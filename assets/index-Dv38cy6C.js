var eS=Object.defineProperty;var tS=(e,t,n)=>t in e?eS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var cc=(e,t,n)=>tS(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $1={exports:{}},Xr={},W1={exports:{}},Dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sl=Symbol.for("react.element"),nS=Symbol.for("react.portal"),rS=Symbol.for("react.fragment"),iS=Symbol.for("react.strict_mode"),sS=Symbol.for("react.profiler"),aS=Symbol.for("react.provider"),oS=Symbol.for("react.context"),cS=Symbol.for("react.forward_ref"),lS=Symbol.for("react.suspense"),uS=Symbol.for("react.memo"),dS=Symbol.for("react.lazy"),Mg=Symbol.iterator;function hS(e){return e===null||typeof e!="object"?null:(e=Mg&&e[Mg]||e["@@iterator"],typeof e=="function"?e:null)}var G1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},J1=Object.assign,Z1={};function Uo(e,t,n){this.props=e,this.context=t,this.refs=Z1,this.updater=n||G1}Uo.prototype.isReactComponent={};Uo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Uo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function X1(){}X1.prototype=Uo.prototype;function im(e,t,n){this.props=e,this.context=t,this.refs=Z1,this.updater=n||G1}var sm=im.prototype=new X1;sm.constructor=im;J1(sm,Uo.prototype);sm.isPureReactComponent=!0;var Lg=Array.isArray,Q1=Object.prototype.hasOwnProperty,am={current:null},Y1={key:!0,ref:!0,__self:!0,__source:!0};function e0(e,t,n){var r,i={},a=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Q1.call(t,r)&&!Y1.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var p=Array(u),h=0;h<u;h++)p[h]=arguments[h+2];i.children=p}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:Sl,type:e,key:a,ref:o,props:i,_owner:am.current}}function pS(e,t){return{$$typeof:Sl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function om(e){return typeof e=="object"&&e!==null&&e.$$typeof===Sl}function fS(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var jg=/\/+/g;function Zh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?fS(""+e.key):t.toString(36)}function Eu(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Sl:case nS:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+Zh(o,0):r,Lg(i)?(n="",e!=null&&(n=e.replace(jg,"$&/")+"/"),Eu(i,t,n,"",function(h){return h})):i!=null&&(om(i)&&(i=pS(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(jg,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",Lg(e))for(var u=0;u<e.length;u++){a=e[u];var p=r+Zh(a,u);o+=Eu(a,t,n,p,i)}else if(p=hS(e),typeof p=="function")for(e=p.call(e),u=0;!(a=e.next()).done;)a=a.value,p=r+Zh(a,u++),o+=Eu(a,t,n,p,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Yl(e,t,n){if(e==null)return e;var r=[],i=0;return Eu(e,r,"","",function(a){return t.call(n,a,i++)}),r}function mS(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var kr={current:null},Pu={transition:null},gS={ReactCurrentDispatcher:kr,ReactCurrentBatchConfig:Pu,ReactCurrentOwner:am};function t0(){throw Error("act(...) is not supported in production builds of React.")}Dt.Children={map:Yl,forEach:function(e,t,n){Yl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Yl(e,function(){t++}),t},toArray:function(e){return Yl(e,function(t){return t})||[]},only:function(e){if(!om(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Dt.Component=Uo;Dt.Fragment=rS;Dt.Profiler=sS;Dt.PureComponent=im;Dt.StrictMode=iS;Dt.Suspense=lS;Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gS;Dt.act=t0;Dt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=J1({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=am.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(p in t)Q1.call(t,p)&&!Y1.hasOwnProperty(p)&&(r[p]=t[p]===void 0&&u!==void 0?u[p]:t[p])}var p=arguments.length-2;if(p===1)r.children=n;else if(1<p){u=Array(p);for(var h=0;h<p;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:Sl,type:e.type,key:i,ref:a,props:r,_owner:o}};Dt.createContext=function(e){return e={$$typeof:oS,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:aS,_context:e},e.Consumer=e};Dt.createElement=e0;Dt.createFactory=function(e){var t=e0.bind(null,e);return t.type=e,t};Dt.createRef=function(){return{current:null}};Dt.forwardRef=function(e){return{$$typeof:cS,render:e}};Dt.isValidElement=om;Dt.lazy=function(e){return{$$typeof:dS,_payload:{_status:-1,_result:e},_init:mS}};Dt.memo=function(e,t){return{$$typeof:uS,type:e,compare:t===void 0?null:t}};Dt.startTransition=function(e){var t=Pu.transition;Pu.transition={};try{e()}finally{Pu.transition=t}};Dt.unstable_act=t0;Dt.useCallback=function(e,t){return kr.current.useCallback(e,t)};Dt.useContext=function(e){return kr.current.useContext(e)};Dt.useDebugValue=function(){};Dt.useDeferredValue=function(e){return kr.current.useDeferredValue(e)};Dt.useEffect=function(e,t){return kr.current.useEffect(e,t)};Dt.useId=function(){return kr.current.useId()};Dt.useImperativeHandle=function(e,t,n){return kr.current.useImperativeHandle(e,t,n)};Dt.useInsertionEffect=function(e,t){return kr.current.useInsertionEffect(e,t)};Dt.useLayoutEffect=function(e,t){return kr.current.useLayoutEffect(e,t)};Dt.useMemo=function(e,t){return kr.current.useMemo(e,t)};Dt.useReducer=function(e,t,n){return kr.current.useReducer(e,t,n)};Dt.useRef=function(e){return kr.current.useRef(e)};Dt.useState=function(e){return kr.current.useState(e)};Dt.useSyncExternalStore=function(e,t,n){return kr.current.useSyncExternalStore(e,t,n)};Dt.useTransition=function(){return kr.current.useTransition()};Dt.version="18.3.1";W1.exports=Dt;var vt=W1.exports;const n0=rm(vt);var r0={exports:{}},i0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(fe,ge){var Ee=fe.length;fe.push(ge);e:for(;0<Ee;){var Oe=Ee-1>>>1,Je=fe[Oe];if(0<i(Je,ge))fe[Oe]=ge,fe[Ee]=Je,Ee=Oe;else break e}}function n(fe){return fe.length===0?null:fe[0]}function r(fe){if(fe.length===0)return null;var ge=fe[0],Ee=fe.pop();if(Ee!==ge){fe[0]=Ee;e:for(var Oe=0,Je=fe.length,ut=Je>>>1;Oe<ut;){var ot=2*(Oe+1)-1,nt=fe[ot],He=ot+1,Qe=fe[He];if(0>i(nt,Ee))He<Je&&0>i(Qe,nt)?(fe[Oe]=Qe,fe[He]=Ee,Oe=He):(fe[Oe]=nt,fe[ot]=Ee,Oe=ot);else if(He<Je&&0>i(Qe,Ee))fe[Oe]=Qe,fe[He]=Ee,Oe=He;else break e}}return ge}function i(fe,ge){var Ee=fe.sortIndex-ge.sortIndex;return Ee!==0?Ee:fe.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var p=[],h=[],g=1,f=null,_=3,w=!1,C=!1,R=!1,S=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(fe){for(var ge=n(h);ge!==null;){if(ge.callback===null)r(h);else if(ge.startTime<=fe)r(h),ge.sortIndex=ge.expirationTime,t(p,ge);else break;ge=n(h)}}function M(fe){if(R=!1,E(fe),!C)if(n(p)!==null)C=!0,_e(Z);else{var ge=n(h);ge!==null&&le(M,ge.startTime-fe)}}function Z(fe,ge){C=!1,R&&(R=!1,b(q),q=-1),w=!0;var Ee=_;try{for(E(ge),f=n(p);f!==null&&(!(f.expirationTime>ge)||fe&&!ee());){var Oe=f.callback;if(typeof Oe=="function"){f.callback=null,_=f.priorityLevel;var Je=Oe(f.expirationTime<=ge);ge=e.unstable_now(),typeof Je=="function"?f.callback=Je:f===n(p)&&r(p),E(ge)}else r(p);f=n(p)}if(f!==null)var ut=!0;else{var ot=n(h);ot!==null&&le(M,ot.startTime-ge),ut=!1}return ut}finally{f=null,_=Ee,w=!1}}var $=!1,z=null,q=-1,Q=5,K=-1;function ee(){return!(e.unstable_now()-K<Q)}function oe(){if(z!==null){var fe=e.unstable_now();K=fe;var ge=!0;try{ge=z(!0,fe)}finally{ge?ce():($=!1,z=null)}}else $=!1}var ce;if(typeof x=="function")ce=function(){x(oe)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,ke=ne.port2;ne.port1.onmessage=oe,ce=function(){ke.postMessage(null)}}else ce=function(){S(oe,0)};function _e(fe){z=fe,$||($=!0,ce())}function le(fe,ge){q=S(function(){fe(e.unstable_now())},ge)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(fe){fe.callback=null},e.unstable_continueExecution=function(){C||w||(C=!0,_e(Z))},e.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<fe?Math.floor(1e3/fe):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return n(p)},e.unstable_next=function(fe){switch(_){case 1:case 2:case 3:var ge=3;break;default:ge=_}var Ee=_;_=ge;try{return fe()}finally{_=Ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(fe,ge){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var Ee=_;_=fe;try{return ge()}finally{_=Ee}},e.unstable_scheduleCallback=function(fe,ge,Ee){var Oe=e.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?Oe+Ee:Oe):Ee=Oe,fe){case 1:var Je=-1;break;case 2:Je=250;break;case 5:Je=1073741823;break;case 4:Je=1e4;break;default:Je=5e3}return Je=Ee+Je,fe={id:g++,callback:ge,priorityLevel:fe,startTime:Ee,expirationTime:Je,sortIndex:-1},Ee>Oe?(fe.sortIndex=Ee,t(h,fe),n(p)===null&&fe===n(h)&&(R?(b(q),q=-1):R=!0,le(M,Ee-Oe))):(fe.sortIndex=Je,t(p,fe),C||w||(C=!0,_e(Z))),fe},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(fe){var ge=_;return function(){var Ee=_;_=ge;try{return fe.apply(this,arguments)}finally{_=Ee}}}})(i0);r0.exports=i0;var vS=r0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yS=vt,Zr=vS;function je(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s0=new Set,Hc={};function Ka(e,t){Po(e,t),Po(e+"Capture",t)}function Po(e,t){for(Hc[e]=t,e=0;e<t.length;e++)s0.add(t[e])}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hp=Object.prototype.hasOwnProperty,_S=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bg={},Ug={};function bS(e){return Hp.call(Ug,e)?!0:Hp.call(Bg,e)?!1:_S.test(e)?Ug[e]=!0:(Bg[e]=!0,!1)}function SS(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function wS(e,t,n,r){if(t===null||typeof t>"u"||SS(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Tr(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var rr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){rr[e]=new Tr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];rr[t]=new Tr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){rr[e]=new Tr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){rr[e]=new Tr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){rr[e]=new Tr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){rr[e]=new Tr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){rr[e]=new Tr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){rr[e]=new Tr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){rr[e]=new Tr(e,5,!1,e.toLowerCase(),null,!1,!1)});var cm=/[\-:]([a-z])/g;function lm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(cm,lm);rr[t]=new Tr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(cm,lm);rr[t]=new Tr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(cm,lm);rr[t]=new Tr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){rr[e]=new Tr(e,1,!1,e.toLowerCase(),null,!1,!1)});rr.xlinkHref=new Tr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){rr[e]=new Tr(e,1,!1,e.toLowerCase(),null,!0,!0)});function um(e,t,n,r){var i=rr.hasOwnProperty(t)?rr[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(wS(t,n,i,r)&&(n=null),r||i===null?bS(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Cs=yS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,eu=Symbol.for("react.element"),no=Symbol.for("react.portal"),ro=Symbol.for("react.fragment"),dm=Symbol.for("react.strict_mode"),Vp=Symbol.for("react.profiler"),a0=Symbol.for("react.provider"),o0=Symbol.for("react.context"),hm=Symbol.for("react.forward_ref"),qp=Symbol.for("react.suspense"),zp=Symbol.for("react.suspense_list"),pm=Symbol.for("react.memo"),Us=Symbol.for("react.lazy"),c0=Symbol.for("react.offscreen"),Hg=Symbol.iterator;function lc(e){return e===null||typeof e!="object"?null:(e=Hg&&e[Hg]||e["@@iterator"],typeof e=="function"?e:null)}var Sn=Object.assign,Xh;function Pc(e){if(Xh===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Xh=t&&t[1]||""}return`
`+Xh+e}var Qh=!1;function Yh(e,t){if(!e||Qh)return"";Qh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,u=a.length-1;1<=o&&0<=u&&i[o]!==a[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==a[u]){if(o!==1||u!==1)do if(o--,u--,0>u||i[o]!==a[u]){var p=`
`+i[o].replace(" at new "," at ");return e.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",e.displayName)),p}while(1<=o&&0<=u);break}}}finally{Qh=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Pc(e):""}function xS(e){switch(e.tag){case 5:return Pc(e.type);case 16:return Pc("Lazy");case 13:return Pc("Suspense");case 19:return Pc("SuspenseList");case 0:case 2:case 15:return e=Yh(e.type,!1),e;case 11:return e=Yh(e.type.render,!1),e;case 1:return e=Yh(e.type,!0),e;default:return""}}function Kp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ro:return"Fragment";case no:return"Portal";case Vp:return"Profiler";case dm:return"StrictMode";case qp:return"Suspense";case zp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case o0:return(e.displayName||"Context")+".Consumer";case a0:return(e._context.displayName||"Context")+".Provider";case hm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case pm:return t=e.displayName||null,t!==null?t:Kp(e.type)||"Memo";case Us:t=e._payload,e=e._init;try{return Kp(e(t))}catch{}}return null}function CS(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kp(t);case 8:return t===dm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ta(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function l0(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ES(e){var t=l0(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function tu(e){e._valueTracker||(e._valueTracker=ES(e))}function u0(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=l0(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Qu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function $p(e,t){var n=t.checked;return Sn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Vg(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ta(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function d0(e,t){t=t.checked,t!=null&&um(e,"checked",t,!1)}function Wp(e,t){d0(e,t);var n=ta(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Gp(e,t.type,n):t.hasOwnProperty("defaultValue")&&Gp(e,t.type,ta(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function qg(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Gp(e,t,n){(t!=="number"||Qu(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var kc=Array.isArray;function yo(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ta(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Jp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(je(91));return Sn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function zg(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(je(92));if(kc(n)){if(1<n.length)throw Error(je(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ta(n)}}function h0(e,t){var n=ta(t.value),r=ta(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Kg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function p0(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?p0(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var nu,f0=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(nu=nu||document.createElement("div"),nu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=nu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Vc(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ic={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PS=["Webkit","ms","Moz","O"];Object.keys(Ic).forEach(function(e){PS.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ic[t]=Ic[e]})});function m0(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ic.hasOwnProperty(e)&&Ic[e]?(""+t).trim():t+"px"}function g0(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=m0(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var kS=Sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xp(e,t){if(t){if(kS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(je(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(je(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(je(61))}if(t.style!=null&&typeof t.style!="object")throw Error(je(62))}}function Qp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yp=null;function fm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ef=null,_o=null,bo=null;function $g(e){if(e=Cl(e)){if(typeof ef!="function")throw Error(je(280));var t=e.stateNode;t&&(t=Hd(t),ef(e.stateNode,e.type,t))}}function v0(e){_o?bo?bo.push(e):bo=[e]:_o=e}function y0(){if(_o){var e=_o,t=bo;if(bo=_o=null,$g(e),t)for(e=0;e<t.length;e++)$g(t[e])}}function _0(e,t){return e(t)}function b0(){}var ep=!1;function S0(e,t,n){if(ep)return e(t,n);ep=!0;try{return _0(e,t,n)}finally{ep=!1,(_o!==null||bo!==null)&&(b0(),y0())}}function qc(e,t){var n=e.stateNode;if(n===null)return null;var r=Hd(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(je(231,t,typeof n));return n}var tf=!1;if(ys)try{var uc={};Object.defineProperty(uc,"passive",{get:function(){tf=!0}}),window.addEventListener("test",uc,uc),window.removeEventListener("test",uc,uc)}catch{tf=!1}function TS(e,t,n,r,i,a,o,u,p){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(g){this.onError(g)}}var Fc=!1,Yu=null,ed=!1,nf=null,RS={onError:function(e){Fc=!0,Yu=e}};function AS(e,t,n,r,i,a,o,u,p){Fc=!1,Yu=null,TS.apply(RS,arguments)}function IS(e,t,n,r,i,a,o,u,p){if(AS.apply(this,arguments),Fc){if(Fc){var h=Yu;Fc=!1,Yu=null}else throw Error(je(198));ed||(ed=!0,nf=h)}}function $a(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function w0(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wg(e){if($a(e)!==e)throw Error(je(188))}function FS(e){var t=e.alternate;if(!t){if(t=$a(e),t===null)throw Error(je(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Wg(i),e;if(a===r)return Wg(i),t;a=a.sibling}throw Error(je(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=a;break}if(u===r){o=!0,r=i,n=a;break}u=u.sibling}if(!o){for(u=a.child;u;){if(u===n){o=!0,n=a,r=i;break}if(u===r){o=!0,r=a,n=i;break}u=u.sibling}if(!o)throw Error(je(189))}}if(n.alternate!==r)throw Error(je(190))}if(n.tag!==3)throw Error(je(188));return n.stateNode.current===n?e:t}function x0(e){return e=FS(e),e!==null?C0(e):null}function C0(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=C0(e);if(t!==null)return t;e=e.sibling}return null}var E0=Zr.unstable_scheduleCallback,Gg=Zr.unstable_cancelCallback,DS=Zr.unstable_shouldYield,NS=Zr.unstable_requestPaint,In=Zr.unstable_now,OS=Zr.unstable_getCurrentPriorityLevel,mm=Zr.unstable_ImmediatePriority,P0=Zr.unstable_UserBlockingPriority,td=Zr.unstable_NormalPriority,MS=Zr.unstable_LowPriority,k0=Zr.unstable_IdlePriority,Ld=null,Xi=null;function LS(e){if(Xi&&typeof Xi.onCommitFiberRoot=="function")try{Xi.onCommitFiberRoot(Ld,e,void 0,(e.current.flags&128)===128)}catch{}}var Ri=Math.clz32?Math.clz32:US,jS=Math.log,BS=Math.LN2;function US(e){return e>>>=0,e===0?32:31-(jS(e)/BS|0)|0}var ru=64,iu=4194304;function Tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function nd(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var u=o&~i;u!==0?r=Tc(u):(a&=o,a!==0&&(r=Tc(a)))}else o=n&~i,o!==0?r=Tc(o):a!==0&&(r=Tc(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ri(t),i=1<<n,r|=e[n],t&=~i;return r}function HS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VS(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Ri(a),u=1<<o,p=i[o];p===-1?(!(u&n)||u&r)&&(i[o]=HS(u,t)):p<=t&&(e.expiredLanes|=u),a&=~u}}function rf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function T0(){var e=ru;return ru<<=1,!(ru&4194240)&&(ru=64),e}function tp(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ri(t),e[t]=n}function qS(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Ri(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function gm(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ri(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Qt=0;function R0(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var A0,vm,I0,F0,D0,sf=!1,su=[],Ws=null,Gs=null,Js=null,zc=new Map,Kc=new Map,Vs=[],zS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jg(e,t){switch(e){case"focusin":case"focusout":Ws=null;break;case"dragenter":case"dragleave":Gs=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":zc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(t.pointerId)}}function dc(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Cl(t),t!==null&&vm(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function KS(e,t,n,r,i){switch(t){case"focusin":return Ws=dc(Ws,e,t,n,r,i),!0;case"dragenter":return Gs=dc(Gs,e,t,n,r,i),!0;case"mouseover":return Js=dc(Js,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return zc.set(a,dc(zc.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Kc.set(a,dc(Kc.get(a)||null,e,t,n,r,i)),!0}return!1}function N0(e){var t=Pa(e.target);if(t!==null){var n=$a(t);if(n!==null){if(t=n.tag,t===13){if(t=w0(n),t!==null){e.blockedOn=t,D0(e.priority,function(){I0(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ku(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=af(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Yp=r,n.target.dispatchEvent(r),Yp=null}else return t=Cl(n),t!==null&&vm(t),e.blockedOn=n,!1;t.shift()}return!0}function Zg(e,t,n){ku(e)&&n.delete(t)}function $S(){sf=!1,Ws!==null&&ku(Ws)&&(Ws=null),Gs!==null&&ku(Gs)&&(Gs=null),Js!==null&&ku(Js)&&(Js=null),zc.forEach(Zg),Kc.forEach(Zg)}function hc(e,t){e.blockedOn===t&&(e.blockedOn=null,sf||(sf=!0,Zr.unstable_scheduleCallback(Zr.unstable_NormalPriority,$S)))}function $c(e){function t(i){return hc(i,e)}if(0<su.length){hc(su[0],e);for(var n=1;n<su.length;n++){var r=su[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ws!==null&&hc(Ws,e),Gs!==null&&hc(Gs,e),Js!==null&&hc(Js,e),zc.forEach(t),Kc.forEach(t),n=0;n<Vs.length;n++)r=Vs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Vs.length&&(n=Vs[0],n.blockedOn===null);)N0(n),n.blockedOn===null&&Vs.shift()}var So=Cs.ReactCurrentBatchConfig,rd=!0;function WS(e,t,n,r){var i=Qt,a=So.transition;So.transition=null;try{Qt=1,ym(e,t,n,r)}finally{Qt=i,So.transition=a}}function GS(e,t,n,r){var i=Qt,a=So.transition;So.transition=null;try{Qt=4,ym(e,t,n,r)}finally{Qt=i,So.transition=a}}function ym(e,t,n,r){if(rd){var i=af(e,t,n,r);if(i===null)dp(e,t,r,id,n),Jg(e,r);else if(KS(i,e,t,n,r))r.stopPropagation();else if(Jg(e,r),t&4&&-1<zS.indexOf(e)){for(;i!==null;){var a=Cl(i);if(a!==null&&A0(a),a=af(e,t,n,r),a===null&&dp(e,t,r,id,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else dp(e,t,r,null,n)}}var id=null;function af(e,t,n,r){if(id=null,e=fm(r),e=Pa(e),e!==null)if(t=$a(e),t===null)e=null;else if(n=t.tag,n===13){if(e=w0(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return id=e,null}function O0(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OS()){case mm:return 1;case P0:return 4;case td:case MS:return 16;case k0:return 536870912;default:return 16}default:return 16}}var Ks=null,_m=null,Tu=null;function M0(){if(Tu)return Tu;var e,t=_m,n=t.length,r,i="value"in Ks?Ks.value:Ks.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return Tu=i.slice(e,1<r?1-r:void 0)}function Ru(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function au(){return!0}function Xg(){return!1}function Qr(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(a):a[u]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?au:Xg,this.isPropagationStopped=Xg,this}return Sn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=au)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=au)},persist:function(){},isPersistent:au}),t}var Ho={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bm=Qr(Ho),xl=Sn({},Ho,{view:0,detail:0}),JS=Qr(xl),np,rp,pc,jd=Sn({},xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pc&&(pc&&e.type==="mousemove"?(np=e.screenX-pc.screenX,rp=e.screenY-pc.screenY):rp=np=0,pc=e),np)},movementY:function(e){return"movementY"in e?e.movementY:rp}}),Qg=Qr(jd),ZS=Sn({},jd,{dataTransfer:0}),XS=Qr(ZS),QS=Sn({},xl,{relatedTarget:0}),ip=Qr(QS),YS=Sn({},Ho,{animationName:0,elapsedTime:0,pseudoElement:0}),ew=Qr(YS),tw=Sn({},Ho,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nw=Qr(tw),rw=Sn({},Ho,{data:0}),Yg=Qr(rw),iw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ow(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=aw[e])?!!t[e]:!1}function Sm(){return ow}var cw=Sn({},xl,{key:function(e){if(e.key){var t=iw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ru(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?sw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sm,charCode:function(e){return e.type==="keypress"?Ru(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ru(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),lw=Qr(cw),uw=Sn({},jd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ev=Qr(uw),dw=Sn({},xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sm}),hw=Qr(dw),pw=Sn({},Ho,{propertyName:0,elapsedTime:0,pseudoElement:0}),fw=Qr(pw),mw=Sn({},jd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),gw=Qr(mw),vw=[9,13,27,32],wm=ys&&"CompositionEvent"in window,Dc=null;ys&&"documentMode"in document&&(Dc=document.documentMode);var yw=ys&&"TextEvent"in window&&!Dc,L0=ys&&(!wm||Dc&&8<Dc&&11>=Dc),tv=" ",nv=!1;function j0(e,t){switch(e){case"keyup":return vw.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function B0(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var io=!1;function _w(e,t){switch(e){case"compositionend":return B0(t);case"keypress":return t.which!==32?null:(nv=!0,tv);case"textInput":return e=t.data,e===tv&&nv?null:e;default:return null}}function bw(e,t){if(io)return e==="compositionend"||!wm&&j0(e,t)?(e=M0(),Tu=_m=Ks=null,io=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return L0&&t.locale!=="ko"?null:t.data;default:return null}}var Sw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Sw[e.type]:t==="textarea"}function U0(e,t,n,r){v0(r),t=sd(t,"onChange"),0<t.length&&(n=new bm("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Nc=null,Wc=null;function ww(e){X0(e,0)}function Bd(e){var t=oo(e);if(u0(t))return e}function xw(e,t){if(e==="change")return t}var H0=!1;if(ys){var sp;if(ys){var ap="oninput"in document;if(!ap){var iv=document.createElement("div");iv.setAttribute("oninput","return;"),ap=typeof iv.oninput=="function"}sp=ap}else sp=!1;H0=sp&&(!document.documentMode||9<document.documentMode)}function sv(){Nc&&(Nc.detachEvent("onpropertychange",V0),Wc=Nc=null)}function V0(e){if(e.propertyName==="value"&&Bd(Wc)){var t=[];U0(t,Wc,e,fm(e)),S0(ww,t)}}function Cw(e,t,n){e==="focusin"?(sv(),Nc=t,Wc=n,Nc.attachEvent("onpropertychange",V0)):e==="focusout"&&sv()}function Ew(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Bd(Wc)}function Pw(e,t){if(e==="click")return Bd(t)}function kw(e,t){if(e==="input"||e==="change")return Bd(t)}function Tw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Di=typeof Object.is=="function"?Object.is:Tw;function Gc(e,t){if(Di(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Hp.call(t,i)||!Di(e[i],t[i]))return!1}return!0}function av(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ov(e,t){var n=av(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=av(n)}}function q0(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?q0(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function z0(){for(var e=window,t=Qu();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Qu(e.document)}return t}function xm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Rw(e){var t=z0(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&q0(n.ownerDocument.documentElement,n)){if(r!==null&&xm(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=ov(n,a);var o=ov(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Aw=ys&&"documentMode"in document&&11>=document.documentMode,so=null,of=null,Oc=null,cf=!1;function cv(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;cf||so==null||so!==Qu(r)||(r=so,"selectionStart"in r&&xm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Oc&&Gc(Oc,r)||(Oc=r,r=sd(of,"onSelect"),0<r.length&&(t=new bm("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=so)))}function ou(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ao={animationend:ou("Animation","AnimationEnd"),animationiteration:ou("Animation","AnimationIteration"),animationstart:ou("Animation","AnimationStart"),transitionend:ou("Transition","TransitionEnd")},op={},K0={};ys&&(K0=document.createElement("div").style,"AnimationEvent"in window||(delete ao.animationend.animation,delete ao.animationiteration.animation,delete ao.animationstart.animation),"TransitionEvent"in window||delete ao.transitionend.transition);function Ud(e){if(op[e])return op[e];if(!ao[e])return e;var t=ao[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in K0)return op[e]=t[n];return e}var $0=Ud("animationend"),W0=Ud("animationiteration"),G0=Ud("animationstart"),J0=Ud("transitionend"),Z0=new Map,lv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function aa(e,t){Z0.set(e,t),Ka(t,[e])}for(var cp=0;cp<lv.length;cp++){var lp=lv[cp],Iw=lp.toLowerCase(),Fw=lp[0].toUpperCase()+lp.slice(1);aa(Iw,"on"+Fw)}aa($0,"onAnimationEnd");aa(W0,"onAnimationIteration");aa(G0,"onAnimationStart");aa("dblclick","onDoubleClick");aa("focusin","onFocus");aa("focusout","onBlur");aa(J0,"onTransitionEnd");Po("onMouseEnter",["mouseout","mouseover"]);Po("onMouseLeave",["mouseout","mouseover"]);Po("onPointerEnter",["pointerout","pointerover"]);Po("onPointerLeave",["pointerout","pointerover"]);Ka("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ka("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ka("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ka("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ka("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ka("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rc));function uv(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,IS(r,t,void 0,e),e.currentTarget=null}function X0(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],p=u.instance,h=u.currentTarget;if(u=u.listener,p!==a&&i.isPropagationStopped())break e;uv(i,u,h),a=p}else for(o=0;o<r.length;o++){if(u=r[o],p=u.instance,h=u.currentTarget,u=u.listener,p!==a&&i.isPropagationStopped())break e;uv(i,u,h),a=p}}}if(ed)throw e=nf,ed=!1,nf=null,e}function ln(e,t){var n=t[pf];n===void 0&&(n=t[pf]=new Set);var r=e+"__bubble";n.has(r)||(Q0(t,e,2,!1),n.add(r))}function up(e,t,n){var r=0;t&&(r|=4),Q0(n,e,r,t)}var cu="_reactListening"+Math.random().toString(36).slice(2);function Jc(e){if(!e[cu]){e[cu]=!0,s0.forEach(function(n){n!=="selectionchange"&&(Dw.has(n)||up(n,!1,e),up(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cu]||(t[cu]=!0,up("selectionchange",!1,t))}}function Q0(e,t,n,r){switch(O0(t)){case 1:var i=WS;break;case 4:i=GS;break;default:i=ym}n=i.bind(null,t,n,e),i=void 0,!tf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function dp(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var p=o.tag;if((p===3||p===4)&&(p=o.stateNode.containerInfo,p===i||p.nodeType===8&&p.parentNode===i))return;o=o.return}for(;u!==null;){if(o=Pa(u),o===null)return;if(p=o.tag,p===5||p===6){r=a=o;continue e}u=u.parentNode}}r=r.return}S0(function(){var h=a,g=fm(n),f=[];e:{var _=Z0.get(e);if(_!==void 0){var w=bm,C=e;switch(e){case"keypress":if(Ru(n)===0)break e;case"keydown":case"keyup":w=lw;break;case"focusin":C="focus",w=ip;break;case"focusout":C="blur",w=ip;break;case"beforeblur":case"afterblur":w=ip;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Qg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=XS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=hw;break;case $0:case W0:case G0:w=ew;break;case J0:w=fw;break;case"scroll":w=JS;break;case"wheel":w=gw;break;case"copy":case"cut":case"paste":w=nw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=ev}var R=(t&4)!==0,S=!R&&e==="scroll",b=R?_!==null?_+"Capture":null:_;R=[];for(var x=h,E;x!==null;){E=x;var M=E.stateNode;if(E.tag===5&&M!==null&&(E=M,b!==null&&(M=qc(x,b),M!=null&&R.push(Zc(x,M,E)))),S)break;x=x.return}0<R.length&&(_=new w(_,C,null,n,g),f.push({event:_,listeners:R}))}}if(!(t&7)){e:{if(_=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",_&&n!==Yp&&(C=n.relatedTarget||n.fromElement)&&(Pa(C)||C[_s]))break e;if((w||_)&&(_=g.window===g?g:(_=g.ownerDocument)?_.defaultView||_.parentWindow:window,w?(C=n.relatedTarget||n.toElement,w=h,C=C?Pa(C):null,C!==null&&(S=$a(C),C!==S||C.tag!==5&&C.tag!==6)&&(C=null)):(w=null,C=h),w!==C)){if(R=Qg,M="onMouseLeave",b="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(R=ev,M="onPointerLeave",b="onPointerEnter",x="pointer"),S=w==null?_:oo(w),E=C==null?_:oo(C),_=new R(M,x+"leave",w,n,g),_.target=S,_.relatedTarget=E,M=null,Pa(g)===h&&(R=new R(b,x+"enter",C,n,g),R.target=E,R.relatedTarget=S,M=R),S=M,w&&C)t:{for(R=w,b=C,x=0,E=R;E;E=Ya(E))x++;for(E=0,M=b;M;M=Ya(M))E++;for(;0<x-E;)R=Ya(R),x--;for(;0<E-x;)b=Ya(b),E--;for(;x--;){if(R===b||b!==null&&R===b.alternate)break t;R=Ya(R),b=Ya(b)}R=null}else R=null;w!==null&&dv(f,_,w,R,!1),C!==null&&S!==null&&dv(f,S,C,R,!0)}}e:{if(_=h?oo(h):window,w=_.nodeName&&_.nodeName.toLowerCase(),w==="select"||w==="input"&&_.type==="file")var Z=xw;else if(rv(_))if(H0)Z=kw;else{Z=Ew;var $=Cw}else(w=_.nodeName)&&w.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(Z=Pw);if(Z&&(Z=Z(e,h))){U0(f,Z,n,g);break e}$&&$(e,_,h),e==="focusout"&&($=_._wrapperState)&&$.controlled&&_.type==="number"&&Gp(_,"number",_.value)}switch($=h?oo(h):window,e){case"focusin":(rv($)||$.contentEditable==="true")&&(so=$,of=h,Oc=null);break;case"focusout":Oc=of=so=null;break;case"mousedown":cf=!0;break;case"contextmenu":case"mouseup":case"dragend":cf=!1,cv(f,n,g);break;case"selectionchange":if(Aw)break;case"keydown":case"keyup":cv(f,n,g)}var z;if(wm)e:{switch(e){case"compositionstart":var q="onCompositionStart";break e;case"compositionend":q="onCompositionEnd";break e;case"compositionupdate":q="onCompositionUpdate";break e}q=void 0}else io?j0(e,n)&&(q="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(q="onCompositionStart");q&&(L0&&n.locale!=="ko"&&(io||q!=="onCompositionStart"?q==="onCompositionEnd"&&io&&(z=M0()):(Ks=g,_m="value"in Ks?Ks.value:Ks.textContent,io=!0)),$=sd(h,q),0<$.length&&(q=new Yg(q,e,null,n,g),f.push({event:q,listeners:$}),z?q.data=z:(z=B0(n),z!==null&&(q.data=z)))),(z=yw?_w(e,n):bw(e,n))&&(h=sd(h,"onBeforeInput"),0<h.length&&(g=new Yg("onBeforeInput","beforeinput",null,n,g),f.push({event:g,listeners:h}),g.data=z))}X0(f,t)})}function Zc(e,t,n){return{instance:e,listener:t,currentTarget:n}}function sd(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=qc(e,n),a!=null&&r.unshift(Zc(e,a,i)),a=qc(e,t),a!=null&&r.push(Zc(e,a,i))),e=e.return}return r}function Ya(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function dv(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var u=n,p=u.alternate,h=u.stateNode;if(p!==null&&p===r)break;u.tag===5&&h!==null&&(u=h,i?(p=qc(n,a),p!=null&&o.unshift(Zc(n,p,u))):i||(p=qc(n,a),p!=null&&o.push(Zc(n,p,u)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Nw=/\r\n?/g,Ow=/\u0000|\uFFFD/g;function hv(e){return(typeof e=="string"?e:""+e).replace(Nw,`
`).replace(Ow,"")}function lu(e,t,n){if(t=hv(t),hv(e)!==t&&n)throw Error(je(425))}function ad(){}var lf=null,uf=null;function df(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hf=typeof setTimeout=="function"?setTimeout:void 0,Mw=typeof clearTimeout=="function"?clearTimeout:void 0,pv=typeof Promise=="function"?Promise:void 0,Lw=typeof queueMicrotask=="function"?queueMicrotask:typeof pv<"u"?function(e){return pv.resolve(null).then(e).catch(jw)}:hf;function jw(e){setTimeout(function(){throw e})}function hp(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),$c(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);$c(t)}function Zs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function fv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Vo=Math.random().toString(36).slice(2),Zi="__reactFiber$"+Vo,Xc="__reactProps$"+Vo,_s="__reactContainer$"+Vo,pf="__reactEvents$"+Vo,Bw="__reactListeners$"+Vo,Uw="__reactHandles$"+Vo;function Pa(e){var t=e[Zi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[_s]||n[Zi]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=fv(e);e!==null;){if(n=e[Zi])return n;e=fv(e)}return t}e=n,n=e.parentNode}return null}function Cl(e){return e=e[Zi]||e[_s],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function oo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(je(33))}function Hd(e){return e[Xc]||null}var ff=[],co=-1;function oa(e){return{current:e}}function un(e){0>co||(e.current=ff[co],ff[co]=null,co--)}function rn(e,t){co++,ff[co]=e.current,e.current=t}var na={},pr=oa(na),jr=oa(!1),La=na;function ko(e,t){var n=e.type.contextTypes;if(!n)return na;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Br(e){return e=e.childContextTypes,e!=null}function od(){un(jr),un(pr)}function mv(e,t,n){if(pr.current!==na)throw Error(je(168));rn(pr,t),rn(jr,n)}function Y0(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(je(108,CS(e)||"Unknown",i));return Sn({},n,r)}function cd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||na,La=pr.current,rn(pr,e),rn(jr,jr.current),!0}function gv(e,t,n){var r=e.stateNode;if(!r)throw Error(je(169));n?(e=Y0(e,t,La),r.__reactInternalMemoizedMergedChildContext=e,un(jr),un(pr),rn(pr,e)):un(jr),rn(jr,n)}var ps=null,Vd=!1,pp=!1;function ey(e){ps===null?ps=[e]:ps.push(e)}function Hw(e){Vd=!0,ey(e)}function ca(){if(!pp&&ps!==null){pp=!0;var e=0,t=Qt;try{var n=ps;for(Qt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ps=null,Vd=!1}catch(i){throw ps!==null&&(ps=ps.slice(e+1)),E0(mm,ca),i}finally{Qt=t,pp=!1}}return null}var lo=[],uo=0,ld=null,ud=0,ci=[],li=0,ja=null,ms=1,gs="";function wa(e,t){lo[uo++]=ud,lo[uo++]=ld,ld=e,ud=t}function ty(e,t,n){ci[li++]=ms,ci[li++]=gs,ci[li++]=ja,ja=e;var r=ms;e=gs;var i=32-Ri(r)-1;r&=~(1<<i),n+=1;var a=32-Ri(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ms=1<<32-Ri(t)+i|n<<i|r,gs=a+e}else ms=1<<a|n<<i|r,gs=e}function Cm(e){e.return!==null&&(wa(e,1),ty(e,1,0))}function Em(e){for(;e===ld;)ld=lo[--uo],lo[uo]=null,ud=lo[--uo],lo[uo]=null;for(;e===ja;)ja=ci[--li],ci[li]=null,gs=ci[--li],ci[li]=null,ms=ci[--li],ci[li]=null}var Jr=null,Gr=null,hn=!1,Pi=null;function ny(e,t){var n=ui(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function vv(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Jr=e,Gr=Zs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Jr=e,Gr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ja!==null?{id:ms,overflow:gs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=ui(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Jr=e,Gr=null,!0):!1;default:return!1}}function mf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function gf(e){if(hn){var t=Gr;if(t){var n=t;if(!vv(e,t)){if(mf(e))throw Error(je(418));t=Zs(n.nextSibling);var r=Jr;t&&vv(e,t)?ny(r,n):(e.flags=e.flags&-4097|2,hn=!1,Jr=e)}}else{if(mf(e))throw Error(je(418));e.flags=e.flags&-4097|2,hn=!1,Jr=e}}}function yv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Jr=e}function uu(e){if(e!==Jr)return!1;if(!hn)return yv(e),hn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!df(e.type,e.memoizedProps)),t&&(t=Gr)){if(mf(e))throw ry(),Error(je(418));for(;t;)ny(e,t),t=Zs(t.nextSibling)}if(yv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(je(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Gr=Zs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Gr=null}}else Gr=Jr?Zs(e.stateNode.nextSibling):null;return!0}function ry(){for(var e=Gr;e;)e=Zs(e.nextSibling)}function To(){Gr=Jr=null,hn=!1}function Pm(e){Pi===null?Pi=[e]:Pi.push(e)}var Vw=Cs.ReactCurrentBatchConfig;function fc(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(je(309));var r=n.stateNode}if(!r)throw Error(je(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var u=i.refs;o===null?delete u[a]:u[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(je(284));if(!n._owner)throw Error(je(290,e))}return e}function du(e,t){throw e=Object.prototype.toString.call(t),Error(je(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _v(e){var t=e._init;return t(e._payload)}function iy(e){function t(b,x){if(e){var E=b.deletions;E===null?(b.deletions=[x],b.flags|=16):E.push(x)}}function n(b,x){if(!e)return null;for(;x!==null;)t(b,x),x=x.sibling;return null}function r(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function i(b,x){return b=ea(b,x),b.index=0,b.sibling=null,b}function a(b,x,E){return b.index=E,e?(E=b.alternate,E!==null?(E=E.index,E<x?(b.flags|=2,x):E):(b.flags|=2,x)):(b.flags|=1048576,x)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function u(b,x,E,M){return x===null||x.tag!==6?(x=bp(E,b.mode,M),x.return=b,x):(x=i(x,E),x.return=b,x)}function p(b,x,E,M){var Z=E.type;return Z===ro?g(b,x,E.props.children,M,E.key):x!==null&&(x.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Us&&_v(Z)===x.type)?(M=i(x,E.props),M.ref=fc(b,x,E),M.return=b,M):(M=Mu(E.type,E.key,E.props,null,b.mode,M),M.ref=fc(b,x,E),M.return=b,M)}function h(b,x,E,M){return x===null||x.tag!==4||x.stateNode.containerInfo!==E.containerInfo||x.stateNode.implementation!==E.implementation?(x=Sp(E,b.mode,M),x.return=b,x):(x=i(x,E.children||[]),x.return=b,x)}function g(b,x,E,M,Z){return x===null||x.tag!==7?(x=Na(E,b.mode,M,Z),x.return=b,x):(x=i(x,E),x.return=b,x)}function f(b,x,E){if(typeof x=="string"&&x!==""||typeof x=="number")return x=bp(""+x,b.mode,E),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case eu:return E=Mu(x.type,x.key,x.props,null,b.mode,E),E.ref=fc(b,null,x),E.return=b,E;case no:return x=Sp(x,b.mode,E),x.return=b,x;case Us:var M=x._init;return f(b,M(x._payload),E)}if(kc(x)||lc(x))return x=Na(x,b.mode,E,null),x.return=b,x;du(b,x)}return null}function _(b,x,E,M){var Z=x!==null?x.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return Z!==null?null:u(b,x,""+E,M);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case eu:return E.key===Z?p(b,x,E,M):null;case no:return E.key===Z?h(b,x,E,M):null;case Us:return Z=E._init,_(b,x,Z(E._payload),M)}if(kc(E)||lc(E))return Z!==null?null:g(b,x,E,M,null);du(b,E)}return null}function w(b,x,E,M,Z){if(typeof M=="string"&&M!==""||typeof M=="number")return b=b.get(E)||null,u(x,b,""+M,Z);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case eu:return b=b.get(M.key===null?E:M.key)||null,p(x,b,M,Z);case no:return b=b.get(M.key===null?E:M.key)||null,h(x,b,M,Z);case Us:var $=M._init;return w(b,x,E,$(M._payload),Z)}if(kc(M)||lc(M))return b=b.get(E)||null,g(x,b,M,Z,null);du(x,M)}return null}function C(b,x,E,M){for(var Z=null,$=null,z=x,q=x=0,Q=null;z!==null&&q<E.length;q++){z.index>q?(Q=z,z=null):Q=z.sibling;var K=_(b,z,E[q],M);if(K===null){z===null&&(z=Q);break}e&&z&&K.alternate===null&&t(b,z),x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K,z=Q}if(q===E.length)return n(b,z),hn&&wa(b,q),Z;if(z===null){for(;q<E.length;q++)z=f(b,E[q],M),z!==null&&(x=a(z,x,q),$===null?Z=z:$.sibling=z,$=z);return hn&&wa(b,q),Z}for(z=r(b,z);q<E.length;q++)Q=w(z,b,q,E[q],M),Q!==null&&(e&&Q.alternate!==null&&z.delete(Q.key===null?q:Q.key),x=a(Q,x,q),$===null?Z=Q:$.sibling=Q,$=Q);return e&&z.forEach(function(ee){return t(b,ee)}),hn&&wa(b,q),Z}function R(b,x,E,M){var Z=lc(E);if(typeof Z!="function")throw Error(je(150));if(E=Z.call(E),E==null)throw Error(je(151));for(var $=Z=null,z=x,q=x=0,Q=null,K=E.next();z!==null&&!K.done;q++,K=E.next()){z.index>q?(Q=z,z=null):Q=z.sibling;var ee=_(b,z,K.value,M);if(ee===null){z===null&&(z=Q);break}e&&z&&ee.alternate===null&&t(b,z),x=a(ee,x,q),$===null?Z=ee:$.sibling=ee,$=ee,z=Q}if(K.done)return n(b,z),hn&&wa(b,q),Z;if(z===null){for(;!K.done;q++,K=E.next())K=f(b,K.value,M),K!==null&&(x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K);return hn&&wa(b,q),Z}for(z=r(b,z);!K.done;q++,K=E.next())K=w(z,b,q,K.value,M),K!==null&&(e&&K.alternate!==null&&z.delete(K.key===null?q:K.key),x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K);return e&&z.forEach(function(oe){return t(b,oe)}),hn&&wa(b,q),Z}function S(b,x,E,M){if(typeof E=="object"&&E!==null&&E.type===ro&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case eu:e:{for(var Z=E.key,$=x;$!==null;){if($.key===Z){if(Z=E.type,Z===ro){if($.tag===7){n(b,$.sibling),x=i($,E.props.children),x.return=b,b=x;break e}}else if($.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Us&&_v(Z)===$.type){n(b,$.sibling),x=i($,E.props),x.ref=fc(b,$,E),x.return=b,b=x;break e}n(b,$);break}else t(b,$);$=$.sibling}E.type===ro?(x=Na(E.props.children,b.mode,M,E.key),x.return=b,b=x):(M=Mu(E.type,E.key,E.props,null,b.mode,M),M.ref=fc(b,x,E),M.return=b,b=M)}return o(b);case no:e:{for($=E.key;x!==null;){if(x.key===$)if(x.tag===4&&x.stateNode.containerInfo===E.containerInfo&&x.stateNode.implementation===E.implementation){n(b,x.sibling),x=i(x,E.children||[]),x.return=b,b=x;break e}else{n(b,x);break}else t(b,x);x=x.sibling}x=Sp(E,b.mode,M),x.return=b,b=x}return o(b);case Us:return $=E._init,S(b,x,$(E._payload),M)}if(kc(E))return C(b,x,E,M);if(lc(E))return R(b,x,E,M);du(b,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,x!==null&&x.tag===6?(n(b,x.sibling),x=i(x,E),x.return=b,b=x):(n(b,x),x=bp(E,b.mode,M),x.return=b,b=x),o(b)):n(b,x)}return S}var Ro=iy(!0),sy=iy(!1),dd=oa(null),hd=null,ho=null,km=null;function Tm(){km=ho=hd=null}function Rm(e){var t=dd.current;un(dd),e._currentValue=t}function vf(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function wo(e,t){hd=e,km=ho=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Lr=!0),e.firstContext=null)}function hi(e){var t=e._currentValue;if(km!==e)if(e={context:e,memoizedValue:t,next:null},ho===null){if(hd===null)throw Error(je(308));ho=e,hd.dependencies={lanes:0,firstContext:e}}else ho=ho.next=e;return t}var ka=null;function Am(e){ka===null?ka=[e]:ka.push(e)}function ay(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Am(t)):(n.next=i.next,i.next=n),t.interleaved=n,bs(e,r)}function bs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Hs=!1;function Im(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oy(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function vs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Xs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Vt&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,bs(e,n)}return i=r.interleaved,i===null?(t.next=t,Am(r)):(t.next=i.next,i.next=t),r.interleaved=t,bs(e,n)}function Au(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,gm(e,n)}}function bv(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function pd(e,t,n,r){var i=e.updateQueue;Hs=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var p=u,h=p.next;p.next=null,o===null?a=h:o.next=h,o=p;var g=e.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==o&&(u===null?g.firstBaseUpdate=h:u.next=h,g.lastBaseUpdate=p))}if(a!==null){var f=i.baseState;o=0,g=h=p=null,u=a;do{var _=u.lane,w=u.eventTime;if((r&_)===_){g!==null&&(g=g.next={eventTime:w,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var C=e,R=u;switch(_=t,w=n,R.tag){case 1:if(C=R.payload,typeof C=="function"){f=C.call(w,f,_);break e}f=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=R.payload,_=typeof C=="function"?C.call(w,f,_):C,_==null)break e;f=Sn({},f,_);break e;case 2:Hs=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,_=i.effects,_===null?i.effects=[u]:_.push(u))}else w={eventTime:w,lane:_,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(h=g=w,p=f):g=g.next=w,o|=_;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;_=u,u=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(g===null&&(p=f),i.baseState=p,i.firstBaseUpdate=h,i.lastBaseUpdate=g,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Ua|=o,e.lanes=o,e.memoizedState=f}}function Sv(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(je(191,i));i.call(r)}}}var El={},Qi=oa(El),Qc=oa(El),Yc=oa(El);function Ta(e){if(e===El)throw Error(je(174));return e}function Fm(e,t){switch(rn(Yc,t),rn(Qc,e),rn(Qi,El),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zp(t,e)}un(Qi),rn(Qi,t)}function Ao(){un(Qi),un(Qc),un(Yc)}function cy(e){Ta(Yc.current);var t=Ta(Qi.current),n=Zp(t,e.type);t!==n&&(rn(Qc,e),rn(Qi,n))}function Dm(e){Qc.current===e&&(un(Qi),un(Qc))}var _n=oa(0);function fd(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fp=[];function Nm(){for(var e=0;e<fp.length;e++)fp[e]._workInProgressVersionPrimary=null;fp.length=0}var Iu=Cs.ReactCurrentDispatcher,mp=Cs.ReactCurrentBatchConfig,Ba=0,bn=null,Vn=null,Wn=null,md=!1,Mc=!1,el=0,qw=0;function or(){throw Error(je(321))}function Om(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Di(e[n],t[n]))return!1;return!0}function Mm(e,t,n,r,i,a){if(Ba=a,bn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Iu.current=e===null||e.memoizedState===null?Ww:Gw,e=n(r,i),Mc){a=0;do{if(Mc=!1,el=0,25<=a)throw Error(je(301));a+=1,Wn=Vn=null,t.updateQueue=null,Iu.current=Jw,e=n(r,i)}while(Mc)}if(Iu.current=gd,t=Vn!==null&&Vn.next!==null,Ba=0,Wn=Vn=bn=null,md=!1,t)throw Error(je(300));return e}function Lm(){var e=el!==0;return el=0,e}function Ji(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wn===null?bn.memoizedState=Wn=e:Wn=Wn.next=e,Wn}function pi(){if(Vn===null){var e=bn.alternate;e=e!==null?e.memoizedState:null}else e=Vn.next;var t=Wn===null?bn.memoizedState:Wn.next;if(t!==null)Wn=t,Vn=e;else{if(e===null)throw Error(je(310));Vn=e,e={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},Wn===null?bn.memoizedState=Wn=e:Wn=Wn.next=e}return Wn}function tl(e,t){return typeof t=="function"?t(e):t}function gp(e){var t=pi(),n=t.queue;if(n===null)throw Error(je(311));n.lastRenderedReducer=e;var r=Vn,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var u=o=null,p=null,h=a;do{var g=h.lane;if((Ba&g)===g)p!==null&&(p=p.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var f={lane:g,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};p===null?(u=p=f,o=r):p=p.next=f,bn.lanes|=g,Ua|=g}h=h.next}while(h!==null&&h!==a);p===null?o=r:p.next=u,Di(r,t.memoizedState)||(Lr=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=p,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,bn.lanes|=a,Ua|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function vp(e){var t=pi(),n=t.queue;if(n===null)throw Error(je(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Di(a,t.memoizedState)||(Lr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function ly(){}function uy(e,t){var n=bn,r=pi(),i=t(),a=!Di(r.memoizedState,i);if(a&&(r.memoizedState=i,Lr=!0),r=r.queue,jm(py.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Wn!==null&&Wn.memoizedState.tag&1){if(n.flags|=2048,nl(9,hy.bind(null,n,r,i,t),void 0,null),Gn===null)throw Error(je(349));Ba&30||dy(n,t,i)}return i}function dy(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=bn.updateQueue,t===null?(t={lastEffect:null,stores:null},bn.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function hy(e,t,n,r){t.value=n,t.getSnapshot=r,fy(t)&&my(e)}function py(e,t,n){return n(function(){fy(t)&&my(e)})}function fy(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Di(e,n)}catch{return!0}}function my(e){var t=bs(e,1);t!==null&&Ai(t,e,1,-1)}function wv(e){var t=Ji();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:tl,lastRenderedState:e},t.queue=e,e=e.dispatch=$w.bind(null,bn,e),[t.memoizedState,e]}function nl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=bn.updateQueue,t===null?(t={lastEffect:null,stores:null},bn.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function gy(){return pi().memoizedState}function Fu(e,t,n,r){var i=Ji();bn.flags|=e,i.memoizedState=nl(1|t,n,void 0,r===void 0?null:r)}function qd(e,t,n,r){var i=pi();r=r===void 0?null:r;var a=void 0;if(Vn!==null){var o=Vn.memoizedState;if(a=o.destroy,r!==null&&Om(r,o.deps)){i.memoizedState=nl(t,n,a,r);return}}bn.flags|=e,i.memoizedState=nl(1|t,n,a,r)}function xv(e,t){return Fu(8390656,8,e,t)}function jm(e,t){return qd(2048,8,e,t)}function vy(e,t){return qd(4,2,e,t)}function yy(e,t){return qd(4,4,e,t)}function _y(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function by(e,t,n){return n=n!=null?n.concat([e]):null,qd(4,4,_y.bind(null,t,e),n)}function Bm(){}function Sy(e,t){var n=pi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Om(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function wy(e,t){var n=pi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Om(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function xy(e,t,n){return Ba&21?(Di(n,t)||(n=T0(),bn.lanes|=n,Ua|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Lr=!0),e.memoizedState=n)}function zw(e,t){var n=Qt;Qt=n!==0&&4>n?n:4,e(!0);var r=mp.transition;mp.transition={};try{e(!1),t()}finally{Qt=n,mp.transition=r}}function Cy(){return pi().memoizedState}function Kw(e,t,n){var r=Ys(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ey(e))Py(t,n);else if(n=ay(e,t,n,r),n!==null){var i=Er();Ai(n,e,r,i),ky(n,t,r)}}function $w(e,t,n){var r=Ys(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ey(e))Py(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,u=a(o,n);if(i.hasEagerState=!0,i.eagerState=u,Di(u,o)){var p=t.interleaved;p===null?(i.next=i,Am(t)):(i.next=p.next,p.next=i),t.interleaved=i;return}}catch{}finally{}n=ay(e,t,i,r),n!==null&&(i=Er(),Ai(n,e,r,i),ky(n,t,r))}}function Ey(e){var t=e.alternate;return e===bn||t!==null&&t===bn}function Py(e,t){Mc=md=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ky(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,gm(e,n)}}var gd={readContext:hi,useCallback:or,useContext:or,useEffect:or,useImperativeHandle:or,useInsertionEffect:or,useLayoutEffect:or,useMemo:or,useReducer:or,useRef:or,useState:or,useDebugValue:or,useDeferredValue:or,useTransition:or,useMutableSource:or,useSyncExternalStore:or,useId:or,unstable_isNewReconciler:!1},Ww={readContext:hi,useCallback:function(e,t){return Ji().memoizedState=[e,t===void 0?null:t],e},useContext:hi,useEffect:xv,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Fu(4194308,4,_y.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fu(4,2,e,t)},useMemo:function(e,t){var n=Ji();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ji();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Kw.bind(null,bn,e),[r.memoizedState,e]},useRef:function(e){var t=Ji();return e={current:e},t.memoizedState=e},useState:wv,useDebugValue:Bm,useDeferredValue:function(e){return Ji().memoizedState=e},useTransition:function(){var e=wv(!1),t=e[0];return e=zw.bind(null,e[1]),Ji().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=bn,i=Ji();if(hn){if(n===void 0)throw Error(je(407));n=n()}else{if(n=t(),Gn===null)throw Error(je(349));Ba&30||dy(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,xv(py.bind(null,r,a,e),[e]),r.flags|=2048,nl(9,hy.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Ji(),t=Gn.identifierPrefix;if(hn){var n=gs,r=ms;n=(r&~(1<<32-Ri(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=el++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=qw++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Gw={readContext:hi,useCallback:Sy,useContext:hi,useEffect:jm,useImperativeHandle:by,useInsertionEffect:vy,useLayoutEffect:yy,useMemo:wy,useReducer:gp,useRef:gy,useState:function(){return gp(tl)},useDebugValue:Bm,useDeferredValue:function(e){var t=pi();return xy(t,Vn.memoizedState,e)},useTransition:function(){var e=gp(tl)[0],t=pi().memoizedState;return[e,t]},useMutableSource:ly,useSyncExternalStore:uy,useId:Cy,unstable_isNewReconciler:!1},Jw={readContext:hi,useCallback:Sy,useContext:hi,useEffect:jm,useImperativeHandle:by,useInsertionEffect:vy,useLayoutEffect:yy,useMemo:wy,useReducer:vp,useRef:gy,useState:function(){return vp(tl)},useDebugValue:Bm,useDeferredValue:function(e){var t=pi();return Vn===null?t.memoizedState=e:xy(t,Vn.memoizedState,e)},useTransition:function(){var e=vp(tl)[0],t=pi().memoizedState;return[e,t]},useMutableSource:ly,useSyncExternalStore:uy,useId:Cy,unstable_isNewReconciler:!1};function xi(e,t){if(e&&e.defaultProps){t=Sn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function yf(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Sn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var zd={isMounted:function(e){return(e=e._reactInternals)?$a(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Er(),i=Ys(e),a=vs(r,i);a.payload=t,n!=null&&(a.callback=n),t=Xs(e,a,i),t!==null&&(Ai(t,e,i,r),Au(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Er(),i=Ys(e),a=vs(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Xs(e,a,i),t!==null&&(Ai(t,e,i,r),Au(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Er(),r=Ys(e),i=vs(n,r);i.tag=2,t!=null&&(i.callback=t),t=Xs(e,i,r),t!==null&&(Ai(t,e,r,n),Au(t,e,r))}};function Cv(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Gc(n,r)||!Gc(i,a):!0}function Ty(e,t,n){var r=!1,i=na,a=t.contextType;return typeof a=="object"&&a!==null?a=hi(a):(i=Br(t)?La:pr.current,r=t.contextTypes,a=(r=r!=null)?ko(e,i):na),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=zd,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Ev(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&zd.enqueueReplaceState(t,t.state,null)}function _f(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Im(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=hi(a):(a=Br(t)?La:pr.current,i.context=ko(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(yf(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&zd.enqueueReplaceState(i,i.state,null),pd(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Io(e,t){try{var n="",r=t;do n+=xS(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function yp(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function bf(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Zw=typeof WeakMap=="function"?WeakMap:Map;function Ry(e,t,n){n=vs(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){yd||(yd=!0,Af=r),bf(e,t)},n}function Ay(e,t,n){n=vs(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){bf(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){bf(e,t),typeof r!="function"&&(Qs===null?Qs=new Set([this]):Qs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Pv(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Zw;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=u4.bind(null,e,t,n),t.then(e,e))}function kv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Tv(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=vs(-1,1),t.tag=2,Xs(n,t,1))),n.lanes|=1),e)}var Xw=Cs.ReactCurrentOwner,Lr=!1;function Sr(e,t,n,r){t.child=e===null?sy(t,null,n,r):Ro(t,e.child,n,r)}function Rv(e,t,n,r,i){n=n.render;var a=t.ref;return wo(t,i),r=Mm(e,t,n,r,a,i),n=Lm(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ss(e,t,i)):(hn&&n&&Cm(t),t.flags|=1,Sr(e,t,r,i),t.child)}function Av(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!Wm(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,Iy(e,t,a,r,i)):(e=Mu(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:Gc,n(o,r)&&e.ref===t.ref)return Ss(e,t,i)}return t.flags|=1,e=ea(a,r),e.ref=t.ref,e.return=t,t.child=e}function Iy(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Gc(a,r)&&e.ref===t.ref)if(Lr=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(Lr=!0);else return t.lanes=e.lanes,Ss(e,t,i)}return Sf(e,t,n,r,i)}function Fy(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},rn(fo,$r),$r|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,rn(fo,$r),$r|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,rn(fo,$r),$r|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,rn(fo,$r),$r|=r;return Sr(e,t,i,n),t.child}function Dy(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Sf(e,t,n,r,i){var a=Br(n)?La:pr.current;return a=ko(t,a),wo(t,i),n=Mm(e,t,n,r,a,i),r=Lm(),e!==null&&!Lr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ss(e,t,i)):(hn&&r&&Cm(t),t.flags|=1,Sr(e,t,n,i),t.child)}function Iv(e,t,n,r,i){if(Br(n)){var a=!0;cd(t)}else a=!1;if(wo(t,i),t.stateNode===null)Du(e,t),Ty(t,n,r),_f(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,u=t.memoizedProps;o.props=u;var p=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=hi(h):(h=Br(n)?La:pr.current,h=ko(t,h));var g=n.getDerivedStateFromProps,f=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||p!==h)&&Ev(t,o,r,h),Hs=!1;var _=t.memoizedState;o.state=_,pd(t,r,o,i),p=t.memoizedState,u!==r||_!==p||jr.current||Hs?(typeof g=="function"&&(yf(t,n,g,r),p=t.memoizedState),(u=Hs||Cv(t,n,u,r,_,p,h))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=h,r=u):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,oy(e,t),u=t.memoizedProps,h=t.type===t.elementType?u:xi(t.type,u),o.props=h,f=t.pendingProps,_=o.context,p=n.contextType,typeof p=="object"&&p!==null?p=hi(p):(p=Br(n)?La:pr.current,p=ko(t,p));var w=n.getDerivedStateFromProps;(g=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==f||_!==p)&&Ev(t,o,r,p),Hs=!1,_=t.memoizedState,o.state=_,pd(t,r,o,i);var C=t.memoizedState;u!==f||_!==C||jr.current||Hs?(typeof w=="function"&&(yf(t,n,w,r),C=t.memoizedState),(h=Hs||Cv(t,n,h,r,_,C,p)||!1)?(g||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,p),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,p)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=C),o.props=r,o.state=C,o.context=p,r=h):(typeof o.componentDidUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),r=!1)}return wf(e,t,n,r,a,i)}function wf(e,t,n,r,i,a){Dy(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&gv(t,n,!1),Ss(e,t,a);r=t.stateNode,Xw.current=t;var u=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Ro(t,e.child,null,a),t.child=Ro(t,null,u,a)):Sr(e,t,u,a),t.memoizedState=r.state,i&&gv(t,n,!0),t.child}function Ny(e){var t=e.stateNode;t.pendingContext?mv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&mv(e,t.context,!1),Fm(e,t.containerInfo)}function Fv(e,t,n,r,i){return To(),Pm(i),t.flags|=256,Sr(e,t,n,r),t.child}var xf={dehydrated:null,treeContext:null,retryLane:0};function Cf(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oy(e,t,n){var r=t.pendingProps,i=_n.current,a=!1,o=(t.flags&128)!==0,u;if((u=o)||(u=e!==null&&e.memoizedState===null?!1:(i&2)!==0),u?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),rn(_n,i&1),e===null)return gf(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Wd(o,r,0,null),e=Na(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Cf(n),t.memoizedState=xf,e):Um(t,o));if(i=e.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return Qw(e,t,o,r,u,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,u=i.sibling;var p={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=p,t.deletions=null):(r=ea(i,p),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?a=ea(u,a):(a=Na(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?Cf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=xf,r}return a=e.child,e=a.sibling,r=ea(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Um(e,t){return t=Wd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function hu(e,t,n,r){return r!==null&&Pm(r),Ro(t,e.child,null,n),e=Um(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Qw(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=yp(Error(je(422))),hu(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Wd({mode:"visible",children:r.children},i,0,null),a=Na(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&Ro(t,e.child,null,o),t.child.memoizedState=Cf(o),t.memoizedState=xf,a);if(!(t.mode&1))return hu(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,a=Error(je(419)),r=yp(a,r,void 0),hu(e,t,o,r)}if(u=(o&e.childLanes)!==0,Lr||u){if(r=Gn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,bs(e,i),Ai(r,e,i,-1))}return $m(),r=yp(Error(je(421))),hu(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=d4.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Gr=Zs(i.nextSibling),Jr=t,hn=!0,Pi=null,e!==null&&(ci[li++]=ms,ci[li++]=gs,ci[li++]=ja,ms=e.id,gs=e.overflow,ja=t),t=Um(t,r.children),t.flags|=4096,t)}function Dv(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),vf(e.return,t,n)}function _p(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function My(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Sr(e,t,r.children,n),r=_n.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dv(e,n,t);else if(e.tag===19)Dv(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(rn(_n,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&fd(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),_p(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&fd(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}_p(t,!0,n,null,a);break;case"together":_p(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Du(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ss(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ua|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(je(153));if(t.child!==null){for(e=t.child,n=ea(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ea(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Yw(e,t,n){switch(t.tag){case 3:Ny(t),To();break;case 5:cy(t);break;case 1:Br(t.type)&&cd(t);break;case 4:Fm(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;rn(dd,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(rn(_n,_n.current&1),t.flags|=128,null):n&t.child.childLanes?Oy(e,t,n):(rn(_n,_n.current&1),e=Ss(e,t,n),e!==null?e.sibling:null);rn(_n,_n.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return My(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rn(_n,_n.current),r)break;return null;case 22:case 23:return t.lanes=0,Fy(e,t,n)}return Ss(e,t,n)}var Ly,Ef,jy,By;Ly=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ef=function(){};jy=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ta(Qi.current);var a=null;switch(n){case"input":i=$p(e,i),r=$p(e,r),a=[];break;case"select":i=Sn({},i,{value:void 0}),r=Sn({},r,{value:void 0}),a=[];break;case"textarea":i=Jp(e,i),r=Jp(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ad)}Xp(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var u=i[h];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Hc.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in r){var p=r[h];if(u=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&p!==u&&(p!=null||u!=null))if(h==="style")if(u){for(o in u)!u.hasOwnProperty(o)||p&&p.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in p)p.hasOwnProperty(o)&&u[o]!==p[o]&&(n||(n={}),n[o]=p[o])}else n||(a||(a=[]),a.push(h,n)),n=p;else h==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,u=u?u.__html:void 0,p!=null&&u!==p&&(a=a||[]).push(h,p)):h==="children"?typeof p!="string"&&typeof p!="number"||(a=a||[]).push(h,""+p):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Hc.hasOwnProperty(h)?(p!=null&&h==="onScroll"&&ln("scroll",e),a||u===p||(a=[])):(a=a||[]).push(h,p))}n&&(a=a||[]).push("style",n);var h=a;(t.updateQueue=h)&&(t.flags|=4)}};By=function(e,t,n,r){n!==r&&(t.flags|=4)};function mc(e,t){if(!hn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function cr(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function e4(e,t,n){var r=t.pendingProps;switch(Em(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cr(t),null;case 1:return Br(t.type)&&od(),cr(t),null;case 3:return r=t.stateNode,Ao(),un(jr),un(pr),Nm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(uu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Pi!==null&&(Df(Pi),Pi=null))),Ef(e,t),cr(t),null;case 5:Dm(t);var i=Ta(Yc.current);if(n=t.type,e!==null&&t.stateNode!=null)jy(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(je(166));return cr(t),null}if(e=Ta(Qi.current),uu(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Zi]=t,r[Xc]=a,e=(t.mode&1)!==0,n){case"dialog":ln("cancel",r),ln("close",r);break;case"iframe":case"object":case"embed":ln("load",r);break;case"video":case"audio":for(i=0;i<Rc.length;i++)ln(Rc[i],r);break;case"source":ln("error",r);break;case"img":case"image":case"link":ln("error",r),ln("load",r);break;case"details":ln("toggle",r);break;case"input":Vg(r,a),ln("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},ln("invalid",r);break;case"textarea":zg(r,a),ln("invalid",r)}Xp(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="children"?typeof u=="string"?r.textContent!==u&&(a.suppressHydrationWarning!==!0&&lu(r.textContent,u,e),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(a.suppressHydrationWarning!==!0&&lu(r.textContent,u,e),i=["children",""+u]):Hc.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&ln("scroll",r)}switch(n){case"input":tu(r),qg(r,a,!0);break;case"textarea":tu(r),Kg(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=ad)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=p0(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Zi]=t,e[Xc]=r,Ly(e,t,!1,!1),t.stateNode=e;e:{switch(o=Qp(n,r),n){case"dialog":ln("cancel",e),ln("close",e),i=r;break;case"iframe":case"object":case"embed":ln("load",e),i=r;break;case"video":case"audio":for(i=0;i<Rc.length;i++)ln(Rc[i],e);i=r;break;case"source":ln("error",e),i=r;break;case"img":case"image":case"link":ln("error",e),ln("load",e),i=r;break;case"details":ln("toggle",e),i=r;break;case"input":Vg(e,r),i=$p(e,r),ln("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Sn({},r,{value:void 0}),ln("invalid",e);break;case"textarea":zg(e,r),i=Jp(e,r),ln("invalid",e);break;default:i=r}Xp(n,i),u=i;for(a in u)if(u.hasOwnProperty(a)){var p=u[a];a==="style"?g0(e,p):a==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&f0(e,p)):a==="children"?typeof p=="string"?(n!=="textarea"||p!=="")&&Vc(e,p):typeof p=="number"&&Vc(e,""+p):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Hc.hasOwnProperty(a)?p!=null&&a==="onScroll"&&ln("scroll",e):p!=null&&um(e,a,p,o))}switch(n){case"input":tu(e),qg(e,r,!1);break;case"textarea":tu(e),Kg(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ta(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?yo(e,!!r.multiple,a,!1):r.defaultValue!=null&&yo(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=ad)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return cr(t),null;case 6:if(e&&t.stateNode!=null)By(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(je(166));if(n=Ta(Yc.current),Ta(Qi.current),uu(t)){if(r=t.stateNode,n=t.memoizedProps,r[Zi]=t,(a=r.nodeValue!==n)&&(e=Jr,e!==null))switch(e.tag){case 3:lu(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&lu(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Zi]=t,t.stateNode=r}return cr(t),null;case 13:if(un(_n),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(hn&&Gr!==null&&t.mode&1&&!(t.flags&128))ry(),To(),t.flags|=98560,a=!1;else if(a=uu(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(je(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(je(317));a[Zi]=t}else To(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;cr(t),a=!1}else Pi!==null&&(Df(Pi),Pi=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||_n.current&1?qn===0&&(qn=3):$m())),t.updateQueue!==null&&(t.flags|=4),cr(t),null);case 4:return Ao(),Ef(e,t),e===null&&Jc(t.stateNode.containerInfo),cr(t),null;case 10:return Rm(t.type._context),cr(t),null;case 17:return Br(t.type)&&od(),cr(t),null;case 19:if(un(_n),a=t.memoizedState,a===null)return cr(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)mc(a,!1);else{if(qn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=fd(e),o!==null){for(t.flags|=128,mc(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return rn(_n,_n.current&1|2),t.child}e=e.sibling}a.tail!==null&&In()>Fo&&(t.flags|=128,r=!0,mc(a,!1),t.lanes=4194304)}else{if(!r)if(e=fd(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),mc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!hn)return cr(t),null}else 2*In()-a.renderingStartTime>Fo&&n!==1073741824&&(t.flags|=128,r=!0,mc(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=In(),t.sibling=null,n=_n.current,rn(_n,r?n&1|2:n&1),t):(cr(t),null);case 22:case 23:return Km(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?$r&1073741824&&(cr(t),t.subtreeFlags&6&&(t.flags|=8192)):cr(t),null;case 24:return null;case 25:return null}throw Error(je(156,t.tag))}function t4(e,t){switch(Em(t),t.tag){case 1:return Br(t.type)&&od(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ao(),un(jr),un(pr),Nm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Dm(t),null;case 13:if(un(_n),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(je(340));To()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return un(_n),null;case 4:return Ao(),null;case 10:return Rm(t.type._context),null;case 22:case 23:return Km(),null;case 24:return null;default:return null}}var pu=!1,dr=!1,n4=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function po(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){kn(e,t,r)}else n.current=null}function Pf(e,t,n){try{n()}catch(r){kn(e,t,r)}}var Nv=!1;function r4(e,t){if(lf=rd,e=z0(),xm(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,u=-1,p=-1,h=0,g=0,f=e,_=null;t:for(;;){for(var w;f!==n||i!==0&&f.nodeType!==3||(u=o+i),f!==a||r!==0&&f.nodeType!==3||(p=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(w=f.firstChild)!==null;)_=f,f=w;for(;;){if(f===e)break t;if(_===n&&++h===i&&(u=o),_===a&&++g===r&&(p=o),(w=f.nextSibling)!==null)break;f=_,_=f.parentNode}f=w}n=u===-1||p===-1?null:{start:u,end:p}}else n=null}n=n||{start:0,end:0}}else n=null;for(uf={focusedElem:e,selectionRange:n},rd=!1,Ge=t;Ge!==null;)if(t=Ge,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ge=e;else for(;Ge!==null;){t=Ge;try{var C=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var R=C.memoizedProps,S=C.memoizedState,b=t.stateNode,x=b.getSnapshotBeforeUpdate(t.elementType===t.type?R:xi(t.type,R),S);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var E=t.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(je(163))}}catch(M){kn(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,Ge=e;break}Ge=t.return}return C=Nv,Nv=!1,C}function Lc(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Pf(t,n,a)}i=i.next}while(i!==r)}}function Kd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function kf(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Uy(e){var t=e.alternate;t!==null&&(e.alternate=null,Uy(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Zi],delete t[Xc],delete t[pf],delete t[Bw],delete t[Uw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Hy(e){return e.tag===5||e.tag===3||e.tag===4}function Ov(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Tf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ad));else if(r!==4&&(e=e.child,e!==null))for(Tf(e,t,n),e=e.sibling;e!==null;)Tf(e,t,n),e=e.sibling}function Rf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Rf(e,t,n),e=e.sibling;e!==null;)Rf(e,t,n),e=e.sibling}var tr=null,Ei=!1;function Ds(e,t,n){for(n=n.child;n!==null;)Vy(e,t,n),n=n.sibling}function Vy(e,t,n){if(Xi&&typeof Xi.onCommitFiberUnmount=="function")try{Xi.onCommitFiberUnmount(Ld,n)}catch{}switch(n.tag){case 5:dr||po(n,t);case 6:var r=tr,i=Ei;tr=null,Ds(e,t,n),tr=r,Ei=i,tr!==null&&(Ei?(e=tr,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):tr.removeChild(n.stateNode));break;case 18:tr!==null&&(Ei?(e=tr,n=n.stateNode,e.nodeType===8?hp(e.parentNode,n):e.nodeType===1&&hp(e,n),$c(e)):hp(tr,n.stateNode));break;case 4:r=tr,i=Ei,tr=n.stateNode.containerInfo,Ei=!0,Ds(e,t,n),tr=r,Ei=i;break;case 0:case 11:case 14:case 15:if(!dr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Pf(n,t,o),i=i.next}while(i!==r)}Ds(e,t,n);break;case 1:if(!dr&&(po(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){kn(n,t,u)}Ds(e,t,n);break;case 21:Ds(e,t,n);break;case 22:n.mode&1?(dr=(r=dr)||n.memoizedState!==null,Ds(e,t,n),dr=r):Ds(e,t,n);break;default:Ds(e,t,n)}}function Mv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new n4),t.forEach(function(r){var i=h4.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function yi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,u=o;e:for(;u!==null;){switch(u.tag){case 5:tr=u.stateNode,Ei=!1;break e;case 3:tr=u.stateNode.containerInfo,Ei=!0;break e;case 4:tr=u.stateNode.containerInfo,Ei=!0;break e}u=u.return}if(tr===null)throw Error(je(160));Vy(a,o,i),tr=null,Ei=!1;var p=i.alternate;p!==null&&(p.return=null),i.return=null}catch(h){kn(i,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)qy(t,e),t=t.sibling}function qy(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yi(t,e),$i(e),r&4){try{Lc(3,e,e.return),Kd(3,e)}catch(R){kn(e,e.return,R)}try{Lc(5,e,e.return)}catch(R){kn(e,e.return,R)}}break;case 1:yi(t,e),$i(e),r&512&&n!==null&&po(n,n.return);break;case 5:if(yi(t,e),$i(e),r&512&&n!==null&&po(n,n.return),e.flags&32){var i=e.stateNode;try{Vc(i,"")}catch(R){kn(e,e.return,R)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,u=e.type,p=e.updateQueue;if(e.updateQueue=null,p!==null)try{u==="input"&&a.type==="radio"&&a.name!=null&&d0(i,a),Qp(u,o);var h=Qp(u,a);for(o=0;o<p.length;o+=2){var g=p[o],f=p[o+1];g==="style"?g0(i,f):g==="dangerouslySetInnerHTML"?f0(i,f):g==="children"?Vc(i,f):um(i,g,f,h)}switch(u){case"input":Wp(i,a);break;case"textarea":h0(i,a);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var w=a.value;w!=null?yo(i,!!a.multiple,w,!1):_!==!!a.multiple&&(a.defaultValue!=null?yo(i,!!a.multiple,a.defaultValue,!0):yo(i,!!a.multiple,a.multiple?[]:"",!1))}i[Xc]=a}catch(R){kn(e,e.return,R)}}break;case 6:if(yi(t,e),$i(e),r&4){if(e.stateNode===null)throw Error(je(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(R){kn(e,e.return,R)}}break;case 3:if(yi(t,e),$i(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$c(t.containerInfo)}catch(R){kn(e,e.return,R)}break;case 4:yi(t,e),$i(e);break;case 13:yi(t,e),$i(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(qm=In())),r&4&&Mv(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(dr=(h=dr)||g,yi(t,e),dr=h):yi(t,e),$i(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!g&&e.mode&1)for(Ge=e,g=e.child;g!==null;){for(f=Ge=g;Ge!==null;){switch(_=Ge,w=_.child,_.tag){case 0:case 11:case 14:case 15:Lc(4,_,_.return);break;case 1:po(_,_.return);var C=_.stateNode;if(typeof C.componentWillUnmount=="function"){r=_,n=_.return;try{t=r,C.props=t.memoizedProps,C.state=t.memoizedState,C.componentWillUnmount()}catch(R){kn(r,n,R)}}break;case 5:po(_,_.return);break;case 22:if(_.memoizedState!==null){jv(f);continue}}w!==null?(w.return=_,Ge=w):jv(f)}g=g.sibling}e:for(g=null,f=e;;){if(f.tag===5){if(g===null){g=f;try{i=f.stateNode,h?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(u=f.stateNode,p=f.memoizedProps.style,o=p!=null&&p.hasOwnProperty("display")?p.display:null,u.style.display=m0("display",o))}catch(R){kn(e,e.return,R)}}}else if(f.tag===6){if(g===null)try{f.stateNode.nodeValue=h?"":f.memoizedProps}catch(R){kn(e,e.return,R)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;g===f&&(g=null),f=f.return}g===f&&(g=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:yi(t,e),$i(e),r&4&&Mv(e);break;case 21:break;default:yi(t,e),$i(e)}}function $i(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Hy(n)){var r=n;break e}n=n.return}throw Error(je(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Vc(i,""),r.flags&=-33);var a=Ov(e);Rf(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=Ov(e);Tf(e,u,o);break;default:throw Error(je(161))}}catch(p){kn(e,e.return,p)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function i4(e,t,n){Ge=e,zy(e)}function zy(e,t,n){for(var r=(e.mode&1)!==0;Ge!==null;){var i=Ge,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||pu;if(!o){var u=i.alternate,p=u!==null&&u.memoizedState!==null||dr;u=pu;var h=dr;if(pu=o,(dr=p)&&!h)for(Ge=i;Ge!==null;)o=Ge,p=o.child,o.tag===22&&o.memoizedState!==null?Bv(i):p!==null?(p.return=o,Ge=p):Bv(i);for(;a!==null;)Ge=a,zy(a),a=a.sibling;Ge=i,pu=u,dr=h}Lv(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Ge=a):Lv(e)}}function Lv(e){for(;Ge!==null;){var t=Ge;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dr||Kd(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!dr)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:xi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Sv(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Sv(t,o,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var p=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&n.focus();break;case"img":p.src&&(n.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var g=h.memoizedState;if(g!==null){var f=g.dehydrated;f!==null&&$c(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(je(163))}dr||t.flags&512&&kf(t)}catch(_){kn(t,t.return,_)}}if(t===e){Ge=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ge=n;break}Ge=t.return}}function jv(e){for(;Ge!==null;){var t=Ge;if(t===e){Ge=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ge=n;break}Ge=t.return}}function Bv(e){for(;Ge!==null;){var t=Ge;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Kd(4,t)}catch(p){kn(t,n,p)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(p){kn(t,i,p)}}var a=t.return;try{kf(t)}catch(p){kn(t,a,p)}break;case 5:var o=t.return;try{kf(t)}catch(p){kn(t,o,p)}}}catch(p){kn(t,t.return,p)}if(t===e){Ge=null;break}var u=t.sibling;if(u!==null){u.return=t.return,Ge=u;break}Ge=t.return}}var s4=Math.ceil,vd=Cs.ReactCurrentDispatcher,Hm=Cs.ReactCurrentOwner,di=Cs.ReactCurrentBatchConfig,Vt=0,Gn=null,jn=null,nr=0,$r=0,fo=oa(0),qn=0,rl=null,Ua=0,$d=0,Vm=0,jc=null,Mr=null,qm=0,Fo=1/0,hs=null,yd=!1,Af=null,Qs=null,fu=!1,$s=null,_d=0,Bc=0,If=null,Nu=-1,Ou=0;function Er(){return Vt&6?In():Nu!==-1?Nu:Nu=In()}function Ys(e){return e.mode&1?Vt&2&&nr!==0?nr&-nr:Vw.transition!==null?(Ou===0&&(Ou=T0()),Ou):(e=Qt,e!==0||(e=window.event,e=e===void 0?16:O0(e.type)),e):1}function Ai(e,t,n,r){if(50<Bc)throw Bc=0,If=null,Error(je(185));wl(e,n,r),(!(Vt&2)||e!==Gn)&&(e===Gn&&(!(Vt&2)&&($d|=n),qn===4&&qs(e,nr)),Ur(e,r),n===1&&Vt===0&&!(t.mode&1)&&(Fo=In()+500,Vd&&ca()))}function Ur(e,t){var n=e.callbackNode;VS(e,t);var r=nd(e,e===Gn?nr:0);if(r===0)n!==null&&Gg(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Gg(n),t===1)e.tag===0?Hw(Uv.bind(null,e)):ey(Uv.bind(null,e)),Lw(function(){!(Vt&6)&&ca()}),n=null;else{switch(R0(r)){case 1:n=mm;break;case 4:n=P0;break;case 16:n=td;break;case 536870912:n=k0;break;default:n=td}n=Qy(n,Ky.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ky(e,t){if(Nu=-1,Ou=0,Vt&6)throw Error(je(327));var n=e.callbackNode;if(xo()&&e.callbackNode!==n)return null;var r=nd(e,e===Gn?nr:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=bd(e,r);else{t=r;var i=Vt;Vt|=2;var a=Wy();(Gn!==e||nr!==t)&&(hs=null,Fo=In()+500,Da(e,t));do try{c4();break}catch(u){$y(e,u)}while(!0);Tm(),vd.current=a,Vt=i,jn!==null?t=0:(Gn=null,nr=0,t=qn)}if(t!==0){if(t===2&&(i=rf(e),i!==0&&(r=i,t=Ff(e,i))),t===1)throw n=rl,Da(e,0),qs(e,r),Ur(e,In()),n;if(t===6)qs(e,r);else{if(i=e.current.alternate,!(r&30)&&!a4(i)&&(t=bd(e,r),t===2&&(a=rf(e),a!==0&&(r=a,t=Ff(e,a))),t===1))throw n=rl,Da(e,0),qs(e,r),Ur(e,In()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(je(345));case 2:xa(e,Mr,hs);break;case 3:if(qs(e,r),(r&130023424)===r&&(t=qm+500-In(),10<t)){if(nd(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Er(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=hf(xa.bind(null,e,Mr,hs),t);break}xa(e,Mr,hs);break;case 4:if(qs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Ri(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=In()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*s4(r/1960))-r,10<r){e.timeoutHandle=hf(xa.bind(null,e,Mr,hs),r);break}xa(e,Mr,hs);break;case 5:xa(e,Mr,hs);break;default:throw Error(je(329))}}}return Ur(e,In()),e.callbackNode===n?Ky.bind(null,e):null}function Ff(e,t){var n=jc;return e.current.memoizedState.isDehydrated&&(Da(e,t).flags|=256),e=bd(e,t),e!==2&&(t=Mr,Mr=n,t!==null&&Df(t)),e}function Df(e){Mr===null?Mr=e:Mr.push.apply(Mr,e)}function a4(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Di(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qs(e,t){for(t&=~Vm,t&=~$d,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ri(t),r=1<<n;e[n]=-1,t&=~r}}function Uv(e){if(Vt&6)throw Error(je(327));xo();var t=nd(e,0);if(!(t&1))return Ur(e,In()),null;var n=bd(e,t);if(e.tag!==0&&n===2){var r=rf(e);r!==0&&(t=r,n=Ff(e,r))}if(n===1)throw n=rl,Da(e,0),qs(e,t),Ur(e,In()),n;if(n===6)throw Error(je(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xa(e,Mr,hs),Ur(e,In()),null}function zm(e,t){var n=Vt;Vt|=1;try{return e(t)}finally{Vt=n,Vt===0&&(Fo=In()+500,Vd&&ca())}}function Ha(e){$s!==null&&$s.tag===0&&!(Vt&6)&&xo();var t=Vt;Vt|=1;var n=di.transition,r=Qt;try{if(di.transition=null,Qt=1,e)return e()}finally{Qt=r,di.transition=n,Vt=t,!(Vt&6)&&ca()}}function Km(){$r=fo.current,un(fo)}function Da(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Mw(n)),jn!==null)for(n=jn.return;n!==null;){var r=n;switch(Em(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&od();break;case 3:Ao(),un(jr),un(pr),Nm();break;case 5:Dm(r);break;case 4:Ao();break;case 13:un(_n);break;case 19:un(_n);break;case 10:Rm(r.type._context);break;case 22:case 23:Km()}n=n.return}if(Gn=e,jn=e=ea(e.current,null),nr=$r=t,qn=0,rl=null,Vm=$d=Ua=0,Mr=jc=null,ka!==null){for(t=0;t<ka.length;t++)if(n=ka[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}ka=null}return e}function $y(e,t){do{var n=jn;try{if(Tm(),Iu.current=gd,md){for(var r=bn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}md=!1}if(Ba=0,Wn=Vn=bn=null,Mc=!1,el=0,Hm.current=null,n===null||n.return===null){qn=1,rl=t,jn=null;break}e:{var a=e,o=n.return,u=n,p=t;if(t=nr,u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var h=p,g=u,f=g.tag;if(!(g.mode&1)&&(f===0||f===11||f===15)){var _=g.alternate;_?(g.updateQueue=_.updateQueue,g.memoizedState=_.memoizedState,g.lanes=_.lanes):(g.updateQueue=null,g.memoizedState=null)}var w=kv(o);if(w!==null){w.flags&=-257,Tv(w,o,u,a,t),w.mode&1&&Pv(a,h,t),t=w,p=h;var C=t.updateQueue;if(C===null){var R=new Set;R.add(p),t.updateQueue=R}else C.add(p);break e}else{if(!(t&1)){Pv(a,h,t),$m();break e}p=Error(je(426))}}else if(hn&&u.mode&1){var S=kv(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Tv(S,o,u,a,t),Pm(Io(p,u));break e}}a=p=Io(p,u),qn!==4&&(qn=2),jc===null?jc=[a]:jc.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var b=Ry(a,p,t);bv(a,b);break e;case 1:u=p;var x=a.type,E=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Qs===null||!Qs.has(E)))){a.flags|=65536,t&=-t,a.lanes|=t;var M=Ay(a,u,t);bv(a,M);break e}}a=a.return}while(a!==null)}Jy(n)}catch(Z){t=Z,jn===n&&n!==null&&(jn=n=n.return);continue}break}while(!0)}function Wy(){var e=vd.current;return vd.current=gd,e===null?gd:e}function $m(){(qn===0||qn===3||qn===2)&&(qn=4),Gn===null||!(Ua&268435455)&&!($d&268435455)||qs(Gn,nr)}function bd(e,t){var n=Vt;Vt|=2;var r=Wy();(Gn!==e||nr!==t)&&(hs=null,Da(e,t));do try{o4();break}catch(i){$y(e,i)}while(!0);if(Tm(),Vt=n,vd.current=r,jn!==null)throw Error(je(261));return Gn=null,nr=0,qn}function o4(){for(;jn!==null;)Gy(jn)}function c4(){for(;jn!==null&&!DS();)Gy(jn)}function Gy(e){var t=Xy(e.alternate,e,$r);e.memoizedProps=e.pendingProps,t===null?Jy(e):jn=t,Hm.current=null}function Jy(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=t4(n,t),n!==null){n.flags&=32767,jn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{qn=6,jn=null;return}}else if(n=e4(n,t,$r),n!==null){jn=n;return}if(t=t.sibling,t!==null){jn=t;return}jn=t=e}while(t!==null);qn===0&&(qn=5)}function xa(e,t,n){var r=Qt,i=di.transition;try{di.transition=null,Qt=1,l4(e,t,n,r)}finally{di.transition=i,Qt=r}return null}function l4(e,t,n,r){do xo();while($s!==null);if(Vt&6)throw Error(je(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(je(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(qS(e,a),e===Gn&&(jn=Gn=null,nr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fu||(fu=!0,Qy(td,function(){return xo(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=di.transition,di.transition=null;var o=Qt;Qt=1;var u=Vt;Vt|=4,Hm.current=null,r4(e,n),qy(n,e),Rw(uf),rd=!!lf,uf=lf=null,e.current=n,i4(n),NS(),Vt=u,Qt=o,di.transition=a}else e.current=n;if(fu&&(fu=!1,$s=e,_d=i),a=e.pendingLanes,a===0&&(Qs=null),LS(n.stateNode),Ur(e,In()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(yd)throw yd=!1,e=Af,Af=null,e;return _d&1&&e.tag!==0&&xo(),a=e.pendingLanes,a&1?e===If?Bc++:(Bc=0,If=e):Bc=0,ca(),null}function xo(){if($s!==null){var e=R0(_d),t=di.transition,n=Qt;try{if(di.transition=null,Qt=16>e?16:e,$s===null)var r=!1;else{if(e=$s,$s=null,_d=0,Vt&6)throw Error(je(331));var i=Vt;for(Vt|=4,Ge=e.current;Ge!==null;){var a=Ge,o=a.child;if(Ge.flags&16){var u=a.deletions;if(u!==null){for(var p=0;p<u.length;p++){var h=u[p];for(Ge=h;Ge!==null;){var g=Ge;switch(g.tag){case 0:case 11:case 15:Lc(8,g,a)}var f=g.child;if(f!==null)f.return=g,Ge=f;else for(;Ge!==null;){g=Ge;var _=g.sibling,w=g.return;if(Uy(g),g===h){Ge=null;break}if(_!==null){_.return=w,Ge=_;break}Ge=w}}}var C=a.alternate;if(C!==null){var R=C.child;if(R!==null){C.child=null;do{var S=R.sibling;R.sibling=null,R=S}while(R!==null)}}Ge=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Ge=o;else e:for(;Ge!==null;){if(a=Ge,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Lc(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,Ge=b;break e}Ge=a.return}}var x=e.current;for(Ge=x;Ge!==null;){o=Ge;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,Ge=E;else e:for(o=x;Ge!==null;){if(u=Ge,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Kd(9,u)}}catch(Z){kn(u,u.return,Z)}if(u===o){Ge=null;break e}var M=u.sibling;if(M!==null){M.return=u.return,Ge=M;break e}Ge=u.return}}if(Vt=i,ca(),Xi&&typeof Xi.onPostCommitFiberRoot=="function")try{Xi.onPostCommitFiberRoot(Ld,e)}catch{}r=!0}return r}finally{Qt=n,di.transition=t}}return!1}function Hv(e,t,n){t=Io(n,t),t=Ry(e,t,1),e=Xs(e,t,1),t=Er(),e!==null&&(wl(e,1,t),Ur(e,t))}function kn(e,t,n){if(e.tag===3)Hv(e,e,n);else for(;t!==null;){if(t.tag===3){Hv(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Qs===null||!Qs.has(r))){e=Io(n,e),e=Ay(t,e,1),t=Xs(t,e,1),e=Er(),t!==null&&(wl(t,1,e),Ur(t,e));break}}t=t.return}}function u4(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Er(),e.pingedLanes|=e.suspendedLanes&n,Gn===e&&(nr&n)===n&&(qn===4||qn===3&&(nr&130023424)===nr&&500>In()-qm?Da(e,0):Vm|=n),Ur(e,t)}function Zy(e,t){t===0&&(e.mode&1?(t=iu,iu<<=1,!(iu&130023424)&&(iu=4194304)):t=1);var n=Er();e=bs(e,t),e!==null&&(wl(e,t,n),Ur(e,n))}function d4(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Zy(e,n)}function h4(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(je(314))}r!==null&&r.delete(t),Zy(e,n)}var Xy;Xy=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||jr.current)Lr=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Lr=!1,Yw(e,t,n);Lr=!!(e.flags&131072)}else Lr=!1,hn&&t.flags&1048576&&ty(t,ud,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Du(e,t),e=t.pendingProps;var i=ko(t,pr.current);wo(t,n),i=Mm(null,t,r,e,i,n);var a=Lm();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Br(r)?(a=!0,cd(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Im(t),i.updater=zd,t.stateNode=i,i._reactInternals=t,_f(t,r,e,n),t=wf(null,t,r,!0,a,n)):(t.tag=0,hn&&a&&Cm(t),Sr(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Du(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=f4(r),e=xi(r,e),i){case 0:t=Sf(null,t,r,e,n);break e;case 1:t=Iv(null,t,r,e,n);break e;case 11:t=Rv(null,t,r,e,n);break e;case 14:t=Av(null,t,r,xi(r.type,e),n);break e}throw Error(je(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xi(r,i),Sf(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xi(r,i),Iv(e,t,r,i,n);case 3:e:{if(Ny(t),e===null)throw Error(je(387));r=t.pendingProps,a=t.memoizedState,i=a.element,oy(e,t),pd(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Io(Error(je(423)),t),t=Fv(e,t,r,n,i);break e}else if(r!==i){i=Io(Error(je(424)),t),t=Fv(e,t,r,n,i);break e}else for(Gr=Zs(t.stateNode.containerInfo.firstChild),Jr=t,hn=!0,Pi=null,n=sy(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(To(),r===i){t=Ss(e,t,n);break e}Sr(e,t,r,n)}t=t.child}return t;case 5:return cy(t),e===null&&gf(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,df(r,i)?o=null:a!==null&&df(r,a)&&(t.flags|=32),Dy(e,t),Sr(e,t,o,n),t.child;case 6:return e===null&&gf(t),null;case 13:return Oy(e,t,n);case 4:return Fm(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ro(t,null,r,n):Sr(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xi(r,i),Rv(e,t,r,i,n);case 7:return Sr(e,t,t.pendingProps,n),t.child;case 8:return Sr(e,t,t.pendingProps.children,n),t.child;case 12:return Sr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,rn(dd,r._currentValue),r._currentValue=o,a!==null)if(Di(a.value,o)){if(a.children===i.children&&!jr.current){t=Ss(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var u=a.dependencies;if(u!==null){o=a.child;for(var p=u.firstContext;p!==null;){if(p.context===r){if(a.tag===1){p=vs(-1,n&-n),p.tag=2;var h=a.updateQueue;if(h!==null){h=h.shared;var g=h.pending;g===null?p.next=p:(p.next=g.next,g.next=p),h.pending=p}}a.lanes|=n,p=a.alternate,p!==null&&(p.lanes|=n),vf(a.return,n,t),u.lanes|=n;break}p=p.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(je(341));o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),vf(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Sr(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,wo(t,n),i=hi(i),r=r(i),t.flags|=1,Sr(e,t,r,n),t.child;case 14:return r=t.type,i=xi(r,t.pendingProps),i=xi(r.type,i),Av(e,t,r,i,n);case 15:return Iy(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xi(r,i),Du(e,t),t.tag=1,Br(r)?(e=!0,cd(t)):e=!1,wo(t,n),Ty(t,r,i),_f(t,r,i,n),wf(null,t,r,!0,e,n);case 19:return My(e,t,n);case 22:return Fy(e,t,n)}throw Error(je(156,t.tag))};function Qy(e,t){return E0(e,t)}function p4(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(e,t,n,r){return new p4(e,t,n,r)}function Wm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function f4(e){if(typeof e=="function")return Wm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===hm)return 11;if(e===pm)return 14}return 2}function ea(e,t){var n=e.alternate;return n===null?(n=ui(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mu(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")Wm(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ro:return Na(n.children,i,a,t);case dm:o=8,i|=8;break;case Vp:return e=ui(12,n,t,i|2),e.elementType=Vp,e.lanes=a,e;case qp:return e=ui(13,n,t,i),e.elementType=qp,e.lanes=a,e;case zp:return e=ui(19,n,t,i),e.elementType=zp,e.lanes=a,e;case c0:return Wd(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case a0:o=10;break e;case o0:o=9;break e;case hm:o=11;break e;case pm:o=14;break e;case Us:o=16,r=null;break e}throw Error(je(130,e==null?e:typeof e,""))}return t=ui(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function Na(e,t,n,r){return e=ui(7,e,r,t),e.lanes=n,e}function Wd(e,t,n,r){return e=ui(22,e,r,t),e.elementType=c0,e.lanes=n,e.stateNode={isHidden:!1},e}function bp(e,t,n){return e=ui(6,e,null,t),e.lanes=n,e}function Sp(e,t,n){return t=ui(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function m4(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tp(0),this.expirationTimes=tp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Gm(e,t,n,r,i,a,o,u,p){return e=new m4(e,t,n,u,p),t===1?(t=1,a===!0&&(t|=8)):t=0,a=ui(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Im(a),e}function g4(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:no,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Yy(e){if(!e)return na;e=e._reactInternals;e:{if($a(e)!==e||e.tag!==1)throw Error(je(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Br(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(je(171))}if(e.tag===1){var n=e.type;if(Br(n))return Y0(e,n,t)}return t}function e_(e,t,n,r,i,a,o,u,p){return e=Gm(n,r,!0,e,i,a,o,u,p),e.context=Yy(null),n=e.current,r=Er(),i=Ys(n),a=vs(r,i),a.callback=t??null,Xs(n,a,i),e.current.lanes=i,wl(e,i,r),Ur(e,r),e}function Gd(e,t,n,r){var i=t.current,a=Er(),o=Ys(i);return n=Yy(n),t.context===null?t.context=n:t.pendingContext=n,t=vs(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Xs(i,t,o),e!==null&&(Ai(e,i,o,a),Au(e,i,o)),o}function Sd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vv(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Jm(e,t){Vv(e,t),(e=e.alternate)&&Vv(e,t)}function v4(){return null}var t_=typeof reportError=="function"?reportError:function(e){console.error(e)};function Zm(e){this._internalRoot=e}Jd.prototype.render=Zm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(je(409));Gd(e,t,null,null)};Jd.prototype.unmount=Zm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ha(function(){Gd(null,e,null,null)}),t[_s]=null}};function Jd(e){this._internalRoot=e}Jd.prototype.unstable_scheduleHydration=function(e){if(e){var t=F0();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Vs.length&&t!==0&&t<Vs[n].priority;n++);Vs.splice(n,0,e),n===0&&N0(e)}};function Xm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Zd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function qv(){}function y4(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var h=Sd(o);a.call(h)}}var o=e_(t,r,e,0,null,!1,!1,"",qv);return e._reactRootContainer=o,e[_s]=o.current,Jc(e.nodeType===8?e.parentNode:e),Ha(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var h=Sd(p);u.call(h)}}var p=Gm(e,0,!1,null,null,!1,!1,"",qv);return e._reactRootContainer=p,e[_s]=p.current,Jc(e.nodeType===8?e.parentNode:e),Ha(function(){Gd(t,p,n,r)}),p}function Xd(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var u=i;i=function(){var p=Sd(o);u.call(p)}}Gd(t,o,e,i)}else o=y4(n,t,e,i,r);return Sd(o)}A0=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Tc(t.pendingLanes);n!==0&&(gm(t,n|1),Ur(t,In()),!(Vt&6)&&(Fo=In()+500,ca()))}break;case 13:Ha(function(){var r=bs(e,1);if(r!==null){var i=Er();Ai(r,e,1,i)}}),Jm(e,1)}};vm=function(e){if(e.tag===13){var t=bs(e,134217728);if(t!==null){var n=Er();Ai(t,e,134217728,n)}Jm(e,134217728)}};I0=function(e){if(e.tag===13){var t=Ys(e),n=bs(e,t);if(n!==null){var r=Er();Ai(n,e,t,r)}Jm(e,t)}};F0=function(){return Qt};D0=function(e,t){var n=Qt;try{return Qt=e,t()}finally{Qt=n}};ef=function(e,t,n){switch(t){case"input":if(Wp(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Hd(r);if(!i)throw Error(je(90));u0(r),Wp(r,i)}}}break;case"textarea":h0(e,n);break;case"select":t=n.value,t!=null&&yo(e,!!n.multiple,t,!1)}};_0=zm;b0=Ha;var _4={usingClientEntryPoint:!1,Events:[Cl,oo,Hd,v0,y0,zm]},gc={findFiberByHostInstance:Pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},b4={bundleType:gc.bundleType,version:gc.version,rendererPackageName:gc.rendererPackageName,rendererConfig:gc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=x0(e),e===null?null:e.stateNode},findFiberByHostInstance:gc.findFiberByHostInstance||v4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mu.isDisabled&&mu.supportsFiber)try{Ld=mu.inject(b4),Xi=mu}catch{}}Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_4;Xr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xm(t))throw Error(je(200));return g4(e,t,null,n)};Xr.createRoot=function(e,t){if(!Xm(e))throw Error(je(299));var n=!1,r="",i=t_;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Gm(e,1,!1,null,null,n,!1,r,i),e[_s]=t.current,Jc(e.nodeType===8?e.parentNode:e),new Zm(t)};Xr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(je(188)):(e=Object.keys(e).join(","),Error(je(268,e)));return e=x0(t),e=e===null?null:e.stateNode,e};Xr.flushSync=function(e){return Ha(e)};Xr.hydrate=function(e,t,n){if(!Zd(t))throw Error(je(200));return Xd(null,e,t,!0,n)};Xr.hydrateRoot=function(e,t,n){if(!Xm(e))throw Error(je(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=t_;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=e_(t,null,e,1,n??null,i,!1,a,o),e[_s]=t.current,Jc(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Jd(t)};Xr.render=function(e,t,n){if(!Zd(t))throw Error(je(200));return Xd(null,e,t,!1,n)};Xr.unmountComponentAtNode=function(e){if(!Zd(e))throw Error(je(40));return e._reactRootContainer?(Ha(function(){Xd(null,null,e,!1,function(){e._reactRootContainer=null,e[_s]=null})}),!0):!1};Xr.unstable_batchedUpdates=zm;Xr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zd(n))throw Error(je(200));if(e==null||e._reactInternals===void 0)throw Error(je(38));return Xd(e,t,n,!1,r)};Xr.version="18.3.1-next-f1338f8080-20240426";function n_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n_)}catch(e){console.error(e)}}n_(),$1.exports=Xr;var S4=$1.exports,r_,zv=S4;r_=zv.createRoot,zv.hydrateRoot;(function(){function e(K){var ee=0;return function(){return ee<K.length?{done:!1,value:K[ee++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(K,ee,oe){return K==Array.prototype||K==Object.prototype||(K[ee]=oe.value),K};function n(K){K=[typeof globalThis=="object"&&globalThis,K,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ti=="object"&&Ti];for(var ee=0;ee<K.length;++ee){var oe=K[ee];if(oe&&oe.Math==Math)return oe}throw Error("Cannot find global object")}var r=n(this);function i(K,ee){if(ee)e:{var oe=r;K=K.split(".");for(var ce=0;ce<K.length-1;ce++){var ne=K[ce];if(!(ne in oe))break e;oe=oe[ne]}K=K[K.length-1],ce=oe[K],ee=ee(ce),ee!=ce&&ee!=null&&t(oe,K,{configurable:!0,writable:!0,value:ee})}}i("Symbol",function(K){function ee(ke){if(this instanceof ee)throw new TypeError("Symbol is not a constructor");return new oe(ce+(ke||"")+"_"+ne++,ke)}function oe(ke,_e){this.g=ke,t(this,"description",{configurable:!0,writable:!0,value:_e})}if(K)return K;oe.prototype.toString=function(){return this.g};var ce="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ne=0;return ee}),i("Symbol.iterator",function(K){if(K)return K;K=Symbol("Symbol.iterator");for(var ee="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),oe=0;oe<ee.length;oe++){var ce=r[ee[oe]];typeof ce=="function"&&typeof ce.prototype[K]!="function"&&t(ce.prototype,K,{configurable:!0,writable:!0,value:function(){return a(e(this))}})}return K});function a(K){return K={next:K},K[Symbol.iterator]=function(){return this},K}function o(K){var ee=typeof Symbol<"u"&&Symbol.iterator&&K[Symbol.iterator];return ee?ee.call(K):{next:e(K)}}function u(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function p(K){if(K.i)throw new TypeError("Generator is already running");K.i=!0}u.prototype.l=function(K){this.o=K};function h(K,ee){K.h={F:ee,G:!0},K.j=K.m}u.prototype.return=function(K){this.h={return:K},this.j=this.m};function g(K){this.g=new u,this.h=K}function f(K,ee){p(K.g);var oe=K.g.g;return oe?_(K,"return"in oe?oe.return:function(ce){return{value:ce,done:!0}},ee,K.g.return):(K.g.return(ee),w(K))}function _(K,ee,oe,ce){try{var ne=ee.call(K.g.g,oe);if(!(ne instanceof Object))throw new TypeError("Iterator result "+ne+" is not an object");if(!ne.done)return K.g.i=!1,ne;var ke=ne.value}catch(_e){return K.g.g=null,h(K.g,_e),w(K)}return K.g.g=null,ce.call(K.g,ke),w(K)}function w(K){for(;K.g.j;)try{var ee=K.h(K.g);if(ee)return K.g.i=!1,{value:ee.value,done:!1}}catch(oe){K.g.o=void 0,h(K.g,oe)}if(K.g.i=!1,K.g.h){if(ee=K.g.h,K.g.h=null,ee.G)throw ee.F;return{value:ee.return,done:!0}}return{value:void 0,done:!0}}function C(K){this.next=function(ee){return p(K.g),K.g.g?ee=_(K,K.g.g.next,ee,K.g.l):(K.g.l(ee),ee=w(K)),ee},this.throw=function(ee){return p(K.g),K.g.g?ee=_(K,K.g.g.throw,ee,K.g.l):(h(K.g,ee),ee=w(K)),ee},this.return=function(ee){return f(K,ee)},this[Symbol.iterator]=function(){return this}}function R(K){function ee(ce){return K.next(ce)}function oe(ce){return K.throw(ce)}return new Promise(function(ce,ne){function ke(_e){_e.done?ce(_e.value):Promise.resolve(_e.value).then(ee,oe).then(ke,ne)}ke(K.next())})}i("Promise",function(K){function ee(_e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var le=this.j();try{_e(le.resolve,le.reject)}catch(fe){le.reject(fe)}}function oe(){this.g=null}function ce(_e){return _e instanceof ee?_e:new ee(function(le){le(_e)})}if(K)return K;oe.prototype.h=function(_e){if(this.g==null){this.g=[];var le=this;this.i(function(){le.l()})}this.g.push(_e)};var ne=r.setTimeout;oe.prototype.i=function(_e){ne(_e,0)},oe.prototype.l=function(){for(;this.g&&this.g.length;){var _e=this.g;this.g=[];for(var le=0;le<_e.length;++le){var fe=_e[le];_e[le]=null;try{fe()}catch(ge){this.j(ge)}}}this.g=null},oe.prototype.j=function(_e){this.i(function(){throw _e})},ee.prototype.j=function(){function _e(ge){return function(Ee){fe||(fe=!0,ge.call(le,Ee))}}var le=this,fe=!1;return{resolve:_e(this.A),reject:_e(this.l)}},ee.prototype.A=function(_e){if(_e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(_e instanceof ee)this.C(_e);else{e:switch(typeof _e){case"object":var le=_e!=null;break e;case"function":le=!0;break e;default:le=!1}le?this.v(_e):this.m(_e)}},ee.prototype.v=function(_e){var le=void 0;try{le=_e.then}catch(fe){this.l(fe);return}typeof le=="function"?this.D(le,_e):this.m(_e)},ee.prototype.l=function(_e){this.u(2,_e)},ee.prototype.m=function(_e){this.u(1,_e)},ee.prototype.u=function(_e,le){if(this.h!=0)throw Error("Cannot settle("+_e+", "+le+"): Promise already settled in state"+this.h);this.h=_e,this.i=le,this.h===2&&this.B(),this.H()},ee.prototype.B=function(){var _e=this;ne(function(){if(_e.I()){var le=r.console;typeof le<"u"&&le.error(_e.i)}},1)},ee.prototype.I=function(){if(this.o)return!1;var _e=r.CustomEvent,le=r.Event,fe=r.dispatchEvent;return typeof fe>"u"?!0:(typeof _e=="function"?_e=new _e("unhandledrejection",{cancelable:!0}):typeof le=="function"?_e=new le("unhandledrejection",{cancelable:!0}):(_e=r.document.createEvent("CustomEvent"),_e.initCustomEvent("unhandledrejection",!1,!0,_e)),_e.promise=this,_e.reason=this.i,fe(_e))},ee.prototype.H=function(){if(this.g!=null){for(var _e=0;_e<this.g.length;++_e)ke.h(this.g[_e]);this.g=null}};var ke=new oe;return ee.prototype.C=function(_e){var le=this.j();_e.s(le.resolve,le.reject)},ee.prototype.D=function(_e,le){var fe=this.j();try{_e.call(le,fe.resolve,fe.reject)}catch(ge){fe.reject(ge)}},ee.prototype.then=function(_e,le){function fe(Je,ut){return typeof Je=="function"?function(ot){try{ge(Je(ot))}catch(nt){Ee(nt)}}:ut}var ge,Ee,Oe=new ee(function(Je,ut){ge=Je,Ee=ut});return this.s(fe(_e,ge),fe(le,Ee)),Oe},ee.prototype.catch=function(_e){return this.then(void 0,_e)},ee.prototype.s=function(_e,le){function fe(){switch(ge.h){case 1:_e(ge.i);break;case 2:le(ge.i);break;default:throw Error("Unexpected state: "+ge.h)}}var ge=this;this.g==null?ke.h(fe):this.g.push(fe),this.o=!0},ee.resolve=ce,ee.reject=function(_e){return new ee(function(le,fe){fe(_e)})},ee.race=function(_e){return new ee(function(le,fe){for(var ge=o(_e),Ee=ge.next();!Ee.done;Ee=ge.next())ce(Ee.value).s(le,fe)})},ee.all=function(_e){var le=o(_e),fe=le.next();return fe.done?ce([]):new ee(function(ge,Ee){function Oe(ot){return function(nt){Je[ot]=nt,ut--,ut==0&&ge(Je)}}var Je=[],ut=0;do Je.push(void 0),ut++,ce(fe.value).s(Oe(Je.length-1),Ee),fe=le.next();while(!fe.done)})},ee});var S=typeof Object.assign=="function"?Object.assign:function(K,ee){for(var oe=1;oe<arguments.length;oe++){var ce=arguments[oe];if(ce)for(var ne in ce)Object.prototype.hasOwnProperty.call(ce,ne)&&(K[ne]=ce[ne])}return K};i("Object.assign",function(K){return K||S});var b=this||self,x={facingMode:"user",width:640,height:480};function E(K,ee){this.video=K,this.i=0,this.h=Object.assign(Object.assign({},x),ee)}E.prototype.stop=function(){var K=this,ee,oe,ce,ne;return R(new C(new g(function(ke){if(K.g){for(ee=K.g.getTracks(),oe=o(ee),ce=oe.next();!ce.done;ce=oe.next())ne=ce.value,ne.stop();K.g=void 0}ke.j=0})))},E.prototype.start=function(){var K=this,ee;return R(new C(new g(function(oe){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),ee=K.h,oe.return(navigator.mediaDevices.getUserMedia({video:{facingMode:ee.facingMode,width:ee.width,height:ee.height}}).then(function(ce){Z(K,ce)}).catch(function(ce){var ne="Failed to acquire camera feed: "+ce;throw console.error(ne),alert(ne),ce}))})))};function M(K){window.requestAnimationFrame(function(){$(K)})}function Z(K,ee){K.g=ee,K.video.srcObject=ee,K.video.onloadedmetadata=function(){K.video.play(),M(K)}}function $(K){var ee=null;K.video.paused||K.video.currentTime===K.i||(K.i=K.video.currentTime,ee=K.h.onFrame()),ee?ee.then(function(){M(K)}):M(K)}var z=["Camera"],q=b;z[0]in q||typeof q.execScript>"u"||q.execScript("var "+z[0]);for(var Q;z.length&&(Q=z.shift());)z.length||E===void 0?q[Q]&&q[Q]!==Object.prototype[Q]?q=q[Q]:q=q[Q]={}:q[Q]=E}).call(Ti);var w4=Camera;(function(){var e;function t(I){var B=0;return function(){return B<I.length?{done:!1,value:I[B++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(I,B,V){return I==Array.prototype||I==Object.prototype||(I[B]=V.value),I};function r(I){I=[typeof globalThis=="object"&&globalThis,I,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ti=="object"&&Ti];for(var B=0;B<I.length;++B){var V=I[B];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")}var i=r(this);function a(I,B){if(B)e:{var V=i;I=I.split(".");for(var ae=0;ae<I.length-1;ae++){var be=I[ae];if(!(be in V))break e;V=V[be]}I=I[I.length-1],ae=V[I],B=B(ae),B!=ae&&B!=null&&n(V,I,{configurable:!0,writable:!0,value:B})}}a("Symbol",function(I){function B(we){if(this instanceof B)throw new TypeError("Symbol is not a constructor");return new V(ae+(we||"")+"_"+be++,we)}function V(we,Pe){this.g=we,n(this,"description",{configurable:!0,writable:!0,value:Pe})}if(I)return I;V.prototype.toString=function(){return this.g};var ae="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",be=0;return B}),a("Symbol.iterator",function(I){if(I)return I;I=Symbol("Symbol.iterator");for(var B="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),V=0;V<B.length;V++){var ae=i[B[V]];typeof ae=="function"&&typeof ae.prototype[I]!="function"&&n(ae.prototype,I,{configurable:!0,writable:!0,value:function(){return o(t(this))}})}return I});function o(I){return I={next:I},I[Symbol.iterator]=function(){return this},I}function u(I){var B=typeof Symbol<"u"&&Symbol.iterator&&I[Symbol.iterator];return B?B.call(I):{next:t(I)}}function p(I){if(!(I instanceof Array)){I=u(I);for(var B,V=[];!(B=I.next()).done;)V.push(B.value);I=V}return I}var h=typeof Object.create=="function"?Object.create:function(I){function B(){}return B.prototype=I,new B},g;if(typeof Object.setPrototypeOf=="function")g=Object.setPrototypeOf;else{var f;e:{var _={a:!0},w={};try{w.__proto__=_,f=w.a;break e}catch{}f=!1}g=f?function(I,B){if(I.__proto__=B,I.__proto__!==B)throw new TypeError(I+" is not extensible");return I}:null}var C=g;function R(I,B){if(I.prototype=h(B.prototype),I.prototype.constructor=I,C)C(I,B);else for(var V in B)if(V!="prototype")if(Object.defineProperties){var ae=Object.getOwnPropertyDescriptor(B,V);ae&&Object.defineProperty(I,V,ae)}else I[V]=B[V];I.ea=B.prototype}function S(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function b(I){if(I.l)throw new TypeError("Generator is already running");I.l=!0}S.prototype.o=function(I){this.h=I};function x(I,B){I.j={U:B,V:!0},I.g=I.m||I.s}S.prototype.return=function(I){this.j={return:I},this.g=this.s};function E(I,B,V){return I.g=V,{value:B}}function M(I){this.g=new S,this.h=I}function Z(I,B){b(I.g);var V=I.g.i;return V?$(I,"return"in V?V.return:function(ae){return{value:ae,done:!0}},B,I.g.return):(I.g.return(B),z(I))}function $(I,B,V,ae){try{var be=B.call(I.g.i,V);if(!(be instanceof Object))throw new TypeError("Iterator result "+be+" is not an object");if(!be.done)return I.g.l=!1,be;var we=be.value}catch(Pe){return I.g.i=null,x(I.g,Pe),z(I)}return I.g.i=null,ae.call(I.g,we),z(I)}function z(I){for(;I.g.g;)try{var B=I.h(I.g);if(B)return I.g.l=!1,{value:B.value,done:!1}}catch(V){I.g.h=void 0,x(I.g,V)}if(I.g.l=!1,I.g.j){if(B=I.g.j,I.g.j=null,B.V)throw B.U;return{value:B.return,done:!0}}return{value:void 0,done:!0}}function q(I){this.next=function(B){return b(I.g),I.g.i?B=$(I,I.g.i.next,B,I.g.o):(I.g.o(B),B=z(I)),B},this.throw=function(B){return b(I.g),I.g.i?B=$(I,I.g.i.throw,B,I.g.o):(x(I.g,B),B=z(I)),B},this.return=function(B){return Z(I,B)},this[Symbol.iterator]=function(){return this}}function Q(I,B){return B=new q(new M(B)),C&&I.prototype&&C(B,I.prototype),B}function K(I,B){I instanceof String&&(I+="");var V=0,ae=!1,be={next:function(){if(!ae&&V<I.length){var we=V++;return{value:B(we,I[we]),done:!1}}return ae=!0,{done:!0,value:void 0}}};return be[Symbol.iterator]=function(){return be},be}var ee=typeof Object.assign=="function"?Object.assign:function(I,B){for(var V=1;V<arguments.length;V++){var ae=arguments[V];if(ae)for(var be in ae)Object.prototype.hasOwnProperty.call(ae,be)&&(I[be]=ae[be])}return I};a("Object.assign",function(I){return I||ee}),a("Promise",function(I){function B(Pe){this.h=0,this.i=void 0,this.g=[],this.o=!1;var Ie=this.j();try{Pe(Ie.resolve,Ie.reject)}catch(Be){Ie.reject(Be)}}function V(){this.g=null}function ae(Pe){return Pe instanceof B?Pe:new B(function(Ie){Ie(Pe)})}if(I)return I;V.prototype.h=function(Pe){if(this.g==null){this.g=[];var Ie=this;this.i(function(){Ie.l()})}this.g.push(Pe)};var be=i.setTimeout;V.prototype.i=function(Pe){be(Pe,0)},V.prototype.l=function(){for(;this.g&&this.g.length;){var Pe=this.g;this.g=[];for(var Ie=0;Ie<Pe.length;++Ie){var Be=Pe[Ie];Pe[Ie]=null;try{Be()}catch(Ke){this.j(Ke)}}}this.g=null},V.prototype.j=function(Pe){this.i(function(){throw Pe})},B.prototype.j=function(){function Pe(Ke){return function(dt){Be||(Be=!0,Ke.call(Ie,dt))}}var Ie=this,Be=!1;return{resolve:Pe(this.C),reject:Pe(this.l)}},B.prototype.C=function(Pe){if(Pe===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(Pe instanceof B)this.F(Pe);else{e:switch(typeof Pe){case"object":var Ie=Pe!=null;break e;case"function":Ie=!0;break e;default:Ie=!1}Ie?this.u(Pe):this.m(Pe)}},B.prototype.u=function(Pe){var Ie=void 0;try{Ie=Pe.then}catch(Be){this.l(Be);return}typeof Ie=="function"?this.G(Ie,Pe):this.m(Pe)},B.prototype.l=function(Pe){this.s(2,Pe)},B.prototype.m=function(Pe){this.s(1,Pe)},B.prototype.s=function(Pe,Ie){if(this.h!=0)throw Error("Cannot settle("+Pe+", "+Ie+"): Promise already settled in state"+this.h);this.h=Pe,this.i=Ie,this.h===2&&this.D(),this.A()},B.prototype.D=function(){var Pe=this;be(function(){if(Pe.B()){var Ie=i.console;typeof Ie<"u"&&Ie.error(Pe.i)}},1)},B.prototype.B=function(){if(this.o)return!1;var Pe=i.CustomEvent,Ie=i.Event,Be=i.dispatchEvent;return typeof Be>"u"?!0:(typeof Pe=="function"?Pe=new Pe("unhandledrejection",{cancelable:!0}):typeof Ie=="function"?Pe=new Ie("unhandledrejection",{cancelable:!0}):(Pe=i.document.createEvent("CustomEvent"),Pe.initCustomEvent("unhandledrejection",!1,!0,Pe)),Pe.promise=this,Pe.reason=this.i,Be(Pe))},B.prototype.A=function(){if(this.g!=null){for(var Pe=0;Pe<this.g.length;++Pe)we.h(this.g[Pe]);this.g=null}};var we=new V;return B.prototype.F=function(Pe){var Ie=this.j();Pe.J(Ie.resolve,Ie.reject)},B.prototype.G=function(Pe,Ie){var Be=this.j();try{Pe.call(Ie,Be.resolve,Be.reject)}catch(Ke){Be.reject(Ke)}},B.prototype.then=function(Pe,Ie){function Be(tt,gt){return typeof tt=="function"?function(Ye){try{Ke(tt(Ye))}catch(ht){dt(ht)}}:gt}var Ke,dt,qt=new B(function(tt,gt){Ke=tt,dt=gt});return this.J(Be(Pe,Ke),Be(Ie,dt)),qt},B.prototype.catch=function(Pe){return this.then(void 0,Pe)},B.prototype.J=function(Pe,Ie){function Be(){switch(Ke.h){case 1:Pe(Ke.i);break;case 2:Ie(Ke.i);break;default:throw Error("Unexpected state: "+Ke.h)}}var Ke=this;this.g==null?we.h(Be):this.g.push(Be),this.o=!0},B.resolve=ae,B.reject=function(Pe){return new B(function(Ie,Be){Be(Pe)})},B.race=function(Pe){return new B(function(Ie,Be){for(var Ke=u(Pe),dt=Ke.next();!dt.done;dt=Ke.next())ae(dt.value).J(Ie,Be)})},B.all=function(Pe){var Ie=u(Pe),Be=Ie.next();return Be.done?ae([]):new B(function(Ke,dt){function qt(Ye){return function(ht){tt[Ye]=ht,gt--,gt==0&&Ke(tt)}}var tt=[],gt=0;do tt.push(void 0),gt++,ae(Be.value).J(qt(tt.length-1),dt),Be=Ie.next();while(!Be.done)})},B}),a("Object.is",function(I){return I||function(B,V){return B===V?B!==0||1/B===1/V:B!==B&&V!==V}}),a("Array.prototype.includes",function(I){return I||function(B,V){var ae=this;ae instanceof String&&(ae=String(ae));var be=ae.length;for(V=V||0,0>V&&(V=Math.max(V+be,0));V<be;V++){var we=ae[V];if(we===B||Object.is(we,B))return!0}return!1}}),a("String.prototype.includes",function(I){return I||function(B,V){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(B instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(B,V||0)!==-1}}),a("Array.prototype.keys",function(I){return I||function(){return K(this,function(B){return B})}});var oe=this||self;function ce(I,B){I=I.split(".");var V=oe;I[0]in V||typeof V.execScript>"u"||V.execScript("var "+I[0]);for(var ae;I.length&&(ae=I.shift());)I.length||B===void 0?V[ae]&&V[ae]!==Object.prototype[ae]?V=V[ae]:V=V[ae]={}:V[ae]=B}function ne(I,B){return B=String.fromCharCode.apply(null,B),I==null?B:I+B}var ke,_e=typeof TextDecoder<"u",le,fe=typeof TextEncoder<"u";function ge(I){if(fe)I=(le||(le=new TextEncoder)).encode(I);else{var B=void 0;B=B===void 0?!1:B;for(var V=0,ae=new Uint8Array(3*I.length),be=0;be<I.length;be++){var we=I.charCodeAt(be);if(128>we)ae[V++]=we;else{if(2048>we)ae[V++]=we>>6|192;else{if(55296<=we&&57343>=we){if(56319>=we&&be<I.length){var Pe=I.charCodeAt(++be);if(56320<=Pe&&57343>=Pe){we=1024*(we-55296)+Pe-56320+65536,ae[V++]=we>>18|240,ae[V++]=we>>12&63|128,ae[V++]=we>>6&63|128,ae[V++]=we&63|128;continue}else be--}if(B)throw Error("Found an unpaired surrogate");we=65533}ae[V++]=we>>12|224,ae[V++]=we>>6&63|128}ae[V++]=we&63|128}}I=ae.subarray(0,V)}return I}var Ee={},Oe=null;function Je(I,B){B===void 0&&(B=0),nt(),B=Ee[B];for(var V=Array(Math.floor(I.length/3)),ae=B[64]||"",be=0,we=0;be<I.length-2;be+=3){var Pe=I[be],Ie=I[be+1],Be=I[be+2],Ke=B[Pe>>2];Pe=B[(Pe&3)<<4|Ie>>4],Ie=B[(Ie&15)<<2|Be>>6],Be=B[Be&63],V[we++]=Ke+Pe+Ie+Be}switch(Ke=0,Be=ae,I.length-be){case 2:Ke=I[be+1],Be=B[(Ke&15)<<2]||ae;case 1:I=I[be],V[we]=B[I>>2]+B[(I&3)<<4|Ke>>4]+Be+ae}return V.join("")}function ut(I){var B=I.length,V=3*B/4;V%3?V=Math.floor(V):"=.".indexOf(I[B-1])!=-1&&(V="=.".indexOf(I[B-2])!=-1?V-2:V-1);var ae=new Uint8Array(V),be=0;return ot(I,function(we){ae[be++]=we}),ae.subarray(0,be)}function ot(I,B){function V(Be){for(;ae<I.length;){var Ke=I.charAt(ae++),dt=Oe[Ke];if(dt!=null)return dt;if(!/^[\s\xa0]*$/.test(Ke))throw Error("Unknown base64 encoding at char: "+Ke)}return Be}nt();for(var ae=0;;){var be=V(-1),we=V(0),Pe=V(64),Ie=V(64);if(Ie===64&&be===-1)break;B(be<<2|we>>4),Pe!=64&&(B(we<<4&240|Pe>>2),Ie!=64&&B(Pe<<6&192|Ie))}}function nt(){if(!Oe){Oe={};for(var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),B=["+/=","+/","-_=","-_.","-_"],V=0;5>V;V++){var ae=I.concat(B[V].split(""));Ee[V]=ae;for(var be=0;be<ae.length;be++){var we=ae[be];Oe[we]===void 0&&(Oe[we]=be)}}}}var He=typeof Uint8Array.prototype.slice=="function",Qe;function mt(I,B,V){return B===V?Qe||(Qe=new Uint8Array(0)):He?I.slice(B,V):new Uint8Array(I.subarray(B,V))}var Lt=0,Wt=0;function Fn(I,B){B=B===void 0?{}:B,B=B.v===void 0?!1:B.v,this.h=null,this.g=this.j=this.l=0,this.m=!1,this.v=B,I&&Bi(this,I)}function Bi(I,B){B=B.constructor===Uint8Array?B:B.constructor===ArrayBuffer?new Uint8Array(B):B.constructor===Array?new Uint8Array(B):B.constructor===String?ut(B):B instanceof Uint8Array?new Uint8Array(B.buffer,B.byteOffset,B.byteLength):new Uint8Array(0),I.h=B,I.l=0,I.j=I.h.length,I.g=I.l}Fn.prototype.reset=function(){this.g=this.l};function fr(I){for(var B=128,V=0,ae=0,be=0;4>be&&128<=B;be++)B=I.h[I.g++],V|=(B&127)<<7*be;if(128<=B&&(B=I.h[I.g++],V|=(B&127)<<28,ae|=(B&127)>>4),128<=B)for(be=0;5>be&&128<=B;be++)B=I.h[I.g++],ae|=(B&127)<<7*be+3;if(128>B)return I=V>>>0,B=ae>>>0,(ae=B&2147483648)&&(I=~I+1>>>0,B=~B>>>0,I==0&&(B=B+1>>>0)),I=4294967296*B+(I>>>0),ae?-I:I;I.m=!0}Fn.prototype.i=function(){var I=this.h,B=I[this.g],V=B&127;return 128>B?(this.g+=1,V):(B=I[this.g+1],V|=(B&127)<<7,128>B?(this.g+=2,V):(B=I[this.g+2],V|=(B&127)<<14,128>B?(this.g+=3,V):(B=I[this.g+3],V|=(B&127)<<21,128>B?(this.g+=4,V):(B=I[this.g+4],V|=(B&15)<<28,128>B?(this.g+=5,V>>>0):(this.g+=5,128<=I[this.g++]&&128<=I[this.g++]&&128<=I[this.g++]&&128<=I[this.g++]&&this.g++,V)))))},Fn.prototype.o=function(){var I=this.h[this.g],B=this.h[this.g+1],V=this.h[this.g+2],ae=this.h[this.g+3];return this.g+=4,V=(I<<0|B<<8|V<<16|ae<<24)>>>0,I=2*(V>>31)+1,B=V>>>23&255,V&=8388607,B==255?V?NaN:1/0*I:B==0?I*Math.pow(2,-149)*V:I*Math.pow(2,B-150)*(V+Math.pow(2,23))};var mi=[];function wn(){this.g=new Uint8Array(64),this.h=0}wn.prototype.push=function(I){if(!(this.h+1<this.g.length)){var B=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(B)}this.g[this.h++]=I},wn.prototype.length=function(){return this.h},wn.prototype.end=function(){var I=this.g,B=this.h;return this.h=0,mt(I,0,B)};function mr(I,B){for(;127<B;)I.push(B&127|128),B>>>=7;I.push(B)}function Dn(I){var B={},V=B.N===void 0?!1:B.N;this.o={v:B.v===void 0?!1:B.v},this.N=V,B=this.o,mi.length?(V=mi.pop(),B&&(V.v=B.v),I&&Bi(V,I),I=V):I=new Fn(I,B),this.g=I,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}Dn.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};function sn(I){var B=I.g;if((B=B.g==B.j)||(B=I.j)||(B=I.g,B=B.m||0>B.g||B.g>B.j),B)return!1;I.m=I.g.g,B=I.g.i();var V=B&7;return V!=0&&V!=5&&V!=1&&V!=2&&V!=3&&V!=4?(I.j=!0,!1):(I.i=B,I.l=B>>>3,I.h=V,!0)}function Tn(I){switch(I.h){case 0:if(I.h!=0)Tn(I);else{for(I=I.g;I.h[I.g]&128;)I.g++;I.g++}break;case 1:I.h!=1?Tn(I):(I=I.g,I.g+=8);break;case 2:if(I.h!=2)Tn(I);else{var B=I.g.i();I=I.g,I.g+=B}break;case 5:I.h!=5?Tn(I):(I=I.g,I.g+=4);break;case 3:B=I.l;do{if(!sn(I)){I.j=!0;break}if(I.h==4){I.l!=B&&(I.j=!0);break}Tn(I)}while(!0);break;default:I.j=!0}}function Kr(I,B,V){var ae=I.g.j,be=I.g.i(),we=I.g.g+be;if(I.g.j=we,V(B,I),V=we-I.g.g,V!==0)throw Error("Message parsing ended unexpectedly. Expected to read "+be+" bytes, instead read "+(be-V)+" bytes, either the data ended unexpectedly or the message misreported its own length");return I.g.g=we,I.g.j=ae,B}function xn(I){return I.g.o()}function ti(I){var B=I.g.i();I=I.g;var V=I.g;I.g+=B,I=I.h;var ae;if(_e)(ae=ke)||(ae=ke=new TextDecoder("utf-8",{fatal:!1})),ae=ae.decode(I.subarray(V,V+B));else{B=V+B;for(var be=[],we=null,Pe,Ie,Be;V<B;)Pe=I[V++],128>Pe?be.push(Pe):224>Pe?V>=B?be.push(65533):(Ie=I[V++],194>Pe||(Ie&192)!==128?(V--,be.push(65533)):be.push((Pe&31)<<6|Ie&63)):240>Pe?V>=B-1?be.push(65533):(Ie=I[V++],(Ie&192)!==128||Pe===224&&160>Ie||Pe===237&&160<=Ie||((ae=I[V++])&192)!==128?(V--,be.push(65533)):be.push((Pe&15)<<12|(Ie&63)<<6|ae&63)):244>=Pe?V>=B-2?be.push(65533):(Ie=I[V++],(Ie&192)!==128||(Pe<<28)+(Ie-144)>>30||((ae=I[V++])&192)!==128||((Be=I[V++])&192)!==128?(V--,be.push(65533)):(Pe=(Pe&7)<<18|(Ie&63)<<12|(ae&63)<<6|Be&63,Pe-=65536,be.push((Pe>>10&1023)+55296,(Pe&1023)+56320))):be.push(65533),8192<=be.length&&(we=ne(we,be),be.length=0);ae=ne(we,be)}return ae}function pn(I,B,V){var ae=I.g.i();for(ae=I.g.g+ae;I.g.g<ae;)V.push(B.call(I.g))}function Un(I,B){I.h==2?pn(I,Fn.prototype.o,B):B.push(xn(I))}function Ui(){this.h=[],this.i=0,this.g=new wn}function yt(I,B){B.length!==0&&(I.h.push(B),I.i+=B.length)}function Rt(I){var B=I.i+I.g.length();if(B===0)return new Uint8Array(0);B=new Uint8Array(B);for(var V=I.h,ae=V.length,be=0,we=0;we<ae;we++){var Pe=V[we];Pe.length!==0&&(B.set(Pe,be),be+=Pe.length)}return V=I.g,ae=V.h,ae!==0&&(B.set(V.g.subarray(0,ae),be),V.h=0),I.h=[B],B}function rt(I,B,V){if(V!=null){mr(I.g,8*B+5),I=I.g;var ae=V;ae=(V=0>ae?1:0)?-ae:ae,ae===0?0<1/ae?Lt=Wt=0:(Wt=0,Lt=2147483648):isNaN(ae)?(Wt=0,Lt=2147483647):34028234663852886e22<ae?(Wt=0,Lt=(V<<31|2139095040)>>>0):11754943508222875e-54>ae?(ae=Math.round(ae/Math.pow(2,-149)),Wt=0,Lt=(V<<31|ae)>>>0):(B=Math.floor(Math.log(ae)/Math.LN2),ae*=Math.pow(2,-B),ae=Math.round(8388608*ae),16777216<=ae&&++B,Wt=0,Lt=(V<<31|B+127<<23|ae&8388607)>>>0),V=Lt,I.push(V>>>0&255),I.push(V>>>8&255),I.push(V>>>16&255),I.push(V>>>24&255)}}var zt=typeof Uint8Array=="function";function Rr(I,B,V){if(I!=null)return typeof I=="object"?zt&&I instanceof Uint8Array?V(I):gr(I,B,V):B(I)}function gr(I,B,V){if(Array.isArray(I)){for(var ae=Array(I.length),be=0;be<I.length;be++)ae[be]=Rr(I[be],B,V);return Array.isArray(I)&&I.W&&zn(ae),ae}ae={};for(be in I)ae[be]=Rr(I[be],B,V);return ae}function Ut(I){return typeof I=="number"?isFinite(I)?I:String(I):I}var ct={W:{value:!0,configurable:!0}};function zn(I){return Array.isArray(I)&&!Object.isFrozen(I)&&Object.defineProperties(I,ct),I}var ks;function fn(I,B,V){var ae=ks;ks=null,I||(I=ae),ae=this.constructor.ca,I||(I=ae?[ae]:[]),this.j=ae?0:-1,this.m=this.g=null,this.h=I;e:{if(ae=this.h.length,I=ae-1,ae&&(ae=this.h[I],!(ae===null||typeof ae!="object"||Array.isArray(ae)||zt&&ae instanceof Uint8Array))){this.l=I-this.j,this.i=ae;break e}B!==void 0&&-1<B?(this.l=Math.max(B,I+1-this.j),this.i=null):this.l=Number.MAX_VALUE}if(V)for(B=0;B<V.length;B++)I=V[B],I<this.l?(I+=this.j,(ae=this.h[I])?zn(ae):this.h[I]=Ga):(Fl(this),(ae=this.i[I])?zn(ae):this.i[I]=Ga)}var Ga=Object.freeze(zn([]));function Fl(I){var B=I.l+I.j;I.h[B]||(I.i=I.h[B]={})}function nn(I,B,V){return B===-1?null:V!==void 0&&V||B>=I.l?I.i?I.i[B]:void 0:I.h[B+I.j]}function Ts(I,B){var V=V===void 0?!1:V,ae=nn(I,B,V);return ae==null&&(ae=Ga),ae===Ga&&(ae=zn([]),kt(I,B,ae,V)),ae}function Dl(I){var B=Ts(I,3);if(I.m||(I.m={}),!I.m[3]){for(var V=0;V<B.length;V++)B[V]=+B[V];I.m[3]=!0}return B}function Hi(I,B,V){return I=nn(I,B),I??V}function ni(I,B,V){return I=nn(I,B),I=I==null?I:+I,I??(V===void 0?0:V)}function kt(I,B,V,ae){ae!==void 0&&ae||B>=I.l?(Fl(I),I.i[B]=V):I.h[B+I.j]=V}function Nl(I,B,V){if(V===-1)return null;if(I.g||(I.g={}),!I.g[V]){var ae=nn(I,V,!1);ae&&(I.g[V]=new B(ae))}return I.g[V]}function Ja(I,B){I.g||(I.g={});var V=I.g[1];if(!V){var ae=Ts(I,1);V=[];for(var be=0;be<ae.length;be++)V[be]=new B(ae[be]);I.g[1]=V}return V}function Ol(I,B,V){var ae=ae===void 0?!1:ae;I.g||(I.g={});var be=V&&ns(V);I.g[B]=V,kt(I,B,be,ae)}function Ml(I,B,V,ae){var be=Ja(I,V);B=B||new V,I=Ts(I,1),ae!=null?(be.splice(ae,0,B),I.splice(ae,0,ns(B))):(be.push(B),I.push(ns(B)))}fn.prototype.toJSON=function(){var I=ns(this);return gr(I,Ut,Je)};function ns(I,B){if(I.g)for(var V in I.g){var ae=I.g[V];if(Array.isArray(ae))for(var be=0;be<ae.length;be++)ae[be]&&ns(ae[be]);else ae&&ns(ae)}return I.h}fn.prototype.toString=function(){return ns(this).toString()};function Go(I,B){if(I=I.o){yt(B,B.g.end());for(var V=0;V<I.length;V++)yt(B,I[V])}}function Vi(I,B){if(B.h==4)return!1;var V=B.m;return Tn(B),B.N||(B=mt(B.g.h,V,B.g.g),(V=I.o)?V.push(B):I.o=[B]),!0}function rs(I){fn.call(this,I,-1,Sh)}R(rs,fn),rs.prototype.getRows=function(){return nn(this,1)},rs.prototype.getCols=function(){return nn(this,2)},rs.prototype.getPackedDataList=function(){return Dl(this)},rs.prototype.getLayout=function(){return Hi(this,4,0)};function bh(I,B){for(;sn(B);)switch(B.i){case 8:var V=B.g.i();kt(I,1,V);break;case 16:V=B.g.i(),kt(I,2,V);break;case 29:case 26:Un(B,I.getPackedDataList());break;case 32:V=fr(B.g),kt(I,4,V);break;default:if(!Vi(I,B))return I}return I}var Sh=[3];function Jn(I,B){var V=void 0;return new(V||(V=Promise))(function(ae,be){function we(Be){try{Ie(B.next(Be))}catch(Ke){be(Ke)}}function Pe(Be){try{Ie(B.throw(Be))}catch(Ke){be(Ke)}}function Ie(Be){Be.done?ae(Be.value):new V(function(Ke){Ke(Be.value)}).then(we,Pe)}Ie((B=B.apply(I,void 0)).next())})}function da(I){fn.call(this,I)}R(da,fn);function wh(I,B){for(;sn(B);)switch(B.i){case 8:var V=B.g.i();kt(I,1,V);break;case 21:V=xn(B),kt(I,2,V);break;case 26:V=ti(B),kt(I,3,V);break;case 34:V=ti(B),kt(I,4,V);break;default:if(!Vi(I,B))return I}return I}function Jo(I){fn.call(this,I,-1,xh)}R(Jo,fn),Jo.prototype.addClassification=function(I,B){return Ml(this,I,da,B),this};var xh=[1];function Rs(I){fn.call(this,I)}R(Rs,fn);function Ch(I,B){for(;sn(B);)switch(B.i){case 13:var V=xn(B);kt(I,1,V);break;case 21:V=xn(B),kt(I,2,V);break;case 29:V=xn(B),kt(I,3,V);break;case 37:V=xn(B),kt(I,4,V);break;case 45:V=xn(B),kt(I,5,V);break;default:if(!Vi(I,B))return I}return I}function Ll(I){fn.call(this,I,-1,Eh)}R(Ll,fn);function jl(I){e:{var B=new Ll;for(I=new Dn(I);sn(I);)switch(I.i){case 10:var V=Kr(I,new Rs,Ch);Ml(B,V,Rs,void 0);break;default:if(!Vi(B,I))break e}}return B}var Eh=[1];function Zo(I){fn.call(this,I)}R(Zo,fn);function is(I){fn.call(this,I,-1,ha)}R(is,fn),is.prototype.getVertexType=function(){return Hi(this,1,0)},is.prototype.getPrimitiveType=function(){return Hi(this,2,0)},is.prototype.getVertexBufferList=function(){return Dl(this)},is.prototype.getIndexBufferList=function(){return Ts(this,4)};function Ph(I,B){for(;sn(B);)switch(B.i){case 8:var V=fr(B.g);kt(I,1,V);break;case 16:V=fr(B.g),kt(I,2,V);break;case 29:case 26:Un(B,I.getVertexBufferList());break;case 32:case 34:V=B;var ae=I.getIndexBufferList();V.h==2?pn(V,Fn.prototype.i,ae):ae.push(V.g.i());break;default:if(!Vi(I,B))return I}return I}var ha=[3,4];function pa(I){fn.call(this,I)}R(pa,fn),pa.prototype.getMesh=function(){return Nl(this,is,1)},pa.prototype.getPoseTransformMatrix=function(){return Nl(this,rs,2)};function kh(I){e:{var B=new pa;for(I=new Dn(I);sn(I);)switch(I.i){case 10:var V=Kr(I,new is,Ph);Ol(B,1,V);break;case 18:V=Kr(I,new rs,bh),Ol(B,2,V);break;default:if(!Vi(B,I))break e}}return B}function Bl(I,B,V){if(V=I.createShader(V===0?I.VERTEX_SHADER:I.FRAGMENT_SHADER),I.shaderSource(V,B),I.compileShader(V),!I.getShaderParameter(V,I.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+I.getShaderInfoLog(V));return V}function Th(I){return Ja(I,da).map(function(B){return{index:Hi(B,1,0),Y:ni(B,2),label:nn(B,3)!=null?Hi(B,3,""):void 0,displayName:nn(B,4)!=null?Hi(B,4,""):void 0}})}function Ul(I){return{x:ni(I,1),y:ni(I,2),z:ni(I,3),visibility:nn(I,4)!=null?ni(I,4):void 0}}function Xo(I,B){this.h=I,this.g=B,this.l=0}function ss(I,B,V){return Rh(I,B),typeof I.g.canvas.transferToImageBitmap=="function"?Promise.resolve(I.g.canvas.transferToImageBitmap()):V?Promise.resolve(I.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(I.g.canvas):(I.i===void 0&&(I.i=document.createElement("canvas")),new Promise(function(ae){I.i.height=I.g.canvas.height,I.i.width=I.g.canvas.width,I.i.getContext("2d",{}).drawImage(I.g.canvas,0,0,I.g.canvas.width,I.g.canvas.height),ae(I.i)}))}function Rh(I,B){var V=I.g;if(I.m===void 0){var ae=Bl(V,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),be=Bl(V,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),we=V.createProgram();if(V.attachShader(we,ae),V.attachShader(we,be),V.linkProgram(we),!V.getProgramParameter(we,V.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+V.getProgramInfoLog(we));ae=I.m=we,V.useProgram(ae),be=V.getUniformLocation(ae,"sampler0"),I.j={I:V.getAttribLocation(ae,"aVertex"),H:V.getAttribLocation(ae,"aTex"),da:be},I.s=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,I.s),V.enableVertexAttribArray(I.j.I),V.vertexAttribPointer(I.j.I,2,V.FLOAT,!1,0,0),V.bufferData(V.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null),I.o=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,I.o),V.enableVertexAttribArray(I.j.H),V.vertexAttribPointer(I.j.H,2,V.FLOAT,!1,0,0),V.bufferData(V.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null),V.uniform1i(be,0)}ae=I.j,V.useProgram(I.m),V.canvas.width=B.width,V.canvas.height=B.height,V.viewport(0,0,B.width,B.height),V.activeTexture(V.TEXTURE0),I.h.bindTexture2d(B.glName),V.enableVertexAttribArray(ae.I),V.bindBuffer(V.ARRAY_BUFFER,I.s),V.vertexAttribPointer(ae.I,2,V.FLOAT,!1,0,0),V.enableVertexAttribArray(ae.H),V.bindBuffer(V.ARRAY_BUFFER,I.o),V.vertexAttribPointer(ae.H,2,V.FLOAT,!1,0,0),V.bindFramebuffer(V.DRAW_FRAMEBUFFER?V.DRAW_FRAMEBUFFER:V.FRAMEBUFFER,null),V.clearColor(0,0,0,0),V.clear(V.COLOR_BUFFER_BIT),V.colorMask(!0,!0,!0,!0),V.drawArrays(V.TRIANGLE_FAN,0,4),V.disableVertexAttribArray(ae.I),V.disableVertexAttribArray(ae.H),V.bindBuffer(V.ARRAY_BUFFER,null),I.h.bindTexture2d(0)}function Ah(I){this.g=I}var Ih=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Fh(I,B){return B+I}function Hl(I,B){window[I]=B}function Dh(I){var B=document.createElement("script");return B.setAttribute("src",I),B.setAttribute("crossorigin","anonymous"),new Promise(function(V){B.addEventListener("load",function(){V()},!1),B.addEventListener("error",function(){V()},!1),document.body.appendChild(B)})}function Nh(){return Jn(this,function I(){return Q(I,function(B){switch(B.g){case 1:return B.m=2,E(B,WebAssembly.instantiate(Ih),4);case 4:B.g=3,B.m=0;break;case 2:return B.m=0,B.j=null,B.return(!1);case 3:return B.return(!0)}})})}function Qo(I){if(this.g=I,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=I&&I.locateFile||Fh,typeof window=="object")var B=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")B=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.S=B,I.options){B=u(Object.keys(I.options));for(var V=B.next();!V.done;V=B.next()){V=V.value;var ae=I.options[V].default;ae!==void 0&&(this.j[V]=typeof ae=="function"?ae():ae)}}}e=Qo.prototype,e.close=function(){return this.i&&this.i.delete(),Promise.resolve()};function Oh(I,B){return I.g.files===void 0?[]:typeof I.g.files=="function"?I.g.files(B):I.g.files}function Zn(I){return Jn(I,function B(){var V=this,ae,be,we,Pe,Ie,Be,Ke,dt,qt,tt,gt;return Q(B,function(Ye){switch(Ye.g){case 1:return ae=V,V.R?(be=Oh(V,V.j),E(Ye,Nh(),2)):Ye.return();case 2:if(we=Ye.h,typeof window=="object")return Hl("createMediapipeSolutionsWasm",{locateFile:V.locateFile}),Hl("createMediapipeSolutionsPackedAssets",{locateFile:V.locateFile}),Be=be.filter(function(ht){return ht.data!==void 0}),Ke=be.filter(function(ht){return ht.data===void 0}),dt=Promise.all(Be.map(function(ht){var wt=Yo(ae,ht.url);if(ht.path!==void 0){var At=ht.path;wt=wt.then(function(Nn){return ae.overrideFile(At,Nn),Promise.resolve(Nn)})}return wt})),qt=Promise.all(Ke.map(function(ht){return ht.simd===void 0||ht.simd&&we||!ht.simd&&!we?Dh(ae.locateFile(ht.url,ae.S)):Promise.resolve()})).then(function(){return Jn(ae,function ht(){var wt,At,Nn=this;return Q(ht,function(Gt){if(Gt.g==1)return wt=window.createMediapipeSolutionsWasm,At=window.createMediapipeSolutionsPackedAssets,E(Gt,wt(At),2);Nn.h=Gt.h,Gt.g=0})})}),tt=function(){return Jn(ae,function ht(){var wt=this;return Q(ht,function(At){return wt.g.graph&&wt.g.graph.url?At=E(At,Yo(wt,wt.g.graph.url),0):(At.g=0,At=void 0),At})})}(),E(Ye,Promise.all([qt,dt,tt]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return Pe=be.filter(function(ht){return ht.simd===void 0||ht.simd&&we||!ht.simd&&!we}).map(function(ht){return ae.locateFile(ht.url,ae.S)}),importScripts.apply(null,p(Pe)),E(Ye,createMediapipeSolutionsWasm(Module),6);case 6:V.h=Ye.h,V.l=new OffscreenCanvas(1,1),V.h.canvas=V.l,Ie=V.h.GL.createContext(V.l,{antialias:!1,alpha:!1,ba:typeof WebGL2RenderingContext<"u"?2:1}),V.h.GL.makeContextCurrent(Ie),Ye.g=4;break;case 7:if(V.l=document.createElement("canvas"),gt=V.l.getContext("webgl2",{}),!gt&&(gt=V.l.getContext("webgl",{}),!gt))return alert("Failed to create WebGL canvas context when passing video frame."),Ye.return();V.D=gt,V.h.canvas=V.l,V.h.createContext(V.l,!0,!0,{});case 4:V.i=new V.h.SolutionWasm,V.R=!1,Ye.g=0}})})}function Mh(I){return Jn(I,function B(){var V=this,ae,be,we,Pe,Ie,Be,Ke,dt;return Q(B,function(qt){if(qt.g==1){if(V.g.graph&&V.g.graph.url&&V.P===V.g.graph.url)return qt.return();if(V.o=!0,!V.g.graph||!V.g.graph.url){qt.g=2;return}return V.P=V.g.graph.url,E(qt,Yo(V,V.g.graph.url),3)}for(qt.g!=2&&(ae=qt.h,V.i.loadGraph(ae)),be=u(Object.keys(V.B)),we=be.next();!we.done;we=be.next())Pe=we.value,V.i.overrideFile(Pe,V.B[Pe]);if(V.B={},V.g.listeners)for(Ie=u(V.g.listeners),Be=Ie.next();!Be.done;Be=Ie.next())Ke=Be.value,Bh(V,Ke);dt=V.j,V.j={},V.setOptions(dt),qt.g=0})})}e.reset=function(){return Jn(this,function I(){var B=this;return Q(I,function(V){B.i&&(B.i.reset(),B.m={},B.s={}),V.g=0})})},e.setOptions=function(I,B){var V=this;if(B=B||this.g.options){for(var ae=[],be=[],we={},Pe=u(Object.keys(I)),Ie=Pe.next();!Ie.done;we={K:we.K,L:we.L},Ie=Pe.next()){var Be=Ie.value;Be in this.j&&this.j[Be]===I[Be]||(this.j[Be]=I[Be],Ie=B[Be],Ie!==void 0&&(Ie.onChange&&(we.K=Ie.onChange,we.L=I[Be],ae.push(function(Ke){return function(){return Jn(V,function dt(){var qt,tt=this;return Q(dt,function(gt){if(gt.g==1)return E(gt,Ke.K(Ke.L),2);qt=gt.h,qt===!0&&(tt.o=!0),gt.g=0})})}}(we))),Ie.graphOptionXref&&(Be={valueNumber:Ie.type===1?I[Be]:0,valueBoolean:Ie.type===0?I[Be]:!1,valueString:Ie.type===2?I[Be]:""},Ie=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),Ie.graphOptionXref),Be),be.push(Ie))))}(ae.length!==0||be.length!==0)&&(this.o=!0,this.A=(this.A===void 0?[]:this.A).concat(be),this.u=(this.u===void 0?[]:this.u).concat(ae))}};function Lh(I){return Jn(I,function B(){var V=this,ae,be,we,Pe,Ie,Be,Ke;return Q(B,function(dt){switch(dt.g){case 1:if(!V.o)return dt.return();if(!V.u){dt.g=2;break}ae=u(V.u),be=ae.next();case 3:if(be.done){dt.g=5;break}return we=be.value,E(dt,we(),4);case 4:be=ae.next(),dt.g=3;break;case 5:V.u=void 0;case 2:if(V.A){for(Pe=new V.h.GraphOptionChangeRequestList,Ie=u(V.A),Be=Ie.next();!Be.done;Be=Ie.next())Ke=Be.value,Pe.push_back(Ke);V.i.changeOptions(Pe),Pe.delete(),V.A=void 0}V.o=!1,dt.g=0}})})}e.initialize=function(){return Jn(this,function I(){var B=this;return Q(I,function(V){return V.g==1?E(V,Zn(B),2):V.g!=3?E(V,Mh(B),3):E(V,Lh(B),0)})})};function Yo(I,B){return Jn(I,function V(){var ae=this,be,we;return Q(V,function(Pe){return B in ae.F?Pe.return(ae.F[B]):(be=ae.locateFile(B,""),we=fetch(be).then(function(Ie){return Ie.arrayBuffer()}),ae.F[B]=we,Pe.return(we))})})}e.overrideFile=function(I,B){this.i?this.i.overrideFile(I,B):this.B[I]=B},e.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},e.send=function(I,B){return Jn(this,function V(){var ae=this,be,we,Pe,Ie,Be,Ke,dt,qt,tt;return Q(V,function(gt){switch(gt.g){case 1:return ae.g.inputs?(be=1e3*(B??performance.now()),E(gt,ae.C,2)):gt.return();case 2:return E(gt,ae.initialize(),3);case 3:for(we=new ae.h.PacketDataList,Pe=u(Object.keys(I)),Ie=Pe.next();!Ie.done;Ie=Pe.next())if(Be=Ie.value,Ke=ae.g.inputs[Be]){e:{var Ye=ae,ht=I[Be];switch(Ke.type){case"video":var wt=Ye.m[Ke.stream];if(wt||(wt=new Xo(Ye.h,Ye.D),Ye.m[Ke.stream]=wt),Ye=wt,Ye.l===0&&(Ye.l=Ye.h.createTexture()),typeof HTMLVideoElement<"u"&&ht instanceof HTMLVideoElement){var At=ht.videoWidth;wt=ht.videoHeight}else typeof HTMLImageElement<"u"&&ht instanceof HTMLImageElement?(At=ht.naturalWidth,wt=ht.naturalHeight):(At=ht.width,wt=ht.height);wt={glName:Ye.l,width:At,height:wt},At=Ye.g,At.canvas.width=wt.width,At.canvas.height=wt.height,At.activeTexture(At.TEXTURE0),Ye.h.bindTexture2d(Ye.l),At.texImage2D(At.TEXTURE_2D,0,At.RGBA,At.RGBA,At.UNSIGNED_BYTE,ht),Ye.h.bindTexture2d(0),Ye=wt;break e;case"detections":for(wt=Ye.m[Ke.stream],wt||(wt=new Ah(Ye.h),Ye.m[Ke.stream]=wt),Ye=wt,Ye.data||(Ye.data=new Ye.g.DetectionListData),Ye.data.reset(ht.length),wt=0;wt<ht.length;++wt){At=ht[wt];var Nn=Ye.data,Gt=Nn.setBoundingBox,Xn=wt,it=At.T,_t=new Zo;kt(_t,1,it.Z),kt(_t,2,it.$),kt(_t,3,it.height),kt(_t,4,it.width),kt(_t,5,it.rotation),kt(_t,6,it.X);var Nt=it=new Ui;rt(Nt,1,nn(_t,1)),rt(Nt,2,nn(_t,2)),rt(Nt,3,nn(_t,3)),rt(Nt,4,nn(_t,4)),rt(Nt,5,nn(_t,5));var jt=nn(_t,6);if(jt!=null&&jt!=null){mr(Nt.g,48);var Et=Nt.g,Ot=jt;jt=0>Ot,Ot=Math.abs(Ot);var Bt=Ot>>>0;for(Ot=Math.floor((Ot-Bt)/4294967296),Ot>>>=0,jt&&(Ot=~Ot>>>0,Bt=(~Bt>>>0)+1,4294967295<Bt&&(Bt=0,Ot++,4294967295<Ot&&(Ot=0))),Lt=Bt,Wt=Ot,jt=Lt,Bt=Wt;0<Bt||127<jt;)Et.push(jt&127|128),jt=(jt>>>7|Bt<<25)>>>0,Bt>>>=7;Et.push(jt)}if(Go(_t,Nt),it=Rt(it),Gt.call(Nn,Xn,it),At.O)for(Nn=0;Nn<At.O.length;++Nn)_t=At.O[Nn],Nt=!!_t.visibility,Gt=Ye.data,Xn=Gt.addNormalizedLandmark,it=wt,_t=Object.assign(Object.assign({},_t),{visibility:Nt?_t.visibility:0}),Nt=new Rs,kt(Nt,1,_t.x),kt(Nt,2,_t.y),kt(Nt,3,_t.z),_t.visibility&&kt(Nt,4,_t.visibility),Et=_t=new Ui,rt(Et,1,nn(Nt,1)),rt(Et,2,nn(Nt,2)),rt(Et,3,nn(Nt,3)),rt(Et,4,nn(Nt,4)),rt(Et,5,nn(Nt,5)),Go(Nt,Et),_t=Rt(_t),Xn.call(Gt,it,_t);if(At.M)for(Nn=0;Nn<At.M.length;++Nn){if(Gt=Ye.data,Xn=Gt.addClassification,it=wt,_t=At.M[Nn],Nt=new da,kt(Nt,2,_t.Y),_t.index&&kt(Nt,1,_t.index),_t.label&&kt(Nt,3,_t.label),_t.displayName&&kt(Nt,4,_t.displayName),Et=_t=new Ui,Bt=nn(Nt,1),Bt!=null&&Bt!=null)if(mr(Et.g,8),jt=Et.g,0<=Bt)mr(jt,Bt);else{for(Ot=0;9>Ot;Ot++)jt.push(Bt&127|128),Bt>>=7;jt.push(1)}rt(Et,2,nn(Nt,2)),jt=nn(Nt,3),jt!=null&&(jt=ge(jt),mr(Et.g,26),mr(Et.g,jt.length),yt(Et,Et.g.end()),yt(Et,jt)),jt=nn(Nt,4),jt!=null&&(jt=ge(jt),mr(Et.g,34),mr(Et.g,jt.length),yt(Et,Et.g.end()),yt(Et,jt)),Go(Nt,Et),_t=Rt(_t),Xn.call(Gt,it,_t)}}Ye=Ye.data;break e;default:Ye={}}}switch(dt=Ye,qt=Ke.stream,Ke.type){case"video":we.pushTexture2d(Object.assign(Object.assign({},dt),{stream:qt,timestamp:be}));break;case"detections":tt=dt,tt.stream=qt,tt.timestamp=be,we.pushDetectionList(tt);break;default:throw Error("Unknown input config type: '"+Ke.type+"'")}}return ae.i.send(we),E(gt,ae.C,4);case 4:we.delete(),gt.g=0}})})};function ec(I,B,V){return Jn(I,function ae(){var be,we,Pe,Ie,Be,Ke,dt=this,qt,tt,gt,Ye,ht,wt,At,Nn;return Q(ae,function(Gt){switch(Gt.g){case 1:if(!V)return Gt.return(B);for(be={},we=0,Pe=u(Object.keys(V)),Ie=Pe.next();!Ie.done;Ie=Pe.next())Be=Ie.value,Ke=V[Be],typeof Ke!="string"&&Ke.type==="texture"&&B[Ke.stream]!==void 0&&++we;1<we&&(dt.G=!1),qt=u(Object.keys(V)),Ie=qt.next();case 2:if(Ie.done){Gt.g=4;break}if(tt=Ie.value,gt=V[tt],typeof gt=="string")return At=be,Nn=tt,E(Gt,jh(dt,tt,B[gt]),14);if(Ye=B[gt.stream],gt.type==="detection_list"){if(Ye){for(var Xn=Ye.getRectList(),it=Ye.getLandmarksList(),_t=Ye.getClassificationsList(),Nt=[],jt=0;jt<Xn.size();++jt){var Et=Xn.get(jt);e:{var Ot=new Zo;for(Et=new Dn(Et);sn(Et);)switch(Et.i){case 13:var Bt=xn(Et);kt(Ot,1,Bt);break;case 21:Bt=xn(Et),kt(Ot,2,Bt);break;case 29:Bt=xn(Et),kt(Ot,3,Bt);break;case 37:Bt=xn(Et),kt(Ot,4,Bt);break;case 45:Bt=xn(Et),kt(Ot,5,Bt);break;case 48:Bt=fr(Et.g),kt(Ot,6,Bt);break;default:if(!Vi(Ot,Et))break e}}Ot={Z:ni(Ot,1),$:ni(Ot,2),height:ni(Ot,3),width:ni(Ot,4),rotation:ni(Ot,5,0),X:Hi(Ot,6,0)},Et=Ja(jl(it.get(jt)),Rs).map(Ul);var As=_t.get(jt);e:for(Bt=new Jo,As=new Dn(As);sn(As);)switch(As.i){case 10:Bt.addClassification(Kr(As,new da,wh));break;default:if(!Vi(Bt,As))break e}Ot={T:Ot,O:Et,M:Th(Bt)},Nt.push(Ot)}Xn=Nt}else Xn=[];be[tt]=Xn,Gt.g=7;break}if(gt.type==="proto_list"){if(Ye){for(Xn=Array(Ye.size()),it=0;it<Ye.size();it++)Xn[it]=Ye.get(it);Ye.delete()}else Xn=[];be[tt]=Xn,Gt.g=7;break}if(Ye===void 0){Gt.g=3;break}if(gt.type==="float_list"){be[tt]=Ye,Gt.g=7;break}if(gt.type==="proto"){be[tt]=Ye,Gt.g=7;break}if(gt.type!=="texture")throw Error("Unknown output config type: '"+gt.type+"'");return ht=dt.s[tt],ht||(ht=new Xo(dt.h,dt.D),dt.s[tt]=ht),E(Gt,ss(ht,Ye,dt.G),13);case 13:wt=Gt.h,be[tt]=wt;case 7:gt.transform&&be[tt]&&(be[tt]=gt.transform(be[tt])),Gt.g=3;break;case 14:At[Nn]=Gt.h;case 3:Ie=qt.next(),Gt.g=2;break;case 4:return Gt.return(be)}})})}function jh(I,B,V){return Jn(I,function ae(){var be=this,we;return Q(ae,function(Pe){return typeof V=="number"||V instanceof Uint8Array||V instanceof be.h.Uint8BlobList?Pe.return(V):V instanceof be.h.Texture2dDataOut?(we=be.s[B],we||(we=new Xo(be.h,be.D),be.s[B]=we),Pe.return(ss(we,V,be.G))):Pe.return(void 0)})})}function Bh(I,B){for(var V=B.name||"$",ae=[].concat(p(B.wants)),be=new I.h.StringList,we=u(B.wants),Pe=we.next();!Pe.done;Pe=we.next())be.push_back(Pe.value);we=I.h.PacketListener.implement({onResults:function(Ie){for(var Be={},Ke=0;Ke<B.wants.length;++Ke)Be[ae[Ke]]=Ie.get(Ke);var dt=I.listeners[V];dt&&(I.C=ec(I,Be,B.outs).then(function(qt){qt=dt(qt);for(var tt=0;tt<B.wants.length;++tt){var gt=Be[ae[tt]];typeof gt=="object"&&gt.hasOwnProperty&&gt.hasOwnProperty("delete")&&gt.delete()}qt&&(I.C=qt)}))}}),I.i.attachMultiListener(be,we),be.delete()}e.onResults=function(I,B){this.listeners[B||"$"]=I},ce("Solution",Qo),ce("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"});function Uh(I){I=kh(I);var B=I.getMesh();if(!B)return I;var V=new Float32Array(B.getVertexBufferList());B.getVertexBufferList=function(){return V};var ae=new Uint32Array(B.getIndexBufferList());return B.getIndexBufferList=function(){return ae},I}var tc={files:[{url:"face_mesh_solution_packed_assets_loader.js"},{simd:!0,url:"face_mesh_solution_simd_wasm_bin.js"},{simd:!1,url:"face_mesh_solution_wasm_bin.js"}],graph:{url:"face_mesh.binarypb"},listeners:[{wants:["multi_face_geometry","image_transformed","multi_face_landmarks"],outs:{image:"image_transformed",multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:function(I){return I.map(Uh)}},multiFaceLandmarks:{type:"proto_list",stream:"multi_face_landmarks",transform:function(I){return I.map(function(B){return Ja(jl(B),Rs).map(Ul)})}}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumFaces:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorNumFaces",fieldName:"int_value"}},refineLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facelandmarkfrontgpu__facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"facelandmarkfrontgpu__facelandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}},fa=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],ir=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],Rn=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Vl=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Za=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Ar=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],nc=[].concat(p(fa),p(ir),p(Rn),p(Vl),p(Za),p(Ar));function Xa(I){I=I||{},I=Object.assign(Object.assign({},tc),I),this.g=new Qo(I)}e=Xa.prototype,e.close=function(){return this.g.close(),Promise.resolve()},e.onResults=function(I){this.g.onResults(I)},e.initialize=function(){return Jn(this,function I(){var B=this;return Q(I,function(V){return E(V,B.g.initialize(),0)})})},e.reset=function(){this.g.reset()},e.send=function(I){return Jn(this,function B(){var V=this;return Q(B,function(ae){return E(ae,V.g.send(I),0)})})},e.setOptions=function(I){this.g.setOptions(I)},ce("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),ce("FaceMesh",Xa),ce("FACEMESH_LIPS",fa),ce("FACEMESH_LEFT_EYE",ir),ce("FACEMESH_LEFT_EYEBROW",Rn),ce("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),ce("FACEMESH_RIGHT_EYE",Vl),ce("FACEMESH_RIGHT_EYEBROW",Za),ce("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),ce("FACEMESH_FACE_OVAL",Ar),ce("FACEMESH_CONTOURS",nc),ce("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),ce("matrixDataToMatrix",function(I){for(var B=I.getCols(),V=I.getRows(),ae=I.getPackedDataList(),be=[],we=0;we<V;we++)be.push(Array(B));for(we=0;we<V;we++)for(var Pe=0;Pe<B;Pe++){var Ie=I.getLayout()===1?we*B+Pe:Pe*V+we;be[we][Pe]=ae[Ie]}return be}),ce("VERSION","0.4.1633559619")}).call(Ti);var x4=FaceMesh,C4=Object.create,Qd=Object.defineProperty,E4=Object.defineProperties,P4=Object.getOwnPropertyDescriptor,k4=Object.getOwnPropertyDescriptors,Qm=Object.getOwnPropertyNames,Kv=Object.getOwnPropertySymbols,T4=Object.getPrototypeOf,i_=Object.prototype.hasOwnProperty,R4=Object.prototype.propertyIsEnumerable,Co=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),Ym=e=>{throw TypeError(e)},ws=Math.pow,Nf=(e,t,n)=>t in e?Qd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ie=(e,t)=>{for(var n in t||(t={}))i_.call(t,n)&&Nf(e,n,t[n]);if(Kv)for(var n of Kv(t))R4.call(t,n)&&Nf(e,n,t[n]);return e},Se=(e,t)=>E4(e,k4(t)),A4=(e,t)=>function(){return e&&(t=(0,e[Qm(e)[0]])(e=0)),t},Ce=(e,t)=>function(){return t||(0,e[Qm(e)[0]])((t={exports:{}}).exports,t),t.exports},s_=(e,t)=>{for(var n in t)Qd(e,n,{get:t[n],enumerable:!0})},I4=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Qm(t))!i_.call(e,i)&&i!==n&&Qd(e,i,{get:()=>t[i],enumerable:!(r=P4(t,i))||r.enumerable});return e},qr=(e,t,n)=>(n=e!=null?C4(T4(e)):{},I4(!e||!e.__esModule?Qd(n,"default",{value:e,enumerable:!0}):n,e)),me=(e,t,n)=>Nf(e,typeof t!="symbol"?t+"":t,n),a_=(e,t,n)=>t.has(e)||Ym("Cannot "+n),xt=(e,t,n)=>(a_(e,t,"read from private field"),n?n.call(e):t.get(e)),lr=(e,t,n)=>t.has(e)?Ym("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),dn=(e,t,n,r)=>(a_(e,t,"write to private field"),t.set(e,n),n),H=(e,t,n)=>new Promise((r,i)=>{var a=p=>{try{u(n.next(p))}catch(h){i(h)}},o=p=>{try{u(n.throw(p))}catch(h){i(h)}},u=p=>p.done?r(p.value):Promise.resolve(p.value).then(a,o);u((n=n.apply(e,t)).next())}),Do=function(e,t){this[0]=e,this[1]=t},o_=(e,t,n)=>{var r=(o,u,p,h)=>{try{var g=n[o](u),f=(u=g.value)instanceof Do,_=g.done;Promise.resolve(f?u[0]:u).then(w=>f?r(o==="return"?o:"next",u[1]?{done:w.done,value:w.value}:w,p,h):p({value:w,done:_})).catch(w=>r("throw",w,p,h))}catch(w){h(w)}},i=o=>a[o]=u=>new Promise((p,h)=>r(o,u,p,h)),a={};return n=n.apply(e,t),a[Co("asyncIterator")]=()=>a,i("next"),i("throw"),i("return"),a},c_=e=>{var t=e[Co("asyncIterator")],n=!1,r,i={};return t==null?(t=e[Co("iterator")](),r=a=>i[a]=o=>t[a](o)):(t=t.call(e),r=a=>i[a]=o=>{if(n){if(n=!1,a==="throw")throw o;return o}return n=!0,{done:!1,value:new Do(new Promise(u=>{var p=t[a](o);p instanceof Object||Ym("Object expected"),u(p)}),1)}}),i[Co("iterator")]=()=>i,r("next"),"throw"in t?r("throw"):i.throw=a=>{throw a},"return"in t&&r("return"),i},F4=(e,t,n)=>(t=e[Co("asyncIterator")])?t.call(e):(e=e[Co("iterator")](),t={},n=(r,i)=>(i=e[r])&&(t[r]=a=>new Promise((o,u,p)=>(a=i.call(e,a),p=a.done,Promise.resolve(a.value).then(h=>o({value:h,done:p}),u)))),n("next"),n("return"),t),Eo,Y=A4({"shims/process.js"(){Eo=void 0}}),D4=Ce({"../../node_modules/.pnpm/bowser@2.11.0/node_modules/bowser/es5.js"(e,t){Y(),function(n,r){typeof e=="object"&&typeof t=="object"?t.exports=r():typeof define=="function"&&define.amd?define([],r):typeof e=="object"?e.bowser=r():n.bowser=r()}(e,function(){return function(n){var r={};function i(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return n[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(a,o,u){i.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:u})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,o){if(1&o&&(a=i(a)),8&o||4&o&&typeof a=="object"&&a&&a.__esModule)return a;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:a}),2&o&&typeof a!="string")for(var p in a)i.d(u,p,(function(h){return a[h]}).bind(null,p));return u},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=90)}({17:function(n,r,i){r.__esModule=!0,r.default=void 0;var a=i(18),o=function(){function u(){}return u.getFirstMatch=function(p,h){var g=h.match(p);return g&&g.length>0&&g[1]||""},u.getSecondMatch=function(p,h){var g=h.match(p);return g&&g.length>1&&g[2]||""},u.matchAndReturnConst=function(p,h,g){if(p.test(h))return g},u.getWindowsVersionName=function(p){switch(p){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},u.getMacOSVersionName=function(p){var h=p.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(h.push(0),h[0]===10)switch(h[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},u.getAndroidVersionName=function(p){var h=p.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(h.push(0),!(h[0]===1&&h[1]<5))return h[0]===1&&h[1]<6?"Cupcake":h[0]===1&&h[1]>=6?"Donut":h[0]===2&&h[1]<2?"Eclair":h[0]===2&&h[1]===2?"Froyo":h[0]===2&&h[1]>2?"Gingerbread":h[0]===3?"Honeycomb":h[0]===4&&h[1]<1?"Ice Cream Sandwich":h[0]===4&&h[1]<4?"Jelly Bean":h[0]===4&&h[1]>=4?"KitKat":h[0]===5?"Lollipop":h[0]===6?"Marshmallow":h[0]===7?"Nougat":h[0]===8?"Oreo":h[0]===9?"Pie":void 0},u.getVersionPrecision=function(p){return p.split(".").length},u.compareVersions=function(p,h,g){g===void 0&&(g=!1);var f=u.getVersionPrecision(p),_=u.getVersionPrecision(h),w=Math.max(f,_),C=0,R=u.map([p,h],function(S){var b=w-u.getVersionPrecision(S),x=S+new Array(b+1).join(".0");return u.map(x.split("."),function(E){return new Array(20-E.length).join("0")+E}).reverse()});for(g&&(C=w-Math.min(f,_)),w-=1;w>=C;){if(R[0][w]>R[1][w])return 1;if(R[0][w]===R[1][w]){if(w===C)return 0;w-=1}else if(R[0][w]<R[1][w])return-1}},u.map=function(p,h){var g,f=[];if(Array.prototype.map)return Array.prototype.map.call(p,h);for(g=0;g<p.length;g+=1)f.push(h(p[g]));return f},u.find=function(p,h){var g,f;if(Array.prototype.find)return Array.prototype.find.call(p,h);for(g=0,f=p.length;g<f;g+=1){var _=p[g];if(h(_,g))return _}},u.assign=function(p){for(var h,g,f=p,_=arguments.length,w=new Array(_>1?_-1:0),C=1;C<_;C++)w[C-1]=arguments[C];if(Object.assign)return Object.assign.apply(Object,[p].concat(w));var R=function(){var S=w[h];typeof S=="object"&&S!==null&&Object.keys(S).forEach(function(b){f[b]=S[b]})};for(h=0,g=w.length;h<g;h+=1)R();return p},u.getBrowserAlias=function(p){return a.BROWSER_ALIASES_MAP[p]},u.getBrowserTypeByAlias=function(p){return a.BROWSER_MAP[p]||""},u}();r.default=o,n.exports=r.default},18:function(n,r,i){r.__esModule=!0,r.ENGINE_MAP=r.OS_MAP=r.PLATFORMS_MAP=r.BROWSER_MAP=r.BROWSER_ALIASES_MAP=void 0,r.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},r.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},r.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},r.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},r.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(91))&&a.__esModule?a:{default:a},u=i(18);function p(g,f){for(var _=0;_<f.length;_++){var w=f[_];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(g,w.key,w)}}var h=function(){function g(){}var f,_,w;return g.getParser=function(C,R){if(R===void 0&&(R=!1),typeof C!="string")throw new Error("UserAgent should be a string");return new o.default(C,R)},g.parse=function(C){return new o.default(C).getResult()},f=g,w=[{key:"BROWSER_MAP",get:function(){return u.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return u.ENGINE_MAP}},{key:"OS_MAP",get:function(){return u.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return u.PLATFORMS_MAP}}],(_=null)&&p(f.prototype,_),w&&p(f,w),g}();r.default=h,n.exports=r.default},91:function(n,r,i){r.__esModule=!0,r.default=void 0;var a=g(i(92)),o=g(i(93)),u=g(i(94)),p=g(i(95)),h=g(i(17));function g(_){return _&&_.__esModule?_:{default:_}}var f=function(){function _(C,R){if(R===void 0&&(R=!1),C==null||C==="")throw new Error("UserAgent parameter can't be empty");this._ua=C,this.parsedResult={},R!==!0&&this.parse()}var w=_.prototype;return w.getUA=function(){return this._ua},w.test=function(C){return C.test(this._ua)},w.parseBrowser=function(){var C=this;this.parsedResult.browser={};var R=h.default.find(a.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.browser=R.describe(this.getUA())),this.parsedResult.browser},w.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},w.getBrowserName=function(C){return C?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},w.getBrowserVersion=function(){return this.getBrowser().version},w.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},w.parseOS=function(){var C=this;this.parsedResult.os={};var R=h.default.find(o.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.os=R.describe(this.getUA())),this.parsedResult.os},w.getOSName=function(C){var R=this.getOS().name;return C?String(R).toLowerCase()||"":R||""},w.getOSVersion=function(){return this.getOS().version},w.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},w.getPlatformType=function(C){C===void 0&&(C=!1);var R=this.getPlatform().type;return C?String(R).toLowerCase()||"":R||""},w.parsePlatform=function(){var C=this;this.parsedResult.platform={};var R=h.default.find(u.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.platform=R.describe(this.getUA())),this.parsedResult.platform},w.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},w.getEngineName=function(C){return C?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},w.parseEngine=function(){var C=this;this.parsedResult.engine={};var R=h.default.find(p.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.engine=R.describe(this.getUA())),this.parsedResult.engine},w.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},w.getResult=function(){return h.default.assign({},this.parsedResult)},w.satisfies=function(C){var R=this,S={},b=0,x={},E=0;if(Object.keys(C).forEach(function(ee){var oe=C[ee];typeof oe=="string"?(x[ee]=oe,E+=1):typeof oe=="object"&&(S[ee]=oe,b+=1)}),b>0){var M=Object.keys(S),Z=h.default.find(M,function(ee){return R.isOS(ee)});if(Z){var $=this.satisfies(S[Z]);if($!==void 0)return $}var z=h.default.find(M,function(ee){return R.isPlatform(ee)});if(z){var q=this.satisfies(S[z]);if(q!==void 0)return q}}if(E>0){var Q=Object.keys(x),K=h.default.find(Q,function(ee){return R.isBrowser(ee,!0)});if(K!==void 0)return this.compareVersion(x[K])}},w.isBrowser=function(C,R){R===void 0&&(R=!1);var S=this.getBrowserName().toLowerCase(),b=C.toLowerCase(),x=h.default.getBrowserTypeByAlias(b);return R&&x&&(b=x.toLowerCase()),b===S},w.compareVersion=function(C){var R=[0],S=C,b=!1,x=this.getBrowserVersion();if(typeof x=="string")return C[0]===">"||C[0]==="<"?(S=C.substr(1),C[1]==="="?(b=!0,S=C.substr(2)):R=[],C[0]===">"?R.push(1):R.push(-1)):C[0]==="="?S=C.substr(1):C[0]==="~"&&(b=!0,S=C.substr(1)),R.indexOf(h.default.compareVersions(x,S,b))>-1},w.isOS=function(C){return this.getOSName(!0)===String(C).toLowerCase()},w.isPlatform=function(C){return this.getPlatformType(!0)===String(C).toLowerCase()},w.isEngine=function(C){return this.getEngineName(!0)===String(C).toLowerCase()},w.is=function(C,R){return R===void 0&&(R=!1),this.isBrowser(C,R)||this.isOS(C)||this.isPlatform(C)},w.some=function(C){var R=this;return C===void 0&&(C=[]),C.some(function(S){return R.is(S)})},_}();r.default=f,n.exports=r.default},92:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=/version\/(\d+(\.?_?\d+)+)/i,p=[{test:[/googlebot/i],describe:function(h){var g={name:"Googlebot"},f=o.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/opera/i],describe:function(h){var g={name:"Opera"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/opr\/|opios/i],describe:function(h){var g={name:"Opera"},f=o.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/SamsungBrowser/i],describe:function(h){var g={name:"Samsung Internet for Android"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/Whale/i],describe:function(h){var g={name:"NAVER Whale Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/MZBrowser/i],describe:function(h){var g={name:"MZ Browser"},f=o.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/focus/i],describe:function(h){var g={name:"Focus"},f=o.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/swing/i],describe:function(h){var g={name:"Swing"},f=o.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/coast/i],describe:function(h){var g={name:"Opera Coast"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(h){var g={name:"Opera Touch"},f=o.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/yabrowser/i],describe:function(h){var g={name:"Yandex Browser"},f=o.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/ucbrowser/i],describe:function(h){var g={name:"UC Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/Maxthon|mxios/i],describe:function(h){var g={name:"Maxthon"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/epiphany/i],describe:function(h){var g={name:"Epiphany"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/puffin/i],describe:function(h){var g={name:"Puffin"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/sleipnir/i],describe:function(h){var g={name:"Sleipnir"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/k-meleon/i],describe:function(h){var g={name:"K-Meleon"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/micromessenger/i],describe:function(h){var g={name:"WeChat"},f=o.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/qqbrowser/i],describe:function(h){var g={name:/qqbrowserlite/i.test(h)?"QQ Browser Lite":"QQ Browser"},f=o.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/msie|trident/i],describe:function(h){var g={name:"Internet Explorer"},f=o.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/\sedg\//i],describe:function(h){var g={name:"Microsoft Edge"},f=o.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/edg([ea]|ios)/i],describe:function(h){var g={name:"Microsoft Edge"},f=o.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/vivaldi/i],describe:function(h){var g={name:"Vivaldi"},f=o.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/seamonkey/i],describe:function(h){var g={name:"SeaMonkey"},f=o.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/sailfish/i],describe:function(h){var g={name:"Sailfish"},f=o.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,h);return f&&(g.version=f),g}},{test:[/silk/i],describe:function(h){var g={name:"Amazon Silk"},f=o.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/phantom/i],describe:function(h){var g={name:"PhantomJS"},f=o.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/slimerjs/i],describe:function(h){var g={name:"SlimerJS"},f=o.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(h){var g={name:"BlackBerry"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/(web|hpw)[o0]s/i],describe:function(h){var g={name:"WebOS Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/bada/i],describe:function(h){var g={name:"Bada"},f=o.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/tizen/i],describe:function(h){var g={name:"Tizen"},f=o.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/qupzilla/i],describe:function(h){var g={name:"QupZilla"},f=o.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/firefox|iceweasel|fxios/i],describe:function(h){var g={name:"Firefox"},f=o.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/electron/i],describe:function(h){var g={name:"Electron"},f=o.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/MiuiBrowser/i],describe:function(h){var g={name:"Miui"},f=o.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/chromium/i],describe:function(h){var g={name:"Chromium"},f=o.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/chrome|crios|crmo/i],describe:function(h){var g={name:"Chrome"},f=o.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/GSA/i],describe:function(h){var g={name:"Google Search"},f=o.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:function(h){var g=!h.test(/like android/i),f=h.test(/android/i);return g&&f},describe:function(h){var g={name:"Android Browser"},f=o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/playstation 4/i],describe:function(h){var g={name:"PlayStation 4"},f=o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/safari|applewebkit/i],describe:function(h){var g={name:"Safari"},f=o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/.*/i],describe:function(h){var g=h.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:o.default.getFirstMatch(g,h),version:o.default.getSecondMatch(g,h)}}}];r.default=p,n.exports=r.default},93:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:[/Roku\/DVP/],describe:function(h){var g=o.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,h);return{name:u.OS_MAP.Roku,version:g}}},{test:[/windows phone/i],describe:function(h){var g=o.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.WindowsPhone,version:g}}},{test:[/windows /i],describe:function(h){var g=o.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,h),f=o.default.getWindowsVersionName(g);return{name:u.OS_MAP.Windows,version:g,versionName:f}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(h){var g={name:u.OS_MAP.iOS},f=o.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,h);return f&&(g.version=f),g}},{test:[/macintosh/i],describe:function(h){var g=o.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,h).replace(/[_\s]/g,"."),f=o.default.getMacOSVersionName(g),_={name:u.OS_MAP.MacOS,version:g};return f&&(_.versionName=f),_}},{test:[/(ipod|iphone|ipad)/i],describe:function(h){var g=o.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,h).replace(/[_\s]/g,".");return{name:u.OS_MAP.iOS,version:g}}},{test:function(h){var g=!h.test(/like android/i),f=h.test(/android/i);return g&&f},describe:function(h){var g=o.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,h),f=o.default.getAndroidVersionName(g),_={name:u.OS_MAP.Android,version:g};return f&&(_.versionName=f),_}},{test:[/(web|hpw)[o0]s/i],describe:function(h){var g=o.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,h),f={name:u.OS_MAP.WebOS};return g&&g.length&&(f.version=g),f}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(h){var g=o.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,h)||o.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,h)||o.default.getFirstMatch(/\bbb(\d+)/i,h);return{name:u.OS_MAP.BlackBerry,version:g}}},{test:[/bada/i],describe:function(h){var g=o.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.Bada,version:g}}},{test:[/tizen/i],describe:function(h){var g=o.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.Tizen,version:g}}},{test:[/linux/i],describe:function(){return{name:u.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:u.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(h){var g=o.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.PlayStation4,version:g}}}];r.default=p,n.exports=r.default},94:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(h){var g=o.default.getFirstMatch(/(can-l01)/i,h)&&"Nova",f={type:u.PLATFORMS_MAP.mobile,vendor:"Huawei"};return g&&(f.model=g),f}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet}}},{test:function(h){var g=h.test(/ipod|iphone/i),f=h.test(/like (ipod|iphone)/i);return g&&!f},describe:function(h){var g=o.default.getFirstMatch(/(ipod|iphone)/i,h);return{type:u.PLATFORMS_MAP.mobile,vendor:"Apple",model:g}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getBrowserName(!0)==="blackberry"},describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(h){return h.getBrowserName(!0)==="bada"},describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getBrowserName()==="windows phone"},describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(h){var g=Number(String(h.getOSVersion()).split(".")[0]);return h.getOSName(!0)==="android"&&g>=3},describe:function(){return{type:u.PLATFORMS_MAP.tablet}}},{test:function(h){return h.getOSName(!0)==="android"},describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getOSName(!0)==="macos"},describe:function(){return{type:u.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(h){return h.getOSName(!0)==="windows"},describe:function(){return{type:u.PLATFORMS_MAP.desktop}}},{test:function(h){return h.getOSName(!0)==="linux"},describe:function(){return{type:u.PLATFORMS_MAP.desktop}}},{test:function(h){return h.getOSName(!0)==="playstation 4"},describe:function(){return{type:u.PLATFORMS_MAP.tv}}},{test:function(h){return h.getOSName(!0)==="roku"},describe:function(){return{type:u.PLATFORMS_MAP.tv}}}];r.default=p,n.exports=r.default},95:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:function(h){return h.getBrowserName(!0)==="microsoft edge"},describe:function(h){if(/\sedg\//i.test(h))return{name:u.ENGINE_MAP.Blink};var g=o.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,h);return{name:u.ENGINE_MAP.EdgeHTML,version:g}}},{test:[/trident/i],describe:function(h){var g={name:u.ENGINE_MAP.Trident},f=o.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:function(h){return h.test(/presto/i)},describe:function(h){var g={name:u.ENGINE_MAP.Presto},f=o.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:function(h){var g=h.test(/gecko/i),f=h.test(/like gecko/i);return g&&!f},describe:function(h){var g={name:u.ENGINE_MAP.Gecko},f=o.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:u.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(h){var g={name:u.ENGINE_MAP.WebKit},f=o.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}}];r.default=p,n.exports=r.default}})})}}),eg=Ce({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/grammar.js"(e,t){Y();var n=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(r){return r.encoding?"rtpmap:%d %s/%s/%s":r.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(r){return r.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(r){return r.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(r){return"extmap:%d"+(r.direction?"/%s":"%v")+(r["encrypt-uri"]?" %s":"%v")+" %s"+(r.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(r){return r.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(r){var i="candidate:%s %d %s %d %s %d typ %s";return i+=r.raddr!=null?" raddr %s rport %d":"%v%v",i+=r.tcptype!=null?" tcptype %s":"%v",r.generation!=null&&(i+=" generation %d"),i+=r["network-id"]!=null?" network-id %d":"%v",i+=r["network-cost"]!=null?" network-cost %d":"%v",i}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(r){var i="ssrc:%d";return r.attribute!=null&&(i+=" %s",r.value!=null&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(r){return r.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(r){return r.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(r){return"imageattr:%s %s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(r){return"simulcast:%s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(r){return"ts-refclk:%s"+(r.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(r){var i="mediaclk:";return i+=r.id!=null?"id=%s %s":"%v%s",i+=r.mediaClockValue!=null?"=%s":"",i+=r.rateNumerator!=null?" rate=%s":"",i+=r.rateDenominator!=null?"/%s":"",i}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(r){var i=n[r];i.forEach(function(a){a.reg||(a.reg=/(.*)/),a.format||(a.format="%s")})})}}),N4=Ce({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/parser.js"(e){Y();var t=function(u){return String(Number(u))===u?Number(u):u},n=function(u,p,h,g){if(g&&!h)p[g]=t(u[1]);else for(var f=0;f<h.length;f+=1)u[f+1]!=null&&(p[h[f]]=t(u[f+1]))},r=function(u,p,h){var g=u.name&&u.names;u.push&&!p[u.push]?p[u.push]=[]:g&&!p[u.name]&&(p[u.name]={});var f=u.push?{}:g?p[u.name]:p;n(h.match(u.reg),f,u.names,u.name),u.push&&p[u.push].push(f)},i=eg(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(u){var p={},h=[],g=p;return u.split(/(\r\n|\r|\n)/).filter(a).forEach(function(f){var _=f[0],w=f.slice(2);_==="m"&&(h.push({rtp:[],fmtp:[]}),g=h[h.length-1]);for(var C=0;C<(i[_]||[]).length;C+=1){var R=i[_][C];if(R.reg.test(w))return r(R,g,w)}}),p.media=h,p};var o=function(u,p){var h=p.split(/=(.+)/,2);return h.length===2?u[h[0]]=t(h[1]):h.length===1&&p.length>1&&(u[h[0]]=void 0),u};e.parseParams=function(u){return u.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(u){return u.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(u){for(var p=[],h=u.split(" ").map(t),g=0;g<h.length;g+=3)p.push({component:h[g],ip:h[g+1],port:h[g+2]});return p},e.parseImageAttributes=function(u){return u.split(" ").map(function(p){return p.substring(1,p.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(u){return u.split(";").map(function(p){return p.split(",").map(function(h){var g,f=!1;return h[0]!=="~"?g=t(h):(g=t(h.substring(1,h.length)),f=!0),{scid:g,paused:f}})})}}}),O4=Ce({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/writer.js"(e,t){Y();var n=eg(),r=/%[sdv%]/g,i=function(p){var h=1,g=arguments,f=g.length;return p.replace(r,function(_){if(h>=f)return _;var w=g[h];switch(h+=1,_){case"%%":return"%";case"%s":return String(w);case"%d":return Number(w);case"%v":return""}})},a=function(p,h,g){var f=h.format instanceof Function?h.format(h.push?g:g[h.name]):h.format,_=[p+"="+f];if(h.names)for(var w=0;w<h.names.length;w+=1){var C=h.names[w];h.name?_.push(g[h.name][C]):_.push(g[h.names[w]])}else _.push(g[h.name]);return i.apply(null,_)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],u=["i","c","b","a"];t.exports=function(p,h){h=h||{},p.version==null&&(p.version=0),p.name==null&&(p.name=" "),p.media.forEach(function(w){w.payloads==null&&(w.payloads="")});var g=h.outerOrder||o,f=h.innerOrder||u,_=[];return g.forEach(function(w){n[w].forEach(function(C){C.name in p&&p[C.name]!=null?_.push(a(w,C,p)):C.push in p&&p[C.push]!=null&&p[C.push].forEach(function(R){_.push(a(w,C,R))})})}),p.media.forEach(function(w){_.push(a("m",n.m[0],w)),f.forEach(function(C){n[C].forEach(function(R){R.name in w&&w[R.name]!=null?_.push(a(C,R,w)):R.push in w&&w[R.push]!=null&&w[R.push].forEach(function(S){_.push(a(C,R,S))})})})}),_.join(`\r
`)+`\r
`}}}),Oi=Ce({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/index.js"(e){Y();var t=N4(),n=O4(),r=eg();e.grammar=r,e.write=n,e.parse=t.parse,e.parseParams=t.parseParams,e.parseFmtpConfig=t.parseFmtpConfig,e.parsePayloads=t.parsePayloads,e.parseRemoteCandidates=t.parseRemoteCandidates,e.parseImageAttributes=t.parseImageAttributes,e.parseSimulcastStreamList=t.parseSimulcastStreamList}}),l_=Ce({"../../node_modules/.pnpm/ua-parser-js@1.0.40/node_modules/ua-parser-js/src/ua-parser.js"(e,t){Y(),function(n,r){var i="1.0.40",a="",o="?",u="function",p="undefined",h="object",g="string",f="major",_="model",w="name",C="type",R="vendor",S="version",b="architecture",x="console",E="mobile",M="tablet",Z="smarttv",$="wearable",z="embedded",q=500,Q="Amazon",K="Apple",ee="ASUS",oe="BlackBerry",ce="Browser",ne="Chrome",ke="Edge",_e="Firefox",le="Google",fe="Huawei",ge="LG",Ee="Microsoft",Oe="Motorola",Je="Opera",ut="Samsung",ot="Sharp",nt="Sony",He="Xiaomi",Qe="Zebra",mt="Facebook",Lt="Chromium OS",Wt="Mac OS",Fn=" Browser",Bi=function(yt,Rt){var rt={};for(var zt in yt)Rt[zt]&&Rt[zt].length%2===0?rt[zt]=Rt[zt].concat(yt[zt]):rt[zt]=yt[zt];return rt},fr=function(yt){for(var Rt={},rt=0;rt<yt.length;rt++)Rt[yt[rt].toUpperCase()]=yt[rt];return Rt},mi=function(yt,Rt){return typeof yt===g?wn(Rt).indexOf(wn(yt))!==-1:!1},wn=function(yt){return yt.toLowerCase()},mr=function(yt){return typeof yt===g?yt.replace(/[^\d\.]/g,a).split(".")[0]:r},Dn=function(yt,Rt){if(typeof yt===g)return yt=yt.replace(/^\s\s*/,a),typeof Rt===p?yt:yt.substring(0,q)},sn=function(yt,Rt){for(var rt=0,zt,Rr,gr,Ut,ct,zn;rt<Rt.length&&!ct;){var ks=Rt[rt],fn=Rt[rt+1];for(zt=Rr=0;zt<ks.length&&!ct&&ks[zt];)if(ct=ks[zt++].exec(yt),ct)for(gr=0;gr<fn.length;gr++)zn=ct[++Rr],Ut=fn[gr],typeof Ut===h&&Ut.length>0?Ut.length===2?typeof Ut[1]==u?this[Ut[0]]=Ut[1].call(this,zn):this[Ut[0]]=Ut[1]:Ut.length===3?typeof Ut[1]===u&&!(Ut[1].exec&&Ut[1].test)?this[Ut[0]]=zn?Ut[1].call(this,zn,Ut[2]):r:this[Ut[0]]=zn?zn.replace(Ut[1],Ut[2]):r:Ut.length===4&&(this[Ut[0]]=zn?Ut[3].call(this,zn.replace(Ut[1],Ut[2])):r):this[Ut]=zn||r;rt+=2}},Tn=function(yt,Rt){for(var rt in Rt)if(typeof Rt[rt]===h&&Rt[rt].length>0){for(var zt=0;zt<Rt[rt].length;zt++)if(mi(Rt[rt][zt],yt))return rt===o?r:rt}else if(mi(Rt[rt],yt))return rt===o?r:rt;return Rt.hasOwnProperty("*")?Rt["*"]:yt},Kr={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},xn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},ti={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[S,[w,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[S,[w,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[w,S],[/opios[\/ ]+([\w\.]+)/i],[S,[w,Je+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[S,[w,Je+" GX"]],[/\bopr\/([\w\.]+)/i],[S,[w,Je]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[S,[w,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[S,[w,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[w,S],[/quark(?:pc)?\/([-\w\.]+)/i],[S,[w,"Quark"]],[/\bddg\/([\w\.]+)/i],[S,[w,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[S,[w,"UC"+ce]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[S,[w,"WeChat"]],[/konqueror\/([\w\.]+)/i],[S,[w,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[S,[w,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[S,[w,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[S,[w,"Smart Lenovo "+ce]],[/(avast|avg)\/([\w\.]+)/i],[[w,/(.+)/,"$1 Secure "+ce],S],[/\bfocus\/([\w\.]+)/i],[S,[w,_e+" Focus"]],[/\bopt\/([\w\.]+)/i],[S,[w,Je+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[S,[w,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[S,[w,"Dolphin"]],[/coast\/([\w\.]+)/i],[S,[w,Je+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[S,[w,"MIUI"+Fn]],[/fxios\/([\w\.-]+)/i],[S,[w,_e]],[/\bqihoobrowser\/?([\w\.]*)/i],[S,[w,"360"]],[/\b(qq)\/([\w\.]+)/i],[[w,/(.+)/,"$1Browser"],S],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[w,/(.+)/,"$1"+Fn],S],[/samsungbrowser\/([\w\.]+)/i],[S,[w,ut+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[S,[w,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[w,"Sogou Mobile"],S],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[w,S],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[w],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[S,w],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[w,mt],S],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[w,S],[/\bgsa\/([\w\.]+) .*safari\//i],[S,[w,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[S,[w,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[S,[w,ne+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[w,ne+" WebView"],S],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[S,[w,"Android "+ce]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[w,S],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[S,[w,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[S,w],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[w,[S,Tn,Kr]],[/(webkit|khtml)\/([\w\.]+)/i],[w,S],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[w,"Netscape"],S],[/(wolvic|librewolf)\/([\w\.]+)/i],[w,S],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[S,[w,_e+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[w,[S,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[w,[S,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[b,"amd64"]],[/(ia32(?=;))/i],[[b,wn]],[/((?:i[346]|x)86)[;\)]/i],[[b,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[b,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[b,"armhf"]],[/windows (ce|mobile); ppc;/i],[[b,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[b,/ower/,a,wn]],[/(sun4\w)[;\)]/i],[[b,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[b,wn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[_,[R,ut],[C,M]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[_,[R,ut],[C,E]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[_,[R,K],[C,E]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[_,[R,K],[C,M]],[/(macintosh);/i],[_,[R,K]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[_,[R,ot],[C,E]],[/(?:honor)([-\w ]+)[;\)]/i],[_,[R,"Honor"],[C,E]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[_,[R,fe],[C,M]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[_,[R,fe],[C,E]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[_,/_/g," "],[R,He],[C,E]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[_,/_/g," "],[R,He],[C,M]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[_,[R,"OPPO"],[C,E]],[/\b(opd2\d{3}a?) bui/i],[_,[R,"OPPO"],[C,M]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[_,[R,"Vivo"],[C,E]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[_,[R,"Realme"],[C,E]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[_,[R,Oe],[C,E]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[_,[R,Oe],[C,M]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[_,[R,ge],[C,M]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[_,[R,ge],[C,E]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[_,[R,"Lenovo"],[C,M]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[_,/_/g," "],[R,"Nokia"],[C,E]],[/(pixel c)\b/i],[_,[R,le],[C,M]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[_,[R,le],[C,E]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_,[R,nt],[C,E]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[_,"Xperia Tablet"],[R,nt],[C,M]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[_,[R,"OnePlus"],[C,E]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[_,[R,Q],[C,M]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[_,/(.+)/g,"Fire Phone $1"],[R,Q],[C,E]],[/(playbook);[-\w\),; ]+(rim)/i],[_,R,[C,M]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[_,[R,oe],[C,E]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[_,[R,ee],[C,M]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[_,[R,ee],[C,E]],[/(nexus 9)/i],[_,[R,"HTC"],[C,M]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[R,[_,/_/g," "],[C,E]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[_,[R,"TCL"],[C,M]],[/(itel) ((\w+))/i],[[R,wn],_,[C,Tn,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[_,[R,"Acer"],[C,M]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[_,[R,"Meizu"],[C,E]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[_,[R,"Ulefone"],[C,E]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[_,[R,"Energizer"],[C,E]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[_,[R,"Cat"],[C,E]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[_,[R,"Smartfren"],[C,E]],[/droid.+; (a(?:015|06[35]|142p?))/i],[_,[R,"Nothing"],[C,E]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[R,_,[C,E]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[R,_,[C,M]],[/(surface duo)/i],[_,[R,Ee],[C,M]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[_,[R,"Fairphone"],[C,E]],[/(u304aa)/i],[_,[R,"AT&T"],[C,E]],[/\bsie-(\w*)/i],[_,[R,"Siemens"],[C,E]],[/\b(rct\w+) b/i],[_,[R,"RCA"],[C,M]],[/\b(venue[\d ]{2,7}) b/i],[_,[R,"Dell"],[C,M]],[/\b(q(?:mv|ta)\w+) b/i],[_,[R,"Verizon"],[C,M]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[_,[R,"Barnes & Noble"],[C,M]],[/\b(tm\d{3}\w+) b/i],[_,[R,"NuVision"],[C,M]],[/\b(k88) b/i],[_,[R,"ZTE"],[C,M]],[/\b(nx\d{3}j) b/i],[_,[R,"ZTE"],[C,E]],[/\b(gen\d{3}) b.+49h/i],[_,[R,"Swiss"],[C,E]],[/\b(zur\d{3}) b/i],[_,[R,"Swiss"],[C,M]],[/\b((zeki)?tb.*\b) b/i],[_,[R,"Zeki"],[C,M]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[R,"Dragon Touch"],_,[C,M]],[/\b(ns-?\w{0,9}) b/i],[_,[R,"Insignia"],[C,M]],[/\b((nxa|next)-?\w{0,9}) b/i],[_,[R,"NextBook"],[C,M]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[R,"Voice"],_,[C,E]],[/\b(lvtel\-)?(v1[12]) b/i],[[R,"LvTel"],_,[C,E]],[/\b(ph-1) /i],[_,[R,"Essential"],[C,E]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[_,[R,"Envizen"],[C,M]],[/\b(trio[-\w\. ]+) b/i],[_,[R,"MachSpeed"],[C,M]],[/\btu_(1491) b/i],[_,[R,"Rotor"],[C,M]],[/(shield[\w ]+) b/i],[_,[R,"Nvidia"],[C,M]],[/(sprint) (\w+)/i],[R,_,[C,E]],[/(kin\.[onetw]{3})/i],[[_,/\./g," "],[R,Ee],[C,E]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[_,[R,Qe],[C,M]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[_,[R,Qe],[C,E]],[/smart-tv.+(samsung)/i],[R,[C,Z]],[/hbbtv.+maple;(\d+)/i],[[_,/^/,"SmartTV"],[R,ut],[C,Z]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[R,ge],[C,Z]],[/(apple) ?tv/i],[R,[_,K+" TV"],[C,Z]],[/crkey/i],[[_,ne+"cast"],[R,le],[C,Z]],[/droid.+aft(\w+)( bui|\))/i],[_,[R,Q],[C,Z]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[_,[R,ot],[C,Z]],[/(bravia[\w ]+)( bui|\))/i],[_,[R,nt],[C,Z]],[/(mitv-\w{5}) bui/i],[_,[R,He],[C,Z]],[/Hbbtv.*(technisat) (.*);/i],[R,_,[C,Z]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[R,Dn],[_,Dn],[C,Z]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[C,Z]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[R,_,[C,x]],[/droid.+; (shield) bui/i],[_,[R,"Nvidia"],[C,x]],[/(playstation [345portablevi]+)/i],[_,[R,nt],[C,x]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[_,[R,Ee],[C,x]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[_,[R,ut],[C,$]],[/((pebble))app/i],[R,_,[C,$]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[_,[R,K],[C,$]],[/droid.+; (glass) \d/i],[_,[R,le],[C,$]],[/droid.+; (wt63?0{2,3})\)/i],[_,[R,Qe],[C,$]],[/droid.+; (glass) \d/i],[_,[R,le],[C,$]],[/(pico) (4|neo3(?: link|pro)?)/i],[R,_,[C,$]],[/; (quest( \d| pro)?)/i],[_,[R,mt],[C,$]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[R,[C,z]],[/(aeobc)\b/i],[_,[R,Q],[C,z]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[_,[C,E]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[_,[C,M]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[C,M]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[C,E]],[/(android[-\w\. ]{0,9});.+buil/i],[_,[R,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[S,[w,ke+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[w,S],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[S,[w,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[w,S],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[S,w]],os:[[/microsoft (windows) (vista|xp)/i],[w,S],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[w,[S,Tn,xn]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[S,Tn,xn],[w,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[S,/_/g,"."],[w,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[w,Wt],[S,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[S,w],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[w,S],[/\(bb(10);/i],[S,[w,oe]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[S,[w,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[S,[w,_e+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[S,[w,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[S,[w,"watchOS"]],[/crkey\/([\d\.]+)/i],[S,[w,ne+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[w,Lt],S],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[w,S],[/(sunos) ?([\w\.\d]*)/i],[[w,"Solaris"],S],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[w,S]]},pn=function(yt,Rt){if(typeof yt===h&&(Rt=yt,yt=r),!(this instanceof pn))return new pn(yt,Rt).getResult();var rt=typeof n!==p&&n.navigator?n.navigator:r,zt=yt||(rt&&rt.userAgent?rt.userAgent:a),Rr=rt&&rt.userAgentData?rt.userAgentData:r,gr=Rt?Bi(ti,Rt):ti,Ut=rt&&rt.userAgent==zt;return this.getBrowser=function(){var ct={};return ct[w]=r,ct[S]=r,sn.call(ct,zt,gr.browser),ct[f]=mr(ct[S]),Ut&&rt&&rt.brave&&typeof rt.brave.isBrave==u&&(ct[w]="Brave"),ct},this.getCPU=function(){var ct={};return ct[b]=r,sn.call(ct,zt,gr.cpu),ct},this.getDevice=function(){var ct={};return ct[R]=r,ct[_]=r,ct[C]=r,sn.call(ct,zt,gr.device),Ut&&!ct[C]&&Rr&&Rr.mobile&&(ct[C]=E),Ut&&ct[_]=="Macintosh"&&rt&&typeof rt.standalone!==p&&rt.maxTouchPoints&&rt.maxTouchPoints>2&&(ct[_]="iPad",ct[C]=M),ct},this.getEngine=function(){var ct={};return ct[w]=r,ct[S]=r,sn.call(ct,zt,gr.engine),ct},this.getOS=function(){var ct={};return ct[w]=r,ct[S]=r,sn.call(ct,zt,gr.os),Ut&&!ct[w]&&Rr&&Rr.platform&&Rr.platform!="Unknown"&&(ct[w]=Rr.platform.replace(/chrome os/i,Lt).replace(/macos/i,Wt)),ct},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return zt},this.setUA=function(ct){return zt=typeof ct===g&&ct.length>q?Dn(ct,q):ct,this},this.setUA(zt),this};pn.VERSION=i,pn.BROWSER=fr([w,S,f]),pn.CPU=fr([b]),pn.DEVICE=fr([_,R,C,x,E,Z,M,$,z]),pn.ENGINE=pn.OS=fr([w,S]),typeof e!==p?(typeof t!==p&&t.exports&&(e=t.exports=pn),e.UAParser=pn):typeof define===u&&define.amd?define(function(){return pn}):typeof n!==p&&(n.UAParser=pn);var Un=typeof n!==p&&(n.jQuery||n.Zepto);if(Un&&!Un.ua){var Ui=new pn;Un.ua=Ui.getResult(),Un.ua.get=function(){return Ui.getUA()},Un.ua.set=function(yt){Ui.setUA(yt);var Rt=Ui.getResult();for(var rt in Rt)Un.ua[rt]=Rt[rt]}}}(typeof window=="object"?window:e)}}),M4=Ce({"../../node_modules/.pnpm/jsrsasign@11.1.0/node_modules/jsrsasign/lib/jsrsasign.js"(e){Y();var t={};t.userAgent=!1;var n={},r="11.1.0",i="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license",a=a||function(s,c){var l={},d=l.lib={},v=d.Base=function(){function P(){}return{extend:function(D){P.prototype=this;var A=new P;return D&&A.mixIn(D),A.hasOwnProperty("init")||(A.init=function(){A.$super.init.apply(this,arguments)}),A.init.prototype=A,A.$super=this,A},create:function(){var D=this.extend();return D.init.apply(D,arguments),D},init:function(){},mixIn:function(D){for(var A in D)D.hasOwnProperty(A)&&(this[A]=D[A]);D.hasOwnProperty("toString")&&(this.toString=D.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),m=d.WordArray=v.extend({init:function(P,D){P=this.words=P||[],D!=c?this.sigBytes=D:this.sigBytes=P.length*4},toString:function(P){return(P||k).stringify(this)},concat:function(P){var D=this.words,A=P.words,N=this.sigBytes,j=P.sigBytes;if(this.clamp(),N%4)for(var W=0;W<j;W++){var se=A[W>>>2]>>>24-W%4*8&255;D[N+W>>>2]|=se<<24-(N+W)%4*8}else for(var W=0;W<j;W+=4)D[N+W>>>2]=A[W>>>2];return this.sigBytes+=j,this},clamp:function(){var P=this.words,D=this.sigBytes;P[D>>>2]&=4294967295<<32-D%4*8,P.length=s.ceil(D/4)},clone:function(){var P=v.clone.call(this);return P.words=this.words.slice(0),P},random:function(P){for(var D=[],A=0;A<P;A+=4)D.push(s.random()*4294967296|0);return new m.init(D,P)}}),T=l.enc={},k=T.Hex={stringify:function(P){for(var D=P.words,A=P.sigBytes,N=[],j=0;j<A;j++){var W=D[j>>>2]>>>24-j%4*8&255;N.push((W>>>4).toString(16)),N.push((W&15).toString(16))}return N.join("")},parse:function(P){for(var D=P.length,A=[],N=0;N<D;N+=2)A[N>>>3]|=parseInt(P.substr(N,2),16)<<24-N%8*4;return new m.init(A,D/2)}},O=T.Latin1={stringify:function(P){for(var D=P.words,A=P.sigBytes,N=[],j=0;j<A;j++){var W=D[j>>>2]>>>24-j%4*8&255;N.push(String.fromCharCode(W))}return N.join("")},parse:function(P){for(var D=P.length,A=[],N=0;N<D;N++)A[N>>>2]|=(P.charCodeAt(N)&255)<<24-N%4*8;return new m.init(A,D)}},F=T.Utf8={stringify:function(P){try{return decodeURIComponent(escape(O.stringify(P)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(P){return O.parse(unescape(encodeURIComponent(P)))}},U=d.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new m.init,this._nDataBytes=0},_append:function(P){typeof P=="string"&&(P=F.parse(P)),this._data.concat(P),this._nDataBytes+=P.sigBytes},_process:function(P){var D=this._data,A=D.words,N=D.sigBytes,j=this.blockSize,W=j*4,se=N/W;P?se=s.ceil(se):se=s.max((se|0)-this._minBufferSize,0);var de=se*j,ue=s.min(de*4,N);if(de){for(var pe=0;pe<de;pe+=j)this._doProcessBlock(A,pe);var G=A.splice(0,de);D.sigBytes-=ue}return new m.init(G,ue)},clone:function(){var P=v.clone.call(this);return P._data=this._data.clone(),P},_minBufferSize:0});d.Hasher=U.extend({cfg:v.extend(),init:function(P){this.cfg=this.cfg.extend(P),this.reset()},reset:function(){U.reset.call(this),this._doReset()},update:function(P){return this._append(P),this._process(),this},finalize:function(P){P&&this._append(P);var D=this._doFinalize();return D},blockSize:512/32,_createHelper:function(P){return function(D,A){return new P.init(A).finalize(D)}},_createHmacHelper:function(P){return function(D,A){return new L.HMAC.init(P,A).finalize(D)}}});var L=l.algo={};return l}(Math);(function(s){var v=a,c=v.lib,l=c.Base,d=c.WordArray,v=v.x64={};v.Word=l.extend({init:function(m,T){this.high=m,this.low=T}}),v.WordArray=l.extend({init:function(m,T){m=this.words=m||[],this.sigBytes=T!=s?T:8*m.length},toX32:function(){for(var m=this.words,T=m.length,k=[],O=0;O<T;O++){var F=m[O];k.push(F.high),k.push(F.low)}return d.create(k,this.sigBytes)},clone:function(){for(var m=l.clone.call(this),T=m.words=this.words.slice(0),k=T.length,O=0;O<k;O++)T[O]=T[O].clone();return m}})})(),a.lib.Cipher||function(s){var D=a,c=D.lib,l=c.Base,d=c.WordArray,v=c.BufferedBlockAlgorithm,m=D.enc.Base64,T=D.algo.EvpKDF,k=c.Cipher=v.extend({cfg:l.extend(),createEncryptor:function(N,j){return this.create(this._ENC_XFORM_MODE,N,j)},createDecryptor:function(N,j){return this.create(this._DEC_XFORM_MODE,N,j)},init:function(N,j,W){this.cfg=this.cfg.extend(W),this._xformMode=N,this._key=j,this.reset()},reset:function(){v.reset.call(this),this._doReset()},process:function(N){return this._append(N),this._process()},finalize:function(N){return N&&this._append(N),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(N){return{encrypt:function(j,W,se){return(typeof W=="string"?A:P).encrypt(N,j,W,se)},decrypt:function(j,W,se){return(typeof W=="string"?A:P).decrypt(N,j,W,se)}}}});c.StreamCipher=k.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var L=D.mode={},O=function(N,j,W){var se=this._iv;se?this._iv=s:se=this._prevBlock;for(var de=0;de<W;de++)N[j+de]^=se[de]},F=(c.BlockCipherMode=l.extend({createEncryptor:function(N,j){return this.Encryptor.create(N,j)},createDecryptor:function(N,j){return this.Decryptor.create(N,j)},init:function(N,j){this._cipher=N,this._iv=j}})).extend();F.Encryptor=F.extend({processBlock:function(N,j){var W=this._cipher,se=W.blockSize;O.call(this,N,j,se),W.encryptBlock(N,j),this._prevBlock=N.slice(j,j+se)}}),F.Decryptor=F.extend({processBlock:function(N,j){var W=this._cipher,se=W.blockSize,de=N.slice(j,j+se);W.decryptBlock(N,j),O.call(this,N,j,se),this._prevBlock=de}}),L=L.CBC=F,F=(D.pad={}).Pkcs7={pad:function(N,j){for(var W=4*j,W=W-N.sigBytes%W,se=W<<24|W<<16|W<<8|W,de=[],ue=0;ue<W;ue+=4)de.push(se);W=d.create(de,W),N.concat(W)},unpad:function(N){N.sigBytes-=N.words[N.sigBytes-1>>>2]&255}},c.BlockCipher=k.extend({cfg:k.cfg.extend({mode:L,padding:F}),reset:function(){k.reset.call(this);var j=this.cfg,N=j.iv,j=j.mode;if(this._xformMode==this._ENC_XFORM_MODE)var W=j.createEncryptor;else W=j.createDecryptor,this._minBufferSize=1;this._mode=W.call(j,this,N&&N.words)},_doProcessBlock:function(N,j){this._mode.processBlock(N,j)},_doFinalize:function(){var N=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){N.pad(this._data,this.blockSize);var j=this._process(!0)}else j=this._process(!0),N.unpad(j);return j},blockSize:4});var U=c.CipherParams=l.extend({init:function(N){this.mixIn(N)},toString:function(N){return(N||this.formatter).stringify(this)}}),L=(D.format={}).OpenSSL={stringify:function(N){var j=N.ciphertext;return N=N.salt,(N?d.create([1398893684,1701076831]).concat(N).concat(j):j).toString(m)},parse:function(N){N=m.parse(N);var j=N.words;if(j[0]==1398893684&&j[1]==1701076831){var W=d.create(j.slice(2,4));j.splice(0,4),N.sigBytes-=16}return U.create({ciphertext:N,salt:W})}},P=c.SerializableCipher=l.extend({cfg:l.extend({format:L}),encrypt:function(N,j,W,se){se=this.cfg.extend(se);var de=N.createEncryptor(W,se);return j=de.finalize(j),de=de.cfg,U.create({ciphertext:j,key:W,iv:de.iv,algorithm:N,mode:de.mode,padding:de.padding,blockSize:N.blockSize,formatter:se.format})},decrypt:function(N,j,W,se){return se=this.cfg.extend(se),j=this._parse(j,se.format),N.createDecryptor(W,se).finalize(j.ciphertext)},_parse:function(N,j){return typeof N=="string"?j.parse(N,this):N}}),D=(D.kdf={}).OpenSSL={execute:function(N,j,W,se){return se||(se=d.random(8)),N=T.create({keySize:j+W}).compute(N,se),W=d.create(N.words.slice(j),4*W),N.sigBytes=4*j,U.create({key:N,iv:W,salt:se})}},A=c.PasswordBasedCipher=P.extend({cfg:P.cfg.extend({kdf:D}),encrypt:function(N,j,W,se){return se=this.cfg.extend(se),W=se.kdf.execute(W,N.keySize,N.ivSize),se.iv=W.iv,N=P.encrypt.call(this,N,j,W.key,se),N.mixIn(W),N},decrypt:function(N,j,W,se){return se=this.cfg.extend(se),j=this._parse(j,se.format),W=se.kdf.execute(W,N.keySize,N.ivSize,j.salt),se.iv=W.iv,P.decrypt.call(this,N,j,W.key,se)}})}(),function(){for(var s=a,c=s.lib.BlockCipher,G=s.algo,l=[],d=[],v=[],m=[],T=[],k=[],O=[],F=[],U=[],L=[],P=[],D=0;256>D;D++)P[D]=128>D?D<<1:D<<1^283;for(var A=0,N=0,D=0;256>D;D++){var j=N^N<<1^N<<2^N<<3^N<<4,j=j>>>8^j&255^99;l[A]=j,d[j]=A;var W=P[A],se=P[W],de=P[se],ue=257*P[j]^16843008*j;v[A]=ue<<24|ue>>>8,m[A]=ue<<16|ue>>>16,T[A]=ue<<8|ue>>>24,k[A]=ue,ue=16843009*de^65537*se^257*W^16843008*A,O[j]=ue<<24|ue>>>8,F[j]=ue<<16|ue>>>16,U[j]=ue<<8|ue>>>24,L[j]=ue,A?(A=W^P[P[P[de^W]]],N^=P[P[N]]):A=N=1}var pe=[0,1,2,4,8,16,32,64,128,27,54],G=G.AES=c.extend({_doReset:function(){for(var J=this._key,X=J.words,te=J.sigBytes/4,J=4*((this._nRounds=te+6)+1),re=this._keySchedule=[],he=0;he<J;he++)if(he<te)re[he]=X[he];else{var ye=re[he-1];he%te?6<te&&he%te==4&&(ye=l[ye>>>24]<<24|l[ye>>>16&255]<<16|l[ye>>>8&255]<<8|l[ye&255]):(ye=ye<<8|ye>>>24,ye=l[ye>>>24]<<24|l[ye>>>16&255]<<16|l[ye>>>8&255]<<8|l[ye&255],ye^=pe[he/te|0]<<24),re[he]=re[he-te]^ye}for(X=this._invKeySchedule=[],te=0;te<J;te++)he=J-te,ye=te%4?re[he]:re[he-4],X[te]=4>te||4>=he?ye:O[l[ye>>>24]]^F[l[ye>>>16&255]]^U[l[ye>>>8&255]]^L[l[ye&255]]},encryptBlock:function(X,te){this._doCryptBlock(X,te,this._keySchedule,v,m,T,k,l)},decryptBlock:function(X,te){var J=X[te+1];X[te+1]=X[te+3],X[te+3]=J,this._doCryptBlock(X,te,this._invKeySchedule,O,F,U,L,d),J=X[te+1],X[te+1]=X[te+3],X[te+3]=J},_doCryptBlock:function(X,te,J,re,he,ye,Ae,ve){for(var xe=this._nRounds,Kn=X[te]^J[0],Qn=X[te+1]^J[1],$n=X[te+2]^J[2],On=X[te+3]^J[3],Fe=4,Ne=1;Ne<xe;Ne++)var ar=re[Kn>>>24]^he[Qn>>>16&255]^ye[$n>>>8&255]^Ae[On&255]^J[Fe++],mn=re[Qn>>>24]^he[$n>>>16&255]^ye[On>>>8&255]^Ae[Kn&255]^J[Fe++],tn=re[$n>>>24]^he[On>>>16&255]^ye[Kn>>>8&255]^Ae[Qn&255]^J[Fe++],On=re[On>>>24]^he[Kn>>>16&255]^ye[Qn>>>8&255]^Ae[$n&255]^J[Fe++],Kn=ar,Qn=mn,$n=tn;ar=(ve[Kn>>>24]<<24|ve[Qn>>>16&255]<<16|ve[$n>>>8&255]<<8|ve[On&255])^J[Fe++],mn=(ve[Qn>>>24]<<24|ve[$n>>>16&255]<<16|ve[On>>>8&255]<<8|ve[Kn&255])^J[Fe++],tn=(ve[$n>>>24]<<24|ve[On>>>16&255]<<16|ve[Kn>>>8&255]<<8|ve[Qn&255])^J[Fe++],On=(ve[On>>>24]<<24|ve[Kn>>>16&255]<<16|ve[Qn>>>8&255]<<8|ve[$n&255])^J[Fe++],X[te]=ar,X[te+1]=mn,X[te+2]=tn,X[te+3]=On},keySize:8});s.AES=c._createHelper(G)}(),function(){function s(P,D){var A=(this._lBlock>>>P^this._rBlock)&D;this._rBlock^=A,this._lBlock^=A<<P}function c(P,D){var A=(this._rBlock>>>P^this._lBlock)&D;this._lBlock^=A,this._rBlock^=A<<P}var l=a,v=l.lib,d=v.WordArray,v=v.BlockCipher,m=l.algo,T=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],k=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],O=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],F=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],U=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],L=m.DES=v.extend({_doReset:function(){for(var P=this._key.words,D=[],A=0;56>A;A++){var N=T[A]-1;D[A]=P[N>>>5]>>>31-N%32&1}for(P=this._subKeys=[],N=0;16>N;N++){for(var j=P[N]=[],W=O[N],A=0;24>A;A++)j[A/6|0]|=D[(k[A]-1+W)%28]<<31-A%6,j[4+(A/6|0)]|=D[28+(k[A+24]-1+W)%28]<<31-A%6;for(j[0]=j[0]<<1|j[0]>>>31,A=1;7>A;A++)j[A]>>>=4*(A-1)+3;j[7]=j[7]<<5|j[7]>>>27}for(D=this._invSubKeys=[],A=0;16>A;A++)D[A]=P[15-A]},encryptBlock:function(P,D){this._doCryptBlock(P,D,this._subKeys)},decryptBlock:function(P,D){this._doCryptBlock(P,D,this._invSubKeys)},_doCryptBlock:function(P,D,A){this._lBlock=P[D],this._rBlock=P[D+1],s.call(this,4,252645135),s.call(this,16,65535),c.call(this,2,858993459),c.call(this,8,16711935),s.call(this,1,1431655765);for(var N=0;16>N;N++){for(var j=A[N],W=this._lBlock,se=this._rBlock,de=0,ue=0;8>ue;ue++)de|=F[ue][((se^j[ue])&U[ue])>>>0];this._lBlock=se,this._rBlock=W^de}A=this._lBlock,this._lBlock=this._rBlock,this._rBlock=A,s.call(this,1,1431655765),c.call(this,8,16711935),c.call(this,2,858993459),s.call(this,16,65535),s.call(this,4,252645135),P[D]=this._lBlock,P[D+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});l.DES=v._createHelper(L),m=m.TripleDES=v.extend({_doReset:function(){var P=this._key.words;this._des1=L.createEncryptor(d.create(P.slice(0,2))),this._des2=L.createEncryptor(d.create(P.slice(2,4))),this._des3=L.createEncryptor(d.create(P.slice(4,6)))},encryptBlock:function(P,D){this._des1.encryptBlock(P,D),this._des2.decryptBlock(P,D),this._des3.encryptBlock(P,D)},decryptBlock:function(P,D){this._des3.decryptBlock(P,D),this._des2.encryptBlock(P,D),this._des1.decryptBlock(P,D)},keySize:6,ivSize:2,blockSize:2}),l.TripleDES=v._createHelper(m)}(),function(){var s=a,c=s.lib.WordArray;s.enc.Base64={stringify:function(l){var d=l.words,v=l.sigBytes,m=this._map;l.clamp(),l=[];for(var T=0;T<v;T+=3)for(var k=(d[T>>>2]>>>24-8*(T%4)&255)<<16|(d[T+1>>>2]>>>24-8*((T+1)%4)&255)<<8|d[T+2>>>2]>>>24-8*((T+2)%4)&255,O=0;4>O&&T+.75*O<v;O++)l.push(m.charAt(k>>>6*(3-O)&63));if(d=m.charAt(64))for(;l.length%4;)l.push(d);return l.join("")},parse:function(l){var d=l.length,v=this._map,m=v.charAt(64);m&&(m=l.indexOf(m),m!=-1&&(d=m));for(var m=[],T=0,k=0;k<d;k++)if(k%4){var O=v.indexOf(l.charAt(k-1))<<2*(k%4),F=v.indexOf(l.charAt(k))>>>6-2*(k%4);m[T>>>2]|=(O|F)<<24-8*(T%4),T++}return c.create(m,T)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(s){function c(L,P,D,A,N,j,W){return L=L+(P&D|~P&A)+N+W,(L<<j|L>>>32-j)+P}function l(L,P,D,A,N,j,W){return L=L+(P&A|D&~A)+N+W,(L<<j|L>>>32-j)+P}function d(L,P,D,A,N,j,W){return L=L+(P^D^A)+N+W,(L<<j|L>>>32-j)+P}function v(L,P,D,A,N,j,W){return L=L+(D^(P|~A))+N+W,(L<<j|L>>>32-j)+P}for(var m=a,O=m.lib,T=O.WordArray,k=O.Hasher,O=m.algo,F=[],U=0;64>U;U++)F[U]=4294967296*s.abs(s.sin(U+1))|0;O=O.MD5=k.extend({_doReset:function(){this._hash=new T.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(L,P){for(var D=0;16>D;D++){var A=P+D,N=L[A];L[A]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}var D=this._hash.words,A=L[P+0],N=L[P+1],j=L[P+2],W=L[P+3],se=L[P+4],de=L[P+5],ue=L[P+6],pe=L[P+7],G=L[P+8],X=L[P+9],te=L[P+10],J=L[P+11],re=L[P+12],he=L[P+13],ye=L[P+14],Ae=L[P+15],ve=D[0],Ne=D[1],Fe=D[2],xe=D[3],ve=c(ve,Ne,Fe,xe,A,7,F[0]),xe=c(xe,ve,Ne,Fe,N,12,F[1]),Fe=c(Fe,xe,ve,Ne,j,17,F[2]),Ne=c(Ne,Fe,xe,ve,W,22,F[3]),ve=c(ve,Ne,Fe,xe,se,7,F[4]),xe=c(xe,ve,Ne,Fe,de,12,F[5]),Fe=c(Fe,xe,ve,Ne,ue,17,F[6]),Ne=c(Ne,Fe,xe,ve,pe,22,F[7]),ve=c(ve,Ne,Fe,xe,G,7,F[8]),xe=c(xe,ve,Ne,Fe,X,12,F[9]),Fe=c(Fe,xe,ve,Ne,te,17,F[10]),Ne=c(Ne,Fe,xe,ve,J,22,F[11]),ve=c(ve,Ne,Fe,xe,re,7,F[12]),xe=c(xe,ve,Ne,Fe,he,12,F[13]),Fe=c(Fe,xe,ve,Ne,ye,17,F[14]),Ne=c(Ne,Fe,xe,ve,Ae,22,F[15]),ve=l(ve,Ne,Fe,xe,N,5,F[16]),xe=l(xe,ve,Ne,Fe,ue,9,F[17]),Fe=l(Fe,xe,ve,Ne,J,14,F[18]),Ne=l(Ne,Fe,xe,ve,A,20,F[19]),ve=l(ve,Ne,Fe,xe,de,5,F[20]),xe=l(xe,ve,Ne,Fe,te,9,F[21]),Fe=l(Fe,xe,ve,Ne,Ae,14,F[22]),Ne=l(Ne,Fe,xe,ve,se,20,F[23]),ve=l(ve,Ne,Fe,xe,X,5,F[24]),xe=l(xe,ve,Ne,Fe,ye,9,F[25]),Fe=l(Fe,xe,ve,Ne,W,14,F[26]),Ne=l(Ne,Fe,xe,ve,G,20,F[27]),ve=l(ve,Ne,Fe,xe,he,5,F[28]),xe=l(xe,ve,Ne,Fe,j,9,F[29]),Fe=l(Fe,xe,ve,Ne,pe,14,F[30]),Ne=l(Ne,Fe,xe,ve,re,20,F[31]),ve=d(ve,Ne,Fe,xe,de,4,F[32]),xe=d(xe,ve,Ne,Fe,G,11,F[33]),Fe=d(Fe,xe,ve,Ne,J,16,F[34]),Ne=d(Ne,Fe,xe,ve,ye,23,F[35]),ve=d(ve,Ne,Fe,xe,N,4,F[36]),xe=d(xe,ve,Ne,Fe,se,11,F[37]),Fe=d(Fe,xe,ve,Ne,pe,16,F[38]),Ne=d(Ne,Fe,xe,ve,te,23,F[39]),ve=d(ve,Ne,Fe,xe,he,4,F[40]),xe=d(xe,ve,Ne,Fe,A,11,F[41]),Fe=d(Fe,xe,ve,Ne,W,16,F[42]),Ne=d(Ne,Fe,xe,ve,ue,23,F[43]),ve=d(ve,Ne,Fe,xe,X,4,F[44]),xe=d(xe,ve,Ne,Fe,re,11,F[45]),Fe=d(Fe,xe,ve,Ne,Ae,16,F[46]),Ne=d(Ne,Fe,xe,ve,j,23,F[47]),ve=v(ve,Ne,Fe,xe,A,6,F[48]),xe=v(xe,ve,Ne,Fe,pe,10,F[49]),Fe=v(Fe,xe,ve,Ne,ye,15,F[50]),Ne=v(Ne,Fe,xe,ve,de,21,F[51]),ve=v(ve,Ne,Fe,xe,re,6,F[52]),xe=v(xe,ve,Ne,Fe,W,10,F[53]),Fe=v(Fe,xe,ve,Ne,te,15,F[54]),Ne=v(Ne,Fe,xe,ve,N,21,F[55]),ve=v(ve,Ne,Fe,xe,G,6,F[56]),xe=v(xe,ve,Ne,Fe,Ae,10,F[57]),Fe=v(Fe,xe,ve,Ne,ue,15,F[58]),Ne=v(Ne,Fe,xe,ve,he,21,F[59]),ve=v(ve,Ne,Fe,xe,se,6,F[60]),xe=v(xe,ve,Ne,Fe,J,10,F[61]),Fe=v(Fe,xe,ve,Ne,j,15,F[62]),Ne=v(Ne,Fe,xe,ve,X,21,F[63]);D[0]=D[0]+ve|0,D[1]=D[1]+Ne|0,D[2]=D[2]+Fe|0,D[3]=D[3]+xe|0},_doFinalize:function(){var L=this._data,P=L.words,D=8*this._nDataBytes,A=8*L.sigBytes;P[A>>>5]|=128<<24-A%32;var N=s.floor(D/4294967296);for(P[(A+64>>>9<<4)+15]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,P[(A+64>>>9<<4)+14]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,L.sigBytes=4*(P.length+1),this._process(),L=this._hash,P=L.words,D=0;4>D;D++)A=P[D],P[D]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;return L},clone:function(){var L=k.clone.call(this);return L._hash=this._hash.clone(),L}}),m.MD5=k._createHelper(O),m.HmacMD5=k._createHmacHelper(O)}(Math),function(){var s=a,v=s.lib,c=v.WordArray,l=v.Hasher,d=[],v=s.algo.SHA1=l.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,T){for(var k=this._hash.words,O=k[0],F=k[1],U=k[2],L=k[3],P=k[4],D=0;80>D;D++){if(16>D)d[D]=m[T+D]|0;else{var A=d[D-3]^d[D-8]^d[D-14]^d[D-16];d[D]=A<<1|A>>>31}A=(O<<5|O>>>27)+P+d[D],A=20>D?A+((F&U|~F&L)+1518500249):40>D?A+((F^U^L)+1859775393):60>D?A+((F&U|F&L|U&L)-1894007588):A+((F^U^L)-899497514),P=L,L=U,U=F<<30|F>>>2,F=O,O=A}k[0]=k[0]+O|0,k[1]=k[1]+F|0,k[2]=k[2]+U|0,k[3]=k[3]+L|0,k[4]=k[4]+P|0},_doFinalize:function(){var m=this._data,T=m.words,k=8*this._nDataBytes,O=8*m.sigBytes;return T[O>>>5]|=128<<24-O%32,T[(O+64>>>9<<4)+14]=Math.floor(k/4294967296),T[(O+64>>>9<<4)+15]=k,m.sigBytes=4*T.length,this._process(),this._hash},clone:function(){var m=l.clone.call(this);return m._hash=this._hash.clone(),m}});s.SHA1=l._createHelper(v),s.HmacSHA1=l._createHmacHelper(v)}(),function(s){for(var c=a,D=c.lib,l=D.WordArray,d=D.Hasher,D=c.algo,v=[],m=[],T=function(N){return 4294967296*(N-(N|0))|0},k=2,O=0;64>O;){var F;e:{F=k;for(var U=s.sqrt(F),L=2;L<=U;L++)if(!(F%L)){F=!1;break e}F=!0}F&&(8>O&&(v[O]=T(s.pow(k,.5))),m[O]=T(s.pow(k,1/3)),O++),k++}var P=[],D=D.SHA256=d.extend({_doReset:function(){this._hash=new l.init(v.slice(0))},_doProcessBlock:function(A,N){for(var j=this._hash.words,W=j[0],se=j[1],de=j[2],ue=j[3],pe=j[4],G=j[5],X=j[6],te=j[7],J=0;64>J;J++){if(16>J)P[J]=A[N+J]|0;else{var re=P[J-15],he=P[J-2];P[J]=((re<<25|re>>>7)^(re<<14|re>>>18)^re>>>3)+P[J-7]+((he<<15|he>>>17)^(he<<13|he>>>19)^he>>>10)+P[J-16]}re=te+((pe<<26|pe>>>6)^(pe<<21|pe>>>11)^(pe<<7|pe>>>25))+(pe&G^~pe&X)+m[J]+P[J],he=((W<<30|W>>>2)^(W<<19|W>>>13)^(W<<10|W>>>22))+(W&se^W&de^se&de),te=X,X=G,G=pe,pe=ue+re|0,ue=de,de=se,se=W,W=re+he|0}j[0]=j[0]+W|0,j[1]=j[1]+se|0,j[2]=j[2]+de|0,j[3]=j[3]+ue|0,j[4]=j[4]+pe|0,j[5]=j[5]+G|0,j[6]=j[6]+X|0,j[7]=j[7]+te|0},_doFinalize:function(){var A=this._data,N=A.words,j=8*this._nDataBytes,W=8*A.sigBytes;return N[W>>>5]|=128<<24-W%32,N[(W+64>>>9<<4)+14]=s.floor(j/4294967296),N[(W+64>>>9<<4)+15]=j,A.sigBytes=4*N.length,this._process(),this._hash},clone:function(){var A=d.clone.call(this);return A._hash=this._hash.clone(),A}});c.SHA256=d._createHelper(D),c.HmacSHA256=d._createHmacHelper(D)}(Math),function(){var s=a,c=s.lib.WordArray,d=s.algo,l=d.SHA256,d=d.SHA224=l.extend({_doReset:function(){this._hash=new c.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var v=l._doFinalize.call(this);return v.sigBytes-=4,v}});s.SHA224=l._createHelper(d),s.HmacSHA224=l._createHmacHelper(d)}(),function(){function s(){return d.create.apply(d,arguments)}for(var c=a,l=c.lib.Hasher,m=c.x64,d=m.Word,v=m.WordArray,m=c.algo,T=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],k=[],O=0;80>O;O++)k[O]=s();m=m.SHA512=l.extend({_doReset:function(){this._hash=new v.init([new d.init(1779033703,4089235720),new d.init(3144134277,2227873595),new d.init(1013904242,4271175723),new d.init(2773480762,1595750129),new d.init(1359893119,2917565137),new d.init(2600822924,725511199),new d.init(528734635,4215389547),new d.init(1541459225,327033209)])},_doProcessBlock:function(F,U){for(var se=this._hash.words,L=se[0],P=se[1],D=se[2],A=se[3],N=se[4],j=se[5],W=se[6],se=se[7],de=L.high,ue=L.low,pe=P.high,G=P.low,X=D.high,te=D.low,J=A.high,re=A.low,he=N.high,ye=N.low,Ae=j.high,ve=j.low,xe=W.high,Fe=W.low,Ne=se.high,ar=se.low,mn=de,tn=ue,On=pe,Kn=G,Qn=X,$n=te,ac=J,vr=re,Mt=he,Xt=ye,gn=Ae,vn=ve,Dr=xe,En=Fe,oc=Ne,ma=ar,vi=0;80>vi;vi++){var Fs=k[vi];if(16>vi)var ri=Fs.high=F[U+2*vi]|0,Kt=Fs.low=F[U+2*vi+1]|0;else{var ri=k[vi-15],Kt=ri.high,zi=ri.low,ri=(Kt>>>1|zi<<31)^(Kt>>>8|zi<<24)^Kt>>>7,zi=(zi>>>1|Kt<<31)^(zi>>>8|Kt<<24)^(zi>>>7|Kt<<25),ga=k[vi-2],Kt=ga.high,on=ga.low,ga=(Kt>>>19|on<<13)^(Kt<<3|on>>>29)^Kt>>>6,on=(on>>>19|Kt<<13)^(on<<3|Kt>>>29)^(on>>>6|Kt<<26),Kt=k[vi-7],Jh=Kt.high,Is=k[vi-16],Ki=Is.high,Is=Is.low,Kt=zi+Kt.low,ri=ri+Jh+(Kt>>>0<zi>>>0?1:0),Kt=Kt+on,ri=ri+ga+(Kt>>>0<on>>>0?1:0),Kt=Kt+Is,ri=ri+Ki+(Kt>>>0<Is>>>0?1:0);Fs.high=ri,Fs.low=Kt}var Jh=Mt&gn^~Mt&Dr,Is=Xt&vn^~Xt&En,Fs=mn&On^mn&Qn^On&Qn,Q2=tn&Kn^tn&$n^Kn&$n,zi=(mn>>>28|tn<<4)^(mn<<30|tn>>>2)^(mn<<25|tn>>>7),ga=(tn>>>28|mn<<4)^(tn<<30|mn>>>2)^(tn<<25|mn>>>7),on=T[vi],Y2=on.high,Og=on.low,on=ma+((Xt>>>14|Mt<<18)^(Xt>>>18|Mt<<14)^(Xt<<23|Mt>>>9)),Ki=oc+((Mt>>>14|Xt<<18)^(Mt>>>18|Xt<<14)^(Mt<<23|Xt>>>9))+(on>>>0<ma>>>0?1:0),on=on+Is,Ki=Ki+Jh+(on>>>0<Is>>>0?1:0),on=on+Og,Ki=Ki+Y2+(on>>>0<Og>>>0?1:0),on=on+Kt,Ki=Ki+ri+(on>>>0<Kt>>>0?1:0),Kt=ga+Q2,Fs=zi+Fs+(Kt>>>0<ga>>>0?1:0),oc=Dr,ma=En,Dr=gn,En=vn,gn=Mt,vn=Xt,Xt=vr+on|0,Mt=ac+Ki+(Xt>>>0<vr>>>0?1:0)|0,ac=Qn,vr=$n,Qn=On,$n=Kn,On=mn,Kn=tn,tn=on+Kt|0,mn=Ki+Fs+(tn>>>0<on>>>0?1:0)|0}ue=L.low=ue+tn,L.high=de+mn+(ue>>>0<tn>>>0?1:0),G=P.low=G+Kn,P.high=pe+On+(G>>>0<Kn>>>0?1:0),te=D.low=te+$n,D.high=X+Qn+(te>>>0<$n>>>0?1:0),re=A.low=re+vr,A.high=J+ac+(re>>>0<vr>>>0?1:0),ye=N.low=ye+Xt,N.high=he+Mt+(ye>>>0<Xt>>>0?1:0),ve=j.low=ve+vn,j.high=Ae+gn+(ve>>>0<vn>>>0?1:0),Fe=W.low=Fe+En,W.high=xe+Dr+(Fe>>>0<En>>>0?1:0),ar=se.low=ar+ma,se.high=Ne+oc+(ar>>>0<ma>>>0?1:0)},_doFinalize:function(){var F=this._data,U=F.words,L=8*this._nDataBytes,P=8*F.sigBytes;return U[P>>>5]|=128<<24-P%32,U[(P+128>>>10<<5)+30]=Math.floor(L/4294967296),U[(P+128>>>10<<5)+31]=L,F.sigBytes=4*U.length,this._process(),this._hash.toX32()},clone:function(){var F=l.clone.call(this);return F._hash=this._hash.clone(),F},blockSize:32}),c.SHA512=l._createHelper(m),c.HmacSHA512=l._createHmacHelper(m)}(),function(){var s=a,v=s.x64,c=v.Word,l=v.WordArray,v=s.algo,d=v.SHA512,v=v.SHA384=d.extend({_doReset:function(){this._hash=new l.init([new c.init(3418070365,3238371032),new c.init(1654270250,914150663),new c.init(2438529370,812702999),new c.init(355462360,4144912697),new c.init(1731405415,4290775857),new c.init(2394180231,1750603025),new c.init(3675008525,1694076839),new c.init(1203062813,3204075428)])},_doFinalize:function(){var m=d._doFinalize.call(this);return m.sigBytes-=16,m}});s.SHA384=d._createHelper(v),s.HmacSHA384=d._createHmacHelper(v)}(),function(){var s=a,F=s.lib,c=F.WordArray,l=F.Hasher,F=s.algo,d=c.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),v=c.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),m=c.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),T=c.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),k=c.create([0,1518500249,1859775393,2400959708,2840853838]),O=c.create([1352829926,1548603684,1836072691,2053994217,0]),F=F.RIPEMD160=l.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(U,L){for(var P=0;16>P;P++){var D=L+P,A=U[D];U[D]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var D=this._hash.words,A=k.words,N=O.words,j=d.words,W=v.words,se=m.words,de=T.words,ue,pe,G,X,te,J,re,he,ye,Ae;J=ue=D[0],re=pe=D[1],he=G=D[2],ye=X=D[3],Ae=te=D[4];for(var ve,P=0;80>P;P+=1)ve=ue+U[L+j[P]]|0,ve=16>P?ve+((pe^G^X)+A[0]):32>P?ve+((pe&G|~pe&X)+A[1]):48>P?ve+(((pe|~G)^X)+A[2]):64>P?ve+((pe&X|G&~X)+A[3]):ve+((pe^(G|~X))+A[4]),ve|=0,ve=ve<<se[P]|ve>>>32-se[P],ve=ve+te|0,ue=te,te=X,X=G<<10|G>>>22,G=pe,pe=ve,ve=J+U[L+W[P]]|0,ve=16>P?ve+((re^(he|~ye))+N[0]):32>P?ve+((re&ye|he&~ye)+N[1]):48>P?ve+(((re|~he)^ye)+N[2]):64>P?ve+((re&he|~re&ye)+N[3]):ve+((re^he^ye)+N[4]),ve|=0,ve=ve<<de[P]|ve>>>32-de[P],ve=ve+Ae|0,J=Ae,Ae=ye,ye=he<<10|he>>>22,he=re,re=ve;ve=D[1]+G+ye|0,D[1]=D[2]+X+Ae|0,D[2]=D[3]+te+J|0,D[3]=D[4]+ue+re|0,D[4]=D[0]+pe+he|0,D[0]=ve},_doFinalize:function(){var U=this._data,L=U.words,P=8*this._nDataBytes,D=8*U.sigBytes;for(L[D>>>5]|=128<<24-D%32,L[(D+64>>>9<<4)+14]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,U.sigBytes=4*(L.length+1),this._process(),U=this._hash,L=U.words,P=0;5>P;P++)D=L[P],L[P]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360;return U},clone:function(){var U=l.clone.call(this);return U._hash=this._hash.clone(),U}});s.RIPEMD160=l._createHelper(F),s.HmacRIPEMD160=l._createHmacHelper(F)}(),function(){var s=a,c=s.enc.Utf8;s.algo.HMAC=s.lib.Base.extend({init:function(l,d){l=this._hasher=new l.init,typeof d=="string"&&(d=c.parse(d));var v=l.blockSize,m=4*v;d.sigBytes>m&&(d=l.finalize(d)),d.clamp();for(var T=this._oKey=d.clone(),k=this._iKey=d.clone(),O=T.words,F=k.words,U=0;U<v;U++)O[U]^=1549556828,F[U]^=909522486;T.sigBytes=k.sigBytes=m,this.reset()},reset:function(){var l=this._hasher;l.reset(),l.update(this._iKey)},update:function(l){return this._hasher.update(l),this},finalize:function(l){var d=this._hasher;return l=d.finalize(l),d.reset(),d.finalize(this._oKey.clone().concat(l))}})}(),function(){var s=a,d=s.lib,c=d.Base,l=d.WordArray,d=s.algo,v=d.HMAC,m=d.PBKDF2=c.extend({cfg:c.extend({keySize:4,hasher:d.SHA1,iterations:1}),init:function(T){this.cfg=this.cfg.extend(T)},compute:function(T,k){for(var A=this.cfg,O=v.create(A.hasher,T),F=l.create(),U=l.create([1]),L=F.words,P=U.words,D=A.keySize,A=A.iterations;L.length<D;){var N=O.update(k).finalize(U);O.reset();for(var j=N.words,W=j.length,se=N,de=1;de<A;de++){se=O.finalize(se),O.reset();for(var ue=se.words,pe=0;pe<W;pe++)j[pe]^=ue[pe]}F.concat(N),P[0]++}return F.sigBytes=4*D,F}});s.PBKDF2=function(T,k,O){return m.create(O).compute(T,k)}}();var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="=";function p(s){var c,l,d="";for(c=0;c+3<=s.length;c+=3)l=parseInt(s.substring(c,c+3),16),d+=o.charAt(l>>6)+o.charAt(l&63);for(c+1==s.length?(l=parseInt(s.substring(c,c+1),16),d+=o.charAt(l<<2)):c+2==s.length&&(l=parseInt(s.substring(c,c+2),16),d+=o.charAt(l>>2)+o.charAt((l&3)<<4));(d.length&3)>0;)d+=u;return d}function h(s){var c="",l,d=0,v,m;for(l=0;l<s.length&&s.charAt(l)!=u;++l)m=o.indexOf(s.charAt(l)),!(m<0)&&(d==0?(c+=$(m>>2),v=m&3,d=1):d==1?(c+=$(v<<2|m>>4),v=m&15,d=2):d==2?(c+=$(v),c+=$(m>>2),v=m&3,d=3):(c+=$(v<<2|m>>4),c+=$(m&15),d=0));return d==1&&(c+=$(v<<2)),c}function g(s){var c=h(s),l,d=new Array;for(l=0;2*l<c.length;++l)d[l]=parseInt(c.substring(2*l,2*l+2),16);return d}var f;function _(s,c,l){s!=null&&(typeof s=="number"?this.fromNumber(s,c,l):c==null&&typeof s!="string"?this.fromString(s,256):this.fromString(s,c))}function w(){return new _(null)}function C(s,c,l,d,v,m){for(;--m>=0;){var T=c*this[s++]+l[d]+v;v=Math.floor(T/67108864),l[d++]=T&67108863}return v}function R(s,c,l,d,v,m){for(var T=c&32767,k=c>>15;--m>=0;){var O=this[s]&32767,F=this[s++]>>15,U=k*O+F*T;O=T*O+((U&32767)<<15)+l[d]+(v&1073741823),v=(O>>>30)+(U>>>15)+k*F+(v>>>30),l[d++]=O&1073741823}return v}function S(s,c,l,d,v,m){for(var T=c&16383,k=c>>14;--m>=0;){var O=this[s]&16383,F=this[s++]>>14,U=k*O+F*T;O=T*O+((U&16383)<<14)+l[d]+v,v=(O>>28)+(U>>14)+k*F,l[d++]=O&268435455}return v}t.appName=="Microsoft Internet Explorer"?(_.prototype.am=R,f=30):t.appName!="Netscape"?(_.prototype.am=C,f=26):(_.prototype.am=S,f=28),_.prototype.DB=f,_.prototype.DM=(1<<f)-1,_.prototype.DV=1<<f;var b=52;_.prototype.FV=Math.pow(2,b),_.prototype.F1=b-f,_.prototype.F2=2*f-b;var x="0123456789abcdefghijklmnopqrstuvwxyz",E=new Array,M,Z;for(M=48,Z=0;Z<=9;++Z)E[M++]=Z;for(M=97,Z=10;Z<36;++Z)E[M++]=Z;for(M=65,Z=10;Z<36;++Z)E[M++]=Z;function $(s){return x.charAt(s)}function z(s,c){var l=E[s.charCodeAt(c)];return l??-1}function q(s){for(var c=this.t-1;c>=0;--c)s[c]=this[c];s.t=this.t,s.s=this.s}function Q(s){this.t=1,this.s=s<0?-1:0,s>0?this[0]=s:s<-1?this[0]=s+this.DV:this.t=0}function K(s){var c=w();return c.fromInt(s),c}function ee(s,c){var l;if(c==16)l=4;else if(c==8)l=3;else if(c==256)l=8;else if(c==2)l=1;else if(c==32)l=5;else if(c==4)l=2;else{this.fromRadix(s,c);return}this.t=0,this.s=0;for(var d=s.length,v=!1,m=0;--d>=0;){var T=l==8?s[d]&255:z(s,d);if(T<0){s.charAt(d)=="-"&&(v=!0);continue}v=!1,m==0?this[this.t++]=T:m+l>this.DB?(this[this.t-1]|=(T&(1<<this.DB-m)-1)<<m,this[this.t++]=T>>this.DB-m):this[this.t-1]|=T<<m,m+=l,m>=this.DB&&(m-=this.DB)}l==8&&s[0]&128&&(this.s=-1,m>0&&(this[this.t-1]|=(1<<this.DB-m)-1<<m)),this.clamp(),v&&_.ZERO.subTo(this,this)}function oe(){for(var s=this.s&this.DM;this.t>0&&this[this.t-1]==s;)--this.t}function ce(s){if(this.s<0)return"-"+this.negate().toString(s);var c;if(s==16)c=4;else if(s==8)c=3;else if(s==2)c=1;else if(s==32)c=5;else if(s==4)c=2;else return this.toRadix(s);var l=(1<<c)-1,d,v=!1,m="",T=this.t,k=this.DB-T*this.DB%c;if(T-- >0)for(k<this.DB&&(d=this[T]>>k)>0&&(v=!0,m=$(d));T>=0;)k<c?(d=(this[T]&(1<<k)-1)<<c-k,d|=this[--T]>>(k+=this.DB-c)):(d=this[T]>>(k-=c)&l,k<=0&&(k+=this.DB,--T)),d>0&&(v=!0),v&&(m+=$(d));return v?m:"0"}function ne(){var s=w();return _.ZERO.subTo(this,s),s}function ke(){return this.s<0?this.negate():this}function _e(s){var c=this.s-s.s;if(c!=0)return c;var l=this.t;if(c=l-s.t,c!=0)return this.s<0?-c:c;for(;--l>=0;)if((c=this[l]-s[l])!=0)return c;return 0}function le(s){var c=1,l;return(l=s>>>16)!=0&&(s=l,c+=16),(l=s>>8)!=0&&(s=l,c+=8),(l=s>>4)!=0&&(s=l,c+=4),(l=s>>2)!=0&&(s=l,c+=2),(l=s>>1)!=0&&(s=l,c+=1),c}function fe(){return this.t<=0?0:this.DB*(this.t-1)+le(this[this.t-1]^this.s&this.DM)}function ge(s,c){var l;for(l=this.t-1;l>=0;--l)c[l+s]=this[l];for(l=s-1;l>=0;--l)c[l]=0;c.t=this.t+s,c.s=this.s}function Ee(s,c){for(var l=s;l<this.t;++l)c[l-s]=this[l];c.t=Math.max(this.t-s,0),c.s=this.s}function Oe(s,c){var l=s%this.DB,d=this.DB-l,v=(1<<d)-1,m=Math.floor(s/this.DB),T=this.s<<l&this.DM,k;for(k=this.t-1;k>=0;--k)c[k+m+1]=this[k]>>d|T,T=(this[k]&v)<<l;for(k=m-1;k>=0;--k)c[k]=0;c[m]=T,c.t=this.t+m+1,c.s=this.s,c.clamp()}function Je(s,c){c.s=this.s;var l=Math.floor(s/this.DB);if(l>=this.t){c.t=0;return}var d=s%this.DB,v=this.DB-d,m=(1<<d)-1;c[0]=this[l]>>d;for(var T=l+1;T<this.t;++T)c[T-l-1]|=(this[T]&m)<<v,c[T-l]=this[T]>>d;d>0&&(c[this.t-l-1]|=(this.s&m)<<v),c.t=this.t-l,c.clamp()}function ut(s,c){for(var l=0,d=0,v=Math.min(s.t,this.t);l<v;)d+=this[l]-s[l],c[l++]=d&this.DM,d>>=this.DB;if(s.t<this.t){for(d-=s.s;l<this.t;)d+=this[l],c[l++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;l<s.t;)d-=s[l],c[l++]=d&this.DM,d>>=this.DB;d-=s.s}c.s=d<0?-1:0,d<-1?c[l++]=this.DV+d:d>0&&(c[l++]=d),c.t=l,c.clamp()}function ot(s,c){var l=this.abs(),d=s.abs(),v=l.t;for(c.t=v+d.t;--v>=0;)c[v]=0;for(v=0;v<d.t;++v)c[v+l.t]=l.am(0,d[v],c,v,0,l.t);c.s=0,c.clamp(),this.s!=s.s&&_.ZERO.subTo(c,c)}function nt(s){for(var c=this.abs(),l=s.t=2*c.t;--l>=0;)s[l]=0;for(l=0;l<c.t-1;++l){var d=c.am(l,c[l],s,2*l,0,1);(s[l+c.t]+=c.am(l+1,2*c[l],s,2*l+1,d,c.t-l-1))>=c.DV&&(s[l+c.t]-=c.DV,s[l+c.t+1]=1)}s.t>0&&(s[s.t-1]+=c.am(l,c[l],s,2*l,0,1)),s.s=0,s.clamp()}function He(s,c,l){var d=s.abs();if(!(d.t<=0)){var v=this.abs();if(v.t<d.t){c!=null&&c.fromInt(0),l!=null&&this.copyTo(l);return}l==null&&(l=w());var m=w(),T=this.s,k=s.s,O=this.DB-le(d[d.t-1]);O>0?(d.lShiftTo(O,m),v.lShiftTo(O,l)):(d.copyTo(m),v.copyTo(l));var F=m.t,U=m[F-1];if(U!=0){var L=U*(1<<this.F1)+(F>1?m[F-2]>>this.F2:0),P=this.FV/L,D=(1<<this.F1)/L,A=1<<this.F2,N=l.t,j=N-F,W=c??w();for(m.dlShiftTo(j,W),l.compareTo(W)>=0&&(l[l.t++]=1,l.subTo(W,l)),_.ONE.dlShiftTo(F,W),W.subTo(m,m);m.t<F;)m[m.t++]=0;for(;--j>=0;){var se=l[--N]==U?this.DM:Math.floor(l[N]*P+(l[N-1]+A)*D);if((l[N]+=m.am(0,se,l,j,0,F))<se)for(m.dlShiftTo(j,W),l.subTo(W,l);l[N]<--se;)l.subTo(W,l)}c!=null&&(l.drShiftTo(F,c),T!=k&&_.ZERO.subTo(c,c)),l.t=F,l.clamp(),O>0&&l.rShiftTo(O,l),T<0&&_.ZERO.subTo(l,l)}}}function Qe(s){var c=w();return this.abs().divRemTo(s,null,c),this.s<0&&c.compareTo(_.ZERO)>0&&s.subTo(c,c),c}function mt(s){this.m=s}function Lt(s){return s.s<0||s.compareTo(this.m)>=0?s.mod(this.m):s}function Wt(s){return s}function Fn(s){s.divRemTo(this.m,null,s)}function Bi(s,c,l){s.multiplyTo(c,l),this.reduce(l)}function fr(s,c){s.squareTo(c),this.reduce(c)}mt.prototype.convert=Lt,mt.prototype.revert=Wt,mt.prototype.reduce=Fn,mt.prototype.mulTo=Bi,mt.prototype.sqrTo=fr;function mi(){if(this.t<1)return 0;var s=this[0];if(!(s&1))return 0;var c=s&3;return c=c*(2-(s&15)*c)&15,c=c*(2-(s&255)*c)&255,c=c*(2-((s&65535)*c&65535))&65535,c=c*(2-s*c%this.DV)%this.DV,c>0?this.DV-c:-c}function wn(s){this.m=s,this.mp=s.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<s.DB-15)-1,this.mt2=2*s.t}function mr(s){var c=w();return s.abs().dlShiftTo(this.m.t,c),c.divRemTo(this.m,null,c),s.s<0&&c.compareTo(_.ZERO)>0&&this.m.subTo(c,c),c}function Dn(s){var c=w();return s.copyTo(c),this.reduce(c),c}function sn(s){for(;s.t<=this.mt2;)s[s.t++]=0;for(var c=0;c<this.m.t;++c){var l=s[c]&32767,d=l*this.mpl+((l*this.mph+(s[c]>>15)*this.mpl&this.um)<<15)&s.DM;for(l=c+this.m.t,s[l]+=this.m.am(0,d,s,c,0,this.m.t);s[l]>=s.DV;)s[l]-=s.DV,s[++l]++}s.clamp(),s.drShiftTo(this.m.t,s),s.compareTo(this.m)>=0&&s.subTo(this.m,s)}function Tn(s,c){s.squareTo(c),this.reduce(c)}function Kr(s,c,l){s.multiplyTo(c,l),this.reduce(l)}wn.prototype.convert=mr,wn.prototype.revert=Dn,wn.prototype.reduce=sn,wn.prototype.mulTo=Kr,wn.prototype.sqrTo=Tn;function xn(){return(this.t>0?this[0]&1:this.s)==0}function ti(s,c){if(s>4294967295||s<1)return _.ONE;var l=w(),d=w(),v=c.convert(this),m=le(s)-1;for(v.copyTo(l);--m>=0;)if(c.sqrTo(l,d),(s&1<<m)>0)c.mulTo(d,v,l);else{var T=l;l=d,d=T}return c.revert(l)}function pn(s,c){var l;return s<256||c.isEven()?l=new mt(c):l=new wn(c),this.exp(s,l)}_.prototype.copyTo=q,_.prototype.fromInt=Q,_.prototype.fromString=ee,_.prototype.clamp=oe,_.prototype.dlShiftTo=ge,_.prototype.drShiftTo=Ee,_.prototype.lShiftTo=Oe,_.prototype.rShiftTo=Je,_.prototype.subTo=ut,_.prototype.multiplyTo=ot,_.prototype.squareTo=nt,_.prototype.divRemTo=He,_.prototype.invDigit=mi,_.prototype.isEven=xn,_.prototype.exp=ti,_.prototype.toString=ce,_.prototype.negate=ne,_.prototype.abs=ke,_.prototype.compareTo=_e,_.prototype.bitLength=fe,_.prototype.mod=Qe,_.prototype.modPowInt=pn,_.ZERO=K(0),_.ONE=K(1);function Un(){var s=w();return this.copyTo(s),s}function Ui(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function yt(){return this.t==0?this.s:this[0]<<24>>24}function Rt(){return this.t==0?this.s:this[0]<<16>>16}function rt(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function zt(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Rr(s){if(s==null&&(s=10),this.signum()==0||s<2||s>36)return"0";var c=this.chunkSize(s),l=Math.pow(s,c),d=K(l),v=w(),m=w(),T="";for(this.divRemTo(d,v,m);v.signum()>0;)T=(l+m.intValue()).toString(s).substr(1)+T,v.divRemTo(d,v,m);return m.intValue().toString(s)+T}function gr(s,c){this.fromInt(0),c==null&&(c=10);for(var l=this.chunkSize(c),d=Math.pow(c,l),v=!1,m=0,T=0,k=0;k<s.length;++k){var O=z(s,k);if(O<0){s.charAt(k)=="-"&&this.signum()==0&&(v=!0);continue}T=c*T+O,++m>=l&&(this.dMultiply(d),this.dAddOffset(T,0),m=0,T=0)}m>0&&(this.dMultiply(Math.pow(c,m)),this.dAddOffset(T,0)),v&&_.ZERO.subTo(this,this)}function Ut(s,c,l){if(typeof c=="number")if(s<2)this.fromInt(1);else for(this.fromNumber(s,l),this.testBit(s-1)||this.bitwiseTo(_.ONE.shiftLeft(s-1),Ts,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>s&&this.subTo(_.ONE.shiftLeft(s-1),this);else{var d=new Array,v=s&7;d.length=(s>>3)+1,c.nextBytes(d),v>0?d[0]&=(1<<v)-1:d[0]=0,this.fromString(d,256)}}function ct(){var s=this.t,c=new Array;c[0]=this.s;var l=this.DB-s*this.DB%8,d,v=0;if(s-- >0)for(l<this.DB&&(d=this[s]>>l)!=(this.s&this.DM)>>l&&(c[v++]=d|this.s<<this.DB-l);s>=0;)l<8?(d=(this[s]&(1<<l)-1)<<8-l,d|=this[--s]>>(l+=this.DB-8)):(d=this[s]>>(l-=8)&255,l<=0&&(l+=this.DB,--s)),d&128&&(d|=-256),v==0&&(this.s&128)!=(d&128)&&++v,(v>0||d!=this.s)&&(c[v++]=d);return c}function zn(s){return this.compareTo(s)==0}function ks(s){return this.compareTo(s)<0?this:s}function fn(s){return this.compareTo(s)>0?this:s}function Ga(s,c,l){var d,v,m=Math.min(s.t,this.t);for(d=0;d<m;++d)l[d]=c(this[d],s[d]);if(s.t<this.t){for(v=s.s&this.DM,d=m;d<this.t;++d)l[d]=c(this[d],v);l.t=this.t}else{for(v=this.s&this.DM,d=m;d<s.t;++d)l[d]=c(v,s[d]);l.t=s.t}l.s=c(this.s,s.s),l.clamp()}function Fl(s,c){return s&c}function nn(s){var c=w();return this.bitwiseTo(s,Fl,c),c}function Ts(s,c){return s|c}function Dl(s){var c=w();return this.bitwiseTo(s,Ts,c),c}function Hi(s,c){return s^c}function ni(s){var c=w();return this.bitwiseTo(s,Hi,c),c}function kt(s,c){return s&~c}function Nl(s){var c=w();return this.bitwiseTo(s,kt,c),c}function Ja(){for(var s=w(),c=0;c<this.t;++c)s[c]=this.DM&~this[c];return s.t=this.t,s.s=~this.s,s}function Ol(s){var c=w();return s<0?this.rShiftTo(-s,c):this.lShiftTo(s,c),c}function Ml(s){var c=w();return s<0?this.lShiftTo(-s,c):this.rShiftTo(s,c),c}function ns(s){if(s==0)return-1;var c=0;return s&65535||(s>>=16,c+=16),s&255||(s>>=8,c+=8),s&15||(s>>=4,c+=4),s&3||(s>>=2,c+=2),s&1||++c,c}function Go(){for(var s=0;s<this.t;++s)if(this[s]!=0)return s*this.DB+ns(this[s]);return this.s<0?this.t*this.DB:-1}function Vi(s){for(var c=0;s!=0;)s&=s-1,++c;return c}function rs(){for(var s=0,c=this.s&this.DM,l=0;l<this.t;++l)s+=Vi(this[l]^c);return s}function bh(s){var c=Math.floor(s/this.DB);return c>=this.t?this.s!=0:(this[c]&1<<s%this.DB)!=0}function Sh(s,c){var l=_.ONE.shiftLeft(s);return this.bitwiseTo(l,c,l),l}function Jn(s){return this.changeBit(s,Ts)}function da(s){return this.changeBit(s,kt)}function wh(s){return this.changeBit(s,Hi)}function Jo(s,c){for(var l=0,d=0,v=Math.min(s.t,this.t);l<v;)d+=this[l]+s[l],c[l++]=d&this.DM,d>>=this.DB;if(s.t<this.t){for(d+=s.s;l<this.t;)d+=this[l],c[l++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;l<s.t;)d+=s[l],c[l++]=d&this.DM,d>>=this.DB;d+=s.s}c.s=d<0?-1:0,d>0?c[l++]=d:d<-1&&(c[l++]=this.DV+d),c.t=l,c.clamp()}function xh(s){var c=w();return this.addTo(s,c),c}function Rs(s){var c=w();return this.subTo(s,c),c}function Ch(s){var c=w();return this.multiplyTo(s,c),c}function Ll(){var s=w();return this.squareTo(s),s}function jl(s){var c=w();return this.divRemTo(s,c,null),c}function Eh(s){var c=w();return this.divRemTo(s,null,c),c}function Zo(s){var c=w(),l=w();return this.divRemTo(s,c,l),new Array(c,l)}function is(s){this[this.t]=this.am(0,s-1,this,0,0,this.t),++this.t,this.clamp()}function Ph(s,c){if(s!=0){for(;this.t<=c;)this[this.t++]=0;for(this[c]+=s;this[c]>=this.DV;)this[c]-=this.DV,++c>=this.t&&(this[this.t++]=0),++this[c]}}function ha(){}function pa(s){return s}function kh(s,c,l){s.multiplyTo(c,l)}function Bl(s,c){s.squareTo(c)}ha.prototype.convert=pa,ha.prototype.revert=pa,ha.prototype.mulTo=kh,ha.prototype.sqrTo=Bl;function Th(s){return this.exp(s,new ha)}function Ul(s,c,l){var d=Math.min(this.t+s.t,c);for(l.s=0,l.t=d;d>0;)l[--d]=0;var v;for(v=l.t-this.t;d<v;++d)l[d+this.t]=this.am(0,s[d],l,d,0,this.t);for(v=Math.min(s.t,c);d<v;++d)this.am(0,s[d],l,d,0,c-d);l.clamp()}function Xo(s,c,l){--c;var d=l.t=this.t+s.t-c;for(l.s=0;--d>=0;)l[d]=0;for(d=Math.max(c-this.t,0);d<s.t;++d)l[this.t+d-c]=this.am(c-d,s[d],l,0,0,this.t+d-c);l.clamp(),l.drShiftTo(1,l)}function ss(s){this.r2=w(),this.q3=w(),_.ONE.dlShiftTo(2*s.t,this.r2),this.mu=this.r2.divide(s),this.m=s}function Rh(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);if(s.compareTo(this.m)<0)return s;var c=w();return s.copyTo(c),this.reduce(c),c}function Ah(s){return s}function Ih(s){for(s.drShiftTo(this.m.t-1,this.r2),s.t>this.m.t+1&&(s.t=this.m.t+1,s.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);s.compareTo(this.r2)<0;)s.dAddOffset(1,this.m.t+1);for(s.subTo(this.r2,s);s.compareTo(this.m)>=0;)s.subTo(this.m,s)}function Fh(s,c){s.squareTo(c),this.reduce(c)}function Hl(s,c,l){s.multiplyTo(c,l),this.reduce(l)}ss.prototype.convert=Rh,ss.prototype.revert=Ah,ss.prototype.reduce=Ih,ss.prototype.mulTo=Hl,ss.prototype.sqrTo=Fh;function Dh(s,c){var l=s.bitLength(),d,v=K(1),m;if(l<=0)return v;l<18?d=1:l<48?d=3:l<144?d=4:l<768?d=5:d=6,l<8?m=new mt(c):c.isEven()?m=new ss(c):m=new wn(c);var T=new Array,k=3,O=d-1,F=(1<<d)-1;if(T[1]=m.convert(this),d>1){var U=w();for(m.sqrTo(T[1],U);k<=F;)T[k]=w(),m.mulTo(U,T[k-2],T[k]),k+=2}var L=s.t-1,P,D=!0,A=w(),N;for(l=le(s[L])-1;L>=0;){for(l>=O?P=s[L]>>l-O&F:(P=(s[L]&(1<<l+1)-1)<<O-l,L>0&&(P|=s[L-1]>>this.DB+l-O)),k=d;!(P&1);)P>>=1,--k;if((l-=k)<0&&(l+=this.DB,--L),D)T[P].copyTo(v),D=!1;else{for(;k>1;)m.sqrTo(v,A),m.sqrTo(A,v),k-=2;k>0?m.sqrTo(v,A):(N=v,v=A,A=N),m.mulTo(A,T[P],v)}for(;L>=0&&!(s[L]&1<<l);)m.sqrTo(v,A),N=v,v=A,A=N,--l<0&&(l=this.DB-1,--L)}return m.revert(v)}function Nh(s){var c=this.s<0?this.negate():this.clone(),l=s.s<0?s.negate():s.clone();if(c.compareTo(l)<0){var d=c;c=l,l=d}var v=c.getLowestSetBit(),m=l.getLowestSetBit();if(m<0)return c;for(v<m&&(m=v),m>0&&(c.rShiftTo(m,c),l.rShiftTo(m,l));c.signum()>0;)(v=c.getLowestSetBit())>0&&c.rShiftTo(v,c),(v=l.getLowestSetBit())>0&&l.rShiftTo(v,l),c.compareTo(l)>=0?(c.subTo(l,c),c.rShiftTo(1,c)):(l.subTo(c,l),l.rShiftTo(1,l));return m>0&&l.lShiftTo(m,l),l}function Qo(s){if(s<=0)return 0;var c=this.DV%s,l=this.s<0?s-1:0;if(this.t>0)if(c==0)l=this[0]%s;else for(var d=this.t-1;d>=0;--d)l=(c*l+this[d])%s;return l}function Oh(s){var c=s.isEven();if(this.isEven()&&c||s.signum()==0)return _.ZERO;for(var l=s.clone(),d=this.clone(),v=K(1),m=K(0),T=K(0),k=K(1);l.signum()!=0;){for(;l.isEven();)l.rShiftTo(1,l),c?((!v.isEven()||!m.isEven())&&(v.addTo(this,v),m.subTo(s,m)),v.rShiftTo(1,v)):m.isEven()||m.subTo(s,m),m.rShiftTo(1,m);for(;d.isEven();)d.rShiftTo(1,d),c?((!T.isEven()||!k.isEven())&&(T.addTo(this,T),k.subTo(s,k)),T.rShiftTo(1,T)):k.isEven()||k.subTo(s,k),k.rShiftTo(1,k);l.compareTo(d)>=0?(l.subTo(d,l),c&&v.subTo(T,v),m.subTo(k,m)):(d.subTo(l,d),c&&T.subTo(v,T),k.subTo(m,k))}if(d.compareTo(_.ONE)!=0)return _.ZERO;if(k.compareTo(s)>=0)return k.subtract(s);if(k.signum()<0)k.addTo(s,k);else return k;return k.signum()<0?k.add(s):k}var Zn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Mh=(1<<26)/Zn[Zn.length-1];function Lh(s){var c,l=this.abs();if(l.t==1&&l[0]<=Zn[Zn.length-1]){for(c=0;c<Zn.length;++c)if(l[0]==Zn[c])return!0;return!1}if(l.isEven())return!1;for(c=1;c<Zn.length;){for(var d=Zn[c],v=c+1;v<Zn.length&&d<Mh;)d*=Zn[v++];for(d=l.modInt(d);c<v;)if(d%Zn[c++]==0)return!1}return l.millerRabin(s)}function Yo(s){var c=this.subtract(_.ONE),l=c.getLowestSetBit();if(l<=0)return!1;var d=c.shiftRight(l);s=s+1>>1,s>Zn.length&&(s=Zn.length);for(var v=w(),m=0;m<s;++m){v.fromInt(Zn[Math.floor(Math.random()*Zn.length)]);var T=v.modPow(d,this);if(T.compareTo(_.ONE)!=0&&T.compareTo(c)!=0){for(var k=1;k++<l&&T.compareTo(c)!=0;)if(T=T.modPowInt(2,this),T.compareTo(_.ONE)==0)return!1;if(T.compareTo(c)!=0)return!1}}return!0}_.prototype.chunkSize=rt,_.prototype.toRadix=Rr,_.prototype.fromRadix=gr,_.prototype.fromNumber=Ut,_.prototype.bitwiseTo=Ga,_.prototype.changeBit=Sh,_.prototype.addTo=Jo,_.prototype.dMultiply=is,_.prototype.dAddOffset=Ph,_.prototype.multiplyLowerTo=Ul,_.prototype.multiplyUpperTo=Xo,_.prototype.modInt=Qo,_.prototype.millerRabin=Yo,_.prototype.clone=Un,_.prototype.intValue=Ui,_.prototype.byteValue=yt,_.prototype.shortValue=Rt,_.prototype.signum=zt,_.prototype.toByteArray=ct,_.prototype.equals=zn,_.prototype.min=ks,_.prototype.max=fn,_.prototype.and=nn,_.prototype.or=Dl,_.prototype.xor=ni,_.prototype.andNot=Nl,_.prototype.not=Ja,_.prototype.shiftLeft=Ol,_.prototype.shiftRight=Ml,_.prototype.getLowestSetBit=Go,_.prototype.bitCount=rs,_.prototype.testBit=bh,_.prototype.setBit=Jn,_.prototype.clearBit=da,_.prototype.flipBit=wh,_.prototype.add=xh,_.prototype.subtract=Rs,_.prototype.multiply=Ch,_.prototype.divide=jl,_.prototype.remainder=Eh,_.prototype.divideAndRemainder=Zo,_.prototype.modPow=Dh,_.prototype.modInverse=Oh,_.prototype.pow=Th,_.prototype.gcd=Nh,_.prototype.isProbablePrime=Lh,_.prototype.square=Ll;function ec(){this.i=0,this.j=0,this.S=new Array}function jh(s){var c,l,d;for(c=0;c<256;++c)this.S[c]=c;for(l=0,c=0;c<256;++c)l=l+this.S[c]+s[c%s.length]&255,d=this.S[c],this.S[c]=this.S[l],this.S[l]=d;this.i=0,this.j=0}function Bh(){var s;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,s=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=s,this.S[s+this.S[this.i]&255]}ec.prototype.init=jh,ec.prototype.next=Bh;function Uh(){return new ec}var tc=256,fa,ir,Rn;function Vl(s){ir[Rn++]^=s&255,ir[Rn++]^=s>>8&255,ir[Rn++]^=s>>16&255,ir[Rn++]^=s>>24&255,Rn>=tc&&(Rn-=tc)}function Za(){Vl(new Date().getTime())}if(ir==null){if(ir=new Array,Rn=0,n!==void 0&&(n.crypto!==void 0||n.msCrypto!==void 0)){if(nc=n.crypto||n.msCrypto,nc.getRandomValues)for(Xa=new Uint8Array(32),nc.getRandomValues(Xa),Ar=0;Ar<32;++Ar)ir[Rn++]=Xa[Ar];else if(t.appName=="Netscape"&&t.appVersion<"5")for(I=n.crypto.random(32),Ar=0;Ar<I.length;++Ar)ir[Rn++]=I.charCodeAt(Ar)&255}for(;Rn<tc;)Ar=Math.floor(65536*Math.random()),ir[Rn++]=Ar>>>8,ir[Rn++]=Ar&255;Rn=0,Za()}var Ar,nc,Xa,I;function B(){if(fa==null){for(Za(),fa=Uh(),fa.init(ir),Rn=0;Rn<ir.length;++Rn)ir[Rn]=0;Rn=0}return fa.next()}function V(s){var c;for(c=0;c<s.length;++c)s[c]=B()}function ae(){}ae.prototype.nextBytes=V;function be(s,c){return new _(s,c)}function we(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Pe(s,c){if(this.isPublic=!0,this.isPrivate=!1,typeof s!="string")this.n=s,this.e=c;else if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=be(s,16),this.e=parseInt(c,16);else throw"Invalid RSA public key"}function Ie(s){return s.modPowInt(this.e,this.n)}we.prototype.doPublic=Ie,we.prototype.setPublic=Pe,we.prototype.type="RSA";function Be(s,c,l){if(this.isPrivate=!0,typeof s!="string")this.n=s,this.e=c,this.d=l;else if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=be(s,16),this.e=parseInt(c,16),this.d=be(l,16);else throw"Invalid RSA private key"}function Ke(s,c,l,d,v,m,T,k){if(this.isPrivate=!0,this.isPublic=!1,s==null)throw"RSASetPrivateEx N == null";if(c==null)throw"RSASetPrivateEx E == null";if(s.length==0)throw"RSASetPrivateEx N.length == 0";if(c.length==0)throw"RSASetPrivateEx E.length == 0";if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=be(s,16),this.e=parseInt(c,16),this.d=be(l,16),this.p=be(d,16),this.q=be(v,16),this.dmp1=be(m,16),this.dmq1=be(T,16),this.coeff=be(k,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function dt(s,c){var l=new ae,d=s>>1;this.e=parseInt(c,16);for(var v=new _(c,16),m=s/2-100,T=_.ONE.shiftLeft(m);;){for(;this.p=new _(s-d,1,l),!(this.p.subtract(_.ONE).gcd(v).compareTo(_.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new _(d,1,l),!(this.q.subtract(_.ONE).gcd(v).compareTo(_.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var k=this.p;this.p=this.q,this.q=k}var O=this.q.subtract(this.p).abs();if(!(O.bitLength()<m||O.compareTo(T)<=0)){var F=this.p.subtract(_.ONE),U=this.q.subtract(_.ONE),L=F.multiply(U);if(L.gcd(v).compareTo(_.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==s)){this.d=v.modInverse(L),this.dmp1=this.d.mod(F),this.dmq1=this.d.mod(U),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function qt(s){if(this.p==null||this.q==null)return s.modPow(this.d,this.n);for(var c=s.mod(this.p).modPow(this.dmp1,this.p),l=s.mod(this.q).modPow(this.dmq1,this.q);c.compareTo(l)<0;)c=c.add(this.p);return c.subtract(l).multiply(this.coeff).mod(this.p).multiply(this.q).add(l)}we.prototype.doPrivate=qt,we.prototype.setPrivate=Be,we.prototype.setPrivateEx=Ke,we.prototype.generate=dt;function tt(s,c){this.x=c,this.q=s}function gt(s){return s==this?!0:this.q.equals(s.q)&&this.x.equals(s.x)}function Ye(){return this.x}function ht(){return new tt(this.q,this.x.negate().mod(this.q))}function wt(s){return new tt(this.q,this.x.add(s.toBigInteger()).mod(this.q))}function At(s){return new tt(this.q,this.x.subtract(s.toBigInteger()).mod(this.q))}function Nn(s){return new tt(this.q,this.x.multiply(s.toBigInteger()).mod(this.q))}function Gt(){return new tt(this.q,this.x.square().mod(this.q))}function Xn(s){return new tt(this.q,this.x.multiply(s.toBigInteger().modInverse(this.q)).mod(this.q))}tt.prototype.equals=gt,tt.prototype.toBigInteger=Ye,tt.prototype.negate=ht,tt.prototype.add=wt,tt.prototype.subtract=At,tt.prototype.multiply=Nn,tt.prototype.square=Gt,tt.prototype.divide=Xn,tt.prototype.sqrt=function(){return new tt(this.q,this.x.sqrt().mod(this.q))};function it(s,c,l,d){this.curve=s,this.x=c,this.y=l,d==null?this.z=_.ONE:this.z=d,this.zinv=null}function _t(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Nt(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function jt(s){if(s==this)return!0;if(this.isInfinity())return s.isInfinity();if(s.isInfinity())return this.isInfinity();var c,l;return c=s.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(s.z)).mod(this.curve.q),c.equals(_.ZERO)?(l=s.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(s.z)).mod(this.curve.q),l.equals(_.ZERO)):!1}function Et(){return this.x==null&&this.y==null?!0:this.z.equals(_.ZERO)&&!this.y.toBigInteger().equals(_.ZERO)}function Ot(){return new it(this.curve,this.x,this.y.negate(),this.z)}function Bt(s){if(this.isInfinity())return s;if(s.isInfinity())return this;var c=s.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(s.z)).mod(this.curve.q),l=s.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(s.z)).mod(this.curve.q);if(_.ZERO.equals(l))return _.ZERO.equals(c)?this.twice():this.curve.getInfinity();var d=new _("3"),v=this.x.toBigInteger(),m=this.y.toBigInteger();s.x.toBigInteger(),s.y.toBigInteger();var T=l.square(),k=T.multiply(l),O=v.multiply(T),F=c.square().multiply(this.z),U=F.subtract(O.shiftLeft(1)).multiply(s.z).subtract(k).multiply(l).mod(this.curve.q),L=O.multiply(d).multiply(c).subtract(m.multiply(k)).subtract(F.multiply(c)).multiply(s.z).add(c.multiply(k)).mod(this.curve.q),P=k.multiply(this.z).multiply(s.z).mod(this.curve.q);return new it(this.curve,this.curve.fromBigInteger(U),this.curve.fromBigInteger(L),P)}function As(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var s=new _("3"),c=this.x.toBigInteger(),l=this.y.toBigInteger(),d=l.multiply(this.z),v=d.multiply(l).mod(this.curve.q),m=this.curve.a.toBigInteger(),T=c.square().multiply(s);_.ZERO.equals(m)||(T=T.add(this.z.square().multiply(m))),T=T.mod(this.curve.q);var k=T.square().subtract(c.shiftLeft(3).multiply(v)).shiftLeft(1).multiply(d).mod(this.curve.q),O=T.multiply(s).multiply(c).subtract(v.shiftLeft(1)).shiftLeft(2).multiply(v).subtract(T.square().multiply(T)).mod(this.curve.q),F=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new it(this.curve,this.curve.fromBigInteger(k),this.curve.fromBigInteger(O),F)}function w2(s){if(this.isInfinity())return this;if(s.signum()==0)return this.curve.getInfinity();var c=s,l=c.multiply(new _("3")),d=this.negate(),v=this,m=this.curve.q.subtract(s),T=m.multiply(new _("3")),k=new it(this.curve,this.x,this.y),O=k.negate(),F;for(F=l.bitLength()-2;F>0;--F){v=v.twice();var U=l.testBit(F),L=c.testBit(F);U!=L&&(v=v.add(U?this:d))}for(F=T.bitLength()-2;F>0;--F){k=k.twice();var P=T.testBit(F),D=m.testBit(F);P!=D&&(k=k.add(P?k:O))}return v}function x2(s,c,l){var d;s.bitLength()>l.bitLength()?d=s.bitLength()-1:d=l.bitLength()-1;for(var v=this.curve.getInfinity(),m=this.add(c);d>=0;)v=v.twice(),s.testBit(d)?l.testBit(d)?v=v.add(m):v=v.add(this):l.testBit(d)&&(v=v.add(c)),--d;return v}it.prototype.getX=_t,it.prototype.getY=Nt,it.prototype.equals=jt,it.prototype.isInfinity=Et,it.prototype.negate=Ot,it.prototype.add=Bt,it.prototype.twice=As,it.prototype.multiply=w2,it.prototype.multiplyTwo=x2;function as(s,c,l){this.q=s,this.a=this.fromBigInteger(c),this.b=this.fromBigInteger(l),this.infinity=new it(this,null,null)}function C2(){return this.q}function E2(){return this.a}function P2(){return this.b}function k2(s){return s==this?!0:this.q.equals(s.q)&&this.a.equals(s.a)&&this.b.equals(s.b)}function T2(){return this.infinity}function R2(s){return new tt(this.q,s)}function A2(s){switch(parseInt(s.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var c=s.substr(0,2);s.substr(2);var l=this.fromBigInteger(new _(O,16)),d=this.getA(),v=this.getB(),m=l.square().add(d).multiply(l).add(v),T=m.sqrt();return c=="03"&&(T=T.negate()),new it(this,l,T);case 4:case 6:case 7:var k=(s.length-2)/2,O=s.substr(2,k),F=s.substr(k+2,k);return new it(this,this.fromBigInteger(new _(O,16)),this.fromBigInteger(new _(F,16)));default:return null}}as.prototype.getQ=C2,as.prototype.getA=E2,as.prototype.getB=P2,as.prototype.equals=k2,as.prototype.getInfinity=T2,as.prototype.fromBigInteger=R2,as.prototype.decodePointHex=A2,tt.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},it.prototype.getEncoded=function(s){var c=function(m,T){var k=m.toByteArrayUnsigned();if(T<k.length)k=k.slice(k.length-T);else for(;T>k.length;)k.unshift(0);return k},l=this.getX().toBigInteger(),d=this.getY().toBigInteger(),v=c(l,32);return s?d.isEven()?v.unshift(2):v.unshift(3):(v.unshift(4),v=v.concat(c(d,32))),v},it.decodeFrom=function(s,c){c[0];var l=c.length-1,d=c.slice(1,1+l/2),v=c.slice(1+l/2,1+l);d.unshift(0),v.unshift(0);var m=new _(d),T=new _(v);return new it(s,s.fromBigInteger(m),s.fromBigInteger(T))},it.decodeFromHex=function(s,c){c.substr(0,2);var l=c.length-2,d=c.substr(2,l/2),v=c.substr(2+l/2,l/2),m=new _(d,16),T=new _(v,16);return new it(s,s.fromBigInteger(m),s.fromBigInteger(T))},it.prototype.add2D=function(s){if(this.isInfinity())return s;if(s.isInfinity())return this;if(this.x.equals(s.x))return this.y.equals(s.y)?this.twice():this.curve.getInfinity();var c=s.x.subtract(this.x),l=s.y.subtract(this.y),d=l.divide(c),v=d.square().subtract(this.x).subtract(s.x),m=d.multiply(this.x.subtract(v)).subtract(this.y);return new it(this.curve,v,m)},it.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var s=this.curve.fromBigInteger(_.valueOf(2)),c=this.curve.fromBigInteger(_.valueOf(3)),l=this.x.square().multiply(c).add(this.curve.a).divide(this.y.multiply(s)),d=l.square().subtract(this.x.multiply(s)),v=l.multiply(this.x.subtract(d)).subtract(this.y);return new it(this.curve,d,v)},it.prototype.multiply2D=function(s){if(this.isInfinity())return this;if(s.signum()==0)return this.curve.getInfinity();var c=s,l=c.multiply(new _("3")),d=this.negate(),v=this,m;for(m=l.bitLength()-2;m>0;--m){v=v.twice();var T=l.testBit(m),k=c.testBit(m);T!=k&&(v=v.add2D(T?this:d))}return v},it.prototype.isOnCurve=function(){var s=this.getX().toBigInteger(),c=this.getY().toBigInteger(),l=this.curve.getA().toBigInteger(),d=this.curve.getB().toBigInteger(),v=this.curve.getQ(),m=c.multiply(c).mod(v),T=s.multiply(s).multiply(s).add(l.multiply(s)).add(d).mod(v);return m.equals(T)},it.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},it.prototype.validate=function(){var s=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var c=this.getX().toBigInteger(),l=this.getY().toBigInteger();if(c.compareTo(_.ONE)<0||c.compareTo(s.subtract(_.ONE))>0)throw new Error("x coordinate out of bounds");if(l.compareTo(_.ONE)<0||l.compareTo(s.subtract(_.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(s).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var yg=function(){var s="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",c='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',l='(?:"'+c+'*")',d=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+s+"|"+l+")","g"),v=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),m={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function T(U,L,P){return L?m[L]:String.fromCharCode(parseInt(P,16))}var k=new String(""),O="\\",F=Object.hasOwnProperty;return function(U,L){var P=U.match(d),D,A=P[0],N=!1;A==="{"?D={}:A==="["?D=[]:(D=[],N=!0);for(var j,W=[D],se=1-N,de=P.length;se<de;++se){A=P[se];var ue;switch(A.charCodeAt(0)){default:ue=W[0],ue[j||ue.length]=+A,j=void 0;break;case 34:if(A=A.substring(1,A.length-1),A.indexOf(O)!==-1&&(A=A.replace(v,T)),ue=W[0],!j)if(ue instanceof Array)j=ue.length;else{j=A||k;break}ue[j]=A,j=void 0;break;case 91:ue=W[0],W.unshift(ue[j||ue.length]=[]),j=void 0;break;case 93:W.shift();break;case 102:ue=W[0],ue[j||ue.length]=!1,j=void 0;break;case 110:ue=W[0],ue[j||ue.length]=null,j=void 0;break;case 116:ue=W[0],ue[j||ue.length]=!0,j=void 0;break;case 123:ue=W[0],W.unshift(ue[j||ue.length]={}),j=void 0;break;case 125:W.shift();break}}if(N){if(W.length!==1)throw new Error;D=D[0]}else if(W.length)throw new Error;if(L){var pe=function(G,X){var te=G[X];if(te&&typeof te=="object"){var J=null;for(var re in te)if(F.call(te,re)&&te!==G){var he=pe(te,re);he!==void 0?te[re]=he:(J||(J=[]),J.push(re))}if(J)for(var ye=J.length;--ye>=0;)delete te[J[ye]]}return L.call(G,X,te)};D=pe({"":D},"")}return D}}();(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),y.asn1.ASN1Util=new function(){this.integerToByteHex=function(s){var c=s.toString(16);return c.length%2==1&&(c="0"+c),c},this.bigIntToMinTwosComplementsHex=function(s){return sc(s)},this.getPEMStringFromHex=function(s,c){return sr(s,c)},this.newObject=function(s){var c=y,l=c.asn1,d=l.ASN1Object,v=l.DERBoolean,m=l.DERInteger,T=l.DERBitString,k=l.DEROctetString,O=l.DERNull,F=l.DERObjectIdentifier,U=l.DEREnumerated,L=l.DERUTF8String,P=l.DERNumericString,D=l.DERPrintableString,A=l.DERTeletexString,N=l.DERIA5String,j=l.DERUTCTime,W=l.DERGeneralizedTime,se=l.DERVisibleString,de=l.DERBMPString,ue=l.DERSequence,pe=l.DERSet,G=l.DERTaggedObject,X=l.ASN1Util.newObject;if(s instanceof l.ASN1Object)return s;var te=Object.keys(s);if(te.length!=1)throw new Error("key of param shall be only one.");var J=te[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+J+":")==-1)throw new Error("undefined key: "+J);if(J=="bool")return new v(s[J]);if(J=="int")return new m(s[J]);if(J=="bitstr")return new T(s[J]);if(J=="octstr")return new k(s[J]);if(J=="null")return new O(s[J]);if(J=="oid")return new F(s[J]);if(J=="enum")return new U(s[J]);if(J=="utf8str")return new L(s[J]);if(J=="numstr")return new P(s[J]);if(J=="prnstr")return new D(s[J]);if(J=="telstr")return new A(s[J]);if(J=="ia5str")return new N(s[J]);if(J=="utctime")return new j(s[J]);if(J=="gentime")return new W(s[J]);if(J=="visstr")return new se(s[J]);if(J=="bmpstr")return new de(s[J]);if(J=="asn1")return new d(s[J]);if(J=="seq"){for(var re=s[J],he=[],ye=0;ye<re.length;ye++){var Ae=X(re[ye]);he.push(Ae)}return new ue({array:he})}if(J=="set"){for(var re=s[J],he=[],ye=0;ye<re.length;ye++){var Ae=X(re[ye]);he.push(Ae)}return new pe({array:he})}if(J=="tag"){var ve=s[J];if(Object.prototype.toString.call(ve)==="[object Array]"&&ve.length==3){var xe=X(ve[2]);return new G({tag:ve[0],explicit:ve[1],obj:xe})}else return new G(ve)}},this.jsonToASN1HEX=function(s){var c=this.newObject(s);return c.tohex()}},y.asn1.ASN1Util.oidHexToInt=function(s){for(var v="",c=parseInt(s.substr(0,2),16),l=Math.floor(c/40),d=c%40,v=l+"."+d,m="",T=2;T<s.length;T+=2){var k=parseInt(s.substr(T,2),16),O=("00000000"+k.toString(2)).slice(-8);if(m=m+O.substr(1,7),O.substr(0,1)=="0"){var F=new _(m,2);v=v+"."+F.toString(10),m=""}}return v},y.asn1.ASN1Util.oidIntToHex=function(s){var c=function(k){var O=k.toString(16);return O.length==1&&(O="0"+O),O},l=function(k){var O="",F=new _(k,10),U=F.toString(2),L=7-U.length%7;L==7&&(L=0);for(var P="",D=0;D<L;D++)P+="0";U=P+U;for(var D=0;D<U.length-1;D+=7){var A=U.substr(D,7);D!=U.length-7&&(A="1"+A),O+=c(parseInt(A,2))}return O};if(!s.match(/^[0-9.]+$/))throw"malformed oid string: "+s;var d="",v=s.split("."),m=parseInt(v[0])*40+parseInt(v[1]);d+=c(m),v.splice(0,2);for(var T=0;T<v.length;T++)d+=l(v[T]);return d},y.asn1.ASN1Object=function(s){var c="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+c.length+",v="+this.hV);var l=this.hV.length/2,d=l.toString(16);if(d.length%2==1&&(d="0"+d),l<128)return d;var v=d.length/2;if(v>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+l.toString(16));var m=128+v;return m.toString(16)+d},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(l){this.params=l},s!=null&&s.tlv!=null&&(this.hTLV=s.tlv,this.isModified=!1)},y.asn1.DERAbstractString=function(s){y.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(c){this.hTLV=null,this.isModified=!0,this.s=c,this.hV=zl(this.s).toLowerCase()},this.setStringHex=function(c){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=c},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s=="string"?this.setString(s):typeof s.str<"u"?this.setString(s.str):typeof s.hex<"u"&&this.setStringHex(s.hex))},Re(y.asn1.DERAbstractString,y.asn1.ASN1Object),y.asn1.DERAbstractTime=function(s){y.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(c){var l=c.getTime()+c.getTimezoneOffset()*6e4,d=new Date(l);return d},this.formatDate=function(c,l,d){var v=this.zeroPadding,m=this.localDateToUTC(c),T=String(m.getFullYear());l=="utc"&&(T=T.substr(2,2));var k=v(String(m.getMonth()+1),2),O=v(String(m.getDate()),2),F=v(String(m.getHours()),2),U=v(String(m.getMinutes()),2),L=v(String(m.getSeconds()),2),P=T+k+O+F+U+L;if(d===!0){var D=m.getMilliseconds();if(D!=0){var A=v(String(D),3);A=A.replace(/[0]+$/,""),P=P+"."+A}}return P+"Z"},this.zeroPadding=function(c,l){return c.length>=l?c:new Array(l-c.length+1).join("0")+c},this.setByParam=function(c){this.hV=null,this.hTLV=null,this.params=c},this.getString=function(){},this.setString=function(c){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=c},this.setByDate=function(c){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=c},this.setByDateValue=function(c,l,d,v,m,T){var k=new Date(Date.UTC(c,l-1,d,v,m,T,0));this.setByDate(k)},this.getFreshValueHex=function(){return this.hV}},Re(y.asn1.DERAbstractTime,y.asn1.ASN1Object),y.asn1.DERAbstractStructured=function(s){y.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array=c},this.appendASN1Object=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array.push(c)},this.asn1Array=new Array,typeof s<"u"&&typeof s.array<"u"&&(this.asn1Array=s.array)},Re(y.asn1.DERAbstractStructured,y.asn1.ASN1Object),y.asn1.DERBoolean=function(s){y.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",s==!1?this.hTLV="010100":this.hTLV="0101ff"},Re(y.asn1.DERBoolean,y.asn1.ASN1Object),y.asn1.DERInteger=function(s){y.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var c=sc;this.setByBigInteger=function(l){this.isModified=!0,this.params={bigint:l}},this.setByInteger=function(l){this.isModified=!0,this.params=l},this.setValueHex=function(l){this.isModified=!0,this.params={hex:l}},this.getFreshValueHex=function(){var l=this.params,d=null;if(l==null)throw new Error("value not set");if(typeof l=="object"&&l.hex!=null)return this.hV=l.hex,this.hV;if(typeof l=="number")d=new _(String(l),10);else if(l.int!=null)d=new _(String(l.int),10);else if(l.bigint!=null)d=l.bigint;else throw new Error("wrong parameter");return this.hV=c(d),this.hV},s!=null&&(this.params=s)},Re(y.asn1.DERInteger,y.asn1.ASN1Object),y.asn1.DERBitString=function(s){if(s!==void 0&&typeof s.obj<"u"){var c=y.asn1.ASN1Util.newObject(s.obj);s.hex="00"+c.tohex()}y.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(l){this.hTLV=null,this.isModified=!0,this.hV=l},this.setUnusedBitsAndHexValue=function(l,d){if(l<0||7<l)throw"unused bits shall be from 0 to 7: u = "+l;var v="0"+l;this.hTLV=null,this.isModified=!0,this.hV=v+d},this.setByBinaryString=function(l){l=l.replace(/0+$/,"");var d=8-l.length%8;d==8&&(d=0),l+="0000000".substr(0,d);for(var v="",m=0;m<l.length-1;m+=8){var T=l.substr(m,8),k=parseInt(T,2).toString(16);k.length==1&&(k="0"+k),v+=k}this.hTLV=null,this.isModified=!0,this.hV="0"+d+v},this.setByBooleanArray=function(l){for(var d="",v=0;v<l.length;v++)l[v]==!0?d+="1":d+="0";this.setByBinaryString(d)},this.newFalseArray=function(l){for(var d=new Array(l),v=0;v<l;v++)d[v]=!1;return d},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s=="string"&&s.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(s):typeof s.hex<"u"?this.setHexValueIncludingUnusedBits(s.hex):typeof s.bin<"u"?this.setByBinaryString(s.bin):typeof s.array<"u"&&this.setByBooleanArray(s.array))},Re(y.asn1.DERBitString,y.asn1.ASN1Object),y.asn1.DEROctetString=function(s){if(s!==void 0&&typeof s.obj<"u"){var c=y.asn1.ASN1Util.newObject(s.obj);s.hex=c.tohex()}y.asn1.DEROctetString.superclass.constructor.call(this,s),this.hT="04"},Re(y.asn1.DEROctetString,y.asn1.DERAbstractString),y.asn1.DERNull=function(){y.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Re(y.asn1.DERNull,y.asn1.ASN1Object),y.asn1.DERObjectIdentifier=function(s){y.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(c){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=c},this.setValueOidString=function(c){var l=kg(c);if(l==null)throw new Error("malformed oid string: "+c);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=l},this.setValueName=function(c){var l=y.asn1.x509.OID.name2oid(c);if(l!=="")this.setValueOidString(l);else throw new Error("DERObjectIdentifier oidName undefined: "+c)},this.setValueNameOrOid=function(c){c.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(c):this.setValueName(c)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(c){typeof c=="string"?this.setValueNameOrOid(c):c.oid!==void 0?this.setValueNameOrOid(c.oid):c.name!==void 0?this.setValueNameOrOid(c.name):c.hex!==void 0&&this.setValueHex(c.hex)},s!==void 0&&this.setByParam(s)},Re(y.asn1.DERObjectIdentifier,y.asn1.ASN1Object),y.asn1.DEREnumerated=function(s){y.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(c){this.hTLV=null,this.isModified=!0,this.hV=sc(c)},this.setByInteger=function(c){var l=new _(String(c),10);this.setByBigInteger(l)},this.setValueHex=function(c){this.hV=c},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s.int<"u"?this.setByInteger(s.int):typeof s=="number"?this.setByInteger(s):typeof s.hex<"u"&&this.setValueHex(s.hex))},Re(y.asn1.DEREnumerated,y.asn1.ASN1Object),y.asn1.DERUTF8String=function(s){y.asn1.DERUTF8String.superclass.constructor.call(this,s),this.hT="0c"},Re(y.asn1.DERUTF8String,y.asn1.DERAbstractString),y.asn1.DERNumericString=function(s){y.asn1.DERNumericString.superclass.constructor.call(this,s),this.hT="12"},Re(y.asn1.DERNumericString,y.asn1.DERAbstractString),y.asn1.DERPrintableString=function(s){y.asn1.DERPrintableString.superclass.constructor.call(this,s),this.hT="13"},Re(y.asn1.DERPrintableString,y.asn1.DERAbstractString),y.asn1.DERTeletexString=function(s){y.asn1.DERTeletexString.superclass.constructor.call(this,s),this.hT="14"},Re(y.asn1.DERTeletexString,y.asn1.DERAbstractString),y.asn1.DERIA5String=function(s){y.asn1.DERIA5String.superclass.constructor.call(this,s),this.hT="16"},Re(y.asn1.DERIA5String,y.asn1.DERAbstractString),y.asn1.DERVisibleString=function(s){y.asn1.DERIA5String.superclass.constructor.call(this,s),this.hT="1a"},Re(y.asn1.DERVisibleString,y.asn1.DERAbstractString),y.asn1.DERBMPString=function(s){y.asn1.DERBMPString.superclass.constructor.call(this,s),this.hT="1e"},Re(y.asn1.DERBMPString,y.asn1.DERAbstractString),y.asn1.DERUTCTime=function(s){y.asn1.DERUTCTime.superclass.constructor.call(this,s),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var c=this.params;if(this.params==null&&(c={date:new Date}),typeof c=="string")if(c.match(/^[0-9]{12}Z$/)||c.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=Ir(c);else throw new Error("malformed string for UTCTime: "+c);else if(c.str!=null)this.hV=Ir(c.str);else if(c.date==null&&c.millis==!0){var l=new Date;this.hV=Ir(this.formatDate(l,"utc",!0))}else if(c.date!=null&&c.date instanceof Date){var d=c.millis===!0;this.hV=Ir(this.formatDate(c.date,"utc",d))}else c instanceof Date&&(this.hV=Ir(this.formatDate(c,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},s!=null&&this.setByParam(s)},Re(y.asn1.DERUTCTime,y.asn1.DERAbstractTime),y.asn1.DERGeneralizedTime=function(s){y.asn1.DERGeneralizedTime.superclass.constructor.call(this,s),this.hT="18",this.params=s,this.getFreshValueHex=function(){var c=this.params;if(this.params==null&&(c={date:new Date}),typeof c=="string")if(c.match(/^[0-9]{14}Z$/)||c.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=Ir(c);else throw new Error("malformed string for GeneralizedTime: "+c);else if(c.str!=null)this.hV=Ir(c.str);else if(c.date==null&&c.millis==!0){var l=new Date;this.hV=Ir(this.formatDate(l,"gen",!0))}else if(c.date!=null&&c.date instanceof Date){var d=c.millis===!0;this.hV=Ir(this.formatDate(c.date,"gen",d))}else c instanceof Date&&(this.hV=Ir(this.formatDate(c,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},s!=null&&this.setByParam(s)},Re(y.asn1.DERGeneralizedTime,y.asn1.DERAbstractTime),y.asn1.DERSequence=function(s){y.asn1.DERSequence.superclass.constructor.call(this,s),this.hT="30",this.getFreshValueHex=function(){for(var c="",l=0;l<this.asn1Array.length;l++){var d=this.asn1Array[l];c+=d.tohex()}return this.hV=c,this.hV}},Re(y.asn1.DERSequence,y.asn1.DERAbstractStructured),y.asn1.DERSet=function(s){y.asn1.DERSet.superclass.constructor.call(this,s),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var c=new Array,l=0;l<this.asn1Array.length;l++){var d=this.asn1Array[l];c.push(d.tohex())}return this.sortFlag==!0&&c.sort(),this.hV=c.join(""),this.hV},typeof s<"u"&&typeof s.sortflag<"u"&&s.sortflag==!1&&(this.sortFlag=!1)},Re(y.asn1.DERSet,y.asn1.DERAbstractStructured),y.asn1.DERTaggedObject=function(s){y.asn1.DERTaggedObject.superclass.constructor.call(this);var c=y.asn1,l=Me,d=l.getV;l.isASN1HEX;var v=c.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(m,T,k){this.params={tag:T,explicit:m,obj:k}},this.getFreshValueHex=function(){var m=this.params;if(m.explicit==null&&(m.explicit=!0),m.tage!=null&&(m.tag=m.tage,m.explicit=!0),m.tagi!=null&&(m.tag=m.tagi,m.explicit=!1),m.str!=null)this.hV=zl(m.str);else if(m.hex!=null)this.hV=m.hex;else if(m.obj!=null){var T;m.obj instanceof c.ASN1Object?T=m.obj.tohex():typeof m.obj=="object"&&(T=v(m.obj).tohex()),m.explicit?this.hV=T:this.hV=d(T,0)}else throw new Error("str, hex nor obj not specified");return m.tag==null&&(m.tag="a0"),this.hT=m.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(m){this.params=m},s!==void 0&&this.setByParam(s)},Re(y.asn1.DERTaggedObject,y.asn1.ASN1Object);var Me=new function(){};Me.getLblen=function(s,c){if(s.substr(c+2,1)!="8")return 1;var l=parseInt(s.substr(c+3,1));return l==0?-1:0<l&&l<10?l+1:-2},Me.getL=function(s,c){var l=Me.getLblen(s,c);return l<1?"":s.substr(c+2,l*2)},Me.getVblen=function(s,c){var l,d;return l=Me.getL(s,c),l==""?-1:(l.substr(0,1)==="8"?d=new _(l.substr(2),16):d=new _(l,16),d.intValue())},Me.getVidx=function(s,c){var l=Me.getLblen(s,c);return l<0?l:c+(l+1)*2},Me.getV=function(s,c){var l=Me.getVidx(s,c),d=Me.getVblen(s,c);return s.substr(l,d*2)},Me.getTLV=function(s,c){return s.substr(c,2)+Me.getL(s,c)+Me.getV(s,c)},Me.getTLVblen=function(s,c){return 2+Me.getLblen(s,c)*2+Me.getVblen(s,c)*2},Me.getNextSiblingIdx=function(s,c){var l=Me.getVidx(s,c),d=Me.getVblen(s,c);return l+d*2},Me.getChildIdx=function(s,c){var l=Me,d=[],v,m,T;v=l.getVidx(s,c),m=l.getVblen(s,c)*2,s.substr(c,2)=="03"&&(v+=2,m-=2),T=0;for(var k=v;T<=m;){var O=l.getTLVblen(s,k);if(T+=O,T<=m&&d.push(k),k+=O,T>=m)break}return d},Me.getNthChildIdx=function(s,c,l){var d=Me.getChildIdx(s,c);return d[l]},Me.getIdxbyList=function(s,c,l,d){var v=Me,m,T;return l.length==0?d!==void 0&&s.substr(c,2)!==d?-1:c:(m=l.shift(),T=v.getChildIdx(s,c),m>=T.length?-1:v.getIdxbyList(s,T[m],l,d))},Me.getIdxbyListEx=function(s,c,l,d){var v=Me,m,T;if(l.length==0)return d!==void 0&&s.substr(c,2)!==d?-1:c;m=l.shift(),T=v.getChildIdx(s,c);for(var k=0,O=0;O<T.length;O++){var F=s.substr(T[O],2);if(typeof m=="number"&&!v.isContextTag(F)&&k==m||typeof m=="string"&&v.isContextTag(F,m))return v.getIdxbyListEx(s,T[O],l,d);v.isContextTag(F)||k++}return-1},Me.getTLVbyList=function(s,c,l,d){var v=Me,m=v.getIdxbyList(s,c,l,d);return m==-1||m>=s.length?null:v.getTLV(s,m)},Me.getTLVbyListEx=function(s,c,l,d){var v=Me,m=v.getIdxbyListEx(s,c,l,d);return m==-1?null:v.getTLV(s,m)},Me.getVbyList=function(s,c,l,d,v){var m=Me,T,k;return T=m.getIdxbyList(s,c,l,d),T==-1||T>=s.length?null:(k=m.getV(s,T),v===!0&&(k=k.substr(2)),k)},Me.getVbyListEx=function(s,c,l,d,v){var m=Me,T,k;return T=m.getIdxbyListEx(s,c,l,d),T==-1?null:(k=m.getV(s,T),s.substr(T,2)=="03"&&v!==!1&&(k=k.substr(2)),k)},Me.getInt=function(s,c,l){l==null&&(l=-1);try{var d=s.substr(c,2);if(d!="02"&&d!="03")return l;var v=Me.getV(s,c);return d=="02"?parseInt(v,16):Rg(v)}catch{return l}},Me.getOID=function(s,c,l){l==null&&(l=null);try{if(s.substr(c,2)!="06")return l;var d=Me.getV(s,c);return Zl(d)}catch{return l}},Me.getOIDName=function(s,c,l){l==null&&(l=null);try{var d=Me.getOID(s,c,l);if(d==l)return l;var v=y.asn1.x509.OID.oid2name(d);return v==""?d:v}catch{return l}},Me.getString=function(s,c,l){l==null&&(l=null);try{var d=Me.getV(s,c);return Fr(d)}catch{return l}},Me.hextooidstr=function(s){var c=function(L,P){return L.length>=P?L:new Array(P-L.length+1).join("0")+L},l=[],d=s.substr(0,2),v=parseInt(d,16);l[0]=new String(Math.floor(v/40)),l[1]=new String(v%40);for(var m=s.substr(2),T=[],k=0;k<m.length/2;k++)T.push(parseInt(m.substr(k*2,2),16));for(var O=[],F="",k=0;k<T.length;k++)T[k]&128?F=F+c((T[k]&127).toString(2),7):(F=F+c((T[k]&127).toString(2),7),O.push(new String(parseInt(F,2))),F="");var U=l.join(".");return O.length>0&&(U=U+"."+O.join(".")),U},Me.dump=function(s,c,l,d){var v=Me,m=v.getV,T=v.dump,k=v.getChildIdx,O=s;s instanceof y.asn1.ASN1Object&&(O=s.tohex());var F=function(X,te){if(X.length<=te*2)return X;var J=X.substr(0,te)+"..(total "+X.length/2+"bytes).."+X.substr(X.length-te,te);return J};c===void 0&&(c={ommit_long_octet:32}),l===void 0&&(l=0),d===void 0&&(d="");var U=c.ommit_long_octet,pe=O.substr(l,2);if(pe=="01"){var L=m(O,l);return L=="00"?d+`BOOLEAN FALSE
`:d+`BOOLEAN TRUE
`}if(pe=="02"){var L=m(O,l);return d+"INTEGER "+F(L,U)+`
`}if(pe=="03"){var L=m(O,l);if(v.isASN1HEX(L.substr(2))){var P=d+`BITSTRING, encapsulates
`;return P=P+T(L.substr(2),c,0,d+"  "),P}else return d+"BITSTRING "+F(L,U)+`
`}if(pe=="04"){var L=m(O,l);if(v.isASN1HEX(L)){var P=d+`OCTETSTRING, encapsulates
`;return P=P+T(L,c,0,d+"  "),P}else return d+"OCTETSTRING "+F(L,U)+`
`}if(pe=="05")return d+`NULL
`;if(pe=="06"){var D=m(O,l),A=y.asn1.ASN1Util.oidHexToInt(D),N=y.asn1.x509.OID.oid2name(A),j=A.replace(/\./g," ");return N!=""?d+"ObjectIdentifier "+N+" ("+j+`)
`:d+"ObjectIdentifier ("+j+`)
`}if(pe=="0a")return d+"ENUMERATED "+parseInt(m(O,l))+`
`;if(pe=="0c")return d+"UTF8String '"+Jt(m(O,l))+`'
`;if(pe=="13")return d+"PrintableString '"+Jt(m(O,l))+`'
`;if(pe=="14")return d+"TeletexString '"+Jt(m(O,l))+`'
`;if(pe=="16")return d+"IA5String '"+Jt(m(O,l))+`'
`;if(pe=="17")return d+"UTCTime "+Jt(m(O,l))+`
`;if(pe=="18")return d+"GeneralizedTime "+Jt(m(O,l))+`
`;if(pe=="1a")return d+"VisualString '"+Jt(m(O,l))+`'
`;if(pe=="1e")return d+"BMPString '"+$h(m(O,l))+`'
`;if(pe=="30"){if(O.substr(l,4)=="3000")return d+`SEQUENCE {}
`;var P=d+`SEQUENCE
`,W=k(O,l),se=c;if((W.length==2||W.length==3)&&O.substr(W[0],2)=="06"&&O.substr(W[W.length-1],2)=="04"){var N=v.oidname(m(O,W[0])),de=JSON.parse(JSON.stringify(c));de.x509ExtName=N,se=de}for(var ue=0;ue<W.length;ue++)P=P+T(O,se,W[ue],d+"  ");return P}if(pe=="31"){for(var P=d+`SET
`,W=k(O,l),ue=0;ue<W.length;ue++)P=P+T(O,c,W[ue],d+"  ");return P}var pe=parseInt(pe,16);if(pe&128){var G=pe&31;if(pe&32){for(var P=d+"["+G+`]
`,W=k(O,l),ue=0;ue<W.length;ue++)P=P+T(O,c,W[ue],d+"  ");return P}else{var L=m(O,l);if(Me.isASN1HEX(L)){var P=d+"["+G+`]
`;return P=P+T(L,c,0,d+"  "),P}else(L.substr(0,8)=="68747470"||c.x509ExtName==="subjectAltName"&&G==2)&&(L=Jt(L));var P=d+"["+G+"] "+L+`
`;return P}}return d+"UNKNOWN("+pe+") "+m(O,l)+`
`},Me.parse=function(s){var c=Me,l=c.parse,d=c.isASN1HEX,v=c.getV,m=c.getTLV,T=c.getChildIdx,k=y.asn1,O=k.ASN1Util.oidHexToInt,F=k.x509.OID.oid2name,U=Jt,L=$h,P=M2,D={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},A=function(J){for(var re=[],he=T(J,0),ye=0;ye<he.length;ye++){var Ae=he[ye],ve=m(J,Ae),xe=l(ve);re.push(xe)}return re},N=s.substr(0,2),j={},W=v(s,0);if(N=="01")return s=="0101ff"?{bool:!0}:{bool:!1};if(N=="02")return{int:{hex:W}};if(N=="03")try{if(W.substr(0,2)!="00")throw"not encap";var se=W.substr(2);if(!d(se))throw"not encap";return{bitstr:{obj:l(se)}}}catch{var de=null;return W.length<=10&&(de=Ig(W)),de==null?{bitstr:{hex:W}}:{bitstr:{bin:de}}}else if(N=="04")try{if(!d(W))throw"not encap";return{octstr:{obj:l(W)}}}catch{return{octstr:{hex:W}}}else{if(N=="05")return{null:""};if(N=="06"){var ue=O(W),pe=F(ue);return pe==""?{oid:ue}:{oid:pe}}else{if(N=="0a")return W.length>4?{enum:{hex:W}}:{enum:parseInt(W,16)};if(N=="30"||N=="31")return j[D[N]]=A(s),j;if(N=="14"){var G=P(W);return j[D[N]]={str:G},j}else if(N=="1e"){var G=L(W);return j[D[N]]={str:G},j}else if(":0c:12:13:16:17:18:1a:".indexOf(N)!=-1){var G=U(W);return j[D[N]]={str:G},j}else if(N.match(/^8[0-9]$/)){var G=U(W);return G==null|G==""?{tag:{tag:N,explicit:!1,hex:W}}:G.match(/[\x00-\x1F\x7F-\x9F]/)!=null||G.match(/[\u0000-\u001F\u0080–\u009F]/)!=null?{tag:{tag:N,explicit:!1,hex:W}}:{tag:{tag:N,explicit:!1,str:G}}}else if(N.match(/^a[0-9]$/))try{if(!d(W))throw new Error("not encap");return{tag:{tag:N,explicit:!0,obj:l(W)}}}catch{return{tag:{tag:N,explicit:!0,hex:W}}}else{var X=new y.asn1.ASN1Object;X.hV=W;var te=X.getLengthHexFromValue();return{asn1:{tlv:N+te+W}}}}}},Me.isContextTag=function(s,c){s=s.toLowerCase();var l,d;try{l=parseInt(s,16)}catch{return-1}if(c===void 0)return(l&192)==128;try{var v=c.match(/^\[[0-9]+\]$/);return v==null||(d=parseInt(c.substr(1,c.length-1),10),d>31)?!1:(l&192)==128&&(l&31)==d}catch{return!1}},Me.isASN1HEX=function(s){var c=Me;if(s.length%2==1)return!1;var l=c.getVblen(s,0),d=s.substr(0,2),v=c.getL(s,0),m=s.length-d.length-v.length;return m==l*2},Me.checkStrictDER=function(s,c,l,d,v){var m=Me;if(l===void 0){if(typeof s!="string")throw new Error("not hex string");if(s=s.toLowerCase(),!y.lang.String.isHex(s))throw new Error("not hex string");l=s.length,d=s.length/2,d<128?v=1:v=Math.ceil(d.toString(16))+1}var T=m.getL(s,c);if(T.length>v*2)throw new Error("L of TLV too long: idx="+c);var k=m.getVblen(s,c);if(k>d)throw new Error("value of L too long than hex: idx="+c);var O=m.getTLV(s,c),F=O.length-2-m.getL(s,c).length;if(F!==k*2)throw new Error("V string length and L's value not the same:"+F+"/"+k*2);if(c===0&&s.length!=O.length)throw new Error("total length and TLV length unmatch:"+s.length+"!="+O.length);var U=s.substr(c,2);if(U==="02"){var L=m.getVidx(s,c);if(s.substr(L,2)=="00"&&s.charCodeAt(L+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(U,16)&32){for(var P=m.getVblen(s,c),D=0,A=m.getChildIdx(s,c),N=0;N<A.length;N++){var j=m.getTLV(s,A[N]);D+=j.length,m.checkStrictDER(s,A[N],l,d,v)}if(P*2!=D)throw new Error("sum of children's TLV length and L unmatch: "+P*2+"!="+D)}},Me.oidname=function(s){var c=y.asn1;y.lang.String.isHex(s)&&(s=c.ASN1Util.oidHexToInt(s));var l=c.x509.OID.oid2name(s);return l===""&&(l=s),l},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.x509>"u"||!y.asn1.x509)&&(y.asn1.x509={}),y.asn1.x509.Certificate=function(s){y.asn1.x509.Certificate.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERBitString,v=l.DERSequence,m=l.x509,T=m.TBSCertificate,k=m.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(O){this.params=O},this.sign=function(){var O=this.params,F=O.sigalg;O.sigalg.name!=null&&(F=O.sigalg.name);var U=O.tbsobj.tohex(),L=new y.crypto.Signature({alg:F});L.init(O.cakey),L.updateHex(U),O.sighex=L.sign()},this.getPEM=function(){return sr(this.tohex(),"CERTIFICATE")},this.tohex=function(){var O=this.params;if((O.tbsobj==null||O.tbsobj==null)&&(O.tbsobj=new T(O)),O.sighex==null&&O.cakey!=null&&this.sign(),O.sighex==null)throw new Error("sighex or cakey parameter not defined");var F=[];F.push(O.tbsobj),F.push(new k({name:O.sigalg})),F.push(new d({hex:"00"+O.sighex}));var U=new v({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&(this.params=s)},Re(y.asn1.x509.Certificate,y.asn1.ASN1Object),y.asn1.x509.TBSCertificate=function(s){y.asn1.x509.TBSCertificate.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509,v=l.DERTaggedObject,m=l.DERInteger,T=l.DERSequence,k=d.AlgorithmIdentifier,O=d.Time,F=d.X500Name,U=d.Extensions,L=d.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(P){this.params=P},this.tohex=function(){var P=[],D=this.params;if(D.version!=null||D.version!=1){var A=2;D.version!=null&&(A=D.version-1);var N=new v({obj:new m({int:A})});P.push(N)}P.push(new m(D.serial)),P.push(new k({name:D.sigalg})),P.push(new F(D.issuer)),P.push(new T({array:[new O(D.notbefore),new O(D.notafter)]})),P.push(new F(D.subject)),P.push(new L(It.getKey(D.sbjpubkey))),D.ext!==void 0&&D.ext.length>0&&P.push(new v({tag:"a3",obj:new U(D.ext)}));var j=new y.asn1.DERSequence({array:P});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.TBSCertificate,y.asn1.ASN1Object),y.asn1.x509.Extensions=function(s){y.asn1.x509.Extensions.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERSequence,v=l.x509;this.aParam=[],this.setByParam=function(m){this.aParam=m},this.tohex=function(){for(var m=[],T=0;T<this.aParam.length;T++){var k=this.aParam[T],O=k.extname,F=null;if(k.extn!=null)F=new v.PrivateExtension(k);else if(O=="subjectKeyIdentifier")F=new v.SubjectKeyIdentifier(k);else if(O=="keyUsage")F=new v.KeyUsage(k);else if(O=="subjectAltName")F=new v.SubjectAltName(k);else if(O=="issuerAltName")F=new v.IssuerAltName(k);else if(O=="basicConstraints")F=new v.BasicConstraints(k);else if(O=="nameConstraints")F=new v.NameConstraints(k);else if(O=="cRLDistributionPoints")F=new v.CRLDistributionPoints(k);else if(O=="certificatePolicies")F=new v.CertificatePolicies(k);else if(O=="policyMappings")F=new v.PolicyMappings(k);else if(O=="policyConstraints")F=new v.PolicyConstraints(k);else if(O=="inhibitAnyPolicy")F=new v.InhibitAnyPolicy(k);else if(O=="authorityKeyIdentifier")F=new v.AuthorityKeyIdentifier(k);else if(O=="extKeyUsage")F=new v.ExtKeyUsage(k);else if(O=="authorityInfoAccess")F=new v.AuthorityInfoAccess(k);else if(O=="cRLNumber")F=new v.CRLNumber(k);else if(O=="cRLReason")F=new v.CRLReason(k);else if(O=="ocspNonce")F=new v.OCSPNonce(k);else if(O=="ocspNoCheck")F=new v.OCSPNoCheck(k);else if(O=="adobeTimeStamp")F=new v.AdobeTimeStamp(k);else if(O=="subjectDirectoryAttributes")F=new v.SubjectDirectoryAttributes(k);else throw new Error("extension not supported:"+JSON.stringify(k));F!=null&&m.push(F)}var U=new d({array:m});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.x509.Extensions,y.asn1.ASN1Object),y.asn1.x509.Extension=function(s){y.asn1.x509.Extension.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERObjectIdentifier,v=l.DEROctetString;l.DERBitString;var m=l.DERBoolean,T=l.DERSequence;this.tohex=function(){var k=new d({oid:this.oid}),O=new v({hex:this.getExtnValueHex()}),F=new Array;F.push(k),this.critical&&F.push(new m),F.push(O);var U=new T({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,s!==void 0&&s.critical!==void 0&&(this.critical=s.critical)},Re(y.asn1.x509.Extension,y.asn1.ASN1Object),y.asn1.x509.KeyUsage=function(s){y.asn1.x509.KeyUsage.superclass.constructor.call(this,s);var c=Error,l={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var d=this.getBinValue();return this.asn1ExtnValue=new y.asn1.DERBitString({bin:d}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var d=this.params;if(typeof d!="object"||typeof d.names!="object"&&typeof d.bin!="string")throw new c("parameter not yet set");if(d.names!=null)return Ql(d.names,l);if(d.bin!=null)return d.bin;throw new c("parameter not set properly")},this.oid="2.5.29.15",s!==void 0&&(this.params=s)},Re(y.asn1.x509.KeyUsage,y.asn1.x509.Extension),y.asn1.x509.BasicConstraints=function(s){y.asn1.x509.BasicConstraints.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERBoolean,d=c.DERInteger,v=c.DERSequence;this.getExtnValueHex=function(){var m=new Array;this.cA&&m.push(new l),this.pathLen>-1&&m.push(new d({int:this.pathLen}));var T=new v({array:m});return this.asn1ExtnValue=T,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,s!==void 0&&(s.cA!==void 0&&(this.cA=s.cA),s.pathLen!==void 0&&(this.pathLen=s.pathLen))},Re(y.asn1.x509.BasicConstraints,y.asn1.x509.Extension),y.asn1.x509.CRLDistributionPoints=function(s){y.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(v){for(var m=[],T=0;T<v.length;T++)if(v[T]instanceof y.asn1.ASN1Object)m.push(v[T]);else{var k=new d.DistributionPoint(v[T]);m.push(k)}this.asn1ExtnValue=new l.DERSequence({array:m})},this.setByOneURI=function(v){var m=new d.DistributionPoint({fulluri:v});this.setByDPArray([m])},this.oid="2.5.29.31",s!==void 0&&(s.array!==void 0?this.setByDPArray(s.array):s.uri!==void 0&&this.setByOneURI(s.uri))},Re(y.asn1.x509.CRLDistributionPoints,y.asn1.x509.Extension),y.asn1.x509.DistributionPoint=function(s){y.asn1.x509.DistributionPoint.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509.DistributionPointName;this.tohex=function(){var v=new l.DERSequence;if(this.asn1DP!=null){var m=new l.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});v.appendASN1Object(m)}return this.hTLV=v.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.dpobj!==void 0?this.asn1DP=s.dpobj:s.dpname!==void 0?this.asn1DP=new d(s.dpname):s.fulluri!==void 0&&(this.asn1DP=new d({full:[{uri:s.fulluri}]})))},Re(y.asn1.x509.DistributionPoint,y.asn1.ASN1Object),y.asn1.x509.DistributionPointName=function(s){y.asn1.x509.DistributionPointName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new d({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0)if(l.x509.GeneralNames.prototype.isPrototypeOf(s))this.type="full",this.tag="a0",this.asn1V=s;else if(s.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new l.x509.GeneralNames(s.full);else throw new Error("This class supports GeneralNames only as argument")},Re(y.asn1.x509.DistributionPointName,y.asn1.ASN1Object),y.asn1.x509.CertificatePolicies=function(s){y.asn1.x509.CertificatePolicies.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509,v=l.DERSequence,m=d.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var T=[],k=0;k<this.params.array.length;k++)T.push(new m(this.params.array[k]));var O=new v({array:T});return this.asn1ExtnValue=O,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",s!==void 0&&(this.params=s)},Re(y.asn1.x509.CertificatePolicies,y.asn1.x509.Extension),y.asn1.x509.PolicyInformation=function(s){y.asn1.x509.PolicyInformation.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.DERObjectIdentifier,v=c.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var m=[new d(this.params.policyoid)];if(this.params.array!==void 0){for(var T=[],k=0;k<this.params.array.length;k++)T.push(new v(this.params.array[k]));T.length>0&&m.push(new l({array:T}))}var O=new l({array:m});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Re(y.asn1.x509.PolicyInformation,y.asn1.ASN1Object),y.asn1.x509.PolicyQualifierInfo=function(s){y.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.DERIA5String,v=c.DERObjectIdentifier,m=c.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var T=new l({array:[new v({oid:"1.3.6.1.5.5.7.2.1"}),new d({str:this.params.cps})]});return T.tohex()}if(this.params.unotice!=null){var T=new l({array:[new v({oid:"1.3.6.1.5.5.7.2.2"}),new m(this.params.unotice)]});return T.tohex()}},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Re(y.asn1.x509.PolicyQualifierInfo,y.asn1.ASN1Object),y.asn1.x509.UserNotice=function(s){y.asn1.x509.UserNotice.superclass.constructor.call(this,s);var c=y.asn1.DERSequence;y.asn1.DERInteger;var l=y.asn1.x509.DisplayText,d=y.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var v=[];this.params.noticeref!==void 0&&v.push(new d(this.params.noticeref)),this.params.exptext!==void 0&&v.push(new l(this.params.exptext));var m=new c({array:v});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Re(y.asn1.x509.UserNotice,y.asn1.ASN1Object),y.asn1.x509.NoticeReference=function(s){y.asn1.x509.NoticeReference.superclass.constructor.call(this,s);var c=y.asn1.DERSequence,l=y.asn1.DERInteger,d=y.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var v=[];if(this.params.org!==void 0&&v.push(new d(this.params.org)),this.params.noticenum!==void 0){for(var m=[],T=this.params.noticenum,k=0;k<T.length;k++)m.push(new l(T[k]));v.push(new c({array:m}))}if(v.length==0)throw new Error("parameter is empty");var O=new c({array:v});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Re(y.asn1.x509.NoticeReference,y.asn1.ASN1Object),y.asn1.x509.DisplayText=function(s){y.asn1.x509.DisplayText.superclass.constructor.call(this,s),this.hT="0c",s!==void 0&&(s.type==="ia5"?this.hT="16":s.type==="vis"?this.hT="1a":s.type==="bmp"&&(this.hT="1e"))},Re(y.asn1.x509.DisplayText,y.asn1.DERAbstractString),y.asn1.x509.PolicyMappings=function(s){y.asn1.x509.PolicyMappings.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var v=this.params,m=[],T=0;T<v.array.length;T++){var k=v.array[T];m.push({seq:[{oid:k[0]},{oid:k[1]}]})}return this.asn1ExtnValue=d({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",s!==void 0&&(this.params=s)},Re(y.asn1.x509.PolicyMappings,y.asn1.x509.Extension),y.asn1.x509.PolicyConstraints=function(s){y.asn1.x509.PolicyConstraints.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var v=this.params,m=[];return v.reqexp!=null&&m.push({tag:{tagi:"80",obj:{int:v.reqexp}}}),v.inhibit!=null&&m.push({tag:{tagi:"81",obj:{int:v.inhibit}}}),this.asn1ExtnValue=d({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",s!==void 0&&(this.params=s)},Re(y.asn1.x509.PolicyConstraints,y.asn1.x509.Extension),y.asn1.x509.InhibitAnyPolicy=function(s){y.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=d({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",s!==void 0&&(this.params=s)},Re(y.asn1.x509.InhibitAnyPolicy,y.asn1.x509.Extension),y.asn1.x509.NameConstraints=function(s){y.asn1.x509.NameConstraints.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509,v=l.ASN1Util.newObject,m=d.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var T=this.params,k=[];if(T.permit!=null&&T.permit.length!=null){for(var O=[],F=0;F<T.permit.length;F++)O.push(new m(T.permit[F]));k.push({tag:{tagi:"a0",obj:{seq:O}}})}if(T.exclude!=null&&T.exclude.length!=null){for(var U=[],F=0;F<T.exclude.length;F++)U.push(new m(T.exclude[F]));k.push({tag:{tagi:"a1",obj:{seq:U}}})}return this.asn1ExtnValue=v({seq:k}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",s!==void 0&&(this.params=s)},Re(y.asn1.x509.NameConstraints,y.asn1.x509.Extension),y.asn1.x509.GeneralSubtree=function(s){y.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var c=y.asn1,l=c.x509,d=l.GeneralName,v=c.ASN1Util.newObject;this.params=null,this.setByParam=function(m){this.params=m},this.tohex=function(){var m=this.params,T=[new d(m)];m.min!=null&&T.push({tag:{tagi:"80",obj:{int:m.min}}}),m.max!=null&&T.push({tag:{tagi:"81",obj:{int:m.max}}});var k=v({seq:T});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.GeneralSubtree,y.asn1.ASN1Object),y.asn1.x509.ExtKeyUsage=function(s){y.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,s);var c=y,l=c.asn1;this.setPurposeArray=function(d){this.asn1ExtnValue=new l.DERSequence;for(var v=0;v<d.length;v++){var m=new l.DERObjectIdentifier(d[v]);this.asn1ExtnValue.appendASN1Object(m)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",s!==void 0&&s.array!==void 0&&this.setPurposeArray(s.array)},Re(y.asn1.x509.ExtKeyUsage,y.asn1.x509.Extension),y.asn1.x509.AuthorityKeyIdentifier=function(s){y.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DERTaggedObject,v=l.x509.GeneralNames;c.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var m=new Array;this.asn1KID&&m.push(new d({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&m.push(new d({explicit:!1,tag:"a1",obj:new v([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&m.push(new d({explicit:!1,tag:"82",obj:this.asn1CertSN}));var T=new l.DERSequence({array:m});return this.asn1ExtnValue=T,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(m){if(m.str!==void 0||m.hex!==void 0)this.asn1KID=new y.asn1.DEROctetString(m);else if(typeof m=="object"&&y.crypto.Util.isKey(m)||typeof m=="string"&&m.indexOf("BEGIN ")!=-1){var T=m;typeof m=="string"&&(T=It.getKey(m));var k=It.getKeyID(T);this.asn1KID=new y.asn1.DEROctetString({hex:k})}},this.setCertIssuerByParam=function(m){m.str!==void 0||m.ldapstr!==void 0||m.hex!==void 0||m.certsubject!==void 0||m.certissuer!==void 0?this.asn1CertIssuer=new y.asn1.x509.X500Name(m):typeof m=="string"&&m.indexOf("BEGIN ")!=-1&&m.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new y.asn1.x509.X500Name({certissuer:m}))},this.setCertSNByParam=function(m){if(m.str!==void 0||m.bigint!==void 0||m.hex!==void 0)this.asn1CertSN=new y.asn1.DERInteger(m);else if(typeof m=="string"&&m.indexOf("BEGIN ")!=-1&&m.indexOf("CERTIFICATE")){var T=new st;T.readCertPEM(m);var k=T.getSerialNumberHex();this.asn1CertSN=new y.asn1.DERInteger({hex:k})}},this.oid="2.5.29.35",s!==void 0&&(s.kid!==void 0&&this.setKIDByParam(s.kid),s.issuer!==void 0&&this.setCertIssuerByParam(s.issuer),s.sn!==void 0&&this.setCertSNByParam(s.sn),s.issuersn!==void 0&&typeof s.issuersn=="string"&&s.issuersn.indexOf("BEGIN ")!=-1&&s.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(s.issuersn),this.setCertIssuerByParam(s.issuersn)))},Re(y.asn1.x509.AuthorityKeyIdentifier,y.asn1.x509.Extension),y.asn1.x509.SubjectKeyIdentifier=function(s){y.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(v){if(v.str!==void 0||v.hex!==void 0)this.asn1KID=new d(v);else if(typeof v=="object"&&y.crypto.Util.isKey(v)||typeof v=="string"&&v.indexOf("BEGIN")!=-1){var m=v;typeof v=="string"&&(m=It.getKey(v));var T=It.getKeyID(m);this.asn1KID=new y.asn1.DEROctetString({hex:T})}},this.oid="2.5.29.14",s!==void 0&&s.kid!==void 0&&this.setKIDByParam(s.kid)},Re(y.asn1.x509.SubjectKeyIdentifier,y.asn1.x509.Extension),y.asn1.x509.AuthorityInfoAccess=function(s){y.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,s),this.setAccessDescriptionArray=function(c){for(var l=new Array,d=y,v=d.asn1,m=v.DERSequence,T=v.DERObjectIdentifier,k=v.x509.GeneralName,O=0;O<c.length;O++){var F,U=c[O];if(U.ocsp!==void 0)F=new m({array:[new T({oid:"1.3.6.1.5.5.7.48.1"}),new k({uri:U.ocsp})]});else if(U.caissuer!==void 0)F=new m({array:[new T({oid:"1.3.6.1.5.5.7.48.2"}),new k({uri:U.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(U));l.push(F)}this.asn1ExtnValue=new m({array:l})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",s!==void 0&&s.array!==void 0&&this.setAccessDescriptionArray(s.array)},Re(y.asn1.x509.AuthorityInfoAccess,y.asn1.x509.Extension),y.asn1.x509.SubjectAltName=function(s){y.asn1.x509.SubjectAltName.superclass.constructor.call(this,s),this.setNameArray=function(c){this.asn1ExtnValue=new y.asn1.x509.GeneralNames(c)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",s!==void 0&&s.array!==void 0&&this.setNameArray(s.array)},Re(y.asn1.x509.SubjectAltName,y.asn1.x509.Extension),y.asn1.x509.IssuerAltName=function(s){y.asn1.x509.IssuerAltName.superclass.constructor.call(this,s),this.setNameArray=function(c){this.asn1ExtnValue=new y.asn1.x509.GeneralNames(c)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",s!==void 0&&s.array!==void 0&&this.setNameArray(s.array)},Re(y.asn1.x509.IssuerAltName,y.asn1.x509.Extension),y.asn1.x509.SubjectDirectoryAttributes=function(s){y.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.ASN1Util.newObject,v=c.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var m=[],T=0;T<this.params.array.length;T++){var k=this.params.array[T];if(k.attr!=null&&k.array!=null){var O={seq:[{oid:k.attr},{set:k.array}]};m.push(d(O));continue}var F={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(k.attr=="dateOfBirth")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={gentime:k.str};else if(k.attr=="placeOfBirth")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={utf8str:k.str};else if(k.attr=="gender")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={prnstr:k.str};else if(k.attr=="countryOfCitizenship")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={prnstr:k.str};else if(k.attr=="countryOfResidence")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={prnstr:k.str};else throw new Error("unsupported attribute: "+k.attr);m.push(new d(F))}var U=new l({array:m});return this.asn1ExtnValue=U,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",s!==void 0&&(this.params=s)},Re(y.asn1.x509.SubjectDirectoryAttributes,y.asn1.x509.Extension),y.asn1.x509.PrivateExtension=function(s){y.asn1.x509.PrivateExtension.superclass.constructor.call(this,s);var c=y,l=c.lang.String.isHex,d=c.asn1,v=d.x509.OID.name2oid,m=d.ASN1Util.newObject;this.params=null,this.setByParam=function(T){this.oid=v(T.extname),this.params=T},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var T=this.params.extn;if(typeof T=="string"&&l(T))return T;if(typeof T=="object")try{return m(T).tohex()}catch{}throw new Error("unsupported extn value")},s!=null&&this.setByParam(s)},Re(y.asn1.x509.PrivateExtension,y.asn1.x509.Extension),y.asn1.x509.CRL=function(s){y.asn1.x509.CRL.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERSequence,v=l.DERBitString,m=l.x509,T=m.AlgorithmIdentifier,k=m.TBSCertList;this.params=void 0,this.setByParam=function(O){this.params=O},this.sign=function(){var O=new k(this.params).tohex(),F=new y.crypto.Signature({alg:this.params.sigalg});F.init(this.params.cakey),F.updateHex(O);var U=F.sign();this.params.sighex=U},this.getPEM=function(){return sr(this.tohex(),"X509 CRL")},this.tohex=function(){var O=this.params;if(O.tbsobj==null&&(O.tbsobj=new k(O)),O.sighex==null&&O.cakey!=null&&this.sign(),O.sighex==null)throw new Error("sighex or cakey parameter not defined");var F=[];F.push(O.tbsobj),F.push(new T({name:O.sigalg})),F.push(new v({hex:"00"+O.sighex}));var U=new d({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&(this.params=s)},Re(y.asn1.x509.CRL,y.asn1.ASN1Object),y.asn1.x509.TBSCertList=function(s){y.asn1.x509.TBSCertList.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERInteger,v=l.DERSequence,m=l.DERTaggedObject;l.DERObjectIdentifier;var T=l.x509,k=T.AlgorithmIdentifier,O=T.Time,F=T.Extensions,U=T.X500Name;this.params=null,this.setByParam=function(L){this.params=L},this.getRevCertSequence=function(){for(var L=[],P=this.params.revcert,D=0;D<P.length;D++){var A=[new d(P[D].sn),new O(P[D].date)];P[D].ext!=null&&A.push(new F(P[D].ext)),L.push(new v({array:A}))}return new v({array:L})},this.tohex=function(){var L=[],P=this.params;if(P.version!=null){var D=P.version-1,A=new d({int:D});L.push(A)}if(L.push(new k({name:P.sigalg})),L.push(new U(P.issuer)),L.push(new O(P.thisupdate)),P.nextupdate!=null&&L.push(new O(P.nextupdate)),P.revcert!=null&&L.push(this.getRevCertSequence()),P.ext!=null){var N=new F(P.ext);L.push(new m({tag:"a0",explicit:!0,obj:N}))}var j=new v({array:L});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.TBSCertList,y.asn1.ASN1Object),y.asn1.x509.CRLEntry=function(s){y.asn1.x509.CRLEntry.superclass.constructor.call(this);var c=y,l=c.asn1;this.setCertSerial=function(d){this.sn=new l.DERInteger(d)},this.setRevocationDate=function(d){this.time=new l.x509.Time(d)},this.tohex=function(){var d=new l.DERSequence({array:[this.sn,this.time]});return this.TLV=d.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.time!==void 0&&this.setRevocationDate(s.time),s.sn!==void 0&&this.setCertSerial(s.sn))},Re(y.asn1.x509.CRLEntry,y.asn1.ASN1Object),y.asn1.x509.CRLNumber=function(s){y.asn1.x509.CRLNumber.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",s!=null&&(this.params=s)},Re(y.asn1.x509.CRLNumber,y.asn1.x509.Extension),y.asn1.x509.CRLReason=function(s){y.asn1.x509.CRLReason.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",s!=null&&(this.params=s)},Re(y.asn1.x509.CRLReason,y.asn1.x509.Extension),y.asn1.x509.OCSPNonce=function(s){y.asn1.x509.OCSPNonce.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",s!=null&&(this.params=s)},Re(y.asn1.x509.OCSPNonce,y.asn1.x509.Extension),y.asn1.x509.OCSPNoCheck=function(s){y.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",s!=null&&(this.params=s)},Re(y.asn1.x509.OCSPNoCheck,y.asn1.x509.Extension),y.asn1.x509.AdobeTimeStamp=function(s){y.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DERInteger,v=l.DERBoolean,m=l.DERSequence,T=l.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var k=this.params,O=[new d(1)];return O.push(new T({uri:k.uri})),k.reqauth!=null&&O.push(new v(k.reqauth)),this.asn1ExtnValue=new m({array:O}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.AdobeTimeStamp,y.asn1.x509.Extension),y.asn1.x509.X500Name=function(s){y.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var c=y,l=c.asn1,d=l.x509,v=d.RDN;this.setByString=function(m,T){T!==void 0&&(this.sRule=T);var k=m.split("/");k.shift();for(var O=[],F=0;F<k.length;F++)if(k[F].match(/^[^=]+=.+$/))O.push(k[F]);else{var U=O.length-1;O[U]=O[U]+"/"+k[F]}for(var F=0;F<O.length;F++)this.asn1Array.push(new v({str:O[F],rule:this.sRule}))},this.setByLdapString=function(m,T){T!==void 0&&(this.sRule=T);var k=d.X500Name.ldapToCompat(m);this.setByString(k,T)},this.setByObject=function(m,T){T!==void 0&&(this.sRule=T);for(var k in m)if(m.hasOwnProperty(k)){var O=new v({str:k+"="+m[k],rule:this.sRule});this.asn1Array?this.asn1Array.push(O):this.asn1Array=[O]}},this.setByParam=function(m){if(m.rule!==void 0&&(this.sRule=m.rule),m.array!==void 0)this.paramArray=m.array;else if(m.str!==void 0)this.setByString(m.str);else if(m.ldapstr!==void 0)this.setByLdapString(m.ldapstr);else if(m.hex!==void 0)this.hTLV=m.hex;else if(m.certissuer!==void 0){var T=new st;T.readCertPEM(m.certissuer),this.hTLV=T.getIssuerHex()}else if(m.certsubject!==void 0){var T=new st;T.readCertPEM(m.certsubject),this.hTLV=T.getSubjectHex()}else typeof m=="object"&&m.certsubject===void 0&&m.certissuer===void 0&&this.setByObject(m)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var m=0;m<this.paramArray.length;m++){var T={array:this.paramArray[m]};this.sRule!="utf8"&&(T.rule=this.sRule);var k=new v(T);this.asn1Array.push(k)}var O=new l.DERSequence({array:this.asn1Array});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.X500Name,y.asn1.ASN1Object),y.asn1.x509.X500Name.compatToLDAP=function(s){if(s.substr(0,1)!=="/")throw"malformed input";s=s.substr(1);var c=s.split("/");return c.reverse(),c=c.map(function(l){return l.replace(/,/,"\\,")}),c.join(",")},y.asn1.x509.X500Name.onelineToLDAP=function(s){return y.asn1.x509.X500Name.compatToLDAP(s)},y.asn1.x509.X500Name.ldapToCompat=function(s){for(var c=s.split(","),l=!1,d=[],v=0;c.length>0;v++){var m=c.shift();if(l===!0){var T=d.pop(),k=(T+","+m).replace(/\\,/g,",");d.push(k),l=!1}else d.push(m);m.substr(-1,1)==="\\"&&(l=!0)}return d=d.map(function(O){return O.replace("/","\\/")}),d.reverse(),"/"+d.join("/")},y.asn1.x509.X500Name.ldapToOneline=function(s){return y.asn1.x509.X500Name.ldapToCompat(s)},y.asn1.x509.RDN=function(s){y.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var c=y.asn1.x509.AttributeTypeAndValue;this.setByParam=function(l){l.rule!==void 0&&(this.sRule=l.rule),l.str!==void 0&&this.addByMultiValuedString(l.str),l.array!==void 0&&(this.paramArray=l.array)},this.addByString=function(l){this.asn1Array.push(new y.asn1.x509.AttributeTypeAndValue({str:l,rule:this.sRule}))},this.addByMultiValuedString=function(l){for(var d=y.asn1.x509.RDN.parseString(l),v=0;v<d.length;v++)this.addByString(d[v])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var l=0;l<this.paramArray.length;l++){var d=this.paramArray[l];d.rule!==void 0&&this.sRule!="utf8"&&(d.rule=this.sRule);var v=new c(d);this.asn1Array.push(v)}var m=new y.asn1.DERSet({array:this.asn1Array});return this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.RDN,y.asn1.ASN1Object),y.asn1.x509.RDN.parseString=function(s){for(var c=s.split(/\+/),l=!1,d=[],v=0;c.length>0;v++){var m=c.shift();if(l===!0){var T=d.pop(),k=(T+"+"+m).replace(/\\\+/g,"+");d.push(k),l=!1}else d.push(m);m.substr(-1,1)==="\\"&&(l=!0)}for(var O=!1,F=[],v=0;d.length>0;v++){var m=d.shift();if(O===!0){var U=F.pop();if(m.match(/"$/)){var k=(U+"+"+m).replace(/^([^=]+)="(.*)"$/,"$1=$2");F.push(k),O=!1}else F.push(U+"+"+m)}else F.push(m);m.match(/^[^=]+="/)&&(O=!0)}return F},y.asn1.x509.AttributeTypeAndValue=function(s){y.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var c=y,l=c.asn1,d=l.DERSequence,v=l.DERUTF8String,m=l.DERPrintableString,T=l.DERTeletexString,k=l.DERIA5String,O=l.DERVisibleString,F=l.DERBMPString,U=c.lang.String.isMail,L=c.lang.String.isPrintable;this.setByParam=function(P){if(P.rule!==void 0&&(this.sRule=P.rule),P.ds!==void 0&&(this.dsType=P.ds),P.value===void 0&&P.str!==void 0){var D=P.str,A=D.match(/^([^=]+)=(.+)$/);if(A)this.sType=A[1],this.sValue=A[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=P.type,this.sValue=P.value},this.setByString=function(P,D){D!==void 0&&(this.sRule=D);var A=P.match(/^([^=]+)=(.+)$/);if(A)this.setByAttrTypeAndValueStr(A[1],A[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var P=this.sType,D=this.sValue,A=this.sRule;return A==="prn"?P=="CN"&&U(D)?"ia5":L(D)?"prn":"utf8":A==="utf8"?P=="CN"&&U(D)?"ia5":P=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(P,D,A){A!==void 0&&(this.sRule=A),this.sType=P,this.sValue=D},this.getValueObj=function(P,D){if(P=="utf8")return new v({str:D});if(P=="prn")return new m({str:D});if(P=="tel")return new T({str:D});if(P=="ia5")return new k({str:D});if(P=="vis")return new O({str:D});if(P=="bmp")return new F({str:D});throw new Error("unsupported directory string type: type="+P+" value="+D)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var P=y.asn1.x509.OID.atype2obj(this.sType),D=this.getValueObj(this.dsType,this.sValue),A=new d({array:[P,D]});return this.TLV=A.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.AttributeTypeAndValue,y.asn1.ASN1Object),y.asn1.x509.SubjectPublicKeyInfo=function(s){y.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERInteger,v=l.DERBitString,m=l.DERObjectIdentifier,T=l.DERSequence,k=l.ASN1Util.newObject,O=l.x509,F=O.AlgorithmIdentifier,U=c.crypto;U.ECDSA,U.DSA,this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var L=new T({array:[this.asn1AlgId,this.asn1SubjPKey]});return L},this.tohex=function(){var L=this.getASN1Object();return this.hTLV=L.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(L){try{if(L instanceof we){var P=k({seq:[{int:{bigint:L.n}},{int:{int:L.e}}]}),D=P.tohex();this.asn1AlgId=new F({name:"rsaEncryption"}),this.asn1SubjPKey=new v({hex:"00"+D})}}catch{}try{if(L instanceof y.crypto.ECDSA){var A=new m({name:L.curveName});this.asn1AlgId=new F({name:"ecPublicKey",asn1params:A}),this.asn1SubjPKey=new v({hex:"00"+L.pubKeyHex})}}catch{}try{if(L instanceof y.crypto.DSA){var A=new k({seq:[{int:{bigint:L.p}},{int:{bigint:L.q}},{int:{bigint:L.g}}]});this.asn1AlgId=new F({name:"dsa",asn1params:A});var N=new d({bigint:L.y});this.asn1SubjPKey=new v({hex:"00"+N.tohex()})}}catch{}},s!==void 0&&this.setPubKey(s)},Re(y.asn1.x509.SubjectPublicKeyInfo,y.asn1.ASN1Object),y.asn1.x509.Time=function(s){y.asn1.x509.Time.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERUTCTime,v=l.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(m){this.timeParams=m},this.setByParam=function(m){this.params=m},this.getType=function(m){return m.match(/^[0-9]{12}Z$/)?"utc":m.match(/^[0-9]{14}Z$/)?"gen":m.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":m.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var m=this.params,T=null;if(typeof m=="string"&&(m={str:m}),m!=null&&m.str&&(m.type==null||m.type==null)&&(m.type=this.getType(m.str)),m!=null&&m.str?(m.type=="utc"&&(T=new d(m.str)),m.type=="gen"&&(T=new v(m.str))):this.type=="gen"?T=new v:T=new d,T==null)throw new Error("wrong setting for Time");return this.TLV=T.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},y.asn1.x509.Time_bak=function(s){y.asn1.x509.Time_bak.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERUTCTime,v=l.DERGeneralizedTime;this.setTimeParams=function(m){this.timeParams=m},this.tohex=function(){var m=null;return this.timeParams!=null?this.type=="utc"?m=new d(this.timeParams):m=new v(this.timeParams):this.type=="utc"?m=new d:m=new v,this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",s!==void 0&&(s.type!==void 0?this.type=s.type:s.str!==void 0&&(s.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),s.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=s)},Re(y.asn1.x509.Time,y.asn1.ASN1Object),y.asn1.x509.AlgorithmIdentifier=function(s){y.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var c=y,l=c.asn1,d=l.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var m=null;for(var T in d)T===this.nameAlg&&(m=d[T]);if(m!==null)return this.hTLV=m,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=l.x509.OID.name2obj(this.nameAlg));var k=[this.asn1Alg];this.asn1Params!==null&&k.push(this.asn1Params);var O=new l.DERSequence({array:k});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.name!==void 0&&(this.nameAlg=s.name),s.asn1params!==void 0&&(this.asn1Params=s.asn1params),s.paramempty!==void 0&&(this.paramEmpty=s.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var v=this.nameAlg.toLowerCase();v.substr(-7,7)!=="withdsa"&&v.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new l.DERNull)}},Re(y.asn1.x509.AlgorithmIdentifier,y.asn1.ASN1Object),y.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},y.asn1.x509.GeneralName=function(s){y.asn1.x509.GeneralName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509,v=d.X500Name,m=d.OtherName,T=l.DERIA5String;l.DERPrintableString;var k=l.DEROctetString,O=l.DERTaggedObject,F=l.ASN1Object,U=Error;this.params=null,this.setByParam=function(L){this.params=L},this.tohex=function(){var L=this.params,P,A,D,A=!1;if(L.other!==void 0)P="a0",D=new m(L.other);else if(L.rfc822!==void 0)P="81",D=new T({str:L.rfc822});else if(L.dns!==void 0)P="82",D=new T({str:L.dns});else if(L.dn!==void 0)P="a4",A=!0,typeof L.dn=="string"?D=new v({str:L.dn}):L.dn instanceof y.asn1.x509.X500Name?D=L.dn:D=new v(L.dn);else if(L.ldapdn!==void 0)P="a4",A=!0,D=new v({ldapstr:L.ldapdn});else if(L.certissuer!==void 0||L.certsubj!==void 0){P="a4",A=!0;var N,j,W=null;if(L.certsubj!==void 0?(N=!1,j=L.certsubj):(N=!0,j=L.certissuer),j.match(/^[0-9A-Fa-f]+$/),j.indexOf("-----BEGIN ")!=-1&&(W=Cn(j)),W==null)throw new Error("certsubj/certissuer not cert");var se=new st;se.hex=W;var de;N?de=se.getIssuerHex():de=se.getSubjectHex(),D=new F,D.hTLV=de}else if(L.uri!==void 0)P="86",D=new T({str:L.uri});else if(L.ip!==void 0){P="87";var ue,pe=L.ip;try{if(pe.match(/^[0-9a-f]+$/)){var G=pe.length;if(G==8||G==16||G==32||G==64)ue=pe;else throw"err"}else ue=Kh(pe)}catch(te){throw new U("malformed IP address: "+L.ip+":"+te.message)}D=new k({hex:ue})}else throw new U("improper params");var X=new O({tag:P,explicit:A,obj:D});return X.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.GeneralName,y.asn1.ASN1Object),y.asn1.x509.GeneralNames=function(s){y.asn1.x509.GeneralNames.superclass.constructor.call(this);var c=y,l=c.asn1;this.setByParamArray=function(d){for(var v=0;v<d.length;v++){var m=new l.x509.GeneralName(d[v]);this.asn1Array.push(m)}},this.tohex=function(){var d=new l.DERSequence({array:this.asn1Array});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof s<"u"&&this.setByParamArray(s)},Re(y.asn1.x509.GeneralNames,y.asn1.ASN1Object),y.asn1.x509.OtherName=function(s){y.asn1.x509.OtherName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERObjectIdentifier,v=l.DERSequence,m=l.ASN1Util.newObject;this.params=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(T.oid==null||T.value==null)throw new Error("oid or value not specified");var k=new d({oid:T.oid}),O=m({tag:{tag:"a0",explicit:!0,obj:T.value}}),F=new v({array:[k,O]});return F.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.x509.OtherName,y.asn1.ASN1Object),y.asn1.x509.OID=new function(){var s=y.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(c){if(typeof this.objCache[c]<"u")return this.objCache[c];if(typeof this.name2oidList[c]>"u")throw"Name of ObjectIdentifier not defined: "+c;var l=this.name2oidList[c],d=new s({oid:l});return this.objCache[c]=d,d},this.atype2obj=function(c){if(this.objCache[c]!==void 0)return this.objCache[c];var l;if(c.match(/^\d+\.\d+\.[0-9.]+$/))l=c;else if(this.atype2oidList[c]!==void 0)l=this.atype2oidList[c];else if(this.name2oidList[c]!==void 0)l=this.name2oidList[c];else throw new Error("AttributeType name undefined: "+c);var d=new s({oid:l});return this.objCache[c]=d,d},this.registerOIDs=function(c){if(this.checkOIDs(c))for(var l in c)this.name2oidList[l]=c[l]},this.checkOIDs=function(c){try{var l=Object.keys(c);return l.length==0?!1:(l.map(function(d,v,m){var T=this[d];if(!T.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},c),!0)}catch{return!1}}},y.asn1.x509.OID.oid2name=function(s){var c=y.asn1.x509.OID.name2oidList;for(var l in c)if(c[l]==s)return l;return""},y.asn1.x509.OID.oid2atype=function(s){var c=y.asn1.x509.OID.atype2oidList;for(var l in c)if(c[l]==s)return l;return s},y.asn1.x509.OID.name2oid=function(s){if(s.match(/^[0-9.]+$/))return s;var c=y.asn1.x509.OID.name2oidList;return c[s]===void 0?"":c[s]},y.asn1.x509.X509Util={},y.asn1.x509.X509Util.newCertPEM=function(s){var c=y.asn1.x509;c.TBSCertificate;var l=c.Certificate,d=new l(s);return d.getPEM()},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.cms>"u"||!y.asn1.cms)&&(y.asn1.cms={}),y.asn1.cms.Attribute=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.DERSet,T=d.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(k){this.params=k},this.getValueArray=function(){throw new c("not yet implemented abstract")},this.tohex=function(){var k=new T({oid:this.typeOid}),O=new m({array:this.getValueArray()}),F=new v({array:[k,O]});return F.tohex()},this.getEncodedHex=function(){return this.tohex()}},Re(y.asn1.cms.Attribute,y.asn1.ASN1Object),y.asn1.cms.ContentType=function(s){var c=y,l=c.asn1;l.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var d=new l.DERObjectIdentifier(this.params.type);return[d]},s!=null&&this.setByParam(s)},Re(y.asn1.cms.ContentType,y.asn1.cms.Attribute),y.asn1.cms.MessageDigest=function(s){var c=y,l=c.asn1,d=l.DEROctetString,v=l.cms;v.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var m=new d(this.params);return[m]},s!=null&&this.setByParam(s)},Re(y.asn1.cms.MessageDigest,y.asn1.cms.Attribute),y.asn1.cms.SigningTime=function(s){var c=y,l=c.asn1;l.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var d=new l.x509.Time(this.params);return[d]},s!=null&&this.setByParam(s)},Re(y.asn1.cms.SigningTime,y.asn1.cms.Attribute),y.asn1.cms.SigningCertificate=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.cms,T=m.ESSCertID;l.crypto,m.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new c("parameter 'array' not specified");for(var k=this.params.array,O=[],F=0;F<k.length;F++){var U=k[F];s.hasis==!1&&typeof U=="string"&&(U.indexOf("-----BEGIN")!=-1||Me.isASN1HEX(U))&&(U={cert:U}),U.hasis!=!1&&s.hasis==!1&&(U.hasis=!1),O.push(new T(U))}var L=new v({array:O}),P=new v({array:[L]});return[P]},s!=null&&this.setByParam(s)},Re(y.asn1.cms.SigningCertificate,y.asn1.cms.Attribute),y.asn1.cms.ESSCertID=function(s){y.asn1.cms.ESSCertID.superclass.constructor.call(this);var c=Error,l=y,d=l.asn1,v=d.DEROctetString,m=d.DERSequence,T=d.cms.IssuerSerial;this.params=null,this.getCertHash=function(k,O){if(k.hash!=null)return k.hash;if(typeof k=="string"&&k.indexOf("-----BEGIN")==-1&&!Me.isASN1HEX(k))return k;var F;if(typeof k=="string")F=k;else if(k.cert!=null)F=k.cert;else throw new c("hash nor cert unspecified");var U;F.indexOf("-----BEGIN")!=-1?U=Cn(F):U=F,typeof k=="string"&&(k.indexOf("-----BEGIN")!=-1?U=Cn(k):Me.isASN1HEX(k)&&(U=k));var L;if(k.alg!=null)L=k.alg;else if(O!=null)L=O;else throw new c("hash alg unspecified");return l.crypto.Util.hashHex(U,L)},this.tohex=function(){var k=this.params,O=this.getCertHash(k,"sha1"),F=[];F.push(new v({hex:O})),(typeof k=="string"&&k.indexOf("-----BEGIN")!=-1||k.cert!=null&&k.hasis!=!1||k.issuer!=null&&k.serial!=null)&&F.push(new T(k));var U=new m({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.ESSCertID,y.asn1.ASN1Object),y.asn1.cms.SigningCertificateV2=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence;d.x509;var m=d.cms,T=m.ESSCertIDv2;l.crypto,m.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new c("parameter 'array' not specified");for(var k=this.params.array,O=[],F=0;F<k.length;F++){var U=k[F];(s.alg!=null||s.hasis==!1)&&typeof U=="string"&&(U.indexOf("-----BEGIN")!=-1||Me.isASN1HEX(U))&&(U={cert:U}),U.alg==null&&s.alg!=null&&(U.alg=s.alg),U.hasis!=!1&&s.hasis==!1&&(U.hasis=!1),O.push(new T(U))}var L=new v({array:O}),P=new v({array:[L]});return[P]},s!=null&&this.setByParam(s)},Re(y.asn1.cms.SigningCertificateV2,y.asn1.cms.Attribute),y.asn1.cms.ESSCertIDv2=function(s){y.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DEROctetString,v=l.DERSequence,m=l.cms.IssuerSerial,T=l.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var k=this.params,O=this.getCertHash(k,"sha256"),F=[];k.alg!=null&&k.alg!="sha256"&&F.push(new T({name:k.alg})),F.push(new d({hex:O})),(typeof k=="string"&&k.indexOf("-----BEGIN")!=-1||k.cert!=null&&k.hasis!=!1||k.issuer!=null&&k.serial!=null)&&F.push(new m(k));var U=new v({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.ESSCertIDv2,y.asn1.cms.ESSCertID),y.asn1.cms.IssuerSerial=function(s){var c=Error,l=y,d=l.asn1,v=d.DERInteger,m=d.DERSequence,T=d.cms,k=d.x509,O=k.GeneralNames,F=st;T.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(U){this.params=U},this.tohex=function(){var U=this.params,L,P;if(typeof U=="string"&&U.indexOf("-----BEGIN")!=-1||U.cert!=null){var D;U.cert!=null?D=U.cert:D=U;var A=new F;A.readCertPEM(D),L=A.getIssuer(),P={hex:A.getSerialNumberHex()}}else if(U.issuer!=null&&U.serial)L=U.issuer,P=U.serial;else throw new c("cert or issuer and serial parameter not specified");var N=new O([{dn:L}]),j=new v(P),W=new m({array:[N,j]});return W.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.IssuerSerial,y.asn1.ASN1Object),y.asn1.cms.SignerIdentifier=function(s){var c=y,l=c.asn1;l.DERInteger,l.DERSequence;var d=l.cms,v=d.IssuerAndSerialNumber,m=d.SubjectKeyIdentifier,T=l.x509;T.X500Name,d.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;if(k.type=="isssn"){var O=new v(k);return O.tohex()}else if(k.type=="skid"){var F=new m(k);return F.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.SignerIdentifier,y.asn1.ASN1Object),y.asn1.cms.IssuerAndSerialNumber=function(s){var c=y,l=c.asn1,d=l.DERInteger,v=l.DERSequence,m=l.cms,T=l.x509,k=T.X500Name,O=st,F=Error;m.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var U=this.params,L,P;if(typeof U=="string"&&U.indexOf("-----BEGIN")!=-1||U.cert!=null){var D;U.cert!=null?D=U.cert:D=U;var A=new O;A.readCertPEM(D),L=A.getIssuer(),P={hex:A.getSerialNumberHex()}}else if(U.issuer!=null&&U.serial)L=U.issuer,P=U.serial;else throw new F("cert or issuer and serial parameter not specified");var N=new k(L),j=new d(P),W=new v({array:[N,j]});return W.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(U){this.params=U},s!=null&&this.setByParam(s)},Re(y.asn1.cms.IssuerAndSerialNumber,y.asn1.ASN1Object),y.asn1.cms.SubjectKeyIdentifier=function(s){var c=y,l=c.asn1;l.DERInteger,l.DERSequence;var d=l.ASN1Util.newObject,v=l.cms;v.IssuerAndSerialName,v.SubjectKeyIdentifier;var m=l.x509;m.X500Name;var T=st,k=Error;v.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var O=this.params;if(O.cert==null&&O.skid==null)throw new k("property cert nor skid undefined");var F;if(O.cert!=null){var U=new T(O.cert),L=U.getExtSubjectKeyIdentifier();F=L.kid.hex}else O.skid!=null&&(F=O.skid);var P=d({tag:{tage:"a0",obj:{octstr:{hex:F}}}});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.SubjectKeyIdentifier,y.asn1.ASN1Object),y.asn1.cms.AttributeList=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSet,m=d.cms;m.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(this.hTLV!=null)return this.hTLV;var k=!0;T.sortflag!=null&&(k=T.sortflag);for(var O=T.array,F=[],U=0;U<O.length;U++){var L=O[U],P=L.attr;if(P=="contentType")F.push(new m.ContentType(L));else if(P=="messageDigest")F.push(new m.MessageDigest(L));else if(P=="signingTime")F.push(new m.SigningTime(L));else if(P=="signingCertificate")F.push(new m.SigningCertificate(L));else if(P=="signingCertificateV2")F.push(new m.SigningCertificateV2(L));else if(P=="signaturePolicyIdentifier")F.push(new y.asn1.cades.SignaturePolicyIdentifier(L));else if(P=="signatureTimeStamp"||P=="timeStampToken")F.push(new y.asn1.cades.SignatureTimeStamp(L));else throw new c("unknown attr: "+P)}var D=new v({array:F,sortflag:k});return this.hTLV=D.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.AttributeList,y.asn1.ASN1Object),y.asn1.cms.SignerInfo=function(s){var c=Error,l=y,d=l.asn1,v=d.DERInteger,m=d.DEROctetString,T=d.DERSequence,k=d.DERTaggedObject,O=d.cms,F=O.SignerIdentifier,U=O.AttributeList;O.ContentType,O.EncapsulatedContentInfo,O.MessageDigest,O.SignedData;var L=d.x509,P=L.AlgorithmIdentifier,D=l.crypto,A=It;O.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var N=this.params,j=N.sigalg,W=new U(N.sattrs).tohex(),se=A.getKey(N.signkey),de=new D.Signature({alg:j});de.init(se),de.updateHex(W);var ue=de.sign();N.sighex=ue},this.tohex=function(){var N=this.params,j=[];if(j.push(new v({int:N.version})),j.push(new F(N.id)),j.push(new P({name:N.hashalg})),N.sattrs!=null){var W=new U(N.sattrs);try{j.push(new k({tag:"a0",explicit:!1,obj:W}))}catch(de){throw new c("si sattr error: "+de)}}if(N.sigalgfield!=null?j.push(new P({name:N.sigalgfield})):j.push(new P({name:N.sigalg})),N.sighex==null&&N.signkey!=null&&this.sign(),j.push(new m({hex:N.sighex})),N.uattrs!=null){var W=new U(N.uattrs);try{j.push(new k({tag:"a1",explicit:!1,obj:W}))}catch(ue){throw new c("si uattr error: "+ue)}}var se=new T({array:j});return se.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.SignerInfo,y.asn1.ASN1Object),y.asn1.cms.EncapsulatedContentInfo=function(s){var c=y,l=c.asn1,d=l.DERTaggedObject,v=l.DERSequence,m=l.DERObjectIdentifier,T=l.DEROctetString,k=l.cms;k.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var O=this.params,F=[];if(F.push(new m(O.type)),O.content!=null&&(O.content.hex!=null||O.content.str!=null)&&O.isDetached!=!0){var U=new T(O.content),L=new d({tag:"a0",explicit:!0,obj:U});F.push(L)}var P=new v({array:F});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(O){this.params=O},s!=null&&this.setByParam(s)},Re(y.asn1.cms.EncapsulatedContentInfo,y.asn1.ASN1Object),y.asn1.cms.ContentInfo=function(s){var c=y,l=c.asn1,d=l.DERTaggedObject,v=l.DERSequence,m=l.DERObjectIdentifier,T=l.x509;T.OID.name2obj,y.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params,O=[];O.push(new m(k.type));var F=new d({tag:"a0",explicit:!0,obj:k.obj});O.push(F);var U=new v({array:O});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(k){this.params=k},s!=null&&this.setByParam(s)},Re(y.asn1.cms.ContentInfo,y.asn1.ASN1Object),y.asn1.cms.SignedData=function(s){var c=y,l=c.asn1;l.ASN1Object;var d=l.DERInteger,v=l.DERSet,m=l.DERSequence;l.DERTaggedObject;var T=l.cms,k=T.EncapsulatedContentInfo,O=T.SignerInfo,F=T.ContentInfo,U=T.CertificateSet,L=T.RevocationInfoChoices,P=l.x509,D=P.AlgorithmIdentifier;y.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var A=this.params;this._setDigestAlgs(A),this._setContentTypeByEContent(A),this._setMessageDigestByEContent(A),this._setSignerInfoVersion(A),this._setSignedDataVersion(A)},this._setDigestAlgs=function(A){for(var N={},j=A.sinfos,W=0;W<j.length;W++){var se=j[W];N[se.hashalg]=1}A.hashalgs=Object.keys(N).sort()},this._setContentTypeByEContent=function(A){for(var N=A.econtent.type,j=A.sinfos,W=0;W<j.length;W++){var se=j[W],de=this._getAttrParamByName(se,"contentType");de.type=N}},this._setMessageDigestByEContent=function(A){var N=A.econtent;A.econtent.type;var j=N.content.hex;j==null&&N.type=="data"&&N.content.str!=null&&(j=qi(N.content.str));for(var W=A.sinfos,se=0;se<W.length;se++){var de=W[se],ue=de.hashalg,pe=this._getAttrParamByName(de,"messageDigest"),G=y.crypto.Util.hashHex(j,ue);pe.hex=G}},this._getAttrParamByName=function(A,N){for(var j=A.sattrs.array,W=0;W<j.length;W++)if(j[W].attr==N)return j[W]},this._setSignerInfoVersion=function(A){for(var N=A.sinfos,j=0;j<N.length;j++){var W=N[j],se=1;W.id.type=="skid"&&(se=3),W.version=se}},this._setSignedDataVersion=function(A){var N=this._getSignedDataVersion(A);A.version=N},this._getSignedDataVersion=function(A){if(A.revinfos!=null)for(var N=A.revinfos,j=0;j<N.length;j++){var W=N[j];if(W.ocsp!=null)return 5}for(var se=A.sinfos,j=0;j<se.length;j++){var de=A.sinfos[j];if(de.version==3)return 3}return A.econtent.type!="data"?3:1},this.tohex=function(){var A=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),A.fixed!=!0&&this.checkAndFixParam();var N=[];N.push(new d({int:A.version}));for(var j=[],W=0;W<A.hashalgs.length;W++){var se=A.hashalgs[W];j.push(new D({name:se}))}N.push(new v({array:j})),N.push(new k(A.econtent)),A.certs!=null&&N.push(new U(A.certs)),A.revinfos!=null&&N.push(new L(A.revinfos));for(var de=[],W=0;W<A.sinfos.length;W++){var ue=A.sinfos[W];de.push(new O(ue))}N.push(new v({array:de}));var pe=new m({array:N});return pe.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var A=new F({type:"signed-data",obj:this});return A},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.SignedData,y.asn1.ASN1Object),y.asn1.cms.CertificateSet=function(s){y.asn1.cms.CertificateSet.superclass.constructor.call(this);var c=Error,l=y.asn1,d=l.DERTaggedObject,v=l.DERSet,m=l.ASN1Object;this.params=null,this.tohex=function(){var T=this.params,k=[],O;if(T instanceof Array)O=T;else if(T.array!=null)O=T.array;else throw new c("cert array not specified");for(var F=0;F<O.length;F++){var U=O[F],L=Cn(U),P=new m;P.hTLV=L,k.push(P)}var D={array:k};T.sortflag==!1&&(D.sortflag=!1);var A=new v(D),N=new d({tag:"a0",explicit:!1,obj:A});return N.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.CertificateSet,y.asn1.ASN1Object),y.asn1.cms.RevocationInfoChoices=function(s){y.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(!c instanceof Array)throw new Error("params is not array");for(var l=[],d=0;d<c.length;d++)l.push(new y.asn1.cms.RevocationInfoChoice(c[d]));var v=y.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:l}}});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.RevocationInfoChoices,y.asn1.ASN1Object),y.asn1.cms.RevocationInfoChoice=function(s){y.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(c.crl!=null&&typeof c.crl=="string"){var l=c.crl;return c.crl.indexOf("-----BEGIN")!=-1&&(l=Cn(c.crl)),l}else if(c.ocsp!=null){var d=y.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new y.asn1.cms.OtherRevocationFormat(c)}});return d.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.RevocationInfoChoice,y.asn1.ASN1Object),y.asn1.cms.OtherRevocationFormat=function(s){y.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var c=Error,l=y,d=l.asn1,v=d.ASN1Util.newObject,m=l.lang.String.isHex;this.params=null,this.tohex=function(){var T=this.params;if(T.ocsp==null)throw new c("property ocsp not specified");if(!m(T.ocsp)||!Me.isASN1HEX(T.ocsp))throw new c("ocsp value not ASN.1 hex string");var k=v({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:T.ocsp}}]});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cms.OtherRevocationFormat,y.asn1.ASN1Object),y.asn1.cms.CMSUtil=new function(){},y.asn1.cms.CMSUtil.newSignedData=function(s){return new y.asn1.cms.SignedData(s)},y.asn1.cms.CMSUtil.verifySignedData=function(s){var c=y,l=c.asn1,d=l.cms;d.SignerInfo,d.SignedData,d.SigningTime,d.SigningCertificate,d.SigningCertificateV2;var v=l.cades;v.SignaturePolicyIdentifier;var m=c.lang.String.isHex,T=Me,k=T.getVbyList,O=T.getTLVbyList,F=T.getIdxbyList,U=T.getChildIdx,L=T.getTLV,P=T.oidname,D=c.crypto.Util.hashHex;s.cms===void 0&&m(s.cms);var A=s.cms,N=function(te,J){for(var re,he=3;he<6;he++)if(re=F(te,0,[1,0,he]),re!==void 0){var ye=te.substr(re,2);ye==="a0"&&(J.certsIdx=re),ye==="a1"&&(J.revinfosIdx=re),ye==="31"&&(J.signerinfosIdx=re)}},j=function(te,J){var re=J.signerinfosIdx;if(re!==void 0){var he=U(te,re);J.signerInfoIdxList=he;for(var ye=0;ye<he.length;ye++){var Ae=he[ye],ve={idx:Ae};W(te,ve),J.signerInfos.push(ve)}}},W=function(te,J){var re=J.idx;J.signerid_issuer1=O(te,re,[1,0],"30"),J.signerid_serial1=k(te,re,[1,1],"02"),J.hashalg=P(k(te,re,[2,0],"06"));var he=F(te,re,[3],"a0");J.idxSignedAttrs=he,se(te,J,he);var ye=U(te,re),Ae=ye.length;if(Ae<6)throw"malformed SignerInfo";J.sigalg=P(k(te,re,[Ae-2,0],"06")),J.sigval=k(te,re,[Ae-1],"04")},se=function(te,J,re){var he=U(te,re);J.signedAttrIdxList=he;for(var ye=0;ye<he.length;ye++){var Ae=he[ye],ve=k(te,Ae,[0],"06"),xe;ve==="2a864886f70d010905"?(xe=Jt(k(te,Ae,[1,0])),J.saSigningTime=xe):ve==="2a864886f70d010904"&&(xe=k(te,Ae,[1,0],"04"),J.saMessageDigest=xe)}},de=function(te,J){if(k(te,0,[0],"06")!=="2a864886f70d010702")return J;J.cmsType="signedData",J.econtent=k(te,0,[1,0,2,1,0]),N(te,J),J.signerInfos=[],j(te,J)},ue=function(te,J){for(var re=J.parse.signerInfos,he=re.length,ye=!0,Ae=0;Ae<he;Ae++){var ve=re[Ae];G(te,J,ve),ve.isValid||(ye=!1)}J.isValid=ye},pe=function(te,J,re,he){var ye=J.parse.certsIdx,Ae;if(J.certs===void 0){Ae=[],J.certkeys=[];for(var ve=U(te,ye),xe=0;xe<ve.length;xe++){var Fe=L(te,ve[xe]),Ne=new st;Ne.readCertHex(Fe),Ae[xe]=Ne,J.certkeys[xe]=Ne.getPublicKey()}J.certs=Ae}else Ae=J.certs;J.cccc=Ae.length,J.cccci=ve.length;for(var xe=0;xe<Ae.length;xe++){var ar=Ne.getIssuerHex(),mn=Ne.getSerialNumberHex();re.signerid_issuer1===ar&&re.signerid_serial1===mn&&(re.certkey_idx=xe)}},G=function(te,J,re,he){re.verifyDetail={};var ye=re.verifyDetail,Ae=J.parse.econtent,ve=re.hashalg,xe=re.saMessageDigest;ye.validMessageDigest=!1,D(Ae,ve)===xe&&(ye.validMessageDigest=!0),pe(te,J,re),ye.validSignatureValue=!1;var Fe=re.sigalg,Ne="31"+L(te,re.idxSignedAttrs).substr(2);re.signedattrshex=Ne;var ar=J.certs[re.certkey_idx].getPublicKey(),mn=new y.crypto.Signature({alg:Fe});mn.init(ar),mn.updateHex(Ne);var tn=mn.verify(re.sigval);ye.validSignatureValue_isValid=tn,tn===!0&&(ye.validSignatureValue=!0),re.isValid=!1,ye.validMessageDigest&&ye.validSignatureValue&&(re.isValid=!0)},X={isValid:!1,parse:{}};return de(A,X.parse),ue(A,X),X},y.asn1.cms.CMSParser=function(){var s=Error,c=st,l=new c,d=Me,v=d.getV,m=d.getTLV;d.getIdxbyList;var T=d.getTLVbyList,k=d.getTLVbyListEx,O=d.getVbyList,F=d.getVbyListEx,U=d.getChildIdx;this.getCMSSignedData=function(L){var P=T(L,0,[1,0]),D=this.getSignedData(P);return D},this.getSignedData=function(L){var P=U(L,0),D={},A=v(L,P[0]),N=parseInt(A,16);D.version=N;var j=m(L,P[1]);D.hashalgs=this.getHashAlgArray(j);var W=m(L,P[2]);D.econtent=this.getEContent(W);var se=k(L,0,["[0]"]);se!=null&&(D.certs=this.getCertificateSet(se)),k(L,0,["[1]"]);var de=k(L,0,[3]);return D.sinfos=this.getSignerInfos(de),D},this.getHashAlgArray=function(L){for(var P=U(L,0),D=new c,A=[],N=0;N<P.length;N++){var j=m(L,P[N]),W=D.getAlgorithmIdentifierName(j);A.push(W)}return A},this.getEContent=function(L){var P={},D=O(L,0,[0]),A=O(L,0,[1,0]);return P.type=y.asn1.x509.OID.oid2name(Me.hextooidstr(D)),P.content={hex:A},P},this.getSignerInfos=function(L){for(var P=[],D=U(L,0),A=0;A<D.length;A++){var N=m(L,D[A]),j=this.getSignerInfo(N);P.push(j)}return P},this.getSignerInfo=function(L){var P={},D=U(L,0),A=d.getInt(L,D[0],-1);A!=-1&&(P.version=A);var N=m(L,D[1]),j=this.getIssuerAndSerialNumber(N);P.id=j;var W=m(L,D[2]),se=l.getAlgorithmIdentifierName(W);P.hashalg=se;var de=k(L,0,["[0]"]);if(de!=null){var ue=this.getAttributeList(de);P.sattrs=ue}var pe=k(L,0,[3]),G=l.getAlgorithmIdentifierName(pe);P.sigalg=G;var X=F(L,0,[4]);P.sighex=X;var te=k(L,0,["[1]"]);if(te!=null){var J=this.getAttributeList(te);P.uattrs=J}return P},this.getSignerIdentifier=function(L){if(L.substr(0,2)=="30")return this.getIssuerAndSerialNumber(L);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(L){var P={type:"isssn"},D=U(L,0),A=m(L,D[0]);P.issuer=l.getX500Name(A);var N=v(L,D[1]);return P.serial={hex:N},P},this.getAttributeList=function(L){for(var P=[],D=U(L,0),A=0;A<D.length;A++){var N=m(L,D[A]),j=this.getAttribute(N);P.push(j)}return{array:P}},this.getAttribute=function(L){var P={},D=U(L,0),A=d.getOID(L,D[0]),N=y.asn1.x509.OID.oid2name(A);P.attr=N;var j=m(L,D[1]),W=U(j,0);if(W.length==1)P.valhex=m(j,W[0]);else{for(var se=[],de=0;de<W.length;de++)se.push(m(j,W[de]));P.valhex=se}return N=="contentType"?this.setContentType(P):N=="messageDigest"?this.setMessageDigest(P):N=="signingTime"?this.setSigningTime(P):N=="signingCertificate"?this.setSigningCertificate(P):N=="signingCertificateV2"?this.setSigningCertificateV2(P):N=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(P),P},this.setContentType=function(L){var P=d.getOIDName(L.valhex,0,null);P!=null&&(L.type=P,delete L.valhex)},this.setSigningTime=function(L){var P=v(L.valhex,0),D=Jt(P);L.str=D,delete L.valhex},this.setMessageDigest=function(L){var P=v(L.valhex,0);L.hex=P,delete L.valhex},this.setSigningCertificate=function(L){var P=U(L.valhex,0);if(P.length>0){for(var D=m(L.valhex,P[0]),A=U(D,0),N=[],j=0;j<A.length;j++){var W=m(D,A[j]),se=this.getESSCertID(W);N.push(se)}L.array=N}if(P.length>1){var de=m(L.valhex,P[1]);L.polhex=de}delete L.valhex},this.setSignaturePolicyIdentifier=function(L){var P=U(L.valhex,0);if(P.length>0){var D=d.getOID(L.valhex,P[0]);L.oid=D}if(P.length>1){var A=new c,N=U(L.valhex,P[1]),j=m(L.valhex,N[0]),W=A.getAlgorithmIdentifierName(j);L.alg=W;var se=v(L.valhex,N[1]);L.hash=se}delete L.valhex},this.setSigningCertificateV2=function(L){var P=U(L.valhex,0);if(P.length>0){for(var D=m(L.valhex,P[0]),A=U(D,0),N=[],j=0;j<A.length;j++){var W=m(D,A[j]),se=this.getESSCertIDv2(W);N.push(se)}L.array=N}if(P.length>1){var de=m(L.valhex,P[1]);L.polhex=de}delete L.valhex},this.getESSCertID=function(L){var P={},D=U(L,0);if(D.length>0){var A=v(L,D[0]);P.hash=A}if(D.length>1){var N=m(L,D[1]),j=this.getIssuerSerial(N);j.serial!=null&&(P.serial=j.serial),j.issuer!=null&&(P.issuer=j.issuer)}return P},this.getESSCertIDv2=function(L){var P={},D=U(L,0);if(D.length<1||3<D.length)throw new s("wrong number of elements");var A=0;if(L.substr(D[0],2)=="30"){var N=m(L,D[0]);P.alg=l.getAlgorithmIdentifierName(N),A++}else P.alg="sha256";var j=v(L,D[A]);if(P.hash=j,D.length>A+1){var W=m(L,D[A+1]),se=this.getIssuerSerial(W);P.issuer=se.issuer,P.serial=se.serial}return P},this.getIssuerSerial=function(L){var P={},D=U(L,0),A=m(L,D[0]),N=l.getGeneralNames(A),j=N[0].dn;P.issuer=j;var W=v(L,D[1]);return P.serial={hex:W},P},this.getCertificateSet=function(L){for(var P=U(L,0),D=[],A=0;A<P.length;A++){var N=m(L,P[A]);if(N.substr(0,2)=="30"){var j=sr(N,"CERTIFICATE");D.push(j)}}return{array:D,sortflag:!1}}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.tsp>"u"||!y.asn1.tsp)&&(y.asn1.tsp={}),y.asn1.tsp.TimeStampToken=function(s){var c=y,l=c.asn1,d=l.tsp;d.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var v=new d.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=v.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.tsp.TimeStampToken,y.asn1.cms.SignedData),y.asn1.tsp.TSTInfo=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.DERInteger,m=l.DERBoolean,T=l.DERGeneralizedTime,k=l.DERObjectIdentifier,O=l.DERTaggedObject,F=l.tsp,U=F.MessageImprint,L=F.Accuracy;l.x509.X500Name;var P=l.x509.GeneralName;if(F.TSTInfo.superclass.constructor.call(this),this.dVersion=new v({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var D=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(D.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(D.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(D.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");D.push(this.dGenTime),this.dAccuracy!=null&&D.push(this.dAccuracy),this.dOrdering!=null&&D.push(this.dOrdering),this.dNonce!=null&&D.push(this.dNonce),this.dTsa!=null&&D.push(this.dTsa);var A=new d({array:D});return this.hTLV=A.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0){if(typeof s.policy=="string"){if(!s.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new k({oid:s.policy})}s.messageImprint!==void 0&&(this.dMessageImprint=new U(s.messageImprint)),s.serial!==void 0&&(this.dSerial=new v(s.serial)),s.genTime!==void 0&&(this.dGenTime=new T(s.genTime)),s.accuracy!==void 0&&(this.dAccuracy=new L(s.accuracy)),s.ordering!==void 0&&s.ordering==!0&&(this.dOrdering=new m),s.nonce!==void 0&&(this.dNonce=new v(s.nonce)),s.tsa!==void 0&&(this.dTsa=new O({tag:"a0",explicit:!0,obj:new P({dn:s.tsa})}))}},Re(y.asn1.tsp.TSTInfo,y.asn1.ASN1Object),y.asn1.tsp.Accuracy=function(s){var c=y,l=c.asn1,d=l.ASN1Util.newObject;l.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var v=this.params,m=[];return v.seconds!=null&&typeof v.seconds=="number"&&m.push({int:v.seconds}),v.millis!=null&&typeof v.millis=="number"&&m.push({tag:{tagi:"80",obj:{int:v.millis}}}),v.micros!=null&&typeof v.micros=="number"&&m.push({tag:{tagi:"81",obj:{int:v.micros}}}),d({seq:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.tsp.Accuracy,y.asn1.ASN1Object),y.asn1.tsp.MessageImprint=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.DEROctetString,m=l.x509,T=m.AlgorithmIdentifier;l.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params,O=new T({name:k.alg}),F=new v({hex:k.hash}),U=new d({array:[O,F]});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.tsp.MessageImprint,y.asn1.ASN1Object),y.asn1.tsp.TimeStampReq=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.DERInteger,m=l.DERBoolean;l.ASN1Object;var T=l.DERObjectIdentifier,k=l.tsp,O=k.MessageImprint;k.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];U.push(new v({int:1})),F.messageImprint instanceof y.asn1.ASN1Object?U.push(F.messageImprint):U.push(new O(F.messageImprint)),F.policy!=null&&U.push(new T(F.policy)),F.nonce!=null&&U.push(new v(F.nonce)),F.certreq==!0&&U.push(new m);var L=new d({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.tsp.TimeStampReq,y.asn1.ASN1Object),y.asn1.tsp.TimeStampResp=function(s){var c=y,l=c.asn1,d=l.DERSequence;l.ASN1Object;var v=l.tsp,m=v.PKIStatusInfo;v.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var T=this.params,k=[];if(T.econtent!=null||T.tst!=null)if(T.statusinfo!=null?k.push(new m(T.statusinfo)):k.push(new m("granted")),T.econtent!=null)k.push(new v.TimeStampToken(T).getContentInfo());else if(T.tst instanceof l.ASN1Object)k.push(T.tst);else throw new Error("improper member tst value");else if(T.statusinfo!=null)k.push(new m(T.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var O=new d({array:k});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.tsp.TimeStampResp,y.asn1.ASN1Object),y.asn1.tsp.PKIStatusInfo=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.tsp,T=m.PKIStatus,k=m.PKIFreeText,O=m.PKIFailureInfo;m.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];if(typeof F=="string")U.push(new T(F));else{if(F.status==null)throw new c("property 'status' unspecified");U.push(new T(F.status)),F.statusstr!=null&&U.push(new k(F.statusstr)),F.failinfo!=null&&U.push(new O(F.failinfo))}var L=new v({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.tsp.PKIStatusInfo,y.asn1.ASN1Object),y.asn1.tsp.PKIStatus=function(s){var c=Error,l=y,d=l.asn1,v=d.DERInteger,m=d.tsp;m.PKIStatus.superclass.constructor.call(this);var T={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var k=this.params,O;if(typeof k=="string")try{O=T[k]}catch{throw new c("undefined name: "+k)}else if(typeof k=="number")O=k;else throw new c("unsupported params");return new v({int:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.tsp.PKIStatus,y.asn1.ASN1Object),y.asn1.tsp.PKIFreeText=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.DERUTF8String,T=d.tsp;T.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;if(!k instanceof Array)throw new c("wrong params: not array");for(var O=[],F=0;F<k.length;F++)O.push(new m({str:k[F]}));var U=new v({array:O});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.tsp.PKIFreeText,y.asn1.ASN1Object),y.asn1.tsp.PKIFailureInfo=function(s){var c=Error,l=y,d=l.asn1,v=d.DERBitString,m=d.tsp,T=m.PKIFailureInfo,k={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};T.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var O=this.params,F=0;if(typeof O=="number"&&0<=O&&O<=25){F|=1<<O;for(var U=F.toString(2),L="",P=U.length-1;P>=0;P--)L+=U[P];return L}else{if(typeof O=="string"&&k[O]!=null)return Ql([O],k);if(typeof O=="object"&&O.length!=null)return Ql(O,k);throw new c("wrong params")}},this.tohex=function(){this.params;var O=this.getBinValue();return new v({bin:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.tsp.PKIFailureInfo,y.asn1.ASN1Object),y.asn1.tsp.AbstractTSAAdapter=function(s){this.getTSTHex=function(c,l){throw"not implemented yet"}},y.asn1.tsp.SimpleTSAAdapter=function(s){var c=y,l=c.asn1,d=l.tsp,v=c.crypto.Util.hashHex;d.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(m,T){var k=v(m,T);this.params.econtent.content.messageImprint={alg:T,hash:k},this.params.econtent.content.serial={int:this.serial++};var O=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:O};var F=new d.TimeStampToken(this.params);return F.getContentInfoEncodedHex()},s!==void 0&&(this.params=s)},Re(y.asn1.tsp.SimpleTSAAdapter,y.asn1.tsp.AbstractTSAAdapter),y.asn1.tsp.FixedTSAAdapter=function(s){var c=y,l=c.asn1,d=l.tsp,v=c.crypto.Util.hashHex;d.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(m,T){var k=v(m,T);this.params.econtent.content.messageImprint={alg:T,hash:k};var O=new d.TimeStampToken(this.params);return O.getContentInfoEncodedHex()},s!==void 0&&(this.params=s)},Re(y.asn1.tsp.FixedTSAAdapter,y.asn1.tsp.AbstractTSAAdapter),y.asn1.tsp.TSPUtil=new function(){},y.asn1.tsp.TSPUtil.newTimeStampToken=function(s){return new y.asn1.tsp.TimeStampToken(s)},y.asn1.tsp.TSPUtil.parseTimeStampReq=function(s){var c=new y.asn1.tsp.TSPParser;return c.getTimeStampReq(s)},y.asn1.tsp.TSPUtil.parseMessageImprint=function(s){var c=new y.asn1.tsp.TSPParser;return c.getMessageImprint(s)},y.asn1.tsp.TSPParser=function(){var s=st,c=new s,l=Me,d=l.getV,v=l.getTLV,m=l.getIdxbyList;l.getTLVbyListEx;var T=l.getChildIdx,k=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],O={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(F){var U=T(F,0);if(U.length==1)return this.getPKIStatusInfo(v(F,U[0]));if(U.length>1){var L=this.getPKIStatusInfo(v(F,U[0])),P=v(F,U[1]),D=this.getToken(P);return D.statusinfo=L,D}},this.getToken=function(F){var U=new y.asn1.cms.CMSParser,L=U.getCMSSignedData(F);return this.setTSTInfo(L),L},this.setTSTInfo=function(F){var U=F.econtent;if(U.type=="tstinfo"){var L=U.content.hex,P=this.getTSTInfo(L);U.content=P}},this.getTSTInfo=function(F){var U={},L=T(F,0),P=d(F,L[1]);U.policy=Zl(P);var D=v(F,L[2]);U.messageImprint=this.getMessageImprint(D);var A=d(F,L[3]);U.serial={hex:A};var N=d(F,L[4]);U.genTime={str:Jt(N)};var j=0;if(L.length>5&&F.substr(L[5],2)=="30"){var W=v(F,L[5]);U.accuracy=this.getAccuracy(W),j++}if(L.length>5+j&&F.substr(L[5+j],2)=="01"){var se=d(F,L[5+j]);se=="ff"&&(U.ordering=!0),j++}if(L.length>5+j&&F.substr(L[5+j],2)=="02"){var de=d(F,L[5+j]);U.nonce={hex:de},j++}if(L.length>5+j&&F.substr(L[5+j],2)=="a0"){var ue=v(F,L[5+j]);ue="30"+ue.substr(2),pGeneralNames=c.getGeneralNames(ue);var pe=pGeneralNames[0].dn;U.tsa=pe,j++}if(L.length>5+j&&F.substr(L[5+j],2)=="a1"){var G=v(F,L[5+j]);G="30"+G.substr(2);var X=c.getExtParamArray(G);U.ext=X,j++}return U},this.getAccuracy=function(F){for(var U={},L=T(F,0),P=0;P<L.length;P++){var D=F.substr(L[P],2),A=d(F,L[P]),N=parseInt(A,16);D=="02"?U.seconds=N:D=="80"?U.millis=N:D=="81"&&(U.micros=N)}return U},this.getMessageImprint=function(F){if(F.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var U={};T(F,0);var L=m(F,0,[0,0]),P=d(F,L),D=l.hextooidstr(P),A=y.asn1.x509.OID.oid2name(D);if(A=="")throw new Error("hashAlg name undefined: "+D);var N=A,j=m(F,0,[1]);return U.alg=N,U.hash=d(F,j),U},this.getPKIStatusInfo=function(F){var U={},L=T(F,0),P=0;try{var D=d(F,L[0]),A=parseInt(D,16);U.status=k[A]}catch{}if(L.length>1&&F.substr(L[1],2)=="30"){var N=v(F,L[1]);U.statusstr=this.getPKIFreeText(N),P++}if(L.length>P&&F.substr(L[1+P],2)=="03"){var j=v(F,L[1+P]);U.failinfo=this.getPKIFailureInfo(j)}return U},this.getPKIFreeText=function(F){for(var U=[],L=T(F,0),P=0;P<L.length;P++)U.push(l.getString(F,L[P]));return U},this.getPKIFailureInfo=function(F){var U=l.getInt(F,0);return O[U]!=null?O[U]:U},this.getTimeStampReq=function(F){var U={};U.certreq=!1;var L=T(F,0);if(L.length<2)throw new Error("TimeStampReq must have at least 2 items");var P=v(F,L[1]);U.messageImprint=y.asn1.tsp.TSPUtil.parseMessageImprint(P);for(var D=2;D<L.length;D++){var A=L[D],N=F.substr(A,2);if(N=="06"){var j=d(F,A);U.policy=l.hextooidstr(j)}N=="02"&&(U.nonce=d(F,A)),N=="01"&&(U.certreq=!0)}return U}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.cades>"u"||!y.asn1.cades)&&(y.asn1.cades={}),y.asn1.cades.SignaturePolicyIdentifier=function(s){var c=y,l=c.asn1,d=l.cades,v=d.SignaturePolicyId;d.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new v(this.params)]},this.setByParam=function(m){this.params=m},s!=null&&this.setByParam(s)},Re(y.asn1.cades.SignaturePolicyIdentifier,y.asn1.cms.Attribute),y.asn1.cades.SignaturePolicyId=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.DERObjectIdentifier,m=l.x509;m.AlgorithmIdentifier;var T=l.cades,k=T.SignaturePolicyId,O=T.OtherHashAlgAndValue;k.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];U.push(new v(F.oid)),U.push(new O(F));var L=new d({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(F){this.params=F},s!=null&&this.setByParam(s)},Re(y.asn1.cades.SignaturePolicyId,y.asn1.ASN1Object),y.asn1.cades.OtherHashAlgAndValue=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.DEROctetString,T=d.x509,k=T.AlgorithmIdentifier,O=d.cades,F=O.OtherHashAlgAndValue;F.superclass.constructor.call(this),this.params=null,this.tohex=function(){var U=this.params;if(U.alg==null)throw new c("property 'alg' not specified");if(U.hash==null&&U.cert==null)throw new c("property 'hash' nor 'cert' not specified");var L=null;if(U.hash!=null)L=U.hash;else if(U.cert!=null){if(typeof U.cert!="string")throw new c("cert not string");var P=U.cert;U.cert.indexOf("-----BEGIN")!=-1&&(P=Cn(U.cert)),L=y.crypto.Util.hashHex(P,U.alg)}var D=[];D.push(new k({name:U.alg})),D.push(new m({hex:L}));var A=new v({array:D});return A.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cades.OtherHashAlgAndValue,y.asn1.ASN1Object),y.asn1.cades.OtherHashValue=function(s){y.asn1.cades.OtherHashValue.superclass.constructor.call(this);var c=Error,l=y;l.lang.String.isHex;var d=l.asn1,v=d.DEROctetString;l.crypto.Util.hashHex,this.params=null,this.tohex=function(){var m=this.params;if(m.hash==null&&m.cert==null)throw new c("hash or cert not specified");var T=null;if(m.hash!=null)T=m.hash;else if(m.cert!=null){if(typeof m.cert!="string")throw new c("cert not string");var k=m.cert;m.cert.indexOf("-----BEGIN")!=-1&&(k=Cn(m.cert)),T=y.crypto.Util.hashHex(k,"sha1")}return new v({hex:T}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cades.OtherHashValue,y.asn1.ASN1Object),y.asn1.cades.SignatureTimeStamp=function(s){var c=Error,l=y,d=l.lang.String.isHex,v=l.asn1,m=v.ASN1Object;v.x509;var T=v.cades;T.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var k=this.params;if(k.tst!=null)if(d(k.tst)){var O=new m;return O.hTLV=k.tst,[O]}else{if(k.tst instanceof m)return[k.tst];throw new c("params.tst has wrong value")}else if(k.res!=null){var F=k.res;if(F instanceof m&&(F=F.tohex()),typeof F!="string"||!d(F))throw new c("params.res has wrong value");Me.getTLVbyList(F,0,[1]);var O=new m;return O.hTLV=k.tst,[O]}},s!=null&&this.setByParam(s)},Re(y.asn1.cades.SignatureTimeStamp,y.asn1.cms.Attribute),y.asn1.cades.CompleteCertificateRefs=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.cades,T=m.OtherCertID,k=l.lang.String.isHex;m.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var O=this.params,F=[],U=0;U<O.array.length;U++){var L=O.array[U];if(typeof L=="string")if(L.indexOf("-----BEGIN")!=-1)L={cert:L};else if(k(L))L={hash:L};else throw new c("unsupported value: "+L);O.alg!=null&&L.alg==null&&(L.alg=O.alg),O.hasis!=null&&L.hasis==null&&(L.hasis=O.hasis);var P=new T(L);F.push(P)}var D=new v({array:F});return[D]},s!=null&&this.setByParam(s)},Re(y.asn1.cades.CompleteCertificateRefs,y.asn1.cms.Attribute),y.asn1.cades.OtherCertID=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.cms,m=v.IssuerSerial,T=l.cades,k=T.OtherHashValue,O=T.OtherHashAlgAndValue;T.OtherCertID.superclass.constructor.call(this),this.params=s,this.tohex=function(){var F=this.params;typeof F=="string"&&(F.indexOf("-----BEGIN")!=-1?F={cert:F}:_isHex(F)&&(F={hash:F}));var U=[],L=null;if(F.alg!=null?L=new O(F):L=new k(F),U.push(L),F.cert!=null&&F.hasis==!0||F.issuer!=null&&F.serial!=null){var P=new m(F);U.push(P)}var D=new d({array:U});return D.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cades.OtherCertID,y.asn1.ASN1Object),y.asn1.cades.OtherHash=function(s){var c=y,l=c.asn1;l.cms;var d=l.cades,v=d.OtherHashAlgAndValue,m=d.OtherHashValue;c.crypto.Util.hashHex;var T=c.lang.String.isHex;d.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;typeof k=="string"&&(k.indexOf("-----BEGIN")!=-1?k={cert:k}:T(k)&&(k={hash:k}));var O=null;return k.alg!=null?O=new v(k):O=new m(k),O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Re(y.asn1.cades.OtherHash,y.asn1.ASN1Object),y.asn1.cades.CAdESUtil=new function(){},y.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(s){var c=new y.asn1.cms.CMSParser,l=c.getCMSSignedData(s);return l},y.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(s,c,l){var d=Me,v=d.getChildIdx,m=d.getTLV,T=d.getV,k=y,O=k.asn1,F=O.ASN1Object,U=O.cms,L=U.AttributeList,P=U.SignerInfo,D={},A=v(s,c);if(A.length!=6)throw"not supported items for SignerInfo (!=6)";var N=A.shift();D.version=m(s,N);var j=A.shift();D.si=m(s,j);var W=A.shift();D.digalg=m(s,W);var se=A.shift();D.sattrs=m(s,se);var de=A.shift();D.sigalg=m(s,de);var ue=A.shift();D.sig=m(s,ue),D.sigval=T(s,ue);var pe=null;return D.obj=new P,pe=new F,pe.hTLV=D.version,D.obj.dCMSVersion=pe,pe=new F,pe.hTLV=D.si,D.obj.dSignerIdentifier=pe,pe=new F,pe.hTLV=D.digalg,D.obj.dDigestAlgorithm=pe,pe=new F,pe.hTLV=D.sattrs,D.obj.dSignedAttrs=pe,pe=new F,pe.hTLV=D.sigalg,D.obj.dSigAlg=pe,pe=new F,pe.hTLV=D.sig,D.obj.dSig=pe,D.obj.dUnsignedAttrs=new L,D},(typeof y.asn1.csr>"u"||!y.asn1.csr)&&(y.asn1.csr={}),y.asn1.csr.CertificationRequest=function(s){var c=y,l=c.asn1,d=l.DERBitString,v=l.DERSequence,m=l.csr;l.x509;var T=m.CertificationRequestInfo;m.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(k){this.params=k},this.sign=function(){var k=new T(this.params).tohex(),O=new y.crypto.Signature({alg:this.params.sigalg});O.init(this.params.sbjprvkey),O.updateHex(k);var F=O.sign();this.params.sighex=F},this.getPEM=function(){return sr(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var k=this.params,O=new y.asn1.csr.CertificationRequestInfo(this.params),F=new y.asn1.x509.AlgorithmIdentifier({name:k.sigalg});if(k.sighex==null&&k.sbjprvkey!=null&&this.sign(),k.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var U=new d({hex:"00"+k.sighex}),L=new v({array:[O,F,U]});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.csr.CertificationRequest,y.asn1.ASN1Object),y.asn1.csr.CertificationRequestInfo=function(s){var c=y,l=c.asn1;l.DERBitString;var d=l.DERSequence,v=l.DERInteger,m=l.DERUTF8String,T=l.DERTaggedObject,k=l.ASN1Util.newObject,O=l.csr,F=l.x509,U=F.X500Name,L=F.Extensions,P=F.SubjectPublicKeyInfo;O.AttributeList,O.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(A){A!=null&&(this.params=A)},this.tohex=function(){var A=this.params,N=[];if(N.push(new v({int:0})),N.push(new U(A.subject)),N.push(new P(It.getKey(A.sbjpubkey))),A.attrs!=null){var j=D(A.attrs),W=k({tag:{tage:"a0",obj:j}});N.push(W)}else if(A.extreq!=null){var se=new L(A.extreq),W=k({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[se]}]}}});N.push(W)}else N.push(new T({tag:"a0",explicit:!1,obj:new m({str:""})}));var de=new d({array:N});return de.tohex()},this.getEncodedHex=function(){return this.tohex()};function D(A){for(var N=Error,j=y.asn1.x509.Extensions,W=[],se=0;se<A.length;se++){var de=A[se],ue=de.attr;if(ue=="extensionRequest"){var pe=new j(de.ext),G={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[pe]}]};W.push(G)}else if(ue=="unstructuredName"){var G={seq:[{oid:"1.2.840.113549.1.9.2"},{set:de.names}]};W.push(G)}else if(ue=="challengePassword"){var G={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:de.password}]}]};W.push(G)}else throw new N("unknown CSR attribute")}return{set:W}}s!=null&&this.setByParam(s)},Re(y.asn1.csr.CertificationRequestInfo,y.asn1.ASN1Object),y.asn1.csr.AttributeList=function(s){},Re(y.asn1.csr.AttributeList,y.asn1.ASN1Object),y.asn1.csr.CSRUtil=new function(){},y.asn1.csr.CSRUtil.newCSRPEM=function(s){var c=y.asn1.csr,l=new c.CertificationRequest(s),d=l.getPEM();return d},y.asn1.csr.CSRUtil.getParam=function(s,c){var l=Me,d=l.getV,v=l.getIdxbyList,m=l.getTLVbyList,T=l.getTLVbyListEx,k=l.getVbyListEx,O=function(se){var de=v(se,0,[0,3,0,0],"06");return d(se,de)!="2a864886f70d01090e"?null:m(se,0,[0,3,0,1,0],"30")},F={};if(s.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var U=Cn(s,"CERTIFICATE REQUEST");c&&(F.tbs=m(U,0,[0]));try{var L=T(U,0,[0,1]);if(L=="3000")F.subject={};else{var N=new st;F.subject=N.getX500Name(L)}}catch{}var P=T(U,0,[0,2]),D=It.getKey(P,null,"pkcs8pub");F.sbjpubkey=It.getPEM(D,"PKCS8PUB");var A=O(U),N=new st;A!=null&&(F.extreq=N.getExtParamArray(A));try{var j=T(U,0,[1],"30"),N=new st;F.sigalg=N.getAlgorithmIdentifierName(j)}catch{}try{var W=k(U,0,[2]);F.sighex=W}catch{}return F},y.asn1.csr.CSRUtil.verifySignature=function(s){try{var c=null;if(typeof s=="string"&&s.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?c=y.asn1.csr.CSRUtil.getParam(s,!0):typeof s=="object"&&s.sbjpubkey!=null&&s.sigalg!=null&&s.sighex!=null&&s.tbs!=null&&(c=s),c==null)return!1;var l=new y.crypto.Signature({alg:c.sigalg});return l.init(c.sbjpubkey),l.updateHex(c.tbs),l.verify(c.sighex)}catch(d){return alert(d),!1}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.ocsp>"u"||!y.asn1.ocsp)&&(y.asn1.ocsp={}),y.asn1.ocsp.DEFAULT_HASH="sha1",y.asn1.ocsp.OCSPResponse=function(s){y.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),y.asn1.DEREnumerated;var c=y.asn1.ASN1Util.newObject,l=y.asn1.ocsp.ResponseBytes,d=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var v=this.params.resstatus;return typeof v=="number"?v:typeof v!="string"?-1:d.indexOf(v)},this.setByParam=function(v){this.params=v},this.tohex=function(){var v=this.params,m=this._getStatusCode();if(m==-1)throw new Error("responseStatus not supported: "+v.resstatus);if(m!=0)return c({seq:[{enum:{int:m}}]}).tohex();var T=new l(v);return c({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:T}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.OCSPResponse,y.asn1.ASN1Object),y.asn1.ocsp.ResponseBytes=function(s){y.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.DERObjectIdentifier,v=c.DEROctetString,m=c.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(T.restype!="ocspBasic")throw new Error("not supported responseType: "+T.restype);var k=new m(T),O=[];O.push(new d({name:"ocspBasic"})),O.push(new v({hex:k.tohex()}));var F=new l({array:O});return F.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.ResponseBytes,y.asn1.ASN1Object),y.asn1.ocsp.BasicOCSPResponse=function(s){y.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var c=Error,l=y.asn1,d=l.ASN1Object,v=l.DERSequence;l.DERGeneralizedTime;var m=l.DERTaggedObject,T=l.DERBitString;l.x509.Extensions;var k=l.x509.AlgorithmIdentifier,O=l.ocsp;O.ResponderID,_SingleResponseList=O.SingleResponseList,_ResponseData=O.ResponseData,this.params=null,this.setByParam=function(F){this.params=F},this.sign=function(){var F=this.params,U=F.tbsresp.tohex(),L=new y.crypto.Signature({alg:F.sigalg});L.init(F.reskey),L.updateHex(U),F.sighex=L.sign()},this.tohex=function(){var F=this.params;F.tbsresp==null&&(F.tbsresp=new _ResponseData(F)),F.sighex==null&&F.reskey!=null&&this.sign();var U=[];if(U.push(F.tbsresp),U.push(new k({name:F.sigalg})),U.push(new T({hex:"00"+F.sighex})),F.certs!=null&&F.certs.length!=null){for(var L=[],P=0;P<F.certs.length;P++){var D=F.certs[P],A=null;if(Me.isASN1HEX(D))A=D;else if(D.match(/-----BEGIN/))A=Cn(D);else throw new c("certs["+P+"] not hex or PEM");L.push(new d({tlv:A}))}var N=new v({array:L});U.push(new m({tag:"a0",explicit:!0,obj:N}))}var j=new v({array:U});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.BasicOCSPResponse,y.asn1.ASN1Object),y.asn1.ocsp.ResponseData=function(s){y.asn1.ocsp.ResponseData.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.DERGeneralizedTime,v=c.DERTaggedObject,m=c.x509.Extensions,T=c.ocsp,k=T.ResponderID;_SingleResponseList=T.SingleResponseList,this.params=null,this.tohex=function(){var O=this.params;O.respid!=null,O.prodat!=null,O.array!=null;var F=[];if(F.push(new k(O.respid)),F.push(new d(O.prodat)),F.push(new _SingleResponseList(O.array)),O.ext!=null){var U=new m(O.ext);F.push(new v({tag:"a1",explicit:!0,obj:U}))}var L=new l({array:F});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(O){this.params=O},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.ResponseData,y.asn1.ASN1Object),y.asn1.ocsp.ResponderID=function(s){y.asn1.ocsp.ResponderID.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.ASN1Util.newObject,v=l.x509.X500Name,m=c.lang.String.isHex,T=Error;this.params=null,this.tohex=function(){var k=this.params;if(k.key!=null){var O=null;if(typeof k.key=="string"){if(m(k.key)&&(O=k.key),k.key.match(/-----BEGIN CERTIFICATE/)){var F=new st(k.key),U=F.getExtSubjectKeyIdentifier();U!=null&&(O=U.kid.hex)}}else if(k.key instanceof st){var U=k.key.getExtSubjectKeyIdentifier();U!=null&&(O=U.kid.hex)}if(O==null)throw new T("wrong key member value");var L=d({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:O}}}});return L.tohex()}else if(k.name!=null){var P=null;if(typeof k.name=="string"&&k.name.match(/-----BEGIN CERTIFICATE/)){var F=new st(k.name);P=F.getSubject()}else k.name instanceof st?P=k.name.getSubject():typeof k.name=="object"&&(k.name.array!=null||k.name.str!=null)&&(P=k.name);if(P==null)throw new T("wrong name member value");var L=d({tag:{tag:"a1",explicit:!0,obj:new v(P)}});return L.tohex()}throw new T("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(k){this.params=k},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.ResponderID,y.asn1.ASN1Object),y.asn1.ocsp.SingleResponseList=function(s){y.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.ocsp.SingleResponse;this.params=null,this.tohex=function(){var v=this.params;if(typeof v!="object"||v.length==null)throw new Error("params not specified properly");for(var m=[],T=0;T<v.length;T++)m.push(new d(v[T]));var k=new l({array:m});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(v){this.params=v},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.SingleResponseList,y.asn1.ASN1Object),y.asn1.ocsp.SingleResponse=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.DERGeneralizedTime,T=d.DERTaggedObject,k=d.ocsp,O=k.CertID,F=k.CertStatus,U=d.x509,L=U.Extensions;k.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P=this.params,D=[];if(P.certid==null)throw new c("certid unspecified");if(P.status==null)throw new c("status unspecified");if(P.thisupdate==null)throw new c("thisupdate unspecified");if(D.push(new O(P.certid)),D.push(new F(P.status)),D.push(new m(P.thisupdate)),P.nextupdate!=null){var A=new m(P.nextupdate);D.push(new T({tag:"a0",explicit:!0,obj:A}))}if(P.ext!=null){var N=new L(P.ext);D.push(new T({tag:"a1",explicit:!0,obj:N}))}var j=new v({array:D});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(P){this.params=P},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.SingleResponse,y.asn1.ASN1Object),y.asn1.ocsp.CertID=function(s){var c=y,l=c.asn1,d=l.DEROctetString,v=l.DERInteger,m=l.DERSequence,T=l.x509,k=T.AlgorithmIdentifier,O=l.ocsp;O.DEFAULT_HASH;var F=c.crypto,U=F.Util.hashHex,L=st,P=Me,D=P.getVbyList;O.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(A,N,j,W){W==null&&(W=this.DEFAULT_HASH),this.params={alg:W,issname:A,isskey:N,sbjsn:j}},this.setByCert=function(A,N,j){j==null&&(j=this.DEFAULT_HASH),this.params={alg:j,issuerCert:A,subjectCert:N}},this.getParamByCerts=function(A,N,j){j==null&&(j=this.DEFAULT_HASH);var W=new L(A),se=new L(N),de=U(W.getSubjectHex(),j),ue=W.getPublicKeyHex(),pe=U(D(ue,0,[1],"03",!0),j),G=se.getSerialNumberHex(),X={alg:j,issname:de,isskey:pe,sbjsn:G};return X},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var A=this.params,N,j,W,se;if(A.alg==null?se=this.DEFAULT_HASH:se=A.alg,A.issuerCert!=null&&A.subjectCert!=null){var de=this.getParamByCerts(A.issuerCert,A.subjectCert,se);N=de.issname,j=de.isskey,W=de.sbjsn}else if(A.issname!=null&&A.isskey!=null&&A.sbjsn!=null)N=A.issname,j=A.isskey,W=A.sbjsn;else throw new Error("required param members not defined");var ue=new k({name:se}),pe=new d({hex:N}),G=new d({hex:j}),X=new v({hex:W}),te=new m({array:[ue,pe,G,X]});return this.hTLV=te.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.CertID,y.asn1.ASN1Object),y.asn1.ocsp.CertStatus=function(s){y.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(c.status=="good")return"8000";if(c.status=="unknown")return"8200";if(c.status=="revoked"){var l=[{gentime:{str:c.time}}];c.reason!=null&&l.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:c.reason}}}});var d={tag:"a1",explicit:!1,obj:{seq:l}};return y.asn1.ASN1Util.newObject({tag:d}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},s!==void 0&&this.setByParam(s)},Re(y.asn1.ocsp.CertStatus,y.asn1.ASN1Object),y.asn1.ocsp.Request=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.ocsp;if(v.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var T=[];if(this.dReqCert===null)throw"reqCert not set";T.push(this.dReqCert);var k=new d({array:T});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof s<"u"){var m=new v.CertID(s);this.dReqCert=m}},Re(y.asn1.ocsp.Request,y.asn1.ASN1Object),y.asn1.ocsp.TBSRequest=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.ocsp;v.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(m){for(var T=[],k=0;k<m.length;k++){var O=new v.Request(m[0]);T.push(O)}this.dRequestList=T},this.tohex=function(){var m=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var T=new d({array:this.dRequestList});if(m.push(T),this.dRequestExt!==null)throw"requestExtensions not supported";var k=new d({array:m});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&s.reqList!==void 0&&this.setRequestListByParam(s.reqList)},Re(y.asn1.ocsp.TBSRequest,y.asn1.ASN1Object),y.asn1.ocsp.OCSPRequest=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.ocsp;if(v.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var T=[];if(this.dTbsRequest!==null)T.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var k=new d({array:T});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&s.reqList!==void 0){var m=new v.TBSRequest(s);this.dTbsRequest=m}},Re(y.asn1.ocsp.OCSPRequest,y.asn1.ASN1Object),y.asn1.ocsp.OCSPUtil={},y.asn1.ocsp.OCSPUtil.getRequestHex=function(s,c,l){var d=y,v=d.asn1,m=v.ocsp;l===void 0&&(l=m.DEFAULT_HASH);var T={alg:l,issuerCert:s,subjectCert:c},k=new m.OCSPRequest({reqList:[T]});return k.tohex()},y.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(s){var c=Me,l=c.getVbyList,d=c.getVbyListEx,v=c.getIdxbyList;c.getIdxbyListEx;var m=c.getV,T={};try{var k=d(s,0,[0],"0a");T.responseStatus=parseInt(k,16)}catch{}if(T.responseStatus!==0)return T;try{var O=v(s,0,[1,0,1,0,0,2,0,1]);s.substr(O,2)==="80"?T.certStatus="good":s.substr(O,2)==="a1"?(T.certStatus="revoked",T.revocationTime=Jt(l(s,O,[0]))):s.substr(O,2)==="82"&&(T.certStatus="unknown")}catch{}try{var F=v(s,0,[1,0,1,0,0,2,0,2]);T.thisUpdate=Jt(m(s,F))}catch{}try{var U=v(s,0,[1,0,1,0,0,2,0,3]);s.substr(U,2)==="a0"&&(T.nextUpdate=Jt(l(s,U,[0])))}catch{}return T},y.asn1.ocsp.OCSPParser=function(){var s=Error,c=st,l=new c,d=Me,v=d.getV,m=d.getTLV,T=d.getIdxbyList,k=d.getVbyList,O=d.getTLVbyList,F=d.getVbyListEx,U=d.getTLVbyListEx,L=d.getChildIdx;this.getOCSPRequest=function(P){var D=L(P,0);if(D.length!=1&&D.length!=2)throw new s("wrong number elements: "+D.length);var A=this.getTBSRequest(m(P,D[0]));return A},this.getTBSRequest=function(P){var D={},A=U(P,0,[0],"30");D.array=this.getRequestList(A);var N=U(P,0,["[2]",0],"30");return N!=null&&(D.ext=l.getExtParamArray(N)),D},this.getRequestList=function(P){for(var D=[],A=L(P,0),N=0;N<A.length;N++){var P=m(P,A[N]);D.push(this.getRequest(P))}return D},this.getRequest=function(P){var D=L(P,0);if(D.length!=1&&D.length!=2)throw new s("wrong number elements: "+D.length);var A=this.getCertID(m(P,D[0]));if(D.length==2){var N=T(P,0,[1,0]);A.ext=l.getExtParamArray(m(P,N))}return A},this.getCertID=function(P){var D=L(P,0);if(D.length!=4)throw new s("wrong number elements: "+D.length);var A=new c,N={};return N.alg=A.getAlgorithmIdentifierName(m(P,D[0])),N.issname=v(P,D[1]),N.isskey=v(P,D[2]),N.sbjsn=v(P,D[3]),N},this.getOCSPResponse=function(P){var D=L(P,0),A,N=v(P,D[0]),j=parseInt(N);if(D.length==1)return{resstatus:j};var W=O(P,0,[1,0]);return A=this.getResponseBytes(W),A.resstatus=j,A},this.getResponseBytes=function(P){var D=L(P,0),A,N=O(P,0,[1,0]);A=this.getBasicOCSPResponse(N);var j=v(P,D[0]);return A.restype=y.asn1.x509.OID.oid2name(Zl(j)),A},this.getBasicOCSPResponse=function(P){var D=L(P,0),A;A=this.getResponseData(m(P,D[0]));var N=new st;A.alg=N.getAlgorithmIdentifierName(m(P,D[1]));var j=v(P,D[2]);A.sighex=j.substr(2);var W=F(P,0,["[0]"]);if(W!=null){for(var se=L(W,0),de=[],ue=0;ue<se.length;ue++){var pe=m(W,se[ue]);de.push(pe)}A.certs=de}return A},this.getResponseData=function(P){var D=L(P,0),A=D.length,N={},j=0;P.substr(D[0],2)=="a0"&&j++,N.respid=this.getResponderID(m(P,D[j++]));var W=v(P,D[j++]);if(N.prodat=Jt(W),N.array=this.getSingleResponseList(m(P,D[j++])),P.substr(D[A-1],2)=="a1"){var se=O(P,D[A-1],[0]),de=new st;N.ext=de.getExtParamArray(se)}return N},this.getResponderID=function(P){var D={};if(P.substr(0,2)=="a2"){var A=k(P,0,[0]);D.key=A}if(P.substr(0,2)=="a1"){var N=O(P,0,[0]),j=new st;D.name=j.getX500Name(N)}return D},this.getSingleResponseList=function(P){for(var D=L(P,0),A=[],N=0;N<D.length;N++){var j=this.getSingleResponse(m(P,D[N]));A.push(j)}return A},this.getSingleResponse=function(P){var D=L(P,0),A={},N=this.getCertID(m(P,D[0]));A.certid=N;var j=this.getCertStatus(m(P,D[1]));if(A.status=j,P.substr(D[2],2)=="18"){var W=v(P,D[2]);A.thisupdate=Jt(W)}for(var se=3;se<D.length;se++){if(P.substr(D[se],2)=="a0"){var de=k(P,D[se],[0],"18");A.nextupdate=Jt(de)}if(P.substr(D[se],2)=="a1"){var ue=new st,pe=O(P,0,[se,0]);A.ext=ue.getExtParamArray(pe)}}return A},this.getCertStatus=function(P){var D={};if(P=="8000")return{status:"good"};if(P=="8200")return{status:"unknown"};if(P.substr(0,2)=="a1"){D.status="revoked";var A=k(P,0,[0]),N=Jt(A);D.time=N}return D}};var y;(typeof y>"u"||!y)&&(y={}),(typeof y.lang>"u"||!y.lang)&&(y.lang={}),y.lang.String=function(){};function _g(s){for(var c=new Array,l=0;l<s.length;l++)c[l]=s.charCodeAt(l);return c}function bg(s){for(var c="",l=0;l<s.length;l++)c=c+String.fromCharCode(s[l]);return c}function ql(s){for(var c="",l=0;l<s.length;l++){var d=s[l].toString(16);d.length==1&&(d="0"+d),c=c+d}return c}function Ir(s){return ql(_g(s))}function I2(s){return p(Ir(s))}function F2(s){return Qa(p(Ir(s)))}function D2(s){return bg(g(rc(s)))}function Qa(s){return s=s.replace(/\=/g,""),s=s.replace(/\+/g,"-"),s=s.replace(/\//g,"_"),s}function rc(s){return s.length%4==2?s=s+"==":s.length%4==3&&(s=s+"="),s=s.replace(/-/g,"+"),s=s.replace(/_/g,"/"),s}function Hn(s){return s.length%2==1&&(s="0"+s),Qa(p(s))}function an(s){return h(rc(s))}var ic,gi;typeof Buffer=="function"?(ic=function(s){return Qa(Buffer.from(s,"utf8").toString("base64"))},gi=function(s){return Buffer.from(rc(s),"base64").toString("utf8")}):(ic=function(s){return Hn($l(Jl(s)))},gi=function(s){return decodeURIComponent(Wl(an(s)))});function N2(s){return p($l(Jl(s)))}function O2(s){return decodeURIComponent(Wl(h(s)))}function zl(s){return $l(Jl(s)).toLowerCase()}function Jt(s){try{return decodeURIComponent(Wl(s))}catch{return null}}function M2(s){return Jt(L2(s))}function L2(s){for(var c=s.match(/.{1,2}/g),l=[],d=0;d<c.length;d++){var v=parseInt(c[d],16);161<=v&&v<=191?(l.push("c2"),l.push(c[d])):192<=v&&v<=255?(l.push("c3"),l.push((v-64).toString(16))):l.push(c[d])}return l.join("")}function Fr(s){for(var c="",l=0;l<s.length-1;l+=2)c+=String.fromCharCode(parseInt(s.substr(l,2),16));return c}function qi(s){for(var c="",l=0;l<s.length;l++)c+=("0"+s.charCodeAt(l).toString(16)).slice(-2);return c}function Hh(s){return p(s)}function j2(s){return Kl(Hh(s),64)}function Kl(s,c){return s=s.replace(new RegExp("(.{"+c+"})","g"),`$1\r
`),s=s.replace(/\s+$/,""),s}function Sg(s){var c=s.replace(/[^0-9A-Za-z\/+=]*/g,""),l=h(c);return l}function B2(s,c){return"-----BEGIN "+c+`-----\r
`+Kl(s,64)+`\r
-----END `+c+`-----\r
`}function sr(s,c){return"-----BEGIN "+c+`-----\r
`+Kl(Hh(s),64)+`\r
-----END `+c+`-----\r
`}function Cn(s,c){if(s.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return c!==void 0?(s=s.replace(new RegExp("^[^]*-----BEGIN "+c+"-----"),""),s=s.replace(new RegExp("-----END "+c+"-----[^]*$"),"")):(s=s.replace(/^[^]*-----BEGIN [^-]+-----/,""),s=s.replace(/-----END [^-]+-----[^]*$/,"")),Sg(s)}function U2(s){return s.indexOf("-----BEGIN ")==-1||s.indexOf("-----END ")==-1?null:(s=s.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),s=s.replace(/-----END [\s\S]+$/m,""),s=s.replace(/\s+/g,""),s.match(/^[0-9a-zA-Z+/=]+$/)?s:null)}function H2(s){if(s.length%2!=0)throw"input is not even length";if(s.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var c=new ArrayBuffer(s.length/2),l=new DataView(c),d=0;d<s.length/2;d++)l.setUint8(d,parseInt(s.substr(d*2,2),16));return c}function V2(s){for(var c="",l=new DataView(s),d=0;d<s.byteLength;d++)c+=("00"+l.getUint8(d).toString(16)).slice(-2);return c}function Vh(s){var c,l,d,v,m,T,k,O,F,U;if(s=xg(s),U=s.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),U)return c=parseInt(U[1]),l=parseInt(U[2])-1,d=parseInt(U[3]),v=parseInt(U[4]),m=parseInt(U[5]),T=parseInt(U[6]),k=0,O=U[7],O!==""&&(F=(O.substr(1)+"00").substr(0,3),k=parseInt(F)),Date.UTC(c,l,d,v,m,T,k);throw new Error("unsupported zulu format: "+s)}function q2(s){var c=new Date(s),l=("0000"+c.getUTCFullYear()).slice(-4),d=("00"+(c.getUTCMonth()+1)).slice(-2),v=("00"+c.getUTCDate()).slice(-2),m=("00"+c.getUTCHours()).slice(-2),T=("00"+c.getUTCMinutes()).slice(-2),k=("00"+c.getUTCSeconds()).slice(-2),O=("000"+c.getUTCMilliseconds()).slice(-3);return O=O.replace(/0+$/,""),O=O!=""?"."+O:O,l+d+v+m+T+k+O+"Z"}function wg(s){return Math.round(Vh(s)/1e3)}function z2(s){return new Date(Vh(s))}function K2(s,c,l){var d,v=s.getUTCFullYear();if(c){if(v<1950||2049<v)throw"not proper year for UTCTime: "+v;d=(""+v).slice(-2)}else d=("000"+v).slice(-4);if(d+=("0"+(s.getUTCMonth()+1)).slice(-2),d+=("0"+s.getUTCDate()).slice(-2),d+=("0"+s.getUTCHours()).slice(-2),d+=("0"+s.getUTCMinutes()).slice(-2),d+=("0"+s.getUTCSeconds()).slice(-2),l){var m=s.getUTCMilliseconds();m!==0&&(m=("00"+m).slice(-3),m=m.replace(/0+$/g,""),d+="."+m)}return d+="Z",d}function xg(s){return s.match(/^[0-9]{12}Z$/)||s.match(/^[0-9]{12}[.][0-9]*Z$/)?s.match(/^[0-4]/)?"20"+s:"19"+s:s}function $l(s){return s.replace(/%/g,"")}function Wl(s){return s.replace(/(..)/g,"%$1")}function qh(s){var c="malformed IPv6 address";if(!s.match(/^[0-9A-Fa-f:]+$/))throw c;s=s.toLowerCase();var l=s.split(":").length-1;if(l<2)throw c;var d=":".repeat(7-l+2);s=s.replace("::",d);var v=s.split(":");if(v.length!=8)throw c;for(var m=0;m<8;m++)v[m]=("0000"+v[m]).slice(-4);return v.join("")}function zh(s){if(!s.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+s);s=s.toLowerCase();var c=s.match(/.{1,4}/g);c=c.map(function(v){return v.replace(/^0+/,"")}),c=c.map(function(v){return v==""?"0":v}),s=":"+c.join(":")+":";var l=s.match(/:(0:){2,}/g);if(l==null)return s.slice(1,-1);var d=l.sort().slice(-1)[0];return s=s.replace(d.substr(0,d.length-1),":"),s.substr(0,2)!="::"&&(s=s.substr(1)),s.substr(-2,2)!="::"&&(s=s.substr(0,s.length-1)),s}function Gl(s){var c=new Error("malformed hex value");if(!s.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw c;if(s.length==8){var l;try{return l=parseInt(s.substr(0,2),16)+"."+parseInt(s.substr(2,2),16)+"."+parseInt(s.substr(4,2),16)+"."+parseInt(s.substr(6,2),16),l}catch{throw c}}else if(s.length==16)try{return Gl(s.substr(0,8))+"/"+Cg(s.substr(8))}catch{throw c}else{if(s.length==32)return zh(s);if(s.length==64){try{return zh(s.substr(0,32))+"/"+Cg(s.substr(32))}catch{throw c}return}else return s}}function Cg(s){var c=new Error("malformed mask"),l;try{l=new _(s,16).toString(2)}catch{throw c}if(!l.match(/^1*0*$/))throw c;return l.replace(/0+$/,"").length}function Kh(s){var c=new Error("malformed IP address");if(s=s.toLowerCase(s),!s.match(/^[0-9a-f.:/]+$/))throw c;if(s.match(/^[0-9.]+$/)){var l=s.split(".");if(l.length!==4)throw c;var d="";try{for(var v=0;v<4;v++){var m=parseInt(l[v]);d+=("0"+m.toString(16)).slice(-2)}return d}catch{throw c}}else if(s.match(/^[0-9.]+\/[0-9]+$/)){var T=s.split("/");return Kh(T[0])+Eg(parseInt(T[1]),32)}else{if(s.match(/^[0-9a-f:]+$/)&&s.indexOf(":")!==-1)return qh(s);if(s.match(/^[0-9a-f:]+\/[0-9]+$/)&&s.indexOf(":")!==-1){var T=s.split("/");return qh(T[0])+Eg(parseInt(T[1]),128)}else throw c}}function Eg(s,c){if(c==32&&s==0)return"00000000";if(c==128&&s==0)return"00000000000000000000000000000000";var l=Array(s+1).join("1")+Array(c-s+1).join("0");return new _(l,2).toString(16)}function $h(s){function c(v){var m=parseInt(v.substr(0,2),16),T=parseInt(v.substr(2),16);if(m==0&T<128)return String.fromCharCode(T);if(m<8){var k=192|(m&7)<<3|(T&192)>>6,O=128|T&63;return Jt(k.toString(16)+O.toString(16))}var k=224|(m&240)>>4,O=128|(m&15)<<2|(T&192)>>6,F=128|T&63;return Jt(k.toString(16)+O.toString(16)+F.toString(16))}var l=s.match(/.{4}/g),d=l.map(c);return d.join("")}function Jl(s){for(var c=encodeURIComponent(s),l="",d=0;d<c.length;d++)c[d]=="%"?(l=l+c.substr(d,3),d=d+2):l=l+"%"+Ir(c[d]);return l}function $2(s){return s=s.replace(/\r\n/mg,`
`),s}function W2(s){return s=s.replace(/\r\n/mg,`
`),s=s.replace(/\n/mg,`\r
`),s}y.lang.String.isInteger=function(s){return s.match(/^[0-9]+$/)?!0:!!s.match(/^-[0-9]+$/)},y.lang.String.isHex=function(s){return Pg(s)};function Pg(s){return!!(s.length%2==0&&(s.match(/^[0-9a-f]+$/)||s.match(/^[0-9A-F]+$/)))}y.lang.String.isBase64=function(s){return s=s.replace(/\s+/g,""),!!(s.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&s.length%4==0)},y.lang.String.isBase64URL=function(s){return s.match(/[+/=]/)?!1:(s=rc(s),y.lang.String.isBase64(s))};function Wh(s){return!!s.match(/^[0-9A-Za-z-_.]+$/)}y.lang.String.isIntegerArray=function(s){return s=s.replace(/\s+/g,""),!!s.match(/^\[[0-9,]+\]$/)},y.lang.String.isPrintable=function(s){return s.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},y.lang.String.isIA5=function(s){return s.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},y.lang.String.isMail=function(s){return s.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function Gh(s){return s.length%2==1?"0"+s:s.substr(0,1)>"7"?"00"+s:s}function G2(s){s=s.replace(/^\s*\[\s*/,""),s=s.replace(/\s*\]\s*$/,""),s=s.replace(/\s*/g,"");try{var c=s.split(/,/).map(function(l,d,v){var m=parseInt(l);if(m<0||255<m)throw"integer not in range 0-255";var T=("00"+m.toString(16)).slice(-2);return T}).join("");return c}catch(l){throw"malformed integer array string: "+l}}var J2=function(s,c){var l=s.length;s.length>c.length&&(l=c.length);for(var d=0;d<l;d++)if(s.charCodeAt(d)!=c.charCodeAt(d))return d;return s.length!=c.length?l:-1};function kg(s){var c=function(k){var O=k.toString(16);return O.length==1&&(O="0"+O),O},l=function(k){var O="",F=parseInt(k,10),U=F.toString(2),L=7-U.length%7;L==7&&(L=0);for(var P="",D=0;D<L;D++)P+="0";U=P+U;for(var D=0;D<U.length-1;D+=7){var A=U.substr(D,7);D!=U.length-7&&(A="1"+A),O+=c(parseInt(A,2))}return O};try{if(!s.match(/^[0-9.]+$/))return null;var d="",v=s.split("."),m=parseInt(v[0],10)*40+parseInt(v[1],10);d+=c(m),v.splice(0,2);for(var T=0;T<v.length;T++)d+=l(v[T]);return d}catch{return null}}function Zl(s){if(!Pg(s))return null;try{var c=[],l=s.substr(0,2),d=parseInt(l,16);c[0]=new String(Math.floor(d/40)),c[1]=new String(d%40);for(var v=s.substr(2),m=[],T=0;T<v.length/2;T++)m.push(parseInt(v.substr(T*2,2),16));for(var k=[],O="",T=0;T<m.length;T++)m[T]&128?O=O+Xl((m[T]&127).toString(2),7):(O=O+Xl((m[T]&127).toString(2),7),k.push(new String(parseInt(O,2))),O="");var F=c.join(".");return k.length>0&&(F=F+"."+k.join(".")),F}catch{return null}}function Tg(s){var c=new _(String(s),10);return sc(c)}function sc(s){var c=s.toString(16);if(c.substr(0,1)!="-")return c.length%2==1?c="0"+c:c.match(/^[0-7]/)||(c="00"+c),c;var l=c.substr(1),d=l.length;d%2==1?d+=1:c.match(/^[0-7]/)||(d+=2);for(var v="",m=0;m<d;m++)v+="f";var T=new _(v,16),k=T.xor(s).add(_.ONE);return c=k.toString(16).replace(/^-/,""),c}var Xl=function(s,c,l){return l==null&&(l="0"),s.length>=c?s:new Array(c-s.length+1).join(l)+s};function Rg(s){if(s.length%2!=0||(s=s.toLowerCase(),s.match(/^[0-9a-f]+$/)==null))return-1;try{var c=s.substr(0,2);if(c=="00")return parseInt(s.substr(2),16);var l=parseInt(c,16);if(l>7)return-1;var d=s.substr(2),v=parseInt(d,16).toString(2);v=="0"&&(v="00000000"),v=v.slice(0,0-l);var m=parseInt(v,2);return m==NaN?-1:m}catch{return-1}}function Ag(s){if(typeof s!="number"||s<0)return null;var c=Number(s).toString(2),l=8-c.length%8;l==8&&(l=0),c=c+Xl("",l,"0");var d=parseInt(c,2).toString(16);d.length%2==1&&(d="0"+d);var v="0"+l;return v+d}function Ig(s){if(typeof s!="string"||s.length%2!=0||!s.match(/^[0-9a-f]+$/))return null;try{var c=parseInt(s.substr(0,2),16);if(c<0||7<c)return null;for(var l=s.substr(2),d="",v=0;v<l.length;v+=2){var m=l.substr(v,2),T=parseInt(m,16).toString(2);T=("0000000"+T).slice(-8),d+=T}return d.substr(0,d.length-c)}catch{return null}}function Z2(s){if(typeof s!="string"||s.match(/^[01]+$/)==null)return null;try{var c=parseInt(s,2);return Ag(c)}catch{return null}}function Ql(s,c){for(var l=0,d=0;d<s.length;d++)l|=1<<c[s[d]];for(var v=l.toString(2),m="",d=v.length-1;d>=0;d--)m+=v[d];return m}function Yt(s,d,l){if(typeof s=="object"){for(var d=String(d).split("."),v=0;v<d.length&&s;v++){var m=d[v];m.match(/^[0-9]+$/)&&(m=parseInt(m)),s=s[m]}return s||s===!1?s:l}}function Re(s,c){var l=function(){};l.prototype=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.superclass=c.prototype,c.prototype.constructor==Object.prototype.constructor&&(c.prototype.constructor=c)}(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:a.algo.MD5,sha1:a.algo.SHA1,sha224:a.algo.SHA224,sha256:a.algo.SHA256,sha384:a.algo.SHA384,sha512:a.algo.SHA512,ripemd160:a.algo.RIPEMD160},this.getDigestInfoHex=function(s,c){if(typeof this.DIGESTINFOHEAD[c]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+c;return this.DIGESTINFOHEAD[c]+s},this.getPaddedDigestInfoHex=function(s,c,l){var d=this.getDigestInfoHex(s,c),v=l/4;if(d.length+22>v)throw"key is too short for SigAlg: keylen="+l+","+c;for(var m="0001",T="00"+d,k="",O=v-m.length-T.length,F=0;F<O;F+=2)k+="ff";var U=m+k+T;return U},this.hashString=function(s,c){var l=new y.crypto.MessageDigest({alg:c});return l.digestString(s)},this.hashHex=function(s,c){var l=new y.crypto.MessageDigest({alg:c});return l.digestHex(s)},this.sha1=function(s){return this.hashString(s,"sha1")},this.sha256=function(s){return this.hashString(s,"sha256")},this.sha256Hex=function(s){return this.hashHex(s,"sha256")},this.sha512=function(s){return this.hashString(s,"sha512")},this.sha512Hex=function(s){return this.hashHex(s,"sha512")},this.isKey=function(s){return s instanceof we||s instanceof y.crypto.DSA||s instanceof y.crypto.ECDSA}},y.crypto.Util.md5=function(s){var c=new y.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return c.digestString(s)},y.crypto.Util.ripemd160=function(s){var c=new y.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return c.digestString(s)},y.crypto.Util.SECURERANDOMGEN=new ae,y.crypto.Util.getRandomHexOfNbytes=function(s){var c=new Array(s);return y.crypto.Util.SECURERANDOMGEN.nextBytes(c),ql(c)},y.crypto.Util.getRandomBigIntegerOfNbytes=function(s){return new _(y.crypto.Util.getRandomHexOfNbytes(s),16)},y.crypto.Util.getRandomHexOfNbits=function(s){var c=s%8,l=(s-c)/8,d=new Array(l+1);return y.crypto.Util.SECURERANDOMGEN.nextBytes(d),d[0]=(255<<c&255^255)&d[0],ql(d)},y.crypto.Util.getRandomBigIntegerOfNbits=function(s){return new _(y.crypto.Util.getRandomHexOfNbits(s),16)},y.crypto.Util.getRandomBigIntegerZeroToMax=function(s){for(var c=s.bitLength();;){var l=y.crypto.Util.getRandomBigIntegerOfNbits(c);if(s.compareTo(l)!=-1)return l}},y.crypto.Util.getRandomBigIntegerMinToMax=function(s,c){var l=s.compareTo(c);if(l==1)throw"biMin is greater than biMax";if(l==0)return s;var d=c.subtract(s),v=y.crypto.Util.getRandomBigIntegerZeroToMax(d);return v.add(s)},y.crypto.MessageDigest=function(s){this.setAlgAndProvider=function(c,l){if(c=y.crypto.MessageDigest.getCanonicalAlgName(c),c!==null&&l===void 0&&(l=y.crypto.Util.DEFAULTPROVIDER[c]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)!=-1&&l=="cryptojs"){try{this.md=y.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c].create()}catch(d){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+d}this.updateString=function(d){this.md.update(d)},this.updateHex=function(d){var v=a.enc.Hex.parse(d);this.md.update(v)},this.digest=function(){var d=this.md.finalize();return d.toString(a.enc.Hex)},this.digestString=function(d){return this.updateString(d),this.digest()},this.digestHex=function(d){return this.updateHex(d),this.digest()}}if(":sha256:".indexOf(c)!=-1&&l=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(d){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+d}this.updateString=function(d){this.md.update(d)},this.updateHex=function(d){var v=sjcl.codec.hex.toBits(d);this.md.update(v)},this.digest=function(){var d=this.md.finalize();return sjcl.codec.hex.fromBits(d)},this.digestString=function(d){return this.updateString(d),this.digest()},this.digestHex=function(d){return this.updateHex(d),this.digest()}}},this.updateString=function(c){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(c){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(c){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},s!==void 0&&s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0&&(this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},y.crypto.MessageDigest.getCanonicalAlgName=function(s){return typeof s=="string"&&(s=s.toLowerCase(),s=s.replace(/-/,"")),s},y.crypto.MessageDigest.getHashLength=function(s){var c=y.crypto.MessageDigest,l=c.getCanonicalAlgName(s);if(c.HASHLENGTH[l]===void 0)throw"not supported algorithm: "+s;return c.HASHLENGTH[l]},y.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},y.crypto.Mac=function(s){this.setAlgAndProvider=function(c,l){if(c=c.toLowerCase(),c==null&&(c="hmacsha1"),c=c.toLowerCase(),c.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+c;l===void 0&&(l=y.crypto.Util.DEFAULTPROVIDER[c]),this.algProv=c+"/"+l;var d=c.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(d)!=-1&&l=="cryptojs"){try{var v=y.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[d];this.mac=a.algo.HMAC.create(v,this.pass)}catch(m){throw"setAlgAndProvider hash alg set fail hashAlg="+d+"/"+m}this.updateString=function(m){this.mac.update(m)},this.updateHex=function(m){var T=a.enc.Hex.parse(m);this.mac.update(T)},this.doFinal=function(){var m=this.mac.finalize();return m.toString(a.enc.Hex)},this.doFinalString=function(m){return this.updateString(m),this.doFinal()},this.doFinalHex=function(m){return this.updateHex(m),this.doFinal()}}},this.updateString=function(c){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(c){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(c){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(c){if(typeof c=="string"){var l=c;(c.length%2==1||!c.match(/^[0-9A-Fa-f]+$/))&&(l=qi(c)),this.pass=a.enc.Hex.parse(l);return}if(typeof c!="object")throw"KJUR.crypto.Mac unsupported password type: "+c;var l=null;if(c.hex!==void 0){if(c.hex.length%2!=0||!c.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+c.hex;l=c.hex}if(c.utf8!==void 0&&(l=zl(c.utf8)),c.rstr!==void 0&&(l=qi(c.rstr)),c.b64!==void 0&&(l=h(c.b64)),c.b64u!==void 0&&(l=an(c.b64u)),l==null)throw"KJUR.crypto.Mac unsupported password type: "+c;this.pass=a.enc.Hex.parse(l)},s!==void 0&&(s.pass!==void 0&&this.setPassword(s.pass),s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0&&(this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},y.crypto.Signature=function(s){var c=null;if(this._setAlgNames=function(){var l=this.algName.match(/^(.+)with(.+)$/);l&&(this.mdAlgName=l[1].toLowerCase(),this.pubkeyAlgName=l[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(l,d){for(var v="",m=d/4-l.length,T=0;T<m;T++)v=v+"0";return v+l},this.setAlgAndProvider=function(l,d){if(this._setAlgNames(),d!="cryptojs/jsrsa")throw new Error("provider not supported: "+d);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new y.crypto.MessageDigest({alg:this.mdAlgName})}catch(v){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+v)}this.init=function(v,m){var T=null;try{m===void 0?T=It.getKey(v):T=It.getKey(v,m)}catch(k){throw"init failed:"+k}if(T.isPrivate===!0)this.prvKey=T,this.state="SIGN";else if(T.isPublic===!0)this.pubKey=T,this.state="VERIFY";else throw"init failed.:"+T},this.updateString=function(v){this.md.updateString(v)},this.updateHex=function(v){this.md.updateHex(v)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&y.crypto.ECDSA!==void 0&&(this.prvKey=new y.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof we&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof we&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof y.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof y.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(v){return this.updateString(v),this.sign()},this.signHex=function(v){return this.updateHex(v),this.sign()},this.verify=function(v){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&y.crypto.ECDSA!==void 0&&(this.pubKey=new y.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof we&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,v,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof we&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,v);if(y.crypto.ECDSA!==void 0&&this.pubKey instanceof y.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,v);if(y.crypto.DSA!==void 0&&this.pubKey instanceof y.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,v);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(l,d){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(l){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(l){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(l){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(l){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(l){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=s,s!==void 0&&(s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0?this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=s.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),s.psssaltlen!==void 0&&(this.pssSaltLen=s.psssaltlen),s.prvkeypem!==void 0)){if(s.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var c=It.getKey(s.prvkeypem);this.init(c)}catch(l){throw"fatal error to load pem private key: "+l}}},y.crypto.Cipher=function(s){},y.crypto.Cipher.encrypt=function(s,c,l,d){if(Yt(d,"enclag")!=null&&(l=d.encalg),typeof l=="string"&&l.substr(-4)=="-CBC"){var v=c,m=s;Yt(d,"key")!=null&&(v=d.key),Yt(d,"enc")!=null&&(hEnc=d.enc);var T=a.enc.Hex.parse(v),k=a.enc.Hex.parse(m),O=a.enc.Hex.parse(d.iv),F;if(l=="des-EDE3-CBC")F=a.TripleDES.encrypt(k,T,{iv:O});else if(l=="aes128-CBC"||l=="aes256-CBC")F=a.AES.encrypt(k,T,{iv:O});else throw new Error("unsupported algorithm: "+l);return F+""}else throw new Error("Cipher.encrypt: unsupported key or algorithm")},y.crypto.Cipher.decrypt=function(s,c,l,d){if(Yt(d,"enclag")!=null&&(l=d.encalg),typeof l=="string"&&l.substr(-4)=="-CBC"){var v=c,m=s;Yt(d,"key")!=null&&(v=d.key),Yt(d,"enc")!=null&&(m=d.enc);var T=a.enc.Hex.parse(v),k=a.enc.Hex.parse(m),O=a.enc.Hex.parse(d.iv),F;if(l=="des-EDE3-CBC")F=a.TripleDES.decrypt({ciphertext:k},T,{iv:O});else if(l=="aes128-CBC"||l=="aes256-CBC")F=a.AES.decrypt({ciphertext:k},T,{iv:O});else throw new Error("unsupported algorithm: "+l);return a.enc.Hex.stringify(F)}else throw new Error("Cipher.decrypt: unsupported key or algorithm")},y.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.ECDSA=function(s){var c="secp256r1",l=Error,d=_,v=it,m=y.crypto.ECDSA,T=y.crypto.ECParameterDB,k=m.getName,O=Me,F=O.getVbyListEx,U=O.isASN1HEX,L=new ae;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(P){return new d(P.bitLength(),L).mod(P.subtract(d.ONE)).add(d.ONE)},this.setNamedCurve=function(P){this.ecparams=T.getByName(P),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=P},this.setPrivateKeyHex=function(P){this.isPrivate=!0,this.prvKeyHex=P},this.setPublicKeyHex=function(P){this.isPublic=!0,this.pubKeyHex=P},this.getPublicKeyXYHex=function(){var P=this.pubKeyHex;if(P.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var D=this.ecparams.keycharlen;if(P.length!==2+D*2)throw"malformed public key hex length";var A={};return A.x=P.substr(2,D),A.y=P.substr(2+D),A},this.getShortNISTPCurveName=function(){var P=this.curveName;return P==="secp256r1"||P==="NIST P-256"||P==="P-256"||P==="prime256v1"?"P-256":P==="secp384r1"||P==="NIST P-384"||P==="P-384"?"P-384":P==="secp521r1"||P==="NIST P-521"||P==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var P=this.ecparams.n,D=this.getBigRandom(P),A=this.ecparams.keycharlen,N=("0000000000"+D.toString(16)).slice(-A);this.setPrivateKeyHex(N);var j=this.generatePublicKeyHex();return{ecprvhex:N,ecpubhex:j}},this.generatePublicKeyHex=function(){var P=new d(this.prvKeyHex,16),D=this.ecparams.G.multiply(P),A=D.getX().toBigInteger(),N=D.getY().toBigInteger(),j=this.ecparams.keycharlen,W=("0000000000"+A.toString(16)).slice(-j),se=("0000000000"+N.toString(16)).slice(-j),de="04"+W+se;return this.setPublicKeyHex(de),de},this.signWithMessageHash=function(P){return this.signHex(P,this.prvKeyHex)},this.signHex=function(P,D){var A=new d(D,16),N=this.ecparams.n,j=new d(P.substring(0,this.ecparams.keycharlen),16);do var W=this.getBigRandom(N),se=this.ecparams.G,de=se.multiply(W),ue=de.getX().toBigInteger().mod(N);while(ue.compareTo(d.ZERO)<=0);var pe=W.modInverse(N).multiply(j.add(A.multiply(ue))).mod(N);return m.biRSSigToASN1Sig(ue,pe)},this.sign=function(P,D){var A=D,N=this.ecparams.n,j=d.fromByteArrayUnsigned(P);do var W=this.getBigRandom(N),se=this.ecparams.G,de=se.multiply(W),ue=de.getX().toBigInteger().mod(N);while(ue.compareTo(_.ZERO)<=0);var pe=W.modInverse(N).multiply(j.add(A.multiply(ue))).mod(N);return this.serializeSig(ue,pe)},this.verifyWithMessageHash=function(P,D){return this.verifyHex(P,D,this.pubKeyHex)},this.verifyHex=function(P,D,A){try{var N,j,W=m.parseSigHex(D);N=W.r,j=W.s;var se=v.decodeFromHex(this.ecparams.curve,A),de=new d(P.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(de,N,j,se)}catch{return!1}},this.verify=function(P,D,A){var N,j;if(Bitcoin.Util.isArray(D)){var W=this.parseSig(D);N=W.r,j=W.s}else if(typeof D=="object"&&D.r&&D.s)N=D.r,j=D.s;else throw"Invalid value for signature";var se;if(A instanceof it)se=A;else if(Bitcoin.Util.isArray(A))se=v.decodeFrom(this.ecparams.curve,A);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var de=d.fromByteArrayUnsigned(P);return this.verifyRaw(de,N,j,se)},this.verifyRaw=function(P,D,A,N){var j=this.ecparams.n,W=this.ecparams.G;if(D.compareTo(d.ONE)<0||D.compareTo(j)>=0||A.compareTo(d.ONE)<0||A.compareTo(j)>=0)return!1;var se=A.modInverse(j),de=P.multiply(se).mod(j),ue=D.multiply(se).mod(j),pe=W.multiply(de).add(N.multiply(ue)),G=pe.getX().toBigInteger().mod(j);return G.equals(D)},this.serializeSig=function(P,D){var A=P.toByteArraySigned(),N=D.toByteArraySigned(),j=[];return j.push(2),j.push(A.length),j=j.concat(A),j.push(2),j.push(N.length),j=j.concat(N),j.unshift(j.length),j.unshift(48),j},this.parseSig=function(P){var D;if(P[0]!=48)throw new Error("Signature not a valid DERSequence");if(D=2,P[D]!=2)throw new Error("First element in signature must be a DERInteger");var A=P.slice(D+2,D+2+P[D+1]);if(D+=2+P[D+1],P[D]!=2)throw new Error("Second element in signature must be a DERInteger");var N=P.slice(D+2,D+2+P[D+1]);D+=2+P[D+1];var j=d.fromByteArrayUnsigned(A),W=d.fromByteArrayUnsigned(N);return{r:j,s:W}},this.parseSigCompact=function(P){if(P.length!==65)throw"Signature has the wrong length";var D=P[0]-27;if(D<0||D>7)throw"Invalid signature type";var A=this.ecparams.n,N=d.fromByteArrayUnsigned(P.slice(1,33)).mod(A),j=d.fromByteArrayUnsigned(P.slice(33,65)).mod(A);return{r:N,s:j,i:D}},this.readPKCS5PrvKeyHex=function(P){if(U(P)===!1)throw new Error("not ASN.1 hex string");var D,A,N;try{D=F(P,0,["[0]",0],"06"),A=F(P,0,[1],"04");try{N=F(P,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=k(D),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(N),this.setPrivateKeyHex(A),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(P){if(U(P)===!1)throw new l("not ASN.1 hex string");var D,A,N,j;try{D=F(P,0,[1,0],"06"),A=F(P,0,[1,1],"06"),N=F(P,0,[2,0,1],"04");try{j=F(P,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new l("malformed PKCS#8 plain ECC private key")}if(this.curveName=k(A),this.curveName===void 0)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(j),this.setPrivateKeyHex(N),this.isPublic=!1},this.readPKCS8PubKeyHex=function(P){if(U(P)===!1)throw new l("not ASN.1 hex string");var D,A,N;try{D=F(P,0,[0,0],"06"),A=F(P,0,[0,1],"06"),N=F(P,0,[1],"03")}catch{throw new l("malformed PKCS#8 ECC public key")}if(this.curveName=k(A),this.curveName===null)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(N)},this.readCertPubKeyHex=function(P,D){if(U(P)===!1)throw new l("not ASN.1 hex string");var A,N;try{A=F(P,0,[0,5,0,1],"06"),N=F(P,0,[0,5,1],"03")}catch{throw new l("malformed X.509 certificate ECC public key")}if(this.curveName=k(A),this.curveName===null)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(N)},s!==void 0&&s.curve!==void 0&&(this.curveName=s.curve),this.curveName===void 0&&(this.curveName=c),this.setNamedCurve(this.curveName),s!==void 0&&(s.prv!==void 0&&this.setPrivateKeyHex(s.prv),s.pub!==void 0&&this.setPublicKeyHex(s.pub))},y.crypto.ECDSA.parseSigHex=function(s){var c=y.crypto.ECDSA.parseSigHexInHexRS(s),l=new _(c.r,16),d=new _(c.s,16);return{r:l,s:d}},y.crypto.ECDSA.parseSigHexInHexRS=function(s){var c=Me,l=c.getChildIdx,d=c.getV;if(c.checkStrictDER(s,0),s.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var v=l(s,0);if(v.length!=2)throw new Error("signature shall have two elements");var m=v[0],T=v[1];if(s.substr(m,2)!="02")throw new Error("1st item not ASN.1 integer");if(s.substr(T,2)!="02")throw new Error("2nd item not ASN.1 integer");var k=d(s,m),O=d(s,T);return{r:k,s:O}},y.crypto.ECDSA.asn1SigToConcatSig=function(s){var c=y.crypto.ECDSA.parseSigHexInHexRS(s),l=c.r,d=c.s;if(l.length>=130&&l.length<=134){if(l.length%2!=0)throw Error("unknown ECDSA sig r length error");if(d.length%2!=0)throw Error("unknown ECDSA sig s length error");l.substr(0,2)=="00"&&(l=l.substr(2)),d.substr(0,2)=="00"&&(d=d.substr(2));var v=Math.max(l.length,d.length);return l=("000000"+l).slice(-v),d=("000000"+d).slice(-v),l+d}if(l.substr(0,2)=="00"&&l.length%32==2&&(l=l.substr(2)),d.substr(0,2)=="00"&&d.length%32==2&&(d=d.substr(2)),l.length%32==30&&(l="00"+l),d.length%32==30&&(d="00"+d),l.length%32!=0)throw Error("unknown ECDSA sig r length error");if(d.length%32!=0)throw Error("unknown ECDSA sig s length error");return l+d},y.crypto.ECDSA.concatSigToASN1Sig=function(s){if(s.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var c=s.substr(0,s.length/2),l=s.substr(s.length/2);return y.crypto.ECDSA.hexRSSigToASN1Sig(c,l)},y.crypto.ECDSA.hexRSSigToASN1Sig=function(s,c){var l=new _(s,16),d=new _(c,16);return y.crypto.ECDSA.biRSSigToASN1Sig(l,d)},y.crypto.ECDSA.biRSSigToASN1Sig=function(s,c){var l=y.asn1,d=new l.DERInteger({bigint:s}),v=new l.DERInteger({bigint:c}),m=new l.DERSequence({array:[d,v]});return m.tohex()},y.crypto.ECDSA.getName=function(s){return s==="2b8104001f"?"secp192k1":s==="2a8648ce3d030107"?"secp256r1":s==="2b8104000a"?"secp256k1":s==="2b81040021"?"secp224r1":s==="2b81040022"?"secp384r1":s==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(s)!==-1?"secp256r1":"|secp256k1|".indexOf(s)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(s)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(s)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(s)!==-1?"secp521r1":null},(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.ECParameterDB=new function(){var s={},c={};function l(d){return new _(d,16)}this.getByName=function(d){var v=d;if(typeof c[v]<"u"&&(v=c[d]),typeof s[v]<"u")return s[v];throw"unregistered EC curve name: "+v},this.regist=function(d,v,m,T,k,O,F,U,L,P,D,A){s[d]={};var N=l(m),j=l(T),W=l(k),se=l(O),de=l(F),ue=new as(N,j,W),pe=ue.decodePointHex("04"+U+L);s[d].name=d,s[d].keylen=v,s[d].keycharlen=Math.ceil(v/8)*2,s[d].curve=ue,s[d].G=pe,s[d].n=se,s[d].h=de,s[d].oid=D,s[d].info=A;for(var G=0;G<P.length;G++)c[P[G]]=d}},y.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),y.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),y.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),y.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),y.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),y.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),y.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),y.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),y.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),y.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.DSA=function(){var s=Me;s.getVbyList;var c=s.getVbyListEx,l=s.isASN1HEX,d=_;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(v,m,T,k,O){this.isPrivate=!0,this.p=v,this.q=m,this.g=T,this.y=k,this.x=O},this.setPrivateHex=function(v,m,T,k,O){var F,U,L,P,D;F=new _(v,16),U=new _(m,16),L=new _(T,16),typeof k=="string"&&k.length>1?P=new _(k,16):P=null,D=new _(O,16),this.setPrivate(F,U,L,P,D)},this.setPublic=function(v,m,T,k){this.isPublic=!0,this.p=v,this.q=m,this.g=T,this.y=k,this.x=null},this.setPublicHex=function(v,m,T,k){var O,F,U,L;O=new _(v,16),F=new _(m,16),U=new _(T,16),L=new _(k,16),this.setPublic(O,F,U,L)},this.signWithMessageHash=function(v){var m=this.p,T=this.q,k=this.g;this.y;var O=this.x,F=y.crypto.Util.getRandomBigIntegerMinToMax(_.ONE.add(_.ONE),T.subtract(_.ONE)),U=v.substr(0,T.bitLength()/4),L=new _(U,16),P=k.modPow(F,m).mod(T),D=F.modInverse(T).multiply(L.add(O.multiply(P))).mod(T),A=y.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:P}},{int:{bigint:D}}]});return A},this.verifyWithMessageHash=function(v,m){var T=this.p,k=this.q,O=this.g,F=this.y,U=this.parseASN1Signature(m),L=U[0],P=U[1],D=v.substr(0,k.bitLength()/4),A=new _(D,16);if(_.ZERO.compareTo(L)>0||L.compareTo(k)>0||_.ZERO.compareTo(P)>=0||P.compareTo(k)>0)throw"invalid DSA signature";var N=P.modInverse(k),j=A.multiply(N).mod(k),W=L.multiply(N).mod(k),se=O.modPow(j,T).multiply(F.modPow(W,T)).mod(T).mod(k);return se.compareTo(L)==0},this.parseASN1Signature=function(v){try{var m=new d(c(v,0,[0],"02"),16),T=new d(c(v,0,[1],"02"),16);return[m,T]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(v){var m,T,k,O,F;if(l(v)===!1)throw new Error("not ASN.1 hex string");try{m=c(v,0,[1],"02"),T=c(v,0,[2],"02"),k=c(v,0,[3],"02"),O=c(v,0,[4],"02"),F=c(v,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(m,T,k,O,F)},this.readPKCS8PrvKeyHex=function(v){var m,T,k,O;if(l(v)===!1)throw new Error("not ASN.1 hex string");try{m=c(v,0,[1,1,0],"02"),T=c(v,0,[1,1,1],"02"),k=c(v,0,[1,1,2],"02"),O=c(v,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(m,T,k,null,O)},this.readPKCS8PubKeyHex=function(v){var m,T,k,O;if(l(v)===!1)throw new Error("not ASN.1 hex string");try{m=c(v,0,[0,1,0],"02"),T=c(v,0,[0,1,1],"02"),k=c(v,0,[0,1,2],"02"),O=c(v,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(m,T,k,O)},this.readCertPubKeyHex=function(v,m){var T,k,O,F;if(l(v)===!1)throw new Error("not ASN.1 hex string");try{T=c(v,0,[0,5,0,1,0],"02"),k=c(v,0,[0,5,0,1,1],"02"),O=c(v,0,[0,5,0,1,2],"02"),F=c(v,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(T,k,O,F)}};var It=function(){var s=function(A,N,j){return d(a.AES,A,N,j)},c=function(A,N,j){return d(a.TripleDES,A,N,j)},l=function(A,N,j){return d(a.DES,A,N,j)},d=function(A,N,j,W){var se=a.enc.Hex.parse(N),de=a.enc.Hex.parse(j),ue=a.enc.Hex.parse(W),pe={};pe.key=de,pe.iv=ue,pe.ciphertext=se;var G=A.decrypt(pe,de,{iv:ue});return a.enc.Hex.stringify(G)},v=function(A,N,j){return k(a.AES,A,N,j)},m=function(A,N,j){return k(a.TripleDES,A,N,j)},T=function(A,N,j){return k(a.DES,A,N,j)},k=function(A,N,j,W){var se=a.enc.Hex.parse(N),de=a.enc.Hex.parse(j),ue=a.enc.Hex.parse(W),pe=A.encrypt(se,de,{iv:ue}),G=a.enc.Hex.parse(pe.toString()),X=a.enc.Base64.stringify(G);return X},O={"AES-256-CBC":{proc:s,eproc:v,keylen:32,ivlen:16},"AES-192-CBC":{proc:s,eproc:v,keylen:24,ivlen:16},"AES-128-CBC":{proc:s,eproc:v,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:c,eproc:m,keylen:24,ivlen:8},"DES-CBC":{proc:l,eproc:T,keylen:8,ivlen:8}},F=function(A){var N=a.lib.WordArray.random(A),j=a.enc.Hex.stringify(N);return j},U=function(A){var N={},j=A.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));j&&(N.cipher=j[1],N.ivsalt=j[2]);var W=A.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));W&&(N.type=W[1]);var se=-1,de=0;A.indexOf(`\r
\r
`)!=-1&&(se=A.indexOf(`\r
\r
`),de=2),A.indexOf(`

`)!=-1&&(se=A.indexOf(`

`),de=1);var ue=A.indexOf("-----END");if(se!=-1&&ue!=-1){var pe=A.substring(se+de*2,ue-de);pe=pe.replace(/\s+/g,""),N.data=pe}return N},L=function(A,N,j){for(var W=j.substring(0,16),se=a.enc.Hex.parse(W),de=a.enc.Utf8.parse(N),ue=O[A].keylen+O[A].ivlen,pe="",G=null;;){var X=a.algo.MD5.create();if(G!=null&&X.update(G),X.update(de),X.update(se),G=X.finalize(),pe=pe+a.enc.Hex.stringify(G),pe.length>=ue*2)break}var te={};return te.keyhex=pe.substr(0,O[A].keylen*2),te.ivhex=pe.substr(O[A].keylen*2,O[A].ivlen*2),te},P=function(A,N,j,W){var se=a.enc.Base64.parse(A),de=a.enc.Hex.stringify(se),ue=O[N].proc,pe=ue(de,j,W);return pe},D=function(A,N,j,W){var se=O[N].eproc,de=se(A,j,W);return de};return{version:"1.0.0",parsePKCS5PEM:function(A){return U(A)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(A,N,j){return L(A,N,j)},decryptKeyB64:function(A,N,j,W){return P(A,N,j,W)},getDecryptedKeyHex:function(A,N){var j=U(A),W=j.cipher,se=j.ivsalt,de=j.data,ue=L(W,N,se),pe=ue.keyhex,G=P(de,W,pe,se);return G},getEncryptedPKCS5PEMFromPrvKeyHex:function(A,N,j,W,se){var J="";if((typeof W>"u"||W==null)&&(W="AES-256-CBC"),typeof O[W]>"u")throw new Error("KEYUTIL unsupported algorithm: "+W);if(typeof se>"u"||se==null){var de=O[W].ivlen,ue=F(de);se=ue.toUpperCase()}var pe=L(W,j,se),G=pe.keyhex,X=D(N,W,G,se),te=X.replace(/(.{64})/g,`$1\r
`),J="-----BEGIN "+A+` PRIVATE KEY-----\r
`;return J+=`Proc-Type: 4,ENCRYPTED\r
`,J+="DEK-Info: "+W+","+se+`\r
`,J+=`\r
`,J+=te,J+=`\r
-----END `+A+` PRIVATE KEY-----\r
`,J},getEncryptedPKCS8PEM:function(A,N,j){var W=this.getEncryptedPKCS8Hex(A,N,j);return sr(W,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(A,N,j){var W;j==null||j==null?W={}:W=JSON.parse(JSON.stringify(j)),W.plain=A,this.initPBES2Param(W),this.encryptPBES2Param(W,N);var se=this.generatePBES2ASN1Param(W);return y.asn1.ASN1Util.newObject(se).tohex()},initPBES2Param:function(A){if(Yt(A,"encalg")==null&&(A.encalg="aes256-CBC"),Yt(A,"iter")==null&&(A.iter=2048),Yt(A,"prf")==null&&(A.prf="hmacWithSHA256"),Yt(A,"salt")==null&&(A.salt=a.enc.Hex.stringify(a.lib.WordArray.random(8))),Yt(A,"enciv")==null){var N;A.encalg=="des-EDE3-CBC"&&(N=8),A.encalg=="aes128-CBC"&&(N=16),A.encalg=="aes256-CBC"&&(N=16),A.enciv=a.enc.Hex.stringify(a.lib.WordArray.random(N))}},encryptPBES2Param:function(A,N){var j=It.getDKFromPBES2Param(A,N);try{var W=y.crypto.Cipher.encrypt(A.plain,j,A.encalg,{iv:A.enciv})}catch{throw new Error("encrypt error: "+A.plain+" "+j+" "+A.encalg+" "+A.enciv)}A.enc=W},generatePBES2ASN1Param:function(A){var N={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:A.salt}},{int:{hex:Tg(A.iter)}}]}]},{seq:[{oid:A.encalg},{octstr:{hex:A.enciv}}]}]}]},{octstr:{hex:A.enc}}]};return A.prf!="hmacWithSHA1"&&N.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:A.prf},{null:""}]}),N},parseHexOfEncryptedPKCS8:function(A){var N=Me,j=N.getChildIdx,W=N.getV,se={},de=j(A,0);if(de.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+de.length);se.ciphertext=W(A,de[1]);var ue=j(A,de[0]);if(ue.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+ue.length);if(W(A,ue[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var pe=j(A,ue[1]);if(ue.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+pe.length);var G=j(A,pe[1]);if(G.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+G.length);if(W(A,G[0])!="2a864886f70d0307")throw"this only supports TripleDES";se.encryptionSchemeAlg="TripleDES",se.encryptionSchemeIV=W(A,G[1]);var X=j(A,pe[0]);if(X.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+X.length);if(W(A,X[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var te=j(A,X[1]);if(te.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+te.length);se.pbkdf2Salt=W(A,te[0]);var J=W(A,te[1]);try{se.pbkdf2Iter=parseInt(J,16)}catch{throw new Error("malformed format pbkdf2Iter: "+J)}return se},getPBKDF2KeyHexFromParam:function(A,N){var j=a.enc.Hex.parse(A.pbkdf2Salt),W=A.pbkdf2Iter,se=a.PBKDF2(N,j,{keySize:192/32,iterations:W}),de=a.enc.Hex.stringify(se);return de},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(A,N){var j=Cn(A,"ENCRYPTED PRIVATE KEY"),W=this.parseHexOfEncryptedPKCS8(j),se=It.getPBKDF2KeyHexFromParam(W,N),de={};de.ciphertext=a.enc.Hex.parse(W.ciphertext);var ue=a.enc.Hex.parse(se),pe=a.enc.Hex.parse(W.encryptionSchemeIV),G=a.TripleDES.decrypt(de,ue,{iv:pe}),X=a.enc.Hex.stringify(G);return X},parsePBES2:function(A){var N=Me.parse(A);if(Yt(N,"seq.0.seq.0.oid")!="pkcs5PBES2"||Yt(N,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var j=Yt(N,"seq.0.seq.1.seq.0.seq.1.seq");if(j==null)throw new Error("PBKDF2 parameter not found");var W=Yt(j,"0.octstr.hex"),se=Yt(j,"1.int.hex"),de=Yt(j,"2.seq.0.oid","hmacWithSHA1"),ue=-1;try{ue=parseInt(se,16)}catch{throw new Error("iter not proper value")}var pe=Yt(N,"seq.0.seq.1.seq.1.seq.0.oid"),G=Yt(N,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),X=Yt(N,"seq.1.octstr.hex");if(pe==null||G==null||X==null)throw new Error("encalg, enciv or enc is undefined");var te={salt:W,iter:ue,prf:de,encalg:pe,enciv:G,enc:X};return te},getDKFromPBES2Param:function(A,N){var j={hmacWithSHA1:a.algo.SHA1,hmacWithSHA224:a.algo.SHA224,hmacWithSHA256:a.algo.SHA256,hmacWithSHA384:a.algo.SHA384,hmacWithSHA512:a.algo.SHA512},W={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},se=j[A.prf];if(se==null)throw new Error("unsupported prf");var de=W[A.encalg];if(de==null)throw new Error("unsupported encalg");var ue=a.enc.Hex.parse(A.salt),pe=A.iter;try{var G=a.PBKDF2(N,ue,{keySize:de,iterations:pe,hasher:se});return a.enc.Hex.stringify(G)}catch(X){throw new Error("PBKDF2 error: "+X+" "+JSON.stringify(A)+" "+N)}},getPlainHexFromEncryptedPKCS8PEM:function(A,N){if(A.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var j=Cn(A),W;try{W=It.parsePBES2(j)}catch(de){throw new Error("malformed PBES2 format: "+de.message)}var se=It.getDKFromPBES2Param(W,N);return y.crypto.Cipher.decrypt(W.enc,se,W.encalg,{iv:W.enciv})},getKeyFromEncryptedPKCS8PEM:function(A,N){var j=this.getPlainHexFromEncryptedPKCS8PEM(A,N),W=this.getKeyFromPlainPrivatePKCS8Hex(j);return W},parsePlainPrivatePKCS8Hex:function(A){var N=Me,j=N.getChildIdx,W=N.getV,se={};if(se.algparam=null,A.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var de=j(A,0);if(de.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(A.substr(de[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var ue=j(A,de[1]);if(ue.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(A.substr(ue[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(se.algoid=W(A,ue[0]),A.substr(ue[1],2)=="06"&&(se.algparam=W(A,ue[1])),A.substr(de[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return se.keyidx=N.getVidx(A,de[2]),se},getKeyFromPlainPrivatePKCS8PEM:function(A){var N=Cn(A,"PRIVATE KEY"),j=this.getKeyFromPlainPrivatePKCS8Hex(N);return j},getKeyFromPlainPrivatePKCS8Hex:function(A){var N=this.parsePlainPrivatePKCS8Hex(A),j;if(N.algoid=="2a864886f70d010101")j=new we;else if(N.algoid=="2a8648ce380401")j=new y.crypto.DSA;else if(N.algoid=="2a8648ce3d0201")j=new y.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return j.readPKCS8PrvKeyHex(A),j},_getKeyFromPublicPKCS8Hex:function(A){var N,j=Me.getVbyList(A,0,[0,0],"06");if(j==="2a864886f70d010101")N=new we;else if(j==="2a8648ce380401")N=new y.crypto.DSA;else if(j==="2a8648ce3d0201")N=new y.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return N.readPKCS8PubKeyHex(A),N},parsePublicRawRSAKeyHex:function(A){var N=Me,j=N.getChildIdx,W=N.getV,se={};if(A.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var de=j(A,0);if(de.length!=2)throw new Error("malformed RSA key(code:002)");if(A.substr(de[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(se.n=W(A,de[0]),A.substr(de[1],2)!="02")throw new Error("malformed RSA key(code:004)");return se.e=W(A,de[1]),se},parsePublicPKCS8Hex:function(A){var N=Me,j=N.getChildIdx,W=N.getV,se={};se.algparam=null;var de=j(A,0);if(de.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+de.length);var ue=de[0];if(A.substr(ue,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var pe=j(A,ue);if(pe.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(A.substr(pe[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(se.algoid=W(A,pe[0]),A.substr(pe[1],2)=="06"?se.algparam=W(A,pe[1]):A.substr(pe[1],2)=="30"&&(se.algparam={},se.algparam.p=N.getVbyList(A,pe[1],[0],"02"),se.algparam.q=N.getVbyList(A,pe[1],[1],"02"),se.algparam.g=N.getVbyList(A,pe[1],[2],"02")),A.substr(de[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return se.key=W(A,de[1]).substr(2),se}}}();It.getKey=function(s,c,l){var d=Me,v=d.getChildIdx;d.getV;var m=d.getVbyList,T=y.crypto,k=T.ECDSA,O=T.DSA,F=we,U=Cn,L=It;if(typeof F<"u"&&s instanceof F||typeof k<"u"&&s instanceof k||typeof O<"u"&&s instanceof O)return s;if(s.curve!==void 0&&s.xy!==void 0&&s.d===void 0)return new k({pub:s.xy,curve:s.curve});if(s.curve!==void 0&&s.d!==void 0)return new k({prv:s.d,curve:s.curve});if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d===void 0){var P=new F;return P.setPublic(s.n,s.e),P}if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p!==void 0&&s.q!==void 0&&s.dp!==void 0&&s.dq!==void 0&&s.co!==void 0&&s.qi===void 0){var P=new F;return P.setPrivateEx(s.n,s.e,s.d,s.p,s.q,s.dp,s.dq,s.co),P}if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p===void 0){var P=new F;return P.setPrivate(s.n,s.e,s.d),P}if(s.p!==void 0&&s.q!==void 0&&s.g!==void 0&&s.y!==void 0&&s.x===void 0){var P=new O;return P.setPublic(s.p,s.q,s.g,s.y),P}if(s.p!==void 0&&s.q!==void 0&&s.g!==void 0&&s.y!==void 0&&s.x!==void 0){var P=new O;return P.setPrivate(s.p,s.q,s.g,s.y,s.x),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d===void 0){var P=new F;return P.setPublic(an(s.n),an(s.e)),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p!==void 0&&s.q!==void 0&&s.dp!==void 0&&s.dq!==void 0&&s.qi!==void 0){var P=new F;return P.setPrivateEx(an(s.n),an(s.e),an(s.d),an(s.p),an(s.q),an(s.dp),an(s.dq),an(s.qi)),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0){var P=new F;return P.setPrivate(an(s.n),an(s.e),an(s.d)),P}if(s.kty==="EC"&&s.crv!==void 0&&s.x!==void 0&&s.y!==void 0&&s.d===void 0){var D=new k({curve:s.crv}),A=D.ecparams.keycharlen,N=("0000000000"+an(s.x)).slice(-A),j=("0000000000"+an(s.y)).slice(-A),W="04"+N+j;return D.setPublicKeyHex(W),D}if(s.kty==="EC"&&s.crv!==void 0&&s.x!==void 0&&s.y!==void 0&&s.d!==void 0){var D=new k({curve:s.crv}),A=D.ecparams.keycharlen,N=("0000000000"+an(s.x)).slice(-A),j=("0000000000"+an(s.y)).slice(-A),W="04"+N+j,se=("0000000000"+an(s.d)).slice(-A);return D.setPublicKeyHex(W),D.setPrivateKeyHex(se),D}if(l==="pkcs5prv"){var de=s,d=Me,ue,P;if(ue=v(de,0),ue.length===9)P=new F,P.readPKCS5PrvKeyHex(de);else if(ue.length===6)P=new O,P.readPKCS5PrvKeyHex(de);else if(ue.length>2&&de.substr(ue[1],2)==="04")P=new k,P.readPKCS5PrvKeyHex(de);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return P}if(l==="pkcs8prv"){var P=L.getKeyFromPlainPrivatePKCS8Hex(s);return P}if(l==="pkcs8pub")return L._getKeyFromPublicPKCS8Hex(s);if(l==="x509pub")return st.getPublicKeyFromCertHex(s);if(s.indexOf("-END CERTIFICATE-",0)!=-1||s.indexOf("-END X509 CERTIFICATE-",0)!=-1||s.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return st.getPublicKeyFromCertPEM(s);if(s.indexOf("-END PUBLIC KEY-")!=-1){var pe=Cn(s,"PUBLIC KEY");return L._getKeyFromPublicPKCS8Hex(pe)}if(s.indexOf("-END RSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var G=U(s,"RSA PRIVATE KEY");return L.getKey(G,null,"pkcs5prv")}if(s.indexOf("-END DSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var X=U(s,"DSA PRIVATE KEY"),te=m(X,0,[1],"02"),J=m(X,0,[2],"02"),re=m(X,0,[3],"02"),he=m(X,0,[4],"02"),ye=m(X,0,[5],"02"),P=new O;return P.setPrivate(new _(te,16),new _(J,16),new _(re,16),new _(he,16),new _(ye,16)),P}if(s.indexOf("-END EC PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var G=U(s,"EC PRIVATE KEY");return L.getKey(G,null,"pkcs5prv")}if(s.indexOf("-END PRIVATE KEY-")!=-1)return L.getKeyFromPlainPrivatePKCS8PEM(s);if(s.indexOf("-END RSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var Ae=L.getDecryptedKeyHex(s,c),ve=new we;return ve.readPKCS5PrvKeyHex(Ae),ve}if(s.indexOf("-END EC PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var X=L.getDecryptedKeyHex(s,c),P=m(X,0,[1],"04"),xe=m(X,0,[2,0],"06"),Fe=m(X,0,[3,0],"03").substr(2),Ne="";if(y.crypto.OID.oidhex2name[xe]!==void 0)Ne=y.crypto.OID.oidhex2name[xe];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+xe);var D=new k({curve:Ne});return D.setPublicKeyHex(Fe),D.setPrivateKeyHex(P),D.isPublic=!1,D}if(s.indexOf("-END DSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var X=L.getDecryptedKeyHex(s,c),te=m(X,0,[1],"02"),J=m(X,0,[2],"02"),re=m(X,0,[3],"02"),he=m(X,0,[4],"02"),ye=m(X,0,[5],"02"),P=new O;return P.setPrivate(new _(te,16),new _(J,16),new _(re,16),new _(he,16),new _(ye,16)),P}if(s.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return L.getKeyFromEncryptedPKCS8PEM(s,c);throw new Error("not supported argument")},It.generateKeypair=function(s,c){if(s=="RSA"){var l=c,d=new we;d.generate(l,"10001"),d.isPrivate=!0,d.isPublic=!0;var v=new we,m=d.n.toString(16),T=d.e.toString(16);v.setPublic(m,T),v.isPrivate=!1,v.isPublic=!0;var k={};return k.prvKeyObj=d,k.pubKeyObj=v,k}else if(s=="EC"){var O=c,F=new y.crypto.ECDSA({curve:O}),U=F.generateKeyPairHex(),d=new y.crypto.ECDSA({curve:O});d.setPublicKeyHex(U.ecpubhex),d.setPrivateKeyHex(U.ecprvhex),d.isPrivate=!0,d.isPublic=!1;var v=new y.crypto.ECDSA({curve:O});v.setPublicKeyHex(U.ecpubhex),v.isPrivate=!1,v.isPublic=!0;var k={};return k.prvKeyObj=d,k.pubKeyObj=v,k}else throw new Error("unknown algorithm: "+s)},It.getPEM=function(s,c,l,d,v,m){var T=y,k=T.asn1,O=k.DERObjectIdentifier,F=k.DERInteger,U=k.ASN1Util.newObject,L=k.x509,P=L.SubjectPublicKeyInfo,D=T.crypto,A=D.DSA,N=D.ECDSA,j=we;function W(xe){var Fe=U({seq:[{int:0},{int:{bigint:xe.n}},{int:xe.e},{int:{bigint:xe.d}},{int:{bigint:xe.p}},{int:{bigint:xe.q}},{int:{bigint:xe.dmp1}},{int:{bigint:xe.dmq1}},{int:{bigint:xe.coeff}}]});return Fe}function se(xe){var Fe=U({seq:[{int:1},{octstr:{hex:xe.prvKeyHex}},{tag:["a0",!0,{oid:{name:xe.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+xe.pubKeyHex}}]}]});return Fe}function de(xe){var Fe=U({seq:[{int:0},{int:{bigint:xe.p}},{int:{bigint:xe.q}},{int:{bigint:xe.g}},{int:{bigint:xe.y}},{int:{bigint:xe.x}}]});return Fe}if((j!==void 0&&s instanceof j||A!==void 0&&s instanceof A||N!==void 0&&s instanceof N)&&s.isPublic==!0&&(c===void 0||c=="PKCS8PUB")){var ue=new P(s),pe=ue.tohex();return sr(pe,"PUBLIC KEY")}if(c=="PKCS1PRV"&&j!==void 0&&s instanceof j&&(l===void 0||l==null)&&s.isPrivate==!0){var ue=W(s),pe=ue.tohex();return sr(pe,"RSA PRIVATE KEY")}if(c=="PKCS1PRV"&&N!==void 0&&s instanceof N&&(l===void 0||l==null)&&s.isPrivate==!0){var G=new O({name:s.curveName}),X=G.tohex(),te=se(s),J=te.tohex(),re="";return re+=sr(X,"EC PARAMETERS"),re+=sr(J,"EC PRIVATE KEY"),re}if(c=="PKCS1PRV"&&A!==void 0&&s instanceof A&&(l===void 0||l==null)&&s.isPrivate==!0){var ue=de(s),pe=ue.tohex();return sr(pe,"DSA PRIVATE KEY")}if(c=="PKCS5PRV"&&j!==void 0&&s instanceof j&&l!==void 0&&l!=null&&s.isPrivate==!0){var ue=W(s),pe=ue.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",pe,l,d,m)}if(c=="PKCS5PRV"&&N!==void 0&&s instanceof N&&l!==void 0&&l!=null&&s.isPrivate==!0){var ue=se(s),pe=ue.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",pe,l,d,m)}if(c=="PKCS5PRV"&&A!==void 0&&s instanceof A&&l!==void 0&&l!=null&&s.isPrivate==!0){var ue=de(s),pe=ue.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",pe,l,d,m)}var he=function(xe,Fe){if(typeof Fe=="string")return It.getEncryptedPKCS8PEM(xe,Fe);if(typeof Fe=="object"&&Yt(Fe,"passcode")!=null){var Ne=JSON.parse(JSON.stringify(Fe)),ar=Ne.passcode;return delete Ne.passcode,It.getEncryptedPKCS8PEM(xe,ar,Ne)}};if(c=="PKCS8PRV"&&j!=null&&s instanceof j&&s.isPrivate==!0){var ye=W(s),Ae=ye.tohex(),ue=U({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:Ae}}]}),pe=ue.tohex();return l===void 0||l==null?sr(pe,"PRIVATE KEY"):he(pe,l)}if(c=="PKCS8PRV"&&N!==void 0&&s instanceof N&&s.isPrivate==!0){var ve={seq:[{int:1},{octstr:{hex:s.prvKeyHex}}]};typeof s.pubKeyHex=="string"&&ve.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+s.pubKeyHex}}]});var ye=new U(ve),Ae=ye.tohex(),ue=U({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:s.curveName}}]},{octstr:{hex:Ae}}]}),pe=ue.tohex();return l===void 0||l==null?sr(pe,"PRIVATE KEY"):he(pe,l)}if(c=="PKCS8PRV"&&A!==void 0&&s instanceof A&&s.isPrivate==!0){var ye=new F({bigint:s.x}),Ae=ye.tohex(),ue=U({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:s.p}},{int:{bigint:s.q}},{int:{bigint:s.g}}]}]},{octstr:{hex:Ae}}]}),pe=ue.tohex();return l===void 0||l==null?sr(pe,"PRIVATE KEY"):he(pe,l)}throw new Error("unsupported object nor format")},It.getKeyFromCSRPEM=function(s){var c=Cn(s,"CERTIFICATE REQUEST"),l=It.getKeyFromCSRHex(c);return l},It.getKeyFromCSRHex=function(s){var c=It.parseCSRHex(s),l=It.getKey(c.p8pubkeyhex,null,"pkcs8pub");return l},It.parseCSRHex=function(s){var c=Me,l=c.getChildIdx,d=c.getTLV,v={},m=s;if(m.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var T=l(m,0);if(T.length<1)throw new Error("malformed CSR(code:002)");if(m.substr(T[0],2)!="30")throw new Error("malformed CSR(code:003)");var k=l(m,T[0]);if(k.length<3)throw new Error("malformed CSR(code:004)");return v.p8pubkeyhex=d(m,k[2]),v},It.getKeyID=function(s){var c=It,l=Me;typeof s=="string"&&s.indexOf("BEGIN ")!=-1&&(s=c.getKey(s));var d=Cn(c.getPEM(s)),v=l.getIdxbyList(d,0,[1]),m=l.getV(d,v).substring(2);return y.crypto.Util.hashHex(m,"sha1")},It.getJWK=function(s,c,l,d,v){var m,T={},k,O=y.crypto.Util.hashHex;if(typeof s=="string")m=It.getKey(s),s.indexOf("CERTIFICATE")!=-1&&(k=Cn(s));else if(typeof s=="object")s instanceof st?(m=s.getPublicKey(),k=s.hex):m=s;else throw new Error("unsupported keyinfo type");if(m instanceof we&&m.isPrivate)T.kty="RSA",T.n=Hn(m.n.toString(16)),T.e=Hn(m.e.toString(16)),T.d=Hn(m.d.toString(16)),T.p=Hn(m.p.toString(16)),T.q=Hn(m.q.toString(16)),T.dp=Hn(m.dmp1.toString(16)),T.dq=Hn(m.dmq1.toString(16)),T.qi=Hn(m.coeff.toString(16));else if(m instanceof we&&m.isPublic)T.kty="RSA",T.n=Hn(m.n.toString(16)),T.e=Hn(m.e.toString(16));else if(m instanceof y.crypto.ECDSA&&m.isPrivate){var F=m.getShortNISTPCurveName();if(F!=="P-256"&&F!=="P-384"&&F!=="P-521")throw new Error("unsupported curve name for JWT: "+F);var U=m.getPublicKeyXYHex();T.kty="EC",T.crv=F,T.x=Hn(U.x),T.y=Hn(U.y),T.d=Hn(m.prvKeyHex)}else if(m instanceof y.crypto.ECDSA&&m.isPublic){var F=m.getShortNISTPCurveName();if(F!=="P-256"&&F!=="P-384"&&F!=="P-521")throw new Error("unsupported curve name for JWT: "+F);var U=m.getPublicKeyXYHex();T.kty="EC",T.crv=F,T.x=Hn(U.x),T.y=Hn(U.y)}if(T.kty==null)throw new Error("unsupported keyinfo");return!m.isPrivate&&c!=!0&&(T.kid=y.jws.JWS.getJWKthumbprint(T)),k!=null&&l!=!0&&(T.x5c=[p(k)]),k!=null&&d!=!0&&(T.x5t=Qa(p(O(k,"sha1")))),k!=null&&v!=!0&&(T["x5t#S256"]=Qa(p(O(k,"sha256")))),T},It.getJWKFromKey=function(s){return It.getJWK(s,!0,!0,!0,!0)},we.getPosArrayOfChildrenFromHex=function(s){return Me.getChildIdx(s,0)},we.getHexValueArrayOfChildrenFromHex=function(s){var c=Me,l=c.getV,P=we.getPosArrayOfChildrenFromHex(s),d=l(s,P[0]),v=l(s,P[1]),m=l(s,P[2]),T=l(s,P[3]),k=l(s,P[4]),O=l(s,P[5]),F=l(s,P[6]),U=l(s,P[7]),L=l(s,P[8]),P=new Array;return P.push(d,v,m,T,k,O,F,U,L),P},we.prototype.readPrivateKeyFromPEMString=function(s){var c=Cn(s),l=we.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8])},we.prototype.readPKCS5PrvKeyHex=function(s){var c=we.getHexValueArrayOfChildrenFromHex(s);this.setPrivateEx(c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])},we.prototype.readPKCS8PrvKeyHex=function(s){var c,l,d,v,m,T,k,O,F=Me,U=F.getVbyListEx;if(F.isASN1HEX(s)===!1)throw new Error("not ASN.1 hex string");try{c=U(s,0,[2,0,1],"02"),l=U(s,0,[2,0,2],"02"),d=U(s,0,[2,0,3],"02"),v=U(s,0,[2,0,4],"02"),m=U(s,0,[2,0,5],"02"),T=U(s,0,[2,0,6],"02"),k=U(s,0,[2,0,7],"02"),O=U(s,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(c,l,d,v,m,T,k,O)},we.prototype.readPKCS5PubKeyHex=function(s){var c=Me,l=c.getV;if(c.isASN1HEX(s)===!1)throw new Error("keyHex is not ASN.1 hex string");var d=c.getChildIdx(s,0);if(d.length!==2||s.substr(d[0],2)!=="02"||s.substr(d[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var v=l(s,d[0]),m=l(s,d[1]);this.setPublic(v,m)},we.prototype.readPKCS8PubKeyHex=function(s){var c=Me;if(c.isASN1HEX(s)===!1)throw new Error("not ASN.1 hex string");if(c.getTLVbyListEx(s,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var l=c.getTLVbyListEx(s,0,[1,0]);this.readPKCS5PubKeyHex(l)},we.prototype.readCertPubKeyHex=function(s,c){var l,d;l=new st,l.readCertHex(s),d=l.getPublicKeyHex(),this.readPKCS8PubKeyHex(d)};function Fg(s,c){for(var l="",d=c/4-s.length,v=0;v<d;v++)l=l+"0";return l+s}we.prototype.sign=function(s,c){var l=function(v){return y.crypto.Util.hashString(v,c)},d=l(s);return this.signWithMessageHash(d,c)},we.prototype.signWithMessageHash=function(s,c){var l=y.crypto.Util.getPaddedDigestInfoHex(s,c,this.n.bitLength()),d=be(l,16),v=this.doPrivate(d),m=v.toString(16);return Fg(m,this.n.bitLength())};function Dg(s,c,l){for(var d="",v=0;d.length<c;)d+=Fr(l(qi(s+String.fromCharCode.apply(String,[(v&4278190080)>>24,(v&16711680)>>16,(v&65280)>>8,v&255])))),v+=1;return d}we.prototype.signPSS=function(s,c,l){var d=function(m){return y.crypto.Util.hashHex(m,c)},v=d(qi(s));return l===void 0&&(l=-1),this.signWithMessageHashPSS(v,c,l)},we.prototype.signWithMessageHashPSS=function(s,c,l){var d=Fr(s),v=d.length,m=this.n.bitLength()-1,T=Math.ceil(m/8),k,O=function(j){return y.crypto.Util.hashHex(j,c)};if(l===-1||l===void 0)l=v;else if(l===-2)l=T-v-2;else if(l<-2)throw new Error("invalid salt length");if(T<v+l+2)throw new Error("data too long");var F="";l>0&&(F=new Array(l),new ae().nextBytes(F),F=String.fromCharCode.apply(String,F));var U=Fr(O(qi("\0\0\0\0\0\0\0\0"+d+F))),L=[];for(k=0;k<T-l-v-2;k+=1)L[k]=0;var P=String.fromCharCode.apply(String,L)+""+F,D=Dg(U,P.length,O),A=[];for(k=0;k<P.length;k+=1)A[k]=P.charCodeAt(k)^D.charCodeAt(k);var N=65280>>8*T-m&255;for(A[0]&=~N,k=0;k<v;k++)A.push(U.charCodeAt(k));return A.push(188),Fg(this.doPrivate(new _(A)).toString(16),this.n.bitLength())};function Ng(s){for(var c in y.crypto.Util.DIGESTINFOHEAD){var l=y.crypto.Util.DIGESTINFOHEAD[c],d=l.length;if(s.substring(0,d)==l){var v=[c,s.substring(d)];return v}}return[]}we.prototype.verify=function(s,c){if(c=c.toLowerCase(),c.match(/^[0-9a-f]+$/)==null)return!1;var l=be(c,16),d=this.n.bitLength();if(l.bitLength()>d)return!1;var v=this.doPublic(l),m=v.toString(16);if(m.length+3!=d/4)return!1;var T=m.replace(/^1f+00/,""),k=Ng(T);if(k.length==0)return!1;var O=k[0],F=k[1],U=function(P){return y.crypto.Util.hashString(P,O)},L=U(s);return F==L},we.prototype.verifyWithMessageHash=function(s,c){if(c.length!=Math.ceil(this.n.bitLength()/4))return!1;var l=be(c,16);if(l.bitLength()>this.n.bitLength())return 0;var d=this.doPublic(l),v=d.toString(16).replace(/^1f+00/,""),m=Ng(v);if(m.length==0)return!1;m[0];var T=m[1];return T==s},we.prototype.verifyPSS=function(s,c,l,d){var v=function(T){return y.crypto.Util.hashHex(T,l)},m=v(qi(s));return d===void 0&&(d=-1),this.verifyWithMessageHashPSS(m,c,l,d)},we.prototype.verifyWithMessageHashPSS=function(s,c,l,d){if(c.length!=Math.ceil(this.n.bitLength()/4))return!1;var v=new _(c,16),m=function(se){return y.crypto.Util.hashHex(se,l)},T=Fr(s),k=T.length,O=this.n.bitLength()-1,F=Math.ceil(O/8),U;if(d===-1||d===void 0)d=k;else if(d===-2)d=F-k-2;else if(d<-2)throw new Error("invalid salt length");if(F<k+d+2)throw new Error("data too long");var L=this.doPublic(v).toByteArray();for(U=0;U<L.length;U+=1)L[U]&=255;for(;L.length<F;)L.unshift(0);if(L[F-1]!==188)throw new Error("encoded message does not end in 0xbc");L=String.fromCharCode.apply(String,L);var P=L.substr(0,F-k-1),D=L.substr(P.length,k),A=65280>>8*F-O&255;if(P.charCodeAt(0)&A)throw new Error("bits beyond keysize not zero");var N=Dg(D,P.length,m),j=[];for(U=0;U<P.length;U+=1)j[U]=P.charCodeAt(U)^N.charCodeAt(U);j[0]&=~A;var W=F-k-d-2;for(U=0;U<W;U+=1)if(j[U]!==0)throw new Error("leftmost octets not zero");if(j[W]!==1)throw new Error("0x01 marker not found");return D===Fr(m(qi("\0\0\0\0\0\0\0\0"+T+String.fromCharCode.apply(String,j.slice(-d)))))},we.SALT_LEN_HLEN=-1,we.SALT_LEN_MAX=-2,we.SALT_LEN_RECOVER=-2;function st(s){var c=Me,l=c.getChildIdx,d=c.getV;c.dump;var v=c.parse,m=c.getTLV,T=c.getVbyList,k=c.getVbyListEx,O=c.getTLVbyList,F=c.getTLVbyListEx,U=c.getIdxbyList,L=c.getIdxbyListEx,P=c.getVidx,D=c.getInt,A=c.oidname,N=c.hextooidstr,j=Cn,W,se=Error;try{W=y.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var G=O(this.hex,0,[0,0]);if(G.substr(0,2)=="a0"){var X=O(G,0,[0]),te=D(X,0);if(te<0||2<te)throw new Error("malformed version field");return this.version=te+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return k(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var G=F(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(G)},this.getAlgorithmIdentifierName=function(G){for(var X in W)if(G===W[X])return X;return A(k(G,0,[0],"06"))},this.getIssuer=function(G,X){return this.getX500Name(this.getIssuerHex(),G,X)},this.getIssuerHex=function(){return O(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var G=this.getIssuer();return G.str},this.getSubject=function(G,X){return this.getX500Name(this.getSubjectHex(),G,X)},this.getSubjectHex=function(){return O(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var G=this.getSubject();return G.str},this.getNotBefore=function(){var G=T(this.hex,0,[0,4+this.foffset,0]);return G=G.replace(/(..)/g,"%$1"),G=decodeURIComponent(G),G},this.getNotAfter=function(){var G=T(this.hex,0,[0,4+this.foffset,1]);return G=G.replace(/(..)/g,"%$1"),G=decodeURIComponent(G),G},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return O(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var G=this.getSPKI();return G==null?null:T(G,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return U(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var G=this.getPublicKeyIdx();return U(this.hex,G,[1,0],"30")},this.getPublicKey=function(){return It.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var G=O(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(G)},this.getSignatureValueHex=function(){return T(this.hex,0,[2],"03",!0)},this.verifySignature=function(G){var X=this.getSignatureAlgorithmField(),te=this.getSignatureValueHex(),J=O(this.hex,0,[0],"30"),re=new y.crypto.Signature({alg:X});return re.init(G),re.updateHex(J),re.verify(te)},this.parseExt=function(G){var X,te,J;if(G===void 0){if(J=this.hex,this.version!==3)return-1;X=U(J,0,[0,7,0],"30"),te=l(J,X)}else{J=Cn(G);var re=U(J,0,[0,3,0,0],"06");if(d(J,re)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}X=U(J,0,[0,3,0,1,0],"30"),te=l(J,X),this.hex=J}this.aExtInfo=new Array;for(var he=0;he<te.length;he++){var ye={};ye.critical=!1;var Ae=l(J,te[he]),ve=0;Ae.length===3&&(ye.critical=!0,ve=1),ye.oid=c.hextooidstr(T(J,te[he],[0],"06"));var xe=U(J,te[he],[1+ve]);ye.vidx=P(J,xe),this.aExtInfo.push(ye)}},this.getExtInfo=function(G){var X=this.aExtInfo,te=G;if(G.match(/^[0-9.]+$/)||(te=y.asn1.x509.OID.name2oid(G)),te!==""){for(var J=0;J<X.length;J++)if(X[J].oid===te)return X[J]}},this.getCriticalExtV=function(G,X,te){if(X!=null)return[X,te];var J=this.getExtInfo(G);return J==null?[null,null]:[m(this.hex,J.vidx),J.critical]},this.getExtBasicConstraints=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("basicConstraints");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"basicConstraints"};if(X&&(J.critical=!0),G==="3000")return J;if(G==="30030101ff")return J.cA=!0,J;if(G.substr(0,12)==="30060101ff02"){var re=d(G,10),he=parseInt(re,16);return J.cA=!0,J.pathLen=he,J}throw new Error("hExtV parse error: "+G)},this.getExtNameConstraints=function(G,X){var te=this.getCriticalExtV("nameConstraints",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"nameConstraints"};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){for(var ye=[],Ae=l(G,re[he]),ve=0;ve<Ae.length;ve++){var xe=m(G,Ae[ve]),Fe=this.getGeneralSubtree(xe);ye.push(Fe)}var Ne=G.substr(re[he],2);Ne=="a0"?J.permit=ye:Ne=="a1"&&(J.exclude=ye)}return J}},this.getGeneralSubtree=function(G){var X=l(G,0),te=X.length;if(te<1||2<te)throw new Error("wrong num elements");for(var J=this.getGeneralName(m(G,X[0])),re=1;re<te;re++){var he=G.substr(X[re],2),ye=d(G,X[re]),Ae=parseInt(ye,16);he=="80"&&(J.min=Ae),he=="81"&&(J.max=Ae)}return J},this.getExtKeyUsage=function(G,X){var te=this.getCriticalExtV("keyUsage",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"keyUsage"};return X&&(J.critical=!0),J.names=this.getExtKeyUsageString(G).split(","),J}},this.getExtKeyUsageBin=function(G){if(G===void 0){var X=this.getExtInfo("keyUsage");if(X===void 0)return"";G=m(this.hex,X.vidx)}if(G.length!=8&&G.length!=10)throw new Error("malformed key usage value: "+G);var te="000000000000000"+parseInt(G.substr(6),16).toString(2);return G.length==8&&(te=te.slice(-8)),G.length==10&&(te=te.slice(-16)),te=te.replace(/0+$/,""),te==""&&(te="0"),te},this.getExtKeyUsageString=function(G){for(var X=this.getExtKeyUsageBin(G),te=new Array,J=0;J<X.length;J++)X.substr(J,1)=="1"&&te.push(st.KEYUSAGE_NAME[J]);return te.join(",")},this.getExtSubjectKeyIdentifier=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("subjectKeyIdentifier");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"subjectKeyIdentifier"};X&&(J.critical=!0);var re=d(G,0);return J.kid={hex:re},J},this.getExtAuthorityKeyIdentifier=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("authorityKeyIdentifier");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"authorityKeyIdentifier"};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){var ye=G.substr(re[he],2);if(ye==="80"&&(J.kid={hex:d(G,re[he])}),ye==="a1"){var Ae=m(G,re[he]),ve=this.getGeneralNames(Ae);J.issuer=ve[0].dn}ye==="82"&&(J.sn={hex:d(G,re[he])})}return J},this.getExtExtKeyUsage=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("extKeyUsage");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"extKeyUsage",array:[]};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++)J.array.push(A(d(G,re[he])));return J},this.getExtExtKeyUsageName=function(){var G=this.getExtInfo("extKeyUsage");if(G===void 0)return G;var X=new Array,te=m(this.hex,G.vidx);if(te==="")return X;for(var J=l(te,0),re=0;re<J.length;re++)X.push(A(d(te,J[re])));return X},this.getExtSubjectAltName=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("subjectAltName");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"subjectAltName",array:[]};return X&&(J.critical=!0),J.array=this.getGeneralNames(G),J},this.getExtIssuerAltName=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("issuerAltName");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"issuerAltName",array:[]};return X&&(J.critical=!0),J.array=this.getGeneralNames(G),J},this.getGeneralNames=function(G){for(var X=l(G,0),te=[],J=0;J<X.length;J++){var re=this.getGeneralName(m(G,X[J]));re!==void 0&&te.push(re)}return te},this.getGeneralName=function(G){var X=G.substr(0,2),te=d(G,0),J=Fr(te);if(X=="81")return{rfc822:J};if(X=="82")return{dns:J};if(X=="86")return{uri:J};if(X=="87")return{ip:Gl(te)};if(X=="a4")return{dn:this.getX500Name(te)};if(X=="a0")return{other:this.getOtherName(G)}},this.getExtSubjectAltName2=function(){var G,X,te,J=this.getExtInfo("subjectAltName");if(J===void 0)return J;for(var re=new Array,he=m(this.hex,J.vidx),ye=l(he,0),Ae=0;Ae<ye.length;Ae++)te=he.substr(ye[Ae],2),G=d(he,ye[Ae]),te==="81"&&(X=Jt(G),re.push(["MAIL",X])),te==="82"&&(X=Jt(G),re.push(["DNS",X])),te==="84"&&(X=st.hex2dn(G,0),re.push(["DN",X])),te==="86"&&(X=Jt(G),re.push(["URI",X])),te==="87"&&(X=Gl(G),re.push(["IP",X]));return re},this.getExtCRLDistributionPoints=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("cRLDistributionPoints");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"cRLDistributionPoints",array:[]};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){var ye=m(G,re[he]);J.array.push(this.getDistributionPoint(ye))}return J},this.getDistributionPoint=function(G){for(var X={},te=l(G,0),J=0;J<te.length;J++){var re=G.substr(te[J],2),he=m(G,te[J]);re=="a0"&&(X.dpname=this.getDistributionPointName(he))}return X},this.getDistributionPointName=function(G){for(var X={},te=l(G,0),J=0;J<te.length;J++){var re=G.substr(te[J],2),he=m(G,te[J]);re=="a0"&&(X.full=this.getGeneralNames(he))}return X},this.getExtCRLDistributionPointsURI=function(){var G=this.getExtCRLDistributionPoints();if(G==null)return G;for(var X=G.array,te=[],J=0;J<X.length;J++)try{X[J].dpname.full[0].uri!=null&&te.push(X[J].dpname.full[0].uri)}catch{}return te},this.getExtAIAInfo=function(){var G=this.getExtInfo("authorityInfoAccess");if(G===void 0)return G;for(var X={ocsp:[],caissuer:[]},te=l(this.hex,G.vidx),J=0;J<te.length;J++){var re=T(this.hex,te[J],[0],"06"),he=T(this.hex,te[J],[1],"86");re==="2b06010505073001"&&X.ocsp.push(Jt(he)),re==="2b06010505073002"&&X.caissuer.push(Jt(he))}return X},this.getExtAuthorityInfoAccess=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("authorityInfoAccess");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"authorityInfoAccess",array:[]};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){var ye=k(G,re[he],[0],"06"),Ae=T(G,re[he],[1],"86"),ve=Jt(Ae);if(ye=="2b06010505073001")J.array.push({ocsp:ve});else if(ye=="2b06010505073002")J.array.push({caissuer:ve});else throw new Error("unknown method: "+ye)}return J},this.getExtCertificatePolicies=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("certificatePolicies");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"certificatePolicies",array:[]};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){var ye=m(G,re[he]),Ae=this.getPolicyInformation(ye);J.array.push(Ae)}return J},this.getPolicyInformation=function(G){var X={},te=T(G,0,[0],"06");X.policyoid=A(te);var J=L(G,0,[1],"30");if(J!=-1){X.array=[];for(var re=l(G,J),he=0;he<re.length;he++){var ye=m(G,re[he]),Ae=this.getPolicyQualifierInfo(ye);X.array.push(Ae)}}return X},this.getOtherName=function(G){var X={},te=l(G,0),J=T(G,te[0],[],"06"),re=T(G,te[1],[]);return X.oid=A(J),X.value=v(re),X},this.getPolicyQualifierInfo=function(G){var X={},te=T(G,0,[0],"06");if(te==="2b06010505070201"){var J=k(G,0,[1],"16");X.cps=Fr(J)}else if(te==="2b06010505070202"){var re=O(G,0,[1],"30");X.unotice=this.getUserNotice(re)}return X},this.getUserNotice=function(G){var X=null;try{X=c.parse(G);var te=this._asn1ToUnotice(X);return te}catch{return}},this._asn1ToUnotice=function(G){try{for(var X={},te=Yt(G,"seq"),J=0;J<te.length;J++){var re=this._asn1ToNoticeRef(te[J]);re!=null&&(X.noticeref=re);var he=this.asn1ToDisplayText(te[J]);he!=null&&(X.exptext=he)}return Object.keys(X).length>0?X:void 0}catch{return}},this._asn1ToNoticeRef=function(G){try{for(var X={},te=Yt(G,"seq"),J=0;J<te.length;J++){var re=this._asn1ToNoticeNum(te[J]);re!=null&&(X.noticenum=re);var he=this.asn1ToDisplayText(te[J]);he!=null&&(X.org=he)}return Object.keys(X).length>0?X:void 0}catch{return}},this._asn1ToNoticeNum=function(G){try{for(var X=Yt(G,"seq"),te=[],J=0;J<X.length;J++){var re=X[J];te.push(parseInt(Yt(re,"int.hex"),16))}return te}catch{return}},this.getDisplayText=function(G){var X={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},te={};return te.type=X[G.substr(0,2)],te.str=Fr(d(G,0)),te},this.asn1ToDisplayText=function(G){if(G.utf8str!=null)return{type:"utf8",str:G.utf8str.str};if(G.ia5str!=null)return{type:"ia5",str:G.ia5str.str};if(G.visstr!=null)return{type:"vis",str:G.visstr.str};if(G.bmpstr!=null)return{type:"bmp",str:G.bmpstr.str};if(G.prnstr!=null)return{type:"prn",str:G.prnstr.str}},this.getExtPolicyMappings=function(G,X){var te=this.getCriticalExtV("policyMappings",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"policyMappings"};X&&(J.critical=!0);try{for(var re=v(G),he=re.seq,ye=[],Ae=0;Ae<he.length;Ae++){var ve=he[Ae].seq;ye.push([ve[0].oid,ve[1].oid])}J.array=ye}catch{throw new se("malformed policyMappings")}return J}},this.getExtPolicyConstraints=function(G,X){var te=this.getCriticalExtV("policyConstraints",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"policyConstraints"};X&&(J.critical=!0);var re=v(G);try{for(var he=re.seq,ye=0;ye<he.length;ye++){var Ae=he[ye].tag;Ae.explicit==!1&&(Ae.tag=="80"&&(J.reqexp=parseInt(Ae.hex,16)),Ae.tag=="81"&&(J.inhibit=parseInt(Ae.hex,16)))}}catch{return new se("malformed policyConstraints value")}return J}},this.getExtInhibitAnyPolicy=function(G,X){var te=this.getCriticalExtV("inhibitAnyPolicy",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"inhibitAnyPolicy"};X&&(J.critical=!0);var re=D(G,0);return re==-1?new se("wrong value"):(J.skip=re,J)}},this.getExtCRLNumber=function(G,X){var te={extname:"cRLNumber"};if(X&&(te.critical=!0),G.substr(0,2)=="02")return te.num={hex:d(G,0)},te;throw new se("hExtV parse error: "+G)},this.getExtCRLReason=function(G,X){var te={extname:"cRLReason"};if(X&&(te.critical=!0),G.substr(0,2)=="0a")return te.code=parseInt(d(G,0),16),te;throw new Error("hExtV parse error: "+G)},this.getExtOcspNonce=function(G,X){var te={extname:"ocspNonce"};X&&(te.critical=!0);var J=d(G,0);return te.hex=J,te},this.getExtOcspNoCheck=function(G,X){var te={extname:"ocspNoCheck"};return X&&(te.critical=!0),te},this.getExtAdobeTimeStamp=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("adobeTimeStamp");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"adobeTimeStamp"};X&&(J.critical=!0);var re=l(G,0);if(re.length>1){var he=m(G,re[1]),ye=this.getGeneralName(he);ye.uri!=null&&(J.uri=ye.uri)}if(re.length>2){var Ae=m(G,re[2]);Ae=="0101ff"&&(J.reqauth=!0),Ae=="010100"&&(J.reqauth=!1)}return J},this.getExtSubjectDirectoryAttributes=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("subjectDirectoryAttributes");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"subjectDirectoryAttributes"};X&&(J.critical=!0);try{for(var re=v(G),he=[],ye=0;ye<re.seq.length;ye++){var Ae=re.seq[ye],ve=Yt(Ae,"seq.0.oid"),xe=Yt(Ae,"seq.1.set");if(ve==null||xe==null)throw"error";he.push({attr:ve,array:xe})}return J.array=he,J}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var de=function(G){var X={};try{var te=G.seq[0].oid,J=y.asn1.x509.OID.name2oid(te);X.type=y.asn1.x509.OID.oid2atype(J);var re=G.seq[1];if(re.utf8str!=null)X.ds="utf8",X.value=re.utf8str.str;else if(re.numstr!=null)X.ds="num",X.value=re.numstr.str;else if(re.telstr!=null)X.ds="tel",X.value=re.telstr.str;else if(re.prnstr!=null)X.ds="prn",X.value=re.prnstr.str;else if(re.ia5str!=null)X.ds="ia5",X.value=re.ia5str.str;else if(re.visstr!=null)X.ds="vis",X.value=re.visstr.str;else if(re.bmpstr!=null)X.ds="bmp",X.value=re.bmpstr.str;else throw"error";return X}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},ue=function(G){try{return G.set.map(function(X){return de(X)})}catch(X){throw new Error("improper ASN.1 parsed RDN: "+X)}},pe=function(G){try{return G.seq.map(function(X){return ue(X)})}catch(X){throw new Error("improper ASN.1 parsed X500Name: "+X)}};this.getX500NameRule=function(G){for(var X=null,te=[],J=0;J<G.length;J++)for(var re=G[J],he=0;he<re.length;he++)te.push(re[he]);for(var J=0;J<te.length;J++){var ye=te[J],Ae=ye.ds,ve=ye.value,xe=ye.type;if(Ae!="prn"&&Ae!="utf8"&&Ae!="ia5")return"mixed";if(Ae=="ia5"){if(xe!="CN")return"mixed";if(y.lang.String.isMail(ve))continue;return"mixed"}if(xe=="C"){if(Ae=="prn")continue;return"mixed"}if(X==null)X=Ae;else if(X!==Ae)return"mixed"}return X??"prn"},this.getAttrTypeAndValue=function(G){var X=v(G);return de(X)},this.getRDN=function(G){var X=v(G);return ue(X)},this.getX500NameArray=function(G){var X=v(G);return pe(X)},this.getX500Name=function(G,X,te){var J=this.getX500NameArray(G),re=this.dnarraytostr(J),he={str:re};return he.array=J,te==!0&&(he.hex=G),X==!0&&(he.canon=this.c14nRDNArray(J)),he},this.readCertPEM=function(G){this.readCertHex(j(G))},this.readCertHex=function(G){this.hex=G,this.getVersion();try{U(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(G){var X={};return G==null&&(G={}),X.version=this.getVersion(),X.serial={hex:this.getSerialNumberHex()},X.sigalg=this.getSignatureAlgorithmField(),X.issuer=this.getIssuer(G.dncanon,G.dnhex),X.notbefore=this.getNotBefore(),X.notafter=this.getNotAfter(),X.subject=this.getSubject(G.dncanon,G.dnhex),X.sbjpubkey=sr(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(X.ext=this.getExtParamArray()),X.sighex=this.getSignatureValueHex(),G.tbshex==!0&&(X.tbshex=O(this.hex,0,[0])),G.nodnarray==!0&&(delete X.issuer.array,delete X.subject.array),X},this.getExtParamArray=function(G){if(G==null){var X=L(this.hex,0,[0,"[3]"]);X!=-1&&(G=F(this.hex,0,[0,"[3]",0],"30"))}for(var te=[],J=l(G,0),re=0;re<J.length;re++){var he=m(G,J[re]),ye=this.getExtParam(he);ye!=null&&te.push(ye)}return te},this.getExtParam=function(G){var X=l(G,0),te=X.length;if(te!=2&&te!=3)throw new Error("wrong number elements in Extension: "+te+" "+G);var J=N(T(G,0,[0],"06")),re=!1;te==3&&O(G,0,[1])=="0101ff"&&(re=!0);var he=O(G,0,[te-1,0]),ye=void 0;if(J=="2.5.29.14"?ye=this.getExtSubjectKeyIdentifier(he,re):J=="2.5.29.15"?ye=this.getExtKeyUsage(he,re):J=="2.5.29.17"?ye=this.getExtSubjectAltName(he,re):J=="2.5.29.18"?ye=this.getExtIssuerAltName(he,re):J=="2.5.29.19"?ye=this.getExtBasicConstraints(he,re):J=="2.5.29.30"?ye=this.getExtNameConstraints(he,re):J=="2.5.29.31"?ye=this.getExtCRLDistributionPoints(he,re):J=="2.5.29.32"?ye=this.getExtCertificatePolicies(he,re):J=="2.5.29.33"?ye=this.getExtPolicyMappings(he,re):J=="2.5.29.35"?ye=this.getExtAuthorityKeyIdentifier(he,re):J=="2.5.29.36"?ye=this.getExtPolicyConstraints(he,re):J=="2.5.29.37"?ye=this.getExtExtKeyUsage(he,re):J=="2.5.29.54"?ye=this.getExtInhibitAnyPolicy(he,re):J=="1.3.6.1.5.5.7.1.1"?ye=this.getExtAuthorityInfoAccess(he,re):J=="2.5.29.20"?ye=this.getExtCRLNumber(he,re):J=="2.5.29.21"?ye=this.getExtCRLReason(he,re):J=="2.5.29.9"?ye=this.getExtSubjectDirectoryAttributes(he,re):J=="1.3.6.1.5.5.7.48.1.2"?ye=this.getExtOcspNonce(he,re):J=="1.3.6.1.5.5.7.48.1.5"?ye=this.getExtOcspNoCheck(he,re):J=="1.2.840.113583.1.1.9.1"?ye=this.getExtAdobeTimeStamp(he,re):st.EXT_PARSER[J]!=null&&(ye=st.EXT_PARSER[J](J,re,he)),ye!=null)return ye;var Ae={extname:J,extn:he};try{Ae.extn=v(he)}catch{}return re&&(Ae.critical=!0),Ae},this.findExt=function(G,X){for(var te=0;te<G.length;te++)if(G[te].extname==X)return G[te];return null},this.updateExtCDPFullURI=function(G,X){var te=this.findExt(G,"cRLDistributionPoints");if(te!=null&&te.array!=null){for(var J=te.array,re=0;re<J.length;re++)if(J[re].dpname!=null&&J[re].dpname.full!=null)for(var he=J[re].dpname.full,ye=0;ye<he.length;ye++){var Ae=he[re];Ae.uri!=null&&(Ae.uri=X)}}},this.updateExtAIAOCSP=function(G,X){var te=this.findExt(G,"authorityInfoAccess");if(te!=null&&te.array!=null)for(var J=te.array,re=0;re<J.length;re++)J[re].ocsp!=null&&(J[re].ocsp=X)},this.updateExtAIACAIssuer=function(G,X){var te=this.findExt(G,"authorityInfoAccess");if(te!=null&&te.array!=null)for(var J=te.array,re=0;re<J.length;re++)J[re].caissuer!=null&&(J[re].caissuer=X)},this.dnarraytostr=function(G){function X(J){return J.map(function(re){return te(re).replace(/\+/,"\\+")}).join("+")}function te(J){return J.type+"="+J.value}return"/"+G.map(function(J){return X(J).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(G){var X;if(G.str!=null&&G.array==null){var te=new y.asn1.x509.X500Name({str:G.str}),J=te.tohex();X=this.getX500NameArray(J)}else X=G.array;G.canon==null&&(G.canon=this.c14nRDNArray(X))},this.c14nRDNArray=function(G){for(var X=[],te=0;te<G.length;te++){for(var J=G[te],re=[],he=0;he<J.length;he++){var ye=J[he],Ae=ye.value;Ae=Ae.replace(/^\s*/,""),Ae=Ae.replace(/\s*$/,""),Ae=Ae.replace(/\s+/g," "),Ae=Ae.toLowerCase(),re.push(ye.type.toLowerCase()+"="+Ae)}X.push(re.join("+"))}return"/"+X.join("/")},this.getInfo=function(){var G=function(vr){for(var Mt="",Xt="    ",gn=`
`,vn=vr.array,Dr=0;Dr<vn.length;Dr++){var En=vn[Dr];if(En.dn!=null&&(Mt+=Xt+"dn: "+En.dn.str+gn),En.ip!=null&&(Mt+=Xt+"ip: "+En.ip+gn),En.rfc822!=null&&(Mt+=Xt+"rfc822: "+En.rfc822+gn),En.dns!=null&&(Mt+=Xt+"dns: "+En.dns+gn),En.uri!=null&&(Mt+=Xt+"uri: "+En.uri+gn),En.other!=null){var oc=En.other.oid,ma=JSON.stringify(En.other.value).replace(/\"/g,"");Mt+=Xt+"other: "+oc+"="+ma+gn}}return Mt=Mt.replace(/\n$/,""),Mt},X=function(vr){for(var Mt="",Xt=vr.array,gn=0;gn<Xt.length;gn++){var vn=Xt[gn];if(Mt+="    policy oid: "+vn.policyoid+`
`,vn.array!==void 0)for(var Dr=0;Dr<vn.array.length;Dr++){var En=vn.array[Dr];En.cps!==void 0&&(Mt+="    cps: "+En.cps+`
`)}}return Mt},te=function(vr){for(var Mt="",Xt=vr.array,gn=0;gn<Xt.length;gn++){var vn=Xt[gn];try{vn.dpname.full[0].uri!==void 0&&(Mt+="    "+vn.dpname.full[0].uri+`
`)}catch{}try{vn.dname.full[0].dn.hex!==void 0&&(Mt+="    "+st.hex2dn(vn.dpname.full[0].dn.hex)+`
`)}catch{}}return Mt},J=function(vr){for(var Mt="",Xt=vr.array,gn=0;gn<Xt.length;gn++){var vn=Xt[gn];vn.caissuer!==void 0&&(Mt+="    caissuer: "+vn.caissuer+`
`),vn.ocsp!==void 0&&(Mt+="    ocsp: "+vn.ocsp+`
`)}return Mt},re,he,ye;if(re=`Basic Fields
`,re+="  serial number: "+this.getSerialNumberHex()+`
`,re+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,re+="  issuer: "+this.getIssuerString()+`
`,re+="  notBefore: "+this.getNotBefore()+`
`,re+="  notAfter: "+this.getNotAfter()+`
`,re+="  subject: "+this.getSubjectString()+`
`,re+=`  subject public key info: 
`,he=this.getPublicKey(),re+="    key algorithm: "+he.type+`
`,he.type==="RSA"&&(re+="    n="+Gh(he.n.toString(16)).substr(0,16)+`...
`,re+="    e="+Gh(he.e.toString(16))+`
`),ye=this.aExtInfo,ye!=null){re+=`X509v3 Extensions:
`;for(var Ae=0;Ae<ye.length;Ae++){var ve=ye[Ae],xe=y.asn1.x509.OID.oid2name(ve.oid);xe===""&&(xe=ve.oid);var Fe="";if(ve.critical===!0&&(Fe="CRITICAL"),re+="  "+xe+" "+Fe+`:
`,xe==="basicConstraints"){var Ne=this.getExtBasicConstraints();Ne.cA===void 0?re+=`    {}
`:(re+="    cA=true",Ne.pathLen!==void 0&&(re+=", pathLen="+Ne.pathLen),re+=`
`)}else if(xe=="policyMappings"){var ar=this.getExtPolicyMappings().array,mn=ar.map(function(vr){var Mt=vr;return Mt[0]+":"+Mt[1]}).join(", ");re+="    "+mn+`
`}else if(xe=="policyConstraints"){var tn=this.getExtPolicyConstraints();re+="    ",tn.reqexp!=null&&(re+=" reqexp="+tn.reqexp),tn.inhibit!=null&&(re+=" inhibit="+tn.inhibit),re+=`
`}else if(xe=="inhibitAnyPolicy"){var tn=this.getExtInhibitAnyPolicy();re+="    skip="+tn.skip+`
`}else if(xe=="keyUsage")re+="    "+this.getExtKeyUsageString()+`
`;else if(xe=="subjectKeyIdentifier")re+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(xe=="authorityKeyIdentifier"){var On=this.getExtAuthorityKeyIdentifier();On.kid!==void 0&&(re+="    kid="+On.kid.hex+`
`)}else if(xe=="extKeyUsage"){var Kn=this.getExtExtKeyUsage().array;re+="    "+Kn.join(", ")+`
`}else if(xe=="subjectAltName"){var Qn=G(this.getExtSubjectAltName());re+=Qn+`
`}else if(xe=="cRLDistributionPoints"){var $n=this.getExtCRLDistributionPoints();re+=te($n)}else if(xe=="authorityInfoAccess"){var ac=this.getExtAuthorityInfoAccess();re+=J(ac)}else xe=="certificatePolicies"&&(re+=X(this.getExtCertificatePolicies()))}}return re+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,re+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,re},typeof s=="string"&&(s.indexOf("-----BEGIN")!=-1?this.readCertPEM(s):y.lang.String.isHex(s)&&this.readCertHex(s))}st.EXT_PARSER={},st.registExtParser=function(s,c){st.EXT_PARSER[s]=c},st.hex2dn=function(s,c){c===void 0&&(c=0);var l=new st;Me.getTLV(s,c);var d=l.getX500Name(s);return d.str},st.hex2rdn=function(s,c){if(c===void 0&&(c=0),s.substr(c,2)!=="31")throw new Error("malformed RDN");for(var l=new Array,d=Me.getChildIdx(s,c),v=0;v<d.length;v++)l.push(st.hex2attrTypeValue(s,d[v]));return l=l.map(function(m){return m.replace("+","\\+")}),l.join("+")},st.hex2attrTypeValue=function(s,c){var l=Me,d=l.getV;if(c===void 0&&(c=0),s.substr(c,2)!=="30")throw new Error("malformed attribute type and value");var v=l.getChildIdx(s,c);v.length!==2||s.substr(v[0],2);var m=d(s,v[0]),T=y.asn1.ASN1Util.oidHexToInt(m),k=y.asn1.x509.OID.oid2atype(T),O=d(s,v[1]),F=Fr(O);return k+"="+F},st.getPublicKeyFromCertHex=function(s){var c=new st;return c.readCertHex(s),c.getPublicKey()},st.getPublicKeyFromCertPEM=function(s){var c=new st;return c.readCertPEM(s),c.getPublicKey()},st.getPublicKeyInfoPropOfCertPEM=function(s){var c=Me,l=c.getVbyList,d={},v,m;return d.algparam=null,v=new st,v.readCertPEM(s),m=v.getPublicKeyHex(),d.keyhex=l(m,0,[1],"03").substr(2),d.algoid=l(m,0,[0,0],"06"),d.algoid==="2a8648ce3d0201"&&(d.algparam=l(m,0,[0,1],"06")),d},st.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var X2=function(s){var c=y,l=c.lang.String.isHex,d=Me,v=d.getV,m=d.getTLV,T=d.getVbyList,k=d.getTLVbyList,O=d.getTLVbyListEx,F=d.getIdxbyList,U=d.getIdxbyListEx,L=d.getChildIdx,P=new st;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var D=F(this.hex,0,[0,0]),A=this.hex.substr(D,2);if(A=="02")this.posSigAlg=1;else if(A=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+A);var N=F(this.hex,0,[0,this.posSigAlg+3]),j=this.hex.substr(N,2);if(j=="17"||j=="18"){var W,se;W=F(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,W!=-1&&(se=this.hex.substr(W,2),se=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(j=="30")this.posRevCert=this.posSigAlg+3;else if(j=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+j)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(T(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var D=k(this.hex,0,[0,this.posSigAlg],"30");return P.getAlgorithmIdentifierName(D)},this.getIssuer=function(){return P.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return k(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var D=T(this.hex,0,[0,this.posSigAlg+2]);return result=Fr(D)},this.getNextUpdate=function(){var D=F(this.hex,0,[0,this.posSigAlg+3]),A=this.hex.substr(D,2);return A!="17"&&A!="18"?null:Fr(v(this.hex,D))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var D=[],A=F(this.hex,0,[0,this.posRevCert]),N=L(this.hex,A),j=0;j<N.length;j++){var W=m(this.hex,N[j]);D.push(this.getRevCert(W))}return D},this.getRevCert=function(D){var A={},N=L(D,0);return A.sn={hex:T(D,0,[0],"02")},A.date=Fr(T(D,0,[1])),N.length==3&&(A.ext=P.getExtParamArray(k(D,0,[2]))),A},this.findRevCert=function(D){var A=new st(D),N=A.getSerialNumberHex();return this.findRevCertBySN(N)},this.findRevCertBySN=function(D){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var A=this.parsed.revcert,N=0;N<A.length;N++)if(D==A[N].sn.hex)return A[N];return null},this.getSignatureValueHex=function(){return T(this.hex,0,[2],"03",!0)},this.verifySignature=function(D){var A=this.getSignatureAlgorithmField(),N=this.getSignatureValueHex(),j=k(this.hex,0,[0],"30"),W=new y.crypto.Signature({alg:A});return W.init(D),W.updateHex(j),W.verify(N)},this.getParam=function(D){var A={},N=this.getVersion();N!=null&&(A.version=N),A.sigalg=this.getSignatureAlgorithmField(),A.issuer=this.getIssuer(),A.thisupdate=this.getThisUpdate();var j=this.getNextUpdate();j!=null&&(A.nextupdate=j);var W=this.getRevCertArray();W!=null&&(A.revcert=W);var se=U(this.hex,0,[0,"[0]"]);if(se!=-1){var de=O(this.hex,0,[0,"[0]",0]);A.ext=P.getExtParamArray(de)}return A.sighex=this.getSignatureValueHex(),this.parsed=A,typeof D=="object"&&(D.tbshex==!0&&(A.tbshex=k(this.hex,0,[0])),D.nodnarray==!0&&delete A.issuer.array),A},typeof s=="string"&&(l(s)?this.hex=s:s.match(/-----BEGIN X509 CRL/)&&(this.hex=Cn(s)),this._setPos())};(typeof y>"u"||!y)&&(y={}),(typeof y.jws>"u"||!y.jws)&&(y.jws={}),y.jws.JWS=function(){var s=y,c=s.jws.JWS,l=c.isSafeJSONString;this.parseJWS=function(d,v){if(!(this.parsedJWS!==void 0&&(v||this.parsedJWS.sigvalH!==void 0))){var m=d.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(m==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var T=m[1],k=m[2],O=m[3],F=T+"."+k;if(this.parsedJWS={},this.parsedJWS.headB64U=T,this.parsedJWS.payloadB64U=k,this.parsedJWS.sigvalB64U=O,this.parsedJWS.si=F,!v){var U=an(O),L=be(U,16);this.parsedJWS.sigvalH=U,this.parsedJWS.sigvalBI=L}var P=gi(T),D=gi(k);if(this.parsedJWS.headS=P,this.parsedJWS.payloadS=D,!l(P,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+P}}},y.jws.JWS.sign=function(s,c,l,d,v){var m=y,T=m.jws,k=T.JWS,O=k.readSafeJSONString,F=k.isSafeJSONString,U=m.crypto;U.ECDSA;var L=U.Mac,P=U.Signature,D=JSON,A,N,j;if(typeof c!="string"&&typeof c!="object")throw"spHeader must be JSON string or object: "+c;if(typeof c=="object"&&(N=c,A=D.stringify(N)),typeof c=="string"){if(A=c,!F(A))throw"JWS Head is not safe JSON string: "+A;N=O(A)}if(j=l,typeof l=="object"&&(j=D.stringify(l)),(s==""||s==null)&&N.alg!==void 0&&(s=N.alg),s!=""&&s!=null&&N.alg===void 0&&(N.alg=s,A=D.stringify(N)),s!==N.alg)throw"alg and sHeader.alg doesn't match: "+s+"!="+N.alg;var W=null;if(k.jwsalg2sigalg[s]===void 0)throw"unsupported alg name: "+s;W=k.jwsalg2sigalg[s];var se=ic(A),de=ic(j),ue=se+"."+de,pe="";if(W.substr(0,4)=="Hmac"){if(d===void 0)throw"mac key shall be specified for HS* alg";var G=new L({alg:W,prov:"cryptojs",pass:d});G.updateString(ue),pe=G.doFinal()}else if(W.indexOf("withECDSA")!=-1){var X=new P({alg:W});X.init(d,v),X.updateString(ue);var te=X.sign();pe=y.crypto.ECDSA.asn1SigToConcatSig(te)}else if(W!="none"){var X=new P({alg:W});X.init(d,v),X.updateString(ue),pe=X.sign()}var J=Hn(pe);return ue+"."+J},y.jws.JWS.verify=function(s,c,l){var d=y,v=d.jws,m=v.JWS,T=m.readSafeJSONString,k=d.crypto,O=k.ECDSA,F=k.Mac,U=k.Signature,L;if(typeof we!==void 0&&(L=we),!Wh(s))return!1;var P=s.split(".");if(P.length!==3)return!1;var D=P[0],A=P[1],N=D+"."+A,j=an(P[2]),W=T(gi(P[0])),se=null,de=null;if(W.alg===void 0)throw"algorithm not specified in header";if(se=W.alg,de=se.substr(0,2),l!=null&&Object.prototype.toString.call(l)==="[object Array]"&&l.length>0){var ue=":"+l.join(":")+":";if(ue.indexOf(":"+se+":")==-1)throw"algorithm '"+se+"' not accepted in the list"}if(se!="none"&&c===null)throw"key shall be specified to verify.";if(typeof c=="string"&&c.indexOf("-----BEGIN ")!=-1&&(c=It.getKey(c)),(de=="RS"||de=="PS")&&!(c instanceof L))throw"key shall be a RSAKey obj for RS* and PS* algs";if(de=="ES"&&!(c instanceof O))throw"key shall be a ECDSA obj for ES* algs";var pe=null;if(m.jwsalg2sigalg[W.alg]===void 0)throw"unsupported alg name: "+se;if(pe=m.jwsalg2sigalg[se],pe=="none")throw"not supported";if(pe.substr(0,4)=="Hmac"){var G=null;if(c===void 0)throw"hexadecimal key shall be specified for HMAC";var X=new F({alg:pe,pass:c});return X.updateString(N),G=X.doFinal(),j==G}else if(pe.indexOf("withECDSA")!=-1){var te=null;try{te=O.concatSigToASN1Sig(j)}catch{return!1}var J=new U({alg:pe});return J.init(c),J.updateString(N),J.verify(te)}else{var J=new U({alg:pe});return J.init(c),J.updateString(N),J.verify(j)}},y.jws.JWS.parse=function(s){var c=s.split("."),l={},d,v,m;if(c.length!=2&&c.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return d=c[0],v=c[1],c.length==3&&(m=c[2]),l.headerObj=y.jws.JWS.readSafeJSONString(gi(d)),l.payloadObj=y.jws.JWS.readSafeJSONString(gi(v)),l.headerPP=JSON.stringify(l.headerObj,null,"  "),l.payloadObj==null?l.payloadPP=gi(v):l.payloadPP=JSON.stringify(l.payloadObj,null,"  "),m!==void 0&&(l.sigHex=an(m)),l},y.jws.JWS.verifyJWT=function(s,c,l){var d=y,v=d.jws,m=v.JWS,T=m.readSafeJSONString,k=m.inArray,O=m.includedArray;if(!Wh(s))return!1;var F=s.split(".");if(F.length!=3)return!1;var U=F[0],L=F[1];an(F[2]);var P=T(gi(U)),D=T(gi(L));if(P.alg===void 0)return!1;if(l.alg===void 0)throw"acceptField.alg shall be specified";if(!k(P.alg,l.alg)||D.iss!==void 0&&typeof l.iss=="object"&&!k(D.iss,l.iss)||D.sub!==void 0&&typeof l.sub=="object"&&!k(D.sub,l.sub))return!1;if(D.aud!==void 0&&typeof l.aud=="object"){if(typeof D.aud=="string"){if(!k(D.aud,l.aud))return!1}else if(typeof D.aud=="object"&&!O(D.aud,l.aud))return!1}var A=v.IntDate.getNow();return l.verifyAt!==void 0&&typeof l.verifyAt=="number"&&(A=l.verifyAt),(l.gracePeriod===void 0||typeof l.gracePeriod!="number")&&(l.gracePeriod=0),!(D.exp!==void 0&&typeof D.exp=="number"&&D.exp+l.gracePeriod<A||D.nbf!==void 0&&typeof D.nbf=="number"&&A<D.nbf-l.gracePeriod||D.iat!==void 0&&typeof D.iat=="number"&&A<D.iat-l.gracePeriod||D.jti!==void 0&&l.jti!==void 0&&D.jti!==l.jti||!m.verify(s,c,l.alg))},y.jws.JWS.includedArray=function(s,c){var l=y.jws.JWS.inArray;if(s===null||typeof s!="object"||typeof s.length!="number")return!1;for(var d=0;d<s.length;d++)if(!l(s[d],c))return!1;return!0},y.jws.JWS.inArray=function(s,c){if(c===null||typeof c!="object"||typeof c.length!="number")return!1;for(var l=0;l<c.length;l++)if(c[l]==s)return!0;return!1},y.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},y.jws.JWS.isSafeJSONString=function(s,c,l){var d=null;try{return d=yg(s),typeof d!="object"||d.constructor===Array?0:(c&&(c[l]=d),1)}catch{return 0}},y.jws.JWS.readSafeJSONString=function(s){var c=null;try{return c=yg(s),typeof c!="object"||c.constructor===Array?null:c}catch{return null}},y.jws.JWS.getEncodedSignatureValueFromJWS=function(s){var c=s.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(c==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return c[1]},y.jws.JWS.getJWKthumbprint=function(s){if(s.kty!=="RSA"&&s.kty!=="EC"&&s.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var c="{";if(s.kty==="RSA"){if(typeof s.n!="string"||typeof s.e!="string")throw"wrong n and e value for RSA key";c+='"e":"'+s.e+'",',c+='"kty":"'+s.kty+'",',c+='"n":"'+s.n+'"}'}else if(s.kty==="EC"){if(typeof s.crv!="string"||typeof s.x!="string"||typeof s.y!="string")throw"wrong crv, x and y value for EC key";c+='"crv":"'+s.crv+'",',c+='"kty":"'+s.kty+'",',c+='"x":"'+s.x+'",',c+='"y":"'+s.y+'"}'}else if(s.kty==="oct"){if(typeof s.k!="string")throw"wrong k value for oct(symmetric) key";c+='"kty":"'+s.kty+'",',c+='"k":"'+s.k+'"}'}var l=qi(c),d=y.crypto.Util.hashHex(l,"sha256"),v=Hn(d);return v},y.jws.IntDate={},y.jws.IntDate.get=function(s){var c=y.jws.IntDate,l=c.getNow,d=c.getZulu;if(s=="now")return l();if(s=="now + 1hour")return l()+60*60;if(s=="now + 1day")return l()+60*60*24;if(s=="now + 1month")return l()+60*60*24*30;if(s=="now + 1year")return l()+60*60*24*365;if(s.match(/Z$/))return d(s);if(s.match(/^[0-9]+$/))return parseInt(s);throw"unsupported format: "+s},y.jws.IntDate.getZulu=function(s){return wg(s)},y.jws.IntDate.getNow=function(){var s=~~(new Date/1e3);return s},y.jws.IntDate.intDate2UTCString=function(s){var c=new Date(s*1e3);return c.toUTCString()},y.jws.IntDate.intDate2Zulu=function(s){var c=new Date(s*1e3),l=("0000"+c.getUTCFullYear()).slice(-4),d=("00"+(c.getUTCMonth()+1)).slice(-2),v=("00"+c.getUTCDate()).slice(-2),m=("00"+c.getUTCHours()).slice(-2),T=("00"+c.getUTCMinutes()).slice(-2),k=("00"+c.getUTCSeconds()).slice(-2);return l+d+v+m+T+k+"Z"},(typeof y>"u"||!y)&&(y={}),(typeof y.jws>"u"||!y.jws)&&(y.jws={}),y.jws.JWSJS=function(){var s=y,c=s.jws,l=c.JWS,d=l.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(v){this.init();var m=v.split(".");if(m.length!=3)throw"malformed input JWS";this.aHeader.push(m[0]),this.sPayload=m[1],this.aSignature.push(m[2])},this.addSignature=function(v,m,T,k){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var O=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var F=y.jws.JWS.sign(v,m,this.sPayload,T,k),U=F.split("."),L=U[0],P=U[2];this.aHeader.push(U[0]),this.aSignature.push(U[2])}catch(D){throw this.aHeader.length>O&&this.aHeader.pop(),this.aSignature.length>O&&this.aSignature.pop(),"addSignature failed: "+D}},this.verifyAll=function(v){if(this.aHeader.length!==v.length||this.aSignature.length!==v.length)return!1;for(var m=0;m<v.length;m++){var T=v[m];if(T.length!==2)return!1;var k=this.verifyNth(m,T[0],T[1]);if(k===!1)return!1}return!0},this.verifyNth=function(v,m,T){if(this.aHeader.length<=v||this.aSignature.length<=v)return!1;var k=this.aHeader[v],O=this.aSignature[v],F=k+"."+this.sPayload+"."+O,U=!1;try{U=l.verify(F,m,T)}catch{return!1}return U},this.readJWSJS=function(v){if(typeof v=="string"){var m=d(v);if(m==null)throw"argument is not safe JSON object string";this.aHeader=m.headers,this.sPayload=m.payload,this.aSignature=m.signatures}else try{if(v.headers.length>0)this.aHeader=v.headers;else throw"malformed header";if(typeof v.payload=="string")this.sPayload=v.payload;else throw"malformed signatures";if(v.signatures.length>0)this.aSignature=v.signatures;else throw"malformed signatures"}catch(T){throw"malformed JWS-JS JSON object: "+T}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}},e.SecureRandom=ae,e.rng_seed_time=Za,e.BigInteger=_,e.RSAKey=we,e.ECDSA=y.crypto.ECDSA,e.DSA=y.crypto.DSA,e.Signature=y.crypto.Signature,e.MessageDigest=y.crypto.MessageDigest,e.Mac=y.crypto.Mac,e.KEYUTIL=It,e.ASN1HEX=Me,e.X509=st,e.X509CRL=X2,e.CryptoJS=a,e.b64tohex=h,e.b64toBA=g,e.ECFieldElementFp=tt,e.ECPointFp=it,e.ECCurveFp=as,e.stoBA=_g,e.BAtos=bg,e.BAtohex=ql,e.stohex=Ir,e.stob64=I2,e.stob64u=F2,e.b64utos=D2,e.b64tob64u=Qa,e.b64utob64=rc,e.hex2b64=p,e.hextob64u=Hn,e.b64utohex=an,e.utf8tob64u=ic,e.b64utoutf8=gi,e.utf8tob64=N2,e.b64toutf8=O2,e.utf8tohex=zl,e.hextoutf8=Jt,e.hextorstr=Fr,e.rstrtohex=qi,e.hextob64=Hh,e.hextob64nl=j2,e.b64nltohex=Sg,e.hextopem=sr,e.pemtohex=Cn,e.hextoArrayBuffer=H2,e.ArrayBuffertohex=V2,e.zulutomsec=Vh,e.msectozulu=q2,e.zulutosec=wg,e.zulutodate=z2,e.datetozulu=K2,e.uricmptohex=$l,e.hextouricmp=Wl,e.ipv6tohex=qh,e.hextoipv6=zh,e.hextoip=Gl,e.iptohex=Kh,e.ucs2hextoutf8=$h,e.encodeURIComponentAll=Jl,e.newline_toUnix=$2,e.newline_toDos=W2,e.hextoposhex=Gh,e.intarystrtohex=G2,e.strdiffidx=J2,e.oidtohex=kg,e.hextooid=Zl,e.strpad=Xl,e.bitstrtoint=Rg,e.inttobitstr=Ag,e.bitstrtobinstr=Ig,e.binstrtobitstr=Z2,e.isBase64URLDot=Wh,e.namearraytobinstr=Ql,e.extendClass=Re,e.foldnl=Kl,e.b64topem=B2,e.pemtob64=U2,e.timeogen=xg,e.aryval=Yt,e.inttohex=Tg,e.twoscompl=sc,e.KJUR=y,e.crypto=y.crypto,e.asn1=y.asn1,e.jws=y.jws,e.lang=y.lang,e.VERSION=r,e.VERSION_FULL=i}}),tg=Ce({"../../node_modules/.pnpm/isomorphic-ws@4.0.1_ws@8.18.2/node_modules/isomorphic-ws/browser.js"(e,t){Y();var n=null;typeof WebSocket<"u"?n=WebSocket:typeof MozWebSocket<"u"?n=MozWebSocket:typeof global<"u"?n=global.WebSocket||global.MozWebSocket:typeof window<"u"?n=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(n=self.WebSocket||self.MozWebSocket),t.exports=n}}),u_=Ce({"../../node_modules/.pnpm/deepmerge@4.3.1/node_modules/deepmerge/dist/cjs.js"(e,t){Y();var n=function(M){return r(M)&&!i(M)};function r(E){return!!E&&typeof E=="object"}function i(E){var M=Object.prototype.toString.call(E);return M==="[object RegExp]"||M==="[object Date]"||u(E)}var a=typeof Symbol=="function"&&Symbol.for,o=a?Symbol.for("react.element"):60103;function u(E){return E.$$typeof===o}function p(E){return Array.isArray(E)?[]:{}}function h(E,M){return M.clone!==!1&&M.isMergeableObject(E)?b(p(E),E,M):E}function g(E,M,Z){return E.concat(M).map(function($){return h($,Z)})}function f(E,M){if(!M.customMerge)return b;var Z=M.customMerge(E);return typeof Z=="function"?Z:b}function _(E){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(E).filter(function(M){return Object.propertyIsEnumerable.call(E,M)}):[]}function w(E){return Object.keys(E).concat(_(E))}function C(E,M){try{return M in E}catch{return!1}}function R(E,M){return C(E,M)&&!(Object.hasOwnProperty.call(E,M)&&Object.propertyIsEnumerable.call(E,M))}function S(E,M,Z){var $={};return Z.isMergeableObject(E)&&w(E).forEach(function(z){$[z]=h(E[z],Z)}),w(M).forEach(function(z){R(E,z)||(C(E,z)&&Z.isMergeableObject(M[z])?$[z]=f(z,Z)(E[z],M[z],Z):$[z]=h(M[z],Z))}),$}function b(E,M,Z){Z=Z||{},Z.arrayMerge=Z.arrayMerge||g,Z.isMergeableObject=Z.isMergeableObject||n,Z.cloneUnlessOtherwiseSpecified=h;var $=Array.isArray(M),z=Array.isArray(E),q=$===z;return q?$?Z.arrayMerge(E,M,Z):S(E,M,Z):h(M,Z)}b.all=function(M,Z){if(!Array.isArray(M))throw new Error("first argument should be an array");return M.reduce(function($,z){return b($,z,Z)},{})};var x=b;t.exports=x}}),L4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheClear.js"(e,t){Y();function n(){this.__data__=[],this.size=0}t.exports=n}}),d_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/eq.js"(e,t){Y();function n(r,i){return r===i||r!==r&&i!==i}t.exports=n}}),Yd=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_assocIndexOf.js"(e,t){Y();var n=d_();function r(i,a){for(var o=i.length;o--;)if(n(i[o][0],a))return o;return-1}t.exports=r}}),j4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheDelete.js"(e,t){Y();var n=Yd(),r=Array.prototype,i=r.splice;function a(o){var u=this.__data__,p=n(u,o);if(p<0)return!1;var h=u.length-1;return p==h?u.pop():i.call(u,p,1),--this.size,!0}t.exports=a}}),B4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheGet.js"(e,t){Y();var n=Yd();function r(i){var a=this.__data__,o=n(a,i);return o<0?void 0:a[o][1]}t.exports=r}}),U4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheHas.js"(e,t){Y();var n=Yd();function r(i){return n(this.__data__,i)>-1}t.exports=r}}),H4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheSet.js"(e,t){Y();var n=Yd();function r(i,a){var o=this.__data__,u=n(o,i);return u<0?(++this.size,o.push([i,a])):o[u][1]=a,this}t.exports=r}}),eh=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_ListCache.js"(e,t){Y();var n=L4(),r=j4(),i=B4(),a=U4(),o=H4();function u(p){var h=-1,g=p==null?0:p.length;for(this.clear();++h<g;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),V4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackClear.js"(e,t){Y();var n=eh();function r(){this.__data__=new n,this.size=0}t.exports=r}}),q4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackDelete.js"(e,t){Y();function n(r){var i=this.__data__,a=i.delete(r);return this.size=i.size,a}t.exports=n}}),z4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackGet.js"(e,t){Y();function n(r){return this.__data__.get(r)}t.exports=n}}),K4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackHas.js"(e,t){Y();function n(r){return this.__data__.has(r)}t.exports=n}}),h_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_freeGlobal.js"(e,t){Y();var n=typeof global=="object"&&global&&global.Object===Object&&global;t.exports=n}}),Es=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_root.js"(e,t){Y();var n=h_(),r=typeof self=="object"&&self&&self.Object===Object&&self,i=n||r||Function("return this")();t.exports=i}}),ng=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Symbol.js"(e,t){Y();var n=Es(),r=n.Symbol;t.exports=r}}),$4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getRawTag.js"(e,t){Y();var n=ng(),r=Object.prototype,i=r.hasOwnProperty,a=r.toString,o=n?n.toStringTag:void 0;function u(p){var h=i.call(p,o),g=p[o];try{p[o]=void 0;var f=!0}catch{}var _=a.call(p);return f&&(h?p[o]=g:delete p[o]),_}t.exports=u}}),W4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_objectToString.js"(e,t){Y();var n=Object.prototype,r=n.toString;function i(a){return r.call(a)}t.exports=i}}),th=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseGetTag.js"(e,t){Y();var n=ng(),r=$4(),i=W4(),a="[object Null]",o="[object Undefined]",u=n?n.toStringTag:void 0;function p(h){return h==null?h===void 0?o:a:u&&u in Object(h)?r(h):i(h)}t.exports=p}}),p_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObject.js"(e,t){Y();function n(r){var i=typeof r;return r!=null&&(i=="object"||i=="function")}t.exports=n}}),f_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isFunction.js"(e,t){Y();var n=th(),r=p_(),i="[object AsyncFunction]",a="[object Function]",o="[object GeneratorFunction]",u="[object Proxy]";function p(h){if(!r(h))return!1;var g=n(h);return g==a||g==o||g==i||g==u}t.exports=p}}),G4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_coreJsData.js"(e,t){Y();var n=Es(),r=n["__core-js_shared__"];t.exports=r}}),J4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isMasked.js"(e,t){Y();var n=G4(),r=function(){var a=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();function i(a){return!!r&&r in a}t.exports=i}}),m_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_toSource.js"(e,t){Y();var n=Function.prototype,r=n.toString;function i(a){if(a!=null){try{return r.call(a)}catch{}try{return a+""}catch{}}return""}t.exports=i}}),Z4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsNative.js"(e,t){Y();var n=f_(),r=J4(),i=p_(),a=m_(),o=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,p=Function.prototype,h=Object.prototype,g=p.toString,f=h.hasOwnProperty,_=RegExp("^"+g.call(f).replace(o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function w(C){if(!i(C)||r(C))return!1;var R=n(C)?_:u;return R.test(a(C))}t.exports=w}}),X4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getValue.js"(e,t){Y();function n(r,i){return r==null?void 0:r[i]}t.exports=n}}),qo=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getNative.js"(e,t){Y();var n=Z4(),r=X4();function i(a,o){var u=r(a,o);return n(u)?u:void 0}t.exports=i}}),rg=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Map.js"(e,t){Y();var n=qo(),r=Es(),i=n(r,"Map");t.exports=i}}),nh=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nativeCreate.js"(e,t){Y();var n=qo(),r=n(Object,"create");t.exports=r}}),Q4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashClear.js"(e,t){Y();var n=nh();function r(){this.__data__=n?n(null):{},this.size=0}t.exports=r}}),Y4=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashDelete.js"(e,t){Y();function n(r){var i=this.has(r)&&delete this.__data__[r];return this.size-=i?1:0,i}t.exports=n}}),e3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashGet.js"(e,t){Y();var n=nh(),r="__lodash_hash_undefined__",i=Object.prototype,a=i.hasOwnProperty;function o(u){var p=this.__data__;if(n){var h=p[u];return h===r?void 0:h}return a.call(p,u)?p[u]:void 0}t.exports=o}}),t3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashHas.js"(e,t){Y();var n=nh(),r=Object.prototype,i=r.hasOwnProperty;function a(o){var u=this.__data__;return n?u[o]!==void 0:i.call(u,o)}t.exports=a}}),n3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashSet.js"(e,t){Y();var n=nh(),r="__lodash_hash_undefined__";function i(a,o){var u=this.__data__;return this.size+=this.has(a)?0:1,u[a]=n&&o===void 0?r:o,this}t.exports=i}}),r3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Hash.js"(e,t){Y();var n=Q4(),r=Y4(),i=e3(),a=t3(),o=n3();function u(p){var h=-1,g=p==null?0:p.length;for(this.clear();++h<g;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),i3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheClear.js"(e,t){Y();var n=r3(),r=eh(),i=rg();function a(){this.size=0,this.__data__={hash:new n,map:new(i||r),string:new n}}t.exports=a}}),s3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isKeyable.js"(e,t){Y();function n(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}t.exports=n}}),rh=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getMapData.js"(e,t){Y();var n=s3();function r(i,a){var o=i.__data__;return n(a)?o[typeof a=="string"?"string":"hash"]:o.map}t.exports=r}}),a3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheDelete.js"(e,t){Y();var n=rh();function r(i){var a=n(this,i).delete(i);return this.size-=a?1:0,a}t.exports=r}}),o3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheGet.js"(e,t){Y();var n=rh();function r(i){return n(this,i).get(i)}t.exports=r}}),c3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheHas.js"(e,t){Y();var n=rh();function r(i){return n(this,i).has(i)}t.exports=r}}),l3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheSet.js"(e,t){Y();var n=rh();function r(i,a){var o=n(this,i),u=o.size;return o.set(i,a),this.size+=o.size==u?0:1,this}t.exports=r}}),g_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_MapCache.js"(e,t){Y();var n=i3(),r=a3(),i=o3(),a=c3(),o=l3();function u(p){var h=-1,g=p==null?0:p.length;for(this.clear();++h<g;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),u3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackSet.js"(e,t){Y();var n=eh(),r=rg(),i=g_(),a=200;function o(u,p){var h=this.__data__;if(h instanceof n){var g=h.__data__;if(!r||g.length<a-1)return g.push([u,p]),this.size=++h.size,this;h=this.__data__=new i(g)}return h.set(u,p),this.size=h.size,this}t.exports=o}}),d3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Stack.js"(e,t){Y();var n=eh(),r=V4(),i=q4(),a=z4(),o=K4(),u=u3();function p(h){var g=this.__data__=new n(h);this.size=g.size}p.prototype.clear=r,p.prototype.delete=i,p.prototype.get=a,p.prototype.has=o,p.prototype.set=u,t.exports=p}}),h3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setCacheAdd.js"(e,t){Y();var n="__lodash_hash_undefined__";function r(i){return this.__data__.set(i,n),this}t.exports=r}}),p3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setCacheHas.js"(e,t){Y();function n(r){return this.__data__.has(r)}t.exports=n}}),f3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_SetCache.js"(e,t){Y();var n=g_(),r=h3(),i=p3();function a(o){var u=-1,p=o==null?0:o.length;for(this.__data__=new n;++u<p;)this.add(o[u])}a.prototype.add=a.prototype.push=r,a.prototype.has=i,t.exports=a}}),m3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arraySome.js"(e,t){Y();function n(r,i){for(var a=-1,o=r==null?0:r.length;++a<o;)if(i(r[a],a,r))return!0;return!1}t.exports=n}}),g3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_cacheHas.js"(e,t){Y();function n(r,i){return r.has(i)}t.exports=n}}),v_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalArrays.js"(e,t){Y();var n=f3(),r=m3(),i=g3(),a=1,o=2;function u(p,h,g,f,_,w){var C=g&a,R=p.length,S=h.length;if(R!=S&&!(C&&S>R))return!1;var b=w.get(p),x=w.get(h);if(b&&x)return b==h&&x==p;var E=-1,M=!0,Z=g&o?new n:void 0;for(w.set(p,h),w.set(h,p);++E<R;){var $=p[E],z=h[E];if(f)var q=C?f(z,$,E,h,p,w):f($,z,E,p,h,w);if(q!==void 0){if(q)continue;M=!1;break}if(Z){if(!r(h,function(Q,K){if(!i(Z,K)&&($===Q||_($,Q,g,f,w)))return Z.push(K)})){M=!1;break}}else if(!($===z||_($,z,g,f,w))){M=!1;break}}return w.delete(p),w.delete(h),M}t.exports=u}}),v3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Uint8Array.js"(e,t){Y();var n=Es(),r=n.Uint8Array;t.exports=r}}),y3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapToArray.js"(e,t){Y();function n(r){var i=-1,a=Array(r.size);return r.forEach(function(o,u){a[++i]=[u,o]}),a}t.exports=n}}),_3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setToArray.js"(e,t){Y();function n(r){var i=-1,a=Array(r.size);return r.forEach(function(o){a[++i]=o}),a}t.exports=n}}),b3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalByTag.js"(e,t){Y();var n=ng(),r=v3(),i=d_(),a=v_(),o=y3(),u=_3(),p=1,h=2,g="[object Boolean]",f="[object Date]",_="[object Error]",w="[object Map]",C="[object Number]",R="[object RegExp]",S="[object Set]",b="[object String]",x="[object Symbol]",E="[object ArrayBuffer]",M="[object DataView]",Z=n?n.prototype:void 0,$=Z?Z.valueOf:void 0;function z(q,Q,K,ee,oe,ce,ne){switch(K){case M:if(q.byteLength!=Q.byteLength||q.byteOffset!=Q.byteOffset)return!1;q=q.buffer,Q=Q.buffer;case E:return!(q.byteLength!=Q.byteLength||!ce(new r(q),new r(Q)));case g:case f:case C:return i(+q,+Q);case _:return q.name==Q.name&&q.message==Q.message;case R:case b:return q==Q+"";case w:var ke=o;case S:var _e=ee&p;if(ke||(ke=u),q.size!=Q.size&&!_e)return!1;var le=ne.get(q);if(le)return le==Q;ee|=h,ne.set(q,Q);var fe=a(ke(q),ke(Q),ee,oe,ce,ne);return ne.delete(q),fe;case x:if($)return $.call(q)==$.call(Q)}return!1}t.exports=z}}),S3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayPush.js"(e,t){Y();function n(r,i){for(var a=-1,o=i.length,u=r.length;++a<o;)r[u+a]=i[a];return r}t.exports=n}}),ig=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArray.js"(e,t){Y();var n=Array.isArray;t.exports=n}}),w3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseGetAllKeys.js"(e,t){Y();var n=S3(),r=ig();function i(a,o,u){var p=o(a);return r(a)?p:n(p,u(a))}t.exports=i}}),x3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayFilter.js"(e,t){Y();function n(r,i){for(var a=-1,o=r==null?0:r.length,u=0,p=[];++a<o;){var h=r[a];i(h,a,r)&&(p[u++]=h)}return p}t.exports=n}}),C3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/stubArray.js"(e,t){Y();function n(){return[]}t.exports=n}}),E3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getSymbols.js"(e,t){Y();var n=x3(),r=C3(),i=Object.prototype,a=i.propertyIsEnumerable,o=Object.getOwnPropertySymbols,u=o?function(p){return p==null?[]:(p=Object(p),n(o(p),function(h){return a.call(p,h)}))}:r;t.exports=u}}),P3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseTimes.js"(e,t){Y();function n(r,i){for(var a=-1,o=Array(r);++a<r;)o[a]=i(a);return o}t.exports=n}}),ih=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObjectLike.js"(e,t){Y();function n(r){return r!=null&&typeof r=="object"}t.exports=n}}),k3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsArguments.js"(e,t){Y();var n=th(),r=ih(),i="[object Arguments]";function a(o){return r(o)&&n(o)==i}t.exports=a}}),T3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArguments.js"(e,t){Y();var n=k3(),r=ih(),i=Object.prototype,a=i.hasOwnProperty,o=i.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(p){return r(p)&&a.call(p,"callee")&&!o.call(p,"callee")};t.exports=u}}),R3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/stubFalse.js"(e,t){Y();function n(){return!1}t.exports=n}}),y_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isBuffer.js"(e,t){Y();var n=Es(),r=R3(),i=typeof e=="object"&&e&&!e.nodeType&&e,a=i&&typeof t=="object"&&t&&!t.nodeType&&t,o=a&&a.exports===i,u=o?n.Buffer:void 0,p=u?u.isBuffer:void 0,h=p||r;t.exports=h}}),A3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isIndex.js"(e,t){Y();var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;function i(a,o){var u=typeof a;return o=o??n,!!o&&(u=="number"||u!="symbol"&&r.test(a))&&a>-1&&a%1==0&&a<o}t.exports=i}}),__=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isLength.js"(e,t){Y();var n=9007199254740991;function r(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=n}t.exports=r}}),I3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsTypedArray.js"(e,t){Y();var n=th(),r=__(),i=ih(),a="[object Arguments]",o="[object Array]",u="[object Boolean]",p="[object Date]",h="[object Error]",g="[object Function]",f="[object Map]",_="[object Number]",w="[object Object]",C="[object RegExp]",R="[object Set]",S="[object String]",b="[object WeakMap]",x="[object ArrayBuffer]",E="[object DataView]",M="[object Float32Array]",Z="[object Float64Array]",$="[object Int8Array]",z="[object Int16Array]",q="[object Int32Array]",Q="[object Uint8Array]",K="[object Uint8ClampedArray]",ee="[object Uint16Array]",oe="[object Uint32Array]",ce={};ce[M]=ce[Z]=ce[$]=ce[z]=ce[q]=ce[Q]=ce[K]=ce[ee]=ce[oe]=!0,ce[a]=ce[o]=ce[x]=ce[u]=ce[E]=ce[p]=ce[h]=ce[g]=ce[f]=ce[_]=ce[w]=ce[C]=ce[R]=ce[S]=ce[b]=!1;function ne(ke){return i(ke)&&r(ke.length)&&!!ce[n(ke)]}t.exports=ne}}),F3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseUnary.js"(e,t){Y();function n(r){return function(i){return r(i)}}t.exports=n}}),D3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nodeUtil.js"(e,t){Y();var n=h_(),r=typeof e=="object"&&e&&!e.nodeType&&e,i=r&&typeof t=="object"&&t&&!t.nodeType&&t,a=i&&i.exports===r,o=a&&n.process,u=function(){try{var p=i&&i.require&&i.require("util").types;return p||o&&o.binding&&o.binding("util")}catch{}}();t.exports=u}}),b_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isTypedArray.js"(e,t){Y();var n=I3(),r=F3(),i=D3(),a=i&&i.isTypedArray,o=a?r(a):n;t.exports=o}}),N3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayLikeKeys.js"(e,t){Y();var n=P3(),r=T3(),i=ig(),a=y_(),o=A3(),u=b_(),p=Object.prototype,h=p.hasOwnProperty;function g(f,_){var w=i(f),C=!w&&r(f),R=!w&&!C&&a(f),S=!w&&!C&&!R&&u(f),b=w||C||R||S,x=b?n(f.length,String):[],E=x.length;for(var M in f)(_||h.call(f,M))&&!(b&&(M=="length"||R&&(M=="offset"||M=="parent")||S&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||o(M,E)))&&x.push(M);return x}t.exports=g}}),O3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isPrototype.js"(e,t){Y();var n=Object.prototype;function r(i){var a=i&&i.constructor,o=typeof a=="function"&&a.prototype||n;return i===o}t.exports=r}}),M3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_overArg.js"(e,t){Y();function n(r,i){return function(a){return r(i(a))}}t.exports=n}}),L3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nativeKeys.js"(e,t){Y();var n=M3(),r=n(Object.keys,Object);t.exports=r}}),j3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseKeys.js"(e,t){Y();var n=O3(),r=L3(),i=Object.prototype,a=i.hasOwnProperty;function o(u){if(!n(u))return r(u);var p=[];for(var h in Object(u))a.call(u,h)&&h!="constructor"&&p.push(h);return p}t.exports=o}}),B3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArrayLike.js"(e,t){Y();var n=f_(),r=__();function i(a){return a!=null&&r(a.length)&&!n(a)}t.exports=i}}),U3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/keys.js"(e,t){Y();var n=N3(),r=j3(),i=B3();function a(o){return i(o)?n(o):r(o)}t.exports=a}}),H3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getAllKeys.js"(e,t){Y();var n=w3(),r=E3(),i=U3();function a(o){return n(o,i,r)}t.exports=a}}),V3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalObjects.js"(e,t){Y();var n=H3(),r=1,i=Object.prototype,a=i.hasOwnProperty;function o(u,p,h,g,f,_){var w=h&r,C=n(u),R=C.length,S=n(p),b=S.length;if(R!=b&&!w)return!1;for(var x=R;x--;){var E=C[x];if(!(w?E in p:a.call(p,E)))return!1}var M=_.get(u),Z=_.get(p);if(M&&Z)return M==p&&Z==u;var $=!0;_.set(u,p),_.set(p,u);for(var z=w;++x<R;){E=C[x];var q=u[E],Q=p[E];if(g)var K=w?g(Q,q,E,p,u,_):g(q,Q,E,u,p,_);if(!(K===void 0?q===Q||f(q,Q,h,g,_):K)){$=!1;break}z||(z=E=="constructor")}if($&&!z){var ee=u.constructor,oe=p.constructor;ee!=oe&&"constructor"in u&&"constructor"in p&&!(typeof ee=="function"&&ee instanceof ee&&typeof oe=="function"&&oe instanceof oe)&&($=!1)}return _.delete(u),_.delete(p),$}t.exports=o}}),q3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_DataView.js"(e,t){Y();var n=qo(),r=Es(),i=n(r,"DataView");t.exports=i}}),z3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Promise.js"(e,t){Y();var n=qo(),r=Es(),i=n(r,"Promise");t.exports=i}}),K3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Set.js"(e,t){Y();var n=qo(),r=Es(),i=n(r,"Set");t.exports=i}}),$3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_WeakMap.js"(e,t){Y();var n=qo(),r=Es(),i=n(r,"WeakMap");t.exports=i}}),W3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getTag.js"(e,t){Y();var n=q3(),r=rg(),i=z3(),a=K3(),o=$3(),u=th(),p=m_(),h="[object Map]",g="[object Object]",f="[object Promise]",_="[object Set]",w="[object WeakMap]",C="[object DataView]",R=p(n),S=p(r),b=p(i),x=p(a),E=p(o),M=u;(n&&M(new n(new ArrayBuffer(1)))!=C||r&&M(new r)!=h||i&&M(i.resolve())!=f||a&&M(new a)!=_||o&&M(new o)!=w)&&(M=function(Z){var $=u(Z),z=$==g?Z.constructor:void 0,q=z?p(z):"";if(q)switch(q){case R:return C;case S:return h;case b:return f;case x:return _;case E:return w}return $}),t.exports=M}}),G3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsEqualDeep.js"(e,t){Y();var n=d3(),r=v_(),i=b3(),a=V3(),o=W3(),u=ig(),p=y_(),h=b_(),g=1,f="[object Arguments]",_="[object Array]",w="[object Object]",C=Object.prototype,R=C.hasOwnProperty;function S(b,x,E,M,Z,$){var z=u(b),q=u(x),Q=z?_:o(b),K=q?_:o(x);Q=Q==f?w:Q,K=K==f?w:K;var ee=Q==w,oe=K==w,ce=Q==K;if(ce&&p(b)){if(!p(x))return!1;z=!0,ee=!1}if(ce&&!ee)return $||($=new n),z||h(b)?r(b,x,E,M,Z,$):i(b,x,Q,E,M,Z,$);if(!(E&g)){var ne=ee&&R.call(b,"__wrapped__"),ke=oe&&R.call(x,"__wrapped__");if(ne||ke){var _e=ne?b.value():b,le=ke?x.value():x;return $||($=new n),Z(_e,le,E,M,$)}}return ce?($||($=new n),a(b,x,E,M,Z,$)):!1}t.exports=S}}),J3=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsEqual.js"(e,t){Y();var n=G3(),r=ih();function i(a,o,u,p,h){return a===o?!0:a==null||o==null||!r(a)&&!r(o)?a!==a&&o!==o:n(a,o,u,p,i,h)}t.exports=i}}),S_=Ce({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEqual.js"(e,t){Y();var n=J3();function r(i,a){return n(i,a)}t.exports=r}}),Z3=Ce({"../../node_modules/.pnpm/ms@2.1.3/node_modules/ms/index.js"(e,t){Y();var n=1e3,r=n*60,i=r*60,a=i*24,o=a*7,u=a*365.25;t.exports=function(_,w){w=w||{};var C=typeof _;if(C==="string"&&_.length>0)return p(_);if(C==="number"&&isFinite(_))return w.long?g(_):h(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function p(_){if(_=String(_),!(_.length>100)){var w=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(w){var C=parseFloat(w[1]),R=(w[2]||"ms").toLowerCase();switch(R){case"years":case"year":case"yrs":case"yr":case"y":return C*u;case"weeks":case"week":case"w":return C*o;case"days":case"day":case"d":return C*a;case"hours":case"hour":case"hrs":case"hr":case"h":return C*i;case"minutes":case"minute":case"mins":case"min":case"m":return C*r;case"seconds":case"second":case"secs":case"sec":case"s":return C*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return C;default:return}}}}function h(_){var w=Math.abs(_);return w>=a?Math.round(_/a)+"d":w>=i?Math.round(_/i)+"h":w>=r?Math.round(_/r)+"m":w>=n?Math.round(_/n)+"s":_+"ms"}function g(_){var w=Math.abs(_);return w>=a?f(_,w,a,"day"):w>=i?f(_,w,i,"hour"):w>=r?f(_,w,r,"minute"):w>=n?f(_,w,n,"second"):_+" ms"}function f(_,w,C,R){var S=w>=C*1.5;return Math.round(_/C)+" "+R+(S?"s":"")}}}),X3=Ce({"../../node_modules/.pnpm/debug@4.4.1_supports-color@10.2.0/node_modules/debug/src/common.js"(e,t){Y();function n(r){a.debug=a,a.default=a,a.coerce=f,a.disable=h,a.enable=u,a.enabled=g,a.humanize=Z3(),a.destroy=_,Object.keys(r).forEach(w=>{a[w]=r[w]}),a.names=[],a.skips=[],a.formatters={};function i(w){let C=0;for(let R=0;R<w.length;R++)C=(C<<5)-C+w.charCodeAt(R),C|=0;return a.colors[Math.abs(C)%a.colors.length]}a.selectColor=i;function a(w){let C,R=null,S,b;function x(...E){if(!x.enabled)return;const M=x,Z=Number(new Date),$=Z-(C||Z);M.diff=$,M.prev=C,M.curr=Z,C=Z,E[0]=a.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let z=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(Q,K)=>{if(Q==="%%")return"%";z++;const ee=a.formatters[K];if(typeof ee=="function"){const oe=E[z];Q=ee.call(M,oe),E.splice(z,1),z--}return Q}),a.formatArgs.call(M,E),(M.log||a.log).apply(M,E)}return x.namespace=w,x.useColors=a.useColors(),x.color=a.selectColor(w),x.extend=o,x.destroy=a.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>R!==null?R:(S!==a.namespaces&&(S=a.namespaces,b=a.enabled(w)),b),set:E=>{R=E}}),typeof a.init=="function"&&a.init(x),x}function o(w,C){const R=a(this.namespace+(typeof C>"u"?":":C)+w);return R.log=this.log,R}function u(w){a.save(w),a.namespaces=w,a.names=[],a.skips=[];const C=(typeof w=="string"?w:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const R of C)R[0]==="-"?a.skips.push(R.slice(1)):a.names.push(R)}function p(w,C){let R=0,S=0,b=-1,x=0;for(;R<w.length;)if(S<C.length&&(C[S]===w[R]||C[S]==="*"))C[S]==="*"?(b=S,x=R,S++):(R++,S++);else if(b!==-1)S=b+1,x++,R=x;else return!1;for(;S<C.length&&C[S]==="*";)S++;return S===C.length}function h(){const w=[...a.names,...a.skips.map(C=>"-"+C)].join(",");return a.enable(""),w}function g(w){for(const C of a.skips)if(p(w,C))return!1;for(const C of a.names)if(p(w,C))return!0;return!1}function f(w){return w instanceof Error?w.stack||w.message:w}function _(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}t.exports=n}}),sh=Ce({"../../node_modules/.pnpm/debug@4.4.1_supports-color@10.2.0/node_modules/debug/src/browser.js"(e,t){Y(),e.formatArgs=r,e.save=i,e.load=a,e.useColors=n,e.storage=o(),e.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let p;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(p=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(p[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const h="color: "+this.color;p.splice(1,0,h,"color: inherit");let g=0,f=0;p[0].replace(/%[a-zA-Z%]/g,_=>{_!=="%%"&&(g++,_==="%c"&&(f=g))}),p.splice(f,0,h)}e.log=console.debug||console.log||(()=>{});function i(p){try{p?e.storage.setItem("debug",p):e.storage.removeItem("debug")}catch{}}function a(){let p;try{p=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!p&&typeof Eo<"u"&&"env"in Eo&&(p=Eo.env.DEBUG),p}function o(){try{return localStorage}catch{}}t.exports=X3()(e);var{formatters:u}=t.exports;u.j=function(p){try{return JSON.stringify(p)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}}),Q3=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/types.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0})}}),zr=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Logger.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var t=sh(),n="mediasoup-client",r=class{constructor(i){me(this,"_debug"),me(this,"_warn"),me(this,"_error"),i?(this._debug=(0,t.default)(`${n}:${i}`),this._warn=(0,t.default)(`${n}:WARN:${i}`),this._error=(0,t.default)(`${n}:ERROR:${i}`)):(this._debug=(0,t.default)(n),this._warn=(0,t.default)(`${n}:WARN`),this._error=(0,t.default)(`${n}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=r}}),Y3=Ce({"../../node_modules/.pnpm/events@3.3.0/node_modules/events/events.js"(e,t){Y();var n=typeof Reflect=="object"?Reflect:null,r=n&&typeof n.apply=="function"?n.apply:function(z,q,Q){return Function.prototype.apply.call(z,q,Q)},i;n&&typeof n.ownKeys=="function"?i=n.ownKeys:Object.getOwnPropertySymbols?i=function(z){return Object.getOwnPropertyNames(z).concat(Object.getOwnPropertySymbols(z))}:i=function(z){return Object.getOwnPropertyNames(z)};function a($){console&&console.warn&&console.warn($)}var o=Number.isNaN||function(z){return z!==z};function u(){u.init.call(this)}t.exports=u,t.exports.once=E,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var p=10;function h($){if(typeof $!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof $)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function($){if(typeof $!="number"||$<0||o($))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+$+".");p=$}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(z){if(typeof z!="number"||z<0||o(z))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+z+".");return this._maxListeners=z,this};function g($){return $._maxListeners===void 0?u.defaultMaxListeners:$._maxListeners}u.prototype.getMaxListeners=function(){return g(this)},u.prototype.emit=function(z){for(var q=[],Q=1;Q<arguments.length;Q++)q.push(arguments[Q]);var K=z==="error",ee=this._events;if(ee!==void 0)K=K&&ee.error===void 0;else if(!K)return!1;if(K){var oe;if(q.length>0&&(oe=q[0]),oe instanceof Error)throw oe;var ce=new Error("Unhandled error."+(oe?" ("+oe.message+")":""));throw ce.context=oe,ce}var ne=ee[z];if(ne===void 0)return!1;if(typeof ne=="function")r(ne,this,q);else for(var ke=ne.length,_e=S(ne,ke),Q=0;Q<ke;++Q)r(_e[Q],this,q);return!0};function f($,z,q,Q){var K,ee,oe;if(h(q),ee=$._events,ee===void 0?(ee=$._events=Object.create(null),$._eventsCount=0):(ee.newListener!==void 0&&($.emit("newListener",z,q.listener?q.listener:q),ee=$._events),oe=ee[z]),oe===void 0)oe=ee[z]=q,++$._eventsCount;else if(typeof oe=="function"?oe=ee[z]=Q?[q,oe]:[oe,q]:Q?oe.unshift(q):oe.push(q),K=g($),K>0&&oe.length>K&&!oe.warned){oe.warned=!0;var ce=new Error("Possible EventEmitter memory leak detected. "+oe.length+" "+String(z)+" listeners added. Use emitter.setMaxListeners() to increase limit");ce.name="MaxListenersExceededWarning",ce.emitter=$,ce.type=z,ce.count=oe.length,a(ce)}return $}u.prototype.addListener=function(z,q){return f(this,z,q,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(z,q){return f(this,z,q,!0)};function _(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w($,z,q){var Q={fired:!1,wrapFn:void 0,target:$,type:z,listener:q},K=_.bind(Q);return K.listener=q,Q.wrapFn=K,K}u.prototype.once=function(z,q){return h(q),this.on(z,w(this,z,q)),this},u.prototype.prependOnceListener=function(z,q){return h(q),this.prependListener(z,w(this,z,q)),this},u.prototype.removeListener=function(z,q){var Q,K,ee,oe,ce;if(h(q),K=this._events,K===void 0)return this;if(Q=K[z],Q===void 0)return this;if(Q===q||Q.listener===q)--this._eventsCount===0?this._events=Object.create(null):(delete K[z],K.removeListener&&this.emit("removeListener",z,Q.listener||q));else if(typeof Q!="function"){for(ee=-1,oe=Q.length-1;oe>=0;oe--)if(Q[oe]===q||Q[oe].listener===q){ce=Q[oe].listener,ee=oe;break}if(ee<0)return this;ee===0?Q.shift():b(Q,ee),Q.length===1&&(K[z]=Q[0]),K.removeListener!==void 0&&this.emit("removeListener",z,ce||q)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(z){var q,Q,K;if(Q=this._events,Q===void 0)return this;if(Q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Q[z]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Q[z]),this;if(arguments.length===0){var ee=Object.keys(Q),oe;for(K=0;K<ee.length;++K)oe=ee[K],oe!=="removeListener"&&this.removeAllListeners(oe);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(q=Q[z],typeof q=="function")this.removeListener(z,q);else if(q!==void 0)for(K=q.length-1;K>=0;K--)this.removeListener(z,q[K]);return this};function C($,z,q){var Q=$._events;if(Q===void 0)return[];var K=Q[z];return K===void 0?[]:typeof K=="function"?q?[K.listener||K]:[K]:q?x(K):S(K,K.length)}u.prototype.listeners=function(z){return C(this,z,!0)},u.prototype.rawListeners=function(z){return C(this,z,!1)},u.listenerCount=function($,z){return typeof $.listenerCount=="function"?$.listenerCount(z):R.call($,z)},u.prototype.listenerCount=R;function R($){var z=this._events;if(z!==void 0){var q=z[$];if(typeof q=="function")return 1;if(q!==void 0)return q.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function S($,z){for(var q=new Array(z),Q=0;Q<z;++Q)q[Q]=$[Q];return q}function b($,z){for(;z+1<$.length;z++)$[z]=$[z+1];$.pop()}function x($){for(var z=new Array($.length),q=0;q<z.length;++q)z[q]=$[q].listener||$[q];return z}function E($,z){return new Promise(function(q,Q){function K(oe){$.removeListener(z,ee),Q(oe)}function ee(){typeof $.removeListener=="function"&&$.removeListener("error",K),q([].slice.call(arguments))}Z($,z,ee,{once:!0}),z!=="error"&&M($,K,{once:!0})})}function M($,z,q){typeof $.on=="function"&&Z($,"error",z,q)}function Z($,z,q,Q){if(typeof $.on=="function")Q.once?$.once(z,q):$.on(z,q);else if(typeof $.addEventListener=="function")$.addEventListener(z,function K(ee){Q.once&&$.removeEventListener(z,K),q(ee)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof $)}}}),Yr=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/enhancedEvents.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.EnhancedEventEmitter=void 0;var t=Y3(),n=zr(),r=new n.Logger("EnhancedEventEmitter"),i=class extends t.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}close(){super.removeAllListeners()}emit(a,...o){return super.emit(a,...o)}safeEmit(a,...o){try{return super.emit(a,...o)}catch(u){r.error("safeEmit() | event listener threw an error [eventName:%s]:%o",a,u);try{super.emit("listenererror",a,u)}catch{}return!!super.listenerCount(a)}}on(a,o){return super.on(a,o),this}off(a,o){return super.off(a,o),this}addListener(a,o){return super.on(a,o),this}prependListener(a,o){return super.prependListener(a,o),this}once(a,o){return super.once(a,o),this}prependOnceListener(a,o){return super.prependOnceListener(a,o),this}removeListener(a,o){return super.off(a,o),this}removeAllListeners(a){return super.removeAllListeners(a),this}listenerCount(a){return super.listenerCount(a)}listeners(a){return super.listeners(a)}rawListeners(a){return super.rawListeners(a)}};e.EnhancedEventEmitter=i}}),Mi=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/errors.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidStateError=e.UnsupportedError=void 0;var t=class w_ extends Error{constructor(i){super(i),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,w_):this.stack=new Error(i).stack}};e.UnsupportedError=t;var n=class x_ extends Error{constructor(i){super(i),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,x_):this.stack=new Error(i).stack}};e.InvalidStateError=n}}),zo=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.clone=t,e.generateRandomNumber=n,e.deepFreeze=r;function t(i){if(i!==void 0)return Number.isNaN(i)?NaN:typeof structuredClone=="function"?structuredClone(i):JSON.parse(JSON.stringify(i))}function n(){return Math.round(Math.random()*1e7)}function r(i){const a=Reflect.ownKeys(i);for(const o of a){const u=i[o];(u&&typeof u=="object"||typeof u=="function")&&r(u)}return Object.freeze(i)}}}),ex=Ce({"../../node_modules/.pnpm/h264-profile-level-id@2.2.3_supports-color@10.2.0/node_modules/h264-profile-level-id/lib/Logger.js"(e){Y();var t=e&&e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var n=t(sh()),r="h264-profile-level-id",i=class{constructor(a){a?(this._debug=(0,n.default)(`${r}:${a}`),this._warn=(0,n.default)(`${r}:WARN:${a}`),this._error=(0,n.default)(`${r}:ERROR:${a}`)):(this._debug=(0,n.default)(r),this._warn=(0,n.default)(`${r}:WARN`),this._error=(0,n.default)(`${r}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=i}}),tx=Ce({"../../node_modules/.pnpm/h264-profile-level-id@2.2.3_supports-color@10.2.0/node_modules/h264-profile-level-id/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.ProfileLevelId=e.Level=e.Profile=void 0,e.parseProfileLevelId=f,e.profileLevelIdToString=_,e.profileToString=w,e.levelToString=C,e.parseSdpProfileLevelId=R,e.isSameProfile=S,e.isSameProfileAndLevel=b,e.generateProfileLevelIdStringForAnswer=x,e.supportedLevel=E;var t=ex(),n=new t.Logger,r;(function(q){q[q.ConstrainedBaseline=1]="ConstrainedBaseline",q[q.Baseline=2]="Baseline",q[q.Main=3]="Main",q[q.ConstrainedHigh=4]="ConstrainedHigh",q[q.High=5]="High",q[q.PredictiveHigh444=6]="PredictiveHigh444"})(r||(e.Profile=r={}));var i;(function(q){q[q.L1_b=0]="L1_b",q[q.L1=10]="L1",q[q.L1_1=11]="L1_1",q[q.L1_2=12]="L1_2",q[q.L1_3=13]="L1_3",q[q.L2=20]="L2",q[q.L2_1=21]="L2_1",q[q.L2_2=22]="L2_2",q[q.L3=30]="L3",q[q.L3_1=31]="L3_1",q[q.L3_2=32]="L3_2",q[q.L4=40]="L4",q[q.L4_1=41]="L4_1",q[q.L4_2=42]="L4_2",q[q.L5=50]="L5",q[q.L5_1=51]="L5_1",q[q.L5_2=52]="L5_2"})(i||(e.Level=i={}));var a=class{constructor(q,Q){this.profile=q,this.level=Q}};e.ProfileLevelId=a;var o=new a(r.ConstrainedBaseline,i.L3_1),u=class{constructor(q){this.mask=~M("x",q),this.masked_value=M("1",q)}isMatch(q){return this.masked_value===(q&this.mask)}},p=class{constructor(q,Q,K){this.profile_idc=q,this.profile_iop=Q,this.profile=K}},h=[new p(66,new u("x1xx0000"),r.ConstrainedBaseline),new p(77,new u("1xxx0000"),r.ConstrainedBaseline),new p(88,new u("11xx0000"),r.ConstrainedBaseline),new p(66,new u("x0xx0000"),r.Baseline),new p(88,new u("10xx0000"),r.Baseline),new p(77,new u("0x0x0000"),r.Main),new p(100,new u("00000000"),r.High),new p(100,new u("00001100"),r.ConstrainedHigh),new p(244,new u("00000000"),r.PredictiveHigh444)],g=[{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:i.L1},{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:i.L1_b},{max_macroblocks_per_second:3e3,max_macroblock_frame_size:396,level:i.L1_1},{max_macroblocks_per_second:6e3,max_macroblock_frame_size:396,level:i.L1_2},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:i.L1_3},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:i.L2},{max_macroblocks_per_second:19800,max_macroblock_frame_size:792,level:i.L2_1},{max_macroblocks_per_second:20250,max_macroblock_frame_size:1620,level:i.L2_2},{max_macroblocks_per_second:40500,max_macroblock_frame_size:1620,level:i.L3},{max_macroblocks_per_second:108e3,max_macroblock_frame_size:3600,level:i.L3_1},{max_macroblocks_per_second:216e3,max_macroblock_frame_size:5120,level:i.L3_2},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:i.L4},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:i.L4_1},{max_macroblocks_per_second:522240,max_macroblock_frame_size:8704,level:i.L4_2},{max_macroblocks_per_second:589824,max_macroblock_frame_size:22080,level:i.L5},{max_macroblocks_per_second:983040,max_macroblock_frame_size:36864,level:i.L5_1},{max_macroblocks_per_second:2073600,max_macroblock_frame_size:36864,level:i.L5_2}];function f(q){if(typeof q!="string"||q.length!==6)return;const K=parseInt(q,16);if(K===0)return;const ee=K&255,oe=K>>8&255,ce=K>>16&255;let ne;switch(ee){case i.L1_1:{ne=oe&16?i.L1_b:i.L1_1;break}case i.L1:case i.L1_2:case i.L1_3:case i.L2:case i.L2_1:case i.L2_2:case i.L3:case i.L3_1:case i.L3_2:case i.L4:case i.L4_1:case i.L4_2:case i.L5:case i.L5_1:case i.L5_2:{ne=ee;break}default:{n.warn(`parseProfileLevelId() | unrecognized level_idc [str:${q}, level_idc:${ee}]`);return}}for(const ke of h)if(ce===ke.profile_idc&&ke.profile_iop.isMatch(oe))return n.debug(`parseProfileLevelId() | result [str:${q}, profile:${ke.profile}, level:${ne}]`),new a(ke.profile,ne);n.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${q}, profile_idc:${ce}, profile_iop:${oe}]`)}function _(q){if(q.level==i.L1_b)switch(q.profile){case r.ConstrainedBaseline:return"42f00b";case r.Baseline:return"42100b";case r.Main:return"4d100b";default:{n.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${q.profile}`);return}}let Q;switch(q.profile){case r.ConstrainedBaseline:{Q="42e0";break}case r.Baseline:{Q="4200";break}case r.Main:{Q="4d00";break}case r.ConstrainedHigh:{Q="640c";break}case r.High:{Q="6400";break}case r.PredictiveHigh444:{Q="f400";break}default:{n.warn(`profileLevelIdToString() | unrecognized profile ${q.profile}`);return}}let K=q.level.toString(16);return K.length===1&&(K=`0${K}`),`${Q}${K}`}function w(q){switch(q){case r.ConstrainedBaseline:return"ConstrainedBaseline";case r.Baseline:return"Baseline";case r.Main:return"Main";case r.ConstrainedHigh:return"ConstrainedHigh";case r.High:return"High";case r.PredictiveHigh444:return"PredictiveHigh444";default:{n.warn(`profileToString() | unrecognized profile ${q}`);return}}}function C(q){switch(q){case i.L1_b:return"1b";case i.L1:return"1";case i.L1_1:return"1.1";case i.L1_2:return"1.2";case i.L1_3:return"1.3";case i.L2:return"2";case i.L2_1:return"2.1";case i.L2_2:return"2.2";case i.L3:return"3";case i.L3_1:return"3.1";case i.L3_2:return"3.2";case i.L4:return"4";case i.L4_1:return"4.1";case i.L4_2:return"4.2";case i.L5:return"5";case i.L5_1:return"5.1";case i.L5_2:return"5.2";default:{n.warn(`levelToString() | unrecognized level ${q}`);return}}}function R(q={}){const Q=q["profile-level-id"];return Q?f(Q):o}function S(q={},Q={}){const K=R(q),ee=R(Q);return!!(K&&ee&&K.profile===ee.profile)}function b(q={},Q={}){const K=R(q),ee=R(Q);return!!(K&&ee&&K.profile===ee.profile&&K.level==ee.level)}function x(q={},Q={}){if(!q["profile-level-id"]&&!Q["profile-level-id"]){n.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const K=R(q),ee=R(Q);if(!K)throw new TypeError("invalid local_profile_level_id");if(!ee)throw new TypeError("invalid remote_profile_level_id");if(K.profile!==ee.profile)throw new TypeError("H264 Profile mismatch");const oe=z(q)&&z(Q),ce=K.level,ne=ee.level,ke=$(ce,ne),_e=oe?ce:ke;return n.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${K.profile}, level:${_e}]`),_(new a(K.profile,_e))}function E(q,Q){for(let ee=g.length-1;ee>=0;--ee){const oe=g[ee];if(oe.max_macroblock_frame_size*256<=q&&oe.max_macroblocks_per_second<=Q*oe.max_macroblock_frame_size)return n.debug(`supportedLevel() | result [max_frame_pixel_count:${q}, max_fps:${Q}, level:${oe.level}]`),oe.level}n.warn(`supportedLevel() | no level supported [max_frame_pixel_count:${q}, max_fps:${Q}]`)}function M(q,Q){return+(Q[0]===q)<<7|+(Q[1]===q)<<6|+(Q[2]===q)<<5|+(Q[3]===q)<<4|+(Q[4]===q)<<3|+(Q[5]===q)<<2|+(Q[6]===q)<<1|+(Q[7]===q)<<0}function Z(q,Q){return q===i.L1_b?Q!==i.L1&&Q!==i.L1_b:Q===i.L1_b?q!==i.L1:q<Q}function $(q,Q){return Z(q,Q)?q:Q}function z(q={}){const Q=q["level-asymmetry-allowed"];return Q===!0||Q===1||Q==="1"}}}),Ps=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/ortc.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.validateRtpCapabilities=o,e.validateRtpParameters=u,e.validateSctpStreamParameters=p,e.validateSctpCapabilities=h,e.getExtendedRtpCapabilities=g,e.getRecvRtpCapabilities=f,e.getSendingRtpParameters=_,e.getSendingRemoteRtpParameters=w,e.reduceCodecs=C,e.generateProbatorRtpParameters=R,e.canSend=S,e.canReceive=b;var t=tx(),n=zo(),r="probator",i=1234,a=127;function o(ne){if(typeof ne!="object")throw new TypeError("caps is not an object");if(ne.codecs&&!Array.isArray(ne.codecs))throw new TypeError("caps.codecs is not an array");ne.codecs||(ne.codecs=[]);for(const ke of ne.codecs)x(ke);if(ne.headerExtensions&&!Array.isArray(ne.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");ne.headerExtensions||(ne.headerExtensions=[]);for(const ke of ne.headerExtensions)M(ke)}function u(ne){if(typeof ne!="object")throw new TypeError("params is not an object");if(ne.mid&&typeof ne.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(ne.codecs))throw new TypeError("missing params.codecs");for(const ke of ne.codecs)Z(ke);if(ne.headerExtensions&&!Array.isArray(ne.headerExtensions))throw new TypeError("params.headerExtensions is not an array");ne.headerExtensions||(ne.headerExtensions=[]);for(const ke of ne.headerExtensions)$(ke);if(ne.encodings&&!Array.isArray(ne.encodings))throw new TypeError("params.encodings is not an array");ne.encodings||(ne.encodings=[]);for(const ke of ne.encodings)z(ke);if(ne.rtcp&&typeof ne.rtcp!="object")throw new TypeError("params.rtcp is not an object");ne.rtcp||(ne.rtcp={}),q(ne.rtcp)}function p(ne){if(typeof ne!="object")throw new TypeError("params is not an object");if(typeof ne.streamId!="number")throw new TypeError("missing params.streamId");let ke=!1;if(typeof ne.ordered=="boolean"?ke=!0:ne.ordered=!0,ne.maxPacketLifeTime&&typeof ne.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(ne.maxRetransmits&&typeof ne.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(ne.maxPacketLifeTime&&ne.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(ke&&ne.ordered&&(ne.maxPacketLifeTime||ne.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!ke&&(ne.maxPacketLifeTime||ne.maxRetransmits)&&(ne.ordered=!1),ne.label&&typeof ne.label!="string")throw new TypeError("invalid params.label");if(ne.protocol&&typeof ne.protocol!="string")throw new TypeError("invalid params.protocol")}function h(ne){if(typeof ne!="object")throw new TypeError("caps is not an object");if(!ne.numStreams||typeof ne.numStreams!="object")throw new TypeError("missing caps.numStreams");Q(ne.numStreams)}function g(ne,ke,_e){var le,fe,ge,Ee,Oe,Je,ut,ot,nt;const He={codecs:[],headerExtensions:[]};if(_e)for(const Qe of(le=ne.codecs)!=null?le:[]){if(K(Qe))continue;const mt=((fe=ke.codecs)!=null?fe:[]).find(Wt=>ee(Wt,Qe,{strict:!0,modify:!0}));if(!mt)continue;const Lt={kind:Qe.kind,mimeType:Qe.mimeType,clockRate:Qe.clockRate,channels:Qe.channels,localPayloadType:Qe.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:mt.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:(ge=Qe.parameters)!=null?ge:{},remoteParameters:(Ee=mt.parameters)!=null?Ee:{},rtcpFeedback:ce(Qe,mt)};He.codecs.push(Lt)}else for(const Qe of(Oe=ke.codecs)!=null?Oe:[]){if(K(Qe))continue;const mt=((Je=ne.codecs)!=null?Je:[]).find(Wt=>ee(Wt,Qe,{strict:!0,modify:!0}));if(!mt)continue;const Lt={kind:mt.kind,mimeType:mt.mimeType,clockRate:mt.clockRate,channels:mt.channels,localPayloadType:mt.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:Qe.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:(ut=mt.parameters)!=null?ut:{},remoteParameters:(ot=Qe.parameters)!=null?ot:{},rtcpFeedback:ce(mt,Qe)};He.codecs.push(Lt)}for(const Qe of He.codecs){const mt=ne.codecs.find(Wt=>{var Fn;return K(Wt)&&((Fn=Wt.parameters)==null?void 0:Fn.apt)===Qe.localPayloadType}),Lt=ke.codecs.find(Wt=>{var Fn;return K(Wt)&&((Fn=Wt.parameters)==null?void 0:Fn.apt)===Qe.remotePayloadType});mt&&Lt&&(Qe.localRtxPayloadType=mt.preferredPayloadType,Qe.remoteRtxPayloadType=Lt.preferredPayloadType)}for(const Qe of ke.headerExtensions){const mt=ne.headerExtensions.find(Wt=>oe(Wt,Qe));if(!mt)continue;const Lt={kind:Qe.kind,uri:Qe.uri,sendId:mt.preferredId,recvId:Qe.preferredId,encrypt:(nt=mt.preferredEncrypt)!=null?nt:!1,direction:"sendrecv"};switch(Qe.direction){case"sendrecv":{Lt.direction="sendrecv";break}case"recvonly":{Lt.direction="sendonly";break}case"sendonly":{Lt.direction="recvonly";break}case"inactive":{Lt.direction="inactive";break}}He.headerExtensions.push(Lt)}return He}function f(ne){var ke;const _e={codecs:[],headerExtensions:[]};for(const le of ne.codecs){const fe={kind:le.kind,mimeType:le.mimeType,preferredPayloadType:le.remotePayloadType,clockRate:le.clockRate,channels:le.channels,parameters:le.localParameters,rtcpFeedback:le.rtcpFeedback};if(_e.codecs.push(fe),!le.remoteRtxPayloadType)continue;const ge={kind:le.kind,mimeType:`${le.kind}/rtx`,preferredPayloadType:le.remoteRtxPayloadType,clockRate:le.clockRate,parameters:{apt:le.remotePayloadType},rtcpFeedback:[]};_e.codecs.push(ge)}for(const le of ne.headerExtensions){if(le.direction!=="sendrecv"&&le.direction!=="recvonly")continue;const fe={kind:le.kind,uri:le.uri,preferredId:le.recvId,preferredEncrypt:(ke=le.encrypt)!=null?ke:!1,direction:le.direction};_e.headerExtensions.push(fe)}return _e}function _(ne,ke){const _e={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const le of ke.codecs){if(le.kind!==ne)continue;const fe={mimeType:le.mimeType,payloadType:le.localPayloadType,clockRate:le.clockRate,channels:le.channels,parameters:le.localParameters,rtcpFeedback:le.rtcpFeedback};if(_e.codecs.push(fe),le.localRtxPayloadType){const ge={mimeType:`${le.kind}/rtx`,payloadType:le.localRtxPayloadType,clockRate:le.clockRate,parameters:{apt:le.localPayloadType},rtcpFeedback:[]};_e.codecs.push(ge)}}for(const le of ke.headerExtensions){if(le.kind&&le.kind!==ne||le.direction!=="sendrecv"&&le.direction!=="sendonly")continue;const fe={uri:le.uri,id:le.sendId,encrypt:le.encrypt,parameters:{}};_e.headerExtensions.push(fe)}return _e}function w(ne,ke){var _e,le,fe;const ge={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const Ee of ke.codecs){if(Ee.kind!==ne)continue;const Oe={mimeType:Ee.mimeType,payloadType:Ee.localPayloadType,clockRate:Ee.clockRate,channels:Ee.channels,parameters:Ee.remoteParameters,rtcpFeedback:Ee.rtcpFeedback};if(ge.codecs.push(Oe),Ee.localRtxPayloadType){const Je={mimeType:`${Ee.kind}/rtx`,payloadType:Ee.localRtxPayloadType,clockRate:Ee.clockRate,parameters:{apt:Ee.localPayloadType},rtcpFeedback:[]};ge.codecs.push(Je)}}for(const Ee of ke.headerExtensions){if(Ee.kind&&Ee.kind!==ne||Ee.direction!=="sendrecv"&&Ee.direction!=="sendonly")continue;const Oe={uri:Ee.uri,id:Ee.sendId,encrypt:Ee.encrypt,parameters:{}};ge.headerExtensions.push(Oe)}if(ge.headerExtensions.some(Ee=>Ee.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const Ee of ge.codecs)Ee.rtcpFeedback=((_e=Ee.rtcpFeedback)!=null?_e:[]).filter(Oe=>Oe.type!=="goog-remb");else if(ge.headerExtensions.some(Ee=>Ee.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const Ee of ge.codecs)Ee.rtcpFeedback=((le=Ee.rtcpFeedback)!=null?le:[]).filter(Oe=>Oe.type!=="transport-cc");else for(const Ee of ge.codecs)Ee.rtcpFeedback=((fe=Ee.rtcpFeedback)!=null?fe:[]).filter(Oe=>Oe.type!=="transport-cc"&&Oe.type!=="goog-remb");return ge}function C(ne,ke){const _e=[];if(!ke)_e.push(ne[0]),K(ne[1])&&_e.push(ne[1]);else{for(let le=0;le<ne.length;++le)if(ee(ne[le],ke,{strict:!0})){_e.push(ne[le]),K(ne[le+1])&&_e.push(ne[le+1]);break}if(_e.length===0)throw new TypeError("no matching codec found")}return _e}function R(ne){ne=n.clone(ne),u(ne);const ke={mid:r,codecs:[],headerExtensions:[],encodings:[{ssrc:i}],rtcp:{cname:"probator"}};return ke.codecs.push(ne.codecs[0]),ke.codecs[0].payloadType=a,ke.headerExtensions=ne.headerExtensions,ke}function S(ne,ke){var _e;return((_e=ke.codecs)!=null?_e:[]).some(le=>le.kind===ne)}function b(ne,ke){var _e;if(u(ne),ne.codecs.length===0)return!1;const le=ne.codecs[0];return((_e=ke.codecs)!=null?_e:[]).some(fe=>fe.preferredPayloadType===le.payloadType)}function x(ne){const ke=new RegExp("^(audio|video)/(.+)","i");if(typeof ne!="object")throw new TypeError("codec is not an object");if(!ne.mimeType||typeof ne.mimeType!="string")throw new TypeError("missing codec.mimeType");const _e=ke.exec(ne.mimeType);if(!_e)throw new TypeError("invalid codec.mimeType");if(ne.kind=_e[1].toLowerCase(),typeof ne.preferredPayloadType!="number")throw new TypeError("missing codec.preferredPayloadType");if(typeof ne.clockRate!="number")throw new TypeError("missing codec.clockRate");ne.kind==="audio"?typeof ne.channels!="number"&&(ne.channels=1):delete ne.channels,(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const le of Object.keys(ne.parameters)){let fe=ne.parameters[le];if(fe===void 0&&(ne.parameters[le]="",fe=""),typeof fe!="string"&&typeof fe!="number")throw new TypeError(`invalid codec parameter [key:${le}s, value:${fe}]`);if(le==="apt"&&typeof fe!="number")throw new TypeError("invalid codec apt parameter")}(!ne.rtcpFeedback||!Array.isArray(ne.rtcpFeedback))&&(ne.rtcpFeedback=[]);for(const le of ne.rtcpFeedback)E(le)}function E(ne){if(typeof ne!="object")throw new TypeError("fb is not an object");if(!ne.type||typeof ne.type!="string")throw new TypeError("missing fb.type");(!ne.parameter||typeof ne.parameter!="string")&&(ne.parameter="")}function M(ne){if(typeof ne!="object")throw new TypeError("ext is not an object");if(ne.kind!=="audio"&&ne.kind!=="video")throw new TypeError("invalid ext.kind");if(!ne.uri||typeof ne.uri!="string")throw new TypeError("missing ext.uri");if(typeof ne.preferredId!="number")throw new TypeError("missing ext.preferredId");if(ne.preferredEncrypt&&typeof ne.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(ne.preferredEncrypt||(ne.preferredEncrypt=!1),ne.direction&&typeof ne.direction!="string")throw new TypeError("invalid ext.direction");ne.direction||(ne.direction="sendrecv")}function Z(ne){const ke=new RegExp("^(audio|video)/(.+)","i");if(typeof ne!="object")throw new TypeError("codec is not an object");if(!ne.mimeType||typeof ne.mimeType!="string")throw new TypeError("missing codec.mimeType");const _e=ke.exec(ne.mimeType);if(!_e)throw new TypeError("invalid codec.mimeType");if(typeof ne.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof ne.clockRate!="number")throw new TypeError("missing codec.clockRate");_e[1].toLowerCase()==="audio"?typeof ne.channels!="number"&&(ne.channels=1):delete ne.channels,(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const fe of Object.keys(ne.parameters)){let ge=ne.parameters[fe];if(ge===void 0&&(ne.parameters[fe]="",ge=""),typeof ge!="string"&&typeof ge!="number")throw new TypeError(`invalid codec parameter [key:${fe}s, value:${ge}]`);if(fe==="apt"&&typeof ge!="number")throw new TypeError("invalid codec apt parameter")}(!ne.rtcpFeedback||!Array.isArray(ne.rtcpFeedback))&&(ne.rtcpFeedback=[]);for(const fe of ne.rtcpFeedback)E(fe)}function $(ne){if(typeof ne!="object")throw new TypeError("ext is not an object");if(!ne.uri||typeof ne.uri!="string")throw new TypeError("missing ext.uri");if(typeof ne.id!="number")throw new TypeError("missing ext.id");if(ne.encrypt&&typeof ne.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");ne.encrypt||(ne.encrypt=!1),(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const ke of Object.keys(ne.parameters)){let _e=ne.parameters[ke];if(_e===void 0&&(ne.parameters[ke]="",_e=""),typeof _e!="string"&&typeof _e!="number")throw new TypeError("invalid header extension parameter")}}function z(ne){if(typeof ne!="object")throw new TypeError("encoding is not an object");if(ne.ssrc&&typeof ne.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(ne.rid&&typeof ne.rid!="string")throw new TypeError("invalid encoding.rid");if(ne.rtx&&typeof ne.rtx!="object")throw new TypeError("invalid encoding.rtx");if(ne.rtx&&typeof ne.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!ne.dtx||typeof ne.dtx!="boolean")&&(ne.dtx=!1),ne.scalabilityMode&&typeof ne.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function q(ne){if(typeof ne!="object")throw new TypeError("rtcp is not an object");if(ne.cname&&typeof ne.cname!="string")throw new TypeError("invalid rtcp.cname");(!ne.reducedSize||typeof ne.reducedSize!="boolean")&&(ne.reducedSize=!0)}function Q(ne){if(typeof ne!="object")throw new TypeError("numStreams is not an object");if(typeof ne.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof ne.MIS!="number")throw new TypeError("missing numStreams.MIS")}function K(ne){return ne?/.+\/rtx$/i.test(ne.mimeType):!1}function ee(ne,ke,{strict:_e=!1,modify:le=!1}={}){var fe,ge,Ee,Oe;const Je=ne.mimeType.toLowerCase(),ut=ke.mimeType.toLowerCase();if(Je!==ut||ne.clockRate!==ke.clockRate||ne.channels!==ke.channels)return!1;switch(Je){case"video/h264":{if(_e){const ot=(fe=ne.parameters["packetization-mode"])!=null?fe:0,nt=(ge=ke.parameters["packetization-mode"])!=null?ge:0;if(ot!==nt||!t.isSameProfile(ne.parameters,ke.parameters))return!1;let He;try{He=t.generateProfileLevelIdStringForAnswer(ne.parameters,ke.parameters)}catch{return!1}le&&(He?(ne.parameters["profile-level-id"]=He,ke.parameters["profile-level-id"]=He):(delete ne.parameters["profile-level-id"],delete ke.parameters["profile-level-id"]))}break}case"video/vp9":{if(_e){const ot=(Ee=ne.parameters["profile-id"])!=null?Ee:0,nt=(Oe=ke.parameters["profile-id"])!=null?Oe:0;if(ot!==nt)return!1}break}}return!0}function oe(ne,ke){return!(ne.kind&&ke.kind&&ne.kind!==ke.kind||ne.uri!==ke.uri)}function ce(ne,ke){var _e,le;const fe=[];for(const ge of(_e=ne.rtcpFeedback)!=null?_e:[]){const Ee=((le=ke.rtcpFeedback)!=null?le:[]).find(Oe=>Oe.type===ge.type&&(Oe.parameter===ge.parameter||!Oe.parameter&&!ge.parameter));Ee&&fe.push(Ee)}return fe}}}),nx=Ce({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/Logger.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var t=sh(),n="awaitqueue",r=class{constructor(i){me(this,"_debug"),me(this,"_warn"),me(this,"_error"),i?(this._debug=t(`${n}:${i}`),this._warn=t(`${n}:WARN:${i}`),this._error=t(`${n}:ERROR:${i}`)):(this._debug=t(n),this._warn=t(`${n}:WARN`),this._error=t(`${n}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=r}}),C_=Ce({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/errors.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=void 0;var t=class E_ extends Error{constructor(i){super(i??"queue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,E_)}};e.AwaitQueueStoppedError=t;var n=class P_ extends Error{constructor(i){super(i??"queue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,P_)}};e.AwaitQueueRemovedTaskError=n}}),rx=Ce({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/AwaitQueue.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueue=void 0;var t=nx(),n=C_(),r=new t.Logger("AwaitQueue"),i=class{constructor(){me(this,"pendingTasks",new Map),me(this,"nextTaskId",0),me(this,"stopping",!1),r.debug("constructor()")}get size(){return this.pendingTasks.size}push(a,o){return H(this,null,function*(){if(o=o??a.name,r.debug(`push() [name:${o}]`),typeof a!="function")throw new TypeError("given task is not a function");if(o)try{Object.defineProperty(a,"name",{value:o})}catch{}return new Promise((u,p)=>{const h={id:this.nextTaskId++,task:a,name:o,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:g=>{if(h.completed)return;h.completed=!0,this.pendingTasks.delete(h.id),r.debug(`resolving task [name:${h.name}]`),u(g);const[f]=this.pendingTasks.values();f&&!f.executedAt&&this.execute(f)},reject:g=>{if(!h.completed&&(h.completed=!0,this.pendingTasks.delete(h.id),r.debug(`rejecting task [name:${h.name}]: %s`,String(g)),p(g),!this.stopping)){const[f]=this.pendingTasks.values();f&&!f.executedAt&&this.execute(f)}}};this.pendingTasks.set(h.id,h),this.pendingTasks.size===1&&this.execute(h)})})}stop(){r.debug("stop()"),this.stopping=!0;for(const a of this.pendingTasks.values())r.debug(`stop() | stopping task [name:${a.name}]`),a.reject(new n.AwaitQueueStoppedError);this.stopping=!1}remove(a){r.debug(`remove() [taskIdx:${a}]`);const o=Array.from(this.pendingTasks.values())[a];if(!o){r.debug(`stop() | no task with given idx [taskIdx:${a}]`);return}o.reject(new n.AwaitQueueRemovedTaskError)}dump(){const a=Date.now();let o=0;return Array.from(this.pendingTasks.values()).map(u=>({idx:o++,task:u.task,name:u.name,enqueuedTime:u.executedAt?u.executedAt-u.enqueuedAt:a-u.enqueuedAt,executionTime:u.executedAt?a-u.executedAt:0}))}execute(a){return H(this,null,function*(){if(r.debug(`execute() [name:${a.name}]`),a.executedAt)throw new Error("task already being executed");a.executedAt=Date.now();try{const o=yield a.task();a.resolve(o)}catch(o){a.reject(o)}})}};e.AwaitQueue=i}}),ix=Ce({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=e.AwaitQueue=void 0;var t=rx();Object.defineProperty(e,"AwaitQueue",{enumerable:!0,get:function(){return t.AwaitQueue}});var n=C_();Object.defineProperty(e,"AwaitQueueStoppedError",{enumerable:!0,get:function(){return n.AwaitQueueStoppedError}}),Object.defineProperty(e,"AwaitQueueRemovedTaskError",{enumerable:!0,get:function(){return n.AwaitQueueRemovedTaskError}})}}),sx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Producer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Producer=void 0;var t=zr(),n=Yr(),r=Mi(),i=new t.Logger("Producer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,localId:u,rtpSender:p,track:h,rtpParameters:g,stopTracks:f,disableTrackOnPause:_,zeroRtpOnPause:w,appData:C}){super(),me(this,"_id"),me(this,"_localId"),me(this,"_closed",!1),me(this,"_rtpSender"),me(this,"_track"),me(this,"_kind"),me(this,"_rtpParameters"),me(this,"_paused"),me(this,"_maxSpatialLayer"),me(this,"_stopTracks"),me(this,"_disableTrackOnPause"),me(this,"_zeroRtpOnPause"),me(this,"_appData"),me(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._localId=u,this._rtpSender=p,this._track=h,this._kind=h.kind,this._rtpParameters=g,this._paused=_?!h.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=f,this._disableTrackOnPause=_,this._zeroRtpOnPause=w,this._appData=C??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}getStats(){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");return new Promise((o,u)=>{this.safeEmit("@getstats",o,u)})})}pause(){if(i.debug("pause()"),this._closed){i.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((o,u)=>{this.safeEmit("@pause",o,u)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(i.debug("resume()"),this._closed){i.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((o,u)=>{this.safeEmit("@resume",o,u)}).catch(()=>{}),this._observer.safeEmit("resume")}replaceTrack(o){return H(this,arguments,function*({track:u}){if(i.debug("replaceTrack() [track:%o]",u),this._closed){if(u&&this._stopTracks)try{u.stop()}catch{}throw new r.InvalidStateError("closed")}else if(u&&u.readyState==="ended")throw new r.InvalidStateError("track ended");if(u===this._track){i.debug("replaceTrack() | same track, ignored");return}yield new Promise((p,h)=>{this.safeEmit("@replacetrack",u,p,h)}),this.destroyTrack(),this._track=u,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()})}setMaxSpatialLayer(o){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");if(this._kind!=="video")throw new r.UnsupportedError("not a video Producer");if(typeof o!="number")throw new TypeError("invalid spatialLayer");o!==this._maxSpatialLayer&&(yield new Promise((u,p)=>{this.safeEmit("@setmaxspatiallayer",o,u,p)}).catch(()=>{}),this._maxSpatialLayer=o)})}setRtpEncodingParameters(o){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");if(typeof o!="object")throw new TypeError("invalid params");yield new Promise((u,p)=>{this.safeEmit("@setrtpencodingparameters",o,u,p)})})}onTrackEnded(){i.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}};e.Producer=a}}),ax=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Consumer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Consumer=void 0;var t=zr(),n=Yr(),r=Mi(),i=new t.Logger("Consumer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,localId:u,producerId:p,rtpReceiver:h,track:g,rtpParameters:f,appData:_}){super(),me(this,"_id"),me(this,"_localId"),me(this,"_producerId"),me(this,"_closed",!1),me(this,"_rtpReceiver"),me(this,"_track"),me(this,"_rtpParameters"),me(this,"_paused"),me(this,"_appData"),me(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._localId=u,this._producerId=p,this._rtpReceiver=h,this._track=g,this._rtpParameters=f,this._paused=!g.enabled,this._appData=_??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}getStats(){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");return new Promise((o,u)=>{this.safeEmit("@getstats",o,u)})})}pause(){if(i.debug("pause()"),this._closed){i.error("pause() | Consumer closed");return}if(this._paused){i.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(i.debug("resume()"),this._closed){i.error("resume() | Consumer closed");return}if(!this._paused){i.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){i.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}};e.Consumer=a}}),ox=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/DataProducer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataProducer=void 0;var t=zr(),n=Yr(),r=Mi(),i=new t.Logger("DataProducer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,dataChannel:u,sctpStreamParameters:p,appData:h}){super(),me(this,"_id"),me(this,"_dataChannel"),me(this,"_closed",!1),me(this,"_sctpStreamParameters"),me(this,"_appData"),me(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._dataChannel=u,this._sctpStreamParameters=p,this._appData=h??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(o){this._dataChannel.bufferedAmountLowThreshold=o}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(o){if(i.debug("send()"),this._closed)throw new r.InvalidStateError("closed");this._dataChannel.send(o)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(i.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",o=>{var u,p,h;if(this._closed)return;const g=(u=o.error)!=null?u:new Error("unknown DataChannel error");((p=o.error)==null?void 0:p.errorDetail)==="sctp-failure"?i.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",(h=o.error)==null?void 0:h.sctpCauseCode,o.error.message):i.error('DataChannel "error" event: %o',g),this.safeEmit("error",g)}),this._dataChannel.addEventListener("close",()=>{this._closed||(i.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||i.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}};e.DataProducer=a}}),cx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/DataConsumer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataConsumer=void 0;var t=zr(),n=Yr(),r=new t.Logger("DataConsumer"),i=class extends n.EnhancedEventEmitter{constructor({id:a,dataProducerId:o,dataChannel:u,sctpStreamParameters:p,appData:h}){super(),me(this,"_id"),me(this,"_dataProducerId"),me(this,"_dataChannel"),me(this,"_closed",!1),me(this,"_sctpStreamParameters"),me(this,"_appData"),me(this,"_observer",new n.EnhancedEventEmitter),r.debug("constructor()"),this._id=a,this._dataProducerId=o,this._dataChannel=u,this._sctpStreamParameters=p,this._appData=h??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(a){this._dataChannel.binaryType=a}get appData(){return this._appData}set appData(a){this._appData=a}get observer(){return this._observer}close(){this._closed||(r.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(r.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(r.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",a=>{var o,u,p;if(this._closed)return;const h=(o=a.error)!=null?o:new Error("unknown DataChannel error");((u=a.error)==null?void 0:u.errorDetail)==="sctp-failure"?r.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",(p=a.error)==null?void 0:p.sctpCauseCode,a.error.message):r.error('DataChannel "error" event: %o',h),this.safeEmit("error",h)}),this._dataChannel.addEventListener("close",()=>{this._closed||(r.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",a=>{this._closed||this.safeEmit("message",a.data)})}};e.DataConsumer=i}}),lx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Transport.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Transport=void 0;var t=ix(),n=zr(),r=Yr(),i=Mi(),a=zo(),o=Ps(),u=sx(),p=ax(),h=ox(),g=cx(),f=new n.Logger("Transport"),_=class{constructor(C){me(this,"consumerOptions"),me(this,"promise"),me(this,"resolve"),me(this,"reject"),this.consumerOptions=C,this.promise=new Promise((R,S)=>{this.resolve=R,this.reject=S})}},w=class extends r.EnhancedEventEmitter{constructor({direction:C,id:R,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:$,appData:z,handlerFactory:q,getSendExtendedRtpCapabilities:Q,recvRtpCapabilities:K,canProduceByKind:ee}){var oe;super(),me(this,"_id"),me(this,"_closed",!1),me(this,"_direction"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_recvRtpCapabilities"),me(this,"_canProduceByKind"),me(this,"_maxSctpMessageSize"),me(this,"_handler"),me(this,"_iceGatheringState","new"),me(this,"_connectionState","new"),me(this,"_appData"),me(this,"_producers",new Map),me(this,"_consumers",new Map),me(this,"_dataProducers",new Map),me(this,"_dataConsumers",new Map),me(this,"_probatorConsumerCreated",!1),me(this,"_awaitQueue",new t.AwaitQueue),me(this,"_pendingConsumerTasks",[]),me(this,"_consumerCreationInProgress",!1),me(this,"_pendingPauseConsumers",new Map),me(this,"_consumerPauseInProgress",!1),me(this,"_pendingResumeConsumers",new Map),me(this,"_consumerResumeInProgress",!1),me(this,"_pendingCloseConsumers",new Map),me(this,"_consumerCloseInProgress",!1),me(this,"_observer",new r.EnhancedEventEmitter),f.debug("constructor() [id:%s, direction:%s]",R,C),this._id=R,this._direction=C,this._getSendExtendedRtpCapabilities=Q,this._recvRtpCapabilities=K,this._canProduceByKind=ee,this._maxSctpMessageSize=E?E.maxMessageSize:null;const ce=(oe=a.clone($))!=null?oe:{};delete ce.iceServers,delete ce.iceTransportPolicy,delete ce.bundlePolicy,delete ce.rtcpMuxPolicy,this._handler=q.factory({direction:C,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:ce,getSendExtendedRtpCapabilities:this._getSendExtendedRtpCapabilities}),this._appData=z??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(C){this._appData=C}get observer(){return this._observer}close(){if(!this._closed){f.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const C of this._producers.values())C.transportClosed();this._producers.clear();for(const C of this._consumers.values())C.transportClosed();this._consumers.clear();for(const C of this._dataProducers.values())C.transportClosed();this._dataProducers.clear();for(const C of this._dataConsumers.values())C.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close"),super.close(),this._observer.close()}}getStats(){return H(this,null,function*(){if(this._closed)throw new i.InvalidStateError("closed");return this._handler.getTransportStats()})}restartIce(C){return H(this,arguments,function*({iceParameters:R}){if(f.debug("restartIce()"),this._closed)throw new i.InvalidStateError("closed");if(!R)throw new TypeError("missing iceParameters");return this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.restartIce(R)}),"transport.restartIce()")})}updateIceServers(){return H(this,arguments,function*({iceServers:C}={}){if(f.debug("updateIceServers()"),this._closed)throw new i.InvalidStateError("closed");if(!Array.isArray(C))throw new TypeError("missing iceServers");return this._awaitQueue.push(()=>H(this,null,function*(){return this._handler.updateIceServers(C)}),"transport.updateIceServers()")})}produce(){return H(this,arguments,function*({track:C,encodings:R,codecOptions:S,codec:b,stopTracks:x=!0,disableTrackOnPause:E=!0,zeroRtpOnPause:M=!1,onRtpSender:Z,appData:$={}}={}){if(f.debug("produce() [track:%o]",C),this._closed)throw new i.InvalidStateError("closed");if(C){if(this._direction!=="send")throw new i.UnsupportedError("not a sending Transport");if(this._canProduceByKind[C.kind]){if(C.readyState==="ended")throw new i.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if($&&typeof $!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError(`cannot produce ${C.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(()=>H(this,null,function*(){let z;if(R&&!Array.isArray(R))throw TypeError("encodings must be an array");R&&R.length===0?z=void 0:R&&(z=R.map(ee=>{const oe={active:!0};return ee.active===!1&&(oe.active=!1),typeof ee.dtx=="boolean"&&(oe.dtx=ee.dtx),typeof ee.scalabilityMode=="string"&&(oe.scalabilityMode=ee.scalabilityMode),typeof ee.scaleResolutionDownBy=="number"&&(oe.scaleResolutionDownBy=ee.scaleResolutionDownBy),typeof ee.maxBitrate=="number"&&(oe.maxBitrate=ee.maxBitrate),typeof ee.maxFramerate=="number"&&(oe.maxFramerate=ee.maxFramerate),typeof ee.adaptivePtime=="boolean"&&(oe.adaptivePtime=ee.adaptivePtime),typeof ee.priority=="string"&&(oe.priority=ee.priority),typeof ee.networkPriority=="string"&&(oe.networkPriority=ee.networkPriority),oe}));const{localId:q,rtpParameters:Q,rtpSender:K}=yield this._handler.send({track:C,encodings:z,codecOptions:S,codec:b,onRtpSender:Z});try{o.validateRtpParameters(Q);const{id:ee}=yield new Promise((ce,ne)=>{this.safeEmit("produce",{kind:C.kind,rtpParameters:Q,appData:$},ce,ne)}),oe=new u.Producer({id:ee,localId:q,rtpSender:K,track:C,rtpParameters:Q,stopTracks:x,disableTrackOnPause:E,zeroRtpOnPause:M,appData:$});return this._producers.set(oe.id,oe),this.handleProducer(oe),this._observer.safeEmit("newproducer",oe),oe}catch(ee){throw this._handler.stopSending(q).catch(()=>{}),ee}}),"transport.produce()").catch(z=>{if(x)try{C.stop()}catch{}throw z})})}consume(C){return H(this,arguments,function*({id:R,producerId:S,kind:b,rtpParameters:x,streamId:E,onRtpReceiver:M,appData:Z={}}){if(f.debug("consume()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="recv")throw new i.UnsupportedError("not a receiving Transport");if(typeof R!="string")throw new TypeError("missing id");if(typeof S!="string")throw new TypeError("missing producerId");if(b!=="audio"&&b!=="video")throw new TypeError(`invalid kind '${b}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(Z&&typeof Z!="object")throw new TypeError("if given, appData must be an object");const $=a.clone(x);if(!o.canReceive($,this._recvRtpCapabilities))throw new i.UnsupportedError("cannot consume this Producer");const q=new _({id:R,producerId:S,kind:b,rtpParameters:$,streamId:E,onRtpReceiver:M,appData:Z});return this._pendingConsumerTasks.push(q),queueMicrotask(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),q.promise})}produceData(){return H(this,arguments,function*({ordered:C=!0,maxPacketLifeTime:R,maxRetransmits:S,label:b="",protocol:x="",appData:E={}}={}){if(f.debug("produceData()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="send")throw new i.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(E&&typeof E!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError("SCTP not enabled by remote Transport");return(R||S)&&(C=!1),this._awaitQueue.push(()=>H(this,null,function*(){const{dataChannel:M,sctpStreamParameters:Z}=yield this._handler.sendDataChannel({ordered:C,maxPacketLifeTime:R,maxRetransmits:S,label:b,protocol:x});o.validateSctpStreamParameters(Z);const{id:$}=yield new Promise((q,Q)=>{this.safeEmit("producedata",{sctpStreamParameters:Z,label:b,protocol:x,appData:E},q,Q)}),z=new h.DataProducer({id:$,dataChannel:M,sctpStreamParameters:Z,appData:E});return this._dataProducers.set(z.id,z),this.handleDataProducer(z),this._observer.safeEmit("newdataproducer",z),z}),"transport.produceData()")})}consumeData(C){return H(this,arguments,function*({id:R,dataProducerId:S,sctpStreamParameters:b,label:x="",protocol:E="",appData:M={}}){if(f.debug("consumeData()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="recv")throw new i.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof R!="string")throw new TypeError("missing id");if(typeof S!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(M&&typeof M!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError("SCTP not enabled by remote Transport");const Z=a.clone(b);return o.validateSctpStreamParameters(Z),this._awaitQueue.push(()=>H(this,null,function*(){const{dataChannel:$}=yield this._handler.receiveDataChannel({sctpStreamParameters:Z,label:x,protocol:E}),z=new g.DataConsumer({id:R,dataProducerId:S,dataChannel:$,sctpStreamParameters:Z,appData:M});return this._dataConsumers.set(z.id,z),this.handleDataConsumer(z),this._observer.safeEmit("newdataconsumer",z),z}),"transport.consumeData()")})}createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingConsumerTasks.length===0){f.debug("createPendingConsumers() | there is no Consumer to be created");return}const C=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let R;const S=[];for(const b of C){const{id:x,kind:E,rtpParameters:M,streamId:Z,onRtpReceiver:$}=b.consumerOptions;S.push({trackId:x,kind:E,rtpParameters:M,streamId:Z,onRtpReceiver:$})}try{const b=yield this._handler.receive(S);for(let x=0;x<b.length;++x){const E=C[x],M=b[x],{id:Z,producerId:$,kind:z,rtpParameters:q,appData:Q}=E.consumerOptions,{localId:K,rtpReceiver:ee,track:oe}=M,ce=new p.Consumer({id:Z,localId:K,producerId:$,rtpReceiver:ee,track:oe,rtpParameters:q,appData:Q});this._consumers.set(ce.id,ce),this.handleConsumer(ce),!this._probatorConsumerCreated&&!R&&z==="video"&&(R=ce),this._observer.safeEmit("newconsumer",ce),E.resolve(ce)}}catch(b){for(const x of C)x.reject(b)}if(R)try{const b=o.generateProbatorRtpParameters(R.rtpParameters);yield this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:b}]),f.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(b){f.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",b)}}),"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingPauseConsumers.size===0){f.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const C=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const R=C.map(S=>S.localId);yield this._handler.pauseReceiving(R)}catch(R){f.error("pausePendingConsumers() | failed to pause Consumers:",R)}}),"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingResumeConsumers.size===0){f.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const C=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const R=C.map(S=>S.localId);yield this._handler.resumeReceiving(R)}catch(R){f.error("resumePendingConsumers() | failed to resume Consumers:",R)}}),"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingCloseConsumers.size===0){f.debug("closePendingConsumers() | there is no Consumer to be closed");return}const C=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{yield this._handler.stopReceiving(C.map(R=>R.localId))}catch(R){f.error("closePendingConsumers() | failed to close Consumers:",R)}}),"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const C=this._handler;C.on("@connect",({dtlsParameters:R},S,b)=>{if(this._closed){b(new i.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:R},S,b)}),C.on("@icegatheringstatechange",R=>{R!==this._iceGatheringState&&(f.debug("ICE gathering state changed to %s",R),this._iceGatheringState=R,this._closed||this.safeEmit("icegatheringstatechange",R))}),C.on("@icecandidateerror",R=>{f.warn(`ICE candidate error [url:${R.url}, localAddress:${R.address}, localPort:${R.port}]: ${R.errorCode} "${R.errorText}"`),this.safeEmit("icecandidateerror",R)}),C.on("@connectionstatechange",R=>{R!==this._connectionState&&(f.debug("connection state changed to %s",R),this._connectionState=R,this._closed||this.safeEmit("connectionstatechange",R))})}handleProducer(C){C.on("@close",()=>{this._producers.delete(C.id),!this._closed&&this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.stopSending(C.localId)}),"producer @close event").catch(R=>f.warn("producer.close() failed:%o",R))}),C.on("@pause",(R,S)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.pauseSending(C.localId)}),"producer @pause event").then(R).catch(S)}),C.on("@resume",(R,S)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.resumeSending(C.localId)}),"producer @resume event").then(R).catch(S)}),C.on("@replacetrack",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.replaceTrack(C.localId,R)}),"producer @replacetrack event").then(S).catch(b)}),C.on("@setmaxspatiallayer",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.setMaxSpatialLayer(C.localId,R)}),"producer @setmaxspatiallayer event").then(S).catch(b)}),C.on("@setrtpencodingparameters",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.setRtpEncodingParameters(C.localId,R)}),"producer @setrtpencodingparameters event").then(S).catch(b)}),C.on("@getstats",(R,S)=>{if(this._closed)return S(new i.InvalidStateError("closed"));this._handler.getSenderStats(C.localId).then(R).catch(S)})}handleConsumer(C){C.on("@close",()=>{this._consumers.delete(C.id),this._pendingPauseConsumers.delete(C.id),this._pendingResumeConsumers.delete(C.id),!this._closed&&(this._pendingCloseConsumers.set(C.id,C),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),C.on("@pause",()=>{this._pendingResumeConsumers.has(C.id)&&this._pendingResumeConsumers.delete(C.id),this._pendingPauseConsumers.set(C.id,C),queueMicrotask(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),C.on("@resume",()=>{this._pendingPauseConsumers.has(C.id)&&this._pendingPauseConsumers.delete(C.id),this._pendingResumeConsumers.set(C.id,C),queueMicrotask(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),C.on("@getstats",(R,S)=>{if(this._closed)return S(new i.InvalidStateError("closed"));this._handler.getReceiverStats(C.localId).then(R).catch(S)})}handleDataProducer(C){C.on("@close",()=>{this._dataProducers.delete(C.id)})}handleDataConsumer(C){C.on("@close",()=>{this._dataConsumers.delete(C.id)})}};e.Transport=w}}),Ko=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/scalabilityModes.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.parse=n;var t=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function n(r){const i=t.exec(r??"");return i?{spatialLayers:Number(i[1]),temporalLayers:Number(i[2])}:{spatialLayers:1,temporalLayers:1}}}}),Pl=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/commonUtils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.extractRtpCapabilities=n,e.extractDtlsParameters=r,e.getCname=i,e.applyCodecParameters=a;var t=Oi();function n({sdpObject:o}){var u,p,h;const g=new Map,f=new Map;for(const w of o.media){const C=w.type;switch(C){case"audio":case"video":break;default:continue}for(const R of w.rtp){const S={kind:C,mimeType:`${C}/${R.codec}`,preferredPayloadType:R.payload,clockRate:R.rate,channels:R.encoding,parameters:{},rtcpFeedback:[]};g.set(S.preferredPayloadType,S)}for(const R of(u=w.fmtp)!=null?u:[]){const S=t.parseParams(R.config),b=g.get(R.payload);b&&(S!=null&&S.hasOwnProperty("profile-level-id")&&(S["profile-level-id"]=String(S["profile-level-id"])),b.parameters=S)}for(const R of(p=w.rtcpFb)!=null?p:[]){const S={type:R.type,parameter:R.subtype};if(S.parameter||delete S.parameter,R.payload!=="*"){const b=g.get(Number(R.payload));if(!b)continue;b.rtcpFeedback.push(S)}else for(const b of g.values())b.kind===C&&!/.+\/rtx$/i.test(b.mimeType)&&b.rtcpFeedback.push(S)}for(const R of(h=w.ext)!=null?h:[]){if(R["encrypt-uri"])continue;const S={kind:C,uri:R.uri,preferredId:R.value};f.set(S.preferredId,S)}}return{codecs:Array.from(g.values()),headerExtensions:Array.from(f.values())}}function r({sdpObject:o}){var u;let p=o.setup,h=o.fingerprint;if(!p||!h){const _=((u=o.media)!=null?u:[]).find(w=>w.port!==0);_&&(p??(p=_.setup),h??(h=_.fingerprint))}if(p){if(!h)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let g;switch(p){case"active":{g="client";break}case"passive":{g="server";break}case"actpass":{g="auto";break}}return{role:g,fingerprints:[{algorithm:h.type,value:h.hash}]}}function i({offerMediaObject:o}){var u;const p=((u=o.ssrcs)!=null?u:[]).find(h=>h.attribute==="cname");return p?p.value:""}function a({offerRtpParameters:o,answerMediaObject:u}){var p,h,g;for(const f of o.codecs){const _=f.mimeType.toLowerCase();if(_!=="audio/opus"||!((p=u.rtp)!=null?p:[]).find(S=>S.payload===f.payloadType))continue;u.fmtp=(h=u.fmtp)!=null?h:[];let C=u.fmtp.find(S=>S.payload===f.payloadType);C||(C={payload:f.payloadType,config:""},u.fmtp.push(C));const R=t.parseParams(C.config);switch(_){case"audio/opus":{const S=(g=f.parameters)==null?void 0:g["sprop-stereo"];S!==void 0&&(R.stereo=Number(S)?1:0);break}}C.config="";for(const S of Object.keys(R))C.config&&(C.config+=";"),C.config+=`${S}=${R[S]}`}}}}),kl=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.getRtpEncodings=t,e.addLegacySimulcast=n;function t({offerMediaObject:r}){var i,a;const o=new Set;for(const h of(i=r.ssrcs)!=null?i:[]){const g=h.id;g&&o.add(g)}if(o.size===0)throw new Error("no a=ssrc lines found");const u=new Map;for(const h of(a=r.ssrcGroups)!=null?a:[]){if(h.semantics!=="FID")continue;const g=h.ssrcs.split(/\s+/),f=Number(g[0]),_=Number(g[1]);o.has(f)&&(o.delete(f),o.delete(_),u.set(f,_))}for(const h of o)u.set(h,void 0);const p=[];for(const[h,g]of u){const f={ssrc:h};g&&(f.rtx={ssrc:g}),p.push(f)}return p}function n({offerMediaObject:r,numStreams:i}){var a,o,u;if(i<=1)throw new TypeError("numStreams must be greater than 1");const p=((a=r.ssrcs)!=null?a:[]).find(b=>b.attribute==="msid");if(!p)throw new Error("a=ssrc line with msid information not found");const[h,g]=p.value.split(" "),f=Number(p.id);let _;((o=r.ssrcGroups)!=null?o:[]).some(b=>{if(b.semantics!=="FID")return!1;const x=b.ssrcs.split(/\s+/);return Number(x[0])===f?(_=Number(x[1]),!0):!1});const w=((u=r.ssrcs)!=null?u:[]).find(b=>b.attribute==="cname");if(!w)throw new Error("a=ssrc line with cname information not found");const C=w.value,R=[],S=[];for(let b=0;b<i;++b)R.push(f+b),_&&S.push(_+b);r.ssrcGroups=[],r.ssrcs=[],r.ssrcGroups.push({semantics:"SIM",ssrcs:R.join(" ")});for(const b of R)r.ssrcs.push({id:b,attribute:"cname",value:C}),r.ssrcs.push({id:b,attribute:"msid",value:`${h} ${g}`});for(let b=0;b<S.length;++b){const x=R[b],E=S[b];r.ssrcs.push({id:E,attribute:"cname",value:C}),r.ssrcs.push({id:E,attribute:"msid",value:`${h} ${g}`}),r.ssrcGroups.push({semantics:"FID",ssrcs:`${x} ${E}`})}}}}),ah=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/ortc/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.addNackSupportForOpus=t;function t(n){var r,i;for(const a of(r=n.codecs)!=null?r:[])(a.mimeType.toLowerCase()==="audio/opus"||a.mimeType.toLowerCase()==="audio/multiopus")&&!((i=a.rtcpFeedback)!=null&&i.some(o=>o.type==="nack"&&!o.parameter))&&(a.rtcpFeedback||(a.rtcpFeedback=[]),a.rtcpFeedback.push({type:"nack"}))}}}),ux=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/MediaSection.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.OfferMediaSection=e.AnswerMediaSection=e.MediaSection=void 0;var t=Oi(),n=zo(),r=class{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h}){me(this,"_mediaObject");var g;if(this._mediaObject={type:"",port:0,protocol:"",payloads:"",rtp:[],fmtp:[]},u&&this.setIceParameters(u),p){this._mediaObject.candidates=[];for(const f of p){const _={foundation:f.foundation,component:1,ip:(g=f.address)!=null?g:f.ip,port:f.port,priority:f.priority,transport:f.protocol,type:f.type};f.tcpType&&(_.tcptype=f.tcpType),this._mediaObject.candidates.push(_)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}h&&this.setDtlsRole(h.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(u){this._mediaObject.iceUfrag=u.usernameFragment,this._mediaObject.icePwd=u.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}};e.MediaSection=r;var i=class extends r{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:g,plainRtpParameters:f,offerMediaObject:_,offerRtpParameters:w,answerRtpParameters:C,codecOptions:R}){var S,b,x,E,M;switch(super({iceParameters:u,iceCandidates:p,dtlsParameters:h}),this._mediaObject.mid=String(_.mid),this._mediaObject.type=_.type,this._mediaObject.protocol=_.protocol,f?(this._mediaObject.connection={ip:f.ip,version:f.ipVersion},this._mediaObject.port=f.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),_.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const Z of C.codecs){const $={payload:Z.payloadType,codec:o(Z),rate:Z.clockRate};Z.channels>1&&($.encoding=Z.channels),this._mediaObject.rtp.push($);const z=(S=n.clone(Z.parameters))!=null?S:{};let q=(b=n.clone(Z.rtcpFeedback))!=null?b:[];if(R){const{opusStereo:K,opusFec:ee,opusDtx:oe,opusMaxPlaybackRate:ce,opusMaxAverageBitrate:ne,opusPtime:ke,opusNack:_e,videoGoogleStartBitrate:le,videoGoogleMaxBitrate:fe,videoGoogleMinBitrate:ge}=R,Ee=w.codecs.find(Oe=>Oe.payloadType===Z.payloadType);switch(Z.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{K!==void 0&&(Ee.parameters["sprop-stereo"]=K?1:0,z.stereo=K?1:0),ee!==void 0&&(Ee.parameters.useinbandfec=ee?1:0,z.useinbandfec=ee?1:0),oe!==void 0&&(Ee.parameters.usedtx=oe?1:0,z.usedtx=oe?1:0),ce!==void 0&&(z.maxplaybackrate=ce),ne!==void 0&&(z.maxaveragebitrate=ne),ke!==void 0&&(Ee.parameters.ptime=ke,z.ptime=ke),_e||(Ee.rtcpFeedback=Ee.rtcpFeedback.filter(Oe=>Oe.type!=="nack"||Oe.parameter),q=q.filter(Oe=>Oe.type!=="nack"||Oe.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":case"video/av1":{le!==void 0&&(z["x-google-start-bitrate"]=le),fe!==void 0&&(z["x-google-max-bitrate"]=fe),ge!==void 0&&(z["x-google-min-bitrate"]=ge);break}}}const Q={payload:Z.payloadType,config:""};for(const K of Object.keys(z))Q.config&&(Q.config+=";"),Q.config+=`${K}=${z[K]}`;Q.config&&this._mediaObject.fmtp.push(Q);for(const K of q)this._mediaObject.rtcpFb.push({payload:Z.payloadType,type:K.type,subtype:K.parameter})}this._mediaObject.payloads=C.codecs.map(Z=>Z.payloadType).join(" "),this._mediaObject.ext=[];for(const Z of C.headerExtensions)((x=_.ext)!=null?x:[]).some(z=>z.uri===Z.uri)&&this._mediaObject.ext.push({uri:Z.uri,value:Z.id});if(_.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),_.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:_.simulcast.list1},this._mediaObject.rids=[];for(const Z of(E=_.rids)!=null?E:[])Z.direction==="send"&&this._mediaObject.rids.push({id:Z.id,direction:"recv"})}else if(_.simulcast_03){this._mediaObject.simulcast_03={value:_.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const Z of(M=_.rids)!=null?M:[])Z.direction==="send"&&this._mediaObject.rids.push({id:Z.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";break}case"application":{typeof _.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=g.port,this._mediaObject.maxMessageSize=g.maxMessageSize):_.sctpmap&&(this._mediaObject.payloads=String(g.port),this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:g.port,maxMessageSize:g.maxMessageSize});break}}}setDtlsRole(u){switch(u){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(u){var p,h;if(!((p=this._mediaObject.simulcast)!=null&&p.list1))return;const g={};for(const w of u)w.rid&&(g[w.rid]=w);const f=this._mediaObject.simulcast.list1,_=t.parseSimulcastStreamList(f);for(const w of _)for(const C of w)C.paused=!((h=g[C.scid])!=null&&h.active);this._mediaObject.simulcast.list1=_.map(w=>w.map(C=>`${C.paused?"~":""}${C.scid}`).join(",")).join(";")}};e.AnswerMediaSection=i;var a=class extends r{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:g,plainRtpParameters:f,mid:_,kind:w,offerRtpParameters:C,streamId:R,trackId:S}){var b,x;switch(super({iceParameters:u,iceCandidates:p,dtlsParameters:h}),this._mediaObject.mid=String(_),this._mediaObject.type=w,f?(this._mediaObject.connection={ip:f.ip,version:f.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=f.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},g?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),this._mediaObject.extmapAllowMixed="extmap-allow-mixed",w){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._mediaObject.msid=`${R??"-"} ${S}`;for(const $ of C.codecs){const z={payload:$.payloadType,codec:o($),rate:$.clockRate};$.channels>1&&(z.encoding=$.channels),this._mediaObject.rtp.push(z);const q={payload:$.payloadType,config:""};for(const Q of Object.keys((b=$.parameters)!=null?b:{}))q.config&&(q.config+=";"),q.config+=`${Q}=${$.parameters[Q]}`;q.config&&this._mediaObject.fmtp.push(q);for(const Q of $.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:$.payloadType,type:Q.type,subtype:Q.parameter})}this._mediaObject.payloads=C.codecs.map($=>$.payloadType).join(" "),this._mediaObject.ext=[];for(const $ of C.headerExtensions)this._mediaObject.ext.push({uri:$.uri,value:$.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const E=C.encodings[0],M=E.ssrc,Z=(x=E.rtx)==null?void 0:x.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],M&&C.rtcp.cname&&this._mediaObject.ssrcs.push({id:M,attribute:"cname",value:C.rtcp.cname}),Z&&(C.rtcp.cname&&this._mediaObject.ssrcs.push({id:Z,attribute:"cname",value:C.rtcp.cname}),M&&this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${M} ${Z}`}));break}case"application":{this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=g.port,this._mediaObject.maxMessageSize=g.maxMessageSize;break}}}setDtlsRole(u){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}};e.OfferMediaSection=a;function o(u){const h=new RegExp("^(audio|video)/(.+)","i").exec(u.mimeType);if(!h)throw new TypeError("invalid codec.mimeType");return h[2]}}}),Tl=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteSdp=void 0;var t=Oi(),n=zr(),r=ux(),i=["av1","h264"],a=new n.Logger("RemoteSdp"),o=class{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:g,plainRtpParameters:f}){if(me(this,"_iceParameters"),me(this,"_iceCandidates"),me(this,"_dtlsParameters"),me(this,"_sctpParameters"),me(this,"_plainRtpParameters"),me(this,"_mediaSections",[]),me(this,"_midToIndex",new Map),me(this,"_firstMid"),me(this,"_sdpObject"),this._iceParameters=u,this._iceCandidates=p,this._dtlsParameters=h,this._sctpParameters=g,this._plainRtpParameters=f,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:"10000",sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},u!=null&&u.iceLite&&(this._sdpObject.icelite="ice-lite"),h){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const _=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:h.fingerprints[_-1].algorithm,hash:h.fingerprints[_-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}f&&(this._sdpObject.origin.address=f.ip,this._sdpObject.origin.ipVer=f.ipVersion)}updateIceParameters(u){a.debug("updateIceParameters() [iceParameters:%o]",u),this._iceParameters=u,this._sdpObject.icelite=u.iceLite?"ice-lite":void 0;for(const p of this._mediaSections)p.setIceParameters(u)}updateDtlsRole(u){a.debug("updateDtlsRole() [role:%s]",u),this._dtlsParameters.role=u;for(const p of this._mediaSections)p.setDtlsRole(u)}setSessionExtmapAllowMixed(){a.debug("setSessionExtmapAllowMixed()"),this._sdpObject.extmapAllowMixed="extmap-allow-mixed"}getNextMediaSectionIdx(){for(let u=0;u<this._mediaSections.length;++u){const p=this._mediaSections[u];if(p.closed)return{idx:u,reuseMid:p.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:u,reuseMid:p,offerRtpParameters:h,answerRtpParameters:g,codecOptions:f}){var _;const w=new r.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:u,offerRtpParameters:h,answerRtpParameters:g,codecOptions:f}),C=w.getObject();C.rtp.find(S=>i.includes(S.codec.toLowerCase()))||(C.ext=(_=C.ext)==null?void 0:_.filter(S=>S.uri!=="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension")),p?this._replaceMediaSection(w,p):this._midToIndex.has(w.mid)?this._replaceMediaSection(w):this._addMediaSection(w)}receive({mid:u,kind:p,offerRtpParameters:h,streamId:g,trackId:f}){this.setSessionExtmapAllowMixed();const _=new r.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,mid:u,kind:p,offerRtpParameters:h,streamId:g,trackId:f}),w=this._mediaSections.find(C=>C.closed);w?this._replaceMediaSection(_,w.mid):this._addMediaSection(_)}pauseMediaSection(u){this._findMediaSection(u).pause()}resumeSendingMediaSection(u){this._findMediaSection(u).resume()}resumeReceivingMediaSection(u){this._findMediaSection(u).resume()}disableMediaSection(u){this._findMediaSection(u).disable()}closeMediaSection(u){const p=this._findMediaSection(u);return u===this._firstMid?(a.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",u),this.disableMediaSection(u),!1):(p.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(u,p){const h=this._findMediaSection(u);h.muxSimulcastStreams(p),this._replaceMediaSection(h)}sendSctpAssociation({offerMediaObject:u}){const p=new r.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:u});this._addMediaSection(p)}receiveSctpAssociation(){const u=new r.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application"});this._addMediaSection(u)}getSdp(){return this._sdpObject.origin.sessionVersion++,t.write(this._sdpObject)}_addMediaSection(u){this._firstMid||(this._firstMid=u.mid),this._mediaSections.push(u),this._midToIndex.set(u.mid,this._mediaSections.length-1),this._sdpObject.media.push(u.getObject()),this._regenerateBundleMids()}_replaceMediaSection(u,p){if(typeof p=="string"){const h=this._midToIndex.get(p);if(h===void 0)throw new Error(`no media section found for reuseMid '${p}'`);const g=this._mediaSections[h];this._mediaSections[h]=u,this._midToIndex.delete(g.mid),this._midToIndex.set(u.mid,h),this._sdpObject.media[h]=u.getObject(),this._regenerateBundleMids()}else{const h=this._midToIndex.get(u.mid);if(h===void 0)throw new Error(`no media section found with mid '${u.mid}'`);this._mediaSections[h]=u,this._sdpObject.media[h]=u.getObject()}}_findMediaSection(u){const p=this._midToIndex.get(u);if(p===void 0)throw new Error(`no media section found with mid '${u}'`);return this._mediaSections[p]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(u=>!u.closed).map(u=>u.mid).join(" "))}};e.RemoteSdp=o}}),dx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Chrome111.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome111=void 0;var t=Oi(),n=Yr(),r=zr(),i=Ps(),a=Mi(),o=Ko(),u=Pl(),p=kl(),h=ah(),g=Tl(),f=new r.Logger("Chrome111"),_="Chrome111",w={OS:1024,MIS:1024},C=class Lu extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_forcedLocalDtlsRole"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",Q=>{this.emit("@icecandidateerror",Q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new g.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Lu(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video",{sendEncodings:[{scalabilityMode:"L3T3"}]});const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Lu.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=u.extractRtpCapabilities({sdpObject:S});return h.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $;if(this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1){let fe=1;for(const ge of x){const Ee=ge.scalabilityMode?(0,o.parse)(ge.scalabilityMode).temporalLayers:3;Ee>fe&&(fe=Ee)}x.forEach((ge,Ee)=>{ge.rid=`r${Ee}`,ge.scalabilityMode=`L1T${fe}`})}const z=this._remoteSdp.getNextMediaSectionIdx(),q=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});Z&&Z(q.sender);const Q=yield this._pc.createOffer();let K=t.parse(Q.sdp);K.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const ee=Lu.getLocalRtpCapabilities(K),oe=this._getSendExtendedRtpCapabilities(ee),ce=i.getSendingRtpParameters(b.kind,oe);ce.codecs=i.reduceCodecs(ce.codecs,M);const ne=i.getSendingRemoteRtpParameters(b.kind,oe);ne.codecs=i.reduceCodecs(ne.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:K})),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",Q),yield this._pc.setLocalDescription(Q);const ke=q.mid;ce.mid=ke,K=t.parse(this._pc.localDescription.sdp);const _e=K.media[z.idx];if(ce.rtcp.cname=u.getCname({offerMediaObject:_e}),!x)ce.encodings=p.getRtpEncodings({offerMediaObject:_e});else if(x.length===1){const fe=p.getRtpEncodings({offerMediaObject:_e});Object.assign(fe[0],x[0]),ce.encodings=fe}else ce.encodings=x;this._remoteSdp.send({offerMediaObject:_e,reuseMid:z.reuseMid,offerRtpParameters:ce,answerRtpParameters:ne,codecOptions:E});const le={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",le),yield this._pc.setRemoteDescription(le),this._mapMidTransceiver.set(ke,q),{localId:ke,rtpParameters:ce,rtpSender:q.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),f.debug("stopSending() [localId:%s]",S),this._closed)return;const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),oe=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:oe});const ce={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ce),yield this._pc.setRemoteDescription(ce),this._hasDataChannelMediaSection=!0}const Q={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:Q}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:Q,kind:K,rtpParameters:ee,streamId:oe}=q;f.debug("receive() [trackId:%s, kind:%s]",Q,K);const ce=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(Q,ce),this._remoteSdp.receive({mid:ce,kind:K,offerRtpParameters:ee,streamId:oe??ee.rtcp.cname,trackId:Q})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:Q,onRtpReceiver:K}=q;if(K){const ee=M.get(Q),oe=this._pc.getTransceivers().find(ce=>ce.mid===ee);if(!oe)throw new Error("transceiver not found");K(oe.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:Q,rtpParameters:K}=q,ee=M.get(Q),oe=z.media.find(ce=>String(ce.mid)===ee);u.applyCodecParameters({offerRtpParameters:K,answerMediaObject:oe})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:Q}=q,K=M.get(Q),ee=this._pc.getTransceivers().find(oe=>oe.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,Q={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",Q);const K=this._pc.createDataChannel(x,Q);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const oe=yield this._pc.createAnswer();if(!this._transportReady){const ce=t.parse(oe.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:ce})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",oe),yield this._pc.setLocalDescription(oe),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=u.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Chrome111=C}}),hx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Chrome74.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome74=void 0;var t=Oi(),n=zr(),r=Yr(),i=Ps(),a=Mi(),o=Ko(),u=Pl(),p=kl(),h=ah(),g=Tl(),f=new n.Logger("Chrome74"),_="Chrome74",w={OS:1024,MIS:1024},C=class ju extends r.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_forcedLocalDtlsRole"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",Q=>{this.emit("@icecandidateerror",Q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new g.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new ju(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return ju.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=u.extractRtpCapabilities({sdpObject:S});return h.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M}){var Z;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1&&x.forEach((ge,Ee)=>{ge.rid=`r${Ee}`});const $=this._remoteSdp.getNextMediaSectionIdx(),z=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});let q=yield this._pc.createOffer(),Q=t.parse(q.sdp);Q.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const K=ju.getLocalRtpCapabilities(Q),ee=this._getSendExtendedRtpCapabilities(K),oe=i.getSendingRtpParameters(b.kind,ee);oe.codecs=i.reduceCodecs(oe.codecs,M);const ce=i.getSendingRemoteRtpParameters(b.kind,ee);ce.codecs=i.reduceCodecs(ce.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:(Z=this._forcedLocalDtlsRole)!=null?Z:"client",localSdpObject:Q}));let ne=!1;const ke=(0,o.parse)((x??[{}])[0].scalabilityMode);let _e;x&&x.length===1&&ke.spatialLayers>1&&oe.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),ne=!0,Q=t.parse(q.sdp),_e=Q.media[$.idx],p.addLegacySimulcast({offerMediaObject:_e,numStreams:ke.spatialLayers}),q={type:"offer",sdp:t.write(Q)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",q),yield this._pc.setLocalDescription(q);const le=z.mid;if(oe.mid=le,Q=t.parse(this._pc.localDescription.sdp),_e=Q.media[$.idx],oe.rtcp.cname=u.getCname({offerMediaObject:_e}),!x)oe.encodings=p.getRtpEncodings({offerMediaObject:_e});else if(x.length===1){let ge=p.getRtpEncodings({offerMediaObject:_e});Object.assign(ge[0],x[0]),ne&&(ge=[ge[0]]),oe.encodings=ge}else oe.encodings=x;if(oe.encodings.length>1&&(oe.codecs[0].mimeType.toLowerCase()==="video/vp8"||oe.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const ge of oe.encodings)ge.scalabilityMode?ge.scalabilityMode=`L1T${ke.temporalLayers}`:ge.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:_e,reuseMid:$.reuseMid,offerRtpParameters:oe,answerRtpParameters:ce,codecOptions:E});const fe={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",fe),yield this._pc.setRemoteDescription(fe),this._mapMidTransceiver.set(le,z),{localId:le,rtpParameters:oe,rtpSender:z.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),f.debug("stopSending() [localId:%s]",S),this._closed)return;const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),oe=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:oe});const ce={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ce),yield this._pc.setRemoteDescription(ce),this._hasDataChannelMediaSection=!0}const Q={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:Q}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:Q,kind:K,rtpParameters:ee,streamId:oe}=q;f.debug("receive() [trackId:%s, kind:%s]",Q,K);const ce=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(Q,ce),this._remoteSdp.receive({mid:ce,kind:K,offerRtpParameters:ee,streamId:oe??ee.rtcp.cname,trackId:Q})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:Q,rtpParameters:K}=q,ee=M.get(Q),oe=z.media.find(ce=>String(ce.mid)===ee);u.applyCodecParameters({offerRtpParameters:K,answerMediaObject:oe})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:Q}=q,K=M.get(Q),ee=this._pc.getTransceivers().find(oe=>oe.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,Q={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",Q);const K=this._pc.createDataChannel(x,Q);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const oe=yield this._pc.createAnswer();if(!this._transportReady){const ce=t.parse(oe.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:ce})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",oe),yield this._pc.setLocalDescription(oe),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=u.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Chrome74=C}}),px=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Firefox120.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Firefox120=void 0;var t=Oi(),n=Yr(),r=zr(),i=Mi(),a=Ps(),o=Ko(),u=Pl(),p=kl(),h=Tl(),g=new r.Logger("Firefox120"),f="Firefox120",_={OS:16,MIS:2048},w=class Bu extends n.EnhancedEventEmitter{constructor({direction:R,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:$,getSendExtendedRtpCapabilities:z}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",q=>{this.emit("@icecandidateerror",q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),g.debug("constructor()"),this._direction=R,this._remoteSdp=new h.RemoteSdp({iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E}),this._getSendExtendedRtpCapabilities=z,this._pc=new RTCPeerConnection(ie({iceServers:M??[],iceTransportPolicy:Z??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},$)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:f,factory:R=>new Bu(R),getNativeRtpCapabilities:()=>H(null,null,function*(){g.debug("getNativeRtpCapabilities()");let R=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});const S=document.createElement("canvas");S.getContext("2d");const x=S.captureStream().getVideoTracks()[0];try{R.addTransceiver("audio",{direction:"sendrecv"}),R.addTransceiver(x,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const E=yield R.createOffer();try{S.remove()}catch{}try{x.stop()}catch{}try{R.close()}catch{}R=void 0;const M=t.parse(E.sdp);return Bu.getLocalRtpCapabilities(M)}catch(E){try{S.remove()}catch{}try{x.stop()}catch{}try{R==null||R.close()}catch{}throw R=void 0,E}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return g.debug("getNativeSctpCapabilities()"),{numStreams:_}})}}static getLocalRtpCapabilities(R){return u.extractRtpCapabilities({sdpObject:R})}get name(){return f}close(){if(g.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(R){return H(this,null,function*(){throw this.assertNotClosed(),new i.UnsupportedError("not supported")})}restartIce(R){return H(this,null,function*(){if(this.assertNotClosed(),g.debug("restartIce()"),this._remoteSdp.updateIceParameters(R),!!this._transportReady)if(this._direction==="send"){const S=yield this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",S),yield this._pc.setLocalDescription(S);const b={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",b),yield this._pc.setRemoteDescription(b)}else{const S={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(R){return H(this,arguments,function*({track:S,encodings:b,codecOptions:x,codec:E,onRtpSender:M}){this.assertNotClosed(),this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",S.kind,S.id),b&&b.length>1&&b.forEach((_e,le)=>{_e.rid=`r${le}`});const Z=this._pc.addTransceiver(S,{direction:"sendonly",streams:[this._sendStream],sendEncodings:b});M&&M(Z.sender);const $=yield this._pc.createOffer();let z=t.parse($.sdp);z.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const q=Bu.getLocalRtpCapabilities(z),Q=this._getSendExtendedRtpCapabilities(q),K=a.getSendingRtpParameters(S.kind,Q);K.codecs=a.reduceCodecs(K.codecs,E);const ee=a.getSendingRemoteRtpParameters(S.kind,Q);ee.codecs=a.reduceCodecs(ee.codecs,E),this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:z}));const oe=(0,o.parse)((b??[{}])[0].scalabilityMode);g.debug("send() | calling pc.setLocalDescription() [offer:%o]",$),yield this._pc.setLocalDescription($);const ce=Z.mid;K.mid=ce,z=t.parse(this._pc.localDescription.sdp);const ne=z.media[z.media.length-1];if(K.rtcp.cname=u.getCname({offerMediaObject:ne}),!b)K.encodings=p.getRtpEncodings({offerMediaObject:ne});else if(b.length===1){const _e=p.getRtpEncodings({offerMediaObject:ne});Object.assign(_e[0],b[0]),K.encodings=_e}else K.encodings=b;if(K.encodings.length>1&&(K.codecs[0].mimeType.toLowerCase()==="video/vp8"||K.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const _e of K.encodings)_e.scalabilityMode?_e.scalabilityMode=`L1T${oe.temporalLayers}`:_e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:ne,offerRtpParameters:K,answerRtpParameters:ee,codecOptions:x});const ke={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",ke),yield this._pc.setRemoteDescription(ke),this._mapMidTransceiver.set(ce,Z),{localId:ce,rtpParameters:K,rtpSender:Z.sender}})}stopSending(R){return H(this,null,function*(){if(this.assertSendDirection(),g.debug("stopSending() [localId:%s]",R),this._closed)return;const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated transceiver not found");S.sender.replaceTrack(null),this._pc.removeTrack(S.sender),this._remoteSdp.disableMediaSection(S.mid);const b=yield this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x),this._mapMidTransceiver.delete(R)})}pauseSending(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",R);const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");S.direction="inactive",this._remoteSdp.pauseMediaSection(R);const b=yield this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)})}resumeSending(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",R);const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");S.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(R);const b=yield this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)})}replaceTrack(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),S?g.debug("replaceTrack() [localId:%s, track.id:%s]",R,S.id):g.debug("replaceTrack() [localId:%s, no track]",R);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated RTCRtpTransceiver not found");yield b.sender.replaceTrack(S)})}setMaxSpatialLayer(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",R,S);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated transceiver not found");const x=b.sender.getParameters();x.encodings.forEach((Z,$)=>{$<=S?Z.active=!0:Z.active=!1}),yield b.sender.setParameters(x),this._remoteSdp.muxMediaSectionSimulcast(R,x.encodings);const E=yield this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M)})}setRtpEncodingParameters(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",R,S);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated RTCRtpTransceiver not found");const x=b.sender.getParameters();x.encodings.forEach((Z,$)=>{x.encodings[$]=ie(ie({},Z),S)}),yield b.sender.setParameters(x),this._remoteSdp.muxMediaSectionSimulcast(R,x.encodings);const E=yield this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M)})}getSenderStats(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");return S.sender.getStats()})}sendDataChannel(R){return H(this,arguments,function*({ordered:S,maxPacketLifeTime:b,maxRetransmits:x,label:E,protocol:M}){this.assertNotClosed(),this.assertSendDirection();const Z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:S,maxPacketLifeTime:b,maxRetransmits:x,protocol:M};g.debug("sendDataChannel() [options:%o]",Z);const $=this._pc.createDataChannel(E,Z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%_.MIS,!this._hasDataChannelMediaSection){const q=yield this._pc.createOffer(),Q=t.parse(q.sdp),K=Q.media.find(oe=>oe.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:Q})),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",q),yield this._pc.setLocalDescription(q),this._remoteSdp.sendSctpAssociation({offerMediaObject:K});const ee={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ee),yield this._pc.setRemoteDescription(ee),this._hasDataChannelMediaSection=!0}const z={streamId:Z.id,ordered:Z.ordered,maxPacketLifeTime:Z.maxPacketLifeTime,maxRetransmits:Z.maxRetransmits};return{dataChannel:$,sctpStreamParameters:z}})}receive(R){return H(this,null,function*(){var S;this.assertNotClosed(),this.assertRecvDirection();const b=[],x=new Map;for(const $ of R){const{trackId:z,kind:q,rtpParameters:Q,streamId:K}=$;g.debug("receive() [trackId:%s, kind:%s]",z,q);const ee=(S=Q.mid)!=null?S:String(this._mapMidTransceiver.size);x.set(z,ee),this._remoteSdp.receive({mid:ee,kind:q,offerRtpParameters:Q,streamId:K??Q.rtcp.cname,trackId:z})}const E={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",E),yield this._pc.setRemoteDescription(E);for(const $ of R){const{trackId:z,onRtpReceiver:q}=$;if(q){const Q=x.get(z),K=this._pc.getTransceivers().find(ee=>ee.mid===Q);if(!K)throw new Error("transceiver not found");q(K.receiver)}}let M=yield this._pc.createAnswer();const Z=t.parse(M.sdp);for(const $ of R){const{trackId:z,rtpParameters:q}=$,Q=x.get(z),K=Z.media.find(ee=>String(ee.mid)===Q);u.applyCodecParameters({offerRtpParameters:q,answerMediaObject:K}),M={type:"answer",sdp:t.write(Z)}}this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:Z})),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",M),yield this._pc.setLocalDescription(M);for(const $ of R){const{trackId:z}=$,q=x.get(z),Q=this._pc.getTransceivers().find(K=>K.mid===q);if(!Q)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(q,Q),b.push({localId:q,track:Q.receiver.track,rtpReceiver:Q.receiver})}return b})}stopReceiving(R){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const x of R){g.debug("stopReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(E.mid)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b);for(const x of R)this._mapMidTransceiver.delete(x)})}pauseReceiving(R){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const x of R){g.debug("pauseReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");E.direction="inactive",this._remoteSdp.pauseMediaSection(x)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)})}resumeReceiving(R){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const x of R){g.debug("resumeReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");E.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(x)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)})}getReceiverStats(R){return H(this,null,function*(){this.assertRecvDirection();const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");return S.receiver.getStats()})}receiveDataChannel(R){return H(this,arguments,function*({sctpStreamParameters:S,label:b,protocol:x}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:E,ordered:M,maxPacketLifeTime:Z,maxRetransmits:$}=S,z={negotiated:!0,id:E,ordered:M,maxPacketLifeTime:Z,maxRetransmits:$,protocol:x};g.debug("receiveDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(b,z);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const Q={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",Q),yield this._pc.setRemoteDescription(Q);const K=yield this._pc.createAnswer();if(!this._transportReady){const ee=t.parse(K.sdp);yield this.setupTransport({localDtlsRole:"client",localSdpObject:ee})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",K),yield this._pc.setLocalDescription(K),this._hasDataChannelMediaSection=!0}return{dataChannel:q}})}setupTransport(R){return H(this,arguments,function*({localDtlsRole:S,localSdpObject:b}){b||(b=t.parse(this._pc.localDescription.sdp));const x=u.extractDtlsParameters({sdpObject:b});x.role=S,this._remoteSdp.updateDtlsRole(S==="client"?"server":"client"),yield new Promise((E,M)=>{this.safeEmit("@connect",{dtlsParameters:x},E,M)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new i.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Firefox120=w}}),fx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Safari12.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Safari12=void 0;var t=Oi(),n=Yr(),r=zr(),i=Ps(),a=Mi(),o=Ko(),u=Tl(),p=Pl(),h=kl(),g=ah(),f=new r.Logger("Safari12"),_="Safari12",w={OS:1024,MIS:1024},C=class Uu extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_forcedLocalDtlsRole"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",Q=>{this.emit("@icecandidateerror",Q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new u.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",Q=>{this.emit("@icecandidateerror",Q)}),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Uu(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Uu.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=p.extractRtpCapabilities({sdpObject:S});return g.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id);const z=this._remoteSdp.getNextMediaSectionIdx(),q=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream]});Z&&Z(q.sender);let Q=yield this._pc.createOffer(),K=t.parse(Q.sdp);K.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const ee=Uu.getLocalRtpCapabilities(K),oe=this._getSendExtendedRtpCapabilities(ee),ce=i.getSendingRtpParameters(b.kind,oe);ce.codecs=i.reduceCodecs(ce.codecs,M);const ne=i.getSendingRemoteRtpParameters(b.kind,oe);ne.codecs=i.reduceCodecs(ne.codecs,M);let ke;this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:K}));const _e=(0,o.parse)((x??[{}])[0].scalabilityMode);x&&x.length>1&&(f.debug("send() | enabling legacy simulcast"),K=t.parse(Q.sdp),ke=K.media[z.idx],h.addLegacySimulcast({offerMediaObject:ke,numStreams:x.length}),Q={type:"offer",sdp:t.write(K)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",Q),yield this._pc.setLocalDescription(Q);const le=q.mid;if(ce.mid=le,K=t.parse(this._pc.localDescription.sdp),ke=K.media[z.idx],ce.rtcp.cname=p.getCname({offerMediaObject:ke}),ce.encodings=h.getRtpEncodings({offerMediaObject:ke}),x)for(let ge=0;ge<ce.encodings.length;++ge)x[ge]&&Object.assign(ce.encodings[ge],x[ge]);if(ce.encodings.length>1&&(ce.codecs[0].mimeType.toLowerCase()==="video/vp8"||ce.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const ge of ce.encodings)ge.scalabilityMode?ge.scalabilityMode=`L1T${_e.temporalLayers}`:ge.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:ke,reuseMid:z.reuseMid,offerRtpParameters:ce,answerRtpParameters:ne,codecOptions:E});const fe={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",fe),yield this._pc.setRemoteDescription(fe),this._mapMidTransceiver.set(le,q),{localId:le,rtpParameters:ce,rtpSender:q.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),this._closed)return;f.debug("stopSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(S);const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),oe=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:oe});const ce={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ce),yield this._pc.setRemoteDescription(ce),this._hasDataChannelMediaSection=!0}const Q={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:Q}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:Q,kind:K,rtpParameters:ee,streamId:oe}=q;f.debug("receive() [trackId:%s, kind:%s]",Q,K);const ce=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(Q,ce),this._remoteSdp.receive({mid:ce,kind:K,offerRtpParameters:ee,streamId:oe??ee.rtcp.cname,trackId:Q})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:Q,onRtpReceiver:K}=q;if(K){const ee=M.get(Q),oe=this._pc.getTransceivers().find(ce=>ce.mid===ee);if(!oe)throw new Error("transceiver not found");K(oe.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:Q,rtpParameters:K}=q,ee=M.get(Q),oe=z.media.find(ce=>String(ce.mid)===ee);p.applyCodecParameters({offerRtpParameters:K,answerMediaObject:oe})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:Q}=q,K=M.get(Q),ee=this._pc.getTransceivers().find(oe=>oe.mid===K);if(!ee)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver})}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,Q={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",Q);const K=this._pc.createDataChannel(x,Q);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const oe=yield this._pc.createAnswer();if(!this._transportReady){const ce=t.parse(oe.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:ce})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",oe),yield this._pc.setLocalDescription(oe),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=p.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Safari12=C}}),mx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/ReactNative106.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.ReactNative106=void 0;var t=Oi(),n=Yr(),r=zr(),i=Ps(),a=Mi(),o=Ko(),u=Tl(),p=Pl(),h=kl(),g=ah(),f=new r.Logger("ReactNative106"),_="ReactNative106",w={OS:1024,MIS:1024},C=class Hu extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_forcedLocalDtlsRole"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",Q=>{this.emit("@icecandidateerror",Q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new u.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Hu(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Hu.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=p.extractRtpCapabilities({sdpObject:S});return g.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0,this._sendStream.release(!1);try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $,z;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1&&x.forEach((Oe,Je)=>{Oe.rid=`r${Je}`});const q=this._remoteSdp.getNextMediaSectionIdx(),Q=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});Z&&Z(Q.sender);let K=yield this._pc.createOffer(),ee=t.parse(K.sdp);ee.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const oe=Hu.getLocalRtpCapabilities(ee),ce=this._getSendExtendedRtpCapabilities(oe),ne=i.getSendingRtpParameters(b.kind,ce);ne.codecs=i.reduceCodecs(ne.codecs,M);const ke=i.getSendingRemoteRtpParameters(b.kind,ce);ke.codecs=i.reduceCodecs(ke.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee}));let _e=!1;const le=(0,o.parse)((x??[{}])[0].scalabilityMode);let fe;x&&x.length===1&&le.spatialLayers>1&&ne.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),_e=!0,ee=t.parse(K.sdp),fe=ee.media[q.idx],h.addLegacySimulcast({offerMediaObject:fe,numStreams:le.spatialLayers}),K={type:"offer",sdp:t.write(ee)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K);let ge=(z=Q.mid)!=null?z:void 0;if(ge||f.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),ne.mid=ge,ee=t.parse(this._pc.localDescription.sdp),fe=ee.media[q.idx],ne.rtcp.cname=p.getCname({offerMediaObject:fe}),!x)ne.encodings=h.getRtpEncodings({offerMediaObject:fe});else if(x.length===1){let Oe=h.getRtpEncodings({offerMediaObject:fe});Object.assign(Oe[0],x[0]),_e&&(Oe=[Oe[0]]),ne.encodings=Oe}else ne.encodings=x;if(ne.encodings.length>1&&(ne.codecs[0].mimeType.toLowerCase()==="video/vp8"||ne.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const Oe of ne.encodings)Oe.scalabilityMode?Oe.scalabilityMode=`L1T${le.temporalLayers}`:Oe.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:fe,reuseMid:q.reuseMid,offerRtpParameters:ne,answerRtpParameters:ke,codecOptions:E});const Ee={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",Ee),yield this._pc.setRemoteDescription(Ee),ge||(ge=Q.mid,ne.mid=ge),this._mapMidTransceiver.set(ge,Q),{localId:ge,rtpParameters:ne,rtpSender:Q.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),this._closed)return;f.debug("stopSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),oe=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:oe});const ce={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ce),yield this._pc.setRemoteDescription(ce),this._hasDataChannelMediaSection=!0}const Q={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:Q}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:Q,kind:K,rtpParameters:ee,streamId:oe}=q;f.debug("receive() [trackId:%s, kind:%s]",Q,K);const ce=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(Q,ce),this._remoteSdp.receive({mid:ce,kind:K,offerRtpParameters:ee,streamId:oe??ee.rtcp.cname,trackId:Q})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:Q,onRtpReceiver:K}=q;if(K){const ee=M.get(Q),oe=this._pc.getTransceivers().find(ce=>ce.mid===ee);if(!oe)throw new Error("transceiver not found");K(oe.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:Q,rtpParameters:K}=q,ee=M.get(Q),oe=z.media.find(ce=>String(ce.mid)===ee);p.applyCodecParameters({offerRtpParameters:K,answerMediaObject:oe})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:Q}=q,K=M.get(Q),ee=this._pc.getTransceivers().find(oe=>oe.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,Q={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",Q);const K=this._pc.createDataChannel(x,Q);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const oe=yield this._pc.createAnswer();if(!this._transportReady){const ce=t.parse(oe.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:ce})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",oe),yield this._pc.setLocalDescription(oe),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=p.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.ReactNative106=C}}),gx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Device.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Device=void 0,e.detectDeviceAsync=C,e.detectDevice=R;var t=l_(),n=zr(),r=Yr(),i=Mi(),a=zo(),o=Ps(),u=lx(),p=dx(),h=hx(),g=px(),f=fx(),_=mx(),w=new n.Logger("Device");function C(x){return H(this,null,function*(){w.debug("detectDeviceAsync() [userAgent:%s]",x),!x&&typeof navigator=="object"&&(x=navigator.userAgent);const E=(0,t.UAParser)(x);return b(E)})}function R(x){w.debug("detectDevice() [userAgent:%s]",x),!x&&typeof navigator=="object"&&(x=navigator.userAgent);const E=(0,t.UAParser)(x);return b(E)}var S=class k_{constructor({handlerName:E,handlerFactory:M}={}){if(me(this,"_handlerFactory"),me(this,"_handlerName"),me(this,"_loaded",!1),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_recvRtpCapabilities"),me(this,"_canProduceByKind",{audio:!1,video:!1}),me(this,"_sctpCapabilities"),me(this,"_observer",new r.EnhancedEventEmitter),w.debug("constructor()"),E&&M)throw new TypeError("just one of handlerName or handlerInterface can be given");if(M)this._handlerFactory=M;else{if(E)w.debug("constructor() | handler given: %s",E);else if(E=R(),E)w.debug("constructor() | detected handler: %s",E);else throw new i.UnsupportedError("device not supported");switch(E){case"Chrome111":{this._handlerFactory=p.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=h.Chrome74.createFactory();break}case"Firefox120":{this._handlerFactory=g.Firefox120.createFactory();break}case"Safari12":{this._handlerFactory=f.Safari12.createFactory();break}case"ReactNative106":{this._handlerFactory=_.ReactNative106.createFactory();break}default:throw new TypeError(`unknown handlerName "${E}"`)}}this._handlerName=this._handlerFactory.name}static factory(){return H(this,arguments,function*({handlerName:E,handlerFactory:M}={}){if(w.debug("factory()"),E&&M)throw new TypeError("just one of handlerName or handlerInterface can be given");if(!E&&!M&&(E=yield C(),!E))throw new i.UnsupportedError("device not supported");return new k_({handlerName:E,handlerFactory:M})})}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new i.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new i.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}load(E){return H(this,arguments,function*({routerRtpCapabilities:M,preferLocalCodecsOrder:Z=!1}){if(w.debug("load() [routerRtpCapabilities:%o]",M),this._loaded)throw new i.InvalidStateError("already loaded");const $=a.clone(M);o.validateRtpCapabilities($);const{getNativeRtpCapabilities:z,getNativeSctpCapabilities:q}=this._handlerFactory,Q=a.clone(yield z());o.validateRtpCapabilities(Q),w.debug("load() | got native RTP capabilities:%o",Q),this._getSendExtendedRtpCapabilities=ee=>a.clone(o.getExtendedRtpCapabilities(ee,$,Z));const K=o.getExtendedRtpCapabilities(Q,$,!1);this._recvRtpCapabilities=o.getRecvRtpCapabilities(K),o.validateRtpCapabilities(this._recvRtpCapabilities),w.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._canProduceByKind.audio=o.canSend("audio",this._recvRtpCapabilities),this._canProduceByKind.video=o.canSend("video",this._recvRtpCapabilities),this._sctpCapabilities=yield q(),o.validateSctpCapabilities(this._sctpCapabilities),w.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),w.debug("load() succeeded"),this._loaded=!0})}canProduce(E){if(this._loaded){if(E!=="audio"&&E!=="video")throw new TypeError(`invalid kind "${E}"`)}else throw new i.InvalidStateError("not loaded");return this._canProduceByKind[E]}createSendTransport({id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:Q,additionalSettings:K,appData:ee}){return w.debug("createSendTransport()"),this.createTransport({direction:"send",id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:Q,additionalSettings:K,appData:ee})}createRecvTransport({id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:Q,additionalSettings:K,appData:ee}){return w.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:Q,additionalSettings:K,appData:ee})}createTransport({direction:E,id:M,iceParameters:Z,iceCandidates:$,dtlsParameters:z,sctpParameters:q,iceServers:Q,iceTransportPolicy:K,additionalSettings:ee,appData:oe}){if(this._loaded){if(typeof M!="string")throw new TypeError("missing id");if(typeof Z!="object")throw new TypeError("missing iceParameters");if(Array.isArray($)){if(typeof z!="object")throw new TypeError("missing dtlsParameters");if(q&&typeof q!="object")throw new TypeError("wrong sctpParameters");if(oe&&typeof oe!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new i.InvalidStateError("not loaded");const ce=new u.Transport({direction:E,id:M,iceParameters:Z,iceCandidates:$,dtlsParameters:z,sctpParameters:q,iceServers:Q,iceTransportPolicy:K,additionalSettings:ee,appData:oe,handlerFactory:this._handlerFactory,getSendExtendedRtpCapabilities:this._getSendExtendedRtpCapabilities,recvRtpCapabilities:this._recvRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",ce),ce}};e.Device=S;function b(x){var E,M,Z,$,z,q;if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(w.debug("detectDeviceImpl() | React-Native detected"),typeof RTCPeerConnection>"u"||typeof RTCRtpTransceiver>"u"){w.warn("detectDeviceImpl() | unsupported react-native-webrtc without RTCPeerConnection or RTCRtpTransceiver, forgot to call registerGlobals() on it?");return}return"ReactNative106"}else{w.debug("detectDeviceImpl() | browser detected [userAgent:%s, parsed:%o]",x.ua,x);const Q=x.browser,K=(E=Q.name)==null?void 0:E.toLowerCase(),ee=parseInt((M=Q.major)!=null?M:"0"),ce=(Z=x.engine.name)==null?void 0:Z.toLowerCase(),ne=x.os,ke=($=ne.name)==null?void 0:$.toLowerCase(),_e=parseFloat((z=ne.version)!=null?z:"0"),fe=(q=x.device.model)==null?void 0:q.toLowerCase(),ge=ke==="ios"||fe==="ipad",Ee=K&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(K),Oe=K&&["firefox","mobile firefox","mobile focus"].includes(K),Je=K&&["safari","mobile safari"].includes(K),ut=K&&["edge"].includes(K);if((Ee||ut)&&!ge&&ee>=111)return"Chrome111";if(Ee&&!ge&&ee>=74||ut&&!ge&&ee>=88)return"Chrome74";if(Oe&&!ge&&ee>=120)return"Firefox120";if(Oe&&ge&&_e>=14.3)return"Safari12";if(Je&&ee>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(ce==="webkit"&&ge&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(ce==="blink"){const ot=x.ua.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);return ot?Number(ot[1])>=111?"Chrome111":"Chrome74":"Chrome111"}else{w.warn("detectDeviceImpl() | browser not supported [name:%s, version:%s]",K,ee);return}}}}}),vx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/max.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default="ffffffff-ffff-ffff-ffff-ffffffffffff"}}),yx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/nil.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default="00000000-0000-0000-0000-000000000000"}}),_x=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/regex.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i}}),oh=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/validate.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=_x();function n(r){return typeof r=="string"&&t.default.test(r)}e.default=n}}),ch=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/parse.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=oh();function n(r){if(!(0,t.default)(r))throw TypeError("Invalid UUID");let i;return Uint8Array.of((i=parseInt(r.slice(0,8),16))>>>24,i>>>16&255,i>>>8&255,i&255,(i=parseInt(r.slice(9,13),16))>>>8,i&255,(i=parseInt(r.slice(14,18),16))>>>8,i&255,(i=parseInt(r.slice(19,23),16))>>>8,i&255,(i=parseInt(r.slice(24,36),16))/1099511627776&255,i/4294967296&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255)}e.default=n}}),la=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/stringify.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.unsafeStringify=void 0;var t=oh(),n=[];for(let a=0;a<256;++a)n.push((a+256).toString(16).slice(1));function r(a,o=0){return(n[a[o+0]]+n[a[o+1]]+n[a[o+2]]+n[a[o+3]]+"-"+n[a[o+4]]+n[a[o+5]]+"-"+n[a[o+6]]+n[a[o+7]]+"-"+n[a[o+8]]+n[a[o+9]]+"-"+n[a[o+10]]+n[a[o+11]]+n[a[o+12]]+n[a[o+13]]+n[a[o+14]]+n[a[o+15]]).toLowerCase()}e.unsafeStringify=r;function i(a,o=0){const u=r(a,o);if(!(0,t.default)(u))throw TypeError("Stringified UUID is invalid");return u}e.default=i}}),sg=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/rng.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t,n=new Uint8Array(16);function r(){if(!t){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(n)}e.default=r}}),T_=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.updateV1State=void 0;var t=sg(),n=la(),r={};function i(u,p,h){var g,f,_,w;let C;const R=(g=u==null?void 0:u._v6)!=null?g:!1;if(u){const S=Object.keys(u);S.length===1&&S[0]==="_v6"&&(u=void 0)}if(u)C=o((w=(_=u.random)!=null?_:(f=u.rng)==null?void 0:f.call(u))!=null?w:(0,t.default)(),u.msecs,u.nsecs,u.clockseq,u.node,p,h);else{const S=Date.now(),b=(0,t.default)();a(r,S,b),C=o(b,r.msecs,r.nsecs,R?void 0:r.clockseq,R?void 0:r.node,p,h)}return p??(0,n.unsafeStringify)(C)}function a(u,p,h){var g,f;return(g=u.msecs)!=null||(u.msecs=-1/0),(f=u.nsecs)!=null||(u.nsecs=0),p===u.msecs?(u.nsecs++,u.nsecs>=1e4&&(u.node=void 0,u.nsecs=0)):p>u.msecs?u.nsecs=0:p<u.msecs&&(u.node=void 0),u.node||(u.node=h.slice(10,16),u.node[0]|=1,u.clockseq=(h[8]<<8|h[9])&16383),u.msecs=p,u}e.updateV1State=a;function o(u,p,h,g,f,_,w=0){if(u.length<16)throw new Error("Random bytes length must be >= 16");if(!_)_=new Uint8Array(16),w=0;else if(w<0||w+16>_.length)throw new RangeError(`UUID byte range ${w}:${w+15} is out of buffer bounds`);p??(p=Date.now()),h??(h=0),g??(g=(u[8]<<8|u[9])&16383),f??(f=u.slice(10,16)),p+=122192928e5;const C=((p&268435455)*1e4+h)%4294967296;_[w++]=C>>>24&255,_[w++]=C>>>16&255,_[w++]=C>>>8&255,_[w++]=C&255;const R=p/4294967296*1e4&268435455;_[w++]=R>>>8&255,_[w++]=R&255,_[w++]=R>>>24&15|16,_[w++]=R>>>16&255,_[w++]=g>>>8|128,_[w++]=g&255;for(let S=0;S<6;++S)_[w++]=f[S];return _}e.default=i}}),R_=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v1ToV6.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=ch(),n=la();function r(a){const o=typeof a=="string"?(0,t.default)(a):a,u=i(o);return typeof a=="string"?(0,n.unsafeStringify)(u):u}e.default=r;function i(a){return Uint8Array.of((a[6]&15)<<4|a[7]>>4&15,(a[7]&15)<<4|(a[4]&240)>>4,(a[4]&15)<<4|(a[5]&240)>>4,(a[5]&15)<<4|(a[0]&240)>>4,(a[0]&15)<<4|(a[1]&240)>>4,(a[1]&15)<<4|(a[2]&240)>>4,96|a[2]&15,a[3],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}}}),bx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/md5.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});function t(w){const C=a(w),R=i(C,w.length*8);return n(R)}function n(w){const C=new Uint8Array(w.length*4);for(let R=0;R<w.length*4;R++)C[R]=w[R>>2]>>>R%4*8&255;return C}function r(w){return(w+64>>>9<<4)+14+1}function i(w,C){const R=new Uint32Array(r(C)).fill(0);R.set(w),R[C>>5]|=128<<C%32,R[R.length-1]=C,w=R;let S=1732584193,b=-271733879,x=-1732584194,E=271733878;for(let M=0;M<w.length;M+=16){const Z=S,$=b,z=x,q=E;S=h(S,b,x,E,w[M],7,-680876936),E=h(E,S,b,x,w[M+1],12,-389564586),x=h(x,E,S,b,w[M+2],17,606105819),b=h(b,x,E,S,w[M+3],22,-1044525330),S=h(S,b,x,E,w[M+4],7,-176418897),E=h(E,S,b,x,w[M+5],12,1200080426),x=h(x,E,S,b,w[M+6],17,-1473231341),b=h(b,x,E,S,w[M+7],22,-45705983),S=h(S,b,x,E,w[M+8],7,1770035416),E=h(E,S,b,x,w[M+9],12,-1958414417),x=h(x,E,S,b,w[M+10],17,-42063),b=h(b,x,E,S,w[M+11],22,-1990404162),S=h(S,b,x,E,w[M+12],7,1804603682),E=h(E,S,b,x,w[M+13],12,-40341101),x=h(x,E,S,b,w[M+14],17,-1502002290),b=h(b,x,E,S,w[M+15],22,1236535329),S=g(S,b,x,E,w[M+1],5,-165796510),E=g(E,S,b,x,w[M+6],9,-1069501632),x=g(x,E,S,b,w[M+11],14,643717713),b=g(b,x,E,S,w[M],20,-373897302),S=g(S,b,x,E,w[M+5],5,-701558691),E=g(E,S,b,x,w[M+10],9,38016083),x=g(x,E,S,b,w[M+15],14,-660478335),b=g(b,x,E,S,w[M+4],20,-405537848),S=g(S,b,x,E,w[M+9],5,568446438),E=g(E,S,b,x,w[M+14],9,-1019803690),x=g(x,E,S,b,w[M+3],14,-187363961),b=g(b,x,E,S,w[M+8],20,1163531501),S=g(S,b,x,E,w[M+13],5,-1444681467),E=g(E,S,b,x,w[M+2],9,-51403784),x=g(x,E,S,b,w[M+7],14,1735328473),b=g(b,x,E,S,w[M+12],20,-1926607734),S=f(S,b,x,E,w[M+5],4,-378558),E=f(E,S,b,x,w[M+8],11,-2022574463),x=f(x,E,S,b,w[M+11],16,1839030562),b=f(b,x,E,S,w[M+14],23,-35309556),S=f(S,b,x,E,w[M+1],4,-1530992060),E=f(E,S,b,x,w[M+4],11,1272893353),x=f(x,E,S,b,w[M+7],16,-155497632),b=f(b,x,E,S,w[M+10],23,-1094730640),S=f(S,b,x,E,w[M+13],4,681279174),E=f(E,S,b,x,w[M],11,-358537222),x=f(x,E,S,b,w[M+3],16,-722521979),b=f(b,x,E,S,w[M+6],23,76029189),S=f(S,b,x,E,w[M+9],4,-640364487),E=f(E,S,b,x,w[M+12],11,-421815835),x=f(x,E,S,b,w[M+15],16,530742520),b=f(b,x,E,S,w[M+2],23,-995338651),S=_(S,b,x,E,w[M],6,-198630844),E=_(E,S,b,x,w[M+7],10,1126891415),x=_(x,E,S,b,w[M+14],15,-1416354905),b=_(b,x,E,S,w[M+5],21,-57434055),S=_(S,b,x,E,w[M+12],6,1700485571),E=_(E,S,b,x,w[M+3],10,-1894986606),x=_(x,E,S,b,w[M+10],15,-1051523),b=_(b,x,E,S,w[M+1],21,-2054922799),S=_(S,b,x,E,w[M+8],6,1873313359),E=_(E,S,b,x,w[M+15],10,-30611744),x=_(x,E,S,b,w[M+6],15,-1560198380),b=_(b,x,E,S,w[M+13],21,1309151649),S=_(S,b,x,E,w[M+4],6,-145523070),E=_(E,S,b,x,w[M+11],10,-1120210379),x=_(x,E,S,b,w[M+2],15,718787259),b=_(b,x,E,S,w[M+9],21,-343485551),S=o(S,Z),b=o(b,$),x=o(x,z),E=o(E,q)}return Uint32Array.of(S,b,x,E)}function a(w){if(w.length===0)return new Uint32Array;const C=new Uint32Array(r(w.length*8)).fill(0);for(let R=0;R<w.length;R++)C[R>>2]|=(w[R]&255)<<R%4*8;return C}function o(w,C){const R=(w&65535)+(C&65535);return(w>>16)+(C>>16)+(R>>16)<<16|R&65535}function u(w,C){return w<<C|w>>>32-C}function p(w,C,R,S,b,x){return o(u(o(o(C,w),o(S,x)),b),R)}function h(w,C,R,S,b,x,E){return p(C&R|~C&S,w,C,b,x,E)}function g(w,C,R,S,b,x,E){return p(C&S|R&~S,w,C,b,x,E)}function f(w,C,R,S,b,x,E){return p(C^R^S,w,C,b,x,E)}function _(w,C,R,S,b,x,E){return p(R^(C|~S),w,C,b,x,E)}e.default=t}}),wd=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v35.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=e.stringToBytes=void 0;var t=ch(),n=la();function r(a){a=unescape(encodeURIComponent(a));const o=new Uint8Array(a.length);for(let u=0;u<a.length;++u)o[u]=a.charCodeAt(u);return o}e.stringToBytes=r,e.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",e.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function i(a,o,u,p,h,g){const f=typeof u=="string"?r(u):u,_=typeof p=="string"?(0,t.default)(p):p;if(typeof p=="string"&&(p=(0,t.default)(p)),(p==null?void 0:p.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let w=new Uint8Array(16+f.length);if(w.set(_),w.set(f,_.length),w=o(w),w[6]=w[6]&15|a,w[8]=w[8]&63|128,h){g=g||0;for(let C=0;C<16;++C)h[g+C]=w[C];return h}return(0,n.unsafeStringify)(w)}e.default=i}}),Sx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v3.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;var t=bx(),n=wd(),r=wd();Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return r.URL}});function i(a,o,u,p){return(0,n.default)(48,t.default,a,o,u,p)}i.DNS=n.DNS,i.URL=n.URL,e.default=i}}),wx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/native.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);e.default={randomUUID:t}}}),xx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v4.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=wx(),n=sg(),r=la();function i(a,o,u){var p,h,g;if(t.default.randomUUID&&!o&&!a)return t.default.randomUUID();a=a||{};const f=(g=(h=a.random)!=null?h:(p=a.rng)==null?void 0:p.call(a))!=null?g:(0,n.default)();if(f.length<16)throw new Error("Random bytes length must be >= 16");if(f[6]=f[6]&15|64,f[8]=f[8]&63|128,o){if(u=u||0,u<0||u+16>o.length)throw new RangeError(`UUID byte range ${u}:${u+15} is out of buffer bounds`);for(let _=0;_<16;++_)o[u+_]=f[_];return o}return(0,r.unsafeStringify)(f)}e.default=i}}),Cx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/sha1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});function t(i,a,o,u){switch(i){case 0:return a&o^~a&u;case 1:return a^o^u;case 2:return a&o^a&u^o&u;case 3:return a^o^u}}function n(i,a){return i<<a|i>>>32-a}function r(i){const a=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520],u=new Uint8Array(i.length+1);u.set(i),u[i.length]=128,i=u;const p=i.length/4+2,h=Math.ceil(p/16),g=new Array(h);for(let f=0;f<h;++f){const _=new Uint32Array(16);for(let w=0;w<16;++w)_[w]=i[f*64+w*4]<<24|i[f*64+w*4+1]<<16|i[f*64+w*4+2]<<8|i[f*64+w*4+3];g[f]=_}g[h-1][14]=(i.length-1)*8/Math.pow(2,32),g[h-1][14]=Math.floor(g[h-1][14]),g[h-1][15]=(i.length-1)*8&4294967295;for(let f=0;f<h;++f){const _=new Uint32Array(80);for(let x=0;x<16;++x)_[x]=g[f][x];for(let x=16;x<80;++x)_[x]=n(_[x-3]^_[x-8]^_[x-14]^_[x-16],1);let w=o[0],C=o[1],R=o[2],S=o[3],b=o[4];for(let x=0;x<80;++x){const E=Math.floor(x/20),M=n(w,5)+t(E,C,R,S)+b+a[E]+_[x]>>>0;b=S,S=R,R=n(C,30)>>>0,C=w,w=M}o[0]=o[0]+w>>>0,o[1]=o[1]+C>>>0,o[2]=o[2]+R>>>0,o[3]=o[3]+S>>>0,o[4]=o[4]+b>>>0}return Uint8Array.of(o[0]>>24,o[0]>>16,o[0]>>8,o[0],o[1]>>24,o[1]>>16,o[1]>>8,o[1],o[2]>>24,o[2]>>16,o[2]>>8,o[2],o[3]>>24,o[3]>>16,o[3]>>8,o[3],o[4]>>24,o[4]>>16,o[4]>>8,o[4])}e.default=r}}),Ex=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v5.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;var t=Cx(),n=wd(),r=wd();Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return r.URL}});function i(a,o,u,p){return(0,n.default)(80,t.default,a,o,u,p)}i.DNS=n.DNS,i.URL=n.URL,e.default=i}}),Px=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v6.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=la(),n=T_(),r=R_();function i(a,o,u){a??(a={}),u??(u=0);let p=(0,n.default)(Se(ie({},a),{_v6:!0}),new Uint8Array(16));if(p=(0,r.default)(p),o){for(let h=0;h<16;h++)o[u+h]=p[h];return o}return(0,t.unsafeStringify)(p)}e.default=i}}),kx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v6ToV1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=ch(),n=la();function r(a){const o=typeof a=="string"?(0,t.default)(a):a,u=i(o);return typeof a=="string"?(0,n.unsafeStringify)(u):u}e.default=r;function i(a){return Uint8Array.of((a[3]&15)<<4|a[4]>>4&15,(a[4]&15)<<4|(a[5]&240)>>4,(a[5]&15)<<4|a[6]&15,a[7],(a[1]&15)<<4|(a[2]&240)>>4,(a[2]&15)<<4|(a[3]&240)>>4,16|(a[0]&240)>>4,(a[0]&15)<<4|(a[1]&240)>>4,a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}}}),Tx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v7.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.updateV7State=void 0;var t=sg(),n=la(),r={};function i(u,p,h){var g,f,_;let w;if(u)w=o((_=(f=u.random)!=null?f:(g=u.rng)==null?void 0:g.call(u))!=null?_:(0,t.default)(),u.msecs,u.seq,p,h);else{const C=Date.now(),R=(0,t.default)();a(r,C,R),w=o(R,r.msecs,r.seq,p,h)}return p??(0,n.unsafeStringify)(w)}function a(u,p,h){var g,f;return(g=u.msecs)!=null||(u.msecs=-1/0),(f=u.seq)!=null||(u.seq=0),p>u.msecs?(u.seq=h[6]<<23|h[7]<<16|h[8]<<8|h[9],u.msecs=p):(u.seq=u.seq+1|0,u.seq===0&&u.msecs++),u}e.updateV7State=a;function o(u,p,h,g,f=0){if(u.length<16)throw new Error("Random bytes length must be >= 16");if(!g)g=new Uint8Array(16),f=0;else if(f<0||f+16>g.length)throw new RangeError(`UUID byte range ${f}:${f+15} is out of buffer bounds`);return p??(p=Date.now()),h??(h=u[6]*127<<24|u[7]<<16|u[8]<<8|u[9]),g[f++]=p/1099511627776&255,g[f++]=p/4294967296&255,g[f++]=p/16777216&255,g[f++]=p/65536&255,g[f++]=p/256&255,g[f++]=p&255,g[f++]=112|h>>>28&15,g[f++]=h>>>20&255,g[f++]=128|h>>>14&63,g[f++]=h>>>6&255,g[f++]=h<<2&255|u[10]&3,g[f++]=u[11],g[f++]=u[12],g[f++]=u[13],g[f++]=u[14],g[f++]=u[15],g}e.default=i}}),Rx=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/version.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=oh();function n(r){if(!(0,t.default)(r))throw TypeError("Invalid UUID");return parseInt(r.slice(14,15),16)}e.default=n}}),Ax=Ce({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.validate=e.v7=e.v6ToV1=e.v6=e.v5=e.v4=e.v3=e.v1ToV6=e.v1=e.stringify=e.parse=e.NIL=e.MAX=void 0;var t=vx();Object.defineProperty(e,"MAX",{enumerable:!0,get:function(){return t.default}});var n=yx();Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return n.default}});var r=ch();Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return r.default}});var i=la();Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return i.default}});var a=T_();Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return a.default}});var o=R_();Object.defineProperty(e,"v1ToV6",{enumerable:!0,get:function(){return o.default}});var u=Sx();Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return u.default}});var p=xx();Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return p.default}});var h=Ex();Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return h.default}});var g=Px();Object.defineProperty(e,"v6",{enumerable:!0,get:function(){return g.default}});var f=kx();Object.defineProperty(e,"v6ToV1",{enumerable:!0,get:function(){return f.default}});var _=Tx();Object.defineProperty(e,"v7",{enumerable:!0,get:function(){return _.default}});var w=oh();Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return w.default}});var C=Rx();Object.defineProperty(e,"version",{enumerable:!0,get:function(){return C.default}})}}),Ix=Ce({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/FakeEventTarget.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeEventTarget=void 0;var t=class{constructor(){me(this,"listeners",{})}addEventListener(n,r,i={}){var a,o;r&&((o=(a=this.listeners)[n])!=null||(a[n]=[]),this.listeners[n].push({callback:r,once:i.once===!0}))}removeEventListener(n,r){this.listeners[n]&&(this.listeners[n]=this.listeners[n].filter(i=>i.callback!==r))}dispatchEvent(n){if(!n||typeof n.type!="string")throw new Error("invalid event object");const r=this.listeners[n.type];if(!r)return!0;for(const i of[...r]){try{i.callback.call(this,n)}catch(a){setTimeout(()=>{throw a},0)}i.once&&this.removeEventListener(n.type,i.callback)}return!n.defaultPrevented}};e.FakeEventTarget=t}}),Fx=Ce({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.clone=t;function t(n){if(n!==void 0)return Number.isNaN(n)?NaN:typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n))}}}),Dx=Ce({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeMediaStreamTrack=void 0;var t=Ax(),n=Ix(),r=Fx(),i,a,o,u,p,h,g,f,_,w,C,R,S,b,x,E,M=class A_ extends n.FakeEventTarget{constructor({kind:z,id:q,label:Q,contentHint:K,enabled:ee,muted:oe,readyState:ce,capabilities:ne,constraints:ke,settings:_e,data:le}){super(),lr(this,i),lr(this,a),lr(this,o),lr(this,u),lr(this,p),lr(this,h),lr(this,g),lr(this,f),lr(this,_),lr(this,w),lr(this,C),lr(this,R,null),lr(this,S,null),lr(this,b,null),lr(this,x,null),lr(this,E,null),dn(this,i,q??(0,t.v4)()),dn(this,a,z),dn(this,o,Q??""),dn(this,g,K??""),dn(this,p,ee??!0),dn(this,h,oe??!1),dn(this,u,ce??"live"),dn(this,f,ne??{}),dn(this,_,ke??{}),dn(this,w,_e??{}),dn(this,C,le??{})}get id(){return xt(this,i)}get kind(){return xt(this,a)}get label(){return xt(this,o)}get contentHint(){return xt(this,g)}set contentHint(z){dn(this,g,z)}get enabled(){return xt(this,p)}set enabled(z){const q=xt(this,p)!==z;dn(this,p,z),q&&this.dispatchEvent(new Event("enabledchange"))}get muted(){return xt(this,h)}get readyState(){return xt(this,u)}get data(){return xt(this,C)}set data(z){dn(this,C,z)}get onmute(){return xt(this,R)}set onmute(z){xt(this,R)&&this.removeEventListener("mute",xt(this,R)),dn(this,R,z),z&&this.addEventListener("mute",z)}get onunmute(){return xt(this,S)}set onunmute(z){xt(this,S)&&this.removeEventListener("unmute",xt(this,S)),dn(this,S,z),z&&this.addEventListener("unmute",z)}get onended(){return xt(this,b)}set onended(z){xt(this,b)&&this.removeEventListener("ended",xt(this,b)),dn(this,b,z),z&&this.addEventListener("ended",z)}get onenabledchange(){return xt(this,x)}set onenabledchange(z){xt(this,x)&&this.removeEventListener("enabledchange",xt(this,x)),dn(this,x,z),z&&this.addEventListener("enabledchange",z)}get onstopped(){return xt(this,E)}set onstopped(z){xt(this,E)&&this.removeEventListener("stopped",xt(this,E)),dn(this,E,z),z&&this.addEventListener("stopped",z)}addEventListener(z,q,Q){super.addEventListener(z,q,Q)}removeEventListener(z,q){super.removeEventListener(z,q)}stop(){xt(this,u)!=="ended"&&(dn(this,u,"ended"),this.dispatchEvent(new Event("stopped")))}clone({id:z,data:q}={}){return new A_({id:z??(0,t.v4)(),kind:xt(this,a),label:xt(this,o),contentHint:xt(this,g),enabled:xt(this,p),muted:xt(this,h),readyState:xt(this,u),capabilities:(0,r.clone)(xt(this,f)),constraints:(0,r.clone)(xt(this,_)),settings:(0,r.clone)(xt(this,w)),data:q??(0,r.clone)(xt(this,C))})}getCapabilities(){return xt(this,f)}getConstraints(){return xt(this,_)}applyConstraints(){return H(this,arguments,function*(z={}){return dn(this,_,z),Promise.resolve()})}getSettings(){return xt(this,w)}remoteStop(){xt(this,u)!=="ended"&&(dn(this,u,"ended"),this.dispatchEvent(new Event("stopped")),this.dispatchEvent(new Event("ended")))}remoteMute(){xt(this,h)||(dn(this,h,!0),this.dispatchEvent(new Event("mute")))}remoteUnmute(){xt(this,h)&&(dn(this,h,!1),this.dispatchEvent(new Event("unmute")))}};i=new WeakMap,a=new WeakMap,o=new WeakMap,u=new WeakMap,p=new WeakMap,h=new WeakMap,g=new WeakMap,f=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,R=new WeakMap,S=new WeakMap,b=new WeakMap,x=new WeakMap,E=new WeakMap;var Z=M;e.FakeMediaStreamTrack=Z}}),Nx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/FakeHandler.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeHandler=void 0;var t=Dx(),n=Yr(),r=zr(),i=zo(),a=Ps(),o=Mi(),u=new r.Logger("FakeHandler"),p="FakeHandler",h=class Vu extends n.EnhancedEventEmitter{constructor({getSendExtendedRtpCapabilities:_},w){super(),me(this,"_closed",!1),me(this,"_fakeParameters"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_cname",`CNAME-${i.generateRandomNumber()}`),me(this,"_transportReady",!1),me(this,"_nextLocalId",1),me(this,"_tracks",new Map),me(this,"_nextSctpStreamId",0),u.debug("constructor()"),this._getSendExtendedRtpCapabilities=_,this._fakeParameters=w}static createFactory(_){return{name:p,factory:w=>new Vu(w,_),getNativeRtpCapabilities:()=>H(null,null,function*(){return u.debug("getNativeRtpCapabilities()"),Vu.getLocalRtpCapabilities(_)}),getNativeSctpCapabilities:()=>H(null,null,function*(){return u.debug("getNativeSctpCapabilities()"),_.generateNativeSctpCapabilities()})}}static getLocalRtpCapabilities(_){return _.generateNativeRtpCapabilities()}get name(){return p}close(){u.debug("close()"),!this._closed&&(this._closed=!0,super.close())}setIceGatheringState(_){this.emit("@icegatheringstatechange",_)}setConnectionState(_){this.emit("@connectionstatechange",_)}updateIceServers(_){return H(this,null,function*(){this.assertNotClosed(),u.debug("updateIceServers()")})}restartIce(_){return H(this,null,function*(){this.assertNotClosed(),u.debug("restartIce()")})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),new Map})}send(_){return H(this,arguments,function*({track:w,encodings:C,codecOptions:R,codec:S}){this.assertNotClosed(),u.debug("send() [kind:%s, track.id:%s]",w.kind,w.id),this._transportReady||(yield this.setupTransport({localDtlsRole:"server"}));const b=Vu.getLocalRtpCapabilities(this._fakeParameters),x=this._getSendExtendedRtpCapabilities(b),E=a.getSendingRtpParameters(w.kind,x);E.codecs=a.reduceCodecs(E.codecs,S);const M=E.codecs.some($=>/.+\/rtx$/i.test($.mimeType));E.mid=`mid-${i.generateRandomNumber()}`,C||(C=[{}]);for(const $ of C)$.ssrc=i.generateRandomNumber(),M&&($.rtx={ssrc:i.generateRandomNumber()});E.encodings=C,E.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const Z=this._nextLocalId++;return this._tracks.set(Z,w),{localId:String(Z),rtpParameters:E}})}stopSending(_){return H(this,null,function*(){if(u.debug("stopSending() [localId:%s]",_),!this._closed){if(!this._tracks.has(Number(_)))throw new Error("local track not found");this._tracks.delete(Number(_))}})}pauseSending(_){return H(this,null,function*(){this.assertNotClosed()})}resumeSending(_){return H(this,null,function*(){this.assertNotClosed()})}replaceTrack(_,w){return H(this,null,function*(){this.assertNotClosed(),w?u.debug("replaceTrack() [localId:%s, track.id:%s]",_,w.id):u.debug("replaceTrack() [localId:%s, no track]",_),this._tracks.delete(Number(_)),this._tracks.set(Number(_),w)})}setMaxSpatialLayer(_,w){return H(this,null,function*(){this.assertNotClosed(),u.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",_,w)})}setRtpEncodingParameters(_,w){return H(this,null,function*(){this.assertNotClosed(),u.debug("setRtpEncodingParameters() [localId:%s, params:%o]",_,w)})}getSenderStats(_){return H(this,null,function*(){return this.assertNotClosed(),new Map})}sendDataChannel(_){return H(this,arguments,function*({ordered:w,maxPacketLifeTime:C,maxRetransmits:R,label:S,protocol:b}){this.assertNotClosed(),this._transportReady||(yield this.setupTransport({localDtlsRole:"server"})),u.debug("sendDataChannel()");const x=new g({id:this._nextSctpStreamId++,ordered:w,maxPacketLifeTime:C,maxRetransmits:R,label:S,protocol:b}),E={streamId:this._nextSctpStreamId,ordered:w,maxPacketLifeTime:C,maxRetransmits:R};return{dataChannel:x,sctpStreamParameters:E}})}receive(_){return H(this,null,function*(){this.assertNotClosed();const w=[];for(const C of _){const{trackId:R,kind:S}=C;this._transportReady||(yield this.setupTransport({localDtlsRole:"client"})),u.debug("receive() [trackId:%s, kind:%s]",R,S);const b=this._nextLocalId++,x=new t.FakeMediaStreamTrack({kind:S});this._tracks.set(b,x),w.push({localId:String(b),track:x})}return w})}stopReceiving(_){return H(this,null,function*(){if(!this._closed)for(const w of _)u.debug("stopReceiving() [localId:%s]",w),this._tracks.delete(Number(w))})}pauseReceiving(_){return H(this,null,function*(){this.assertNotClosed()})}resumeReceiving(_){return H(this,null,function*(){this.assertNotClosed()})}getReceiverStats(_){return H(this,null,function*(){return this.assertNotClosed(),new Map})}receiveDataChannel(_){return H(this,arguments,function*({sctpStreamParameters:w,label:C,protocol:R}){return this.assertNotClosed(),this._transportReady||(yield this.setupTransport({localDtlsRole:"client"})),u.debug("receiveDataChannel()"),{dataChannel:new g({id:w.streamId,ordered:w.ordered,maxPacketLifeTime:w.maxPacketLifeTime,maxRetransmits:w.maxRetransmits,label:C,protocol:R})}})}setupTransport(_){return H(this,arguments,function*({localDtlsRole:w,localSdpObject:C}){const R=i.clone(this._fakeParameters.generateLocalDtlsParameters());w&&(R.role=w),this.emit("@connectionstatechange","connecting"),yield new Promise((S,b)=>this.emit("@connect",{dtlsParameters:R},S,b)),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new o.InvalidStateError("method called in a closed handler")}};e.FakeHandler=h;var g=class extends EventTarget{constructor({id:f,ordered:_=!0,maxPacketLifeTime:w=null,maxRetransmits:C=null,label:R="",protocol:S=""}){super(),me(this,"_id"),me(this,"_negotiated",!0),me(this,"_ordered"),me(this,"_maxPacketLifeTime"),me(this,"_maxRetransmits"),me(this,"_label"),me(this,"_protocol"),me(this,"_readyState","connecting"),me(this,"_bufferedAmount",0),me(this,"_bufferedAmountLowThreshold",0),me(this,"_binaryType","arraybuffer"),me(this,"_onopen",null),me(this,"_onclosing",null),me(this,"_onclose",null),me(this,"_onmessage",null),me(this,"_onbufferedamountlow",null),me(this,"_onerror",null),u.debug(`constructor() [id:${f}, ordered:${_}, maxPacketLifeTime:${w}, maxRetransmits:${C}, label:${R}, protocol:${S}`),this._id=f,this._ordered=_,this._maxPacketLifeTime=w,this._maxRetransmits=C,this._label=R,this._protocol=S}get id(){return this._id}get negotiated(){return this._negotiated}get ordered(){return this._ordered}get maxPacketLifeTime(){return this._maxPacketLifeTime}get maxRetransmits(){return this._maxRetransmits}get label(){return this._label}get protocol(){return this._protocol}get readyState(){return this._readyState}get bufferedAmount(){return this._bufferedAmount}get bufferedAmountLowThreshold(){return this._bufferedAmountLowThreshold}set bufferedAmountLowThreshold(f){this._bufferedAmountLowThreshold=f}get binaryType(){return this._binaryType}set binaryType(f){this._binaryType=f}get onopen(){return this._onopen}set onopen(f){this._onopen&&this.removeEventListener("open",this._onopen),this._onopen=f,f&&this.addEventListener("open",f)}get onclosing(){return this._onclosing}set onclosing(f){this._onclosing&&this.removeEventListener("closing",this._onclosing),this._onclosing=f,f&&this.addEventListener("closing",f)}get onclose(){return this._onclose}set onclose(f){this._onclose&&this.removeEventListener("close",this._onclose),this._onclose=f,f&&this.addEventListener("close",f)}get onmessage(){return this._onmessage}set onmessage(f){this._onmessage&&this.removeEventListener("message",this._onmessage),this._onmessage=f,f&&this.addEventListener("message",f)}get onbufferedamountlow(){return this._onbufferedamountlow}set onbufferedamountlow(f){this._onbufferedamountlow&&this.removeEventListener("bufferedamountlow",this._onbufferedamountlow),this._onbufferedamountlow=f,f&&this.addEventListener("bufferedamountlow",f)}get onerror(){return this._onerror}set onerror(f){this._onerror&&this.removeEventListener("error",this._onerror),this._onerror=f,f&&this.addEventListener("error",f)}addEventListener(f,_,w){super.addEventListener(f,_,w)}removeEventListener(f,_,w){super.removeEventListener(f,_,w)}close(){["closing","closed"].includes(this._readyState)||(this._readyState="closed")}send(f){if(this._readyState!=="open")throw new o.InvalidStateError("not open")}}}}),Ox=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/test/fakeParameters.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.generateRouterRtpCapabilities=r,e.generateNativeRtpCapabilities=i,e.generateNativeSctpCapabilities=a,e.generateLocalDtlsParameters=o,e.generateTransportRemoteParameters=u,e.generateProducerRemoteParameters=p,e.generateConsumerRemoteParameters=h,e.generateDataProducerRemoteParameters=g,e.generateDataConsumerRemoteParameters=f;var t=zo();function n(){return String(t.generateRandomNumber())}function r(){return t.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}},{mimeType:"video/H264",kind:"video",preferredPayloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:105,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"profile-id":0,"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:106,clockRate:9e4,rtcpFeedback:[],parameters:{apt:105}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id",preferredId:2,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id",preferredId:3,preferredEncrypt:!1,direction:"recvonly"},{kind:"audio",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:11,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:12,preferredEncrypt:!1,direction:"sendrecv"}]})}function i(){return t.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:111,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{minptime:10,useinbandfec:1}},{mimeType:"audio/ISAC",kind:"audio",preferredPayloadType:103,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/CN",kind:"audio",preferredPayloadType:106,clockRate:32e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/foo",kind:"audio",preferredPayloadType:107,clockRate:9e4,channels:4,rtcpFeedback:[{type:"foo-qwe-qwe"}],parameters:{foo:"lalala"}},{mimeType:"video/BAZCODEC",kind:"video",preferredPayloadType:100,clockRate:9e4,rtcpFeedback:[{type:"foo"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[],parameters:{apt:100}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:96,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:97,clockRate:9e4,rtcpFeedback:[],parameters:{apt:96}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:98,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{"profile-id":0}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:99,clockRate:9e4,rtcpFeedback:[],parameters:{apt:98}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:2},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:3},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:4},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",preferredId:6},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",preferredId:7},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing",preferredId:8},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10}]})}function a(){return t.deepFreeze({numStreams:{OS:2048,MIS:2048}})}function o(){return t.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"82:5A:68:3D:36:C3:0A:DE:AF:E7:32:43:D2:88:83:57:AC:2D:65:E5:80:C4:B6:FB:AF:1A:A0:21:9F:6D:0C:AD"}],role:"auto"})}function u(){return{id:n(),iceParameters:t.deepFreeze({iceLite:!0,password:"yku5ej8nvfaor28lvtrabcx0wkrpkztz",usernameFragment:"h3hk1iz6qqlnqlne"}),iceCandidates:t.deepFreeze([{foundation:"udpcandidate",address:"9.9.9.9",ip:"9.9.9.9",port:40533,priority:1078862079,protocol:"udp",type:"host",tcpType:"passive"},{foundation:"udpcandidate",address:"9.9.9.9",ip:"9:9:9:9:9:9",port:41333,priority:1078862089,protocol:"udp",type:"host",tcpType:"passive"}]),dtlsParameters:t.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"A9:F4:E0:D2:74:D3:0F:D9:CA:A5:2F:9F:7F:47:FA:F0:C4:72:DD:73:49:D0:3B:14:90:20:51:30:1B:90:8E:71"},{algorithm:"sha-384",value:"03:D9:0B:87:13:98:F6:6D:BC:FC:92:2E:39:D4:E1:97:32:61:30:56:84:70:81:6E:D1:82:97:EA:D9:C1:21:0F:6B:C5:E7:7F:E1:97:0C:17:97:6E:CF:B3:EF:2E:74:B0"},{algorithm:"sha-512",value:"84:27:A4:28:A4:73:AF:43:02:2A:44:68:FF:2F:29:5C:3B:11:9A:60:F4:A8:F0:F5:AC:A0:E3:49:3E:B1:34:53:A9:85:CE:51:9B:ED:87:5E:B8:F4:8E:3D:FA:20:51:B8:96:EE:DA:56:DC:2F:5C:62:79:15:23:E0:21:82:2B:2C"}],role:"auto"}),sctpParameters:t.deepFreeze({port:5e3,OS:2048,MIS:2048,maxMessageSize:2e6})}}function p(){return t.deepFreeze({id:n()})}function h({id:_,codecMimeType:w}={}){switch(w){case"audio/opus":return{id:_??n(),producerId:n(),kind:"audio",rtpParameters:t.deepFreeze({codecs:[{mimeType:"audio/opus",payloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}}],encodings:[{ssrc:46687003}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",id:10}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"audio/ISAC":return{id:_??n(),producerId:n(),kind:"audio",rtpParameters:t.deepFreeze({codecs:[{mimeType:"audio/ISAC",payloadType:111,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}}],encodings:[{ssrc:46687004}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/VP8":return{id:_??n(),producerId:n(),kind:"video",rtpParameters:t.deepFreeze({codecs:[{mimeType:"video/VP8",payloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",payloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}}],encodings:[{ssrc:99991111,rtx:{ssrc:99991112}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/H264":return{id:_??n(),producerId:n(),kind:"video",rtpParameters:t.deepFreeze({codecs:[{mimeType:"video/H264",payloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",payloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}}],encodings:[{ssrc:99991113,rtx:{ssrc:99991114}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};default:throw new TypeError(`unknown codecMimeType '${w}'`)}}function g(){return t.deepFreeze({id:n()})}function f({id:_}={}){return{id:_??n(),dataProducerId:n(),sctpStreamParameters:t.deepFreeze({streamId:666,maxPacketLifeTime:5e3,maxRetransmits:void 0})}}}}),Mx=Ce({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.testFakeParameters=e.FakeHandler=e.enhancedEvents=e.ortc=e.parseScalabilityMode=e.detectDeviceAsync=e.detectDevice=e.Device=e.version=e.types=void 0;var t=sh();e.debug=t.default,e.types=Q3(),e.version="3.15.2";var n=gx();Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return n.Device}}),Object.defineProperty(e,"detectDevice",{enumerable:!0,get:function(){return n.detectDevice}}),Object.defineProperty(e,"detectDeviceAsync",{enumerable:!0,get:function(){return n.detectDeviceAsync}});var r=Ko();Object.defineProperty(e,"parseScalabilityMode",{enumerable:!0,get:function(){return r.parse}}),e.ortc=Ps(),e.enhancedEvents=Yr();var i=Nx();Object.defineProperty(e,"FakeHandler",{enumerable:!0,get:function(){return i.FakeHandler}}),e.testFakeParameters=Ox()}});Y();Y();Y();Y();Y();Y();Y();var $v=["disable","error","warn","info","debug"],Wa=class js{constructor(t){this.debug=(...n)=>(this._log("debug",...n),Date.now()),this.info=(...n)=>(this._log("info",...n),Date.now()),this.warn=(...n)=>{this._log("warn",...n)},this.error=(...n)=>{this._log("error",...n)},this.elapsed=(n,...r)=>{const i=Date.now()-n;this._log("info",`elapsed ms:${i}`,...r)},this.prefix=t}_log(t,...n){const r=$v.indexOf(t);if($v.indexOf(js.level)>=r){const a=new Date,o=js.formatter.formatToParts(a),u=_=>{var w;return(w=o.find(C=>C.type===_))==null?void 0:w.value},p=String(a.getMilliseconds()).padStart(3,"0"),h=`${u("year")}-${u("month")}-${u("day")}T${u("hour")}:${u("minute")}:${u("second")}.${p}+09:00`;n=[this.prefix,...n].map(_=>{if(_ instanceof Error)return _.toJSON?_.toJSON():{name:_.name,message:_.message,stack:_.stack};if(typeof _=="object")try{return JSON.parse(JSON.stringify(_))}catch{return"json error"}return _});let f=[h,t,...n];switch(js.format==="string"&&(f=[h+" "+t+" "+JSON.stringify(n)]),t){case"debug":console.debug(...f);break;case"info":console.info(...f);break;case"warn":console.warn(...f);break;case"error":console.error(...f);break}js.onLog({id:js.id,timestamp:h,level:t,message:n}),js._onLogForAnalytics({id:js.id,timestamp:h,level:t,message:n,prefix:this.prefix})}}createBlock(t){return{warn:(...n)=>{this.warn(ie({},t),...n)},debug:(...n)=>{this.debug(ie({},t),...n)},info:(...n)=>{this.info(ie({},t),...n)},error:(...n)=>{this.error(ie({},t),...n)}}}};Wa.level="error";Wa.format="object";Wa.onLog=()=>{};Wa._onLogForAnalytics=()=>{};Wa.id=Math.random().toString().slice(2,7);Wa.formatter=new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});var ze=Wa,Lx=new ze("packages/common/src/error.ts"),wr=class extends Error{constructor(e,t=!0){if(super(e.info.detail),this.id=Math.random().toString().slice(2,10),Object.assign(this,e),this.name=this.info.name,t){const n=["SkyWayError",`name:${this.info.name}, detail:${this.info.detail}, solution:${this.info.solution}`];this.path&&n.push(this.path),this.error&&n.push(this.error),this.payload&&n.push(this.payload),n.push(this.id),Lx.warn(...n)}}toJSON(){return{id:this.id,info:this.info,path:this.path,payload:this.payload,error:this.error,stack:this.stack}}};Y();var jx=new ze("packages/common/src/event.ts"),We=class{constructor(e=()=>{}){this._onSetListener=e,this._stack=[],this._eventIndex=0,this.emit=t=>{for(const n of this._stack)try{n.execute(t)}catch(r){jx.error("task throws error",r)}},this.removeAllListeners=()=>{this._stack=[]},this.pipe=t=>this.add(n=>t.emit(n)),this.add=t=>{const n=this._eventIndex;this._stack.push({execute:t,id:n}),this._eventIndex++;const r=()=>{this._stack=this._stack.filter(a=>a.id!==n&&a)},i=a=>{a.push(r)};return this._onSetListener(),{removeListener:r,disposer:i}},this.once=t=>{const n=this.add(r=>{n.removeListener(),t(r)});return n},this.asPromise=t=>new Promise((n,r)=>{const i=t&&setTimeout(()=>{r(new Wv("Event asPromise timeout : "+t))},t);this.once(a=>{i&&clearTimeout(i),n(a)})}),this.watch=(t,n)=>new Promise((r,i)=>{const a=n&&setTimeout(()=>{i(new Wv("Event watch timeout : "+n))},n),{removeListener:o}=this.add(u=>{t(u)&&(a&&clearTimeout(a),o(),r(u))})})}get length(){return this._stack.length}},ts=class{constructor(){this.events=[]}make(){const e=new We;return this.events.push(e),e}dispose(){this.events.forEach(e=>e.removeAllListeners()),this.events=[]}},ei=class{constructor(){this._disposer=[]}push(e){this._disposer.push(e)}dispose(){this._disposer.forEach(e=>e()),this._disposer=[]}},Wv=class extends Error{toJSON(){return{name:this.name,message:this.message,stack:this.stack}}};Y();Y();Y();Y();Y();function I_(e,t){return function(){return e.apply(t,arguments)}}var{toString:Bx}=Object.prototype,{getPrototypeOf:ag}=Object,{iterator:lh,toStringTag:F_}=Symbol,uh=(e=>t=>{const n=Bx.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Li=e=>(e=e.toLowerCase(),t=>uh(t)===e),dh=e=>t=>typeof t===e,{isArray:$o}=Array,il=dh("undefined");function Ux(e){return e!==null&&!il(e)&&e.constructor!==null&&!il(e.constructor)&&Hr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}var D_=Li("ArrayBuffer");function Hx(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&D_(e.buffer),t}var Vx=dh("string"),Hr=dh("function"),N_=dh("number"),hh=e=>e!==null&&typeof e=="object",qx=e=>e===!0||e===!1,qu=e=>{if(uh(e)!=="object")return!1;const t=ag(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(F_ in e)&&!(lh in e)},zx=Li("Date"),Kx=Li("File"),$x=Li("Blob"),Wx=Li("FileList"),Gx=e=>hh(e)&&Hr(e.pipe),Jx=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Hr(e.append)&&((t=uh(e))==="formdata"||t==="object"&&Hr(e.toString)&&e.toString()==="[object FormData]"))},Zx=Li("URLSearchParams"),[Xx,Qx,Yx,eC]=["ReadableStream","Request","Response","Headers"].map(Li),tC=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Rl(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),$o(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const a=n?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let u;for(r=0;r<o;r++)u=a[r],t.call(null,e[u],u,e)}}function O_(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}var Ra=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,M_=e=>!il(e)&&e!==Ra;function Of(){const{caseless:e}=M_(this)&&this||{},t={},n=(r,i)=>{const a=e&&O_(t,i)||i;qu(t[a])&&qu(r)?t[a]=Of(t[a],r):qu(r)?t[a]=Of({},r):$o(r)?t[a]=r.slice():t[a]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Rl(arguments[r],n);return t}var nC=(e,t,n,{allOwnKeys:r}={})=>(Rl(t,(i,a)=>{n&&Hr(i)?e[a]=I_(i,n):e[a]=i},{allOwnKeys:r}),e),rC=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),iC=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},sC=(e,t,n,r)=>{let i,a,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)o=i[a],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&ag(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},aC=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},oC=e=>{if(!e)return null;if($o(e))return e;let t=e.length;if(!N_(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},cC=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&ag(Uint8Array)),lC=(e,t)=>{const r=(e&&e[lh]).call(e);let i;for(;(i=r.next())&&!i.done;){const a=i.value;t.call(e,a[0],a[1])}},uC=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},dC=Li("HTMLFormElement"),hC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Gv=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),pC=Li("RegExp"),L_=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Rl(n,(i,a)=>{let o;(o=t(i,a,e))!==!1&&(r[a]=o||i)}),Object.defineProperties(e,r)},fC=e=>{L_(e,(t,n)=>{if(Hr(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Hr(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},mC=(e,t)=>{const n={},r=i=>{i.forEach(a=>{n[a]=!0})};return $o(e)?r(e):r(String(e).split(t)),n},gC=()=>{},vC=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function yC(e){return!!(e&&Hr(e.append)&&e[F_]==="FormData"&&e[lh])}var _C=e=>{const t=new Array(10),n=(r,i)=>{if(hh(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const a=$o(r)?[]:{};return Rl(r,(o,u)=>{const p=n(o,i+1);!il(p)&&(a[u]=p)}),t[i]=void 0,a}}return r};return n(e,0)},bC=Li("AsyncFunction"),SC=e=>e&&(hh(e)||Hr(e))&&Hr(e.then)&&Hr(e.catch),j_=((e,t)=>e?setImmediate:t?((n,r)=>(Ra.addEventListener("message",({source:i,data:a})=>{i===Ra&&a===n&&r.length&&r.shift()()},!1),i=>{r.push(i),Ra.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Hr(Ra.postMessage)),wC=typeof queueMicrotask<"u"?queueMicrotask.bind(Ra):typeof Eo<"u"&&Eo.nextTick||j_,xC=e=>e!=null&&Hr(e[lh]),Te={isArray:$o,isArrayBuffer:D_,isBuffer:Ux,isFormData:Jx,isArrayBufferView:Hx,isString:Vx,isNumber:N_,isBoolean:qx,isObject:hh,isPlainObject:qu,isReadableStream:Xx,isRequest:Qx,isResponse:Yx,isHeaders:eC,isUndefined:il,isDate:zx,isFile:Kx,isBlob:$x,isRegExp:pC,isFunction:Hr,isStream:Gx,isURLSearchParams:Zx,isTypedArray:cC,isFileList:Wx,forEach:Rl,merge:Of,extend:nC,trim:tC,stripBOM:rC,inherits:iC,toFlatObject:sC,kindOf:uh,kindOfTest:Li,endsWith:aC,toArray:oC,forEachEntry:lC,matchAll:uC,isHTMLForm:dC,hasOwnProperty:Gv,hasOwnProp:Gv,reduceDescriptors:L_,freezeMethods:fC,toObjectSet:mC,toCamelCase:hC,noop:gC,toFiniteNumber:vC,findKey:O_,global:Ra,isContextDefined:M_,isSpecCompliantForm:yC,toJSONObject:_C,isAsyncFn:bC,isThenable:SC,setImmediate:j_,asap:wC,isIterable:xC};Y();Y();Y();Y();Y();function No(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Te.inherits(No,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Te.toJSONObject(this.config),code:this.code,status:this.status}}});var B_=No.prototype,U_={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{U_[e]={value:e}});Object.defineProperties(No,U_);Object.defineProperty(B_,"isAxiosError",{value:!0});No.from=(e,t,n,r,i,a)=>{const o=Object.create(B_);return Te.toFlatObject(e,o,function(p){return p!==Error.prototype},u=>u!=="isAxiosError"),No.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};var Ft=No;Y();var CC=null;function Mf(e){return Te.isPlainObject(e)||Te.isArray(e)}function H_(e){return Te.endsWith(e,"[]")?e.slice(0,-2):e}function Jv(e,t,n){return e?e.concat(t).map(function(i,a){return i=H_(i),!n&&a?"["+i+"]":i}).join(n?".":""):t}function EC(e){return Te.isArray(e)&&!e.some(Mf)}var PC=Te.toFlatObject(Te,{},null,function(t){return/^is[A-Z]/.test(t)});function kC(e,t,n){if(!Te.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Te.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(R,S){return!Te.isUndefined(S[R])});const r=n.metaTokens,i=n.visitor||g,a=n.dots,o=n.indexes,p=(n.Blob||typeof Blob<"u"&&Blob)&&Te.isSpecCompliantForm(t);if(!Te.isFunction(i))throw new TypeError("visitor must be a function");function h(C){if(C===null)return"";if(Te.isDate(C))return C.toISOString();if(Te.isBoolean(C))return C.toString();if(!p&&Te.isBlob(C))throw new Ft("Blob is not supported. Use a Buffer instead.");return Te.isArrayBuffer(C)||Te.isTypedArray(C)?p&&typeof Blob=="function"?new Blob([C]):Buffer.from(C):C}function g(C,R,S){let b=C;if(C&&!S&&typeof C=="object"){if(Te.endsWith(R,"{}"))R=r?R:R.slice(0,-2),C=JSON.stringify(C);else if(Te.isArray(C)&&EC(C)||(Te.isFileList(C)||Te.endsWith(R,"[]"))&&(b=Te.toArray(C)))return R=H_(R),b.forEach(function(E,M){!(Te.isUndefined(E)||E===null)&&t.append(o===!0?Jv([R],M,a):o===null?R:R+"[]",h(E))}),!1}return Mf(C)?!0:(t.append(Jv(S,R,a),h(C)),!1)}const f=[],_=Object.assign(PC,{defaultVisitor:g,convertValue:h,isVisitable:Mf});function w(C,R){if(!Te.isUndefined(C)){if(f.indexOf(C)!==-1)throw Error("Circular reference detected in "+R.join("."));f.push(C),Te.forEach(C,function(b,x){(!(Te.isUndefined(b)||b===null)&&i.call(t,b,Te.isString(x)?x.trim():x,R,_))===!0&&w(b,R?R.concat(x):[x])}),f.pop()}}if(!Te.isObject(e))throw new TypeError("data must be an object");return w(e),t}var ph=kC;function Zv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function V_(e,t){this._pairs=[],e&&ph(e,this,t)}var q_=V_.prototype;q_.append=function(t,n){this._pairs.push([t,n])};q_.toString=function(t){const n=t?function(r){return t.call(this,r,Zv)}:Zv;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};var z_=V_;function TC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function K_(e,t,n){if(!t)return e;const r=n&&n.encode||TC;Te.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let a;if(i?a=i(t,n):a=Te.isURLSearchParams(t)?t.toString():new z_(t,n).toString(r),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}Y();var RC=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Te.forEach(this.handlers,function(n){n!==null&&e(n)})}},Xv=RC;Y();Y();Y();Y();var $_={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};Y();Y();Y();Y();var AC=typeof URLSearchParams<"u"?URLSearchParams:z_;Y();var IC=typeof FormData<"u"?FormData:null;Y();var FC=typeof Blob<"u"?Blob:null,DC={isBrowser:!0,classes:{URLSearchParams:AC,FormData:IC,Blob:FC},protocols:["http","https","file","blob","url","data"]},W_={};s_(W_,{hasBrowserEnv:()=>og,hasStandardBrowserEnv:()=>NC,hasStandardBrowserWebWorkerEnv:()=>OC,navigator:()=>Lf,origin:()=>MC});Y();var og=typeof window<"u"&&typeof document<"u",Lf=typeof navigator=="object"&&navigator||void 0,NC=og&&(!Lf||["ReactNative","NativeScript","NS"].indexOf(Lf.product)<0),OC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",MC=og&&window.location.href||"http://localhost",hr=ie(ie({},W_),DC);function LC(e,t){return ph(e,new hr.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,a){return hr.isNode&&Te.isBuffer(n)?(this.append(r,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}Y();function jC(e){return Te.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function BC(e){const t={},n=Object.keys(e);let r;const i=n.length;let a;for(r=0;r<i;r++)a=n[r],t[a]=e[a];return t}function UC(e){function t(n,r,i,a){let o=n[a++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),p=a>=n.length;return o=!o&&Te.isArray(i)?i.length:o,p?(Te.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!Te.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],a)&&Te.isArray(i[o])&&(i[o]=BC(i[o])),!u)}if(Te.isFormData(e)&&Te.isFunction(e.entries)){const n={};return Te.forEachEntry(e,(r,i)=>{t(jC(r),i,n,0)}),n}return null}var G_=UC;function HC(e,t,n){if(Te.isString(e))try{return(t||JSON.parse)(e),Te.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}var cg={transitional:$_,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,a=Te.isObject(t);if(a&&Te.isHTMLForm(t)&&(t=new FormData(t)),Te.isFormData(t))return i?JSON.stringify(G_(t)):t;if(Te.isArrayBuffer(t)||Te.isBuffer(t)||Te.isStream(t)||Te.isFile(t)||Te.isBlob(t)||Te.isReadableStream(t))return t;if(Te.isArrayBufferView(t))return t.buffer;if(Te.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return LC(t,this.formSerializer).toString();if((u=Te.isFileList(t))||r.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return ph(u?{"files[]":t}:t,p&&new p,this.formSerializer)}}return a||i?(n.setContentType("application/json",!1),HC(t)):t}],transformResponse:[function(t){const n=this.transitional||cg.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(Te.isResponse(t)||Te.isReadableStream(t))return t;if(t&&Te.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Ft.from(u,Ft.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:hr.classes.FormData,Blob:hr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Te.forEach(["delete","get","head","post","put","patch"],e=>{cg.headers[e]={}});var lg=cg;Y();Y();var VC=Te.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),qC=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&VC[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Qv=Symbol("internals");function vc(e){return e&&String(e).trim().toLowerCase()}function zu(e){return e===!1||e==null?e:Te.isArray(e)?e.map(zu):String(e)}function zC(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}var KC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function wp(e,t,n,r,i){if(Te.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!Te.isString(t)){if(Te.isString(r))return t.indexOf(r)!==-1;if(Te.isRegExp(r))return r.test(t)}}function $C(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function WC(e,t){const n=Te.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,a,o){return this[r].call(this,t,i,a,o)},configurable:!0})})}var fh=class{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(o,u,p){const h=vc(u);if(!h)throw new Error("header name must be a non-empty string");const g=Te.findKey(r,h);(!g||r[g]===void 0||p===!0||p===void 0&&r[g]!==!1)&&(r[g||u]=zu(o))}const a=(o,u)=>Te.forEach(o,(p,h)=>i(p,h,u));if(Te.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(Te.isString(e)&&(e=e.trim())&&!KC(e))a(qC(e),t);else if(Te.isObject(e)&&Te.isIterable(e)){let o={},u,p;for(const h of e){if(!Te.isArray(h))throw TypeError("Object iterator must return a key-value pair");o[p=h[0]]=(u=o[p])?Te.isArray(u)?[...u,h[1]]:[u,h[1]]:h[1]}a(o,t)}else e!=null&&i(t,e,n);return this}get(e,t){if(e=vc(e),e){const n=Te.findKey(this,e);if(n){const r=this[n];if(!t)return r;if(t===!0)return zC(r);if(Te.isFunction(t))return t.call(this,r,n);if(Te.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=vc(e),e){const n=Te.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||wp(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let r=!1;function i(a){if(a=vc(a),a){const o=Te.findKey(n,a);o&&(!t||wp(n,n[o],o,t))&&(delete n[o],r=!0)}}return Te.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];(!e||wp(this,this[i],i,e,!0))&&(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return Te.forEach(this,(r,i)=>{const a=Te.findKey(n,i);if(a){t[a]=zu(r),delete t[i];return}const o=e?$C(i):String(i).trim();o!==i&&delete t[i],t[o]=zu(r),n[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Te.forEach(this,(n,r)=>{n!=null&&n!==!1&&(t[r]=e&&Te.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(r=>n.set(r)),n}static accessor(e){const n=(this[Qv]=this[Qv]={accessors:{}}).accessors,r=this.prototype;function i(a){const o=vc(a);n[o]||(WC(r,a),n[o]=!0)}return Te.isArray(e)?e.forEach(i):i(e),this}};fh.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Te.reduceDescriptors(fh.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});Te.freezeMethods(fh);var Ii=fh;function xp(e,t){const n=this||lg,r=t||n,i=Ii.from(r.headers);let a=r.data;return Te.forEach(e,function(u){a=u.call(n,a,i.normalize(),t?t.status:void 0)}),i.normalize(),a}Y();function J_(e){return!!(e&&e.__CANCEL__)}Y();function Z_(e,t,n){Ft.call(this,e??"canceled",Ft.ERR_CANCELED,t,n),this.name="CanceledError"}Te.inherits(Z_,Ft,{__CANCEL__:!0});var Al=Z_;Y();Y();Y();function X_(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Ft("Request failed with status code "+n.status,[Ft.ERR_BAD_REQUEST,Ft.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}Y();function GC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}Y();Y();function JC(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,a=0,o;return t=t!==void 0?t:1e3,function(p){const h=Date.now(),g=r[a];o||(o=h),n[i]=p,r[i]=h;let f=a,_=0;for(;f!==i;)_+=n[f++],f=f%e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),h-o<t)return;const w=g&&h-g;return w?Math.round(_*1e3/w):void 0}}var ZC=JC;Y();function XC(e,t){let n=0,r=1e3/t,i,a;const o=(h,g=Date.now())=>{n=g,i=null,a&&(clearTimeout(a),a=null),e.apply(null,h)};return[(...h)=>{const g=Date.now(),f=g-n;f>=r?o(h,g):(i=h,a||(a=setTimeout(()=>{a=null,o(i)},r-f)))},()=>i&&o(i)]}var QC=XC,xd=(e,t,n=3)=>{let r=0;const i=ZC(50,250);return QC(a=>{const o=a.loaded,u=a.lengthComputable?a.total:void 0,p=o-r,h=i(p),g=o<=u;r=o;const f={loaded:o,total:u,progress:u?o/u:void 0,bytes:p,rate:h||void 0,estimated:h&&u&&g?(u-o)/h:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(f)},n)},Yv=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},e1=e=>(...t)=>Te.asap(()=>e(...t));Y();Y();var YC=hr.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,hr.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(hr.origin),hr.navigator&&/(msie|trident)/i.test(hr.navigator.userAgent)):()=>!0;Y();var eE=hr.hasStandardBrowserEnv?{write(e,t,n,r,i,a){const o=[e+"="+encodeURIComponent(t)];Te.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Te.isString(r)&&o.push("path="+r),Te.isString(i)&&o.push("domain="+i),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};Y();Y();function tE(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}Y();function nE(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Q_(e,t,n){let r=!tE(t);return e&&(r||n==!1)?nE(e,t):t}Y();var t1=e=>e instanceof Ii?ie({},e):e;function Va(e,t){t=t||{};const n={};function r(h,g,f,_){return Te.isPlainObject(h)&&Te.isPlainObject(g)?Te.merge.call({caseless:_},h,g):Te.isPlainObject(g)?Te.merge({},g):Te.isArray(g)?g.slice():g}function i(h,g,f,_){if(Te.isUndefined(g)){if(!Te.isUndefined(h))return r(void 0,h,f,_)}else return r(h,g,f,_)}function a(h,g){if(!Te.isUndefined(g))return r(void 0,g)}function o(h,g){if(Te.isUndefined(g)){if(!Te.isUndefined(h))return r(void 0,h)}else return r(void 0,g)}function u(h,g,f){if(f in t)return r(h,g);if(f in e)return r(void 0,h)}const p={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(h,g,f)=>i(t1(h),t1(g),f,!0)};return Te.forEach(Object.keys(Object.assign({},e,t)),function(g){const f=p[g]||i,_=f(e[g],t[g],g);Te.isUndefined(_)&&f!==u||(n[g]=_)}),n}var Y_=e=>{const t=Va({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:u}=t;t.headers=o=Ii.from(o),t.url=K_(Q_(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let p;if(Te.isFormData(n)){if(hr.hasStandardBrowserEnv||hr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((p=o.getContentType())!==!1){const[h,...g]=p?p.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...g].join("; "))}}if(hr.hasStandardBrowserEnv&&(r&&Te.isFunction(r)&&(r=r(t)),r||r!==!1&&YC(t.url))){const h=i&&a&&eE.read(a);h&&o.set(i,h)}return t},rE=typeof XMLHttpRequest<"u",iE=rE&&function(e){return new Promise(function(n,r){const i=Y_(e);let a=i.data;const o=Ii.from(i.headers).normalize();let{responseType:u,onUploadProgress:p,onDownloadProgress:h}=i,g,f,_,w,C;function R(){w&&w(),C&&C(),i.cancelToken&&i.cancelToken.unsubscribe(g),i.signal&&i.signal.removeEventListener("abort",g)}let S=new XMLHttpRequest;S.open(i.method.toUpperCase(),i.url,!0),S.timeout=i.timeout;function b(){if(!S)return;const E=Ii.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),Z={data:!u||u==="text"||u==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:E,config:e,request:S};X_(function(z){n(z),R()},function(z){r(z),R()},Z),S=null}"onloadend"in S?S.onloadend=b:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(b)},S.onabort=function(){S&&(r(new Ft("Request aborted",Ft.ECONNABORTED,e,S)),S=null)},S.onerror=function(){r(new Ft("Network Error",Ft.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let M=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const Z=i.transitional||$_;i.timeoutErrorMessage&&(M=i.timeoutErrorMessage),r(new Ft(M,Z.clarifyTimeoutError?Ft.ETIMEDOUT:Ft.ECONNABORTED,e,S)),S=null},a===void 0&&o.setContentType(null),"setRequestHeader"in S&&Te.forEach(o.toJSON(),function(M,Z){S.setRequestHeader(Z,M)}),Te.isUndefined(i.withCredentials)||(S.withCredentials=!!i.withCredentials),u&&u!=="json"&&(S.responseType=i.responseType),h&&([_,C]=xd(h,!0),S.addEventListener("progress",_)),p&&S.upload&&([f,w]=xd(p),S.upload.addEventListener("progress",f),S.upload.addEventListener("loadend",w)),(i.cancelToken||i.signal)&&(g=E=>{S&&(r(!E||E.type?new Al(null,e,S):E),S.abort(),S=null)},i.cancelToken&&i.cancelToken.subscribe(g),i.signal&&(i.signal.aborted?g():i.signal.addEventListener("abort",g)));const x=GC(i.url);if(x&&hr.protocols.indexOf(x)===-1){r(new Ft("Unsupported protocol "+x+":",Ft.ERR_BAD_REQUEST,e));return}S.send(a||null)})};Y();Y();var sE=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const a=function(h){if(!i){i=!0,u();const g=h instanceof Error?h:this.reason;r.abort(g instanceof Ft?g:new Al(g instanceof Error?g.message:g))}};let o=t&&setTimeout(()=>{o=null,a(new Ft(`timeout ${t} of ms exceeded`,Ft.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(a):h.removeEventListener("abort",a)}),e=null)};e.forEach(h=>h.addEventListener("abort",a));const{signal:p}=r;return p.unsubscribe=()=>Te.asap(u),p}},aE=sE;Y();var oE=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},cE=function(e,t){return o_(this,null,function*(){try{for(var n=F4(lE(e)),r,i,a;r=!(i=yield new Do(n.next())).done;r=!1){const o=i.value;yield*c_(oE(o,t))}}catch(o){a=[o]}finally{try{r&&(i=n.return)&&(yield new Do(i.call(n)))}finally{if(a)throw a[0]}}})},lE=function(e){return o_(this,null,function*(){if(e[Symbol.asyncIterator]){yield*c_(e);return}const t=e.getReader();try{for(;;){const{done:n,value:r}=yield new Do(t.read());if(n)break;yield r}}finally{yield new Do(t.cancel())}})},n1=(e,t,n,r)=>{const i=cE(e,t);let a=0,o,u=p=>{o||(o=!0,r&&r(p))};return new ReadableStream({pull(p){return H(this,null,function*(){try{const{done:h,value:g}=yield i.next();if(h){u(),p.close();return}let f=g.byteLength;if(n){let _=a+=f;n(_)}p.enqueue(new Uint8Array(g))}catch(h){throw u(h),h}})},cancel(p){return u(p),i.return()}},{highWaterMark:2})},mh=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",eb=mh&&typeof ReadableStream=="function",uE=mh&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):e=>H(null,null,function*(){return new Uint8Array(yield new Response(e).arrayBuffer())})),tb=(e,...t)=>{try{return!!e(...t)}catch{return!1}},dE=eb&&tb(()=>{let e=!1;const t=new Request(hr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),r1=64*1024,jf=eb&&tb(()=>Te.isReadableStream(new Response("").body)),Cd={stream:jf&&(e=>e.body)};mh&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Cd[t]&&(Cd[t]=Te.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Ft(`Response type '${t}' is not supported`,Ft.ERR_NOT_SUPPORT,r)})})})(new Response);var hE=e=>H(null,null,function*(){if(e==null)return 0;if(Te.isBlob(e))return e.size;if(Te.isSpecCompliantForm(e))return(yield new Request(hr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Te.isArrayBufferView(e)||Te.isArrayBuffer(e))return e.byteLength;if(Te.isURLSearchParams(e)&&(e=e+""),Te.isString(e))return(yield uE(e)).byteLength}),pE=(e,t)=>H(null,null,function*(){const n=Te.toFiniteNumber(e.getContentLength());return n??hE(t)}),fE=mh&&(e=>H(null,null,function*(){let{url:t,method:n,data:r,signal:i,cancelToken:a,timeout:o,onDownloadProgress:u,onUploadProgress:p,responseType:h,headers:g,withCredentials:f="same-origin",fetchOptions:_}=Y_(e);h=h?(h+"").toLowerCase():"text";let w=aE([i,a&&a.toAbortSignal()],o),C;const R=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let S;try{if(p&&dE&&n!=="get"&&n!=="head"&&(S=yield pE(g,r))!==0){let Z=new Request(t,{method:"POST",body:r,duplex:"half"}),$;if(Te.isFormData(r)&&($=Z.headers.get("content-type"))&&g.setContentType($),Z.body){const[z,q]=Yv(S,xd(e1(p)));r=n1(Z.body,r1,z,q)}}Te.isString(f)||(f=f?"include":"omit");const b="credentials"in Request.prototype;C=new Request(t,Se(ie({},_),{signal:w,method:n.toUpperCase(),headers:g.normalize().toJSON(),body:r,duplex:"half",credentials:b?f:void 0}));let x=yield fetch(C,_);const E=jf&&(h==="stream"||h==="response");if(jf&&(u||E&&R)){const Z={};["status","statusText","headers"].forEach(Q=>{Z[Q]=x[Q]});const $=Te.toFiniteNumber(x.headers.get("content-length")),[z,q]=u&&Yv($,xd(e1(u),!0))||[];x=new Response(n1(x.body,r1,z,()=>{q&&q(),R&&R()}),Z)}h=h||"text";let M=yield Cd[Te.findKey(Cd,h)||"text"](x,e);return!E&&R&&R(),yield new Promise((Z,$)=>{X_(Z,$,{data:M,headers:Ii.from(x.headers),status:x.status,statusText:x.statusText,config:e,request:C})})}catch(b){throw R&&R(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new Ft("Network Error",Ft.ERR_NETWORK,e,C),{cause:b.cause||b}):Ft.from(b,b&&b.code,e,C)}})),Bf={http:CC,xhr:iE,fetch:fE};Te.forEach(Bf,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});var i1=e=>`- ${e}`,mE=e=>Te.isFunction(e)||e===null||e===!1,nb={getAdapter:e=>{e=Te.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let a=0;a<t;a++){n=e[a];let o;if(r=n,!mE(n)&&(r=Bf[(o=String(n)).toLowerCase()],r===void 0))throw new Ft(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+a]=r}if(!r){const a=Object.entries(i).map(([u,p])=>`adapter ${u} `+(p===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(i1).join(`
`):" "+i1(a[0]):"as no adapter specified";throw new Ft("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Bf};function Cp(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Al(null,e)}function s1(e){return Cp(e),e.headers=Ii.from(e.headers),e.data=xp.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),nb.getAdapter(e.adapter||lg.adapter)(e).then(function(r){return Cp(e),r.data=xp.call(e,e.transformResponse,r),r.headers=Ii.from(r.headers),r},function(r){return J_(r)||(Cp(e),r&&r.response&&(r.response.data=xp.call(e,e.transformResponse,r.response),r.response.headers=Ii.from(r.response.headers))),Promise.reject(r)})}Y();Y();var rb="1.10.0",gh={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{gh[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});var a1={};gh.transitional=function(t,n,r){function i(a,o){return"[Axios v"+rb+"] Transitional option '"+a+"'"+o+(r?". "+r:"")}return(a,o,u)=>{if(t===!1)throw new Ft(i(o," has been removed"+(n?" in "+n:"")),Ft.ERR_DEPRECATED);return n&&!a1[o]&&(a1[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,o,u):!0}};gh.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function gE(e,t,n){if(typeof e!="object")throw new Ft("options must be an object",Ft.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const a=r[i],o=t[a];if(o){const u=e[a],p=u===void 0||o(u,a,e);if(p!==!0)throw new Ft("option "+a+" must be "+p,Ft.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ft("Unknown option "+a,Ft.ERR_BAD_OPTION)}}var Ku={assertOptions:gE,validators:gh},Wi=Ku.validators,Ed=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Xv,response:new Xv}}request(e,t){return H(this,null,function*(){try{return yield this._request(e,t)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}})}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Va(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;n!==void 0&&Ku.assertOptions(n,{silentJSONParsing:Wi.transitional(Wi.boolean),forcedJSONParsing:Wi.transitional(Wi.boolean),clarifyTimeoutError:Wi.transitional(Wi.boolean)},!1),r!=null&&(Te.isFunction(r)?t.paramsSerializer={serialize:r}:Ku.assertOptions(r,{encode:Wi.function,serialize:Wi.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ku.assertOptions(t,{baseUrl:Wi.spelling("baseURL"),withXsrfToken:Wi.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&Te.merge(i.common,i[t.method]);i&&Te.forEach(["delete","get","head","post","put","patch","common"],w=>{delete i[w]}),t.headers=Ii.concat(a,i);const o=[];let u=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(t)===!1||(u=u&&C.synchronous,o.unshift(C.fulfilled,C.rejected))});const p=[];this.interceptors.response.forEach(function(C){p.push(C.fulfilled,C.rejected)});let h,g=0,f;if(!u){const w=[s1.bind(this),void 0];for(w.unshift.apply(w,o),w.push.apply(w,p),f=w.length,h=Promise.resolve(t);g<f;)h=h.then(w[g++],w[g++]);return h}f=o.length;let _=t;for(g=0;g<f;){const w=o[g++],C=o[g++];try{_=w(_)}catch(R){C.call(this,R);break}}try{h=s1.call(this,_)}catch(w){return Promise.reject(w)}for(g=0,f=p.length;g<f;)h=h.then(p[g++],p[g++]);return h}getUri(e){e=Va(this.defaults,e);const t=Q_(e.baseURL,e.url,e.allowAbsoluteUrls);return K_(t,e.params,e.paramsSerializer)}};Te.forEach(["delete","get","head","options"],function(t){Ed.prototype[t]=function(n,r){return this.request(Va(r||{},{method:t,url:n,data:(r||{}).data}))}});Te.forEach(["post","put","patch"],function(t){function n(r){return function(a,o,u){return this.request(Va(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}Ed.prototype[t]=n(),Ed.prototype[t+"Form"]=n(!0)});var $u=Ed;Y();var vE=class ib{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const r=this;this.promise.then(i=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](i);r._listeners=null}),this.promise.then=i=>{let a;const o=new Promise(u=>{r.subscribe(u),a=u}).then(i);return o.cancel=function(){r.unsubscribe(a)},o},t(function(a,o,u){r.reason||(r.reason=new Al(a,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new ib(function(i){t=i}),cancel:t}}},yE=vE;Y();function _E(e){return function(n){return e.apply(null,n)}}Y();function bE(e){return Te.isObject(e)&&e.isAxiosError===!0}Y();var Uf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Uf).forEach(([e,t])=>{Uf[t]=e});var SE=Uf;function sb(e){const t=new $u(e),n=I_($u.prototype.request,t);return Te.extend(n,$u.prototype,t,{allOwnKeys:!0}),Te.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return sb(Va(e,i))},n}var Bn=sb(lg);Bn.Axios=$u;Bn.CanceledError=Al;Bn.CancelToken=yE;Bn.isCancel=J_;Bn.VERSION=rb;Bn.toFormData=ph;Bn.AxiosError=Ft;Bn.Cancel=Bn.CanceledError;Bn.all=function(t){return Promise.all(t)};Bn.spread=_E;Bn.isAxiosError=bE;Bn.mergeConfig=Va;Bn.AxiosHeaders=Ii;Bn.formToJSON=e=>G_(Te.isHTMLForm(e)?new FormData(e):e);Bn.getAdapter=nb.getAdapter;Bn.HttpStatusCode=SE;Bn.default=Bn;var eo=Bn,{Axios:RT,AxiosError:AT,CanceledError:IT,isCancel:FT,CancelToken:DT,VERSION:NT,all:OT,Cancel:MT,isAxiosError:LT,spread:jT,toFormData:BT,AxiosHeaders:UT,HttpStatusCode:HT,formToJSON:VT,getAdapter:qT,mergeConfig:zT}=eo,_i=new ze("packages/common/src/http.ts"),ug=class{constructor(e){this.api=eo.create({baseURL:e})}get(e,t){return H(this,null,function*(){const n=yield this.api.get(e,t).catch(r=>r);if(eo.isAxiosError(n)){const r=Se(ie({},n.response),{message:n.message});if(t!=null&&t.retry){if(yield t.retry(r))return _i.warn("retry get",{url:e}),this.get(e,t);throw _i.warn("retry get failed",{url:e}),r}throw _i.warn("response error",{error:r}),r}else return n.data})}post(e,t,n){return H(this,null,function*(){var r,i,a;const o=yield this.api.post(e,t,n).catch(u=>u);if(eo.isAxiosError(o)){const u={data:(r=o.response)==null?void 0:r.data,status:(i=o.response)==null?void 0:i.status,statusText:(a=o.response)==null?void 0:a.statusText,message:o.message};if(_i.warn("error received",u),n!=null&&n.retry){const p=yield n.retry(u);if(p)return _i.warn("retry post",e,{data:t,error:u,needRetry:p}),this.post(e,t,n);throw u}throw u}else return o.data})}put(e,t,n){return H(this,null,function*(){const r=yield this.api.put(e,t,n).catch(i=>i);if(eo.isAxiosError(r)){const i=Se(ie({},r.response),{message:r.message});if(n!=null&&n.retry){if(yield n.retry(i))return _i.warn("retry put",{url:e,data:t}),this.put(e,t,n);throw _i.warn("retry put failed",{url:e,data:t}),i}throw _i.warn("response error",{error:i}),i}else return r.data})}delete(e,t){return H(this,null,function*(){const n=yield this.api.delete(e,t).catch(r=>r);if(eo.isAxiosError(n)){const r=Se(ie({},n.response),{message:n.message});if(t!=null&&t.retry){if(yield t.retry(r))return _i.warn("retry delete",{url:e}),this.delete(e,t);throw _i.warn("retry delete failed",{url:e}),r}throw _i.warn("response error",{error:r}),r}else return n.data})}};Y();var wE=new ze("packages/common/src/promise.ts"),ua=class{constructor(){this.id=Math.random().toString().slice(2),this.queue=[],this.running=!1,this.push=e=>new Promise((t,n)=>{this.queue.push({promise:e,done:t,failed:n}),this.running||this.run().catch(r=>{wE.error("push",r)})})}run(){return H(this,null,function*(){const e=this.queue.shift();if(e){this.running=!0;try{const t=yield e.promise();e.done(t)}catch(t){e.failed(t)}yield this.run()}else this.running=!1})}};Y();var ki=class{constructor(e={}){this.count=0,this.times=8,this.interval=100,this.jitter=0,Object.assign(this,e)}wait(){return H(this,null,function*(){if(this.exceeded)return!1;const e=this.timeout;return this.count++,yield new Promise(t=>setTimeout(t,e)),!0})}get timeout(){return ws(this.count,2)*this.interval+ws(this.count,2)*this.jitter*Math.random()}get exceeded(){return this.count>=this.times}reset(){this.count=0}},xE=e=>JSON.parse(JSON.stringify(e));Y();var Ue={internal:{name:"internal",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},missingProperty:{name:"missingProperty",detail:"",solution:""},notFound:{name:"notFound",detail:"",solution:""},invalidParameter:{name:"invalidParameter",detail:"",solution:""},invalidArgumentValue:{name:"invalidArgumentValue",detail:"引数の値が不正です",solution:"正しい値を引数に渡してください"},invalidContentType:{name:"invalidContentType",detail:"contentTypeが正しくありません",solution:"ContentTypeを確認してください"},localPersonNotJoinedChannel:{name:"localPersonNotJoinedChannel",detail:"操作しようとしたPersonがChannelに居ないので、操作できません The person who tried to operate is not in the channel, so the operation is not possible",solution:"Channelに居ないPersonを操作している可能性があるので確認してください Please check as you may be operating a person which is not in the channel"},alreadyLocalPersonExist:{name:"alreadyLocalPersonExist",detail:"ChannelにすでにLocalPersonが存在します。一つのChannelインスタンスにはLocalPersonが一つしかJoinできません",solution:"複数のLocalPersonを用意したい場合は個別にChannelインスタンスを用意してください。"},alreadySameNameMemberExist:{name:"alreadySameNameMemberExist",detail:"Channelにすでに同じNameのMemberが存在します",solution:"別のNameを使用してください"},alreadyPublishedStream:{name:"alreadyPublishedStream",detail:"すでにPublishしたStreamを再度Publishすることはできません You cannot re-publish a stream that has already been published",solution:"そのStreamをPublishしたPublicationをUnpublishするか、別の新しいStreamを作ってPublishしてください Unpublish the publication that published that stream, or create another new stream and publish it"},alreadySubscribedPublication:{name:"alreadySubscribedPublication",detail:"すでにSubscribeしたPublicationをSubscribeすることはできません",solution:"ありません"},invalidTrackKind:{name:"invalidTrackKind",detail:"Streamの種類とMediaStreamTrackの種類が一致しません",solution:"Streamの種類と同じMediaStreamTrackを利用してください"},cantMoveSameIdChannel:{name:"cantMoveSameIdChannel",detail:"moveChannelで同じidのChannelに移動することは出来ません",solution:"移動先のChannelが正しいか確かめてください"},alreadyChannelClosed:{name:"alreadyChannelClosed",detail:"ChannelがすでにCloseされています",solution:"ありません"},disabledDataStream:{name:"disabledDataStream",detail:"関連するPublicationがDisableなDataStreamには書き込みできません",solution:"関連するPublicationをEnableしてから書き込んでください"},publicationNotExist:{name:"publicationNotExist",detail:"channelに該当するPublicationが存在しません",solution:"publicationIdが正しいか確かめてください"},subscriptionNotExist:{name:"subscriptionNotExist",detail:"channelに該当するSubscriptionが存在しません",solution:"subscriptionIdが正しいか確かめてください"},unknownMemberType:{name:"unknownMemberType",detail:"対象のMemberのSubtypeのプラグインが登録されていません",solution:"対象のMemberのSubtypeのプラグイン(SfuBotなど)をSkyWayContextに登録してください"},streamNotExistInSubscription:{name:"streamNotExistInSubscription",detail:"SubscriptionにStreamがありません。RemoteMemberのSubscriptionのStreamにはアクセスできません",solution:"参照しているSubscriptionが目的のものか確かめてください。"},streamNotExistInPublication:{name:"streamNotExistInPublication",detail:"PublicationにStreamがありません。RemoteMemberのPublicationのStreamにはアクセスできません",solution:"参照しているPublicationが目的のものか確かめてください。"},dataStreamNotSupportEncoding:{name:"dataStreamNotSupportEncoding",detail:"dataStreamはEncode設定の変更に対応していません",solution:"ありません"},correspondingEncodeNotExistForId:{name:"correspondingEncodeNotExistForId",detail:"指定されたIDに対応するEncode設定が存在しません",solution:"正しいEncodingIDを指定してください"},updateIceParamsFailed:{name:"updateIceParamsFailed",detail:"iceParamsの更新に失敗しました",solution:"ありません"},invalidElement:{name:"invalidElement",detail:"渡されたHTML Elementが正しくありません",solution:"要求された正しいElementを渡してください"},connectRtcApiFailed:{name:"connectRtcApiFailed",detail:"RtcAPIへの接続に失敗しました",solution:"インターネットへ接続できているか、もしくはTokenのパラメータが正しいかを確かめてください"},rtcApiFatalError:{name:"rtcApiFatalError",detail:"RtcAPIの回復不能なエラーです。サーバー側の問題の可能性があります",solution:"インターネットへの接続が出来ているかを確かめてください"},invalidExpireTokenValue:{name:"invalidExpireTokenValue",detail:"tokenのExpire時刻が不正です",solution:"正しい時刻を指定してください"},invalidRemindExpireTokenValue:{name:"invalidRemindExpireTokenValue",detail:"tokenのExpireをリマインドする時間の値が不正です",solution:"正しい時間を指定してください"},invalidTokenAppId:{name:"invalidTokenAppId",detail:"tokenのappIdが正しくありません",solution:"正しいappIdを含むTokenを使用してください"},mediaDevicesNotFound:{name:"mediaDevicesNotFound",detail:"navigator.mediaDevicesがみつかりません",solution:"アプリケーションをhttps,localhost,127.0.0.1のいずれかの環境で動作させてください"},canNotUseReplaceStream:{name:"canNotUseReplaceStream",detail:"remoteのPublicationからreplaceStreamできません",solution:"対象のPublicationがLocalのものか確認してください"},canNotEnableRemotePublication:{name:"canNotEnableRemotePublication",detail:"remoteのPublicationをenableすることはできません",solution:"対象のPublicationがLocalのものか確認してください"}};Y();Y();Y();var CE=qr(D4());qr(Oi());var EE=qr(l_()),PE=new ze("packages/core/src/util.ts");function Oo(e){const t=[];return e.forEach(n=>{t.push(n)}),t}function Ct(e){return H(this,arguments,function*({operationName:t,channel:n}){const r={operationName:t,appId:n.appId,channelId:n.id};if(n.localPerson){const i=n.localPerson,a=yield Promise.all(i.publications.map(u=>H(null,null,function*(){var p,h,g;const f={id:u.id,contentType:u.contentType,state:u.state,stats:{},connectionStats:{}};if(u.stream)for(const{memberId:_,stats:w}of yield u.stream._getStatsAll()){const C=w.find(R=>R.type.includes("local-candidate"));f.stats[_]={transportType:(p=C==null?void 0:C.protocol)!=null?p:"none",relayProtocol:(h=C==null?void 0:C.relayProtocol)!=null?h:"none",callType:(g=u.subscriptions.find(R=>R.subscriber.id===_))==null?void 0:g.subscriber.subtype,outbound:w.find(R=>R.type.includes("outbound-rtp")),localCandidate:C}}if(u.stream)for(const{memberId:_,connectionState:w}of u.stream._getConnectionStateAll())f.connectionStats[_]=w;return f})));r.publishing=a;const o=yield Promise.all(i.subscriptions.map(u=>H(null,null,function*(){const p={id:u.id,contentType:u.contentType,stats:{}};if(p.callType=u.publication.publisher.subtype,u.stream){const h=yield u.stream.getStats();p.stats=h.find(f=>f.type.includes("inbound-rtp"));const g=h.find(f=>f.type.includes("local-candidate"));p.transportType=g==null?void 0:g.protocol,p.relayProtocol=g==null?void 0:g.relayProtocol}return u.stream&&(p.connectionState=u.stream.getConnectionState()),p})));r.subscribing=o}return r})}function Ln({member:e,detail:t,channel:n,operationName:r,payload:i}){const a={operationName:r,payload:i,detail:t};return e&&(a.appId=e.channel.appId,a.channelId=e.channel.id,a.memberId=e.id),n&&(a.appId=n.appId,a.channelId=n.id),a}function De({operationName:e,context:t,info:n,error:r,path:i,payload:a,channel:o}){const u={operationName:e,payload:a};return o&&(u.appId=o.appId,u.channelId=o.id,o.localPerson&&(u.memberId=o.localPerson.id)),t&&(u.info=t.info,u.plugins=t.plugins.map(p=>p.subtype)),new wr({error:r,info:n,payload:u,path:i})}var o1=e=>H(null,[e],function*({stream:t,remoteMember:n,end:r,interval:i,timeout:a}){return new Promise((o,u)=>H(null,null,function*(){i??(i=100),a??(a=1e4);for(let p=0;;p+=i){if(p>=a){u(De({operationName:"Peer.waitForStats",info:Se(ie({},Ue.timeout),{detail:"waitForStats timeout"}),path:PE.prefix}));break}const h=yield t._getStats(n);if(r(h)){o(h);break}yield new Promise(g=>setTimeout(g,i))}}))}),kE=(e,t)=>{var n,r;return ab((r=(n=e.find(i=>i.payload===t))==null?void 0:n.config)!=null?r:"")},ab=e=>e.split(";").reduce((n,r)=>{const[i,a]=r.split("=");return i&&(n[i]=isNaN(Number(a))?a:Number(a)),n},{}),ob=({isNotBrowser:e}={})=>{if(e)return e;const t=CE.default.getParser(window.navigator.userAgent),n=t.getOSName(),r=t.getOSVersion(),i=t.getBrowserName(),a=t.getBrowserVersion();return{browserName:i,browserVersion:a,osName:n,osVersion:r}};function c1(){var e,t,n,r,i,a,o,u;if(typeof navigator=="object"&&navigator.product==="ReactNative")return typeof RTCPeerConnection>"u"?void 0:typeof RTCRtpTransceiver<"u"?"ReactNativeUnifiedPlan":"ReactNative";if(typeof navigator=="object"&&typeof navigator.userAgent=="string"){const p=navigator.userAgent,h=new EE.UAParser(p),g=h.getBrowser(),f=(t=(e=g.name)==null?void 0:e.toLowerCase())!=null?t:"",_=parseInt((n=g.major)!=null?n:"0"),C=(i=(r=h.getEngine().name)==null?void 0:r.toLowerCase())!=null?i:"",R=h.getOS(),S=(o=(a=R.name)==null?void 0:a.toLowerCase())!=null?o:"",b=parseFloat((u=R.version)!=null?u:"0"),x=S==="ios",E=["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(f),M=["firefox","mobile firefox","mobile focus"].includes(f),Z=["safari","mobile safari"].includes(f),$=["edge"].includes(f);if((E||$)&&!x&&_>=111)return"Chrome111";if(E&&!x&&_>=74||$&&!x&&_>=88)return"Chrome74";if(E&&!x&&_>=70)return"Chrome70";if(E&&!x&&_>=67)return"Chrome67";if(E&&!x&&_>=55)return"Chrome55";if(M&&!x&&_>=60)return"Firefox60";if(M&&x&&b>=14.3)return"Safari12";if(Z&&_>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(Z&&_>=11)return"Safari11";if($&&!x&&_>=11&&_<=18)return"Edge11";if(C==="webkit"&&x&&b>=14.3&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(C==="blink"){const z=p.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(z){const q=Number(z[1]);return q>=111?"Chrome111":q>=74?"Chrome74":q>=70?"Chrome70":q>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else return}else return}var Ep=new ze("packages/core/src/member/index.ts"),vh=class{constructor(e){this._state="joined",this._events=new ts,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.channel=e.channel,this.id=e.id,this.name=e.name,this._metadata=e.metadata,this.context=e.context}get metadata(){return this._metadata}get state(){return this._state}get publications(){return this.channel.publications.filter(e=>e.publisher.id===this.id)}get subscriptions(){return this.channel.subscriptions.filter(e=>e.subscriber.id===this.id)}toJSON(){return{id:this.id,name:this.name,type:this.type,subtype:this.subtype,metadata:this.metadata}}_left(){this._state="left",this.onLeft.emit(),this._events.dispose()}_metadataUpdated(e){this._metadata=e,this.onMetadataUpdated.emit(e)}updateMetadata(e){return H(this,null,function*(){yield this.channel._updateMemberMetadata(this.id,e)})}leave(){return H(this,null,function*(){const e=Ep.info("[start] leave",yield Ct({operationName:"localPerson.leave",channel:this.channel}));if(this.state==="left")throw De({operationName:"localPerson.leave",info:Ue.localPersonNotJoinedChannel,path:Ep.prefix,context:this.context,channel:this.channel});yield this.channel.leave(this),Ep.elapsed(e,"[end] leave")})}};Y();Y();var gu=new ze("packages/core/src/plugin/internal/unknown/connection.ts"),TE=class{constructor(e,t){this.localPerson=e,this.remoteMember=t,this.type="unknown",this.onDisconnect=new We,this.onClose=new We,this.closed=!1}close(){this.closed=!0,this.onClose.emit()}startPublishing(e){return H(this,null,function*(){gu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{publication:e})})}stopPublishing(e){return H(this,null,function*(){gu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{publication:e})})}startSubscribing(e){return H(this,null,function*(){gu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{subscription:e})})}stopSubscribing(e){return H(this,null,function*(){gu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{subscription:e})})}},cb=class extends vh{constructor(e){super(e),this.type="bot",this.side="remote",this._connections={},this.plugin=e.plugin,this.subtype=e.subtype}_getConnection(e){return this._connections[e]}_getOrCreateConnection(e){var t;return(t=this._getConnection(e.id))!=null?t:this._createConnection(e,this)}_createConnection(e,t){return new TE(e,t)}_dispose(){}};Y();Y();Y();Y();Y();Y();var lb=new ze("packages/core/src/media/stream/base.ts");function ub(e,t){var n;if(((n=e??{})==null?void 0:n.srcObject)===void 0)throw De({operationName:"attachElement",info:Ue.invalidElement,payload:{element:e},path:lb.prefix});if(e.srcObject){const r=e.srcObject,i=r.getTracks().find(o=>o.readyState==="ended");i&&r.removeTrack(i);const a=r.getTracks().find(o=>o.kind===t.kind);a&&r.removeTrack(a),r.addTrack(t)}else e.srcObject=new MediaStream([t])}function db(e,t){var n;if(((n=e??{})==null?void 0:n.srcObject)===void 0)throw De({operationName:"attachElement",info:Ue.invalidElement,payload:{element:e},path:lb.prefix});const r=e.srcObject;r.getTracks().length>0&&r.removeTrack(t),r.getTracks().length===0&&(e.srcObject=null)}Y();Y();Y();Y();var vu,RE=new Uint8Array(16);function AE(){if(!vu&&(vu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!vu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vu(RE)}Y();Y();Y();var IE=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function FE(e){return typeof e=="string"&&IE.test(e)}var DE=FE,er=[];for(let e=0;e<256;++e)er.push((e+256).toString(16).slice(1));function NE(e,t=0){return er[e[t+0]]+er[e[t+1]]+er[e[t+2]]+er[e[t+3]]+"-"+er[e[t+4]]+er[e[t+5]]+"-"+er[e[t+6]]+er[e[t+7]]+"-"+er[e[t+8]]+er[e[t+9]]+"-"+er[e[t+10]]+er[e[t+11]]+er[e[t+12]]+er[e[t+13]]+er[e[t+14]]+er[e[t+15]]}Y();Y();var OE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),l1={randomUUID:OE};function ME(e,t,n){if(l1.randomUUID&&!t&&!e)return l1.randomUUID();e=e||{};const r=e.random||(e.rng||AE)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return NE(r)}var ji=ME;Y();var LE=qr(M4());Y();function Hf(e){this.message=e}Hf.prototype=new Error,Hf.prototype.name="InvalidCharacterError";var u1=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new Hf("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,a=0,o="";r=t.charAt(a++);~r&&(n=i%4?64*n+r:r,i++%4)?o+=String.fromCharCode(255&n>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o};function jE(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(n){return decodeURIComponent(u1(n).replace(/(.)/g,function(r,i){var a=i.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}(t)}catch{return u1(t)}}function Pd(e){this.message=e}function BE(e,t){if(typeof e!="string")throw new Pd("Invalid token specified");var n=(t=t||{}).header===!0?0:1;try{return JSON.parse(jE(e.split(".")[n]))}catch(r){throw new Pd("Invalid token specified: "+r.message)}}Pd.prototype=new Error,Pd.prototype.name="InvalidTokenError";var UE=BE;Y();Y();var Ve={};s_(Ve,{BRAND:()=>h5,DIRTY:()=>mo,EMPTY_PATH:()=>zE,INVALID:()=>at,NEVER:()=>J5,OK:()=>Pr,ParseStatus:()=>Vr,Schema:()=>Pt,ZodAny:()=>jo,ZodArray:()=>za,ZodBigInt:()=>ol,ZodBoolean:()=>cl,ZodBranded:()=>dg,ZodCatch:()=>yl,ZodDate:()=>ll,ZodDefault:()=>vl,ZodDiscriminatedUnion:()=>_b,ZodEffects:()=>Ni,ZodEnum:()=>Il,ZodError:()=>Fi,ZodFirstPartyTypeKind:()=>lt,ZodFunction:()=>xb,ZodIntersection:()=>pl,ZodIssueCode:()=>Le,ZodLazy:()=>fl,ZodLiteral:()=>ml,ZodMap:()=>Id,ZodNaN:()=>Dd,ZodNativeEnum:()=>gl,ZodNever:()=>xs,ZodNull:()=>dl,ZodNullable:()=>ia,ZodNumber:()=>al,ZodObject:()=>fi,ZodOptional:()=>Yi,ZodParsedType:()=>$e,ZodPipeline:()=>hg,ZodPromise:()=>Bo,ZodReadonly:()=>_l,ZodRecord:()=>wb,ZodSchema:()=>Pt,ZodSet:()=>Fd,ZodString:()=>Lo,ZodSymbol:()=>Rd,ZodTransformer:()=>Ni,ZodTuple:()=>ra,ZodType:()=>Pt,ZodUndefined:()=>ul,ZodUnion:()=>hl,ZodUnknown:()=>Oa,ZodVoid:()=>Ad,addIssueToContext:()=>qe,any:()=>S5,array:()=>E5,bigint:()=>g5,boolean:()=>Rb,coerce:()=>G5,custom:()=>Pb,date:()=>v5,datetimeRegex:()=>vb,defaultErrorMap:()=>Mo,discriminatedUnion:()=>R5,effect:()=>p1,enum:()=>j5,function:()=>O5,getErrorMap:()=>kd,getParsedType:()=>fs,instanceof:()=>f5,intersection:()=>A5,isAborted:()=>qf,isAsync:()=>sl,isDirty:()=>zf,isValid:()=>qa,late:()=>p5,lazy:()=>M5,literal:()=>L5,makeIssue:()=>Td,map:()=>D5,nan:()=>m5,nativeEnum:()=>B5,never:()=>x5,null:()=>b5,nullable:()=>V5,number:()=>Tb,object:()=>P5,objectUtil:()=>Vf,oboolean:()=>W5,onumber:()=>$5,optional:()=>H5,ostring:()=>K5,pipeline:()=>z5,preprocess:()=>q5,promise:()=>U5,quotelessJson:()=>HE,record:()=>F5,set:()=>N5,setErrorMap:()=>qE,strictObject:()=>k5,string:()=>kb,symbol:()=>y5,transformer:()=>p1,tuple:()=>I5,undefined:()=>_5,union:()=>T5,unknown:()=>w5,util:()=>Ht,void:()=>C5});Y();Y();Y();Y();Y();var Ht;(function(e){e.assertEqual=i=>{};function t(i){}e.assertIs=t;function n(i){throw new Error}e.assertNever=n,e.arrayToEnum=i=>{const a={};for(const o of i)a[o]=o;return a},e.getValidEnumValues=i=>{const a=e.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),o={};for(const u of a)o[u]=i[u];return e.objectValues(o)},e.objectValues=i=>e.objectKeys(i).map(function(a){return i[a]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&a.push(o);return a},e.find=(i,a)=>{for(const o of i)if(a(o))return o},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,a=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(Ht||(Ht={}));var Vf;(function(e){e.mergeShapes=(t,n)=>ie(ie({},t),n)})(Vf||(Vf={}));var $e=Ht.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),fs=e=>{switch(typeof e){case"undefined":return $e.undefined;case"string":return $e.string;case"number":return Number.isNaN(e)?$e.nan:$e.number;case"boolean":return $e.boolean;case"function":return $e.function;case"bigint":return $e.bigint;case"symbol":return $e.symbol;case"object":return Array.isArray(e)?$e.array:e===null?$e.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?$e.promise:typeof Map<"u"&&e instanceof Map?$e.map:typeof Set<"u"&&e instanceof Set?$e.set:typeof Date<"u"&&e instanceof Date?$e.date:$e.object;default:return $e.unknown}},Le=Ht.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),HE=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),Fi=class hb extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},r={_errors:[]},i=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let u=r,p=0;for(;p<o.path.length;){const h=o.path[p];p===o.path.length-1?(u[h]=u[h]||{_errors:[]},u[h]._errors.push(n(o))):u[h]=u[h]||{_errors:[]},u=u[h],p++}}};return i(this),r}static assert(t){if(!(t instanceof hb))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ht.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):r.push(t(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}};Fi.create=e=>new Fi(e);var VE=(e,t)=>{let n;switch(e.code){case Le.invalid_type:e.received===$e.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Le.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Ht.jsonStringifyReplacer)}`;break;case Le.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ht.joinValues(e.keys,", ")}`;break;case Le.invalid_union:n="Invalid input";break;case Le.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ht.joinValues(e.options)}`;break;case Le.invalid_enum_value:n=`Invalid enum value. Expected ${Ht.joinValues(e.options)}, received '${e.received}'`;break;case Le.invalid_arguments:n="Invalid function arguments";break;case Le.invalid_return_type:n="Invalid function return type";break;case Le.invalid_date:n="Invalid date";break;case Le.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Ht.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Le.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Le.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Le.custom:n="Invalid input";break;case Le.invalid_intersection_types:n="Intersection results could not be merged";break;case Le.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Le.not_finite:n="Number must be finite";break;default:n=t.defaultError,Ht.assertNever(e)}return{message:n}},Mo=VE,pb=Mo;function qE(e){pb=e}function kd(){return pb}Y();var Td=e=>{const{data:t,path:n,errorMaps:r,issueData:i}=e,a=[...n,...i.path||[]],o=Se(ie({},i),{path:a});if(i.message!==void 0)return Se(ie({},i),{path:a,message:i.message});let u="";const p=r.filter(h=>!!h).slice().reverse();for(const h of p)u=h(o,{data:t,defaultError:u}).message;return Se(ie({},i),{path:a,message:u})},zE=[];function qe(e,t){const n=kd(),r=Td({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Mo?void 0:Mo].filter(i=>!!i)});e.common.issues.push(r)}var Vr=class fb{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const i of n){if(i.status==="aborted")return at;i.status==="dirty"&&t.dirty(),r.push(i.value)}return{status:t.value,value:r}}static mergeObjectAsync(t,n){return H(this,null,function*(){const r=[];for(const i of n){const a=yield i.key,o=yield i.value;r.push({key:a,value:o})}return fb.mergeObjectSync(t,r)})}static mergeObjectSync(t,n){const r={};for(const i of n){const{key:a,value:o}=i;if(a.status==="aborted"||o.status==="aborted")return at;a.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[a.value]=o.value)}return{status:t.value,value:r}}},at=Object.freeze({status:"aborted"}),mo=e=>({status:"dirty",value:e}),Pr=e=>({status:"valid",value:e}),qf=e=>e.status==="aborted",zf=e=>e.status==="dirty",qa=e=>e.status==="valid",sl=e=>typeof Promise<"u"&&e instanceof Promise;Y();Y();Y();var et;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(et||(et={}));var es=class{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},d1=(e,t)=>{if(qa(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Fi(e.common.issues);return this._error=n,this._error}}};function St(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(o,u)=>{var p,h;const{message:g}=e;return o.code==="invalid_enum_value"?{message:g??u.defaultError}:typeof u.data>"u"?{message:(p=g??r)!=null?p:u.defaultError}:o.code!=="invalid_type"?{message:u.defaultError}:{message:(h=g??n)!=null?h:u.defaultError}},description:i}}var Pt=class{get description(){return this._def.description}_getType(e){return fs(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:fs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Vr,ctx:{common:e.parent.common,data:e.data,parsedType:fs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(sl(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:(n=t==null?void 0:t.async)!=null?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fs(e)},i=this._parseSync({data:e,path:r.path,parent:r});return d1(r,i)}"~validate"(e){var t,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fs(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:r});return qa(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(n=(t=i==null?void 0:i.message)==null?void 0:t.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>qa(i)?{value:i.value}:{issues:r.common.issues})}parseAsync(e,t){return H(this,null,function*(){const n=yield this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error})}safeParseAsync(e,t){return H(this,null,function*(){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:fs(e)},r=this._parse({data:e,path:n.path,parent:n}),i=yield sl(r)?r:Promise.resolve(r);return d1(n,i)})}refine(e,t){const n=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,i)=>{const a=e(r),o=()=>i.addIssue(ie({code:Le.custom},n(r)));return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new Ni({schema:this,typeName:lt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Yi.create(this,this._def)}nullable(){return ia.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return za.create(this)}promise(){return Bo.create(this,this._def)}or(e){return hl.create([this,e],this._def)}and(e){return pl.create(this,e,this._def)}transform(e){return new Ni(Se(ie({},St(this._def)),{schema:this,typeName:lt.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){const t=typeof e=="function"?e:()=>e;return new vl(Se(ie({},St(this._def)),{innerType:this,defaultValue:t,typeName:lt.ZodDefault}))}brand(){return new dg(ie({typeName:lt.ZodBranded,type:this},St(this._def)))}catch(e){const t=typeof e=="function"?e:()=>e;return new yl(Se(ie({},St(this._def)),{innerType:this,catchValue:t,typeName:lt.ZodCatch}))}describe(e){const t=this.constructor;return new t(Se(ie({},this._def),{description:e}))}pipe(e){return hg.create(this,e)}readonly(){return _l.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},KE=/^c[^\s-]{8,}$/i,$E=/^[0-9a-z]+$/,WE=/^[0-9A-HJKMNP-TV-Z]{26}$/i,GE=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,JE=/^[a-z0-9_-]{21}$/i,ZE=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,XE=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,QE=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,YE="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Pp,e5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,t5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,n5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,r5=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,i5=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,s5=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,mb="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",a5=new RegExp(`^${mb}$`);function gb(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function o5(e){return new RegExp(`^${gb(e)}$`)}function vb(e){let t=`${mb}T${gb(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function c5(e,t){return!!((t==="v4"||!t)&&e5.test(e)||(t==="v6"||!t)&&n5.test(e))}function l5(e,t){if(!ZE.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||t&&i.alg!==t)}catch{return!1}}function u5(e,t){return!!((t==="v4"||!t)&&t5.test(e)||(t==="v6"||!t)&&r5.test(e))}var Lo=class Ac extends Pt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==$e.string){const a=this._getOrReturnCtx(t);return qe(a,{code:Le.invalid_type,expected:$e.string,received:a.parsedType}),at}const r=new Vr;let i;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=t.data.length>a.value,u=t.data.length<a.value;(o||u)&&(i=this._getOrReturnCtx(t,i),o?qe(i,{code:Le.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&qe(i,{code:Le.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")QE.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"email",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Pp||(Pp=new RegExp(YE,"u")),Pp.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"emoji",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")GE.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"uuid",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")JE.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"nanoid",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")KE.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"cuid",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")$E.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"cuid2",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")WE.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"ulid",code:Le.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),qe(i,{validation:"url",code:Le.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"regex",code:Le.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?vb(a).test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?a5.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?o5(a).test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?XE.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"duration",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?c5(t.data,a.version)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"ip",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?l5(t.data,a.alg)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"jwt",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?u5(t.data,a.version)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"cidr",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?i5.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"base64",code:Le.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?s5.test(t.data)||(i=this._getOrReturnCtx(t,i),qe(i,{validation:"base64url",code:Le.invalid_string,message:a.message}),r.dirty()):Ht.assertNever(a);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(i=>t.test(i),ie({validation:n,code:Le.invalid_string},et.errToObj(r)))}_addCheck(t){return new Ac(Se(ie({},this._def),{checks:[...this._def.checks,t]}))}email(t){return this._addCheck(ie({kind:"email"},et.errToObj(t)))}url(t){return this._addCheck(ie({kind:"url"},et.errToObj(t)))}emoji(t){return this._addCheck(ie({kind:"emoji"},et.errToObj(t)))}uuid(t){return this._addCheck(ie({kind:"uuid"},et.errToObj(t)))}nanoid(t){return this._addCheck(ie({kind:"nanoid"},et.errToObj(t)))}cuid(t){return this._addCheck(ie({kind:"cuid"},et.errToObj(t)))}cuid2(t){return this._addCheck(ie({kind:"cuid2"},et.errToObj(t)))}ulid(t){return this._addCheck(ie({kind:"ulid"},et.errToObj(t)))}base64(t){return this._addCheck(ie({kind:"base64"},et.errToObj(t)))}base64url(t){return this._addCheck(ie({kind:"base64url"},et.errToObj(t)))}jwt(t){return this._addCheck(ie({kind:"jwt"},et.errToObj(t)))}ip(t){return this._addCheck(ie({kind:"ip"},et.errToObj(t)))}cidr(t){return this._addCheck(ie({kind:"cidr"},et.errToObj(t)))}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck(ie({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!=null?n:!1,local:(r=t==null?void 0:t.local)!=null?r:!1},et.errToObj(t==null?void 0:t.message)))}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck(ie({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision},et.errToObj(t==null?void 0:t.message)))}duration(t){return this._addCheck(ie({kind:"duration"},et.errToObj(t)))}regex(t,n){return this._addCheck(ie({kind:"regex",regex:t},et.errToObj(n)))}includes(t,n){return this._addCheck(ie({kind:"includes",value:t,position:n==null?void 0:n.position},et.errToObj(n==null?void 0:n.message)))}startsWith(t,n){return this._addCheck(ie({kind:"startsWith",value:t},et.errToObj(n)))}endsWith(t,n){return this._addCheck(ie({kind:"endsWith",value:t},et.errToObj(n)))}min(t,n){return this._addCheck(ie({kind:"min",value:t},et.errToObj(n)))}max(t,n){return this._addCheck(ie({kind:"max",value:t},et.errToObj(n)))}length(t,n){return this._addCheck(ie({kind:"length",value:t},et.errToObj(n)))}nonempty(t){return this.min(1,et.errToObj(t))}trim(){return new Ac(Se(ie({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new Ac(Se(ie({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new Ac(Se(ie({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}};Lo.create=e=>{var t;return new Lo(ie({checks:[],typeName:lt.ZodString,coerce:(t=e==null?void 0:e.coerce)!=null?t:!1},St(e)))};function d5(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r,a=Number.parseInt(e.toFixed(i).replace(".","")),o=Number.parseInt(t.toFixed(i).replace(".",""));return a%o/ws(10,i)}var al=class Kf extends Pt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==$e.number){const a=this._getOrReturnCtx(t);return qe(a,{code:Le.invalid_type,expected:$e.number,received:a.parsedType}),at}let r;const i=new Vr;for(const a of this._def.checks)a.kind==="int"?Ht.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),qe(r,{code:Le.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),qe(r,{code:Le.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),qe(r,{code:Le.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?d5(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),qe(r,{code:Le.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),qe(r,{code:Le.not_finite,message:a.message}),i.dirty()):Ht.assertNever(a);return{status:i.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,et.toString(n))}gt(t,n){return this.setLimit("min",t,!1,et.toString(n))}lte(t,n){return this.setLimit("max",t,!0,et.toString(n))}lt(t,n){return this.setLimit("max",t,!1,et.toString(n))}setLimit(t,n,r,i){return new Kf(Se(ie({},this._def),{checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:et.toString(i)}]}))}_addCheck(t){return new Kf(Se(ie({},this._def),{checks:[...this._def.checks,t]}))}int(t){return this._addCheck({kind:"int",message:et.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:et.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:et.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:et.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:et.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:et.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:et.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:et.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:et.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Ht.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}};al.create=e=>new al(ie({checks:[],typeName:lt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1},St(e)));var ol=class $f extends Pt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==$e.bigint)return this._getInvalidInput(t);let r;const i=new Vr;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),qe(r,{code:Le.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),qe(r,{code:Le.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),qe(r,{code:Le.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):Ht.assertNever(a);return{status:i.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return qe(n,{code:Le.invalid_type,expected:$e.bigint,received:n.parsedType}),at}gte(t,n){return this.setLimit("min",t,!0,et.toString(n))}gt(t,n){return this.setLimit("min",t,!1,et.toString(n))}lte(t,n){return this.setLimit("max",t,!0,et.toString(n))}lt(t,n){return this.setLimit("max",t,!1,et.toString(n))}setLimit(t,n,r,i){return new $f(Se(ie({},this._def),{checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:et.toString(i)}]}))}_addCheck(t){return new $f(Se(ie({},this._def),{checks:[...this._def.checks,t]}))}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:et.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:et.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:et.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:et.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:et.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}};ol.create=e=>{var t;return new ol(ie({checks:[],typeName:lt.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!=null?t:!1},St(e)))};var cl=class extends Pt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==$e.boolean){const n=this._getOrReturnCtx(e);return qe(n,{code:Le.invalid_type,expected:$e.boolean,received:n.parsedType}),at}return Pr(e.data)}};cl.create=e=>new cl(ie({typeName:lt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1},St(e)));var ll=class yb extends Pt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==$e.date){const a=this._getOrReturnCtx(t);return qe(a,{code:Le.invalid_type,expected:$e.date,received:a.parsedType}),at}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return qe(a,{code:Le.invalid_date}),at}const r=new Vr;let i;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(i=this._getOrReturnCtx(t,i),qe(i,{code:Le.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):Ht.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new yb(Se(ie({},this._def),{checks:[...this._def.checks,t]}))}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:et.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:et.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}};ll.create=e=>new ll(ie({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:lt.ZodDate},St(e)));var Rd=class extends Pt{_parse(e){if(this._getType(e)!==$e.symbol){const n=this._getOrReturnCtx(e);return qe(n,{code:Le.invalid_type,expected:$e.symbol,received:n.parsedType}),at}return Pr(e.data)}};Rd.create=e=>new Rd(ie({typeName:lt.ZodSymbol},St(e)));var ul=class extends Pt{_parse(e){if(this._getType(e)!==$e.undefined){const n=this._getOrReturnCtx(e);return qe(n,{code:Le.invalid_type,expected:$e.undefined,received:n.parsedType}),at}return Pr(e.data)}};ul.create=e=>new ul(ie({typeName:lt.ZodUndefined},St(e)));var dl=class extends Pt{_parse(e){if(this._getType(e)!==$e.null){const n=this._getOrReturnCtx(e);return qe(n,{code:Le.invalid_type,expected:$e.null,received:n.parsedType}),at}return Pr(e.data)}};dl.create=e=>new dl(ie({typeName:lt.ZodNull},St(e)));var jo=class extends Pt{constructor(){super(...arguments),this._any=!0}_parse(e){return Pr(e.data)}};jo.create=e=>new jo(ie({typeName:lt.ZodAny},St(e)));var Oa=class extends Pt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Pr(e.data)}};Oa.create=e=>new Oa(ie({typeName:lt.ZodUnknown},St(e)));var xs=class extends Pt{_parse(e){const t=this._getOrReturnCtx(e);return qe(t,{code:Le.invalid_type,expected:$e.never,received:t.parsedType}),at}};xs.create=e=>new xs(ie({typeName:lt.ZodNever},St(e)));var Ad=class extends Pt{_parse(e){if(this._getType(e)!==$e.undefined){const n=this._getOrReturnCtx(e);return qe(n,{code:Le.invalid_type,expected:$e.void,received:n.parsedType}),at}return Pr(e.data)}};Ad.create=e=>new Ad(ie({typeName:lt.ZodVoid},St(e)));var za=class Wu extends Pt{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),i=this._def;if(n.parsedType!==$e.array)return qe(n,{code:Le.invalid_type,expected:$e.array,received:n.parsedType}),at;if(i.exactLength!==null){const o=n.data.length>i.exactLength.value,u=n.data.length<i.exactLength.value;(o||u)&&(qe(n,{code:o?Le.too_big:Le.too_small,minimum:u?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(qe(n,{code:Le.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(qe(n,{code:Le.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,u)=>i.type._parseAsync(new es(n,o,n.path,u)))).then(o=>Vr.mergeArray(r,o));const a=[...n.data].map((o,u)=>i.type._parseSync(new es(n,o,n.path,u)));return Vr.mergeArray(r,a)}get element(){return this._def.type}min(t,n){return new Wu(Se(ie({},this._def),{minLength:{value:t,message:et.toString(n)}}))}max(t,n){return new Wu(Se(ie({},this._def),{maxLength:{value:t,message:et.toString(n)}}))}length(t,n){return new Wu(Se(ie({},this._def),{exactLength:{value:t,message:et.toString(n)}}))}nonempty(t){return this.min(1,t)}};za.create=(e,t)=>new za(ie({type:e,minLength:null,maxLength:null,exactLength:null,typeName:lt.ZodArray},St(t)));function to(e){if(e instanceof fi){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Yi.create(to(r))}return new fi(Se(ie({},e._def),{shape:()=>t}))}else return e instanceof za?new za(Se(ie({},e._def),{type:to(e.element)})):e instanceof Yi?Yi.create(to(e.unwrap())):e instanceof ia?ia.create(to(e.unwrap())):e instanceof ra?ra.create(e.items.map(t=>to(t))):e}var fi=class wi extends Pt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Ht.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==$e.object){const h=this._getOrReturnCtx(t);return qe(h,{code:Le.invalid_type,expected:$e.object,received:h.parsedType}),at}const{status:r,ctx:i}=this._processInputParams(t),{shape:a,keys:o}=this._getCached(),u=[];if(!(this._def.catchall instanceof xs&&this._def.unknownKeys==="strip"))for(const h in i.data)o.includes(h)||u.push(h);const p=[];for(const h of o){const g=a[h],f=i.data[h];p.push({key:{status:"valid",value:h},value:g._parse(new es(i,f,i.path,h)),alwaysSet:h in i.data})}if(this._def.catchall instanceof xs){const h=this._def.unknownKeys;if(h==="passthrough")for(const g of u)p.push({key:{status:"valid",value:g},value:{status:"valid",value:i.data[g]}});else if(h==="strict")u.length>0&&(qe(i,{code:Le.unrecognized_keys,keys:u}),r.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const g of u){const f=i.data[g];p.push({key:{status:"valid",value:g},value:h._parse(new es(i,f,i.path,g)),alwaysSet:g in i.data})}}return i.common.async?Promise.resolve().then(()=>H(this,null,function*(){const h=[];for(const g of p){const f=yield g.key,_=yield g.value;h.push({key:f,value:_,alwaysSet:g.alwaysSet})}return h})).then(h=>Vr.mergeObjectSync(r,h)):Vr.mergeObjectSync(r,p)}get shape(){return this._def.shape()}strict(t){return et.errToObj,new wi(ie(Se(ie({},this._def),{unknownKeys:"strict"}),t!==void 0?{errorMap:(n,r)=>{var i,a,o,u;const p=(o=(a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)!=null?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(u=et.errToObj(t).message)!=null?u:p}:{message:p}}}:{}))}strip(){return new wi(Se(ie({},this._def),{unknownKeys:"strip"}))}passthrough(){return new wi(Se(ie({},this._def),{unknownKeys:"passthrough"}))}extend(t){return new wi(Se(ie({},this._def),{shape:()=>ie(ie({},this._def.shape()),t)}))}merge(t){return new wi({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>ie(ie({},this._def.shape()),t._def.shape()),typeName:lt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new wi(Se(ie({},this._def),{catchall:t}))}pick(t){const n={};for(const r of Ht.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new wi(Se(ie({},this._def),{shape:()=>n}))}omit(t){const n={};for(const r of Ht.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new wi(Se(ie({},this._def),{shape:()=>n}))}deepPartial(){return to(this)}partial(t){const n={};for(const r of Ht.objectKeys(this.shape)){const i=this.shape[r];t&&!t[r]?n[r]=i:n[r]=i.optional()}return new wi(Se(ie({},this._def),{shape:()=>n}))}required(t){const n={};for(const r of Ht.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Yi;)a=a._def.innerType;n[r]=a}return new wi(Se(ie({},this._def),{shape:()=>n}))}keyof(){return Cb(Ht.objectKeys(this.shape))}};fi.create=(e,t)=>new fi(ie({shape:()=>e,unknownKeys:"strip",catchall:xs.create(),typeName:lt.ZodObject},St(t)));fi.strictCreate=(e,t)=>new fi(ie({shape:()=>e,unknownKeys:"strict",catchall:xs.create(),typeName:lt.ZodObject},St(t)));fi.lazycreate=(e,t)=>new fi(ie({shape:e,unknownKeys:"strip",catchall:xs.create(),typeName:lt.ZodObject},St(t)));var hl=class extends Pt{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function r(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Fi(o.ctx.common.issues));return qe(t,{code:Le.invalid_union,unionErrors:a}),at}if(t.common.async)return Promise.all(n.map(i=>H(this,null,function*(){const a=Se(ie({},t),{common:Se(ie({},t.common),{issues:[]}),parent:null});return{result:yield i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}}))).then(r);{let i;const a=[];for(const u of n){const p=Se(ie({},t),{common:Se(ie({},t.common),{issues:[]}),parent:null}),h=u._parseSync({data:t.data,path:t.path,parent:p});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:p}),p.common.issues.length&&a.push(p.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(u=>new Fi(u));return qe(t,{code:Le.invalid_union,unionErrors:o}),at}}get options(){return this._def.options}};hl.create=(e,t)=>new hl(ie({options:e,typeName:lt.ZodUnion},St(t)));var ds=e=>e instanceof fl?ds(e.schema):e instanceof Ni?ds(e.innerType()):e instanceof ml?[e.value]:e instanceof Il?e.options:e instanceof gl?Ht.objectValues(e.enum):e instanceof vl?ds(e._def.innerType):e instanceof ul?[void 0]:e instanceof dl?[null]:e instanceof Yi?[void 0,...ds(e.unwrap())]:e instanceof ia?[null,...ds(e.unwrap())]:e instanceof dg||e instanceof _l?ds(e.unwrap()):e instanceof yl?ds(e._def.innerType):[],_b=class bb extends Pt{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==$e.object)return qe(n,{code:Le.invalid_type,expected:$e.object,received:n.parsedType}),at;const r=this.discriminator,i=n.data[r],a=this.optionsMap.get(i);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):(qe(n,{code:Le.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),at)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const i=new Map;for(const a of n){const o=ds(a.shape[t]);if(!o.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const u of o){if(i.has(u))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(u)}`);i.set(u,a)}}return new bb(ie({typeName:lt.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:i},St(r)))}};function Wf(e,t){const n=fs(e),r=fs(t);if(e===t)return{valid:!0,data:e};if(n===$e.object&&r===$e.object){const i=Ht.objectKeys(t),a=Ht.objectKeys(e).filter(u=>i.indexOf(u)!==-1),o=ie(ie({},e),t);for(const u of a){const p=Wf(e[u],t[u]);if(!p.valid)return{valid:!1};o[u]=p.data}return{valid:!0,data:o}}else if(n===$e.array&&r===$e.array){if(e.length!==t.length)return{valid:!1};const i=[];for(let a=0;a<e.length;a++){const o=e[a],u=t[a],p=Wf(o,u);if(!p.valid)return{valid:!1};i.push(p.data)}return{valid:!0,data:i}}else return n===$e.date&&r===$e.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var pl=class extends Pt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(i,a)=>{if(qf(i)||qf(a))return at;const o=Wf(i.value,a.value);return o.valid?((zf(i)||zf(a))&&t.dirty(),{status:t.value,value:o.data}):(qe(n,{code:Le.invalid_intersection_types}),at)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,a])=>r(i,a)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};pl.create=(e,t,n)=>new pl(ie({left:e,right:t,typeName:lt.ZodIntersection},St(n)));var ra=class Sb extends Pt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==$e.array)return qe(r,{code:Le.invalid_type,expected:$e.array,received:r.parsedType}),at;if(r.data.length<this._def.items.length)return qe(r,{code:Le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),at;!this._def.rest&&r.data.length>this._def.items.length&&(qe(r,{code:Le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((o,u)=>{const p=this._def.items[u]||this._def.rest;return p?p._parse(new es(r,o,r.path,u)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>Vr.mergeArray(n,o)):Vr.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new Sb(Se(ie({},this._def),{rest:t}))}};ra.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ra(ie({items:e,typeName:lt.ZodTuple,rest:null},St(t)))};var wb=class Gf extends Pt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==$e.object)return qe(r,{code:Le.invalid_type,expected:$e.object,received:r.parsedType}),at;const i=[],a=this._def.keyType,o=this._def.valueType;for(const u in r.data)i.push({key:a._parse(new es(r,u,r.path,u)),value:o._parse(new es(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?Vr.mergeObjectAsync(n,i):Vr.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Pt?new Gf(ie({keyType:t,valueType:n,typeName:lt.ZodRecord},St(r))):new Gf(ie({keyType:Lo.create(),valueType:t,typeName:lt.ZodRecord},St(n)))}},Id=class extends Pt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==$e.map)return qe(n,{code:Le.invalid_type,expected:$e.map,received:n.parsedType}),at;const r=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map(([o,u],p)=>({key:r._parse(new es(n,o,n.path,[p,"key"])),value:i._parse(new es(n,u,n.path,[p,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(()=>H(this,null,function*(){for(const u of a){const p=yield u.key,h=yield u.value;if(p.status==="aborted"||h.status==="aborted")return at;(p.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(p.value,h.value)}return{status:t.value,value:o}}))}else{const o=new Map;for(const u of a){const p=u.key,h=u.value;if(p.status==="aborted"||h.status==="aborted")return at;(p.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(p.value,h.value)}return{status:t.value,value:o}}}};Id.create=(e,t,n)=>new Id(ie({valueType:t,keyType:e,typeName:lt.ZodMap},St(n)));var Fd=class Jf extends Pt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==$e.set)return qe(r,{code:Le.invalid_type,expected:$e.set,received:r.parsedType}),at;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(qe(r,{code:Le.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(qe(r,{code:Le.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const a=this._def.valueType;function o(p){const h=new Set;for(const g of p){if(g.status==="aborted")return at;g.status==="dirty"&&n.dirty(),h.add(g.value)}return{status:n.value,value:h}}const u=[...r.data.values()].map((p,h)=>a._parse(new es(r,p,r.path,h)));return r.common.async?Promise.all(u).then(p=>o(p)):o(u)}min(t,n){return new Jf(Se(ie({},this._def),{minSize:{value:t,message:et.toString(n)}}))}max(t,n){return new Jf(Se(ie({},this._def),{maxSize:{value:t,message:et.toString(n)}}))}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}};Fd.create=(e,t)=>new Fd(ie({valueType:e,minSize:null,maxSize:null,typeName:lt.ZodSet},St(t)));var xb=class Gu extends Pt{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==$e.function)return qe(n,{code:Le.invalid_type,expected:$e.function,received:n.parsedType}),at;function r(u,p){return Td({data:u,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,kd(),Mo].filter(h=>!!h),issueData:{code:Le.invalid_arguments,argumentsError:p}})}function i(u,p){return Td({data:u,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,kd(),Mo].filter(h=>!!h),issueData:{code:Le.invalid_return_type,returnTypeError:p}})}const a={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Bo){const u=this;return Pr(function(...p){return H(this,null,function*(){const h=new Fi([]),g=yield u._def.args.parseAsync(p,a).catch(w=>{throw h.addIssue(r(p,w)),h}),f=yield Reflect.apply(o,this,g);return yield u._def.returns._def.type.parseAsync(f,a).catch(w=>{throw h.addIssue(i(f,w)),h})})})}else{const u=this;return Pr(function(...p){const h=u._def.args.safeParse(p,a);if(!h.success)throw new Fi([r(p,h.error)]);const g=Reflect.apply(o,this,h.data),f=u._def.returns.safeParse(g,a);if(!f.success)throw new Fi([i(g,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Gu(Se(ie({},this._def),{args:ra.create(t).rest(Oa.create())}))}returns(t){return new Gu(Se(ie({},this._def),{returns:t}))}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new Gu(ie({args:t||ra.create([]).rest(Oa.create()),returns:n||Oa.create(),typeName:lt.ZodFunction},St(r)))}},fl=class extends Pt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};fl.create=(e,t)=>new fl(ie({getter:e,typeName:lt.ZodLazy},St(t)));var ml=class extends Pt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return qe(t,{received:t.data,code:Le.invalid_literal,expected:this._def.value}),at}return{status:"valid",value:e.data}}get value(){return this._def.value}};ml.create=(e,t)=>new ml(ie({value:e,typeName:lt.ZodLiteral},St(t)));function Cb(e,t){return new Il(ie({values:e,typeName:lt.ZodEnum},St(t)))}var Il=class Zf extends Pt{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return qe(n,{expected:Ht.joinValues(r),received:n.parsedType,code:Le.invalid_type}),at}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return qe(n,{received:n.data,code:Le.invalid_enum_value,options:r}),at}return Pr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Zf.create(t,ie(ie({},this._def),n))}exclude(t,n=this._def){return Zf.create(this.options.filter(r=>!t.includes(r)),ie(ie({},this._def),n))}};Il.create=Cb;var gl=class extends Pt{_parse(e){const t=Ht.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==$e.string&&n.parsedType!==$e.number){const r=Ht.objectValues(t);return qe(n,{expected:Ht.joinValues(r),received:n.parsedType,code:Le.invalid_type}),at}if(this._cache||(this._cache=new Set(Ht.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=Ht.objectValues(t);return qe(n,{received:n.data,code:Le.invalid_enum_value,options:r}),at}return Pr(e.data)}get enum(){return this._def.values}};gl.create=(e,t)=>new gl(ie({values:e,typeName:lt.ZodNativeEnum},St(t)));var Bo=class extends Pt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==$e.promise&&t.common.async===!1)return qe(t,{code:Le.invalid_type,expected:$e.promise,received:t.parsedType}),at;const n=t.parsedType===$e.promise?t.data:Promise.resolve(t.data);return Pr(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};Bo.create=(e,t)=>new Bo(ie({type:e,typeName:lt.ZodPromise},St(t)));var Ni=class extends Pt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===lt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:a=>{qe(n,a),a.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),r.type==="preprocess"){const a=r.transform(n.data,i);if(n.common.async)return Promise.resolve(a).then(o=>H(this,null,function*(){if(t.value==="aborted")return at;const u=yield this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?at:u.status==="dirty"||t.value==="dirty"?mo(u.value):u}));{if(t.value==="aborted")return at;const o=this._def.schema._parseSync({data:a,path:n.path,parent:n});return o.status==="aborted"?at:o.status==="dirty"||t.value==="dirty"?mo(o.value):o}}if(r.type==="refinement"){const a=o=>{const u=r.refinement(o,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?at:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?at:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(r.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!qa(a))return at;const o=r.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>qa(a)?Promise.resolve(r.transform(a.value,i)).then(o=>({status:t.value,value:o})):at);Ht.assertNever(r)}};Ni.create=(e,t,n)=>new Ni(ie({schema:e,typeName:lt.ZodEffects,effect:t},St(n)));Ni.createWithPreprocess=(e,t,n)=>new Ni(ie({schema:t,effect:{type:"preprocess",transform:e},typeName:lt.ZodEffects},St(n)));var Yi=class extends Pt{_parse(e){return this._getType(e)===$e.undefined?Pr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Yi.create=(e,t)=>new Yi(ie({innerType:e,typeName:lt.ZodOptional},St(t)));var ia=class extends Pt{_parse(e){return this._getType(e)===$e.null?Pr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ia.create=(e,t)=>new ia(ie({innerType:e,typeName:lt.ZodNullable},St(t)));var vl=class extends Pt{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===$e.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};vl.create=(e,t)=>new vl(ie({innerType:e,typeName:lt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default},St(t)));var yl=class extends Pt{_parse(e){const{ctx:t}=this._processInputParams(e),n=Se(ie({},t),{common:Se(ie({},t.common),{issues:[]})}),r=this._def.innerType._parse({data:n.data,path:n.path,parent:ie({},n)});return sl(r)?r.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Fi(n.common.issues)},input:n.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Fi(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};yl.create=(e,t)=>new yl(ie({innerType:e,typeName:lt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch},St(t)));var Dd=class extends Pt{_parse(e){if(this._getType(e)!==$e.nan){const n=this._getOrReturnCtx(e);return qe(n,{code:Le.invalid_type,expected:$e.nan,received:n.parsedType}),at}return{status:"valid",value:e.data}}};Dd.create=e=>new Dd(ie({typeName:lt.ZodNaN},St(e)));var h5=Symbol("zod_brand"),dg=class extends Pt{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},hg=class Eb extends Pt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return H(this,null,function*(){const a=yield this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?at:a.status==="dirty"?(n.dirty(),mo(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})});{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?at:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(t,n){return new Eb({in:t,out:n,typeName:lt.ZodPipeline})}},_l=class extends Pt{_parse(e){const t=this._def.innerType._parse(e),n=r=>(qa(r)&&(r.value=Object.freeze(r.value)),r);return sl(t)?t.then(r=>n(r)):n(t)}unwrap(){return this._def.innerType}};_l.create=(e,t)=>new _l(ie({innerType:e,typeName:lt.ZodReadonly},St(t)));function h1(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function Pb(e,t={},n){return e?jo.create().superRefine((r,i)=>{var a,o;const u=e(r);if(u instanceof Promise)return u.then(p=>{var h,g;if(!p){const f=h1(t,r),_=(g=(h=f.fatal)!=null?h:n)!=null?g:!0;i.addIssue(Se(ie({code:"custom"},f),{fatal:_}))}});if(!u){const p=h1(t,r),h=(o=(a=p.fatal)!=null?a:n)!=null?o:!0;i.addIssue(Se(ie({code:"custom"},p),{fatal:h}))}}):jo.create()}var p5={object:fi.lazycreate},lt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(lt||(lt={}));var f5=(e,t={message:`Input not instance of ${e.name}`})=>Pb(n=>n instanceof e,t),kb=Lo.create,Tb=al.create,m5=Dd.create,g5=ol.create,Rb=cl.create,v5=ll.create,y5=Rd.create,_5=ul.create,b5=dl.create,S5=jo.create,w5=Oa.create,x5=xs.create,C5=Ad.create,E5=za.create,P5=fi.create,k5=fi.strictCreate,T5=hl.create,R5=_b.create,A5=pl.create,I5=ra.create,F5=wb.create,D5=Id.create,N5=Fd.create,O5=xb.create,M5=fl.create,L5=ml.create,j5=Il.create,B5=gl.create,U5=Bo.create,p1=Ni.create,H5=Yi.create,V5=ia.create,q5=Ni.createWithPreprocess,z5=hg.create,K5=()=>kb().optional(),$5=()=>Tb().optional(),W5=()=>Rb().optional(),G5={string:e=>Lo.create(Se(ie({},e),{coerce:!0})),number:e=>al.create(Se(ie({},e),{coerce:!0})),boolean:e=>cl.create(Se(ie({},e),{coerce:!0})),bigint:e=>ol.create(Se(ie({},e),{coerce:!0})),date:e=>ll.create(Se(ie({},e),{coerce:!0}))},J5=at,yc=new ze("packages/token/src/encoder.ts"),bl=class Ab{constructor(t){let n;try{n=S6.parse(t)}catch(r){throw r instanceof Ve.ZodError?new wr({path:yc.prefix,info:_c.invalidParameter,error:new Error("Received invalid token. Please check your SkyWayAuthToken.")}):new wr({path:yc.prefix,info:_c.invalidParameter,error:new Error("Received invalid token. Please check your SkyWayAuthToken.")})}Object.assign(this,n)}static Decode(t){try{const n=UE(t),r=new Ab(n);return r.tokenString=t,r}catch(n){throw new wr({path:yc.prefix,info:_c.invalidParameter,error:n})}}encode(t){const n={jti:this.jti,iat:this.iat,exp:this.exp,scope:this.scope,version:this.version};return this.tokenString=LE.default.KJUR.jws.JWS.sign("HS256",JSON.stringify({alg:"HS256",typ:"JWT"}),JSON.stringify(n),t),this.tokenString}toJSON(){return{jti:this.jti,iat:this.iat,exp:this.exp,scope:this.scope,encoded:this.tokenString,version:this.version}}getAppId(){switch(this.version){case void 0:case 1:case 2:return this.scope.app.id;case 3:return this.scope.appId;default:throw new wr({path:yc.prefix,info:_c.invalidParameter,error:new Error(`invalid token version: version ${this.version} is not supported.`)})}}getAnalyticsEnabled(){var t,n,r;switch(this.version){case void 0:case 1:case 2:return(t=this.scope.app.analytics)!=null?t:!1;case 3:return(r=(n=this.scope.analytics)==null?void 0:n.enabled)!=null?r:!0;default:throw new wr({path:yc.prefix,info:_c.invalidParameter,error:new Error(`invalid token version: version ${this.version} is not supported.`)})}}};Y();var Z5=["create","write","delete"],X5=Ve.object({actions:Ve.array(Ve.enum(Z5).refine(e=>typeof e=="string"))}).passthrough(),Q5=["create","write","delete"],Y5=Ve.object({actions:Ve.array(Ve.enum(Q5).refine(e=>typeof e=="string")),forwardings:Ve.array(X5)}).passthrough();Y();var e6=["write","create","delete","updateMetadata","enable","disable"],t6=Ve.object({actions:Ve.array(Ve.enum(e6).refine(e=>typeof e=="string"))}).passthrough(),n6=["write","create","delete"],r6=Ve.object({actions:Ve.array(Ve.enum(n6).refine(e=>typeof e=="string"))}).passthrough(),i6=["write","create","delete","updateMetadata","signal"],s6=Ve.object({id:Ve.string().optional(),name:Ve.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),a6=Ve.intersection(s6,Ve.object({actions:Ve.array(Ve.enum(i6).refine(e=>typeof e=="string")),publication:t6.optional(),subscription:r6.optional()}).passthrough()),o6=["write","read","create","delete","updateMetadata"],c6=Ve.object({id:Ve.string().optional(),name:Ve.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),l6=Ve.intersection(c6,Ve.object({actions:Ve.array(Ve.enum(o6).refine(e=>typeof e=="string")),members:Ve.array(a6),sfuBots:Ve.array(Y5).optional()}).passthrough()),u6=["listChannels","read","write"],d6=Ve.object({id:Ve.string(),analytics:Ve.boolean().optional(),actions:Ve.array(Ve.enum(u6).refine(e=>typeof e=="string")).optional(),channels:Ve.array(l6).optional(),turn:Ve.boolean().optional()}).passthrough();Y();var h6=["publish","subscribe","updateMetadata"],p6=Ve.object({id:Ve.string().optional(),name:Ve.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),f6=Ve.intersection(p6,Ve.object({methods:Ve.array(Ve.enum(h6).refine(e=>typeof e=="string"))}).passthrough()),m6=["create","close","updateMetadata"],g6=Ve.object({id:Ve.string().optional(),name:Ve.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),v6=Ve.intersection(g6,Ve.object({methods:Ve.array(Ve.enum(m6).refine(e=>typeof e=="string")),member:f6.optional(),sfu:Ve.object({enabled:Ve.boolean().optional(),maxSubscribersLimit:Ve.number().optional()}).optional()}).passthrough()),y6=Ve.object({appId:Ve.string(),analytics:Ve.object({enabled:Ve.boolean().optional()}).optional(),noiseCancelling:Ve.object({enabled:Ve.boolean().optional()}).optional(),turn:Ve.object({enabled:Ve.boolean().optional()}).optional(),rooms:Ve.array(v6)}).passthrough();Y();var Ib=Ve.object({jti:Ve.string().uuid(),iat:Ve.number().nonnegative(),exp:Ve.number().nonnegative()}),_6=Ve.intersection(Ib,Ve.object({scope:Ve.object({app:d6}),version:Ve.union([Ve.literal(1),Ve.literal(2),Ve.literal(void 0)]).optional()})),b6=Ve.intersection(Ib,Ve.object({scope:y6,version:Ve.literal(3)})),S6=Ve.union([_6,b6]);Y();var _c={invalidParameter:{name:"invalidParameter",detail:"failed to decode token",solution:"Use the correct token according to the specification"}};Y();var f1=()=>Math.floor(Date.now()/1e3),Wo=ji,Fb=class{constructor(e){this.contentType=e,this.side="local",this.onConnectionStateChanged=new We,this._onConnectionStateChanged=new We,this.id=Wo(),this._label="",this.published=!1,this._getTransportCallbacks={},this._getStatsCallbacks={},this._connectionState={},this._onConnectionStateChanged.pipe(this.onConnectionStateChanged)}_setLabel(e){this._label=e}_unpublished(){this.published=!1,this._getTransportCallbacks={},this._getStatsCallbacks={}}_getTransport(e){var t,n;const r=typeof e=="string"?e:e.id;return(n=(t=this._getTransportCallbacks)[r])==null?void 0:n.call(t)}_setConnectionState(e,t){this._connectionState[e.id]!==t&&(this._connectionState[e.id]=t,this._onConnectionStateChanged.emit({remoteMember:e,state:t}))}getStats(e){return this._getStats(e)}_getStats(e){var t,n,r;const i=typeof e=="string"?e:e.id;return(r=(n=(t=this._getStatsCallbacks)[i])==null?void 0:n.call(t))!=null?r:[]}_getStatsAll(){return Promise.all(Object.entries(this._getStatsCallbacks).map(e=>H(this,[e],function*([t,n]){return{memberId:t,stats:yield n().catch(()=>[])}})))}getRTCPeerConnection(e){return this._getRTCPeerConnection(e)}_getRTCPeerConnection(e){var t;return(t=this._getTransport(e))==null?void 0:t.rtcPeerConnection}getConnectionState(e){return this._getConnectionState(e)}_getConnectionState(e){var t;const n=typeof e=="string"?e:e.id;return(t=this._connectionState[n])!=null?t:"new"}_getConnectionStateAll(){return Object.keys(this._getTransportCallbacks).map(e=>({memberId:e,connectionState:this._getConnectionState(e)}))}toJSON(){return{label:this._label,contentType:this.contentType,id:this.id,side:this.side}}},w6=new ze("packages/core/src/media/stream/local/media.ts"),pg=class extends Fb{constructor(e,t,n={}){super(t),this.onTrackUpdated=new We,this.onDestroyed=new We,this._disposer=new ei,this._trackConstraints={},this._replacingTrack=!1,this._onReplacingTrackDone=new We,this._onEnableChanged=new We,this._track=e,this._listenTrackEvent(),this._options=n,this._trackConstraints=ie({},n)}get trackConstraints(){return this._trackConstraints}toJSON(){const e=super.toJSON();return Se(ie({},e),{trackConstraints:this.trackConstraints,isEnabled:this.isEnabled,_options:this._options})}get track(){return this._track}attach(e){this._element=e,ub(e,this._track)}detach(){this._element&&(db(this._element,this._track),this._element=void 0)}_disable(e){this._options.stopTrackWhenDisabled?(this._trackConstraints=ie(ie({},this.trackConstraints),this.track.getConstraints()),this.track.stop()):this._oldTrack=this.track;const t=e==="video"?Nb:x6;t.enabled=!1,this._onEnableChanged.emit(t),this._updateTrack(t)}_updateTrack(e){this._track=e,this._element&&this.attach(this._element),this.onTrackUpdated.emit(e),this._listenTrackEvent()}_listenTrackEvent(){const e=()=>{w6.info("onDestroyed",this.toJSON()),this.onDestroyed.emit()};this._track.addEventListener("ended",e),this._disposer.push(()=>this._track.removeEventListener("ended",e))}release(){this._disposer.dispose(),this._track.stop()}},Db=new RTCPeerConnection,x6=Db.addTransceiver("audio").receiver.track,Nb=Db.addTransceiver("video").receiver.track,kp=new ze("packages/core/src/media/stream/local/audio.ts"),Tp=class extends pg{constructor(e,t={}){if(super(e,"audio",t),this.contentType="audio",this._isEnabled=!0,this._promiseQueue=new ua,e.kind!=="audio")throw De({operationName:"LocalAudioStream.constructor",path:kp.prefix,info:Ue.invalidTrackKind,payload:{track:e}})}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){if(this._isEnabled===!0&&e===!1)this._isEnabled=e,this._disable("audio"),kp.debug("stopped");else if(this._isEnabled===!1&&e===!0){if(this._isEnabled=e,this._options.stopTrackWhenDisabled){const t=this._options.isDisplayMedia===!0?yield this.enableDisplay():yield this.enableMic();this._updateTrack(t),this._onEnableChanged.emit(t)}else this._oldTrack&&(this._updateTrack(this._oldTrack),this._onEnableChanged.emit(this._oldTrack));kp.debug("resumed")}}))})}get isEnabled(){return this._isEnabled}enableMic(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getUserMedia({audio:this.trackConstraints})).getAudioTracks();return e})}enableDisplay(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getDisplayMedia({audio:this.trackConstraints})).getAudioTracks();return e})}};Y();var C6=new ze("packages/core/src/media/stream/local/customVideo.ts"),E6=class extends pg{constructor(e={}){super(Nb,"video",e),this.contentType="video",this._isEnabled=!0,this._promiseQueue=new ua,this._stream=null}setStream(e){return H(this,null,function*(){if(this._stream)throw new Error("ProcessedStream is already exists");this._stream=e,this._updateTrack(e.track)})}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){var t;yield(t=this._stream)==null?void 0:t.setEnabled(e)}))})}updateTrack(e){return H(this,null,function*(){this._updateTrack(e),this._onEnableChanged.emit(e)})}get isEnabled(){return this._isEnabled}release(){var e;(e=this._stream)==null||e.dispose().catch(()=>{C6.error("release failed")})}};Y();var yu=new ze("packages/core/src/media/stream/local/video.ts"),Rp=class extends pg{constructor(e,t={}){if(super(e,"video",t),this.contentType="video",this._isEnabled=!0,this._promiseQueue=new ua,e.kind!=="video")throw De({operationName:"LocalVideoStream.constructor",path:yu.prefix,info:Ue.invalidTrackKind,payload:{track:e}});yu.debug("LocalVideoStream spawned",this.toJSON())}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){if(this._isEnabled===!0&&e===!1)this._isEnabled=e,this._disable("video"),yu.debug("stopped",this.toJSON());else if(this._isEnabled===!1&&e===!0){if(this._isEnabled=e,this._options.stopTrackWhenDisabled){const t=this._options.isDisplayMedia===!0?yield this.enableDisplay():yield this.enableCamera();this._updateTrack(t),this._onEnableChanged.emit(t)}else this._oldTrack&&(this._updateTrack(this._oldTrack),this._onEnableChanged.emit(this._oldTrack));yu.debug("resumed",this.toJSON())}}))})}get isEnabled(){return this._isEnabled}enableCamera(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getUserMedia({video:this.trackConstraints})).getVideoTracks();return e})}enableDisplay(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getDisplayMedia({video:this.trackConstraints})).getVideoTracks();return e})}},P6=new ze("packages/core/src/media/stream/local/data.ts"),fg=class extends Fb{constructor(e={}){super("data"),this.options=e,this.contentType="data",this._onWriteData=new We,this._isEnabled=!0,this._setLabel("LocalDataStream")}get isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}write(e){if(!this._isEnabled)throw De({operationName:"LocalDataStream.write",path:P6.prefix,info:Ue.disabledDataStream});!ArrayBuffer.isView(e)&&typeof e!="string"&&(e=Xf+JSON.stringify(e)),this._onWriteData.emit(e)}},Xf="skyway_object:";Y();function k6(e,{publisherId:t,stream:n,origin:r,metadata:i,codecCapabilities:a,encodings:o,contentType:u,id:p,isEnabled:h}){const g=e._getPublication(p);if(g)return g;u=u.toLowerCase();const f=r?e._getPublication(r):void 0;return f&&o.length===0&&(o=f.encodings),new Ob({id:p,channel:e,publisher:e._getMember(t),contentType:u,metadata:i,origin:f,stream:n,codecCapabilities:a??[],encodings:o,isEnabled:h})}var yn=new ze("packages/core/src/publication/index.ts"),Ob=class{constructor(e){this._codecCapabilities=[],this._encodings=[],this._state="enabled",this._events=new ts,this.onCanceled=this._events.make(),this.onSubscribed=this._events.make(),this.onUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onEnabled=this._events.make(),this.onDisabled=this._events.make(),this.onStateChanged=this._events.make(),this.onConnectionStateChanged=new We,this._onEncodingsChanged=this._events.make(),this._onReplaceStream=this._events.make(),this._onEnabled=this._events.make(),this.streamEventDisposer=new ei,this.cancel=()=>new Promise((i,a)=>{let o=!1;this._channel._unpublish(this.id).catch(u=>{o=!0,a(u)}),this._setStream(void 0),this.onCanceled.asPromise(this._context.config.rtcApi.timeout).then(()=>i()).catch(u=>{o||a(u)})}),this.updateMetadata=i=>new Promise((a,o)=>H(this,null,function*(){const u=yn.info("[start] updateMetadata",yield Ct({operationName:"Publication.updateMetadata",channel:this._channel}),this);let p=!1;this._channel._updatePublicationMetadata(this.id,i).catch(h=>{p=!0,o(h)}),this.onMetadataUpdated.watch(h=>h.metadata===i,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){a(),yn.elapsed(u,"[end] updateMetadata",yield Ct({operationName:"Publication.updateMetadata",channel:this._channel}),this)})).catch(h=>{if(!p)throw De({operationName:"PublicationImpl.updateMetadata",info:Se(ie({},Ue.timeout),{detail:"publication onMetadataUpdated"}),path:yn.prefix,context:this._context,channel:this._channel,error:h})})})),this.disable=()=>new Promise((i,a)=>H(this,null,function*(){if(this.state==="disabled"){i();return}const o=yn.info("[start] disable",yield Ct({operationName:"Publication.disable",channel:this._channel}),this);yield this._disableStream();let u=!1;this._channel._disablePublication(this.id).catch(p=>{u=!0,a(p)}),this.onDisabled.asPromise(this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){i(),yn.elapsed(o,"[end] disable",yield Ct({operationName:"Publication.disable",channel:this._channel}),this)})).catch(p=>{u||a(p)})})),this.enable=()=>new Promise((i,a)=>H(this,null,function*(){if(this.stream==null){a(De({operationName:"Publication.enable",context:this._context,info:Ue.canNotEnableRemotePublication,path:yn.prefix}));return}if(this.state==="enabled"){i();return}const o=yn.info("[start] enable",yield Ct({operationName:"Publication.enable",channel:this._channel}),this);let u=!1;this._channel._enablePublication(this.id).catch(p=>{u=!0,a(p)}),this._onEnabled.asPromise(this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){yield this._enableStream(),this.onEnabled.emit(),this.onStateChanged.emit(),yn.elapsed(o,"[end] enable",yield Ct({operationName:"Publication.enable",channel:this._channel}),this),i()})).catch(p=>{u||a(p)})}));var t,n,r;this.id=e.id,this._channel=e.channel,this._context=this._channel._context,this.publisher=e.publisher,this.contentType=e.contentType,this._metadata=e.metadata,this.origin=e.origin,this.setCodecCapabilities((t=e.codecCapabilities)!=null?t:[]),this.setEncodings(Qf((n=e.encodings)!=null?n:[])),this._state=e.isEnabled?"enabled":"disabled",e.stream&&this._setStream(e.stream),this._analytics=(r=this._channel.localPerson)==null?void 0:r._analytics,yn.debug("publication spawned",this.toJSON())}get codecCapabilities(){return this._codecCapabilities}setCodecCapabilities(e){this._codecCapabilities=e}get encodings(){return this._encodings}setEncodings(e){this._encodings=e}get stream(){return this._stream}_setStream(e){this._stream=e,e?e._onConnectionStateChanged.add(t=>{yn.debug("onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit(t)}).disposer(this.streamEventDisposer):this.streamEventDisposer.dispose()}get metadata(){return this._metadata}get state(){return this._state}get deviceName(){if(!(this.stream instanceof fg))return this.stream.track.label}get subscriptions(){return this._channel.subscriptions.filter(e=>e.publication.id===this.id)}_updateMetadata(e){this._metadata=e,this.onMetadataUpdated.emit({metadata:e})}_disable(){return H(this,null,function*(){yield this._disableStream(),this.onDisabled.emit(),this.onStateChanged.emit()})}_enable(){this.stream?this._onEnabled.emit():(this._state="enabled",this.onEnabled.emit(),this.onStateChanged.emit())}_unpublished(){this._state="canceled",this.stream&&this.stream._unpublished(),this.onCanceled.emit(),this.onStateChanged.emit(),this._dispose()}_subscribed(e){this.onSubscribed.emit({subscription:e}),this.onSubscriptionListChanged.emit()}_unsubscribed(e){this.onUnsubscribed.emit({subscription:e}),this.onSubscriptionListChanged.emit()}updateEncodings(e){yn.info("updateEncodings",{encodings:e},this),this.setEncodings(Qf(Mb(e))),this._onEncodingsChanged.emit(e),this._analytics&&!this._analytics.isClosed()&&this._analytics.client.sendPublicationUpdateEncodingsReport({publicationId:this.id,encodings:this.encodings,updatedAt:Date.now()})}_disableStream(){return H(this,null,function*(){this.state!=="disabled"&&(this._state="disabled",this.stream&&(this.stream.contentType==="data"?this.stream.setIsEnabled(!1):yield this.stream.setEnabled(!1).catch(e=>{yn.warn(Ln({channel:this._channel,operationName:"Publication._disableStream",payload:e,detail:"setEnabled failed"}))}),Ct({operationName:"Publication._disableStream",channel:this._channel}).then(e=>yn.info("publication _disableStream",e,{publication:this})).catch(()=>{})))})}_enableStream(){return H(this,null,function*(){this.state!=="enabled"&&(this._state="enabled",this.stream&&(Ct({operationName:"Publication._enableStream",channel:this._channel}).then(e=>yn.info("publication _enableStream",e,{publication:this})).catch(()=>{}),this.stream.contentType==="data"?this.stream.setIsEnabled(!0):yield this.stream.setEnabled(!0).catch(e=>{yn.warn(Ln({channel:this._channel,operationName:"Publication._disableStream",payload:e,detail:"setEnabled failed"}))})))})}replaceStream(e,t={}){var n;if(yn.info("replaceStream",{stream:e,options:t},this),!this.stream)throw De({operationName:"PublicationImpl.replaceStream",context:this._context,info:Ue.canNotUseReplaceStream,path:yn.prefix});if(e.contentType!==this.contentType)throw De({operationName:"PublicationImpl.replaceStream",context:this._context,info:Ue.invalidContentType,path:yn.prefix});((n=t.releaseOldStream)==null||n)&&this.stream.release(),Ct({operationName:"PublicationImpl.replaceStream",channel:this._channel}).then(i=>yn.debug(i,{old:this.stream,new:e})).catch(i=>i),e.setEnabled(this.stream.isEnabled).catch(i=>{yn.error("replaceStream stream.setEnabled",i,this.toJSON())});const r=this._stream;this._setStream(e),this._onReplaceStream.emit({newStream:e,oldStream:r}),this._analytics&&!this._analytics.isClosed()&&this._analytics.client.sendMediaDeviceReport({publicationId:this.id,mediaDeviceName:this.deviceName,mediaDeviceTrigger:"replaceStream",updatedAt:Date.now()})}getStats(e){if(!this.stream)throw De({operationName:"PublicationImpl.getStats",context:this._context,info:Ue.streamNotExistInSubscription,path:yn.prefix});return this.stream._getStats(e)}getRTCPeerConnection(e){if(!this.stream)throw De({operationName:"PublicationImpl.getRTCPeerConnection",context:this._context,info:Ue.streamNotExistInSubscription,path:yn.prefix});return this.stream._getRTCPeerConnection(e)}getConnectionState(e){if(!this.stream)throw De({operationName:"PublicationImpl.getConnectionState",context:this._context,info:Ue.streamNotExistInSubscription,path:yn.prefix});return this.stream._getConnectionState(e)}toJSON(){var e;return{id:this.id,channelId:this._channel.id,publisherId:this.publisher.id,origin:(e=this.origin)==null?void 0:e.id,contentType:this.contentType,metadata:this.metadata,codecCapabilities:this.codecCapabilities,encodings:this.encodings,state:this.state,stream:this.stream}}_dispose(){this._events.dispose()}},Qf=e=>e.map((t,n)=>{var r;return Se(ie({},t),{id:(r=t.id)!=null?r:n.toString()})}),Mb=e=>{const[t]=e;return t.maxBitrate?e.sort((n,r)=>n.maxBitrate-r.maxBitrate):t.scaleResolutionDownBy?e.sort((n,r)=>r.scaleResolutionDownBy-n.scaleResolutionDownBy):t.maxFramerate?e.sort((n,r)=>n.maxFramerate-r.maxFramerate):e};Y();function T6(e){return e==null?!1:e.side==="remote"}Y();Y();var m1=new ze("packages/core/src/dataPlane/agent/publishing.ts"),R6=class{constructor(e){this._localPerson=e,this.context=this._localPerson.context}startPublishing(e){return H(this,null,function*(){if(this.context.config.internal.disableDPlane){yield new Promise(i=>setTimeout(i,500));return}const t=e.publication,n=e.subscriber;t.stream||(yield this._localPerson.onStreamPublished.watch(i=>i.publication.id===t.id,this.context.config.rtcApi.timeout).catch(i=>{throw De({operationName:"PublishingAgent.startPublishing",context:this.context,channel:this._localPerson.channel,info:Se(ie({},Ue.timeout),{detail:"PublishingAgent onStreamPublished"}),path:m1.prefix,payload:{publication:t},error:i})}));const r=n._getOrCreateConnection(this._localPerson);r.startPublishing&&(yield r.startPublishing(t,e.id))})}stopPublishing(e,t){return H(this,null,function*(){const n=t._getConnection(this._localPerson.id);n!=null&&n.stopPublishing&&n.stopPublishing(e).catch(r=>{m1.error("stopPublishing failed",r)})})}};Y();var A6=class{constructor(e){this._localPerson=e,this._disposers={},this._context=this._localPerson.context}startSubscribing(e){return H(this,null,function*(){if(this._context.config.internal.disableDPlane){yield new Promise(r=>setTimeout(r,500));return}const n=e.publication.publisher._getOrCreateConnection(this._localPerson);if(n.startSubscribing){yield n.startSubscribing(e);const{removeListener:r}=e._onChangeEncoding.add(()=>H(this,null,function*(){var i;yield(i=n.changePreferredEncoding)==null?void 0:i.call(n,e)}));this._disposers[e.id]=r}})}stopSubscribing(e){return H(this,null,function*(){var t,n;const i=e.publication.publisher._getConnection(this._localPerson.id);i!=null&&i.stopSubscribing&&(yield i.stopSubscribing(e),(n=(t=this._disposers)[e.id])==null||n.call(t))})}};Y();var g1=class{constructor(e){this._impl=e,this._events=new ts,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberStateChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onFatalError=this._events.make(),this.apply(e)}get keepaliveIntervalSec(){return this._impl.keepaliveIntervalSec}get keepaliveIntervalGapSec(){return this._impl.keepaliveIntervalGapSec}get disableSignaling(){return this._impl.disableSignaling}get disableAnalytics(){return this._impl.disableAnalytics}get type(){return this._impl.type}get subtype(){return this._impl.subtype}get side(){return this._impl.side}get id(){return this._impl.id}get name(){return this._impl.name}get channel(){return this._impl.channel}get metadata(){return this._impl.metadata}get state(){return this._impl.state}get publications(){return this._impl.publications}get subscriptions(){return this._impl.subscriptions}apply(e){this._impl=e,e.onLeft.pipe(this.onLeft),e.onMetadataUpdated.pipe(this.onMetadataUpdated),e.onStreamPublished.pipe(this.onStreamPublished),e.onStreamUnpublished.pipe(this.onStreamUnpublished),e.onPublicationListChanged.pipe(this.onPublicationListChanged),e.onPublicationSubscribed.pipe(this.onPublicationSubscribed),e.onPublicationUnsubscribed.pipe(this.onPublicationUnsubscribed),e.onSubscriptionListChanged.pipe(this.onSubscriptionListChanged),e.onFatalError.pipe(this.onFatalError)}subscribe(e,t){return this._impl.subscribe(e,t)}unsubscribe(e){return this._impl.unsubscribe(e)}publish(e,t={}){return this._impl.publish(e,t)}unpublish(e){return this._impl.unpublish(e)}updateMetadata(e){return this._impl.updateMetadata(e)}leave(){return H(this,null,function*(){yield this._impl.leave()})}dispose(){this._impl.dispose()}};Y();Y();var I6=24*60*60;Y();var v1=new ze("packages/core/src/external/ice.ts"),F6=class{constructor(e){this.args=e,this.domain=this.args.domain,this.version=this.args.version,this.secure=this.args.secure,this.memberId=this.args.memberId,this.channelId=this.args.channelId,this.ttl=this.args.ttl,this.context=this.args.context,this._stunServers=[],this._turnServers=[],this._endpoint=`http${this.secure?"s":""}://${this.domain}/v${this.version}`,this.http=new ug(this._endpoint)}updateIceParams(){return H(this,null,function*(){const e={memberId:this.memberId,channelId:this.channelId,ttl:this.ttl};v1.debug("[start] fetch iceParams");const t=new ki({times:6,interval:500,jitter:100}),{turn:n,stun:r}=yield this.http.post("/ice-params",e,{headers:{authorization:`Bearer ${this.context.authTokenString}`},retry:()=>t.wait()});n&&(this._turnServers=[{credential:n.credential,urls:`turn:${n.domain}:${n.port}?transport=tcp`,username:n.username},{credential:n.credential,urls:`turn:${n.domain}:${n.port}?transport=udp`,username:n.username},{credential:n.credential,urls:`turns:${n.domain}:${n.port}?transport=tcp`,username:n.username}]),this._stunServers=[{urls:`stun:${r.domain}:${r.port}`}],v1.debug("[end] fetch iceParams",{turn:n,stun:r})})}get iceServers(){let e=[...this._stunServers];const t=this._turnServers.filter(n=>{const r=n.urls;switch(this.context.config.rtcConfig.turnProtocol){case"all":return!0;case"udp":return r.endsWith("udp");case"tcp":return!r.startsWith("turns")&&r.endsWith("tcp");case"tls":return r.startsWith("turns")}});return this.context.config.rtcConfig.turnPolicy!=="disable"&&(e=[...e,...t]),e}};Y();Y();Y();Y();var D6=20480,_u=class{constructor(e,t={}){if(this.event=e,this.payload=t,this.eventId=ji(),this.data=JSON.stringify({event:this.event,eventId:this.eventId,payload:this.payload}),this.data.length>D6)throw new Error("payload size exceeds the upper limit")}};Y();var N6=["rateLimitExceeded","targetNotFound","payloadLengthExceeded","invalidPayload","unknown","parameterError","permissionError"];function y1(e){return!(!e||typeof e!="object"||!Lb(e.src)||!e.data||typeof e.data!="object")}function O6(e){return!(!e||typeof e!="object"||typeof e.eventId!="string"||typeof e.ok!="boolean"||typeof e.reason<"u"&&(typeof e.reason!="string"||!N6.includes(e.reason)))}function Lb(e){return!(e===void 0||Array.isArray(e)||typeof e!="object"||typeof e.id!="string"||typeof e.name<"u"&&typeof e.name!="string")}Y();var _1=qr(tg());Y();var Aa=class{constructor(){this._listeners=new Map,this._listenerIndex=0,this.emit=e=>{this._listeners.forEach(t=>t(e))},this.removeAllListeners=()=>{this._listeners.clear()},this.addListener=e=>{const t=this._listenerIndex;return this._listeners.set(t,e),this._listenerIndex++,{removeListener:()=>{this._listeners.delete(t)}}},this.addOneTimeListener=e=>{const t=this.addListener(n=>{t.removeListener(),e(n)});return t},this.asPromise=e=>new Promise((t,n)=>{let r=()=>{};const i=e&&setTimeout(()=>{n("Event asPromise timeout"),r()},e);r=this.addOneTimeListener(o=>{i&&clearTimeout(i),t(o)}).removeListener})}};Y();var M6="1.0.4",L6=["open","sendRequestSignalingMessage","sendResponseSignalingMessage","acknowledge"],j6=e=>(ws(2,e)+Math.random())*1e3,B6=class{constructor({channelId:e,channelName:t,memberId:n,memberName:r,sessionEndpoint:i,token:a,logger:o}){this._isOpen=!1,this._isDestroyed=!1,this._reconnectCount=0,this.connectionState="closed",this.onConnectionStateChanged=new Aa,this.onOpened=new Aa,this.onEventReceived=new Aa,this.onConnectionFailed=new Aa,this._sessionEndpoint=i,this._channelId=e,this._channelName=t,this._memberId=n,this._memberName=r,this._token=a,this._logger=o,this._connect()}_setConnectionState(e){this._logger.debug(`connectionState changed : ${e}`),this.connectionState=e,this.onConnectionStateChanged.emit(e)}_connect(){let e;try{const t=`SkyWayAuthToken!${this._token}`,n={channelId:this._channelId,channelName:this._channelName,memberId:this._memberId,memberName:this._memberName,platform:"javascript",version:M6},r=Object.entries(n).filter(([a,o])=>o!==void 0).map(a=>a.join("=")).join("&"),i=`${this._sessionEndpoint}?${r}`;e=new _1.default(i,t),this._logger.debug(`Connecting to signaling-server: ${this._sessionEndpoint}`),e.onerror=a=>{this._logger.error("WebSocket error occurred",a.error),e.close(4202)}}catch(t){const n=t instanceof Error?t:new Error;this._logger.error("Failed to create WebSocket instance",n),this.reconnect();return}e.onopen=()=>{this._logger.debug("Connected to signaling-server")},e.onclose=t=>{const n="Close event fired: "+JSON.stringify({code:t.code,reason:t.reason,type:t.type});if(4100<=t.code&&t.code<=4199?this._logger.error(n,new Error):this._logger.debug(n),t.code!==1e3&&!(4e3<=t.code&&t.code<=4199)){this.reconnect();return}t.code!==4e3&&(this._logger.debug("Closed the connection to signaling-server"),this.onConnectionFailed.emit(),this.destroy())},e.onmessage=t=>{this._messageHandler(t.data)},this._ws=e}updateAuthToken(e){this._token=e}reconnect(){if(this._ws!==void 0&&this._ws.close(4e3),this._ws=void 0,this._isOpen=!1,this._reconnectCount>=8)this.onConnectionFailed.emit(),this.destroy(),this._logger.error("Failed to reconnect for eight times",new Error);else{this._setConnectionState("reconnecting");const e=j6(this._reconnectCount);this._reconnectTimer=setTimeout(()=>{this._connect(),this._reconnectCount++,this._logger.debug(`Try to reconnect: count = ${this._reconnectCount}`)},e)}}destroy(){this._isDestroyed=!0,this._setConnectionState("closed"),this.onConnectionStateChanged.removeAllListeners(),this.onOpened.removeAllListeners(),this.onEventReceived.removeAllListeners(),this.onConnectionFailed.removeAllListeners(),this._reconnectTimer&&clearTimeout(this._reconnectTimer),this._ws!==void 0&&this._ws.close(1e3)}send(e){return new Promise((t,n)=>{const r=()=>{this.onOpened.addOneTimeListener(()=>{this.send(e).then(()=>{t()}).catch(i=>{n(i)})}),this.onConnectionFailed.addOneTimeListener(()=>{n(new Error("Connection failed"))})};if(this._isDestroyed){n(new Error("The socket is already destroyed"));return}if(this._ws===void 0||!this._isOpen){this._logger.debug("Retry send the client event when connected because WebSocket is undefined or isOpen = false"),r();return}this._logger.debug(`Send the event: ${e.data}`),this._ws.send(e.data,i=>{if(i){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==_1.default.OPEN){this._logger.debug("Retry send the client event when connected because WebSocket.send failed"),r();return}n(i)}else t()})})}_messageHandler(e){if(typeof e!="string"){this._logger.error("Received invalid message: not string",new Error);return}let t;try{t=JSON.parse(e)}catch(n){const r=n instanceof Error?n:new Error;this._logger.error("Received invalid message: parse error",r);return}if(!U6(t)){this._logger.error(`Received invalid message: ${t}`,new Error);return}t.event==="open"?(this._logger.debug("Received a open event"),this._isOpen=!0,this._setConnectionState("connected"),this._reconnectCount!==0&&(this._reconnectCount=0,this._logger.debug("Succeeded to reconnect")),this.onOpened.emit()):(this._logger.debug(`Received the event: ${t.event}, payload: ${JSON.stringify(t.payload)}`),this.onEventReceived.emit(t))}};function U6(e){return!(!e||typeof e!="object"||typeof e.event!="string"||!L6.includes(e.event)||typeof e.eventId!="string"||e.payload&&typeof e.payload!="object")}var b1="signaling.skyway.ntt.com",H6="v1",V6=class{constructor({token:e,channelId:t,channelName:n,memberId:r,memberName:i},a){this.onConnectionStateChanged=new Aa,this.onConnectionFailed=new Aa,this.onRequested=new Aa,this._connectivityCheckTimers=new Map,this._responseCallbacks=new Map,this._acknowledgeCallbacks=new Map,this._token=e,this._channelId=t,this._channelName=n,this._memberId=r,this._memberName=i;const o={connectivityCheckIntervalSec:30,signalingServerDomain:b1,secure:!0,logger:{debug:u=>{console.debug(u)},error:u=>{console.error(u)}}};this._options=Object.assign({},o,a??{}),this._logger=this._options.logger,this._logger.debug(`Created instance with the options: ${this._options}`)}get connectionState(){var e,t;return(t=(e=this._socket)==null?void 0:e.connectionState)!=null?t:"closed"}connect(){return H(this,null,function*(){const e=this._options.secure?"wss":"ws",t=this._options.signalingServerDomain||b1;this._socket=new B6({sessionEndpoint:`${e}://${t}/${H6}/ws`,channelId:this._channelId,channelName:this._channelName,memberId:this._memberId,memberName:this._memberName,token:this._token,logger:this._logger}),this._socket.onEventReceived.addListener(n=>{try{this._eventReceivedHandler(n)}catch(r){this._logger.error("in _eventReceivedHandler",r)}}),this._socket.onConnectionFailed.addListener(()=>{this.onConnectionFailed.emit()}),this._socket.onConnectionStateChanged.addListener(n=>{this.onConnectionStateChanged.emit(n)}),yield this._socket.onOpened.asPromise(15*1e3),this._startConnectivityCheck()})}disconnect(){var e;this._stopConnectivityCheck(),(e=this._socket)==null||e.destroy(),this._socket=void 0,this._responseCallbacks.clear(),this._acknowledgeCallbacks.clear()}_startConnectivityCheck(){if(this._connectivityCheckInterval){this._logger.debug("connectivity check timer is already set");return}this._connectivityCheckInterval=setInterval(()=>{var e;const t=new _u("checkConnectivity");(e=this._socket)==null||e.send(t).catch(()=>{this._acknowledgeCallbacks.delete(t.eventId)}),this._connectivityCheckTimers.set(t.eventId,setTimeout(()=>{var n;this._acknowledgeCallbacks.delete(t.eventId),(n=this._socket)==null||n.reconnect(),this._logger.debug("connectivity check timer is expired")},5*1e3)),this._setAcknowledgeCallback(t.eventId,n=>{var r;const i=this._connectivityCheckTimers.get(t.eventId);i&&(clearTimeout(i),this._connectivityCheckTimers.delete(t.eventId)),n.ok||((r=this._socket)==null||r.reconnect(),this._logger.debug("connectivity check response from server was not ok"))})},this._options.connectivityCheckIntervalSec*1e3),this._logger.debug("Started connectivity check timer")}_stopConnectivityCheck(){if(!this._connectivityCheckInterval){this._logger.debug("connectivity check timer is not set");return}clearInterval(this._connectivityCheckInterval),this._connectivityCheckInterval=void 0,this._logger.debug("Stopped connectivity check timer");for(const[e,t]of this._connectivityCheckTimers)clearTimeout(t);this._connectivityCheckTimers.clear()}request(e,t,n=10){return q6(e),S1(t),new Promise((r,i)=>{if(this._socket===void 0){i(new Error("websocket is not connected"));return}const a={dst:e,data:t},o=new _u("sendRequestSignalingMessage",a),u=setTimeout(()=>{this._acknowledgeCallbacks.delete(o.eventId),i(new Error("request timeout"))},n*1e3);this._setResponseCallback(o.eventId,p=>{clearTimeout(u),r(p)}),this._setAcknowledgeCallback(o.eventId,p=>{p.ok||(clearTimeout(u),i(p))}),this._socket.send(o).catch(p=>{this._acknowledgeCallbacks.delete(o.eventId),clearTimeout(u),i(p)})})}_response(e,t,n,r){return new Promise((i,a)=>{if(S1(n),this._socket===void 0){a(new Error("websocket is not connected"));return}const o={dst:e,requestEventId:t,data:n},u=new _u("sendResponseSignalingMessage",o),p=setTimeout(()=>{this._acknowledgeCallbacks.delete(u.eventId),a(new Error("response timeout"))},r*1e3);this._setAcknowledgeCallback(u.eventId,h=>{clearTimeout(p),h.ok?i():a(h)}),this._socket.send(u).catch(h=>{this._acknowledgeCallbacks.delete(u.eventId),clearTimeout(p),a(h)})})}updateSkyWayAuthToken(e,t=10){return new Promise((n,r)=>{if(this._socket===void 0){r(new Error("websocket is not connected"));return}const i={token:e},a=new _u("updateSkyWayAuthToken",i),o=setTimeout(()=>{this._acknowledgeCallbacks.delete(a.eventId),r(new Error("updateSkyWayAuthToken timeout"))},t*1e3);this._setAcknowledgeCallback(a.eventId,u=>{if(clearTimeout(o),u.ok){if(this._socket===void 0){r(new Error("websocket is not connected"));return}this._socket.updateAuthToken(e),n()}else r(u)}),this._socket.send(a).catch(u=>{this._acknowledgeCallbacks.delete(a.eventId),clearTimeout(o),r(u)})})}_eventReceivedHandler(e){switch(e.event){case"acknowledge":this._acknowledgeHandler(e.payload);break;case"sendRequestSignalingMessage":this._eventMessageRequestHandler(e.payload);break;case"sendResponseSignalingMessage":this._eventMessageResponseHandler(e.payload);break;case"open":break;default:e.event,this._logger.debug(`Unknown event: ${e.event}`)}}_acknowledgeHandler(e){if(!O6(e))throw new Error("Invalid payload");const{eventId:t}=e;if(!this._acknowledgeCallbacks.has(t))throw new Error(`acknowledge event has unknown eventId: ${t}`);const n=this._acknowledgeCallbacks.get(t);n&&(this._acknowledgeCallbacks.delete(t),n(e))}_eventMessageRequestHandler(e){if(!y1(e))throw new Error("Invalid payload");if(!e.requestEventId)throw new Error("Invalid payload");const t=e.src,n=e.requestEventId,r=(i,a=10)=>H(this,null,function*(){yield this._response(t,n,i,a)});this.onRequested.emit({data:e.data,reply:r,requestEventId:e.requestEventId,src:e.src})}_eventMessageResponseHandler(e){if(!y1(e))throw new Error("Invalid payload");if(!e.requestEventId||!this._responseCallbacks.has(e.requestEventId))throw new Error(`received response has unknown eventId: ${e.requestEventId}`);const t=this._responseCallbacks.get(e.requestEventId);t&&(this._responseCallbacks.delete(e.requestEventId),t(e.data))}_setResponseCallback(e,t){this._responseCallbacks.set(e,t)}_setAcknowledgeCallback(e,t){this._acknowledgeCallbacks.set(e,t)}};function S1(e){if(!e||typeof e!="object")throw new Error("the type of data must be object")}function q6(e){if(!Lb(e))throw new Error("the type of target must be {id: string, name: string}");if(!DE(e.id))throw new Error("the type of target.id must be uuid format")}Y();var oi=new ze("packages/core/src/external/signaling.ts");function z6(e,t,n){return H(this,null,function*(){const{signalingService:r}=e.config,i=new V6({token:e.authTokenString,channelId:t.id,channelName:t.name,memberId:n.id,memberName:n.name},{logger:{error:o=>H(null,null,function*(){oi.error("SignalingClient error",De({operationName:"SignalingClient.logger",context:e,info:Se(ie({},Ue.internal),{detail:"signalingClient error"}),error:o,path:oi.prefix,channel:t}))}),debug:o=>{}},signalingServerDomain:r.domain,secure:r.secure}),a=new K6(i,e);return yield a.connect(),a})}var K6=class{constructor(e,t){this._client=e,this.context=t,this.onConnectionFailed=new We,this.onConnectionStateChanged=new We,this.onMessage=new We,this.closed=!1,this._chunkedMessageBuffer={},this._backoffUpdateSkyWayAuthToken=new ki({times:8,interval:100,jitter:100}),this._disposer=new ei,this._listen(),t._onTokenUpdated.add(n=>H(this,null,function*(){yield this._updateSkyWayAuthToken(n)})).disposer(this._disposer)}updateClient(e){this._client=e,this._listen()}_listen(){this._client.onConnectionFailed.addOneTimeListener(()=>{this.onConnectionFailed.emit({})}),this._client.onConnectionStateChanged.addListener(e=>{oi.debug("signalingClient onConnectionStateChanged",e),this.onConnectionStateChanged.emit(e)}),this._client.onRequested.addListener(e=>H(this,[e],function*({data:t,src:n,reply:r}){var i;const a=t,{chunk:o,length:u,offset:p,id:h,type:g}=a;if(g===Ap){if(u===0)this.onMessage.emit({src:n,data:JSON.parse(o)});else if(this._chunkedMessageBuffer[h]=[...(i=this._chunkedMessageBuffer[h])!=null?i:[],a.chunk],u===p){const f=this._chunkedMessageBuffer[h].join("");delete this._chunkedMessageBuffer[h],this.onMessage.emit({src:n,data:JSON.parse(f)})}yield r({}).catch(f=>{this.closed||oi.warn("failed to reply",Ln({operationName:"SignalingSession.reply",detail:"SignalingClient failed to reply"}),f)})}}))}_updateSkyWayAuthToken(e){return H(this,null,function*(){if(this._backoffUpdateSkyWayAuthToken.exceeded){oi.error("[failed] updateSkyWayAuthToken");return}yield this._backoffUpdateSkyWayAuthToken.wait(),oi.debug("[start] updateSkyWayAuthToken",{count:this._backoffUpdateSkyWayAuthToken.count});const t=yield this._client.updateSkyWayAuthToken(e).catch(n=>n);if(t){oi.warn("[retry] updateSkyWayAuthToken",Ln({operationName:"SignalingSession._updateSkyWayAuthToken",detail:"[retry] updateSkyWayAuthToken"}),t),yield this._updateSkyWayAuthToken(e);return}oi.debug("[end] updateSkyWayAuthToken"),this._backoffUpdateSkyWayAuthToken.reset()})}get connectionState(){return this._client.connectionState}connect(){return H(this,null,function*(){oi.debug("[start] connect signalingService"),yield this._client.connect().catch(e=>{throw De({operationName:"signalingSession.connect",path:oi.prefix,info:Se(ie({},Ue.internal),{detail:"signalingClient failed to connect Server"}),context:this.context,error:e})}),oi.debug("[end] connect signalingService")})}close(){this.closed=!0,this._disposer.dispose(),this._client.disconnect()}send(e,t,n=1e4){return H(this,null,function*(){var r;try{const i=JSON.stringify(t),a=Wo();if(i.length>20480){const o=(r=i.match(/.{1,20480}/g))!=null?r:[];let u=0;for(const p of o){const h={type:Ap,length:o.length-1,offset:u++,chunk:p,id:a};yield this._client.request(e,h,n/1e3)}}else{const o={type:Ap,length:0,offset:0,chunk:i,id:a};yield this._client.request(e,o,n/1e3)}}catch(i){if(this.closed||e.state!=="joined")return;throw De({operationName:"SignalingSession.send",context:this.context,info:Se(ie({},Ue.internal),{detail:"signalingClient"}),error:i,path:oi.prefix,payload:{target:e,data:t}})}})}},Ap="signalingMessage",w1=new ze("packages/core/src/member/person/local/factory.ts");function $6(e,t,n){return H(this,arguments,function*(r,i,a,{keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p,disableSignaling:h}={}){var g;w1.debug("createLocalPerson",{channel:i,memberDto:a,keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p});const{iceParamServer:f}=r.config,_=h===!0?void 0:yield z6(r,i,a),w=new F6(Se(ie({},f),{memberId:a.id,channelId:i.id,ttl:I6,context:r}));yield w.updateIceParams().catch(R=>{throw De({operationName:"createLocalPerson",context:r,channel:i,info:Se(ie({},Ue.internal),{detail:"updateIceParams failed"}),path:w1.prefix,error:R})});const C=yield W6.Create({iceManager:w,channel:i,signaling:_,analytics:r.analyticsSession,metadata:a.metadata,name:a.name,id:a.id,keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p,context:r});for(const R of r.plugins)yield(g=R._whenCreateLocalPerson)==null?void 0:g.call(R,C),C._onDisposed.once(()=>H(null,null,function*(){var S;yield(S=R._whenDisposeLocalPerson)==null?void 0:S.call(R,C)}));return C})}var pt=new ze("packages/core/src/member/localPerson/index.ts"),W6=class jb extends vh{constructor(t){super(t),this.args=t,this.type="person",this.subtype="person",this.side="local",this.keepaliveIntervalSec=this.args.keepaliveIntervalSec,this.keepaliveIntervalGapSec=this.args.keepaliveIntervalGapSec,this.preventAutoLeaveOnBeforeUnload=this.args.preventAutoLeaveOnBeforeUnload,this.disableSignaling=this.args.disableSignaling,this.disableAnalytics=this.args.disableAnalytics,this.config=this.context.config,this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onFatalError=this._events.make(),this._onStreamSubscribeFailed=this._events.make(),this._onDisposed=this._events.make(),this._disposer=new ei,this._subscribing={},this._requestQueue=new ua,this.iceManager=this.args.iceManager,this._disposed=!1,this._publishingAgent=new R6(this),this._subscribingAgent=new A6(this),this._signaling=t.signaling,this._analytics=t.analytics,this._listenChannelEvent(),this._listenBeforeUnload()}static Create(...t){return H(this,null,function*(){const n=new jb(...t);return yield n._setupTtlTimer(),n._analytics&&n._analytics.client.sendJoinReport({memberId:n.id}),n})}_listenChannelEvent(){this.channel.onPublicationSubscribed.add(t=>H(this,[t],function*({subscription:n}){yield this._handleOnPublicationSubscribe(n).catch(r=>pt.error("_handleOnStreamSubscribe",r))})).disposer(this._disposer),this.channel.onPublicationUnsubscribed.add(t=>H(this,[t],function*({subscription:n}){yield this._handleOnPublicationUnsubscribe(n).catch(r=>pt.error("_handleOnStreamUnsubscribe",r))})).disposer(this._disposer),this.channel._onDisposed.once(()=>{this.dispose()}),this.onLeft.once(()=>{this.dispose()})}_setupTtlTimer(){return H(this,null,function*(){const{keepaliveIntervalSec:t,keepaliveIntervalGapSec:n}=this;if(t==null||(pt.debug("_setupTtlTimer",this.toJSON(),{keepaliveIntervalSec:t,keepaliveIntervalGapSec:n}),t===-1))return;const r=()=>H(this,null,function*(){if(this._disposed)return;const i=yield this.context._api.getServerUnixtimeInSec();this.ttlSec=Math.floor(i+t+(n??0));try{yield this.channel._updateMemberTtl(this.id,this.ttlSec),pt.debug("updateTtl",this.toJSON(),{now:i,ttlSec:this.ttlSec,keepaliveIntervalSec:t??0,keepaliveIntervalGapSec:n??0,diff:this.ttlSec-i})}catch(a){if(this._disposed)return;throw a}});yield r(),this.ttlInterval=setInterval(()=>H(this,null,function*(){yield r().catch(i=>{this._disposed||(this.onFatalError.emit(De({operationName:"localPerson._setupTtlTimer",path:pt.prefix,info:Se(ie({},Ue.internal),{detail:"updateMemberTtl failed"}),channel:this.channel,context:this.context,error:i})),this.dispose())})}),t*1e3)})}_listenBeforeUnload(){if(window&&!this.preventAutoLeaveOnBeforeUnload){const t=()=>H(this,null,function*(){window.removeEventListener("beforeunload",t),this.state==="joined"&&(pt.debug("leave by beforeunload",this.toJSON()),yield this.leave())});window.addEventListener("beforeunload",t)}}_handleOnPublicationSubscribe(t){return H(this,null,function*(){var n;if(t.subscriber.id===this.id)try{const r=pt.info("[start] startSubscribing",yield Ct({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t}),i=(n=this._subscribing[t.publication.id])==null?void 0:n.options;i&&(t.preferredEncoding=i.preferredEncodingId),yield this._subscribingAgent.startSubscribing(t),this.onPublicationSubscribed.emit({subscription:t,stream:t.stream}),this.onSubscriptionListChanged.emit(),pt.elapsed(r,"[end] startSubscribing",yield Ct({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t})}catch(r){throw this._onStreamSubscribeFailed.emit({error:r,subscription:t}),r}if(t.publication.publisher.id===this.id){if(t.subscriber.id===this.id)throw De({operationName:"localPerson._handleOnStreamSubscribe",path:pt.prefix,info:Se(ie({},Ue.internal),{detail:"can not subscribe own Publication"}),channel:this.channel,context:this.context});const r=pt.info("[start] startPublishing",yield Ct({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t});yield this._publishingAgent.startPublishing(t).catch(i=>{throw pt.error("[failed] startPublishing",i,{subscription:t}),i}),pt.elapsed(r,"[end] startPublishing",yield Ct({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t})}})}_handleOnPublicationUnsubscribe(t){return H(this,null,function*(){if(t.publication.publisher.id===this.id){const n=pt.info("[start] stopPublishing",yield Ct({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t});yield this._publishingAgent.stopPublishing(t.publication,t.subscriber).catch(r=>{throw pt.error("[failed] stopPublishing",r,{subscription:t}),r}),pt.elapsed(n,"[end] stopPublishing",yield Ct({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t})}if(t.subscriber.id===this.id){const n=pt.info("[start] stopSubscribing",yield Ct({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t});yield this._subscribingAgent.stopSubscribing(t).catch(r=>{throw pt.error("[failed] stopSubscribing",{subscription:t},r),r}),this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit(),pt.elapsed(n,"[end] stopSubscribing",yield Ct({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t})}})}publish(t){return H(this,arguments,function*(n,r={}){var i,a,o,u;const p=pt.info("[start] publish",yield Ct({operationName:"localPerson.publish",channel:this.channel}),{options:r});if(this.state!=="joined")throw De({operationName:"localPerson.publish",info:Ue.localPersonNotJoinedChannel,path:pt.prefix,channel:this.channel,context:this.context});if(n.published)throw De({operationName:"localPerson.publish",channel:this.channel,context:this.context,info:Ue.alreadyPublishedStream,path:pt.prefix});n.published=!0,r.codecCapabilities&&(r.codecCapabilities=r.codecCapabilities.filter(_=>_!=null));const h={metadata:r.metadata,publisher:this.id,channel:this.channel.id,contentType:n.contentType,codecCapabilities:(i=r.codecCapabilities)!=null?i:[],isEnabled:r.isEnabled};n.contentType==="video"&&h.codecCapabilities.length===0&&(h.codecCapabilities=[{mimeType:"video/vp8"}]),r.encodings&&r.encodings.length>0&&(h.encodings=Qf(Mb(r.encodings)));const g=yield this._requestQueue.push(()=>this.channel._publish(h).catch(_=>{throw De({operationName:"localPerson.publish",context:this.context,channel:this.channel,info:_.info,path:pt.prefix,error:_})}));n.contentType==="data"?n.setIsEnabled(g.isEnabled):yield n.setEnabled(g.isEnabled);const f=this.channel._addPublication(g);if(f._setStream(n),(a=h.codecCapabilities)!=null&&a.length&&f.setCodecCapabilities(h.codecCapabilities),(o=h.encodings)!=null&&o.length&&f.setEncodings(h.encodings),yield this._handleOnStreamPublish(f),pt.elapsed(p,"[end] publish",yield Ct({operationName:"localPerson.publish",channel:this.channel}),{publication:f}),["video","audio"].includes(f.contentType)&&this._analytics&&!this._analytics.isClosed()){this._analytics.client.sendMediaDeviceReport({publicationId:f.id,mediaDeviceName:f.deviceName,mediaDeviceTrigger:"publish",updatedAt:Date.now()});const _=(u=h.encodings)!=null?u:[];this._analytics.client.sendPublicationUpdateEncodingsReport({publicationId:f.id,encodings:_,updatedAt:Date.now()})}return f})}_handleOnStreamPublish(t){return H(this,null,function*(){pt.info("onStreamPublished",yield Ct({operationName:"onStreamPublished",channel:this.channel})),this.onStreamPublished.emit({publication:t}),this.onPublicationListChanged.emit()})}unpublish(t){return H(this,null,function*(){const n=pt.info("[start] unpublish",yield Ct({operationName:"localPerson.unpublish",channel:this.channel})),r=typeof t=="string"?t:t.id;if(this.state!=="joined")throw De({operationName:"localPerson.unpublish",info:Ue.localPersonNotJoinedChannel,path:pt.prefix,context:this.context,channel:this.channel});const i=this.channel._getPublication(r);if(!i)throw De({operationName:"localPerson.unpublish",info:Ue.publicationNotExist,path:pt.prefix,context:this.context,channel:this.channel,payload:{publicationId:r}});i.stream&&i.stream._unpublished(),yield this._requestQueue.push(()=>this.channel._unpublish(r)),i.subscriptions.map(a=>a.subscriber).forEach(a=>{T6(a)&&this._publishingAgent.stopPublishing(i,a).catch(o=>{pt.error("[failed] stopPublishing",o,{publication:i})})}),yield this._handleOnStreamUnpublished(i),pt.elapsed(n,"[end] unpublish",yield Ct({operationName:"localPerson.unpublish",channel:this.channel}),{publication:i})})}_handleOnStreamUnpublished(t){return H(this,null,function*(){pt.info("onStreamUnpublished",yield Ct({operationName:"onStreamUnpublished",channel:this.channel})),this.onStreamUnpublished.emit({publication:t}),this.onPublicationListChanged.emit()})}subscribe(t){return H(this,arguments,function*(n,r={}){const i=pt.info("[start] subscribe",yield Ct({operationName:"localPerson.subscribe",channel:this.channel}),{target:n}),a=typeof n=="string"?n:n.id;if(this.state!=="joined")throw De({operationName:"localPerson.subscribe",info:Ue.localPersonNotJoinedChannel,path:pt.prefix,context:this.context,channel:this.channel,payload:{target:n}});const o=this.channel._getPublication(a);if(o==null)throw De({operationName:"localPerson.subscribe",info:Ue.publicationNotExist,path:pt.prefix,context:this.context,channel:this.channel,payload:o});this._validatePublicationForSubscribe(o),this._subscribing[o.id]={options:r,processing:!0};const u=this._subscribing[o.id];try{const p=yield this._requestQueue.push(()=>this.channel._subscribe(this.id,a));pt.elapsed(i,"[elapsed] subscribe / subscriptionDto received",{subscriptionDto:p});const h=this.channel._addSubscription(p);return h.stream||(yield Promise.race([new Promise((g,f)=>{this.onPublicationSubscribed.watch(({subscription:_})=>_.publication.id===a,this.context.config.rtcApi.timeout).then(g).catch(_=>H(this,null,function*(){u.processing&&f(De({operationName:"localPerson.subscribe",info:Se(ie({},Ue.timeout),{detail:"failed to subscribe publication. maybe publisher already left room"}),path:pt.prefix,context:this.context,channel:this.channel,payload:{subscription:h,publication:o},error:_}))}))}),new Promise((g,f)=>{this.channel.onMemberLeft.watch(_=>_.member.id===o.publisher.id,this.context.config.rtcApi.timeout+1e3).then(()=>{u.processing&&f(De({operationName:"localPerson.subscribe",info:Se(ie({},Ue.internal),{detail:"failed to subscribe publication. publisher already left room"}),path:pt.prefix,context:this.context,channel:this.channel,payload:{subscription:h,publication:o}}))}).catch(g)}),new Promise((g,f)=>{this._onStreamSubscribeFailed.watch(_=>_.subscription.publication.id===o.id,this.context.config.rtcApi.timeout+1e3).then(_=>{var w,C;if(u.processing){const R=(C=(w=_==null?void 0:_.error)==null?void 0:w.info)!=null?C:Se(ie({},Ue.internal),{detail:"subscribe _onStreamSubscribeFailed"});f(De({operationName:"localPerson.subscribe",info:R,path:pt.prefix,context:this.context,channel:this.channel,error:_.error,payload:{subscription:h,publication:o}}))}}).catch(g)})])),u.processing=!1,pt.elapsed(i,"[end] subscribe",yield Ct({operationName:"localPerson.subscribe",channel:this.channel}),{subscription:h,publication:o}),{subscription:h,stream:h.stream}}catch(p){throw u.processing=!1,pt.warn("[failed] subscribe",p,{publication:o}),p}})}_validatePublicationForSubscribe(t){if(t.publisher.id===this.id)throw De({operationName:"localPerson._validatePublicationForSubscribe",info:Ue.publicationNotExist,path:pt.prefix,context:this.context,channel:this.channel,payload:{publication:t}});if(t.publisher instanceof cb)throw De({operationName:"localPerson._validatePublicationForSubscribe",info:Ue.unknownMemberType,path:pt.prefix,context:this.context,channel:this.channel,payload:{publication:t}});if(this.subscriptions.find(n=>n.publication.id===t.id))throw De({operationName:"localPerson._validatePublicationForSubscribe",info:Ue.alreadySubscribedPublication,path:pt.prefix,context:this.context,channel:this.channel,payload:{publication:t}})}unsubscribe(t){return H(this,null,function*(){const n=pt.info("[start] unsubscribe",yield Ct({operationName:"localPerson.unsubscribe",channel:this.channel})),r=typeof t=="string"?t:t.id;if(this.state!=="joined")throw De({operationName:"localPerson.unsubscribe",info:Ue.localPersonNotJoinedChannel,path:pt.prefix,context:this.context,channel:this.channel});const i=this.subscriptions.find(a=>a.id===r);if(!i)throw De({operationName:"localPerson.unsubscribe",info:Ue.subscriptionNotExist,path:pt.prefix,context:this.context,channel:this.channel,payload:{subscriptionId:r}});delete this._subscribing[i.publication.id],yield this._requestQueue.push(()=>this.channel._unsubscribe(r)),pt.elapsed(n,"[end] unsubscribe",yield Ct({operationName:"localPerson.unsubscribe",channel:this.channel}),{subscription:i})})}_getConnections(){return this.channel.members.map(r=>r._getConnection(this.id)).filter(r=>(r==null?void 0:r.closed)===!1)}dispose(){this._disposed||(this._disposed=!0,pt.debug("disposed",this.toJSON()),clearInterval(this.ttlInterval),this._signaling&&this._signaling.close(),this._analytics&&this._analytics.close(),this._getConnections().forEach(t=>t.close({reason:"localPerson disposed"})),this._onDisposed.emit(),this._events.dispose(),this._disposer.dispose())}};Y();Y();var Gi=new ze("packages/core/src/subscription/index.ts"),G6=class{constructor(e){this._disposer=new ei,this._state="enabled",this.onCanceled=new We,this.onStreamAttached=new We,this.onConnectionStateChanged=new We,this._onChangeEncoding=new We,this.cancel=()=>new Promise((t,n)=>{let r=!1;this._channel._unsubscribe(this.id).catch(i=>{r=!0,n(i)}),this.onCanceled.asPromise(this._context.config.rtcApi.timeout).then(()=>t()).catch(i=>{r||n(i)})}),this._channel=e.channel,this._context=this._channel._context,this.id=e.id,this.contentType=e.contentType,this.subscriber=e.subscriber,this.publication=e.publication,Gi.debug("subscription spawned",this.toJSON()),this._handlePublicationEnabled()}get state(){return this._state}_handlePublicationEnabled(){this.publication.onDisabled.add(()=>{this.stream&&(Gi.debug("disabled",this),this.stream.setIsEnabled(!1))}).disposer(this._disposer),this.publication.onEnabled.add(()=>{this.stream&&(Gi.debug("enabled",this),this.stream.setIsEnabled(!0))}).disposer(this._disposer),this.stream&&this.stream.setIsEnabled(this.publication.state==="enabled")}_setStream(e){this._stream=e,this.onStreamAttached.emit(),e._onConnectionStateChanged.add(t=>{Gi.debug("onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit(t)})}get stream(){return this._stream}toJSON(){return{id:this.id,contentType:this.contentType,subscriber:this.subscriber,publication:this.publication,channelId:this._channel.id,state:this.state,stream:this.stream}}_canceled(){this._state="canceled",this.onCanceled.emit(),this._disposer.dispose()}changePreferredEncoding(e){if(!this.stream)throw De({operationName:"SubscriptionImpl.changePreferredEncoding",info:Ue.streamNotExistInSubscription,path:Gi.prefix,context:this._context,channel:this._channel});if(this.stream.contentType==="data")throw De({operationName:"SubscriptionImpl.changePreferredEncoding",info:Ue.dataStreamNotSupportEncoding,path:Gi.prefix,context:this._context,channel:this._channel});if(!this.publication.encodings.map(t=>t.id).includes(e))throw De({operationName:"SubscriptionImpl.changePreferredEncoding",info:Ue.correspondingEncodeNotExistForId,path:Gi.prefix,context:this._context,channel:this._channel});this.preferredEncoding=e,this._onChangeEncoding.emit()}getStats(){if(!this.stream)throw De({operationName:"SubscriptionImpl.getStats",info:Ue.streamNotExistInSubscription,path:Gi.prefix,context:this._context,channel:this._channel});return this.stream._getStats()}getRTCPeerConnection(){if(!this.stream)throw De({operationName:"SubscriptionImpl.getRTCPeerConnection",info:Ue.streamNotExistInSubscription,path:Gi.prefix,context:this._context,channel:this._channel});return this.stream._getRTCPeerConnection()}getConnectionState(){if(!this.stream)throw De({operationName:"SubscriptionImpl.getConnectionState",info:Ue.streamNotExistInSubscription,path:Gi.prefix,context:this._context,channel:this._channel});return this.stream._getConnectionState()}};function J6(e,{subscriberId:t,publicationId:n,id:r}){const i=e._getSubscription(r);if(i)return i;const o=e._getPublication(n).contentType;return new G6({channel:e,id:r,subscriber:e._getMember(t),publication:e._getPublication(n),contentType:o})}var en=new ze("packages/core/src/channel/index.ts"),Ip=class{constructor(e,t){this._context=e,this._channelImpl=t,this.id=this._channelImpl.id,this.name=this._channelImpl.name,this.appId=this._context.appId,this.disposed=!1,this.config=this._context.config,this._state="opened",this._api=this._context._api,this._members={},this._getMember=n=>this._members[n],this._publications={},this._getPublication=n=>this._publications[n],this._subscriptions={},this._getSubscription=n=>this._subscriptions[n],this._events=new ts,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this._onDisposed=this._events.make(),this.leave=n=>H(this,null,function*(){return this._channelImpl.leave(this.id,n.id)}),this.updateMetadata=n=>this._channelImpl.updateChannelMetadata(n),this.close=()=>new Promise((n,r)=>H(this,null,function*(){if(this.state==="closed"){r(De({operationName:"SkyWayChannelImpl.close",path:en.prefix,info:Ue.alreadyChannelClosed,channel:this,context:this._context,payload:this.toJSON()}));return}const i=en.info("[start] close channel",yield Ct({operationName:"SkyWayChannelImpl.close",channel:this}));try{yield this._channelImpl.close().catch(a=>{throw De({operationName:"SkyWayChannelImpl.close",context:this._context,info:Se(ie({},Ue.internal),{detail:"_api.deleteChannel failed"}),error:a,path:en.prefix,channel:this})}),this._state!=="closed"&&(yield this.onClosed.asPromise(this._context.config.rtcApi.timeout).catch(a=>{throw De({operationName:"SkyWayChannelImpl.close",context:this._context,info:Se(ie({},Ue.timeout),{detail:"channel.onClosed"}),error:a,path:en.prefix,channel:this})}))}catch(a){en.error(a.message,a),r(a)}en.elapsed(i,"[end] close channel",yield Ct({operationName:"SkyWayChannelImpl.close",channel:this})),n()})),this._updateMemberTtl=(n,r)=>this._channelImpl.updateMemberTtl(n,r),this._updateMemberMetadata=(n,r)=>this._channelImpl.updateMemberMetadata(n,r),this._publish=n=>this._channelImpl.publish(n),this._unpublish=n=>H(this,null,function*(){return this._channelImpl.unpublish(n)}),this._subscribe=(n,r)=>{const i=this._getPublication(r),a=this._getMember(n);if(a==null)throw De({operationName:"SkyWayChannelImpl._subscribe",path:en.prefix,info:Se(ie({},Ue.internal),{detail:"subscriber not found"}),channel:this,context:this._context,payload:{subscriberId:n,publicationId:r}});return this._channelImpl.subscribe({publication:i.toJSON(),subscriber:a.toJSON()})},this._unsubscribe=n=>H(this,null,function*(){if(!this._getSubscription(n))throw De({operationName:"SkyWayChannelImpl._unsubscribe",path:en.prefix,info:Se(ie({},Ue.internal),{detail:"can't unsubscribe not exist subscription"}),channel:this,context:this._context,payload:{subscriptionId:n}});yield this._channelImpl.unsubscribe(n)}),this._updatePublicationMetadata=(n,r)=>this._channelImpl.updatePublicationMetadata(n,r),this._disablePublication=n=>this._channelImpl.disablePublication(n),this._enablePublication=n=>this._channelImpl.enablePublication(n),this._setupPropertiesFromChannel(),this._setupListenChannelEvent(),e._onDisposed.once(()=>{this.dispose()}),en.debug("channel spawned",this.toJSON())}_addMember(e){const t=this._getMember(e.id);if(t)return t;const n=this._context._createRemoteMember(this,e);return this._members[n.id]=n,n}_removeMember(e){delete this._members[e]}_addPublication(e){const t=this._getPublication(e.id);if(t)return t;const n=k6(this,e);return this._publications[e.id]=n,n}_removePublication(e){delete this._publications[e]}_addSubscription(e){const t=this._getSubscription(e.id);if(t)return t;const n=J6(this,e);return this._subscriptions[e.id]=n,n}_removeSubscription(e){delete this._subscriptions[e]}get localPerson(){return this._localPerson}get members(){return Object.values(this._members)}get bots(){return this.members.filter(e=>e.type==="bot")}get publications(){return Object.values(this._publications)}get subscriptions(){return Object.values(this._subscriptions)}get metadata(){return this._channelImpl.metadata}get state(){return this._state}toJSON(){return{id:this.id,name:this.name,appId:this.appId,metadata:this.metadata,members:this.members,publications:this.publications,subscriptions:this.subscriptions}}_setupPropertiesFromChannel(){this._channelImpl.members.forEach(e=>{this._addMember(e)}),this._channelImpl.publications.forEach(e=>{this._addPublication(e)}),this._channelImpl.subscriptions.forEach(e=>{this._addSubscription(e)})}_setupListenChannelEvent(){this._channelImpl.onClosed.add(()=>this._handleOnChannelClose()),this._channelImpl.onMetadataUpdated.add(({channel:e})=>this._handleOnChannelMetadataUpdate(e.metadata)),this._channelImpl.onMemberJoined.add(({member:e})=>{this._handleOnMemberJoin(e)}),this._channelImpl.onMemberLeft.add(({member:e})=>{this._handleOnMemberLeft(e)}),this._channelImpl.onMemberListChanged.pipe(this.onMemberListChanged),this._channelImpl.onMemberMetadataUpdated.add(({member:e})=>{this._handleOnMemberMetadataUpdate(e,e.metadata)}),this._channelImpl.onStreamPublished.add(({publication:e})=>{this._handleOnStreamPublish(e)}),this._channelImpl.onStreamUnpublished.add(({publication:e})=>{this._handleOnStreamUnpublish(e)}),this._channelImpl.onPublicationListChanged.pipe(this.onPublicationListChanged),this._channelImpl.onPublicationMetadataUpdated.add(({publication:e})=>{this._handleOnPublicationMetadataUpdate(e,e.metadata)}),this._channelImpl.onPublicationEnabled.add(e=>H(this,[e],function*({publication:t}){return yield this._handleOnPublicationEnabled(t)})),this._channelImpl.onPublicationDisabled.add(e=>H(this,[e],function*({publication:t}){return yield this._handleOnPublicationDisabled(t)})),this._channelImpl.onPublicationSubscribed.add(({subscription:e})=>{this._handleOnStreamSubscribe(e)}),this._channelImpl.onPublicationUnsubscribed.add(({subscription:e})=>{this._handleOnStreamUnsubscribe(e)}),this._channelImpl.onSubscriptionListChanged.pipe(this.onSubscriptionListChanged)}_handleOnChannelClose(){this._state="closed",this.onClosed.emit({}),this.dispose()}_handleOnChannelMetadataUpdate(e){this.onMetadataUpdated.emit({metadata:e})}_handleOnMemberJoin(e){const t=this._addMember(e);this.onMemberJoined.emit({member:t})}_handleOnMemberLeft(e){var t;const n=this._getMember(e.id);this._removeMember(n.id),n._left(),((t=this.localPerson)==null?void 0:t.id)===e.id&&(this.localPerson._left(),this._localPerson=void 0),this.onMemberLeft.emit({member:n})}_handleOnMemberMetadataUpdate(e,t){var n;const r=this._getMember(e.id);r._metadataUpdated(t),((n=this.localPerson)==null?void 0:n.id)===e.id&&this.localPerson._metadataUpdated(t),this.onMemberMetadataUpdated.emit({member:r,metadata:t})}_handleOnStreamPublish(e){const t=this._addPublication(e);this.onStreamPublished.emit({publication:t})}_handleOnStreamUnpublish(e){const t=this._getPublication(e.id);this._removePublication(t.id),t._unpublished(),this.onStreamUnpublished.emit({publication:t})}_handleOnPublicationMetadataUpdate(e,t){const n=this._getPublication(e.id);n._updateMetadata(t),this.onPublicationMetadataUpdated.emit({publication:n,metadata:t})}_handleOnPublicationEnabled(e){return H(this,null,function*(){const t=this._getPublication(e.id);t._enable(),this.onPublicationEnabled.emit({publication:t})})}_handleOnPublicationDisabled(e){return H(this,null,function*(){const t=this._getPublication(e.id);yield t._disable(),this.onPublicationDisabled.emit({publication:t})})}_handleOnStreamSubscribe(e){const t=this._addSubscription(e);this._getPublication(t.publication.id)._subscribed(t),this.onPublicationSubscribed.emit({subscription:t})}_handleOnStreamUnsubscribe(e){const t=this._getSubscription(e.id);this._removeSubscription(t.id),t._canceled(),this._getPublication(t.publication.id)._unsubscribed(t),this.onPublicationUnsubscribed.emit({subscription:t})}join(){return H(this,arguments,function*(e={}){var t,n,r;const i=en.info("[start] join",yield Ct({operationName:"SkyWayChannelImpl.join",channel:this}));if(this._localPerson)throw De({operationName:"SkyWayChannelImpl.join",path:en.prefix,info:Ue.alreadyLocalPersonExist,channel:this,context:this._context});if(e.name!=null&&this.members.find(g=>g.name===e.name))throw De({operationName:"SkyWayChannelImpl.join",path:en.prefix,info:Ue.alreadySameNameMemberExist,channel:this,context:this._context,payload:e});(t=e.keepaliveIntervalSec)!=null||(e.keepaliveIntervalSec=this.config.member.keepaliveIntervalSec),(n=e.keepaliveIntervalGapSec)!=null||(e.keepaliveIntervalGapSec=this.config.member.keepaliveIntervalGapSec),(r=e.preventAutoLeaveOnBeforeUnload)!=null||(e.preventAutoLeaveOnBeforeUnload=this.config.member.preventAutoLeaveOnBeforeUnload);const a=Se(ie({},e),{type:"person",subtype:"person"});e.keepaliveIntervalSec!==null&&(a.ttlSec=(yield this._context._api.getServerUnixtimeInSec())+e.keepaliveIntervalSec);const o=yield this._channelImpl.joinChannel(a).catch(h=>{throw en.error("[failed] join",h),h});en.elapsed(i,"[elapsed] join / channelImpl.joinChannel",{member:o});const u=yield this._createLocalPerson(o,e),p=new g1(u);return en.elapsed(i,"[end] join",{person:u}),p})}moveChannel(e){return H(this,null,function*(){if(this._localPerson)throw De({operationName:"SkyWayChannelImpl.moveChannel",path:en.prefix,info:Ue.alreadyLocalPersonExist,channel:this,context:this._context});if(!(e instanceof g1))throw De({operationName:"SkyWayChannelImpl.moveChannel",path:en.prefix,info:Ue.invalidArgumentValue,channel:this,context:this._context});const t=e.channel;if(this.id===t.id)throw De({operationName:"SkyWayChannelImpl.moveChannel",path:en.prefix,info:Ue.cantMoveSameIdChannel,channel:this,context:this._context});yield t.leave(e);const n={name:e.name,type:e.type,subtype:e.subtype,metadata:e.metadata};e.keepaliveIntervalSec!=null&&(n.ttlSec=(yield this._context._api.getServerUnixtimeInSec())+e.keepaliveIntervalSec);const r=yield this._channelImpl.joinChannel(n),i=yield this._createLocalPerson(r,{keepaliveIntervalSec:e.keepaliveIntervalSec,keepaliveIntervalGapSec:e.keepaliveIntervalGapSec,disableSignaling:e.disableSignaling,disableAnalytics:e.disableAnalytics});e.apply(i)})}_createLocalPerson(e,t){return H(this,null,function*(){const n=yield $6(this._context,this,e,t);return this._localPerson=n,n})}dispose(){this.disposed||(this.disposed=!0,en.debug("disposed",this.toJSON()),this._channelImpl.dispose(),this._onDisposed.emit(),this._events.dispose())}},mg=class{static Create(e){return H(this,arguments,function*(t,n={}){const r=en.info("[start] createChannel",{operationName:"SkyWayChannel.Create"}),i=yield t._api.createChannel(n).catch(o=>{throw en.error("[failed] createChannel",o),o}),a=new Ip(t,i);return en.elapsed(r,"[end] createChannel"),a})}static Find(e,t){return H(this,null,function*(){const n=en.info("[start] findChannel",{operationName:"SkyWayChannel.Find"}),r=yield e._api.findChannel(t).catch(a=>{throw en.error("[failed] findChannel",a),a}),i=new Ip(e,r);return en.elapsed(n,"[end] findChannel"),i})}static FindOrCreate(e,t){return H(this,null,function*(){const n=en.info("[start] findOrCreateChannel",{operationName:"SkyWayChannel.FindOrCreate"}),r=yield e._api.findOrCreateChannel(t).catch(a=>{throw en.error("[failed] findOrCreateChannel",a),a}),i=new Ip(e,r);return en.elapsed(n,"[end] findOrCreateChannel"),i})}constructor(){}};Y();Y();var Z6=qr(u_()),X6=class{constructor(e={}){this.rtcApi={domain:"rtc-api.skyway.ntt.com",timeout:3e4,secure:!0,eventSubscribeTimeout:5e3},this.iceParamServer={domain:"ice-params.skyway.ntt.com",version:1,secure:!0},this.signalingService={domain:"signaling.skyway.ntt.com",secure:!0},this.analyticsService={domain:"analytics-logging.skyway.ntt.com",secure:!0},this.rtcConfig={timeout:3e4,turnPolicy:"enable",turnProtocol:"all",encodedInsertableStreams:!1,iceDisconnectBufferTimeout:5e3},this.token={updateReminderSec:30},this.log={level:"error",format:"string"},this.internal={disableDPlane:!1},this.member={keepaliveIntervalGapSec:30,keepaliveIntervalSec:30,preventAutoLeaveOnBeforeUnload:!1},Object.assign(this,(0,Z6.default)(this,e))}};Y();Y();Y();Y();Y();Y();var Q6="rtc-api.skyway.ntt.com",va=2e4,Y6=8;Y();var ur={timeout:{name:"timeout",detail:"",solution:""},internalError:{name:"internalError",detail:"",solution:""},invalidParameter:{name:"invalidParameter",detail:"",solution:""},connectionDisconnected:{name:"connectionDisconnected",detail:"",solution:""},websocketConnectionFailure:{name:"connectionFailure",detail:"サーバへの接続に失敗しました",solution:"ネットワーク接続状況およびフリープランをご利用の場合はリソース利用量を確認してください"},rpcResponseError:{name:"rpcResponseError",detail:"",solution:"",error:{}},onClosedWhileRequesting:{name:"onClosedWhileRequesting",detail:"request中にクライアントが終了されました",solution:"リクエストの完了を確認してからクライアントを終了させてください"},failedToConnectRtcAPI:{name:"failedToConnectRtcAPI",detail:"rtc-api serverへの接続に失敗しました",solution:"インターネット接続状況とTokenの内容が正しいか、またフリープランをご利用の場合はリソース利用量を確かめてください"},failedToUpdateMemberTTL:{name:"failedToUpdateMemberTTL",detail:"updateMemberTTLを再試行しましたが、失敗しました",solution:"インターネット接続状況を確認してください"}};Y();var eP=qr(tg());Y();function Or({operationName:e,info:t,error:n,path:r,payload:i,channelId:a,appId:o,memberId:u}){return new wr({error:n,info:t,payload:{payload:i,operationName:e,channelId:a,appId:o,memberId:u},path:r})}function Ci({appId:e,detail:t,channelId:n,operationName:r,payload:i,memberId:a}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n,memberId:a}}var Mn=new ze("packages/rtc-rpc-api-client/src/rpc.ts"),tP=4291,nP=class{constructor(){this._id=ji(),this.closed=!1,this.negotiated=!1,this._reconnecting=!1,this._pendingRequests=[],this._events=new ts,this._onMessage=this._events.make(),this.onNotify=this._events.make(),this.onFatalError=this._events.make(),this.onDisconnected=this._events.make(),this.onClosed=this._events.make(),this._send=e=>new Promise((t,n)=>H(this,null,function*(){if(yield new Promise(r=>setTimeout(r,0)),this._ws.readyState!==this._ws.OPEN){n(Or({operationName:"RPC._send",info:Se(ie({},ur.internalError),{detail:"wrong state"}),path:Mn.prefix,payload:{request:e,wsReadyState:x1[this._ws.readyState]}}));return}this._ws.send(JSON.stringify(e),r=>{if(r)throw n(Or({operationName:"RPC._send",info:Se(ie({},ur.internalError),{detail:"failed to send rpc message"}),path:Mn.prefix,error:r}))}),t()}))}set reconnecting(e){this._reconnecting=e}get reconnecting(){return this._reconnecting}connect(e){return H(this,arguments,function*({domain:t,token:n,secure:r}){const i=n;this._ws=new eP.default(`${r?"wss":"ws"}://${t}/ws`,i),this._ws.onmessage=o=>{this._onMessage.emit(JSON.parse(o.data))},this._ws.onclose=o=>H(this,null,function*(){Mn.debug("websocket closed",{id:this._id,code:o.code,reason:o.reason}),o.code===tP?this.close():this.onDisconnected.emit()}),this._onMessage.add(o=>{rP(o)&&this.onNotify.emit(o)});const a=yield new Promise((o,u)=>{const p=setTimeout(()=>{u(Or({operationName:"RPC.connect",info:Se(ie({},ur.timeout),{detail:"ws.open"}),path:Mn.prefix}))},5e3);this._ws.onerror=h=>{u(Or({operationName:"RPC.connect",info:ur.websocketConnectionFailure,path:Mn.prefix,error:h}))},this._ws.onopen=()=>{clearTimeout(p),o()}}).catch(o=>o);if(a)throw a;this.negotiated=!0})}close(){this.closed||(this.closed=!0,Mn.debug("closed"),this._ws.close(),this.onClosed.emit(),this._events.dispose())}resolvePendingRequests(){Mn.debug("resolve pendingRequests",[...this._pendingRequests]),this._pendingRequests.forEach(e=>H(this,null,function*(){yield this._send(e)})),this._pendingRequests=[]}request(e,t){return H(this,null,function*(){if(this.closed)throw Or({operationName:"RPC.request",info:Se(ie({},ur.internalError),{detail:"rpc closed"}),path:Mn.prefix,payload:{method:e,params:t,id:this._id}});let n=!1;try{const r=Fp(e,t),i=()=>H(this,null,function*(){return yield this._onMessage.watch(u=>u.id===r.id,va).catch(()=>{if(!n)throw Or({operationName:"RPC.request",info:Se(ie({},ur.timeout),{detail:"rpc request timeout"}),path:Mn.prefix,payload:{rpcTimeout:va,method:e,params:t,wsReadyState:x1[this._ws.readyState],id:this._id}})})}),a=()=>H(this,null,function*(){Mn.warn("[start] reconnecting. pending request",Ci({operationName:"RPC.request",detail:"[start] reconnecting. pending request",payload:{request:r,id:this._id}})),this._pendingRequests.push(r);const u=yield Promise.race([i(),this.onFatalError.asPromise(va+100).then(p=>{throw n||Mn.error("[failed] reconnecting. pending request",Or({operationName:"RPC.request",info:Se(ie({},ur.internalError),{detail:"onFatalError while request"}),path:Mn.prefix}),p),p})]);return n=!0,Mn.warn("[end] reconnecting. pending request",Ci({operationName:"RPC.request",detail:"[end] reconnecting. pending request",payload:{request:r,id:this._id}})),u});let o;if(this._reconnecting?o=yield a():(this._send(r).catch(u=>{Mn.error("send error",u)}),o=yield Promise.race([i(),H(this,null,function*(){if(yield this.onDisconnected.asPromise(va+100),n)return{};try{const u=yield a();return Mn.warn(Ci({operationName:"request.pendingRequest",detail:"success to handle disconnected"})),u}catch(u){throw Or({operationName:"RPC.request",info:ur.connectionDisconnected,path:Mn.prefix,error:u})}}),this.onFatalError.asPromise(va+100).then(u=>{if(n)return{};throw Or({operationName:"RPC.request",info:Se(ie({},ur.internalError),{detail:"onFatalError while requesting"}),path:Mn.prefix,error:u})}),this.onClosed.asPromise(va+100).then(()=>{if(n)return{};throw Or({operationName:"RPC.request",info:ur.onClosedWhileRequesting,path:Mn.prefix,payload:{method:e,params:t}})})]),n=!0),o.error)throw Mn.warn("[failed] request ",{message:o,method:e,params:t}),Or({operationName:"RPC.request",info:Se(ie({},ur.rpcResponseError),{detail:e,error:o.error}),payload:{message:o,method:e,params:t},path:Mn.prefix});return o.result}catch(r){throw n=!0,r}})}notify(e,t){return H(this,null,function*(){const n=Fp(e,t,!0);yield this._send(n)})}batch(e){return H(this,null,function*(){const t=e.map(({method:r,params:i})=>Fp(r,i));return this._send(t).catch(r=>{throw r}),yield Promise.all(t.map(r=>H(this,[r],function*({id:i}){return yield this._onMessage.watch(o=>o.id===i,va)})))})}},Fp=(e,t,n)=>{if(n)return{jsonrpc:"2.0",method:e,params:t};const r=ji();return{jsonrpc:"2.0",method:e,params:t,id:r}},rP=e=>{const t=e;return!!(t.method&&t.id==null)},x1=["CONNECTING","OPEN","CLOSING","CLOSED"],An=new ze("packages/rtc-rpc-api-client/src/client.ts"),C1,E1,iP=class{constructor(e){this.config=e,this.closed=!1,this._domain=(C1=this.config.domain)!=null?C1:Q6,this._secure=(E1=this.config.secure)!=null?E1:!0,this._token=this.config.token,this._rpc=new nP,this._subscribingChannelEvents=new Set,this._subscribingChannelVersions={},this._httpClient=new ug(`http${this.config.secure?"s":""}://${this.config.domain}`),this._reconnectCount=0,this._reconnectLimit=Y6,this._events=new ts,this.onEvent=this._events.make(),this.onFatalError=this._events.make(),this.onClose=this._events.make(),this.onReconnected=this._events.make();var t,n,r,i;ze.level=(n=(t=e.log)==null?void 0:t.level)!=null?n:ze.level,ze.format=(i=(r=e.log)==null?void 0:r.format)!=null?i:ze.format,An.debug("RtcRpcApiClient spawned",e),this._rpc.onNotify.add(a=>{if(a.method==="channelEventNotification"){const o=a.params;this._subscribingChannelVersions[o.data.channel.id]=o.data.channel.version,this.onEvent.emit({channelId:o.data.channel.id,event:o})}}),this._rpc.onDisconnected.add(()=>H(this,null,function*(){this._rpc.negotiated&&!this._rpc.closed&&!this._rpc.reconnecting&&(yield this._reconnect())})),this._rpc.onFatalError.once(a=>{An.error("fatal error",a),this.onFatalError.emit(a),this.close()})}get token(){return this._token}_reconnect(){return H(this,null,function*(){if(this._reconnectCount>=this._reconnectLimit){this._rpc.onFatalError.emit(Or({operationName:"RtcRpcApiClient._reconnect",info:{name:"failed to reconnect",detail:"_reconnectLimit exceeded",solution:""},path:An.prefix})),this.close();return}this._rpc.reconnecting=!0,An.warn("[start] reconnect",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect start",payload:{reconnectCount:this._reconnectCount,limit:this._reconnectLimit}})),this._reconnectCount++;const e=ws(this._reconnectCount,2)*100+ws(this._reconnectCount,2)*100*Math.random();yield new Promise(t=>setTimeout(t,e));try{yield this.connect().catch(t=>{throw An.warn("[failed] reconnect rtc api",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"connect rpc failed",payload:{reconnectCount:this._reconnectCount}}),t),t}),this._rpc.reconnecting=!1,this._reconnectCount=0,this._rpc.resolvePendingRequests(),yield Promise.all([...this._subscribingChannelEvents].map(t=>H(this,null,function*(){const[n,r]=t.split(":"),i=this._subscribingChannelVersions[r];yield this.subscribeChannelEvents({appId:n,channelId:r,offset:i})}))).catch(t=>{throw An.warn("subscribeChannelEvents failed",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"subscribeChannelEvents failed",payload:{reconnectCount:this._reconnectCount}}),t),t}),An.warn("[end] reconnect",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect finished",payload:{reconnectCount:this._reconnectCount}})),this.onReconnected.emit()}catch(t){An.warn("[failed] reconnect",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect failed",payload:{reconnectCount:this._reconnectCount}}),t),yield this._reconnect()}})}updateToken(e){return H(this,null,function*(){An.debug("token update",{token:e}),this._token=e,yield this._updateAuthToken()})}close(){this.closed||(this.closed=!0,An.debug("closed"),this._rpc.close(),this.onClose.emit(),this._events.dispose())}health(){return H(this,null,function*(){return yield this._httpClient.get("/health")})}connect(){return H(this,null,function*(){An.debug("connect to rtc api rpc",this._domain),yield this._rpc.connect({domain:this._domain,token:this.token,secure:this._secure}).catch(e=>{throw Or({operationName:"RtcRpcApiClient.connect",info:ur.failedToConnectRtcAPI,error:e,path:An.prefix})})})}_channelSubscribed(e,t){this._subscribingChannelEvents.add(e+":"+t),An.debug("_channelSubscribed",{appId:e,channelId:t,_subscribingChannelEvents:[...this._subscribingChannelEvents]})}_isSubscribingChannel(e,t){return this._subscribingChannelEvents.has(e+":"+t)}createChannel(e){return H(this,arguments,function*({name:t,metadata:n,appId:r}){const{channel:i}=yield this._rpc.request("createChannel",{name:t,metadata:n,appId:r,authToken:this.token});return this._channelSubscribed(r,i.id),i})}findOrCreateChannel(e){return H(this,arguments,function*({name:t,metadata:n,appId:r}){const{channel:i}=yield this._rpc.request("findOrCreateChannel",{name:t,metadata:n,appId:r,authToken:this.token});return this._channelSubscribed(r,i.id),i})}getChannel(e){return H(this,arguments,function*({appId:t,id:n}){const r=yield this._rpc.request("getChannel",{id:n,appId:t,authToken:this.token});return this._isSubscribingChannel(t,n)||(this._channelSubscribed(t,n),yield this.subscribeChannelEvents({appId:t,channelId:n,offset:r.channel.version})),r.channel})}getChannelByName(e){return H(this,arguments,function*({name:t,appId:n}){const r=yield this._rpc.request("getChannelByName",{name:t,appId:n,authToken:this.token}),i=r.channel.id;return this._isSubscribingChannel(n,i)||(this._channelSubscribed(n,i),yield this.subscribeChannelEvents({appId:n,channelId:i,offset:r.channel.version})),r.channel})}deleteChannel(e){return H(this,arguments,function*({id:t,appId:n}){yield this._rpc.request("deleteChannel",{id:t,appId:n,authToken:this.token})})}updateChannelMetadata(e){return H(this,arguments,function*({id:t,metadata:n,appId:r}){yield this._rpc.request("updateChannelMetadata",{id:t,metadata:n,appId:r,authToken:this.token})})}addMember(e){return H(this,arguments,function*({channelId:t,name:n,metadata:r,subscribeChannelEvents:i,appId:a,ttlSec:o,subtype:u,type:p}){return yield this._rpc.request("addMember",{channelId:t,name:n,metadata:r,subscribeChannelEvents:i,appId:a,ttlSec:o&&parseInt(o.toString()),authToken:this.token,subtype:u,type:p})})}updateMemberTtl(e){return H(this,arguments,function*(t,n=new ki({times:8})){const{appId:r,channelId:i,memberId:a,ttlSec:o}=t;try{yield this._rpc.request("updateMemberTtl",{appId:r,channelId:i,memberId:a,ttlSec:o&&parseInt(o.toString()),authToken:this.token})}catch(u){if(!n.exceeded)An.warn("retry updateMemberTtl",Ci({operationName:"RtcRpcApiClient.updateMemberTtl",detail:"retry updateMemberTtl",appId:r,channelId:i,memberId:a,payload:{backoff:n.count}}),u),yield n.wait(),yield this.updateMemberTtl(t,n);else throw new wr({path:An.prefix,info:ur.failedToUpdateMemberTTL,error:u})}})}updateMemberMetadata(e){return H(this,arguments,function*({channelId:t,memberId:n,metadata:r,appId:i}){yield this._rpc.request("updateMemberMetadata",{channelId:t,memberId:n,metadata:r,appId:i,authToken:this.token})})}leaveChannel(e){return H(this,arguments,function*({channelId:t,id:n,appId:r}){yield this._rpc.request("removeMember",{channelId:t,id:n,appId:r,authToken:this.token})})}publishStream(e){return H(this,arguments,function*({appId:t,channelId:n,publisherId:r,contentType:i,metadata:a,origin:o,codecCapabilities:u,encodings:p,isEnabled:h}){return{publicationId:(yield this._rpc.request("publishStream",{channelId:n,publisherId:r,contentType:i[0].toUpperCase()+i.slice(1),metadata:a,origin:o,codecCapabilities:u,encodings:p==null?void 0:p.map(f=>({id:f.id})),isEnabled:h,appId:t,authToken:this.token})).id}})}disablePublication(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("disablePublication",{channelId:t,appId:r,publicationId:n,authToken:this.token})})}enablePublication(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("enablePublication",{channelId:t,appId:r,publicationId:n,authToken:this.token})})}updatePublicationMetadata(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r,metadata:i}){yield this._rpc.request("updatePublicationMetadata",{channelId:t,publicationId:n,metadata:i,appId:r,authToken:this.token})})}unpublishStream(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("unpublishStream",{channelId:t,publicationId:n,appId:r,authToken:this.token})})}subscribeStream(e){return H(this,arguments,function*({channelId:t,subscriberId:n,publicationId:r,appId:i}){return{subscriptionId:(yield this._rpc.request("subscribeStream",{channelId:t,subscriberId:n,publicationId:r,appId:i,authToken:this.token})).id}})}unsubscribeStream(e){return H(this,arguments,function*({channelId:t,subscriptionId:n,appId:r}){yield this._rpc.request("unsubscribeStream",{channelId:t,subscriptionId:n,appId:r,authToken:this.token})})}getServerUnixtime(e){return H(this,arguments,function*(t,n=new ki({times:8})){const{appId:r}=t;try{return(yield this._rpc.request("getServerUnixtime",{appId:r,authToken:this.token})).unixtime}catch(i){if(n.exceeded)throw i;return An.warn(Ci({operationName:"RtcRpcApiClient.getServerUnixtime",detail:"retry getServerUnixtime",appId:r,payload:{backoff:n.count}}),i),yield n.wait(),this.getServerUnixtime(t,n)}})}_updateAuthToken(){return H(this,null,function*(){yield this._rpc.request("updateAuthToken",{authToken:this.token})})}subscribeChannelEvents(e){return H(this,arguments,function*({appId:t,channelId:n,offset:r}){try{An.debug("[start] subscribeChannelEvents",{offset:r}),yield this._rpc.request("subscribeChannelEvents",{appId:t,authToken:this.token,channelId:n,offset:r}),An.debug("[end] subscribeChannelEvents",{offset:r})}catch(i){if(i instanceof wr&&i.info.name===ur.connectionDisconnected.name)An.warn("reconnect happened while subscribeChannelEvents. retry",Ci({operationName:"RtcRpcApiClient.subscribeChannelEvents",detail:"reconnect happened while subscribeChannelEvents. retry",appId:t,channelId:n,payload:{offset:r}}),i),yield this.subscribeChannelEvents({appId:t,channelId:n,offset:r});else throw An.error("[failed] subscribeChannelEvents",Or({operationName:"RtcRpcApiClient.subscribeChannelEvents",info:Se(ie({},ur.internalError),{detail:"subscribeChannelEvents failed"}),path:An.prefix,error:i,payload:{offset:r},appId:t,channelId:n})),i}})}};Y();Y();var sP=qr(u_()),aP=class{constructor(e={}){this.rtcApi={domain:"rtc-api.skyway.ntt.com",timeout:3e4,secure:!0,eventSubscribeTimeout:5e3},this.log={level:"error",format:"object"},Object.assign(this,(0,sP.default)(this,e))}};Y();Y();var Ze=Se(ie({},ur),{invalidParameter:{name:"invalidParameter",detail:"",solution:""},notFound:{name:"notFound",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internalError:{name:"internalError",detail:"",solution:""},invalidRequestParameter:{name:"invalidRequestParameter",detail:"リクエストのパラメーターが正しくありません",solution:"API仕様を確認し正しい値を入力してください"},insufficientPermissions:{name:"insufficientPermissions",detail:"tokenの権限が不足しています Token permissions are insufficient",solution:"Tokenに必要な権限を加えてください Add the necessary permissions to the Token"},publicationNestedTooMuch:{name:"publicationNestedTooMuch",detail:"originが設定されているPublicationをPublicationのoriginに指定することは出来ません It is not possible to specify the origin of a publication for which Origin has been set",solution:"仕様上の制約なので解決法はありません There is no solution because it is a specification limitation"},channelNotFound:{name:"channelNotFound",detail:"参照しようとしたchannelは存在しません The channel you tried to reference does not exist.",solution:"channelIdやchannelNameが正しいか確かめてください Make sure that the Channel id and channel name are correct."},memberNotFound:{name:"memberNotFound",detail:"参照しようとしたMemberは存在しません The member you tried to reference does not exist.",solution:"memberIdやmemberNameが正しいか確かめてください Make sure that the member id and member name is correct."},publicationNotFound:{name:"publicationNotFound",detail:"参照しようとしたPublicationは存在しません The Publication you tried to reference does not exist.",solution:"publicationIdが正しいか確かめてください Make sure that the publication id is correct."},subscriptionNotFound:{name:"subscriptionNotFound",detail:"参照しようとしたSubscriptionは存在しません The Subscription you tried to reference does not exist.",solution:"subscriptionIdが正しいか確かめてください Make sure that the subscription id is correct."},operationConflicted:{name:"operationConflicted",detail:"与えられた名前のチャネルは、今までの競合する要求によって、すでに作成されています The channel with the given name has already been created by a conflicting request up to now",solution:"別の名前を使ってchannelを作成してください"},channelNameDuplicated:{name:"channelNameDuplicated",detail:"その名前のChannelはすでに存在します A channel with that name already exists",solution:"別の名前を使ってchannelを作成してください"},memberNameDuplicated:{name:"memberNameDuplicated",detail:"その名前のMemberはすでに存在します A member with that name already exists",solution:"別の名前を使ってmemberを作成してください"},subscriptionAlreadyExists:{name:"subscriptionAlreadyExists",detail:"PublicationはすでにSubscribeされています",solution:"publicationIdが正しいか確かめてください"},rateLimitExceeded:{name:"rateLimitExceeded",detail:"リソースを規定仕様以上に消費しています",solution:"リソースの消費量を減らしてください"},projectUsageLimitExceeded:{name:"projectUsageLimitExceeded",detail:"フリープランプロジェクトのリソース利用上限に達しています",solution:"エンタープライズプランにアップグレードしてください"},invalidAuthToken:{name:"invalidAuthToken",detail:"AuthTokenが無効です",solution:"適切なAuthTokenを使用してください"},authTokenExpired:{name:"authTokenExpired",detail:"AuthTokenが期限切れです",solution:"適切なExpを設定したAuthTokenを使用してください"},serverBusy:{name:"serverBusy",detail:"サービス側の問題です",solution:"しばらく時間を置いて再試行してください"}});Y();function P1({appId:e,detail:t,channelId:n,operationName:r,payload:i}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n}}function Xe({operationName:e,info:t,error:n,path:r,channelId:i,appId:a,payload:o}){return new wr({error:n,info:t,payload:{payload:o,operationName:e,channelId:i,appId:a},path:r})}var ft=new ze("packages/rtc-api-client/src/infrastructure/api.ts"),oP=class{constructor(e){this._client=e,this.closed=!1,this.onClose=new We,this.onFatalError=new We,this._token=bl.Decode(this._client.token),e.onClose.once(()=>{this.close()}),e.onFatalError.add(t=>{this.onFatalError.emit(t)})}connect(){return H(this,null,function*(){yield this._client.connect()})}updateAuthToken(e){return H(this,null,function*(){this._token=bl.Decode(e),yield this._client.updateToken(e).catch(t=>{var n,r,i,a,o;const{info:u}=t;if(((r=(n=u==null?void 0:u.error)==null?void 0:n.data)==null?void 0:r.code)===429001)throw Xe({operationName:"RtcApiImpl.updateAuthToken",path:ft.prefix,info:Ze.projectUsageLimitExceeded,error:t});const p=this._commonError("RtcApiImpl.updateAuthToken",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,t);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 401:throw Xe({operationName:"RtcApiImpl.updateAuthToken",path:ft.prefix,info:Ze.invalidAuthToken,error:t});default:throw Xe({operationName:"RtcApiImpl.updateAuthToken",path:ft.prefix,info:Ze.internalError,error:t})}})})}close(){this.closed||(this.closed=!0,ft.debug("closed"),this._client.close(),this.onClose.emit(),this.onClose.removeAllListeners())}_commonError(e,t,n){switch(t){case-32602:return Xe({operationName:e,info:Ze.invalidRequestParameter,path:ft.prefix,error:n});case-32603:return Xe({operationName:e,info:Ze.internalError,path:ft.prefix,error:n});case 403:case 4030:return Xe({operationName:e,info:Ze.insufficientPermissions,path:ft.prefix,error:n});case 429:return Xe({operationName:e,info:Ze.rateLimitExceeded,path:ft.prefix,error:n})}}createChannel(e,t){return H(this,null,function*(){const{id:n}=yield this._client.createChannel({appId:e,name:t.name,metadata:t.metadata}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.createChannel",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw Xe({operationName:"RtcApiImpl.createChannel",path:ft.prefix,info:Ze.channelNotFound,error:i});case 409:throw Xe({operationName:"RtcApiImpl.createChannel",path:ft.prefix,info:Ze.channelNameDuplicated,error:i});default:throw Xe({operationName:"RtcApiImpl.createChannel",path:ft.prefix,info:Ze.internalError,error:i})}});return yield this.getChannel(e,{id:n})})}getChannel(e,t){return H(this,arguments,function*(n,{name:r,id:i}){if(i)return yield this._client.getChannel({appId:n,id:i}).catch(a=>{var o,u,p;const{info:h}=a,g=this._commonError("RtcApiImpl.getChannel",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(g)throw g;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw Xe({operationName:"RtcApiImpl.getChannel",path:ft.prefix,info:Ze.channelNotFound,error:a});default:throw Xe({operationName:"RtcApiImpl.getChannel",path:ft.prefix,info:Ze.internalError,error:a})}});if(r)return yield this._client.getChannelByName({appId:n,name:r}).catch(a=>{var o,u,p;const{info:h}=a,g=this._commonError("RtcApiImpl.getChannel",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(g)throw g;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw Xe({operationName:"getChannel",path:ft.prefix,info:Ze.channelNotFound,error:a});default:throw Xe({operationName:"getChannel",path:ft.prefix,info:Ze.internalError,error:a})}});throw Xe({operationName:"RtcApiImpl.createChannel",path:ft.prefix,info:Ze.invalidRequestParameter})})}findOrCreateChannel(e,t){return H(this,null,function*(){return this._client.findOrCreateChannel(Se(ie({},t),{appId:e})).catch(n=>{var r,i,a,o;const{info:u}=n,p=this._commonError("RtcApiImpl.findOrCreateChannel",(i=(r=u==null?void 0:u.error)==null?void 0:r.code)!=null?i:-1,n);if(p)throw p;if(t.name&&((a=u==null?void 0:u.error)==null?void 0:a.code)===409)return this.getChannel(e,{name:t.name});switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw Xe({operationName:"RtcApiImpl.findOrCreateChannel",path:ft.prefix,info:Ze.channelNotFound,error:n});case 409:throw Xe({operationName:"RtcApiImpl.findOrCreateChannel",path:ft.prefix,info:Ze.channelNameDuplicated,error:n});default:throw Xe({operationName:"RtcApiImpl.findOrCreateChannel",path:ft.prefix,info:Ze.internalError,error:n})}})})}deleteChannel(e,t){return H(this,null,function*(){yield this._client.deleteChannel({appId:e,id:t}).catch(n=>{var r,i,a;const{info:o}=n,u=this._commonError("RtcApiImpl.deleteChannel",(i=(r=o==null?void 0:o.error)==null?void 0:r.code)!=null?i:-1,n);if(u)throw u;switch((a=o==null?void 0:o.error)==null?void 0:a.code){case 404:throw Xe({operationName:"RtcApiImpl.deleteChannel",path:ft.prefix,info:Ze.channelNotFound,error:n});default:throw Xe({operationName:"RtcApiImpl.deleteChannel",path:ft.prefix,info:Ze.internalError,error:n})}})})}updateChannelMetadata(e,t,n){return H(this,null,function*(){yield this._client.updateChannelMetadata({appId:e,id:t,metadata:n}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.updateChannelMetadata",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw Xe({operationName:"RtcApiImpl.updateChannelMetadata",path:ft.prefix,info:Ze.channelNotFound,error:r});default:throw Xe({operationName:"RtcApiImpl.updateChannelMetadata",path:ft.prefix,info:Ze.internalError,error:r})}})})}join(e,t,n){return H(this,null,function*(){const{memberId:r}=yield this._client.addMember({appId:e,channelId:t,name:n.name,metadata:n.metadata,ttlSec:n.ttlSec,type:n.type,subtype:n.subtype}).catch(a=>{var o,u,p;const{info:h}=a,g=this._commonError("RtcApiImpl.addMember",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(g)throw g;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw Xe({operationName:"RtcApiImpl.addMember",path:ft.prefix,info:Ze.channelNotFound,error:a});case 409:throw Xe({operationName:"RtcApiImpl.addMember",path:ft.prefix,info:Ze.memberNameDuplicated,error:a});default:throw Xe({operationName:"RtcApiImpl.addMember",path:ft.prefix,info:Ze.internalError,error:a})}});return{id:r,name:n.name,type:n.type,subtype:n.subtype,metadata:n.metadata}})}updateMemberTtl(e,t,n,r){return H(this,null,function*(){yield this._client.updateMemberTtl({appId:e,channelId:t,memberId:n,ttlSec:r}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updateMemberTtl",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw Xe({operationName:"RtcApiImpl.updateMemberTtl",path:ft.prefix,info:Ze.memberNotFound,error:i});default:throw Xe({operationName:"RtcApiImpl.updateMemberTtl",path:ft.prefix,info:Ze.internalError,error:i})}})})}getServerUnixtime(e){return H(this,null,function*(){return yield this._client.getServerUnixtime({appId:e}).catch(t=>{var n,r;const{info:i}=t,a=this._commonError("RtcApiImpl.getServerUnixtime",(r=(n=i==null?void 0:i.error)==null?void 0:n.code)!=null?r:-1,t);throw a||Xe({operationName:"RtcApiImpl.getServerUnixtime",path:ft.prefix,info:Ze.internalError,error:t})})})}updateMemberMetadata(e,t,n,r){return H(this,null,function*(){yield this._client.updateMemberMetadata({appId:e,channelId:t,memberId:n,metadata:r}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updateMemberMetadata",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw Xe({operationName:"RtcApiImpl.updateMemberMetadata",path:ft.prefix,info:Ze.memberNotFound,error:i});default:throw Xe({operationName:"RtcApiImpl.updateMemberMetadata",path:ft.prefix,info:Ze.internalError,error:i})}})})}leave(e,t,n){return H(this,null,function*(){yield this._client.leaveChannel({channelId:t,id:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.leaveChannel",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw Xe({operationName:"RtcApiImpl.leaveChannel",path:ft.prefix,info:Ze.memberNotFound,error:r});default:throw Xe({operationName:"RtcApiImpl.leaveChannel",path:ft.prefix,info:Ze.internalError,error:r})}})})}publish(e,t){return H(this,null,function*(){const{publicationId:n}=yield this._client.publishStream({channelId:t.channel,publisherId:t.publisher,contentType:t.contentType,metadata:t.metadata,origin:t.origin,codecCapabilities:t.codecCapabilities,encodings:t.encodings,isEnabled:t.isEnabled,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.publish",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){default:throw Xe({operationName:"RtcApiImpl.publish",path:ft.prefix,info:Ze.internalError,error:r})}});return n})}updatePublicationMetadata(e,t,n,r){return H(this,null,function*(){yield this._client.updatePublicationMetadata({channelId:t,publicationId:n,metadata:r,appId:e}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updatePublicationMetadata",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw Xe({operationName:"RtcApiImpl.updatePublicationMetadata",path:ft.prefix,info:Ze.publicationNotFound,error:i});default:throw Xe({operationName:"RtcApiImpl.updatePublicationMetadata",path:ft.prefix,info:Ze.internalError,error:i})}})})}disablePublication(e,t,n){return H(this,null,function*(){yield this._client.disablePublication({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.disablePublication",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw Xe({operationName:"RtcApiImpl.disablePublication",path:ft.prefix,info:Ze.publicationNotFound,error:r});default:throw Xe({operationName:"RtcApiImpl.disablePublication",path:ft.prefix,info:Ze.internalError,error:r})}})})}enablePublication(e,t,n){return H(this,null,function*(){yield this._client.enablePublication({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.enablePublication",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw Xe({operationName:"RtcApiImpl.enablePublication",path:ft.prefix,info:Ze.publicationNotFound,error:r});default:throw Xe({operationName:"RtcApiImpl.enablePublication",path:ft.prefix,info:Ze.internalError,error:r})}})})}unpublish(e,t,n){return H(this,null,function*(){yield this._client.unpublishStream({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.unpublishStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw Xe({operationName:"RtcApiImpl.unpublishStream",path:ft.prefix,info:Ze.publicationNotFound,error:r});default:throw Xe({operationName:"RtcApiImpl.unpublishStream",path:ft.prefix,info:Ze.internalError,error:r})}})})}subscribe(e,t){return H(this,null,function*(){const{subscriptionId:n}=yield this._client.subscribeStream({channelId:t.channel.id,subscriberId:t.subscriber.id,publicationId:t.publication.id,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.subscribeStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw Xe({operationName:"RtcApiImpl.subscribeStream",path:ft.prefix,info:Ze.publicationNotFound,error:r});case 409:throw Xe({operationName:"RtcApiImpl.subscribeStream",path:ft.prefix,info:Ze.subscriptionAlreadyExists,error:r});default:throw Xe({operationName:"RtcApiImpl.subscribeStream",path:ft.prefix,info:Ze.internalError,error:r})}});return n})}unsubscribe(e,t,n){return H(this,null,function*(){yield this._client.unsubscribeStream({appId:e,channelId:t,subscriptionId:n}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.unsubscribeStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw Xe({operationName:"RtcApiImpl.unsubscribeStream",path:ft.prefix,info:Ze.publicationNotFound,error:r});default:throw Xe({operationName:"RtcApiImpl.unsubscribeStream",path:ft.prefix,info:Ze.internalError,error:r})}})})}};Y();var Ca=new ze("packages/rtc-api-client/src/infrastructure/eventObserver.ts"),cP=class{constructor(e,t,n,r){this.onEvent=new We,this._disposer=[];const i=new lP(n.version,a=>H(null,null,function*(){yield t.subscribeChannelEvents({appId:e,channelId:n.id,offset:a}),yield new Promise(o=>setTimeout(o,r.eventSubscribeTimeout)),i.packetLostHappened&&Ca.error(Xe({operationName:"EventObserverImpl.eventJitterBuffer",info:Se(ie({},Ze.internalError),{detail:"failed to resolve event lost"}),channelId:n.id,appId:e,path:Ca.prefix}))}));this._disposer=[t.onEvent.add(a=>H(this,[a],function*({channelId:o,event:u}){o===n.id&&i.push({event:u,version:u.data.channel.version})})).removeListener,i.onEvent.add(a=>{this.onEvent.emit(a)}).removeListener]}dispose(){this._disposer.forEach(e=>e()),this.onEvent.removeAllListeners()}},lP=class{constructor(e,t,n=1e3){this.presentVersion=e,this.onPacketLost=t,this.packetLifetime=n,this.onEvent=new We,this.eventBuffer={},this.packetLostHappened=!1}get expectNextVersion(){return this.presentVersion+1}push(e){const t=e.version;if(t<this.expectNextVersion){Ca.debug("duplicate event",Se(ie({},e),{presentVersion:this.presentVersion}));return}if(t>this.expectNextVersion){Ca.debug("maybe miss order event received",Se(ie({},e),{presentVersion:this.presentVersion})),this.eventBuffer[t]=e,this.handlePacketLifetime();return}this.packetLostHappened&&(Ca.warn("event packetLost resolved",P1({operationName:"EventJitterBuffer.push",detail:"event packetLost resolved",payload:{eventFrame:e}})),this.packetLostHappened=!1),this.eventBuffer[t]=e,this.resolveEvents()}handlePacketLifetime(){const[e]=Object.keys(this.eventBuffer).sort().map(t=>this.eventBuffer[Number(t)]);this.packetLifeTimer==null&&e&&(Ca.debug("set event packetLost timer",Se(ie({},e),{presentVersion:this.presentVersion})),this.packetLifeTimer=setTimeout(()=>H(this,null,function*(){if(this.presentVersion<e.version){if(Ca.warn("event packetLost",P1({operationName:"EventJitterBuffer.handlePacketLifetime",detail:"eventPacket lost",payload:{oldestBufferedEvent:e,eventBufferLength:Object.keys(this.eventBuffer).length,presentVersion:this.presentVersion}})),this.packetLostHappened)return;this.packetLostHappened=!0,yield this.onPacketLost(this.expectNextVersion)}this.packetLifeTimer=void 0,this.handlePacketLifetime()}),this.packetLifetime))}resolveEvents(){const e=[];for(let t=this.expectNextVersion;;t++){const n=this.eventBuffer[t];if(n)e.push(n),delete this.eventBuffer[t];else break}e.length>0&&(this.presentVersion=e.slice(-1)[0].version,e.forEach(t=>{this.onEvent.emit(t.event)}))}},bi=new ze("packages/rtc-api-client/src/client.ts"),uP=class Bb{constructor(t,n,r,i){this.appId=t,this.config=n,this.apiClient=r,this._eventObserverFactory=i,this.closed=!1,this.onFatalError=new We,this.apiClient.onFatalError.pipe(this.onFatalError)}static Create(t){return H(this,null,function*(){const n=new aP(t);n.log&&(ze.level=n.log.level,ze.format=n.log.format),bi.debug("RtcApiClient spawned",n);const r=new iP(Se(ie({},n.rtcApi),{token:t.token,log:n.log})),i=new oP(r);yield i.connect();const a=(o,u)=>new cP(o,r,u,n.rtcApi);return new Bb(t.appId,n,i,a)})}updateAuthToken(t){return H(this,null,function*(){yield this.apiClient.updateAuthToken(t)})}getServerUnixtimeInMs(){return H(this,null,function*(){return this.apiClient.getServerUnixtime(this.appId)})}getServerUnixtimeInSec(){return H(this,null,function*(){return Math.floor((yield this.getServerUnixtimeInMs())/1e3)})}createChannel(){return H(this,arguments,function*(t={}){bi.debug("[start] apiClient.createChannel",{init:t});const n=yield this.apiClient.createChannel(this.appId,t).catch(i=>{throw bi.debug("[failed] apiClient.createChannel",{init:t,e:i}),i});return bi.debug("[end] apiClient.createChannel",{init:t,channelDto:n}),Dp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config)})}findChannel(t){return H(this,null,function*(){bi.debug("[start] apiClient.getChannel",{query:t});const n=yield this.apiClient.getChannel(this.appId,t).catch(i=>{throw bi.debug("[failed] apiClient.getChannel",{query:t,e:i}),i}),r=Dp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config);return bi.debug("[end] apiClient.getChannel",{channelId:r.id}),r})}findOrCreateChannel(t){return H(this,null,function*(){bi.debug("[start] apiClient.findOrCreateChannel",{query:t});const n=yield this.apiClient.findOrCreateChannel(this.appId,t).catch(i=>{throw bi.debug("[failed] apiClient.findOrCreateChannel",{query:t,e:i}),i});return bi.debug("[end] apiClient.findOrCreateChannel",{query:t}),Dp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config)})}deleteChannel(t){return this.apiClient.deleteChannel(this.appId,t)}close(){this.closed||(this.closed=!0,bi.debug("closed",{appid:this.appId}),this.apiClient.close())}};Y();Y();var dP={};Y();var $t=new ze("packages/rtc-api-client/src/domain/channel.ts"),hP=class{constructor(e,{id:t,name:n,members:r,metadata:i,publications:a,subscriptions:o,version:u},p,h,g){this.appId=e,this.eventObserver=p,this.apiClient=h,this.config=g,this.disposed=!1,this._events=new ts,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.updateChannelMetadata=f=>new Promise((_,w)=>{let C=!1;this.apiClient.updateChannelMetadata(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onMetadataUpdated.watch(R=>R.channel.metadata===f).then(()=>_()).catch(R=>{C||w(Xe({operationName:"ChannelImpl.updateChannelMetadata",info:Se(ie({},Ze.timeout),{detail:"onMetadataUpdated"}),path:$t.prefix,error:R,appId:this.appId,channelId:this.id}))})}),this.leave=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.leave(this.appId,f,_).catch(S=>{R=!0,C(S)}),this.onMemberLeft.watch(S=>S.member.id===_,this.config.rtcApi.timeout).then(()=>w()).catch(S=>{R||C(Xe({operationName:"ChannelImpl.leave",info:Se(ie({},Ze.timeout),{detail:"onMemberLeft"}),path:$t.prefix,error:S,appId:this.appId,channelId:this.id}))})}),this.updateMemberMetadata=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.updateMemberMetadata(this.appId,this.id,f,_).catch(S=>{R=!0,C(S)}),this.onMemberMetadataUpdated.watch(S=>S.member.id===f&&S.member.metadata===_).then(()=>w()).catch(S=>{R||C(Xe({operationName:"ChannelImpl.updateMemberMetadata",info:Se(ie({},Ze.timeout),{detail:"onMemberMetadataUpdated"}),path:$t.prefix,error:S,appId:this.appId,channelId:this.id}))})}),this.unpublish=f=>new Promise((_,w)=>{let C=!1;this.apiClient.unpublish(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onStreamUnpublished.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(Xe({operationName:"ChannelImpl.unpublish",info:Se(ie({},Ze.timeout),{detail:"onStreamUnpublished"}),path:$t.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.updatePublicationMetadata=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.updatePublicationMetadata(this.appId,this.id,f,_).catch(S=>{R=!0,C(S)}),this.onPublicationMetadataUpdated.watch(S=>S.publication.id===f&&S.publication.metadata===_).then(()=>w()).catch(S=>{R||C(Xe({operationName:"ChannelImpl.updatePublicationMetadata",info:Se(ie({},Ze.timeout),{detail:"onPublicationMetadataUpdated"}),path:$t.prefix,error:S,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.disablePublication=f=>new Promise((_,w)=>{let C=!1;this.apiClient.disablePublication(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationDisabled.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(Xe({operationName:"ChannelImpl.disablePublication",info:Se(ie({},Ze.timeout),{detail:"onPublicationDisabled"}),path:$t.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.enablePublication=f=>new Promise((_,w)=>{let C=!1;this.apiClient.enablePublication(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationEnabled.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(Xe({operationName:"ChannelImpl.enablePublication",info:Se(ie({},Ze.timeout),{detail:"onPublicationEnabled"}),path:$t.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.unsubscribe=f=>new Promise((_,w)=>{let C=!1;this.apiClient.unsubscribe(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationUnsubscribed.watch(R=>R.subscription.id===f).then(()=>_()).catch(R=>{C||w(Xe({operationName:"ChannelImpl.unsubscribe",info:Se(ie({},Ze.timeout),{detail:"onPublicationUnsubscribed"}),path:$t.prefix,error:R,payload:{subscriptionId:f},appId:this.appId,channelId:this.id}))})}),this.id=t,this.name=n,this.metadata=i,this.members=r,this.publications=a,this.subscriptions=o,this.version=u,p.onEvent.add(f=>{$t.debug("received event: ",f),this.version=f.data.channel.version;try{switch(f.type){case"ChannelDeleted":this._channelClosed();break;case"ChannelMetadataUpdated":this._channelMetadataUpdated(f.data);break;case"MemberAdded":this._memberJoined(f.data);break;case"MemberRemoved":this._memberLeft(f.data);break;case"MemberMetadataUpdated":this._memberMetadataUpdated(f.data);break;case"StreamPublished":this._streamPublished(f.data);break;case"StreamUnpublished":this._streamUnpublished(f.data);break;case"PublicationMetadataUpdated":this._publicationMetadataUpdated(f.data);break;case"PublicationDisabled":this._publicationDisabled(f.data);break;case"PublicationEnabled":this._publicationEnabled(f.data);break;case"StreamSubscribed":this._streamSubscribed(f.data);break;case"StreamUnsubscribed":this._streamUnsubscribed(f.data);break}}catch(_){$t.error(_)}}),h.onClose.once(()=>{this.dispose()})}getMember(e){return this.members.find(t=>t.id===e)}addMember(e){const t=this.getMember(e.id);return t||(this.members.push(e),e)}deleteMember(e){this.members=this.members.filter(t=>t.id!==e)}getPublication(e){return this.publications.find(t=>t.id===e)}addPublication(e){var t,n;const r=this.getPublication(e.id);if(r)return r;const i=Se(ie({},e),{channelId:this.id,codecCapabilities:(t=e.codecCapabilities)!=null?t:[],encodings:(n=e.encodings)!=null?n:[]});return this.publications.push(i),i}deletePublication(e){this.publications=this.publications.filter(t=>t.id!==e)}getSubscription(e){return this.subscriptions.find(t=>t.id===e)}addSubscription(e){const t=this.getSubscription(e.id);if(t)return t;const n=this.getPublication(e.publicationId),r=Se(ie({},e),{channelId:this.id,publisherId:n.publisherId,contentType:n.contentType});return this.subscriptions.push(r),r}deleteSubscription(e){this.subscriptions=this.subscriptions.filter(t=>t.id!==e)}_channelClosed(){this.onClosed.emit({})}_channelMetadataUpdated(e){this.metadata=e.channel.metadata,this.onMetadataUpdated.emit(e)}_memberJoined(e){this.addMember(e.member),this.onMemberJoined.emit(e),this.onMemberListChanged.emit({})}_memberLeft(e){const t=this.getMember(e.member.id);if(!t)throw Xe({operationName:"ChannelImpl._memberLeft",info:Ze.memberNotFound,path:$t.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deleteMember(t.id),this.onMemberLeft.emit({member:t}),this.onMemberListChanged.emit({})}_memberMetadataUpdated(e){const t=this.getMember(e.member.id);if(!t)throw Xe({operationName:"ChannelImpl._memberMetadataUpdated",info:Ze.memberNotFound,path:$t.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.metadata=e.member.metadata,this.onMemberMetadataUpdated.emit(e)}_streamPublished(e){const t=this.addPublication(e.publication),n=Se(ie({},e),{publication:t});this.onStreamPublished.emit(n),this.onPublicationListChanged.emit({})}_streamUnpublished(e){const t=this.getPublication(e.publication.id);if(!t)throw Xe({operationName:"ChannelImpl._streamUnpublished",info:Ze.publicationNotFound,path:$t.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deletePublication(t.id);const n=Se(ie({},e),{publication:t});this.onStreamUnpublished.emit(n),this.onPublicationListChanged.emit({})}_publicationMetadataUpdated(e){const t=this.getPublication(e.publication.id);if(!t)throw Xe({operationName:"ChannelImpl._publicationMetadataUpdated",info:Ze.publicationNotFound,path:$t.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.metadata=e.publication.metadata;const n=Se(ie({},e),{publication:t});this.onPublicationMetadataUpdated.emit(n)}_publicationDisabled(e){const t=this.getPublication(e.publication.id);if(!t)throw Xe({operationName:"ChannelImpl._publicationDisabled",info:Ze.publicationNotFound,path:$t.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.isEnabled=e.publication.isEnabled;const n={publication:t};this.onPublicationDisabled.emit(n)}_publicationEnabled(e){const t=this.getPublication(e.publication.id);if(!t)throw Xe({operationName:"ChannelImpl._publicationEnabled",info:Ze.publicationNotFound,path:$t.prefix,payload:{event:dP},appId:this.appId,channelId:this.id});t.isEnabled=e.publication.isEnabled;const n={publication:t};this.onPublicationEnabled.emit(n)}_streamSubscribed(e){const t=this.addSubscription(e.subscription),n=Se(ie({},e),{subscription:t});this.onPublicationSubscribed.emit(n),this.onSubscriptionListChanged.emit({})}_streamUnsubscribed(e){const t=this.getSubscription(e.subscription.id);if(!t)throw Xe({operationName:"ChannelImpl._streamUnsubscribed",info:Ze.subscriptionNotFound,path:$t.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deleteSubscription(t.id);const n=Se(ie({},e),{subscription:t});this.onPublicationUnsubscribed.emit(n),this.onSubscriptionListChanged.emit({})}joinChannel(e){return H(this,null,function*(){var t;e.type&&(e.type=e.type[0].toUpperCase()+e.type.slice(1)),e.subtype&&(e.subtype=e.subtype[0].toUpperCase()+e.subtype.slice(1)),$t.debug("[start] joinChannel",{memberInit:e});const n=yield this.apiClient.join(this.appId,this.id,ie({},e)),r=(t=this.getMember(n.id))!=null?t:(yield this.onMemberJoined.watch(i=>i.member.id===n.id,this.config.rtcApi.timeout).catch(i=>{throw Xe({operationName:"ChannelImpl.joinChannel",info:Se(ie({},Ze.timeout),{detail:"onMemberJoined"}),path:$t.prefix,error:i,appId:this.appId,channelId:this.id})})).member;return $t.debug("[end] joinChannel",{member:r}),r})}updateMemberTtl(e,t){return this.apiClient.updateMemberTtl(this.appId,this.id,e,t)}publish(e){return H(this,null,function*(){var t,n,r;const i=$t.debug("[start] apiClient.publish",{init:e}),a=this.id,o=yield this.apiClient.publish(this.appId,Se(ie({},e),{channel:a})),u={id:o,channelId:a,publisherId:e.publisher,origin:e.origin,contentType:e.contentType,metadata:e.metadata,codecCapabilities:(t=e.codecCapabilities)!=null?t:[],encodings:(n=e.encodings)!=null?n:[],isEnabled:(r=e.isEnabled)!=null?r:!0};$t.elapsed(i,"[ongoing] apiClient.publish",{publicationDto:u});const p=this.getPublication(o);if(p)return p;const{publication:h}=yield this.onStreamPublished.watch(g=>g.publication.id===o,this.config.rtcApi.timeout).catch(g=>{throw Xe({operationName:"ChannelImpl.publish",info:Se(ie({},Ze.timeout),{detail:"onStreamPublished"}),path:$t.prefix,error:g,payload:{publicationDto:u},appId:this.appId,channelId:this.id})});return $t.elapsed(i,"[end] apiClient.publish",{publicationDto:u}),h})}subscribe(e){return H(this,null,function*(){const t=$t.debug("[start] apiClient.subscribe",{init:e}),n=yield this.apiClient.subscribe(this.appId,Se(ie({},e),{channel:this})),r={id:n,publicationId:e.publication.id,channelId:this.id,publisherId:e.publication.publisherId,subscriberId:e.subscriber.id,contentType:e.publication.contentType};$t.elapsed(t,"[ongoing] apiClient.subscribe",{subscriptionDto:r});const i=this.getSubscription(n);if(i)return $t.elapsed(t,"[end] apiClient.subscribe",{subscriptionDto:r}),i;const{subscription:a}=yield this.onPublicationSubscribed.watch(o=>o.subscription.id===n,this.config.rtcApi.timeout).catch(o=>{throw $t.elapsed(t,"[fail] apiClient.subscribe",o),Xe({operationName:"ChannelImpl.subscribe",info:Se(ie({},Ze.timeout),{detail:"onPublicationSubscribed"}),path:$t.prefix,error:o,payload:{subscriptionDto:r}})});return $t.elapsed(t,"[end] apiClient.subscribe",{subscriptionDto:r}),a})}close(){return this.apiClient.deleteChannel(this.appId,this.id)}dispose(){this.disposed||(this.disposed=!0,$t.debug("disposed",{id:this.id}),this.eventObserver.dispose(),this._events.dispose())}};function Dp(e,t,n,r,i){return new hP(e,r,t,n,i)}Y();Y();Y();Y();var Ns=class{constructor(e,t){this.id=ji(),this.type=e,this.payload=t}toJSON(){return{id:this.id,type:this.type,payload:this.payload}}};Y();function pP(e){return!(typeof e!="object"||e===null||Array.isArray(e))}function fP(e){if(!e||typeof e!="object"||!e.statsRequest||typeof e.statsRequest!="object"||!e.statsRequest.intervalSec||typeof e.statsRequest.intervalSec!="number"||!e.statsRequest.types||!Array.isArray(e.statsRequest.types))return!1;for(const t of e.statsRequest.types){if(!t.type||typeof t.type!="string"||!t.properties||!pP(t.properties))return!1;for(const n of Object.keys(t.properties))if(!("normalization"in t.properties[n])||typeof t.properties[n].normalization!="boolean"||!t.properties[n].outputKey||typeof t.properties[n].outputKey!="string")return!1}return!0}var mP=["invalidPayload","unexpected"];function k1(e){return!(!e||typeof e!="object"||typeof e.eventId!="string"||typeof e.ok!="boolean"||typeof e.reason<"u"&&(typeof e.reason!="string"||!mP.includes(e.reason)))}Y();var Np=qr(tg());Y();var zs=class{constructor(){this._listeners=new Map,this._listenerIndex=0,this.emit=e=>{this._listeners.forEach(t=>t(e))},this.removeAllListeners=()=>{this._listeners.clear()},this.addListener=e=>{const t=this._listenerIndex;return this._listeners.set(t,e),this._listenerIndex++,{removeListener:()=>{this._listeners.delete(t)}}},this.addOneTimeListener=e=>{const t=this.addListener(n=>{t.removeListener(),e(n)});return t},this.asPromise=e=>new Promise((t,n)=>{let r=()=>{};const i=e&&setTimeout(()=>{n("Event asPromise timeout"),r()},e);r=this.addOneTimeListener(o=>{i&&clearTimeout(i),t(o)}).removeListener})}},gP=["Open","Acknowledge"],vP=e=>(ws(2,e)+Math.random())*1e3,yP=class{constructor({sessionEndpoint:e,token:t,logger:n,sdkVersion:r,contextId:i}){this._isOpen=!1,this._isClosed=!1,this._reconnectCount=0,this.connectionState="connecting",this.onConnectionStateChanged=new zs,this.onOpened=new zs,this.onTokenExpired=new zs,this.onEventReceived=new zs,this.onConnectionFailed=new zs,this._resendClientEvents=[],this._sessionEndpoint=e,this._token=t,this._logger=n,this._sdkVersion=r,this._contextId=i,this._connect()}_setConnectionState(e){this.connectionState!==e&&(this._logger.debug(`connectionState changed : ${e}`),this.connectionState=e,this.onConnectionStateChanged.emit(e))}_connect(){let e;try{const t=`SkyWayAuthToken!${this._token}`,n={sdkPlatform:"js",sdkVersion:this._sdkVersion,contextId:this._contextId},r=Object.entries(n).filter(([a,o])=>o!==void 0).map(a=>a.join("=")).join("&"),i=`${this._sessionEndpoint}?${r}`;e=new Np.default(i,t),this._logger.debug(`Connecting to analytics-logging-server: ${this._sessionEndpoint}`),e.onerror=a=>{this._logger.error("WebSocket error occurred",a.error),e.close(4202)}}catch(t){const n=t instanceof Error?t:new Error;this._logger.error("Failed to create WebSocket instance",n),this.reconnect();return}e.onopen=()=>{this._logger.debug("Connected to analytics-logging-server")},e.onclose=t=>{const n="Close event fired: "+JSON.stringify({code:t.code,reason:t.reason,type:t.type});if(4100<=t.code&&t.code<=4199||t.code===1009?this._logger.error(n,new Error):this._logger.debug(n),t.code!==1e3&&t.code!==1009&&!(4e3<=t.code&&t.code<=4199)){t.code===4200?this.onTokenExpired.emit():this.reconnect();return}this._logger.debug("Closed the connection to analytics-logging-server"),this.onConnectionFailed.emit({code:t.code,reason:t.reason}),this.close()},e.onmessage=t=>{this._messageHandler(t.data)},this._ws=e}updateAuthToken(e){this._token=e}reconnect(){if(this._ws!==void 0&&this._ws.close(4e3),this._ws=void 0,this._isOpen=!1,this._reconnectCount>=5)this.onConnectionFailed.emit({}),this.close(),this._logger.error("Failed to reconnect for five times",new Error);else{this._setConnectionState("reconnecting");const e=vP(this._reconnectCount);this._reconnectTimer=setTimeout(()=>{this._connect(),this._reconnectCount++,this._logger.debug(`Try to reconnect: count = ${this._reconnectCount}`)},e)}}close(){this._isClosed=!0,this.destroy()}destroy(){this._setConnectionState("closed"),this.onConnectionStateChanged.removeAllListeners(),this.onOpened.removeAllListeners(),this.onEventReceived.removeAllListeners(),this.onConnectionFailed.removeAllListeners(),this._reconnectTimer&&clearTimeout(this._reconnectTimer),this._ws!==void 0&&this._ws.close(1e3)}send(e){return H(this,null,function*(){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==Np.default.OPEN){this._logger.debug("Try to reconnect because connection is lost"),this.resendAfterReconnect(e);return}const t=JSON.stringify(e.toJSON());this._ws.send(t,n=>{if(n){this._logger.debug(`Try to reconnect because failed to send: ${n.message}`),this.resendAfterReconnect(e);return}})})}resendAfterReconnect(e){this._resendClientEvents.some(n=>n.id===e.id)||this._resendClientEvents.push(e),this.connectionState!=="reconnecting"&&this.reconnect()}pushResendClientEventsQueue(e){this._resendClientEvents.push(e)}isClosed(){return this._isClosed}_messageHandler(e){if(typeof e!="string"){this._logger.error("Received invalid message: not string",new Error);return}let t;try{t=JSON.parse(e)}catch(n){const r=n instanceof Error?n:new Error;this._logger.error("Received invalid message: parse error",r);return}if(!_P(t)){this._logger.error(`Received invalid message: ${JSON.stringify(t)}`,new Error);return}if(t.type==="Open"){if(!fP(t.payload)){this._logger.error(`Received invalid message: ${JSON.stringify(t.payload)}`,new Error);return}if(this._logger.debug("Received a open event"),this._isOpen=!0,this._setConnectionState("connected"),this._reconnectCount!==0&&(this._reconnectCount=0,this._logger.debug("Succeeded to reconnect")),this._resendClientEvents.length>0){for(const n of this._resendClientEvents){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==Np.default.OPEN){this._logger.error(`Failed to resend event because connection lost after reconnect: ${n}`,new Error);continue}const r=JSON.stringify(n.toJSON());this._ws.send(r,i=>{if(i){this._logger.error(`Failed to resend event: ${n}`,i);return}this._logger.debug(`Succeed to resend ClientEvent: ${n}`)})}this._logger.debug("Process of resending ClientEvents is completed"),this._resendClientEvents=[]}this.onOpened.emit(t.payload)}else this._logger.debug(`Received the event: ${t.type}, payload: ${JSON.stringify(t.payload)}`),this.onEventReceived.emit(t)}};function _P(e){return!(!e||typeof e!="object"||typeof e.type!="string"||!gP.includes(e.type)||typeof e.id!="string"||e.payload&&typeof e.payload!="object")}Y();var bP=class{constructor(e={}){this.count=0,this.times=8,this.interval=100,this.jitter=0,Object.assign(this,e)}wait(){return H(this,null,function*(){if(this.exceeded)return!1;const e=this.timeout;return this.count++,yield new Promise(t=>setTimeout(t,e)),!0})}get timeout(){return ws(this.count,2)*this.interval+ws(this.count,2)*this.jitter*Math.random()}get exceeded(){return this.count>=this.times}reset(){this.count=0}stop(){this.count=this.times}},T1="analytics-logging.skyway.ntt.com",SP="v2",wP=5,Ub=class Hb{constructor({token:t,sdkVersion:n,contextId:r},i){this.onConnectionStateChanged=new zs,this.onConnectionFailed=new zs,this.onAnalyticsNotEnabledError=new zs,this._isClosed=!1,this._responseCallbacks=new Map,this._acknowledgeCallbacks=new Map,this._mediaDeviceVersion=new Map,this._encodingsVersion=new Map,this._preferredEncodingVersion=new Map,this._previousSubscriptionStats=new Map,this._statsRequest={intervalSec:5,types:[]},this._pendingSdkLogs=[],this._token=t,this._newToken=void 0,this._sdkVersion=n,this._contextId=r;const a={analyticsLoggingServerDomain:T1,secure:!0,logger:{debug:(o,...u)=>{console.debug(o,...u)},warn:(o,...u)=>{console.warn(o,...u)},error:o=>{console.error(o)}}};this._options=Object.assign({},a,i??{}),this._logger=this._options.logger,this._logger.debug(`Created instance with the options: ${this._options}`),this._sdkLogTimer=setInterval(()=>{if(this._pendingSdkLogs.length>0){const o=this._pendingSdkLogs.splice(0,this._pendingSdkLogs.length);this.sendSdkLogReport(o).catch(u=>{this._logger.warn("sendSdkLogReport (interval) failed",u)})}},5*1e3)}get connectionState(){var t,n;return(n=(t=this._socket)==null?void 0:t.connectionState)!=null?n:"closed"}connect(){return H(this,null,function*(){const t=this._options.secure?"wss":"ws",n=this._options.analyticsLoggingServerDomain||T1;this._socket=new yP({sessionEndpoint:`${t}://${n}/${SP}/client/ws`,contextId:this._contextId,token:this._token,logger:this._logger,sdkVersion:this._sdkVersion}),this._socket.onEventReceived.addListener(i=>{try{this._eventReceivedHandler(i)}catch(a){this._logger.error("in _eventReceivedHandler",a)}}),this._socket.onConnectionFailed.addListener(i=>{i.code===4e3&&this.onAnalyticsNotEnabledError.emit(i),this.onConnectionFailed.emit(),this.dispose()}),this._socket.onConnectionStateChanged.addListener(i=>{var a;i==="closed"&&!this.isClosed()&&((a=this._socket)!=null&&a.isClosed())&&(this._isClosed=!0,this.dispose()),this.onConnectionStateChanged.emit(i)}),this._socket.onTokenExpired.addListener(()=>{this._reconnectWithNewSkyWayAuthToken()});const r=yield this._socket.onOpened.asPromise();if(r!==void 0){this._statsRequest=r.statsRequest;return}else{this._logger.error("First time connection payload is undefined",new Error),this.onConnectionFailed.emit();return}})}bufferOrSendSdkLog(t){const n=t.level==="warn"||t.level==="error";if(this._pendingSdkLogs.push(t),n||this._pendingSdkLogs.length>=Hb.MAX_PENDING_SDK_LOGS){const r=[...this._pendingSdkLogs];this._pendingSdkLogs.length=0,this.sendSdkLogReport(r).catch(i=>{this._logger.warn("sendSdkLogReport failed",i)})}}dispose(){clearInterval(this._sdkLogTimer),this._disconnect(),this._cleanupAnalyticsClientMaps()}setNewSkyWayAuthToken(t){this._socket!==void 0&&(this._newToken=t,this._logger.debug("setNewSkyWayAuthToken is success"))}cleanupOnUnpublished(t){this._mediaDeviceVersion.delete(t),this._encodingsVersion.delete(t)}cleanupOnUnsubscribed(t){this._preferredEncodingVersion.delete(t),this._previousSubscriptionStats.delete(t)}_disconnect(){var t;(t=this._socket)==null||t.destroy(),this._socket=void 0,this._responseCallbacks.clear(),this._acknowledgeCallbacks.clear()}sendMediaDeviceReport(t){return H(this,null,function*(){let n=this._mediaDeviceVersion.get(t.publicationId);n===void 0?n=0:n++,this._mediaDeviceVersion.set(t.publicationId,n);const r={publicationId:t.publicationId,mediaDeviceName:t.mediaDeviceName,mediaDeviceVersion:n,mediaDeviceTrigger:t.mediaDeviceTrigger,updatedAt:t.updatedAt},i=new Ns("MediaDeviceReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendMediaDeviceReport is failed",a)})})}sendSdkLogReport(t){return H(this,null,function*(){if(t.length===0)return;const n=t.map(i=>({timestamp:i.timestamp,level:i.level,message:Array.isArray(i.message)?i.message.map(a=>typeof a=="string"?a:JSON.stringify(a)).join(","):String(i.message)})),r=new Ns("SdkLog",{sdkLogs:n,contextId:this._contextId});yield this._sendClientEvent(r).catch(i=>{this._logger.warn("_sendClientEvent in sendSdkLogReport is failed",i)})})}sendBindingRtcPeerConnectionToSubscription(t){return H(this,null,function*(){const n=new Ns("BindingRtcPeerConnectionToSubscription",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendBindingRtcPeerConnectionToSubscription is failed",r)})})}filterStatsReport(t){const n=Array.from(t.values()).find(o=>o.type==="transport"&&o.dtlsState==="connected"),r=[];if(n){const o=Array.from(t.values()).find(u=>u.type==="candidate-pair"&&u.nominated&&u.id===(n==null?void 0:n.selectedCandidatePairId));o&&r.push(o.id,o.localCandidateId,o.remoteCandidateId,o.transportId)}else{const o=Array.from(t.values()).find(u=>u.type==="candidate-pair"&&u.nominated&&u.selected);o&&r.push(o.id,o.localCandidateId,o.remoteCandidateId,o.transportId)}const i=new Map,a=["candidate-pair","local-candidate","remote-candidate","transport"];for(const[o,u]of t.entries())a.includes(u.type)?r.includes(u.id)&&i.set(o,u):i.set(o,u);return i}bundleStatsReportByStatsType(t){const n={};for(const r of t.values())n[r.type]=r;return n}sendSubscriptionStatsReport(t,n){return H(this,null,function*(){var r;const i=this._previousSubscriptionStats.get(n.subscriptionId);if(this._previousSubscriptionStats.set(n.subscriptionId,{stats:t,createdAt:n.createdAt}),i===void 0)return;const a=this.filterStatsReport(i.stats),o=this.bundleStatsReportByStatsType(a),u=i.createdAt,p=(n.createdAt-u)/1e3;if(p<=0)throw new Error("duration must be greater than 0. also sendSubscriptionStatsReport was duplicated.");const h=this.filterStatsReport(t),g=this.bundleStatsReportByStatsType(h),f={};for(const{type:C,properties:R}of this._statsRequest.types)for(const[S,{normalization:b,outputKey:x,contentType:E}]of Object.entries(R)){if(!E.includes(n.contentType))continue;const M=g[C];if(!(M===void 0||M[S]===void 0))if(b){const Z=(r=o[C])==null?void 0:r[S];if(Z===void 0){this._logger.warn(`${C} in previous statsReport is undefined`);continue}const $=(Number(M[S])-Number(Z))/p;f[C]=Se(ie({},f[C]),{[x]:String($)})}else f[C]=Se(ie({},f[C]),{[x]:String(M[S])})}const _={subscriptionId:n.subscriptionId,stats:f,role:n.role,createdAt:n.createdAt},w=new Ns("SubscriptionStatsReport",_);yield this._sendClientEvent(w).catch(C=>{this._logger.warn("_sendClientEvent in sendSubscriptionStatsReport is failed",C)})})}sendRtcPeerConnectionEventReport(t){return H(this,null,function*(){const n=new Ns("RtcPeerConnectionEventReport",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendRtcPeerConnectionEventReport is failed",r)})})}sendPublicationUpdateEncodingsReport(t){return H(this,null,function*(){let n=this._encodingsVersion.get(t.publicationId);n===void 0?n=0:n++,this._encodingsVersion.set(t.publicationId,n);const r={publicationId:t.publicationId,encodings:t.encodings,encodingsVersion:n,updatedAt:t.updatedAt},i=new Ns("PublicationUpdateEncodingsReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendPublicationUpdateEncodingsReport is failed",a)})})}sendSubscriptionUpdatePreferredEncodingReport(t){return H(this,null,function*(){let n=this._preferredEncodingVersion.get(t.subscriptionId);n===void 0?n=0:n++,this._preferredEncodingVersion.set(t.subscriptionId,n);const r={subscriptionId:t.subscriptionId,preferredEncodingIndex:t.preferredEncodingIndex,preferredEncodingVersion:n,updatedAt:t.updatedAt},i=new Ns("SubscriptionUpdatePreferredEncodingReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendSubscriptionUpdatePreferredEncodingReport is failed",a)})})}sendJoinReport(t){return H(this,null,function*(){const n=new Ns("JoinReport",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendJoinReport is failed",r)})})}_sendClientEvent(t){return H(this,null,function*(){return new Promise((n,r)=>H(this,null,function*(){if(this._socket===void 0||this._socket.connectionState==="closed"){r(new Error("websocket is not connected"));return}if(this._socket.connectionState==="connecting"){this._socket.pushResendClientEventsQueue(t),this._setAcknowledgeCallback(t.id,a=>H(this,null,function*(){a.ok?(this._acknowledgeCallbacks.delete(t.id),n()):(this._acknowledgeCallbacks.delete(t.id),r(a))})),this._logger.debug(`pushResendClientEventsQueue and setAcknowledgeCallback. clientEvent.id: ${t.id}`),r(new Error("websocket is connecting now"));return}const i=new bP({times:6,interval:500,jitter:100});for(;!i.exceeded;){const a=setTimeout(()=>H(this,null,function*(){if(this._socket===void 0){this._acknowledgeCallbacks.delete(t.id),r(new Error("Socket closed when trying to resend"));return}else this._socket.resendAfterReconnect(t);r(new Error("Timeout to send data"))}),wP*1e3);this._logger.debug(`send clientEvent, ${JSON.stringify(t)}`),this._socket.send(t).catch(u=>{this._acknowledgeCallbacks.delete(t.id),clearTimeout(a),r(u)});const o=yield this._waitForAcknowledge(t.id).catch(u=>u);if(clearTimeout(a),k1(o))if(o.reason==="unexpected")yield i.wait();else{r(o);return}else{n();return}}r(new Error("unexpected has occurred at server"))}))})}_waitForAcknowledge(t){return H(this,null,function*(){return new Promise((n,r)=>{this._setAcknowledgeCallback(t,i=>H(this,null,function*(){i.ok?(this._acknowledgeCallbacks.delete(t),n()):(this._acknowledgeCallbacks.delete(t),r(i))}))})})}_reconnectWithNewSkyWayAuthToken(){return H(this,null,function*(){this._disconnect(),this._newToken!==void 0?(this._token=this._newToken,this._newToken=void 0,yield this.connect()):this._logger.warn("new token is not set. so not reconnect.")})}_eventReceivedHandler(t){switch(t.type){case"Acknowledge":this._acknowledgeHandler(t.payload);break;case"Open":break;default:t.type,this._logger.warn(`Unknown event: ${t.type}`)}}_acknowledgeHandler(t){if(!k1(t))throw new Error("Invalid payload");const{eventId:n}=t;if(!this._acknowledgeCallbacks.has(n))throw new Error(`acknowledge event has unknown eventId: ${n}`);const r=this._acknowledgeCallbacks.get(n);r&&(this._acknowledgeCallbacks.delete(n),r(t))}_setAcknowledgeCallback(t,n){this._acknowledgeCallbacks.set(t,n)}_cleanupAnalyticsClientMaps(){this._mediaDeviceVersion.clear(),this._encodingsVersion.clear(),this._preferredEncodingVersion.clear(),this._previousSubscriptionStats.clear()}getIntervalSec(){return this._statsRequest.intervalSec}isConnectionEstablished(){return!(!this._socket||this._socket.connectionState==="connecting"||this._socket.connectionState==="closed")}isClosed(){return this._isClosed}};Ub.MAX_PENDING_SDK_LOGS=50;var xP=Ub;Y();var Vb="packages/core/src/external/analytics.ts",Wr=new ze(Vb);function CP(e){return H(this,null,function*(){const{analyticsService:t}=e.config,n=new xP({token:e.authTokenString,sdkVersion:em.version,contextId:em.id},{logger:{error:(i,a)=>H(null,null,function*(){Wr.error(`AnalyticsClient error: ${i}`,De({operationName:"AnalyticsClient.logger",context:e,info:Se(ie({},Ue.internal),{detail:"AnalyticsClient error"}),error:a,path:Wr.prefix}))}),debug:(i,...a)=>{Wr.debug("[analytics]:",i,...a)},warn:(i,...a)=>{Wr.warn("[analytics]:",i,...a)}},analyticsLoggingServerDomain:t.domain,secure:t.secure}),r=new EP(n,e);return ze._onLogForAnalytics=i=>{i.prefix!==Vb&&n.bufferOrSendSdkLog(i)},r.connectWithTimeout().catch(i=>{r.close(),Wr.error(`AnalyticsClient error: ${i.message}`,De({operationName:"AnalyticsClient.logger",context:e,info:Se(ie({},Ue.internal),{detail:"AnalyticsClient error"}),error:i,path:Wr.prefix})),r.onConnectionFailed.emit({})}),r})}var EP=class{constructor(e,t){this.client=e,this.context=t,this.onConnectionFailed=new We,this.onConnectionStateChanged=new We,this.onMessage=new We,this._isClosed=!1,this._listen(),t._onTokenUpdated.add(n=>{this.client.setNewSkyWayAuthToken(n)})}_listen(){this.client.onConnectionFailed.addOneTimeListener(()=>{this.onConnectionFailed.emit({})}),this.client.onConnectionStateChanged.addListener(e=>{e==="closed"&&!this.isClosed()&&this.client.isClosed()&&this.close(),this.onConnectionStateChanged.emit(e)})}get connectionState(){return this.client.connectionState}_connect(){return H(this,null,function*(){Wr.debug("[start] connect analyticsService"),yield this.client.connect().then(()=>{Wr.debug("[end] connect analyticsService")}).catch(e=>{this.close(),Wr.debug("[end] failed connect analyticsService: also unreachable to server"),Wr.error(`AnalyticsClient error: ${e.message}`,De({operationName:"AnalyticsClient.logger",info:Se(ie({},Ue.internal),{detail:"AnalyticsClient error"}),error:e,path:Wr.prefix})),this.onConnectionFailed.emit({})})})}connectWithTimeout(){return H(this,null,function*(){let e;const t=new Promise((r,i)=>{e=setTimeout(()=>{Wr.debug("[end] failed connect analyticsService: no initial response from the server"),i(new Error("failed connect analyticsService"))},3e4)}),n=new Promise((r,i)=>{this.client.onAnalyticsNotEnabledError.addOneTimeListener(a=>{Wr.warn(`[end] failed connect analyticsService: ${a.reason}`),r()})});return Promise.race([this._connect(),t,n]).finally(()=>{clearTimeout(e)})})}close(){this._isClosed=!0,this.onConnectionFailed.removeAllListeners(),this.onConnectionStateChanged.removeAllListeners(),this.onMessage.removeAllListeners()}isClosed(){return this._isClosed}};Y();Y();var gg=class{constructor(){this._onContextAttached=new We}_attachContext(e){this._context=e,this._onContextAttached.emit(e)}};Y();var PP=new ze("packages/core/src/plugin/internal/person/connection/messageBuffer.ts"),kP=class{constructor(e){this.signaling=e,this._indicateMessageBuffer={},this._excludeConnectionIndicateBuffering=new Set,this._disposer=new ei,this.signaling.onMessage.add(t=>{const n=t.src.id+t.src.name;this._excludeConnectionIndicateBuffering.has(n)||(this._indicateMessageBuffer[n]||(this._indicateMessageBuffer[n]=[]),this._indicateMessageBuffer[n].push(t))}).disposer(this._disposer)}resolveMessagingBuffer({id:e,name:t}){const n=e+t,r=this._indicateMessageBuffer[n];(r==null?void 0:r.length)>0&&(PP.debug("resolveMessagingBuffer",{length:r.length}),r.forEach(i=>{this.signaling.onMessage.emit(i)}),delete this._indicateMessageBuffer[n]),this._excludeConnectionIndicateBuffering.add(n)}close(){this._disposer.dispose(),this._indicateMessageBuffer={},this._excludeConnectionIndicateBuffering=new Set}};Y();Y();Y();var bc=qr(Oi());Y();Y();Y();Y();var qb=class{constructor(e,t){this.id=e,this.contentType=t,this.side="remote",this.onConnectionStateChanged=new We,this._onConnectionStateChanged=new We,this._connectionState="new",this._getTransport=()=>{},this.getStats=()=>this._getStats(),this._getStats=()=>H(null,null,function*(){return[]}),this._onConnectionStateChanged.pipe(this.onConnectionStateChanged)}_setConnectionState(e){this._connectionState!==e&&(this._connectionState=e,this._onConnectionStateChanged.emit(e))}getRTCPeerConnection(){return this._getRTCPeerConnection()}_getRTCPeerConnection(){var e;return(e=this._getTransport())==null?void 0:e.rtcPeerConnection}getConnectionState(){return this._getConnectionState()}_getConnectionState(){return this._connectionState}toJSON(){return{contentType:this.contentType,id:this.id,codec:this.codec,side:this.side}}},zb=class extends qb{constructor(e,t,n){super(e,t),this.id=e,this.contentType=t,this.track=n}get isEnabled(){return this.track.enabled}setIsEnabled(e){this.track.enabled=e}attach(e){this._element=e,ub(e,this.track)}detach(){this._element&&(db(this._element,this.track),this._element=void 0)}},TP=class extends zb{constructor(e,t){super(e,"audio",t),this.track=t,this.contentType="audio"}};Y();var RP=class extends qb{constructor(e,t){super(e,"data"),this._datachannel=t,this._isEnabled=!0,this.contentType="data",this.onData=new We,t.onmessage=({data:n})=>{this.isEnabled&&(typeof n=="string"&&n.includes(Xf)&&(n=JSON.parse(n.slice(Xf.length))),this.onData.emit(n))}}get isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}};Y();var AP=class extends zb{constructor(e,t){super(e,"video",t),this.track=t,this.contentType="video"}},IP=new ze("packages/core/src/media/stream/remote/factory.ts"),Yf=(e,t,n)=>{if(t instanceof RTCDataChannel){const r=new RP(e,t);return r.codec=n,r}else if(t.kind==="audio"){const r=new TP(e,t);return r.codec=n,r}else if(t.kind==="video"){const r=new AP(e,t);return r.codec=n,r}throw De({operationName:"createRemoteStream",path:IP.prefix,info:Se(ie({},Ue.invalidArgumentValue),{detail:"invalid stream type"})})};Y();var FP=new ze("packages/core/src/plugin/internal/person/util.ts"),Uc=(e,t)=>H(null,null,function*(){const n=FP.createBlock({label:"setEncodingParams"}),r=e.getParameters();n.debug("getParameters",{params:r,newEncodings:t}),r.encodings==null&&(r.encodings=[]),r.encodings=t.map((i,a)=>ie(ie({},r.encodings[a]||{}),i)),yield e.setParameters(r)}),Kb=()=>c1()==="Safari12"||c1()==="Safari11";function DP(e){switch(e){case"closed":case"disconnected":case"failed":return"disconnected";case"connected":return"connected";case"connecting":return"connecting";case"new":return"new";case"reconnecting":return"reconnecting"}}var NP=e=>{const t=[];return e.forEach(n=>{t.push(JSON.parse(JSON.stringify(n)))}),t};Y();var $b=class Wb{constructor(t,n){this.publicationId=t,this.streamId=n}static fromLabel(t){const{p:n,s:r}=JSON.parse(t);return new Wb(n,r)}toLabel(){return JSON.stringify({p:this.publicationId,s:this.streamId})}};Y();var Si=new ze("packages/core/src/plugin/internal/person/connection/peer.ts"),Gb=class{constructor(e,t,n,r,i,a,o){this._context=e,this._iceManager=t,this.signaling=n,this.analytics=r,this.localPerson=i,this.endpoint=a,this.role=o,this._pendingCandidates=[],this.pc=new RTCPeerConnection(Se(ie({},this._context.config.rtcConfig),{iceTransportPolicy:this._context.config.rtcConfig.turnPolicy==="turnOnly"?"relay":void 0,iceServers:this._iceManager.iceServers})),this.onSignalingStateChanged=new We,this.onPeerConnectionStateChanged=new We,this.onDisconnect=new We,this.connected=!1,this.disconnected=!1,this.rtcPeerConnectionId=Wo(),this._onICECandidate=h=>H(this,null,function*(){if(h.candidate==null||h.candidate===""||this.pc.connectionState==="closed")return;const g={kind:"iceCandidateMessage",payload:{candidate:h.candidate,role:this.role}};Si.debug("[start] send candidate",{message:g,localPerson:this.localPerson}),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceCandidate",data:{candidate:JSON.stringify(h.candidate)},createdAt:Date.now()});try{yield this.signaling.send(this.endpoint,g),Si.debug("[end] send candidate",{message:g,localPerson:this.localPerson})}catch(f){Si.warn("[failed] send candidate",Ln({operationName:"Peer._onICECandidate",channel:this.localPerson.channel,detail:"[failed] send candidate",payload:{message:g}}),f)}}),this._onICECandidateError=h=>H(this,null,function*(){this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceCandidateError",data:{event:JSON.stringify(h)},createdAt:Date.now()})}),this._onIceGatheringStateChange=h=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const g=this.pc.iceGatheringState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceGatheringStateChange",data:{event:g},createdAt:Date.now()})}}),this._onConnectionStateChange=()=>H(this,null,function*(){const h=this.pc.connectionState;switch(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"connectionStateChange",data:{connectionState:h},createdAt:Date.now()}),h){case"connected":this.connected=!0,this._pendingCandidates=[];break}this.onPeerConnectionStateChanged.emit(this.pc.connectionState)}),this._onIceConnectionStateChange=()=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const h=this.pc.iceConnectionState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceConnectionStateChange",data:{iceConnectionState:h},createdAt:Date.now()})}}),this._onSignalingStateChange=()=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const h=this.pc.signalingState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"signalingStateChange",data:{signalingState:h},createdAt:Date.now()})}}),this.waitForSignalingState=(h,g=1e4)=>H(this,null,function*(){this.pc.signalingState!==h&&(yield this.onSignalingStateChanged.watch(()=>this.pc.signalingState===h,g).catch(f=>{throw De({operationName:"Peer.waitForSignalingState",info:Se(ie({},Ue.timeout),{detail:"waitForSignalingState timeout"}),path:Si.prefix,context:this._context,channel:this.localPerson.channel,error:f})}))}),this.waitForConnectionState=(h,g=1e4)=>H(this,null,function*(){h!==this.pc.connectionState&&(yield this.onPeerConnectionStateChanged.watch(()=>h===this.pc.connectionState,g).catch(f=>{throw De({operationName:"Peer.waitForConnectionState",info:Se(ie({},Ue.timeout),{detail:"waitForConnectionState timeout"}),path:Si.prefix,context:this._context,channel:this.localPerson.channel,error:f})}))}),this.waitForStats=h=>H(this,[h],function*({track:g,cb:f,interval:_,timeout:w,logging:C}){_??(_=100),w??(w=1e4);for(let R=0;;R+=_){if(R>=w)throw De({operationName:"Peer.waitForStats",info:Se(ie({},Ue.timeout),{detail:"waitForStats timeout"}),path:Si.prefix,context:this._context,channel:this.localPerson.channel});const S=yield this.pc.getStats(g),b=NP(S);if(C&&Si.debug("Peer.waitForStats",b),f(b))break;yield new Promise(x=>setTimeout(x,_))}});var u;Si.debug("peerConfig",this.pc.getConfiguration()),this.setPeerConnectionListener();const p=(u=this.pc)==null?void 0:u.peerIdentity;p&&p.catch(h=>{Si.debug("firefox peerIdentity",h)})}setPeerConnectionListener(){this.pc.onicecandidate=this._onICECandidate,this.pc.onicecandidateerror=this._onICECandidateError,this.pc.onicegatheringstatechange=this._onIceGatheringStateChange,this.pc.onconnectionstatechange=this._onConnectionStateChange,this.pc.oniceconnectionstatechange=this._onIceConnectionStateChange,this.pc.onsignalingstatechange=()=>{this._onSignalingStateChange(),this.onSignalingStateChanged.emit(this.pc.signalingState)}}unSetPeerConnectionListener(){this.pc.onicecandidate=null,this.pc.onicecandidateerror=null,this.pc.onicegatheringstatechange=null,this.pc.onconnectionstatechange=null,this.pc.oniceconnectionstatechange=null,this.pc.onsignalingstatechange=null}handleCandidate(e){return H(this,null,function*(){this._pendingCandidates.push(e),this.pc.remoteDescription&&(yield this.resolveCandidates())})}resolveCandidates(){return H(this,null,function*(){const e=[...this._pendingCandidates];this._pendingCandidates=[],Si.debug("addIceCandidates",e),yield Promise.all(e.map(t=>{this.pc.signalingState!=="closed"&&this.pc.addIceCandidate(t).catch(n=>{Si.warn("[failed] add ice candidate",Ln({operationName:"Peer.resolveCandidates",channel:this.localPerson.channel,detail:"[failed] send candidate",payload:{endpointId:this.endpoint.id}}),n)})}))})}},Os=new ze("packages/core/src/plugin/internal/person/connection/receiver.ts"),OP=class extends Gb{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a,"receiver"),this.id=ji(),this.onConnectionStateChanged=new We,this.onStreamAdded=new We,this.onError=new We,this._connectionState="new",this._publicationInfo={},this.streams={},this._subscriptions={},this._promiseQueue=new ua,this._disposer=new ei,this._log=Os.createBlock({localPersonId:this.localPerson.id,id:this.id}),this._log.debug("spawned"),this.signaling.onMessage.add(o=>H(this,[o],function*({src:u,data:p}){if(!(u.id===a.id&&u.name===a.name))return;const h=p;switch(h.kind){case"senderProduceMessage":this._promiseQueue.push(()=>this._handleSenderProduce(h.payload)).catch(g=>this._log.error("handle senderProduceMessage failed",g,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"senderUnproduceMessage":this._promiseQueue.push(()=>this._handleSenderUnproduce(h.payload)).catch(g=>this._log.error("handle handleSenderUnproduce",g,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"senderRestartIceMessage":this._promiseQueue.push(()=>this._handleSenderRestartIce(h.payload)).catch(g=>this._log.error("_handleSenderRestartIce",g,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"iceCandidateMessage":{const{role:g,candidate:f}=h.payload;g==="sender"&&(yield this.handleCandidate(f))}break}})).disposer(this._disposer),this.pc.ontrack=o=>H(this,[o],function*({track:u,transceiver:p}){if(!p.mid)throw De({operationName:"Receiver.pc.ontrack",info:Se(ie({},Ue.missingProperty),{detail:"mid missing"}),path:Os.prefix,context:this._context,channel:this.localPerson.channel});const h=Object.values(this._publicationInfo).find(w=>{var C;return w.mid===((C=p.mid)==null?void 0:C.toString())});if(!h){const w=De({operationName:"Receiver.pc.ontrack",info:Se(ie({},Ue.notFound),{detail:"publicationInfo not found"}),path:Os.prefix,context:this._context,channel:i.channel,payload:{endpointId:this.endpoint.id,publicationInfo:this._publicationInfo,mid:p.mid}});this.onError.emit(w),this._log.error(w);return}const g=bc.parse(this.pc.remoteDescription.sdp),f=this._getCodecFromSdp(g,p,u.kind),_=Yf(h.streamId,u,f);_.codec=f,this._setupTransportAccessForStream(_),this.streams[h.publicationId]=_,this._log.debug("MediaStreamTrack added",h,u,f),this.onStreamAdded.emit({publicationId:h.publicationId,stream:_})}),this.pc.ondatachannel=o=>H(this,[o],function*({channel:u}){const{publicationId:p,streamId:h}=$b.fromLabel(u.label),g={mimeType:"datachannel"},f=Yf(h,u,g);this._setupTransportAccessForStream(f),this.streams[p]=f,this._log.debug("DataChannel added",p,u,g),this.onStreamAdded.emit({publicationId:p,stream:f})}),this.onPeerConnectionStateChanged.add(o=>{switch(o){case"connecting":case"connected":this._setConnectionState(o);break;case"failed":case"closed":this._setConnectionState("disconnected");break}}).disposer(this._disposer)}_setConnectionState(e){this._connectionState!==e&&(this._log.debug("onConnectionStateChanged",this.id,this._connectionState,e),this._connectionState=e,this.onConnectionStateChanged.emit(e))}_setupTransportAccessForStream(e){e._getTransport=()=>({rtcPeerConnection:this.pc,connectionState:DP(this.pc.connectionState)}),e._getStats=()=>H(this,null,function*(){if(e.contentType==="data"){const r=yield this.pc.getStats();return Oo(r)}const t=yield this.pc.getStats(e.track);return Oo(t)}),this._disposer.push(()=>{e._getTransport=()=>{}}),this.onConnectionStateChanged.add(t=>{e._setConnectionState(t),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"skywayConnectionStateChange",data:{skywayConnectionState:t},createdAt:Date.now()})}).disposer(this._disposer)}_getCodecFromSdp(e,t,n){var r;const i=e.media.find(f=>{var _,w;return((_=f.mid)==null?void 0:_.toString())===((w=t.mid)==null?void 0:w.toString())});if(!i)throw De({operationName:"Receiver._getCodecFromSdp",info:Se(ie({},Ue.notFound),{detail:"m-line not exist"}),path:Os.prefix,context:this._context,channel:this.localPerson.channel});const a=(r=i.payloads)==null?void 0:r.toString().split(" ")[0],o=i.rtp.find(f=>f.payload.toString()===a),u=`${n}/${o.codec}`.toLowerCase();let p={};const h=i.fmtp.find(f=>f.payload.toString()===a);return h!=null&&h.config&&(p=ab(h.config)),{mimeType:u,parameters:p}}get hasMedia(){const e=Object.values(this.streams).length;return this._log.debug("hasMedia",{count:e}),e>0}close(){this._log.debug("closed"),this.unSetPeerConnectionListener(),this.pc.close(),this._setConnectionState("disconnected"),this._disposer.dispose()}add(e){this._subscriptions[e.id]=e}remove(e){const t=this._subscriptions[e];if(!t)return;delete this._subscriptions[t.id];const n=t.publication.id;this.streams[n]&&delete this.streams[n]}_validateRemoteOffer(e){const t=bc.parse(e);this._log.debug("_validateRemoteOffer",{sdpObject:t});for(const n of t.media){if(n.direction==="inactive")continue;if(!Object.values(this._publicationInfo).find(i=>{var a;return((a=n.mid)==null?void 0:a.toString())===i.mid})){const i=De({operationName:"Receiver._validateRemoteOffer",info:Se(ie({},Ue.notFound),{detail:"mismatch between sdp and state"}),path:Os.prefix,context:this._context,channel:this.localPerson.channel,payload:{sdpMedia:t.media,sdpMediaLine:n,info:this._publicationInfo}});throw this.onError.emit(i),i}}}get isWrongSignalingState(){return this.pc.signalingState==="have-local-offer"&&this.pc.remoteDescription||this.pc.signalingState==="have-remote-offer"}_handleSenderProduce(e){return H(this,arguments,function*({sdp:t,publicationId:n,info:r}){if(this.pc.signalingState!=="closed"){if(this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("_handleSenderProduce wait for be stable",Ln({operationName:"Receiver._handleSenderProduce",channel:this.localPerson.channel,detail:"_handleSenderProduce wait for be stable",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderProduce({sdp:t,publicationId:n,info:r});return}throw De({operationName:"Receiver._handleSenderProduce",context:this._context,channel:this.localPerson.channel,info:Se(ie({},Ue.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Os.prefix})}this._log.debug("_handleSenderProduce",{info:r,publicationId:n,publicationInfo:Object.values(this._publicationInfo)}),this._publicationInfo[r.publicationId]=r,this._validateRemoteOffer(t.sdp),yield this.sendAnswer(t),yield this.resolveCandidates()}})}_handleSenderUnproduce(e){return H(this,arguments,function*({sdp:t,publicationId:n}){if(this.pc.signalingState==="closed"){this._log.warn("signalingState closed",Ln({channel:this.localPerson.channel,detail:"signalingState closed",operationName:"Receiver._handleSenderUnproduce"}));return}if(this._log.debug("<handleSenderUnproduce> start",{sdp:t,publicationId:n}),this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("signalingState is not stable",Ln({channel:this.localPerson.channel,detail:"signalingState is not stable",operationName:"Receiver._handleSenderUnproduce",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderUnproduce({sdp:t,publicationId:n});return}throw De({operationName:"Receiver._handleSenderProduce",context:this._context,channel:this.localPerson.channel,info:Se(ie({},Ue.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Os.prefix})}delete this._publicationInfo[n],yield this.sendAnswer(t),yield this.resolveCandidates(),this._log.debug("<handleSenderUnproduce> end",{publicationId:n})})}_handleSenderRestartIce(e){return H(this,arguments,function*({sdp:t}){if(this.pc.signalingState!=="closed"){if(this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("signalingState is not stable",Ln({channel:this.localPerson.channel,detail:"signalingState is not stable",operationName:"Receiver._handleSenderRestartIce",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderRestartIce({sdp:t});return}throw De({operationName:"Receiver._handleSenderRestartIce",context:this._context,channel:this.localPerson.channel,info:Se(ie({},Ue.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Os.prefix})}this._setConnectionState("reconnecting"),yield this.sendAnswer(t),yield this.resolveCandidates(),this.pc.connectionState==="connected"&&this._setConnectionState("connected")}})}sendAnswer(e){return H(this,null,function*(){this._log.debug("[receiver] start: sendAnswer"),yield this.pc.setRemoteDescription(e);const t=yield this.pc.createAnswer();this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"answer",data:{answer:JSON.stringify(t)},createdAt:Date.now()});const n=bc.parse(this.pc.remoteDescription.sdp),r=bc.parse(t.sdp);n.media.forEach((o,u)=>{const p=r.media[u];p.fmtp=xE(p.fmtp).map(h=>{const g=o.fmtp.find(f=>f.payload===h.payload);return g||h})});const i=bc.write(r);yield this.pc.setLocalDescription({type:"answer",sdp:i});const a={kind:"receiverAnswerMessage",payload:{sdp:this.pc.localDescription}};yield this.signaling.send(this.endpoint,a).catch(o=>this._log.error("failed to send answer",o,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id})),this._log.debug("[receiver] end: sendAnswer")})}get subscriptions(){return this._subscriptions}};Y();var MP=qr(S_()),R1=qr(Oi()),br=new ze("packages/core/src/plugin/internal/person/connection/sender.ts"),LP=class extends Gb{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a,"sender"),this.id=ji(),this.onConnectionStateChanged=new We,this.publications={},this.transceivers={},this.datachannels={},this._pendingPublications=[],this._isNegotiating=!1,this.promiseQueue=new ua,this._disposer=new ei,this._ms=new MediaStream,this._backoffIceRestarted=new ki({times:8,interval:100,jitter:100}),this._connectionState="new",this._log=br.createBlock({localPersonId:this.localPerson.id,id:this.id}),this._unsubscribeStreamEnableChange={},this._cleanupStreamCallbacks={},this.restartIce=()=>H(this,null,function*(){if(this._backoffIceRestarted.exceeded){this._log.error(De({operationName:"Sender.restartIce",context:this._context,channel:this.localPerson.channel,info:Se(ie({},Ue.internal),{detail:"restartIce limit exceeded"}),path:br.prefix})),this._setConnectionState("disconnected");return}this._log.warn("[start] restartIce",Ln({operationName:"Sender.restartIce",detail:"start restartIce",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}));const o=()=>{if(this.endpoint.state==="left")return this._log.warn("endpointMemberLeft",Ln({operationName:"restartIce",detail:"endpointMemberLeft",channel:this.localPerson.channel,payload:{endpointId:this.endpoint.id}})),this._setConnectionState("disconnected"),!0;if(this.pc.connectionState==="connected")return this._log.warn("[end] restartIce",Ln({operationName:"restartIce",detail:"reconnected",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}})),this._backoffIceRestarted.reset(),this._setConnectionState("connected"),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"restartIce",data:void 0,createdAt:Date.now()}),!0};if(this._setConnectionState("reconnecting"),yield this._backoffIceRestarted.wait(),o())return;let u=yield this._iceManager.updateIceParams().catch(g=>g);if(u){this._log.warn("[failed] restartIce",Ln({operationName:"restartIce",detail:"update IceParams failed",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}),u),yield this.restartIce();return}if(this.pc.setConfiguration&&(this.pc.setConfiguration(Se(ie({},this.pc.getConfiguration()),{iceServers:this._iceManager.iceServers})),this._log.debug("<restartIce> setConfiguration",{iceServers:this._iceManager.iceServers})),o())return;if(this.signaling.connectionState!=="connected"){if(this._log.warn("<restartIce> reconnect signaling service",Ln({operationName:"restartIce",detail:"reconnect signaling service",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}})),u=yield this.signaling.onConnectionStateChanged.watch(g=>g==="connected",1e4).catch(g=>g).then(()=>{}),u instanceof wr){yield this.restartIce();return}if(o())return}const p=yield this.pc.createOffer({iceRestart:!0});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(p)},createdAt:Date.now()}),yield this.pc.setLocalDescription(p);const h={kind:"senderRestartIceMessage",payload:{sdp:this.pc.localDescription}};if(u=yield this.signaling.send(this.endpoint,h,1e4).catch(g=>g),u){this._log.warn("<restartIce> [failed]",Ln({operationName:"restartIce",detail:"timeout send signaling message",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}),u),yield this.restartIce();return}u=yield this.waitForConnectionState("connected",this._context.config.rtcConfig.iceDisconnectBufferTimeout).catch(g=>g),!(!u&&o())&&(yield this.restartIce())}),this._log.debug("spawned"),this.signaling.onMessage.add(o=>H(this,[o],function*({src:u,data:p}){if(!(u.id===a.id&&u.name===a.name))return;const h=p;switch(h.kind){case"receiverAnswerMessage":this.promiseQueue.push(()=>this._handleReceiverAnswer(h.payload)).catch(g=>this._log.error("handle receiverAnswerMessage",{localPersonId:this.localPerson.id,endpointId:this.endpoint.id,err:g}));break;case"iceCandidateMessage":{const{role:g,candidate:f}=h.payload;g==="receiver"&&(yield this.handleCandidate(f))}break}})).disposer(this._disposer),this.onPeerConnectionStateChanged.add(o=>H(this,null,function*(){try{switch(br.debug("onPeerConnectionStateChanged",{state:o}),o){case"disconnected":case"failed":(yield this.waitForConnectionState("connected",e.config.rtcConfig.iceDisconnectBufferTimeout).catch(p=>p))&&this._connectionState!=="reconnecting"&&(yield this.restartIce());break;case"connecting":case"connected":this._setConnectionState(o);break;case"closed":this._setConnectionState("disconnected");break}}catch(u){br.error("onPeerConnectionStateChanged",u,this.id)}})).disposer(this._disposer)}_setConnectionState(e){this._connectionState!==e&&(this._log.debug("onConnectionStateChanged",this.id,this._connectionState,e),this._connectionState=e,this.onConnectionStateChanged.emit(e))}get hasMedia(){const e=Object.keys(this.publications).length;return this._log.debug("hasMedia",{count:e}),e>0}_getMid(e,t){if(e.contentType==="data"){const n=t.media.find(r=>r.type==="application");if((n==null?void 0:n.mid)==null)throw De({operationName:"Sender._getMid",info:Se(ie({},Ue.missingProperty),{detail:"datachannel mid undefined"}),path:br.prefix,context:this._context,channel:this.localPerson.channel});return n.mid.toString()}else{const r=this.transceivers[e.id].mid;if(r==null)throw De({operationName:"Sender._getMid",info:Se(ie({},Ue.missingProperty),{detail:"media mid undefined"}),path:br.prefix,context:this._context,channel:this.localPerson.channel});return r.toString()}}_listenStreamEnableChange(e,t){this._unsubscribeStreamEnableChange[t]&&this._unsubscribeStreamEnableChange[t]();const{removeListener:n}=e._onEnableChanged.add(r=>H(this,null,function*(){yield this._replaceTrack(t,r).catch(i=>{br.warn(Ln({member:this.localPerson,detail:"_replaceTrack failed",operationName:"Sender._listenStreamEnableChange",payload:i}))})}));this._unsubscribeStreamEnableChange[t]=n}add(e){return H(this,null,function*(){var t,n;if(this._isNegotiating||this.pc.signalingState!=="stable"){this._pendingPublications.push(e),this._log.debug("<add> isNegotiating",{publication:e,isNegotiating:this._isNegotiating,signalingState:this.pc.signalingState,pendingPublications:this._pendingPublications.length});return}this._isNegotiating=!0,this._log.debug("<add> add publication",{publication:e}),this.publications[e.id]=e;const r=e.stream;if(!r)throw De({operationName:"Sender.add",info:Se(ie({},Ue.missingProperty),{detail:"<add> stream not found"}),path:br.prefix,context:this._context,channel:this.localPerson.channel});if(this._cleanupStreamCallbacks[r.id]=this._setupTransportAccessForStream(r),r.contentType==="data"){const p=this.pc.createDataChannel(new $b(e.id,r.id).toLabel(),r.options);r._onWriteData.add(h=>{p.readyState==="open"&&p.send(h)}).disposer(this._disposer),this.datachannels[e.id]=p}else{e._onReplaceStream.add(h=>H(this,[h],function*({newStream:g,oldStream:f}){g._replacingTrack=!0,this._listenStreamEnableChange(g,e.id),this._cleanupStreamCallbacks[f.id]&&this._cleanupStreamCallbacks[f.id](),this._cleanupStreamCallbacks[g.id]=this._setupTransportAccessForStream(g),yield this._replaceTrack(e.id,g.track),g._replacingTrack=!1,g._onReplacingTrackDone.emit()})).disposer(this._disposer),this._listenStreamEnableChange(r,e.id);const p=this.pc.addTransceiver(r.track,{direction:"sendonly",streams:[this._ms]});e._onEncodingsChanged.add(h=>H(this,null,function*(){yield Uc(p.sender,h).catch(g=>{this._log.error("_onEncodingsChanged failed",g)})})).disposer(this._disposer),this.transceivers[e.id]=p}const i=yield this.pc.createOffer().catch(p=>{throw De({operationName:"Sender.add",info:Se(ie({},Ue.internal),{detail:"can't create offer"}),path:br.prefix,context:this._context,channel:this.localPerson.channel,error:p})});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(i)},createdAt:Date.now()}),yield this.pc.setLocalDescription(i);const a=R1.parse(this.pc.localDescription.sdp);this._log.debug("<add> create offer base",a);const o=this._getMid(e,a);if(e.contentType!=="data"){jP((t=e.codecCapabilities)!=null?t:[],o,a);const p=R1.write(a);if(yield this.pc.setLocalDescription({type:"offer",sdp:p}),this._log.debug("<add> create offer",this.pc.localDescription),((n=e.encodings)==null?void 0:n.length)>0)if(Kb())this._safariSetupEncoding(e);else{const h=this.transceivers[e.id];yield Uc(h.sender,[e.encodings[0]])}}const u={kind:"senderProduceMessage",payload:{sdp:this.pc.localDescription,publicationId:e.id,info:{publicationId:e.id,streamId:r.id,mid:o}}};this._log.debug("[start] send message",u),yield this.signaling.send(this.endpoint,u).catch(p=>{throw this._log.error("[failed] send message :",p,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}),p}),this._log.debug("[end] send message",u)})}_setupTransportAccessForStream(e){e._getTransportCallbacks[this.endpoint.id]=()=>({rtcPeerConnection:this.pc,connectionState:this._connectionState}),e._getStatsCallbacks[this.endpoint.id]=()=>H(this,null,function*(){if(e.contentType==="data"){const i=yield this.pc.getStats();return Oo(i)}e._replacingTrack&&(yield e._onReplacingTrackDone.asPromise(200));const n=yield this.pc.getStats(e.track);return Oo(n)});const t=()=>{delete e._getTransportCallbacks[this.endpoint.id],delete e._getStatsCallbacks[this.endpoint.id]};return this._disposer.push(()=>{t()}),this.onConnectionStateChanged.add(n=>{e._setConnectionState(this.endpoint,n),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"skywayConnectionStateChange",data:{skywayConnectionState:n},createdAt:Date.now()})}).disposer(this._disposer),t}remove(e){return H(this,null,function*(){const t=this.publications[e];if(!t){this._log.warn("<remove> publication not found",Ln({operationName:"Sender.remove",detail:"publication already removed",channel:this.localPerson.channel,payload:{publicationId:e}}));return}if(delete this.publications[e],this._isNegotiating||this.pc.signalingState!=="stable"){this._pendingPublications.push(e),this._log.debug("<remove> isNegotiating",{publicationId:e,_isNegotiating:this._isNegotiating,signalingState:this.pc.signalingState});return}this._isNegotiating=!0,this._log.debug("<remove> [start]",{publicationId:e});const n=t.stream;if(!n)throw De({operationName:"Sender.remove",info:Se(ie({},Ue.missingProperty),{detail:"<remove> publication not have stream"}),path:br.prefix,context:this._context,channel:this.localPerson.channel,payload:{publication:t}});n.contentType==="data"?(this.datachannels[e].close(),delete this.datachannels[e]):(this.transceivers[e].stop(),delete this.transceivers[e]);const r=yield this.pc.createOffer().catch(a=>{throw De({operationName:"Sender.remove",info:Se(ie({},Ue.internal),{detail:"<remove> can't create offer"}),path:br.prefix,context:this._context,channel:this.localPerson.channel,error:a})});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(r)},createdAt:Date.now()}),yield this.pc.setLocalDescription(r);const i={kind:"senderUnproduceMessage",payload:{sdp:this.pc.localDescription,publicationId:e}};this._log.debug("<remove> send message",{message:i}),yield this.signaling.send(this.endpoint,i).catch(a=>{throw this._log.error("<remove> in remote error :",a,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}),a}),this._log.debug("<remove> [end]",{publicationId:e})})}_replaceTrack(e,t){return H(this,null,function*(){const n=this.transceivers[e];if(!n){this._log.warn("can't replace track, transceiver not found",Ln({operationName:"Sender._replaceTrack",detail:"transceiver already removed",channel:this.localPerson.channel,payload:{publicationId:e}}));return}yield n.sender.replaceTrack(t).catch(r=>{throw De({operationName:"Sender._replaceTrack",context:this._context,info:Ue.internal,error:r,path:br.prefix,channel:this.localPerson.channel})})})}_handleReceiverAnswer(e){return H(this,arguments,function*({sdp:t}){this.pc.signalingState!=="closed"&&(this._log.debug("<handleReceiverAnswer> [start]"),yield this.pc.setRemoteDescription(new RTCSessionDescription(t)).catch(n=>{const r=De({operationName:"Sender._handleReceiverAnswer",context:this._context,info:Se(ie({},Ue.internal),{detail:"failed to setRemoteDescription"}),path:br.prefix,payload:{sdp:t},channel:this.localPerson.channel,error:n});throw this._log.error(r),r}),this._log.debug("<handleReceiverAnswer> sRD"),yield this.resolveCandidates(),this._log.debug("<handleReceiverAnswer> resolveCandidates"),yield this.waitForSignalingState("stable"),this._log.debug("<handleReceiverAnswer> waitForSignalingState"),this._isNegotiating=!1,yield this._resolvePendingSender(),this._log.debug("<handleReceiverAnswer> _resolvePendingSender",this._pendingPublications.length),this._log.debug("<handleReceiverAnswer> [end]"))})}_safariSetupEncoding(e){const t=this.transceivers[e.id],n=e.stream;this.waitForStats({track:n.track,cb:r=>{const i=r.find(a=>a.id.includes("RTCOutboundRTP")||a.type.includes("outbound-rtp"));return(i==null?void 0:i.keyFramesEncoded)>0},interval:10,timeout:this._context.config.rtcConfig.timeout}).then(()=>{br.debug("safari wait for stats resolved, setEncodingParams"),Uc(t.sender,[e.encodings[0]]).catch(r=>{this._log.error("setEncodingParams failed",r)})}).catch(r=>{this._log.error("waitForStats",r)})}_resolvePendingSender(){return H(this,null,function*(){const e=this._pendingPublications.shift();e&&(this._log.debug("resolve pending sender",{publication:e}),typeof e=="string"?yield this.remove(e):yield this.add(e))})}close(){this._log.debug("closed"),this.unSetPeerConnectionListener(),Object.values(this._unsubscribeStreamEnableChange).forEach(e=>e()),this.pc.close(),this._setConnectionState("disconnected"),this._disposer.dispose()}};function jP(e,t,n){var r,i;const a=n.media.find(h=>{var g;return((g=h.mid)==null?void 0:g.toString())===t});if(!a)throw De({operationName:"applyCodecCapabilities",info:Se(ie({},Ue.notFound),{detail:"media not found"}),path:br.prefix});e.forEach(h=>{var g;if(h.parameters)for(const[f,_]of Object.entries((g=h.parameters)!=null?g:{})){if(_===!1||!h.parameters[f])return;f==="usedtx"&&_&&(h.parameters[f]=1)}});const o=(h,g,f)=>{var _;const w=g.map(S=>Se(ie({},S),{parameters:kE(f,S.payload)})),C=A1(h.mimeType);return C&&(_=w.find(S=>{var b,x;return S.codec.toLowerCase()!==C.toLowerCase()?!1:Object.keys((b=h.parameters)!=null?b:{}).length===0||BP(h.mimeType)==="audio"?!0:(0,MP.default)(S.parameters,(x=h.parameters)!=null?x:{})}))!=null?_:void 0},u=e.map(h=>o(h,a.rtp,a.fmtp)).filter(h=>h!=null),p=[...u,...a.rtp.filter(h=>!u.find(g=>g.payload===h.payload))];for(const h of a.fmtp){const g=h.payload,f=p.find(C=>C.payload===g);if(f){const C=e.find(R=>o(R,[f],a.fmtp));C&&C.parameters&&Object.keys(C.parameters).length>0&&(h.config="",Object.entries(C.parameters).forEach(([R,S])=>{S===!1||h.config.includes(R)||(h.config.length>0?h.config+=`;${R}=${S}`:h.config=`${R}=${S}`)}))}const _=p.find(C=>C.codec.toLowerCase()==="opus"),w=(i=(r=e.find(C=>A1(C.mimeType).toLowerCase()==="opus"))==null?void 0:r.parameters)==null?void 0:i.usedtx;_&&w!==!1&&h.payload===_.payload&&!h.config.includes("usedtx")&&(h.config.length>0?h.config+=";usedtx=1":h.config="usedtx=1")}a.payloads=p.map(h=>h.payload.toString()).join(" ")}var A1=e=>e.split("/")[1],BP=e=>e.split("/")[0],bu=new ze("packages/core/src/plugin/internal/person/connection/index.ts"),UP=class{constructor(e,t,n,r,i,a,o){this._iceManager=e,this._signaling=t,this._analytics=n,this._context=r,this.channelId=i,this.localPerson=a,this.remoteMember=o,this.id=ji(),this.type="p2p",this.onDisconnect=new We,this.onClose=new We,this.closed=!1,this.disconnected=!1,this._log=bu.createBlock({id:this.id,localPersonId:this.localPerson.id}),this._pubsubQueue=new ua,this.sendSubscriptionStatsReportTimers=new Map,this._waitingSendSubscriptionStatsReportsFromPublish=new Map,this._waitingSendSubscriptionStatsReportsFromSubscribe=[],this.sender=new LP(this._context,this._iceManager,this._signaling,this._analytics,this.localPerson,this.remoteMember),this.receiver=new OP(this._context,this._iceManager,this._signaling,this._analytics,this.localPerson,this.remoteMember),this.sender.onDisconnect.once(()=>{this.disconnected=!0,this.onDisconnect.emit()}),this.receiver.onDisconnect.once(()=>{this.disconnected=!0,this.onDisconnect.emit()}),this._analytics&&this._analytics.onConnectionStateChanged.add(u=>{if(u==="connected"){if(this._waitingSendSubscriptionStatsReportsFromPublish.size>0){for(const[p,h]of this._waitingSendSubscriptionStatsReportsFromPublish){const g=this.sender.publications[h];g&&this.startSendSubscriptionStatsReportTimer(g,p)}this._waitingSendSubscriptionStatsReportsFromPublish.clear()}if(this._waitingSendSubscriptionStatsReportsFromSubscribe.length>0){for(const p of this._waitingSendSubscriptionStatsReportsFromSubscribe){const h=this.receiver.subscriptions[p];h&&this.startSendSubscriptionStatsReportTimer(h,p)}this._waitingSendSubscriptionStatsReportsFromSubscribe=[]}}})}startPublishing(e,t){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("startPublishing",{publication:e}),yield this.sender.add(e)})),this._analytics&&!this._analytics.isClosed()&&(this._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:t,role:"sender",rtcPeerConnectionId:this.sender.rtcPeerConnectionId}),this._analytics.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer(e,t):this._waitingSendSubscriptionStatsReportsFromPublish.set(t,e.id))})}stopPublishing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("<stopPublishing> start",{publication:e}),this.sender.remove(e.id).then(()=>{this._log.debug("<stopPublishing> removed",{publication:e})}).catch(n=>{this._log.error("<stopPublishing> remove failed",n,{publication:e})}),this._closeIfNeeded(),this._log.debug("<stopPublishing> end",{publication:e})}));const t=this.sendSubscriptionStatsReportTimers.get(e.id);t&&(clearInterval(t),this.sendSubscriptionStatsReportTimers.delete(e.id))})}startSubscribing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("startSubscribing",{subscription:e}),this.receiver.add(e);const t=e.publication.id;let n=this.receiver.streams[t];n||(yield this.receiver.onStreamAdded.watch(r=>r.publicationId===t,this._context.config.rtcConfig.timeout).catch(()=>{throw De({operationName:"P2PConnection.startSubscribing",info:Se(ie({},Ue.timeout),{detail:"onStreamAdded"}),path:bu.prefix,context:this._context,channel:this.localPerson.channel,payload:{subscription:e}})}),n=this.receiver.streams[t]),n.setIsEnabled(e.publication.state==="enabled"),e.codec=n.codec,e._setStream(n),this._analytics&&!this._analytics.isClosed()&&(this._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:e.id,role:"receiver",rtcPeerConnectionId:this.receiver.rtcPeerConnectionId}),this._analytics.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer(e,e.id):this._waitingSendSubscriptionStatsReportsFromSubscribe.push(e.id))}))})}stopSubscribing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("stopSubscribing",{subscription:e}),this.receiver.remove(e.id),this._closeIfNeeded()}));const t=this.sendSubscriptionStatsReportTimers.get(e.id);t&&(clearInterval(t),this.sendSubscriptionStatsReportTimers.delete(e.id))})}_closeIfNeeded(){this.sender.hasMedia||this.receiver.hasMedia||this.close({reason:"no media"})}getStats(e){return H(this,null,function*(){const t=e.stream;if(!t)throw De({operationName:"P2PConnection.getStats",info:Se(ie({},Ue.invalidArgumentValue),{detail:"Subscription or Publication must has stream"}),path:bu.prefix,context:this._context,channel:this.localPerson.channel});return t.side==="local"?t.contentType==="data"?this.sender.pc.getStats():this.sender.pc.getStats(t.track):t.contentType==="data"?this.receiver.pc.getStats():this.receiver.pc.getStats(t.track)})}close({reason:e}={}){if(!this.closed){this.closed=!0,this._log.debug("closed",{endpointId:this.remoteMember.id,reason:e,sender:this.sender.id,receiver:this.receiver.id,id:this.id}),this.sender.close(),this.receiver.close();for(const t of this.sendSubscriptionStatsReportTimers.values())clearInterval(t);this.sendSubscriptionStatsReportTimers.clear(),this._waitingSendSubscriptionStatsReportsFromPublish.clear(),this._waitingSendSubscriptionStatsReportsFromSubscribe=[],this.onClose.emit()}}startSendSubscriptionStatsReportTimer(e,t){if(this._analytics){const n=e instanceof Ob?"sender":"receiver",r=this._analytics.client.getIntervalSec();this.sendSubscriptionStatsReportTimers.set(e.id,setInterval(()=>H(this,null,function*(){if(!this._analytics)throw De({operationName:"P2PConnection.sendSubscriptionStatsReportTimer",info:Se(ie({},Ue.missingProperty),{detail:"AnalyticsSession not exist"}),path:bu.prefix,context:this._context,channel:this.localPerson.channel});if(this._analytics.isClosed()){const a=this.sendSubscriptionStatsReportTimers.get(e.id);a&&(clearInterval(a),this.sendSubscriptionStatsReportTimers.delete(e.id));return}const i=yield this.getStats(e);i&&this._analytics.client.sendSubscriptionStatsReport(i,{subscriptionId:t,role:n,contentType:e.contentType,createdAt:Date.now()})}),r*1e3))}}},Sc=new ze("packages/core/src/plugin/internal/person/member.ts"),Ju=class extends vh{constructor(e){super(e),this.args=e,this.type="person",this.subtype="person",this.side="remote",this._connections={},this._context=this.args.channel._context,this._disposer=new ei,this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.subscribe=t=>new Promise((n,r)=>{let i=!1;this.channel._subscribe(this.id,t).catch(a=>{i=!0,r(a)}),this.onPublicationSubscribed.watch(({subscription:a})=>a.publication.id===t,this._context.config.rtcApi.timeout).then(({subscription:a})=>{n({subscription:a})}).catch(()=>{i||r(De({operationName:"RemotePersonImpl.subscribe",info:Se(ie({},Ue.timeout),{detail:"onPublicationSubscribed"}),path:Sc.prefix,context:this._context,channel:this.channel}))})}),this.plugin=e.plugin,this.channel.onPublicationUnsubscribed.add(({subscription:t})=>{t.subscriber.id===this.id&&(this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this.channel.onPublicationSubscribed.add(({subscription:t})=>{t.subscriber.id===this.id&&(this.onPublicationSubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this.channel.onStreamPublished.add(({publication:t})=>{t.publisher.id===this.id&&this.onPublicationListChanged.emit()}).disposer(this._disposer),this.channel.onStreamUnpublished.add(({publication:t})=>{t.publisher.id===this.id&&this.onPublicationListChanged.emit()}).disposer(this._disposer),this.onLeft.once(()=>{Sc.debug("RemotePerson left: ",this.toJSON()),Object.values(this._connections).forEach(t=>{t.close({reason:"remote person left"})}),this._connections={}})}_getConnection(e){return this._connections[e]}_getOrCreateConnection(e){var t;return(t=this._getConnection(e.id))!=null?t:this._createConnection(this.channel,e,this)}_createConnection(e,t,n){if(t.side!=="local")throw De({operationName:"RemotePersonImpl._createConnection",info:Se(ie({},Ue.invalidArgumentValue),{detail:"wrong localPerson type"}),path:Sc.prefix,context:this._context,channel:this.channel});if(!t._signaling)throw De({operationName:"RemotePersonImpl._createConnection",info:Se(ie({},Ue.missingProperty),{detail:"signalingSession not exist"}),path:Sc.prefix,context:this._context,channel:this.channel});const r=new UP(t.iceManager,t._signaling,t._analytics,this._context,e.id,t,n);return this.plugin._messageBuffers[t.id].resolveMessagingBuffer(n),r.onClose.once(()=>{Sc.debug("connection closed",this.toJSON(),{connectionId:r.id}),delete this._connections[t.id]}),this._connections[t.id]=r,r}unsubscribe(e){return H(this,null,function*(){yield this.channel._unsubscribe(e)})}_dispose(){this._disposer.dispose()}},HP=class extends gg{constructor(){super(...arguments),this.subtype="person",this._messageBuffers={},this._whenCreateLocalPerson=e=>H(this,null,function*(){e._signaling&&(this._messageBuffers[e.id]=new kP(e._signaling))}),this._whenDisposeLocalPerson=e=>H(this,null,function*(){const t=this._messageBuffers[e.id];t&&(t.close(),delete this._messageBuffers[e.id])}),this._createRemoteMember=(e,t)=>new Ju(Se(ie({},this._context),{context:this._context,channel:e,metadata:t.metadata,id:t.id,name:t.name,plugin:this}))}},VP=e=>{const t=new HP;return e.registerPlugin(t),t};Y();var qP=class extends gg{constructor(){super(...arguments),this.subtype="unknown",this._createRemoteMember=(e,t)=>new cb(Se(ie({},this._context),{context:this._context,channel:e,metadata:t.metadata,id:t.id,name:t.name,plugin:this,subtype:t.subtype}))}};Y();var zP="1.15.0",Nr=new ze("packages/core/src/context.ts"),vg=class Jb{constructor(t,n,r,i){this.config=n,this.authToken=r,this.info=i,this.disposed=!1,this.plugins=[],this._unknownPlugin=new qP,this._reminderSec=this.config.token.updateReminderSec,this._events=new ts,this.onTokenUpdateReminder=this._events.make(),this.onTokenExpired=this._events.make(),this.onFatalError=this._events.make(),this._onTokenUpdated=this._events.make(),this._onDisposed=this._events.make(),this._authTokenString=r.tokenString,this.appId=this.authToken.getAppId(),VP(this),this._api=t,this._api.onFatalError.once(a=>{Nr.error("onFatalError",{appId:this.appId,error:a}),this.onFatalError.emit(De({operationName:"SkyWayContext._api.onFatalError",context:this,info:Ue.rtcApiFatalError,error:a,path:Nr.prefix})),this.dispose()})}static Create(t){return H(this,arguments,function*(n,r={}){const i=new X6(r);ze.level=i.log.level,ze.format=i.log.format;const a=bl.Decode(n),{osName:o,osVersion:u,browserName:p,browserVersion:h}=ob(),g={sdkName:"core",sdkVersion:this.version,osName:o,osVersion:u,browserName:p,browserVersion:h},f={rapi:i.rtcApi.domain,signaling:i.signalingService.domain,ice:i.iceParamServer.domain};Nr.info("core sdk spawned",{operationName:"SkyWayContext.Create",runtime:g,endpoint:f,config:i,token:a});try{const _=a.getAppId(),w=yield uP.Create({appId:_,token:n,log:i.log,rtcApi:i.rtcApi}),C=new Jb(w,i,a,{endpoint:f,runtime:g});return yield C._setTokenExpireTimer(),a.getAnalyticsEnabled()&&(C.analyticsSession=yield CP(C)),C}catch(_){throw De({operationName:"SkyWayContext.Create",info:Ue.connectRtcApiFailed,error:_,path:Nr.prefix})}})}get authTokenString(){return this._authTokenString}_setTokenExpireTimer(){return H(this,null,function*(){const t=yield this._api.getServerUnixtimeInSec(),n=this.authToken.exp-t;if(n<0)throw De({operationName:"SkyWayContext._setTokenExpireTimer",context:this,info:Ue.invalidExpireTokenValue,path:Nr.prefix,payload:{exp:this.authToken.exp,now:t}});this.tokenUpdateReminderTimer&&clearTimeout(this.tokenUpdateReminderTimer);const r=n-this._reminderSec;if(r<0)throw De({operationName:"SkyWayContext._setTokenExpireTimer",context:this,info:Ue.invalidRemindExpireTokenValue,path:Nr.prefix,payload:{expiresInSec:n,reminderSec:this._reminderSec}});Nr.debug("_setTokenExpireTimer",{expiresInSec:n,tokenExpireReminderTimeSec:r}),this.tokenUpdateReminderTimer=setTimeout(()=>{Nr.debug("tokenUpdateReminder",{appid:this.appId}),this.onTokenUpdateReminder.emit()},r*1e3),this.tokenExpiredTimer&&clearTimeout(this.tokenExpiredTimer),this.tokenExpiredTimer=setTimeout(()=>{Nr.debug("tokenExpired",{appid:this.appId}),this.onTokenExpired.emit()},n*1e3)})}updateAuthToken(t){return H(this,null,function*(){const n=bl.Decode(t),r=n.getAppId();if(Nr.info({operationName:"SkyWayContext.updateAuthToken"},{oldToken:this.authToken,newToken:n}),r!==this.appId)throw De({operationName:"SkyWayContext.updateAuthToken",context:this,info:Ue.invalidTokenAppId,path:Nr.prefix,payload:{invalid:r,expect:this.appId}});this._authTokenString=t,this.authToken=n,this._onTokenUpdated.emit(t),yield this._setTokenExpireTimer(),yield this._api.updateAuthToken(t).catch(i=>{var a;throw Nr.warn("[failed] SkyWayContext.updateAuthToken",{detail:i}),i instanceof wr&&((a=i.info)==null?void 0:a.name)==="projectUsageLimitExceeded"&&(this.dispose(),clearTimeout(this.tokenExpiredTimer)),i})})}registerPlugin(t){this.plugins.find(n=>n.subtype===t.subtype)||(t._attachContext(this),this.plugins.push(t))}_createRemoteMember(t,n){const r=t._getMember(n.id);if(r)return r;Nr.debug("createRemoteMember",{memberDto:n}),n.type=n.type.toLowerCase(),n.subtype=n.subtype.toLowerCase();let i=this.plugins.find(o=>o.subtype===n.subtype);return i||(i=this._unknownPlugin),i._createRemoteMember(t,n)}dispose(){this.disposed||(this.disposed=!0,Nr.debug("disposed",{appid:this.appId}),clearTimeout(this.tokenUpdateReminderTimer),this._onDisposed.emit(),this._events.dispose(),this._api.close(),ze._onLogForAnalytics=()=>{})}};vg.version=zP;vg.id=ji();var em=vg;Y();Y();var Op=new ze("packages/core/src/media/factory.ts"),KP=class{constructor(){if(this.onDeviceChange=new We,this._devices=[],!(navigator!=null&&navigator.mediaDevices))throw De({operationName:"StreamFactory.constructor",info:Ue.mediaDevicesNotFound,path:Op.prefix});navigator.mediaDevices.addEventListener("devicechange",()=>H(this,null,function*(){const e=yield this._enumerateDevicesArray(),t=[];this._devices.forEach(r=>{e.map(i=>i.id).includes(r.id)||t.push(r)});const n=[];e.map(r=>r.id).forEach(r=>{this._devices.map(i=>i.id).includes(r)||n.push(e.find(i=>i.id===r))}),Op.debug("device changed",{added:n,removed:t}),t.forEach(r=>{this.onDeviceChange.emit({state:"removed",device:r})}),n.forEach(r=>{this.onDeviceChange.emit({state:"added",device:r})}),this._devices=e}))}_enumerateDevicesArray(){return H(this,null,function*(){return(yield navigator.mediaDevices.enumerateDevices()).map(t=>new $P(t)).filter(t=>t.id.length>0)})}_enumerateDevicesWithAuth(){return H(this,arguments,function*({video:e,audio:t}={audio:!0,video:!0}){let n=[];return(e||t)&&(n=(yield navigator.mediaDevices.getUserMedia({video:e,audio:t})).getTracks()),this._devices=yield this._enumerateDevicesArray(),n.forEach(r=>r.stop()),this._devices})}enumerateDevices(){return H(this,null,function*(){return yield this._enumerateDevicesWithAuth()})}enumerateInputVideoDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({video:!0})).filter(t=>t.kind==="videoinput")})}enumerateInputAudioDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({audio:!0})).filter(t=>t.kind==="audioinput")})}enumerateOutputAudioDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({audio:!0})).filter(t=>t.kind==="audiooutput")})}createCameraVideoStream(){return H(this,arguments,function*(e={}){var t;e.stopTrackWhenDisabled=(t=e.stopTrackWhenDisabled)!=null?t:!0;const[n]=(yield navigator.mediaDevices.getUserMedia({video:e})).getTracks(),r=new Rp(n,e);return r._setLabel("camera"),r})}createMicrophoneAudioStream(){return H(this,arguments,function*(e={}){var t;e.stopTrackWhenDisabled=(t=e.stopTrackWhenDisabled)!=null?t:!0;const[n]=(yield navigator.mediaDevices.getUserMedia({audio:e})).getTracks(),r=new Tp(n,e);return r._setLabel("microphone"),r})}createDisplayStreams(){return H(this,arguments,function*(e={}){var t,n,r;const i=(t=e.video)!=null?t:{};(n=i.stopTrackWhenDisabled)!=null||(i.stopTrackWhenDisabled=!0);let a=e.audio;a&&(a=typeof a=="boolean"?{}:a,(r=a.stopTrackWhenDisabled)!=null||(a.stopTrackWhenDisabled=!0)),e={audio:a,video:i};const o=yield navigator.mediaDevices.getDisplayMedia(e),[u]=o.getVideoTracks(),[p]=o.getAudioTracks();e.audio&&!p&&Op.warn(Ln({operationName:"StreamFactory.createDisplayStreams",detail:"This client does not support device audio capture"}));const h=new Rp(u,Se(ie({},i),{isDisplayMedia:!0}));h._setLabel("displayVideo");const g=p?new Tp(p,Se(ie({},a),{isDisplayMedia:!0})):void 0;return g&&g._setLabel("displayAudio"),{video:h,audio:g}})}createDataStream(){return H(this,arguments,function*(e={}){return new fg(e)})}createMicrophoneAudioAndCameraStream(){return H(this,arguments,function*({audio:e,video:t}={}){var n,r;const i=yield navigator.mediaDevices.getUserMedia({audio:e??!0,video:t??!0}),[a]=i.getAudioTracks(),[o]=i.getVideoTracks();e=e??{},e.stopTrackWhenDisabled=(n=e.stopTrackWhenDisabled)!=null?n:!0;const u=new Tp(a,e);u._setLabel("microphone"),t=t??{},t.stopTrackWhenDisabled=(r=t.stopTrackWhenDisabled)!=null?r:!0;const p=new Rp(o,t);return p._setLabel("camera"),{audio:u,video:p}})}createCustomVideoStream(e){return H(this,arguments,function*(t,n={}){var r,i;n.stopTrackWhenDisabled=(r=n.stopTrackWhenDisabled)!=null?r:!0;const a=new E6(n),o=yield t.createProcessedStream({constraints:(i=n.constraints)!=null?i:{},stopTrackWhenDisabled:n.stopTrackWhenDisabled,onUpdateTrack:u=>a.updateTrack(u)});return yield a.setStream(o),a})}},I1=new KP,$P=class{constructor(e){this.id=e.deviceId,this.label=e.label,this.kind=e.kind}};Y();Y();Y();Y();Y();Y();Y();Y();Y();Y();var Zb={domain:"sfu.skyway.ntt.com",secure:!0,version:4};Y();var Bs={invalidParameter:{name:"invalidParameter",detail:"",solution:""},invalidRequestParameter:{name:"invalidRequestParameter",detail:"リクエストの値が不正です",solution:"正しい値を入力してください"},notFound:{name:"notFound",detail:"対象のリソースが見つかりません",solution:"対象のリソースが存在するか確かめてください"},maxSubscriberExceededError:{name:"maxSubscribersExceededError",detail:"forwardingのmaxSubscribersの制限を超えています。maxSubscribersの値を超えてSubscribeすることはできません",solution:"maxSubscribersの範囲内でご利用ください"},quotaExceededError:{name:"quotaExceededError",detail:"リソースの制限量を超えてリソースを利用することはできません",solution:"リソース制限量の範囲内でご利用ください"},timeout:{name:"timeout",detail:"",solution:""},insufficientPermissions:{name:"insufficientPermissions",detail:"tokenの権限が不足しています",solution:"tokenに必要な権限を付与してください"},backendError:{name:"backendError:",detail:"",solution:""},notAllowedConsumeError:{name:"notAllowedConsumeError",detail:"ForwardingからのConsume許可がありません",solution:"Forwardingしているmemberによる許可操作が必要です"}};Y();function ya({operationName:e,info:t,error:n,path:r,payload:i}){return new wr({error:n,info:t,payload:{payload:i,operationName:e},path:r})}function wc({appId:e,detail:t,channelId:n,operationName:r,payload:i,memberId:a,botId:o}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n,memberId:a,botId:o}}var yr=new ze("packages/sfu-api-client/src/api.ts"),WP=class{constructor(e,t){this._token=e,this._headers={authorization:`Bearer ${this._token}`},this.options=ie(ie({},Zb),t),this.endpoint=`http${this.options.secure?"s":""}://${this.options.domain}/v${this.options.version}`,this.http=new ug(this.endpoint),ze.level=this.options.log.level,ze.format=this.options.log.format,yr.debug("SfuRestApiClient spawned",{endpoint:this.endpoint})}updateToken(e){this._token=e}_commonErrorHandler(e,t){switch(e==null?void 0:e.status){case 401:return ya({operationName:t,info:Bs.invalidRequestParameter,path:yr.prefix,payload:e});case 403:return ya({operationName:t,info:Bs.insufficientPermissions,path:yr.prefix,payload:e});case 404:return ya({operationName:t,info:Bs.notFound,path:yr.prefix,payload:e});case 429:return ya({operationName:t,info:Bs.quotaExceededError,path:yr.prefix,payload:e});default:return ya({operationName:t,info:Bs.backendError,path:yr.prefix,payload:e})}}createBot(e){return H(this,arguments,function*({appId:t,channelId:n}){return(yield this.http.post("/bots",{appId:t,channelId:n},{headers:{authorization:`Bearer ${this._token}`}}).catch(i=>{throw this._commonErrorHandler(i,"SfuRestApiClient.createBot")})).id})}deleteBot(e){return H(this,arguments,function*({botId:t}){yield this.http.delete(`/bots/${t}`,{headers:{authorization:`Bearer ${this._token}`}}).catch(n=>{throw this._commonErrorHandler(n,"SfuRestApiClient.deleteBot")})})}startForwarding(e){return H(this,arguments,function*({botId:t,publicationId:n,maxSubscribers:r,contentType:i,publisherId:a}){const o=new ki,u={publicationId:n,maxSubscribers:r,contentType:i[0].toUpperCase()+i.slice(1),publisherId:a},p=yield this.http.post(`/bots/${t}/forwardings`,u,{headers:{authorization:`Bearer ${this._token}`},retry:h=>H(this,null,function*(){return[400,403,429].includes(h.status)?!1:yield o.wait()})}).catch(h=>{throw this._commonErrorHandler(h,"SfuRestApiClient.startForwarding")});return o.count>0&&yr.warn("success to retry startForwarding",wc({operationName:"SfuRestApiClient.startForwarding",detail:"success to retry startForwarding",botId:t,memberId:a,payload:{publicationId:n,count:o.count}})),p})}createProducer(e){return H(this,arguments,function*({botId:t,forwardingId:n,transportId:r,producerOptions:i}){const a=new ki,o=yield this.http.put(`/bots/${t}/forwardings/${n}/transports/producers`,{transportId:r,producerOptions:i},{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield a.wait()})}).catch(u=>{throw this._commonErrorHandler(u,"SfuRestApiClient.createProducer")});return a.count>0&&yr.warn("success to retry createProducer",wc({operationName:"SfuRestApiClient.createProducer",detail:"success to retry createProducer",botId:t,payload:{forwardingId:n,transportId:r,count:a.count}})),o})}createConsumer(e){return H(this,arguments,function*({botId:t,forwardingId:n,rtpCapabilities:r,subscriptionId:i,subscriberId:a,spatialLayer:o,originPublicationId:u}){const p=new ki({times:5,interval:100}),h={rtpCapabilities:r,subscriptionId:i,subscriberId:a,spatialLayer:o,originPublicationId:u},g=yield this.http.post(`/bots/${t}/forwardings/${n}/transports/consumers`,h,{retry:f=>H(this,null,function*(){return[400,403,429].includes(f.status)?!1:yield p.wait()}),headers:{authorization:`Bearer ${this._token}`}}).catch(f=>{throw f.status===429?ya({operationName:"SfuRestApiClient.createConsumer",info:Bs.maxSubscriberExceededError,path:yr.prefix,payload:f}):f.status===403?ya({operationName:"SfuRestApiClient.createConsumer",info:Bs.notAllowedConsumeError,path:yr.prefix,payload:f}):this._commonErrorHandler(f,"SfuRestApiClient.createConsumer")});return p.count>0&&yr.warn("success to retry createConsumer",wc({operationName:"SfuRestApiClient.createConsumer",detail:"success to retry createConsumer",botId:t,payload:{forwardingId:n,count:p.count}})),yr.debug("response of createConsumer",g),g})}connect(e){return H(this,arguments,function*({transportId:t,dtlsParameters:n}){const r=new ki,i={transportId:t,dtlsParameters:n},a=yield this.http.put("/transports/connections",i,{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield r.wait()})}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.connect")});return r.count>0&&yr.warn("success to retry connect",wc({operationName:"SfuRestApiClient.connect",detail:"success to retry connect",payload:{transportId:t,count:r.count}})),a})}changeConsumerLayer(e){return H(this,arguments,function*({transportId:t,consumerId:n,spatialLayer:r,publicationId:i}){return yield this.http.put(`transports/consumers/${n}/layers`,{transportId:t,spatialLayer:r,publicationId:i},{headers:{authorization:`Bearer ${this._token}`}}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.changeConsumerLayer")})})}stopForwarding({botId:e,forwardingId:t}){let n=!1;return{promise:this.http.delete(`/bots/${e}/forwardings/${t}`,{headers:{authorization:`Bearer ${this._token}`}}).catch(i=>{throw this._commonErrorHandler(i,"SfuRestApiClient.stopForwarding")}).then(i=>{n=i}),fulfilled:n}}iceRestart(e){return H(this,arguments,function*({transportId:t}){return(yield this.http.put("/transports/connections/ice",{transportId:t},{headers:this._headers}).catch(r=>{throw this._commonErrorHandler(r,"SfuRestApiClient.iceRestart")})).iceParameters})}getRtpCapabilities(e){return H(this,arguments,function*({botId:t,forwardingId:n,originPublicationId:r}){const i=new ki,a=yield this.http.get(`/bots/${t}/forwardings/${n}/transports/rtp-capabilities?originPublicationId=${r}`,{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield i.wait()})}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.getRtpCapabilities")});return i.count>0&&yr.warn("getCapabilities to retry connect",wc({operationName:"SfuRestApiClient.getRtpCapabilities",detail:"getCapabilities to retry connect",botId:t,payload:{forwardingId:n,count:i.count}})),a.rtpCapabilities})}confirmSubscription(e){return H(this,arguments,function*({forwardingId:t,subscriptionId:n,identifierKey:r}){const i={forwardingId:t,subscriptionId:n,identifierKey:r},a=yield this.http.post("/confirm-subscription",i,{headers:{authorization:`Bearer ${this._token}`}}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.confirmSubscription")});return yr.debug("response of confirmSubscription",a),a})}},Zt=Se(ie({},Bs),{invalidParameter:{name:"invalidParameter",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internal:{name:"internal",detail:"",solution:""},sfuBotNotInChannel:{name:"sfuBotNotInChannel",detail:"SfuBotがChannelに存在しません",solution:"操作しようとしているSfuBotが正しいか確かめてください"},remotePublisherId:{name:"remotePublisherId",detail:"publisherがremoteのPublicationをForwardingすることはできません",solution:"PublicationがLocalでPublishされたものか確かめてください"},dataStreamNotSupported:{name:"dataStreamNotSupported",detail:"dataStreamはSFUに対応していません",solution:"ありません"},streamNotExistInPublication:{name:"streamNotExistInPublication",detail:"PublicationにStreamがありません。RemoteMemberのPublicationのStreamにはアクセスできません",solution:"参照しているPublicationが目的のものか確かめてください。"},invalidPreferredEncoding:{name:"invalidPreferredEncoding",detail:"preferredEncodingの値が不正です。エンコード設定切り替え機能が使えません",solution:"正しい文字列を入力してください"},invalidEncodings:{name:"invalidEncodings",detail:"エンコード設定が設定されていません。エンコード設定切り替え機能が使えません",solution:"エンコード設定切り替え機能を利用する場合はエンコード設定をしたPublicationをForwardingしてください"},receiverNotFound:{name:"receiverNotFound",detail:"SFUはRemoteMemberのSubscriptionを操作できません",solution:"SFUでsubscriptionの操作をする際にはLocalPersonがSubscribeしているSubscriptionインスタンスを利用してください"},consumerNotFound:{name:"consumerNotFound",detail:"SFUはLocalPersonがUnsubscribeしたSubscriptionを操出来ません",solution:"操作対象のSubscriptionが正しいか確かめてください"},forwardingNotFound:{name:"forwardingNotFound",detail:"存在しないForwardingを操作しようとしています",solution:"対象のForwardingが正しいか確かめてください"},netWorkError:{name:"netWorkError",detail:"通信環境に問題があります",solution:"ネットワーク接続状況を確認してください"},confirmSubscriptionFailed:{name:"confirmSubscriptionFailed",detail:"Forwardingのconsume許可を出すのに失敗しました",solution:"ありません"}});Y();function tm(e,t){let n=0;for(;n<t.length&&t[n].id!==e;n++);return n}function Ea({channel:e,detail:t,operationName:n,payload:r,bot:i}){var a;const o={operationName:n,payload:r,detail:t};return e&&(o.appId=e.appId,o.channelId=e.id,e.localPerson&&(o.memberId=e.localPerson.id)),i&&(o.botId=i.id,o.appId=i.channel.appId,o.channelId=i.channel.id,o.memberId=(a=i.channel.localPerson)==null?void 0:a.id),o}Y();var ii=new ze("packages/sfu-bot/src/connection/receiver.ts"),GP=class{constructor(e,t,n,r,i,a,o){this.subscription=e,this._api=t,this._transportRepository=n,this._localPerson=r,this._bot=i,this._iceManager=a,this._context=o,this._disposer=new ei,this.sendSubscriptionStatsReportTimer=null,this._waitingSendSubscriptionStatsReports=[];const u=this._localPerson._analytics;u&&u.onConnectionStateChanged.add(p=>{if(p==="connected"&&this._waitingSendSubscriptionStatsReports.length>0){for(const h of this._waitingSendSubscriptionStatsReports)this.consumer&&this.consumer.id===h&&this.startSendSubscriptionStatsReportTimer();this._waitingSendSubscriptionStatsReports=[]}})}toJSON(){return{transport:this.transport,subscription:this.subscription}}consume(){return H(this,null,function*(){var e,t;let n=this._transportRepository.rtpCapabilities;n||(ii.debug("[start] getCapabilities"),n=yield this._api.getRtpCapabilities({botId:this._bot.id,forwardingId:this.subscription.publication.id,originPublicationId:this.subscription.publication.origin.id}),ii.debug("[end] getCapabilities"),yield this._transportRepository.loadDevice(n).catch(w=>{throw De({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:Se(ie({},Zt.internal),{detail:"sfu loadDevice failed"}),path:ii.prefix,error:w})}));const r=this.subscription.preferredEncoding?tm(this.subscription.preferredEncoding,(t=(e=this.subscription.publication.origin)==null?void 0:e.encodings)!=null?t:[]):void 0;ii.debug("[start] createConsumer",{subscription:this.subscription});const{consumerOptions:i,transportOptions:a,transportId:o,producerId:u}=yield this._api.createConsumer({botId:this._bot.id,forwardingId:this.subscription.publication.id,rtpCapabilities:n,subscriptionId:this.subscription.id,subscriberId:this.subscription.subscriber.id,spatialLayer:r,originPublicationId:this.subscription.publication.origin.id});a&&this._transportRepository.createTransport(this._localPerson.id,this._bot,a,"recv",this._iceManager,this._localPerson._analytics),this.transport=this._transportRepository.getTransport(this._localPerson.id,o),this.transport||(ii.warn("transport is under race condition",{transportId:o}),yield this._transportRepository.onTransportCreated.watch(w=>w===o,this._bot.options.endpointTimeout).catch(w=>{throw De({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:Se(ie({},Zt.timeout),{detail:"receiver sfuTransport not found"}),path:ii.prefix,error:w,payload:{transportOptions:a,transportId:o,producerId:u,consumerOptions:i,subscription:this.subscription}})}),this.transport=this._transportRepository.getTransport(this._localPerson.id,o)),this._localPerson._analytics&&!this._localPerson._analytics.isClosed()&&this._localPerson._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:this.subscription.id,role:"receiver",rtcPeerConnectionId:this.transport.id}),ii.debug("[end] createConsumer"),ii.debug("[start] consume",{consumerOptions:i,subscription:this.subscription});const p=yield this.transport.msTransport.consume(Se(ie({},i),{producerId:u})).catch(w=>{throw De({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:Se(ie({},Zt.internal),{detail:"consume failed, maybe subscribing unsupported codec"}),path:ii.prefix,error:w})});this.consumer=p,ii.debug("[end] consume",{subscription:this.subscription});const[h]=p.rtpParameters.codecs,g=Yf(Wo(),p.track,h),f={mimeType:h.mimeType,parameters:h.parameters};this._setupTransportAccessForStream(g,p);const _=this._localPerson._analytics;return _&&!_.isClosed()&&(_.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer():this._waitingSendSubscriptionStatsReports.push(p.id)),{stream:g,codec:f}})}_setupTransportAccessForStream(e,t){const n=this.transport,r=this.pc;e._getTransport=()=>({rtcPeerConnection:r,connectionState:n.connectionState,info:this}),e._getStats=()=>H(this,null,function*(){const i=yield t.getStats();let a=Oo(i);return a=a.map(o=>(o.sfuTransportId=n.id,o)),a}),this._disposer.push(()=>{e._getTransport=()=>{}}),n.onConnectionStateChanged.add(i=>{ii.debug("transport connection state changed",n.id,i),e._setConnectionState(i)})}unconsume(){if(!this.consumer){ii.debug("unconsume failed, consumer not exist",{subscription:this.subscription});return}this.consumer.close(),this.consumer=void 0,this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer)}close(){this._disposer.dispose()}get pc(){var e;return(e=this.transport)==null?void 0:e.pc}startSendSubscriptionStatsReportTimer(){const e=this._localPerson._analytics;if(e){const t=e.client.getIntervalSec();this.sendSubscriptionStatsReportTimer=setInterval(()=>H(this,null,function*(){if(!e||e.isClosed()){this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer);return}if(this.consumer){const n=yield this.consumer.getStats();n&&e.client.sendSubscriptionStatsReport(n,{subscriptionId:this.subscription.id,role:"receiver",contentType:this.subscription.contentType,createdAt:Date.now()})}}),t*1e3)}}};Y();var F1=qr(S_());Y();var Su=new ze("packages/sfu-bot/src/connection/sender.ts"),JP=class{constructor(e){this.props=e,this.state="started",this.configure=this.props.configure,this.originPublication=this.props.originPublication,this.relayingPublication=this.props.relayingPublication,this._identifierKey=this.props.identifierKey,this._api=this.props.api,this._context=this.props.context,this.onStopped=new We,this.relayingPublication.onSubscribed.add(t=>H(this,null,function*(){yield this.confirmSubscription(t.subscription).catch(n=>n)})),this.relayingPublication.subscriptions.forEach(t=>H(this,null,function*(){yield this.confirmSubscription(t).catch(n=>n)}))}get id(){return this.relayingPublication.id}_stop(){this.state="stopped",this.onStopped.emit()}toJSON(){return{id:this.id,configure:this.configure,originPublication:this.originPublication,relayingPublication:this.relayingPublication}}confirmSubscription(e){return H(this,null,function*(){Su.debug("[start] Forwarding confirmSubscription");const{message:t}=yield this._api.confirmSubscription({forwardingId:this.id,subscriptionId:e.id,identifierKey:this._identifierKey}).catch(n=>{throw Su.error("Forwarding confirmSubscription failed:",n),De({operationName:"Forwarding.confirmSubscription",context:this._context,info:Zt.confirmSubscriptionFailed,path:Su.prefix,payload:n})});Su.debug("[end] Forwarding confirmSubscription",{message:t})})}},cn=new ze("packages/sfu-bot/src/connection/sender.ts"),ZP=class{constructor(e,t,n,r,i,a,o,u){this.publication=e,this.channel=t,this._api=n,this._transportRepository=r,this._localPerson=i,this._bot=a,this._iceManager=o,this._context=u,this._disposer=new ei,this._connectionState="new",this.onConnectionStateChanged=new We,this.closed=!1,this.sendSubscriptionStatsReportTimer=null,this._waitingSendSubscriptionStatsReports=[];const p=this._localPerson._analytics;p&&p.onConnectionStateChanged.add(h=>{if(h==="connected"&&this._waitingSendSubscriptionStatsReports.length>0){for(const g of this._waitingSendSubscriptionStatsReports)this._producer&&this._producer.id===g&&this.startSendSubscriptionStatsReportTimer();this._waitingSendSubscriptionStatsReports=[]}})}_setConnectionState(e){this._connectionState!==e&&(cn.debug("_setConnectionState",{state:e,forwardingId:this.forwardingId}),this._connectionState=e,this.onConnectionStateChanged.emit(e))}toJSON(){return{forwarding:this.forwarding,broadcasterTransport:this._broadcasterTransport,_connectionState:this._connectionState}}startForwarding(e){return H(this,null,function*(){if(this.publication.contentType==="data")throw De({operationName:"Sender.startForwarding",context:this._context,info:Zt.dataStreamNotSupported,path:cn.prefix,channel:this.channel});const t=this.publication.stream;if(!t)throw De({operationName:"Sender.startForwarding",context:this._context,info:Zt.streamNotExistInPublication,path:cn.prefix,channel:this.channel});this.onConnectionStateChanged.add(w=>{var C;cn.debug("transport connection state changed",(C=this._broadcasterTransport)==null?void 0:C.id,w),t._setConnectionState(this._bot,w)}).disposer(this._disposer),cn.debug("[start] Sender startForwarding",{botId:this._bot.id,publicationId:this.publication.id,contentType:this.publication.contentType,maxSubscribers:e.maxSubscribers});const{forwardingId:n,broadcasterTransportId:r,broadcasterTransportOptions:i,rtpCapabilities:a,identifierKey:o}=yield this._api.startForwarding({botId:this._bot.id,publicationId:this.publication.id,contentType:this.publication.contentType,maxSubscribers:e.maxSubscribers,publisherId:this.publication.publisher.id});if(this.forwardingId=n,i&&(cn.debug("sender create new transport",{broadcasterTransportOptions:i}),yield this._transportRepository.loadDevice(a),this._broadcasterTransport=this._transportRepository.createTransport(this._localPerson.id,this._bot,i,"send",this._iceManager,this._localPerson._analytics)),this._broadcasterTransport=this._transportRepository.getTransport(this._localPerson.id,r),!this._broadcasterTransport)throw De({operationName:"Sender.startForwarding",context:this._context,info:Se(ie({},Zt.internal),{detail:"_broadcasterTransport not found"}),path:cn.prefix,channel:this.channel,payload:{broadcasterTransportOptions:i}});this._broadcasterTransport.onConnectionStateChanged.add(w=>{this._setConnectionState(w)}).disposer(this._disposer),this._setConnectionState(this._broadcasterTransport.connectionState);const u=yield this._produce(t,this._broadcasterTransport);this._cleanupStreamCallbacks=this._setupTransportAccessForStream(t,this._broadcasterTransport,u);const p=this._localPerson._analytics;p&&!p.isClosed()&&(p.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer():this._waitingSendSubscriptionStatsReports.push(u.id)),cn.debug("[end] Sender startForwarding",{forwardingId:n});let h=this.channel._getPublication(n);h||(h=(yield this.channel.onStreamPublished.watch(w=>w.publication.id===n,this._context.config.rtcApi.timeout).catch(()=>{throw De({operationName:"Sender.startForwarding",context:this._context,info:Se(ie({},Zt.timeout),{detail:"SfuBotMember onStreamPublished"}),path:cn.prefix,channel:this.channel,payload:{forwardingId:n}})})).publication);const g=new JP({configure:e,originPublication:this.publication,relayingPublication:h,api:this._api,context:this._context,identifierKey:o});this.forwarding=g;const f=this.channel.subscriptions.find(w=>w.publication.id===this.publication.id),[_]=u.rtpParameters.codecs;return f.codec=_,this._localPerson._analytics&&this._localPerson._analytics.client.connectionState!=="closed"&&this._localPerson._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:f.id,role:"sender",rtcPeerConnectionId:this._broadcasterTransport.id}),Kb()&&o1({stream:t,remoteMember:this._bot.id,end:w=>{const C=w.find(R=>R.id.includes("RTCOutboundRTP")||R.type.includes("outbound-rtp"));return(C==null?void 0:C.keyFramesEncoded)>0},interval:10}).then(()=>H(this,null,function*(){const w=this.publication.encodings;(w==null?void 0:w.length)>0&&(yield Uc(u.rtpSender,w).catch(C=>{cn.error("_onEncodingsChanged failed",C,this)}))})).catch(w=>{cn.error("setEncodingParams waitForLocalStats failed",w,this)}),o1({stream:t,remoteMember:this._bot.id,end:w=>!!w.find(C=>C.type.includes("local-candidate"))}).then(()=>H(this,null,function*(){const w=yield Ct({operationName:"startForwarding/waitForLocalStats",channel:this.channel});cn.debug(w,"forwarding connection connected",{broadcasterTransportId:r})})).catch(()=>{}),g})}_listenStreamEnableChange(e){this._unsubscribeStreamEnableChange&&this._unsubscribeStreamEnableChange();const{removeListener:t}=e._onEnableChanged.add(n=>H(this,null,function*(){yield this._replaceTrack(n).catch(r=>{cn.warn(Ea({detail:"replaceTrack failed",operationName:"Sender._listenStreamEnableChange",bot:this._bot,payload:r}))})}));this._unsubscribeStreamEnableChange=t}_produce(e,t){return H(this,null,function*(){var n,r,i,a,o,u,p,h;this.publication._onReplaceStream.add(b=>H(this,[b],function*({newStream:x}){if(!this._broadcasterTransport)throw De({operationName:"Sender._produce",context:this._context,info:Se(ie({},Zt.internal),{detail:"_broadcasterTransport not found"}),path:cn.prefix,channel:this.channel});this._listenStreamEnableChange(x),this._cleanupStreamCallbacks&&this._cleanupStreamCallbacks(),this._cleanupStreamCallbacks=this._setupTransportAccessForStream(x,this._broadcasterTransport,S),yield this._replaceTrack(x.track)})).disposer(this._disposer),this._listenStreamEnableChange(e);const g=Wo(),f={track:e.track,stopTracks:!1,appData:{transactionId:g},disableTrackOnPause:!1},_=this.publication.encodings;_&&(f.encodings=_),this.publication._onEncodingsChanged.add(b=>H(this,null,function*(){yield Uc(S.rtpSender,b).catch(x=>{cn.error("_onEncodingsChanged failed",x,this)})})).disposer(this._disposer);const w=this.publication.codecCapabilities,C=(r=(n=this._transportRepository.rtpCapabilities)==null?void 0:n.codecs)!=null?r:[];cn.debug("select codec",{codecCapabilities:w,deviceCodecs:C});const[R]=w.map(b=>b.mimeType.toLowerCase().includes("video")?C.find(M=>{var Z;return!(M.mimeType.toLowerCase()!==b.mimeType.toLowerCase()||Object.keys((Z=b.parameters)!=null?Z:{}).length>0&&!(0,F1.default)(b.parameters,M.parameters))}):C.find(E=>E.mimeType.toLowerCase()===b.mimeType.toLowerCase()));if(cn.debug("selected codec",{codec:R}),R){const[b,x]=R.mimeType.split("/");f.codec=Se(ie({},R),{mimeType:`${b}/${x.toUpperCase()}`}),e.contentType==="video"&&this._fixVideoCodecWithParametersOrder(R)}else w.length>0&&cn.warn("preferred codec not supported",Ea({channel:this.channel,detail:"preferred codec not supported",operationName:"Sender._produce",bot:this._bot,payload:{codecCapabilities:w,deviceCodecs:C}}));e.contentType==="audio"&&(((a=(i=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:i.parameters)==null?void 0:a.usedtx)!==!1&&(f.codecOptions=Se(ie({},f.codecOptions),{opusDtx:!0})),(u=(o=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:o.parameters)!=null&&u.stereo&&(f.codecOptions=Se(ie({},f.codecOptions),{opusStereo:!0})),(h=(p=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:p.parameters)!=null&&h.useinbandfec&&(f.codecOptions=Se(ie({},f.codecOptions),{opusFec:!0}))),t.onProduce.watch(b=>{var x;return((x=b.producerOptions.appData)==null?void 0:x.transactionId)===g},this._context.config.rtcConfig.timeout).then(b=>H(this,null,function*(){try{const{producerId:x}=yield this._api.createProducer({botId:this._bot.id,transportId:t.id,forwardingId:this.forwardingId,producerOptions:b.producerOptions});b.callback({id:x})}catch(x){b.errback(x)}})).catch(b=>{cn.error("onProduce failed",b,this)}),cn.debug("[start] msTransport.produce",this);const S=yield t.msTransport.produce(f).catch(b=>{throw De({operationName:"Sender._produce",context:this._context,info:Se(ie({},Zt.internal),{detail:"msTransport.produce failed"}),path:cn.prefix,channel:this.channel,error:b})});return cn.debug("[end] msTransport.produce",this),this._producer=S,S})}_fixVideoCodecWithParametersOrder(e){const t=this._broadcasterTransport.msTransport._handler,n=i=>i.mimeType===e.mimeType?e.parameters&&Object.keys(e.parameters).length>0?!!(0,F1.default)(i.parameters,e.parameters):!0:!1,r=(i,a)=>{for(const o of Object.keys(i))o!=="payloadType"&&(i[o]=a[o])};if(t._sendingRtpParametersByKind){const i=t._sendingRtpParametersByKind.video,a=i.codecs.find(n);if(i&&a){const o=JSON.parse(JSON.stringify(i)),[u]=i.codecs,p=JSON.parse(JSON.stringify(u));r(u,a),r(a,p),cn.debug("sort _sendingRtpParametersByKind",{origin:o,new:i.codecs})}}if(t._sendingRemoteRtpParametersByKind){const i=t._sendingRemoteRtpParametersByKind.video,a=i.codecs.find(n);if(i&&a){const o=JSON.parse(JSON.stringify(i)),[u]=i.codecs,p=JSON.parse(JSON.stringify(u));r(u,a),r(a,p),cn.debug("sort _sendingRemoteRtpParametersByKind",{origin:o,new:i.codecs})}}}_setupTransportAccessForStream(e,t,n){e._getTransportCallbacks[this._bot.id]=()=>({rtcPeerConnection:t.pc,connectionState:t.connectionState,info:this}),e._getStatsCallbacks[this._bot.id]=()=>H(this,null,function*(){if(n.closed)return delete e._getStatsCallbacks[this._bot.id],[];const i=yield n.getStats();let a=Oo(i);return a=a.map(o=>(o.sfuTransportId=t.id,o)),a});const r=()=>{delete e._getTransportCallbacks[this._bot.id],delete e._getStatsCallbacks[this._bot.id]};return this._disposer.push(()=>{r()}),r}unproduce(){this._producer&&(this._producer.close(),this._producer=void 0,this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer))}_replaceTrack(e){return H(this,null,function*(){var t,n;yield(n=(t=this._producer)==null?void 0:t.replaceTrack)==null?void 0:n.call(t,{track:e}).catch(r=>{throw De({operationName:"Sender._replaceTrack",context:this._context,info:Zt.internal,error:r,path:cn.prefix,channel:this.channel})})})}close(){this.closed=!0,this._unsubscribeStreamEnableChange&&this._unsubscribeStreamEnableChange(),this._setConnectionState("disconnected"),this._disposer.dispose()}get pc(){var e;return(e=this._broadcasterTransport)==null?void 0:e.pc}startSendSubscriptionStatsReportTimer(){const e=this._localPerson._analytics,t=this._bot.subscriptions.find(n=>n.publication.id===this.publication.id);if(t&&e){const n=e.client.getIntervalSec();this.sendSubscriptionStatsReportTimer=setInterval(()=>H(this,null,function*(){if(!e||e.isClosed()){this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer);return}if(this._producer){const r=yield this._producer.getStats();r&&e.client.sendSubscriptionStatsReport(r,{subscriptionId:t.id,role:"sender",contentType:this.publication.contentType,createdAt:Date.now()})}}),n*1e3)}}},si=new ze("packages/sfu-bot/src/connection/index.ts"),XP=class{constructor(e,t,n,r,i,a){this._api=e,this.channel=t,this.localPerson=n,this.remoteMember=r,this._transportRepository=i,this._context=a,this.type="sfu",this.onDisconnect=new We,this.onClose=new We,this.closed=!1,this._receivers={},this._senders={}}addSender(e){const t=new ZP(e,this.channel,this._api,this._transportRepository,this.localPerson,this.remoteMember,this.localPerson.iceManager,this._context);return this._senders[e.id]=t,t}removeSender(e){si.debug("removeSender",e);const t=this._senders[e];t&&t.unproduce()}startSubscribing(e){return H(this,null,function*(){var t;const n=new GP(e,this._api,this._transportRepository,this.localPerson,this.remoteMember,this.localPerson.iceManager,this._context);this._receivers[e.id]=n;const r=si.debug("[start] _startSubscribing consume"),{stream:i,codec:a}=yield n.consume().catch(o=>{throw si.error("[failed] _startSubscribing consume",De({operationName:"SFUConnection.startSubscribing",context:this._context,channel:this.channel,info:Se(ie({},Zt.internal),{detail:"failed to receiver.consume"}),error:o,path:si.prefix,payload:{subscription:e.toJSON()}})),o});if(si.elapsed(r,"[end] _startSubscribing consume"),i.setIsEnabled(e.publication.state==="enabled"),e.codec=a,e._setStream(i),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const o=e.preferredEncoding,u=(t=e.publication.origin)==null?void 0:t.encodings;if(!o||!u||u.length===0)return;const p=tm(o,u);this.localPerson._analytics.client.sendSubscriptionUpdatePreferredEncodingReport({subscriptionId:e.id,preferredEncodingIndex:p,updatedAt:Date.now()})}})}stopSubscribing(e){return H(this,null,function*(){const t=this._receivers[e.id];t&&t.unconsume()})}stopPublishing(e){return H(this,null,function*(){this.removeSender(e.id)})}close({reason:e}={}){this.closed||(si.debug("close sfu connection",{remote:this.remoteMember,local:this.localPerson,reason:e}),this.closed=!0,Object.values(this._senders).forEach(t=>{t.close()}),Object.values(this._receivers).forEach(t=>{t.close()}),this._senders={},this._receivers={},this.onClose.emit())}_getReceiver(e){return this._receivers[e]}changePreferredEncoding(e){return H(this,null,function*(){var t;const n=e.preferredEncoding,r=(t=e.publication.origin)==null?void 0:t.encodings;if(si.debug("changePreferredEncoding",{preferredEncoding:n,encodings:r,subscription:e}),!n)throw De({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Zt.invalidPreferredEncoding,path:si.prefix,payload:{subscription:e}});if(!r||r.length===0)throw De({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Zt.invalidEncodings,path:si.prefix,payload:{subscription:e}});const i=tm(n,r),a=this._getReceiver(e.id);if(!a)throw De({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Zt.receiverNotFound,path:si.prefix,payload:{subscription:e}});const o=a.transport;if(!o)throw De({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Se(ie({},Zt.internal),{detail:"transport not found"}),path:si.prefix,payload:{subscription:e}});const u=a.consumer;if(!u)throw De({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Zt.consumerNotFound,path:si.prefix,payload:{subscription:e}});yield this._api.changeConsumerLayer({transportId:o.id,consumerId:u.id,publicationId:e.publication.id,spatialLayer:i}),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendSubscriptionUpdatePreferredEncodingReport({subscriptionId:e.id,preferredEncodingIndex:i,updatedAt:Date.now()})})}};Y();Y();var QP=10,_r=new ze("packages/sfu-bot/src/member.ts"),Xb=class Qb extends vh{constructor(t){super(t),this.side="remote",this.subtype=Qb.subtype,this.type="bot",this._connections={},this.onForwardingStarted=new We,this.onForwardingStopped=new We,this.onForwardingListChanged=new We,this._startForwardQueue=new ua,this._forwardings={},this.stopForwarding=n=>new Promise((r,i)=>H(this,null,function*(){const a=_r.info("[start] stopForwarding",yield Ct({operationName:"SfuBotMember.stopForwarding",channel:this.channel}));if(this.state!=="joined"){i(De({operationName:"SfuBotMember.stopForwarding",context:this._context,info:Zt.sfuBotNotInChannel,path:_r.prefix,channel:this.channel,payload:{status:this.state}}));return}const o=typeof n=="string"?n:n.id,u=this._forwardings[o];if(!u){i(De({operationName:"SfuBotMember.stopForwarding",context:this._context,info:Zt.forwardingNotFound,path:_r.prefix,channel:this.channel,payload:{forwardingId:o,_forwardings:Object.keys(this._forwardings)}}));return}delete this._forwardings[u.id];const{promise:p,fulfilled:h}=this._api.stopForwarding({botId:this.id,forwardingId:o});let g=!1;p.catch(f=>{g=!0,i(f)}),this.onForwardingStopped.watch(f=>f.forwarding.id===o,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){_r.elapsed(a,"[end] stopForwarding",yield Ct({operationName:"SfuBotMember.stopForwarding",channel:this.channel})),r()})).catch(f=>{g||i(De({operationName:"SfuBotMember.stopForwarding",context:this._context,info:Se(ie({},Zt.timeout),{detail:"onForwardingStopped"}),path:_r.prefix,channel:this.channel,payload:{fulfilled:h},error:f}))})})),this._api=t.api,this._context=t.context,this._transportRepository=t.transportRepository,this.options=t.options,this.onLeft.once(()=>{_r.debug("SfuBotMember left: ",{id:this.id}),Object.values(this._connections).forEach(n=>{n.close({reason:"sfu bot left"})}),this._connections={}})}get forwardings(){return Object.values(this._forwardings)}_getConnection(t){return this._connections[t]}_getOrCreateConnection(t){var n;return(n=this._getConnection(t.id))!=null?n:this._createConnection(this.channel,t,this)}_createConnection(t,n,r){const i=new XP(r._api,t,n,r,this._transportRepository,this._context);return i.onClose.once(()=>{delete this._connections[n.id]}),this._connections[n.id]=i,i}startForwarding(t){return H(this,arguments,function*(n,r={}){const i=_r.info("[start] startForwarding",yield Ct({operationName:"SfuBotMember.startForwarding",channel:this.channel})),a=yield this._startForwardQueue.push(()=>this._startForwarding(n,r));return _r.elapsed(i,"[end] startForwarding",yield Ct({operationName:"SfuBotMember.startForwarding",channel:this.channel})),a})}_startForwarding(t,n){return H(this,null,function*(){if(n.maxSubscribers==null&&(n.maxSubscribers=QP),this.state!=="joined")throw De({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:Zt.sfuBotNotInChannel,path:_r.prefix,payload:{status:this.state}});if(!this.channel._getPublication(t.id))throw De({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:Ue.publicationNotExist,path:_r.prefix});const r=this.channel.localPerson;if(!r)throw De({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:Ue.localPersonNotJoinedChannel,path:_r.prefix});if(r.id!==t.publisher.id)throw De({operationName:"SfuBotMember._startForwarding",context:this._context,info:Zt.remotePublisherId,path:_r.prefix,channel:this.channel});const i=_r.debug("[start] SfuBotMember startForwarding",{publication:t.toJSON(),configure:n}),u=yield this._getOrCreateConnection(r).addSender(t).startForwarding(n).catch(p=>{throw De({operationName:"SfuBotMember._startForwarding",context:this._context,info:Se(ie({},Zt.internal),{detail:"[failed] SfuBotMember startForwarding"}),path:_r.prefix,channel:this.channel,error:p,payload:{publication:t.toJSON()}})});return this._forwardings[u.id]=u,this.listenStopForwardEvent(u),this.onForwardingStarted.emit({forwarding:u}),this.onForwardingListChanged.emit(),_r.elapsed(i,"[end] SfuBotMember startForwarding",{forwarding:u.toJSON()}),u})}listenStopForwardEvent(t){const{removeListener:n}=this.channel.onStreamUnpublished.add(r=>{if(r.publication.id===t.id){n(),t._stop();const i=t.originPublication,a=this._getConnection(i.publisher.id);a&&a.removeSender(i.id),this.onForwardingStopped.emit({forwarding:t}),this.onForwardingListChanged.emit()}})}_dispose(){}};Xb.subtype="sfu";var Ma=Xb;Y();var YP=Se(ie({},Zb),{endpointTimeout:3e4,ackTimeout:1e4,disableRestartIce:!1});Y();Y();var D1=qr(Mx());Y();var Yn=new ze("packages/sfu-bot/src/connection/transport/transport.ts"),ek=class{constructor(e,t,n,r,i,a){this.msTransport=e,this._bot=t,this._iceManager=n,this._sfuApi=r,this._context=i,this._analyticsSession=a,this._backoffIceRestart=new ki({times:8,interval:100,jitter:100}),this._connectionState="new",this.onProduce=new We,this.onProduceData=new We,this.onMediasoupConnectionStateChanged=new We,this.onConnectionStateChanged=new We,this.restartIce=()=>H(this,null,function*(){if(this._backoffIceRestart.exceeded){Yn.error("_iceRestartedCount exceeded",De({operationName:"SfuTransport.restartIce",context:this._context,info:Zt.netWorkError,path:Yn.prefix})),this._setConnectionState("disconnected");return}Yn.warn("[start] restartIce",Ea({bot:this._bot,detail:"start restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}}));const g=()=>{if(this._bot.state==="left")return Yn.debug("bot already left",this),this._setConnectionState("disconnected"),Yn.warn("[end] restartIce",Ea({bot:this._bot,detail:"end restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}})),!0;if(this.msTransport.connectionState==="connected")return this._backoffIceRestart.reset(),this._setConnectionState("connected"),Yn.warn("[end] restartIce",Ea({bot:this._bot,detail:"end restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}})),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"restartIce",data:void 0,createdAt:Date.now()}),!0};if(this._setConnectionState("reconnecting"),yield this._backoffIceRestart.wait(),g())return;let f=yield this._iceManager.updateIceParams().catch(w=>w);if(f){Yn.warn("updateIceParams failed",Ea({operationName:"SfuTransport.restartIce",detail:"updateIceParams failed",bot:this._bot,payload:{transport:this}}),f),yield this.restartIce();return}if(yield this.msTransport.updateIceServers({iceServers:this._iceManager.iceServers}),g())return;const _=yield this._mediasoupRestartIce();if(f=yield this._waitForMsConnectionState("connected",this._context.config.rtcConfig.iceDisconnectBufferTimeout).catch(w=>w),!f&&g())return _;yield this.restartIce()}),this._waitForMsConnectionState=(g,f=1e4)=>H(this,null,function*(){g!==this.msTransport.connectionState&&(yield this.onMediasoupConnectionStateChanged.watch(()=>g===this.msTransport.connectionState,f).catch(_=>{throw De({operationName:"SfuTransport._waitForMsConnectionState",context:this._context,info:Se(ie({},Zt.timeout),{detail:"waitForConnectionState timeout"}),error:_,path:Yn.prefix})}))}),this._onConnect=g=>(f,_,w)=>H(this,[f,_,w],function*({dtlsParameters:C},R,S){try{Yn.debug("[start] transport connect",{transportId:g}),yield this._sfuApi.connect({transportId:g,dtlsParameters:C}),Yn.debug("[end] transport connect",{transportId:g}),R()}catch(b){Yn.error("[failed] transport connect",{error:b,transportId:g}),S(b)}});var o,u,p;const h=i.plugins.find(g=>g.subtype===yh.subtype);this._options=h.options,Yn.debug("peerConfig",(p=(u=(o=this.pc)==null?void 0:o.getConfiguration)==null?void 0:u.call(o))!=null?p:{}),e.on("connect",(g,f,_)=>this._onConnect(e.id)(g,f,_)),e.on("connectionstatechange",g=>{this.onMediasoupConnectionStateChanged.emit(g),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"connectionStateChange",data:{connectionState:g},createdAt:Date.now()})}),e.on("produce",(g,f,_)=>{this.onProduce.emit({producerOptions:g,callback:f,errback:_})}),e.on("producedata",(g,f,_)=>{this.onProduceData.emit({producerOptions:g,callback:f,errback:_})}),this.onMediasoupConnectionStateChanged.add(g=>H(this,null,function*(){switch(Ct({operationName:"onMediasoupConnectionStateChanged",channel:this._bot.channel}).then(f=>{Yn.debug(f,{state:g,transportId:this.id,bot:t})}).catch(()=>{}),g){case"disconnected":case"failed":{if(this._connectionState==="reconnecting")return;(yield this._waitForMsConnectionState("connected",i.config.rtcConfig.iceDisconnectBufferTimeout).catch(_=>_))&&this._connectionState!=="reconnecting"&&t.options.disableRestartIce!==!0&&(yield this.restartIce())}break;case"connecting":case"connected":this._setConnectionState(g);break;case"closed":this._setConnectionState("disconnected");break}Yn.debug("onMediasoupConnectionStateChanged",this)}))}get pc(){var e,t,n;return(n=(t=(e=this.msTransport)==null?void 0:e._handler)==null?void 0:t._pc)!=null?n:{}}get id(){return this.msTransport.id}get connectionState(){return this._connectionState}toJSON(){return{id:this.id,direction:this.msTransport.direction,connectionState:this._connectionState}}close(){var e;Yn.debug("close",this.id),(e=this.pc)!=null&&e.peerIdentity&&this.pc.peerIdentity.catch(()=>{}),this.msTransport.close(),this._setConnectionState("disconnected")}_setConnectionState(e){this._connectionState!==e&&(Yn.debug("onConnectionStateChanged",this._connectionState,e,this),this._connectionState=e,this.onConnectionStateChanged.emit(e),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"skywayConnectionStateChange",data:{skywayConnectionState:e},createdAt:Date.now()}))}_mediasoupRestartIce(){return H(this,null,function*(){const e=yield this._sfuApi.iceRestart({transportId:this.id}).catch(t=>t);if(e instanceof Error){Yn.warn("iceRestart failed",Ea({operationName:"SfuTransport._mediasoupRestartIce",detail:"iceRestart failed",bot:this._bot,payload:{transport:this}}),e),yield this.restartIce();return}return yield this.msTransport.restartIce({iceParameters:e}),e})}},Mp=new ze("packages/sfu-bot/src/connection/transport/transportRepository.ts"),tk=class{constructor(e,t){this._context=e,this._api=t,this.onTransportCreated=new We,this._transports={},this.getTransport=(i,a)=>this._transports[i+a];const{browserName:n,browserVersion:r}=ob();Mp.debug("runtime info",{browserName:n,browserVersion:r}),n==="Safari"&&r==null?this._device=new D1.Device({handlerName:"Safari12"}):this._device=new D1.Device}get rtpCapabilities(){if(this._device.loaded)return this._device.rtpCapabilities}loadDevice(e){return H(this,null,function*(){this._device.loaded||(yield this._device.load({routerRtpCapabilities:e}).catch(t=>{throw De({operationName:"TransportRepository.loadDevice",context:this._context,info:Se(ie({},Zt.internal),{detail:"loadDevice failed"}),path:Mp.prefix,payload:{rtpCapabilities:e},error:t})}),Mp.debug("device loaded",{routerRtpCapabilities:e,rtpCapabilities:this._device.rtpCapabilities}))})}createTransport(e,t,n,r,i,a){const u=(r==="send"?h=>this._device.createSendTransport(h):h=>this._device.createRecvTransport(h))(Se(ie({},n),{iceServers:i.iceServers,iceTransportPolicy:this._context.config.rtcConfig.turnPolicy==="turnOnly"?"relay":void 0,additionalSettings:this._context.config.rtcConfig})),p=new ek(u,t,i,this._api,this._context,a);return this._transports[e+u.id]=p,this.onTransportCreated.emit(u.id),p}deleteTransports(e){Object.entries(ie({},this._transports)).forEach(([t,n])=>{t.includes(e)&&(n.close(),delete this._transports[t])})}};Y();var nk="1.14.2",_a=new ze("packages/sfu-bot/src/plugin.ts"),Yb=class e2 extends gg{constructor(t={}){super(),this.subtype=e2.subtype,this._createRemoteMember=(n,r)=>new Ma(Se(ie({},this._context),{channel:n,id:r.id,name:r.name,metadata:r.metadata,plugin:this,api:this._api,context:this._context,transportRepository:this._transportRepository,options:this.options})),this.createBot=n=>H(this,null,function*(){var r;const i=_a.info("[start] createBot",yield Ct({operationName:"SfuBotPlugin.createBot",channel:n})),a=this._context.authToken.getAppId(),o=yield this._api.createBot({appId:a,channelId:n.id}),u=(r=n._getMember(o))!=null?r:(yield n.onMemberJoined.watch(p=>p.member.id===o,this._context.config.rtcApi.timeout).catch(p=>{throw De({operationName:"SfuBotPlugin.createBot",info:Se(ie({},Zt.timeout),{detail:"onMemberJoined"}),path:_a.prefix,error:p,context:this._context})})).member;return _a.elapsed(i,"[end] createBot",yield Ct({operationName:"SfuBotPlugin.createBot",channel:n})),u}),this.deleteBot=(n,r)=>H(this,null,function*(){return new Promise((i,a)=>H(this,null,function*(){const o=_a.info("[start] deleteBot",yield Ct({operationName:"SfuBotPlugin.deleteBot",channel:n}));let u=!1;this._api.deleteBot({botId:r}).catch(p=>{u=!0,a(p)}),n.onMemberLeft.watch(p=>p.member.id===r,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){_a.elapsed(o,"[end] deleteBot",yield Ct({operationName:"SfuBotPlugin.deleteBot",channel:n})),i()})).catch(p=>{u||a(De({operationName:"SfuBotPlugin.deleteBot",info:Se(ie({},Zt.timeout),{detail:"onMemberLeft"}),path:_a.prefix,channel:n,error:p,context:this._context}))})}))}),this.options=ie(ie({},YP),t),this._onContextAttached.once(n=>{ze.level=n.config.log.level,ze.format=n.config.log.format,_a.info("SfuBotPlugin spawned",{operationName:"SfuBotPlugin.constructor",endpoint:{sfu:this.options.domain},options:this.options,sdkName:"sfu-bot",sdkVersion:nk}),this._api=new WP(n.authTokenString,Se(ie({},this.options),{log:n.config.log})),this._transportRepository=new tk(n,this._api),n._onTokenUpdated.add(r=>{this._api.updateToken(r)})}),this._whenDisposeLocalPerson=n=>H(this,null,function*(){this._transportRepository.deleteTransports(n.id)})}};Yb.subtype=Ma.subtype;var yh=Yb,rk={invalidParameter:{name:"invalidParameter",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internal:{name:"internal",detail:"",solution:""},notImplemented:{name:"notImplemented",detail:"対応していないRoomTypeです",solution:"正しいRoomTypeを指定してください"},roomNotOpened:{name:"roomNotOpened",detail:"RoomがOpenされていません",solution:"Roomの状態を確かめてください"},subscribeOtherMemberType:{name:"subscribeOtherMemberType",detail:"RemoteMemberにSubscribe/Unsubscribeさせる場合、対象のMemberのTypeはPersonである必要があります",solution:"対象のRemoteMemberが正しいか確認してください"},sfuRoomNotSupportDataStream:{name:"sfuRoomNotSupportDataStream",detail:"SFURoomでDataStreamを使うことは出来ません",solution:"ありません"},publicationNotHasOrigin:{name:"publicationNotHasOrigin",detail:"SfuRoomで操作するPublicationはOriginをもつ必要があります",solution:"SfuRoomとP2PRoomを同一のIDで混在させていないか確かめてください"},notFound:{name:"notFound",detail:"参照しようとしていたものが見つかりません",solution:"参照しようとしたものが存在するか確かめてください"}},Cr=ie(ie(ie({},Ue),Zt),rk);Y();var t2=class{constructor(e,t){this.member=e,this.room=t,this.onLeft=new We;const{removeListener:n}=t.onMemberLeft.add(r=>{r.member.id===this.member.id&&(n(),this.onLeft.emit())});this.onMetadataUpdated=e.onMetadataUpdated}get id(){return this.member.id}get name(){return this.member.name}get roomId(){return this.room.id}get roomName(){return this.room.name}get roomType(){return this.room.type}get state(){return this.member.state}get metadata(){return this.member.metadata}get _member(){return this.member}get publications(){return this.room.publications.filter(e=>e.publisher.id===this.id)}get subscriptions(){return this.member.subscriptions.map(e=>this.room._getSubscription(e.id))}updateMetadata(e){return this.member.updateMetadata(e)}leave(){return this.member.leave()}toJSON(){return{id:this.id,name:this.name,metadata:this.metadata}}};Y();var n2=class extends t2{constructor(e,t){super(e,t),this.side="local",this._local=this._member,this.onStreamPublished=new We,this.onStreamUnpublished=new We,this.onPublicationListChanged=new We,this.onPublicationSubscribed=new We,this.onPublicationUnsubscribed=new We,this.onSubscriptionListChanged=new We,this.onFatalError=new We,this._context=this.room._context,this._local.onPublicationSubscribed.add(n=>H(this,null,function*(){const r=t._addSubscription(n.subscription);this.onPublicationSubscribed.emit({subscription:r,stream:n.stream})})),this._local.onFatalError.pipe(this.onFatalError),this._listenRoomEvent(),this.onStreamPublished.add(()=>this.onPublicationListChanged.emit()),this.onStreamUnpublished.add(()=>this.onPublicationListChanged.emit()),this.onPublicationSubscribed.add(()=>this.onSubscriptionListChanged.emit()),this.onPublicationUnsubscribed.add(()=>this.onSubscriptionListChanged.emit())}get subscriptions(){return this.member.subscriptions.map(e=>this.room._getSubscription(e.id)).filter(e=>e.stream)}_listenRoomEvent(){this.room.onPublicationUnsubscribed.add(e=>{e.subscription.subscriber._member.id===this._local.id&&this.onPublicationUnsubscribed.emit(e)})}};Y();Y();function xr({operationName:e,context:t,info:n,error:r,path:i,payload:a,room:o}){const u={operationName:e,payload:a};return o&&(u.appId=o._channel.appId,u.roomId=o.id,o.localRoomMember&&(u.memberId=o.localRoomMember.id)),t&&(u.info=t.info,u.plugins=t.plugins.map(p=>p.subtype)),new wr({error:r,info:n,payload:u,path:i})}var xc=new ze("packages/room/src/member/local/p2p.ts"),ik=class extends n2{constructor(e,t){super(e,t)}publish(e){return H(this,arguments,function*(t,n={}){const r=yield this._local.publish(t,n),i=this.room._addPublication(r);return this.onStreamPublished.emit({publication:i}),i})}unpublish(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unpublish(t).catch(r=>{xc.error("unpublish",r,{target:e},this.toJSON())});const{publication:n}=yield this.room.onStreamUnpublished.watch(r=>r.publication.id===t,this._context.config.rtcApi.timeout).catch(r=>{throw xr({operationName:"LocalP2PRoomMemberImpl.unpublish",context:this._context,room:this.room,info:Se(ie({},Cr.timeout),{detail:"onStreamUnpublished"}),path:xc.prefix,error:r})});this.onStreamUnpublished.emit({publication:n})})}subscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id,{subscription:n,stream:r}=yield this._local.subscribe(t);return{subscription:this.room._addSubscription(n),stream:r}})}unsubscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unsubscribe(t).catch(n=>{xc.error("unsubscribe",n,{target:e},this.toJSON())}),yield this.room.onPublicationUnsubscribed.watch(n=>n.subscription.id===t,this._context.config.rtcApi.timeout).catch(n=>{throw xr({operationName:"LocalP2PRoomMemberImpl.unsubscribe",context:this._context,room:this.room,info:Se(ie({},Cr.timeout),{detail:"onPublicationUnsubscribed"}),path:xc.prefix,error:n})})})}_updateRoom(e){xc.debug("_updateRoom",{memberId:this.id}),this.room=e,this._listenRoomEvent()}};Y();Y();var sk=10,Ms=new ze("packages/room/src/member/local/sfu.ts"),ak=class extends n2{constructor(e,t){super(e,t)}publish(e){return H(this,arguments,function*(t,n={}){var r;if(t instanceof fg)throw xr({operationName:"LocalSFURoomMemberImpl.publish",context:this._context,room:this.room,info:Cr.sfuRoomNotSupportDataStream,path:Ms.prefix});n.maxSubscribers=(r=n.maxSubscribers)!=null?r:sk;const i=yield this._local.publish(t,n),a=this.room._channel.members.find(h=>h.subtype===Ma.subtype);if(!a)throw xr({operationName:"LocalSFURoomMemberImpl.publish",context:this._context,room:this.room,info:Zt.sfuBotNotInChannel,path:Ms.prefix});const u=(yield a.startForwarding(i,{maxSubscribers:n.maxSubscribers})).relayingPublication,p=this.room._addPublication(u);return this.onStreamPublished.emit({publication:p}),p})}unpublish(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id,n=this.room._getPublication(t),r=n._publication.origin;if(!r)throw xr({operationName:"LocalSFURoomMemberImpl.unpublish",context:this._context,room:this.room,info:Cr.publicationNotHasOrigin,path:Ms.prefix});this._local.unpublish(r.id).catch(i=>{Ms.error("unpublish error",i,{target:e},this.toJSON())}),yield this.room.onStreamUnpublished.watch(i=>i.publication.id===t,this._context.config.rtcApi.timeout).catch(i=>{throw xr({operationName:"LocalSFURoomMemberImpl.unpublish",context:this._context,room:this.room,info:Se(ie({},Cr.timeout),{detail:"onStreamUnpublished"}),path:Ms.prefix,error:i})}),this.onStreamUnpublished.emit({publication:n})})}subscribe(e,t){return H(this,null,function*(){const n=typeof e=="string"?e:e.id,{subscription:r,stream:i}=yield this._local.subscribe(n,t);return{subscription:this.room._addSubscription(r),stream:i}})}unsubscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unsubscribe(t).catch(n=>{Ms.error("unsubscribe error",n,{target:e},this.toJSON())}),yield this.room.onPublicationUnsubscribed.watch(n=>n.subscription.id===t,this._context.config.rtcApi.timeout).catch(n=>{throw xr({operationName:"LocalSFURoomMemberImpl.unsubscribe",context:this._context,room:this.room,info:Se(ie({},Cr.timeout),{detail:"onPublicationUnsubscribed"}),path:Ms.prefix,error:n})})})}_updateRoom(e){Ms.debug("_updateRoom",{memberId:this.id}),this.room=e,this._listenRoomEvent()}};Y();var N1=new ze("packages/room/src/member/remote/base.ts"),Nd=class extends t2{constructor(e,t){super(e,t),this.side="remote",this.onPublicationSubscribed=new We,this.onPublicationUnsubscribed=new We,this.onSubscriptionListChanged=new We,this.onPublicationListChanged=new We,this._disposer=new ei,this.subscribe=n=>new Promise((r,i)=>{if(!(this.member instanceof Ju)){i(xr({operationName:"RemoteRoomMemberImpl.subscribe",context:this.room._context,room:this.room,info:Cr.subscribeOtherMemberType,path:N1.prefix}));return}let a=!1;this.member.subscribe(n).catch(o=>{a=!0,i(o)}),this.onPublicationSubscribed.watch(o=>o.subscription.publication.id===n).then(o=>r(o)).catch(o=>{a||i(o)})}),this.unsubscribe=n=>new Promise((r,i)=>{if(!(this.member instanceof Ju)){i(xr({operationName:"RemoteRoomMemberImpl.unsubscribe",context:this.room._context,room:this.room,info:Cr.subscribeOtherMemberType,path:N1.prefix}));return}let a=!1;this.member.unsubscribe(n).catch(o=>{a=!0,i(o)}),this.onPublicationUnsubscribed.watch(o=>o.subscription.id===n).then(()=>r()).catch(o=>{a||i(o)})}),t.onPublicationSubscribed.add(n=>{n.subscription.subscriber._member.id===e.id&&(this.onPublicationSubscribed.emit(n),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),t.onPublicationUnsubscribed.add(n=>{n.subscription.subscriber._member.id===e.id&&(this.onPublicationUnsubscribed.emit(n),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),e instanceof Ju&&e.onPublicationListChanged.pipe(this.onPublicationListChanged).disposer(this._disposer)}_dispose(){this._disposer.dispose()}};Y();var Zu="packages/room/src/publication/index.ts",O1=new ze(Zu),ok=class{constructor(e,t){this._publication=e,this._room=t,this._disposer=new ei,this._events=new ts,this.onCanceled=this._events.make(),this.onSubscribed=this._events.make(),this.onUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onEnabled=this._events.make(),this.onDisabled=this._events.make(),this.onStateChanged=this._events.make(),this.onConnectionStateChanged=new We,this.enable=()=>new Promise((r,i)=>{if(this.state==="enabled"){r();return}this._origin?Promise.all([this._origin.enable(),this._publication.onEnabled.asPromise()]).then(()=>r()).catch(i):this._publication.enable().then(r).catch(i)}),this.disable=()=>new Promise((r,i)=>{if(this.state==="disabled"){r();return}this._origin?Promise.all([this._origin.disable(),this._publication.onDisabled.asPromise()]).then(()=>r()).catch(i):this._publication.disable().then(r).catch(i)}),this.replaceStream=(r,i={})=>{this._preferredPublication.replaceStream(r,i)};var n;this.id=e.id,this.contentType=e.contentType,this._origin=e.origin;{const r=(n=this._origin)!=null?n:this._publication;this.publisher=this._room._getMember(r.publisher.id)}this._setEvents()}_setEvents(){var e;this._room.onStreamUnpublished.add(t=>{t.publication.id===this.id&&this._dispose()}),this._room.onPublicationSubscribed.add(t=>{t.subscription.publication.id===this.id&&(this.onSubscribed.emit({subscription:t.subscription}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this._room.onPublicationUnsubscribed.add(t=>{t.subscription.publication.id===this.id&&(this.onUnsubscribed.emit({subscription:t.subscription}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this._publication.onEnabled.pipe(this.onEnabled),this._publication.onDisabled.pipe(this.onDisabled),this._publication.onStateChanged.pipe(this.onStateChanged),((e=this._origin)!=null?e:this._publication).onMetadataUpdated.pipe(this.onMetadataUpdated),this._origin?this._origin.onConnectionStateChanged.add(t=>{O1.debug("this._origin.onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit({state:t.state})}):this._publication.onConnectionStateChanged.add(t=>{O1.debug("this._publication.onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit({state:t.state,remoteMember:this._room._getMember(t.remoteMember.id)})})}get subscriptions(){return this._publication.subscriptions.map(e=>this._room._getSubscription(e.id))}get _preferredPublication(){var e;return(e=this._origin)!=null?e:this._publication}get codecCapabilities(){return this._preferredPublication.codecCapabilities}get encodings(){return this._preferredPublication.encodings}get stream(){return this._preferredPublication.stream}get state(){return this._preferredPublication.state}get metadata(){return this._preferredPublication.metadata}cancel(){return H(this,null,function*(){yield Promise.all([this._preferredPublication.cancel(),this.onCanceled.asPromise()])})}updateMetadata(e){return H(this,null,function*(){yield this._preferredPublication.updateMetadata(e)})}updateEncodings(e){this._preferredPublication.updateEncodings(e)}_dispose(){this.onCanceled.emit(),this._events.dispose(),this._disposer.dispose()}getStats(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Ma.subtype))==null?void 0:t.subscriber;if(!n)throw xr({operationName:"RoomPublicationImpl.getStats",room:this._room,path:Zu,info:Se(ie({},Cr.notFound),{detail:"bot not found"})});return this._origin.getStats(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getStats(n)}}getRTCPeerConnection(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Ma.subtype))==null?void 0:t.subscriber;if(!n)throw xr({operationName:"RoomPublicationImpl.getRTCPeerConnection",room:this._room,path:Zu,info:Se(ie({},Cr.notFound),{detail:"bot not found"})});return this._origin.getRTCPeerConnection(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getRTCPeerConnection(n)}}getConnectionState(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Ma.subtype))==null?void 0:t.subscriber;if(!n)throw xr({operationName:"RoomPublicationImpl.getConnectionState",room:this._room,path:Zu,info:Se(ie({},Cr.notFound),{detail:"bot not found"})});return this._origin.getConnectionState(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getConnectionState(n)}}toJSON(){return{id:this.id,contentType:this.contentType,metadata:this.metadata,publisher:this.publisher,subscriptions:this.subscriptions,codecCapabilities:this.codecCapabilities,encodings:this.encodings,state:this.state}}};Y();Y();var ck="1.15.1";Y();Y();Y();var Lp=new ze("packages/room/src/subscription/index.ts"),lk=class{constructor(e,t){this._subscription=e,this._room=t,this._context=this._room._context,this.onStreamAttached=new We,this.onCanceled=new We,this.onConnectionStateChanged=new We,this.id=e.id,this.contentType=e.contentType,this.publication=this._room._getPublication(e.publication.id),this.subscriber=this._room._getMember(e.subscriber.id),e.onStreamAttached.pipe(this.onStreamAttached),e.onCanceled.pipe(this.onCanceled),e.onConnectionStateChanged.add(n=>{Lp.debug("_subscription.onConnectionStateChanged",this.id,n),this.onConnectionStateChanged.emit(n)})}get stream(){return this._subscription.stream}get state(){return this._subscription.state}get codec(){return this._subscription.codec}get preferredEncoding(){return this._subscription.preferredEncoding}changePreferredEncoding(e){this._subscription.changePreferredEncoding(e)}cancel(){return H(this,null,function*(){this._subscription.cancel().catch(e=>{Lp.error("subscription.cancel",e,this.toJSON())}),yield this._room.onPublicationUnsubscribed.watch(e=>e.subscription.id===this.id,this._context.config.rtcApi.timeout).catch(e=>{throw xr({operationName:"RoomSubscriptionImpl.cancel",context:this._context,room:this._room,info:Se(ie({},Cr.timeout),{detail:"onPublicationUnsubscribed"}),error:e,path:Lp.prefix})})})}toJSON(){return{id:this.id,contentType:this.contentType,publication:this.publication,codec:this.codec}}getStats(){return this._subscription.getStats()}getRTCPeerConnection(){return this._subscription.getRTCPeerConnection()}getConnectionState(){return this._subscription.getConnectionState()}},M1=new ze("packages/room/src/room/base.ts"),r2=class{constructor(e,t){this._channel=t,this._members={},this._publications={},this._subscriptions={},this._context=this._channel._context,this._events=new ts,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.type=e,this._channel.onClosed.pipe(this.onClosed),this._channel.onMetadataUpdated.pipe(this.onMetadataUpdated),this._channel.onMemberMetadataUpdated.add(n=>{this._handleOnMemberMetadataUpdate(n)})}_getMember(e){return this._members[e]}_getPublication(e){return this._publications[e]}_addPublication(e){const t=this._publications[e.id];if(t)return t;const n=new ok(e,this);return this._publications[e.id]=n,n}_getSubscription(e){return this._subscriptions[e]}_addSubscription(e){const t=this._subscriptions[e.id];if(t)return t;const n=new lk(e,this);return this._subscriptions[e.id]=n,n}get id(){return this._channel.id}get name(){return this._channel.name}get metadata(){return this._channel.metadata}get state(){return this._channel.state}get disposed(){return this._channel.disposed}_handleOnMemberMetadataUpdate(e){const t=this._getMember(e.member.id);this.onMemberMetadataUpdated.emit({member:t,metadata:e.metadata})}get members(){return Object.values(this._members)}get publications(){return Object.values(this._publications)}get subscriptions(){return Object.values(this._subscriptions)}joinChannel(){return H(this,arguments,function*(e={}){var t;if(this.state!=="opened")throw xr({operationName:"RoomImpl.joinChannel",context:this._context,room:this,info:Cr.roomNotOpened,path:M1.prefix});e.name=(t=e.name)!=null?t:ji();const n=yield this._channel.join(e);return this._getMember(n.id)||(yield this.onMemberJoined.watch(r=>r.member._member.id===n.id,this._context.config.rtcApi.timeout).catch(r=>{throw xr({operationName:"RoomImpl.joinChannel",context:this._context,room:this,info:Se(ie({},Cr.timeout),{detail:"RoomImpl onMemberJoined"}),path:M1.prefix,error:r})})),n})}leave(e){return H(this,null,function*(){yield this._channel.leave(e._member)})}moveRoom(e){return H(this,null,function*(){return yield this._channel.moveChannel(e._local),e._updateRoom(this),e})}updateMetadata(e){return this._channel.updateMetadata(e)}close(){return H(this,null,function*(){yield this._channel.close()})}dispose(){return H(this,null,function*(){return this._channel.dispose()})}toJSON(){return{type:this.type,id:this.id,name:this.name,metadata:this.metadata,members:this.members,publications:this.publications,subscriptions:this.subscriptions}}},uk=new ze("packages/room/src/room/p2p.ts"),dk=class extends r2{constructor(e){super("p2p",e),this.setChannelState(),this.setChannelListener()}setChannelState(){this._channel.members.forEach(e=>{const t=new Nd(e,this);this._members[e.id]=t}),this._channel.publications.forEach(e=>{this._addPublication(e)}),this._channel.subscriptions.forEach(e=>{this._addSubscription(e)})}setChannelListener(){this._channel.onMemberJoined.add(e=>this._handleOnMemberJoin(e.member)),this._channel.onMemberLeft.add(e=>this._handleOnMemberLeft(e.member)),this._channel.onStreamPublished.add(e=>this._handleOnStreamPublish(e.publication)),this._channel.onStreamUnpublished.add(e=>this._handleOnStreamUnpublish(e.publication)),this._channel.onPublicationMetadataUpdated.add(e=>{this._handleOnPublicationMetadataUpdate(e.publication)}),this._channel.onPublicationEnabled.add(e=>{this._handleOnPublicationEnabled(e.publication)}),this._channel.onPublicationDisabled.add(e=>{this._handleOnPublicationDisabled(e.publication)}),this._channel.onPublicationSubscribed.add(e=>this._handleOnStreamSubscribe(e.subscription)),this._channel.onPublicationUnsubscribed.add(e=>this._handleOnStreamUnsubscribe(e.subscription))}_handleOnMemberJoin(e){if(this._getMember(e.id))return;const t=new Nd(e,this);this._members[e.id]=t,this.onMemberJoined.emit({member:t}),this.onMemberListChanged.emit({})}_handleOnMemberLeft(e){const t=this._getMember(e.id);delete this._members[e.id],t._dispose(),this.onMemberLeft.emit({member:t}),this.onMemberListChanged.emit({})}_handleOnStreamPublish(e){if(this._getPublication(e.id))return;const t=this._addPublication(e);this.onStreamPublished.emit({publication:t}),this.onPublicationListChanged.emit({})}_handleOnStreamUnpublish(e){const t=this._getPublication(e.id);delete this._publications[e.id],this.onStreamUnpublished.emit({publication:t}),this.onPublicationListChanged.emit({})}_handleOnPublicationMetadataUpdate(e){const t=this._getPublication(e.id);this.onPublicationMetadataUpdated.emit({publication:t,metadata:t.metadata})}_handleOnPublicationEnabled(e){const t=this._getPublication(e.id);this.onPublicationEnabled.emit({publication:t})}_handleOnPublicationDisabled(e){const t=this._getPublication(e.id);this.onPublicationDisabled.emit({publication:t})}_handleOnStreamSubscribe(e){if(this._getSubscription(e.id))return;const t=this._addSubscription(e);this.onPublicationSubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit({})}_handleOnStreamUnsubscribe(e){const t=this._getSubscription(e.id);delete this._subscriptions[e.id],this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit({})}join(){return H(this,arguments,function*(e={}){const t=yield this.joinChannel(e),n=new ik(t,this);return uk.debug("member joined",e),this.localRoomMember=n,n.onLeft.once(()=>{this.localRoomMember=void 0}),n})}};Y();var hk=new ze("packages/room/src/room/sfu.ts"),pk=class i2 extends r2{constructor(t,n){super("sfu",t),this._plugin=n,this.setChannelState(),this.setChannelListener()}static Create(t,n){return H(this,null,function*(){const r=t.plugins.find(o=>o.subtype==="sfu");return n.members.find(o=>o.subtype===Ma.subtype)||(yield r.createBot(n)),new i2(n,r)})}setChannelState(){this._channel.members.forEach(t=>{if(t.type==="bot")return;const n=new Nd(t,this);this._members[t.id]=n}),this._channel.publications.forEach(t=>{t.origin&&this._addPublication(t)}),this._channel.subscriptions.forEach(t=>{t.subscriber.type!=="bot"&&this._addSubscription(t)})}setChannelListener(){this._channel.onMemberJoined.add(t=>this._handleOnMemberJoin(t.member)),this._channel.onMemberLeft.add(t=>this._handleOnMemberLeft(t.member)),this._channel.onStreamPublished.add(t=>{this._handleOnStreamPublish(t.publication)}),this._channel.onStreamUnpublished.add(t=>this._handleOnStreamUnpublish(t.publication)),this._channel.onPublicationMetadataUpdated.add(t=>{this._handleOnPublicationMetadataUpdate(t.publication)}),this._channel.onPublicationEnabled.add(t=>{this._handleOnPublicationEnabled(t.publication)}),this._channel.onPublicationDisabled.add(t=>{this._handleOnPublicationDisabled(t.publication)}),this._channel.onPublicationSubscribed.add(t=>{this._handleOnStreamSubscribe(t.subscription)}),this._channel.onPublicationUnsubscribed.add(t=>this._handleOnStreamUnsubscribe(t.subscription))}_handleOnMemberJoin(t){if(t.type==="bot")return;const n=new Nd(t,this);this._members[t.id]=n,this.onMemberJoined.emit({member:n}),this.onMemberListChanged.emit({})}_handleOnMemberLeft(t){const n=this._getMember(t.id);n&&(delete this._members[t.id],n._dispose(),this.onMemberLeft.emit({member:n}),this.onMemberListChanged.emit({}))}_handleOnStreamPublish(t){var n;if(!((n=t.origin)!=null&&n.id))return;const r=this._addPublication(t);this.onStreamPublished.emit({publication:r}),this.onPublicationListChanged.emit({})}_handleOnStreamUnpublish(t){var n;if(!((n=t.origin)!=null&&n.id))return;const r=this._getPublication(t.id);delete this._publications[t.id],this.onStreamUnpublished.emit({publication:r}),this.onPublicationListChanged.emit({})}_getRelayedPublication(t){return this.publications.find(r=>{var i;return((i=r._publication.origin)==null?void 0:i.id)===t})}_handleOnPublicationMetadataUpdate(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationMetadataUpdated.emit({publication:n,metadata:n.metadata})}_handleOnPublicationEnabled(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationEnabled.emit({publication:n})}_handleOnPublicationDisabled(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationDisabled.emit({publication:n})}_handleOnStreamSubscribe(t){if(t.subscriber.type==="bot")return;const n=this._addSubscription(t);this.onPublicationSubscribed.emit({subscription:n}),this.onSubscriptionListChanged.emit({})}_handleOnStreamUnsubscribe(t){if(t.subscriber.type==="bot")return;const n=this._getSubscription(t.id);delete this._subscriptions[t.id],this.onPublicationUnsubscribed.emit({subscription:n}),this.onSubscriptionListChanged.emit({})}join(){return H(this,arguments,function*(t={}){const n=yield this.joinChannel(Se(ie({},t),{disableSignaling:!0})),r=new ak(n,this);return this.localRoomMember=r,r.onLeft.once(()=>{this.localRoomMember=void 0}),hk.debug("member joined",t),r})}},s2=new ze("packages/room/src/room/index.ts"),sa=class{constructor(){}};sa.Create=(e,t)=>H(null,null,function*(){var n,r;s2.info("room created",{operationName:"SkyWayRoom._Factory",sdkName:"room",sdkVersion:ck,init:t});const i=new yh((n=t==null?void 0:t.options)==null?void 0:n.sfu);e.registerPlugin(i);const a=yield mg.Create(e,{name:(r=t.name)!=null?r:ji(),metadata:t.metadata});return yield sa._Factory(e,t.type,a)});sa.Find=(e,t,n,r)=>H(null,null,function*(){const i=new yh(r==null?void 0:r.sfu);e.registerPlugin(i);const a=yield mg.Find(e,t);return yield sa._Factory(e,n,a)});sa.FindOrCreate=(e,t)=>H(null,null,function*(){var n;const r=new yh((n=t==null?void 0:t.options)==null?void 0:n.sfu);e.registerPlugin(r);const i=yield mg.FindOrCreate(e,ie({},t));return yield sa._Factory(e,t.type,i)});sa._Factory=(e,t,n)=>H(null,null,function*(){switch(t){case"p2p":return new dk(n);case"sfu":return yield pk.Create(e,n);default:throw De({operationName:"SkyWayRoom._Factory",context:e,channel:n,info:Cr.notImplemented,path:s2.prefix})}});var fk=sa;Y();/*! Bundled license information:

jsrsasign/lib/jsrsasign.js:
  (*! CryptoJS v3.1.2 core-fix.js
   * code.google.com/p/crypto-js
   * (c) 2009-2013 by Jeff Mott. All rights reserved.
   * code.google.com/p/crypto-js/wiki/License
   * THIS IS FIX of 'core.js' to fix Hmac issue.
   * https://code.google.com/p/crypto-js/issues/detail?id=84
   * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
   *)
  (*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
   *)
  (*! (c) Tom Wu, Kenji Urushima | http://www-cs-students.stanford.edu/~tjw/jsbn/
   *)
  (*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
   *)
  (*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
   *)
*/const mk=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),a2=e=>Array.isArray(e)&&e.every(t=>typeof t=="object"&&!(t instanceof Array)),gk=e=>Array.isArray(e)&&e.every(t=>Array.isArray(t)),vk=e=>Array.from(e.map(t=>Object.keys(t)).reduce((t,n)=>new Set([...t,...n]),[])),yk=(e,t)=>{t=t||vk(e);let n=t,r=t;a2(t)&&(n=t.map(a=>a.label),r=t.map(a=>a.key));const i=e.map(a=>r.map(o=>_k(o,a)));return[n,...i]},_k=(e,t)=>{const n=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(r,i,a,o){const u=r[i];if(u==null)o.splice(1);else return u},t);return n===void 0?e in t?t[e]:"":n},bk=e=>typeof e>"u"||e===null?"":e,o2=(e,t=",",n='"')=>e.filter(r=>r).map(r=>r.map(i=>bk(i)).map(i=>`${n}${i}${n}`).join(t)).join(`
`),Sk=(e,t,n,r)=>o2(t?[t,...e]:e,n,r),wk=(e,t,n,r)=>o2(yk(e,t),n,r),xk=(e,t,n,r)=>t?`${t.join(n)}
${e}`:e.replace(/"/g,'""'),c2=(e,t,n,r)=>{if(a2(e))return wk(e,t,n,r);if(gk(e))return Sk(e,t,n,r);if(typeof e=="string")return xk(e,t,n);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},l2=(e,t,n,r,i)=>{const a=c2(e,n,r,i),o=mk()?"application/csv":"text/csv",u=new Blob([t?"\uFEFF":"",a],{type:o}),p=`data:${o};charset=utf-8,${t?"\uFEFF":""}${a}`,h=window.URL||window.webkitURL;return typeof h.createObjectURL>"u"?p:h.createObjectURL(u)};var u2={exports:{}},Ck="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ek=Ck,Pk=Ek;function d2(){}function h2(){}h2.resetWarningCache=d2;var kk=function(){function e(r,i,a,o,u,p){if(p!==Pk){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:h2,resetWarningCache:d2};return n.PropTypes=n,n};u2.exports=kk();var ai=u2.exports;const p2={data:ai.oneOfType([ai.string,ai.array,ai.func]).isRequired,headers:ai.array,target:ai.string,separator:ai.string,filename:ai.string,uFEFF:ai.bool,onClick:ai.func,asyncOnClick:ai.bool,enclosingCharacter:ai.string},f2={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},Tk={target:"_blank"};class L1 extends n0.Component{constructor(t){super(t),this.state={}}buildURI(){return l2(...arguments)}componentDidMount(){const{data:t,headers:n,separator:r,enclosingCharacter:i,uFEFF:a,target:o,specs:u,replace:p}=this.props;this.state.page=window.open(this.buildURI(t,a,n,r,i),o,u,p)}getWindow(){return this.state.page}render(){return null}}cc(L1,"defaultProps",Object.assign(f2,Tk)),cc(L1,"propTypes",p2);var m2={exports:{}},_h={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rk=vt,Ak=Symbol.for("react.element"),Ik=Symbol.for("react.fragment"),Fk=Object.prototype.hasOwnProperty,Dk=Rk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Nk={key:!0,ref:!0,__self:!0,__source:!0};function g2(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Fk.call(t,r)&&!Nk.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:Ak,type:e,key:a,ref:o,props:i,_owner:Dk.current}}_h.Fragment=Ik;_h.jsx=g2;_h.jsxs=g2;m2.exports=_h;var v2=m2.exports;const Tt=v2.jsx,Cc=v2.jsxs;var Cu;let Ok=(Cu=class extends n0.Component{constructor(t){super(t),this.buildURI=this.buildURI.bind(this)}buildURI(){return l2(...arguments)}handleLegacy(t,n=!1){if(window.navigator.msSaveOrOpenBlob){t.preventDefault();const{data:r,headers:i,separator:a,filename:o,enclosingCharacter:u,uFEFF:p}=this.props,h=n&&typeof r=="function"?r():r;let g=new Blob([p?"\uFEFF":"",c2(h,i,a,u)]);return window.navigator.msSaveBlob(g,o),!1}}handleAsyncClick(t){const n=r=>{if(r===!1){t.preventDefault();return}this.handleLegacy(t,!0)};this.props.onClick(t,n)}handleSyncClick(t){if(this.props.onClick(t)===!1){t.preventDefault();return}this.handleLegacy(t)}handleClick(){return t=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(t):this.handleSyncClick(t);this.handleLegacy(t)}}render(){const{data:t,headers:n,separator:r,filename:i,uFEFF:a,children:o,onClick:u,asyncOnClick:p,enclosingCharacter:h,...g}=this.props,_=typeof window>"u"?"":this.buildURI(t,a,n,r,h);return Tt("a",{download:i,...g,ref:w=>this.link=w,target:"_self",href:_,onClick:this.handleClick(),children:o})}},cc(Cu,"defaultProps",f2),cc(Cu,"propTypes",p2),Cu);const Mk=Ok;function j1(e,t,n,r,i,a,o){try{var u=e[a](o),p=u.value}catch(h){n(h);return}u.done?t(p):Promise.resolve(p).then(r,i)}function Ia(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(p){j1(a,r,i,o,u,"next",p)}function u(p){j1(a,r,i,o,u,"throw",p)}o(void 0)})}}var Lk="Expected a function",B1=NaN,jk="[object Symbol]",Bk=/^\s+|\s+$/g,Uk=/^[-+]0x[0-9a-f]+$/i,Hk=/^0b[01]+$/i,Vk=/^0o[0-7]+$/i,qk=parseInt,zk=typeof Ti=="object"&&Ti&&Ti.Object===Object&&Ti,Kk=typeof self=="object"&&self&&self.Object===Object&&self,$k=zk||Kk||Function("return this")(),Wk=Object.prototype,Gk=Wk.toString,Jk=Math.max,Zk=Math.min,jp=function(){return $k.Date.now()};function Xk(e,t,n){var r,i,a,o,u,p,h=0,g=!1,f=!1,_=!0;if(typeof e!="function")throw new TypeError(Lk);t=U1(t)||0,nm(n)&&(g=!!n.leading,f="maxWait"in n,a=f?Jk(U1(n.maxWait)||0,t):a,_="trailing"in n?!!n.trailing:_);function w($){var z=r,q=i;return r=i=void 0,h=$,o=e.apply(q,z),o}function C($){return h=$,u=setTimeout(b,t),g?w($):o}function R($){var z=$-p,q=$-h,Q=t-z;return f?Zk(Q,a-q):Q}function S($){var z=$-p,q=$-h;return p===void 0||z>=t||z<0||f&&q>=a}function b(){var $=jp();if(S($))return x($);u=setTimeout(b,R($))}function x($){return u=void 0,_&&r?w($):(r=i=void 0,o)}function E(){u!==void 0&&clearTimeout(u),h=0,r=p=i=u=void 0}function M(){return u===void 0?o:x(jp())}function Z(){var $=jp(),z=S($);if(r=arguments,i=this,p=$,z){if(u===void 0)return C(p);if(f)return u=setTimeout(b,t),w(p)}return u===void 0&&(u=setTimeout(b,t)),o}return Z.cancel=E,Z.flush=M,Z}function nm(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Qk(e){return!!e&&typeof e=="object"}function Yk(e){return typeof e=="symbol"||Qk(e)&&Gk.call(e)==jk}function U1(e){if(typeof e=="number")return e;if(Yk(e))return B1;if(nm(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=nm(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Bk,"");var n=Hk.test(e);return n||Vk.test(e)?qk(e.slice(2),n?2:8):Uk.test(e)?B1:+e}var eT=Xk;const tT=rm(eT),go=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),nT=e=>e===go;var Od=()=>/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"");const Md=(...e)=>e.map(t=>t.trim()).join(" ").trim(),rT=/\s*\((.*?)\)\s*/g,iT=/(\(\?:[^)]+\))\?/g,sT=/(\(\?)?:\w+/g,aT=/\*/g,oT=/[-{}[\]+?.,\\^$|#]/g,cT=e=>e instanceof RegExp?new RegExp(e.source,"i"):(e=e.replace(oT,"\\$&").replace(rT,"(?:$1)?").replace(sT,(t,n)=>n?t:"([^\\s]+)").replace(aT,"(.*?)").replace(iT,"\\s*$1?\\s*"),new RegExp("^"+e+"$","i")),lT=(e,t)=>{if(e=e.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!e.length&&!t.length)return 1;if(!e.length||!t.length)return 0;if(e===t)return 1;if(e.length===1&&t.length===1||e.length<2||t.length<2)return 0;const n=new Map;for(let i=0;i<e.length-1;i++){const a=e.substring(i,i+2),o=n.has(a)?n.get(a)+1:1;n.set(a,o)}let r=0;for(let i=0;i<t.length-1;i++){const a=t.substring(i,i+2),o=n.has(a)?n.get(a):0;o>0&&(n.set(a,o-1),r++)}return 2*r/(e.length+t.length-2)},y2=()=>typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0);class Bp{setSpeechRecognition(t){const n=!!t&&(nT(t)||y2());n&&(this.disableRecognition(),this.recognition=new t,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(n)}subscribe(t,n){this.subscribers[t]=n}unsubscribe(t){delete this.subscribers[t]}emitListeningChange(t){this.listening=t,Object.keys(this.subscribers).forEach(n=>{const{onListeningChange:r}=this.subscribers[n];r(t)})}emitMicrophoneAvailabilityChange(t){this.isMicrophoneAvailable=t,Object.keys(this.subscribers).forEach(n=>{const{onMicrophoneAvailabilityChange:r}=this.subscribers[n];r(t)})}emitTranscriptChange(t,n){Object.keys(this.subscribers).forEach(r=>{const{onTranscriptChange:i}=this.subscribers[r];i(t,n)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(t=>{const{onClearTranscript:n}=this.subscribers[t];n()})}emitBrowserSupportsSpeechRecognitionChange(t){Object.keys(this.subscribers).forEach(n=>{const{onBrowserSupportsSpeechRecognitionChange:r,onBrowserSupportsContinuousListeningChange:i}=this.subscribers[n];r(t),i(t)})}disconnect(t){if(this.recognition&&this.listening)switch(t){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(t){t&&t.error&&t.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:t,resultIndex:n}){const r=n===void 0?t.length-1:n;this.interimTranscript="",this.finalTranscript="";for(let a=r;a<t.length;++a)t[a].isFinal&&(!Od()||t[a][0].confidence>0)?this.updateFinalTranscript(t[a][0].transcript):this.interimTranscript=Md(this.interimTranscript,t[a][0].transcript);let i=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(i=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,i||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(t){this.finalTranscript=Md(this.finalTranscript,t)}resetTranscript(){this.disconnect("RESET")}startListening(){return Ia(function*({continuous:t=!1,language:n}={}){if(!this.recognition)return;const r=t!==this.recognition.continuous,i=n&&n!==this.recognition.lang;if((r||i)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=r?t:this.recognition.continuous,this.recognition.lang=i?n:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(a){a instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return Ia(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}stopListening(){return Ia(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}getRecognition(){return this.recognition}start(){return Ia(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(t){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(t),Od()&&(this.updateFinalTranscript=tT(this.updateFinalTranscript,250,{leading:!0}))}}const _2="CLEAR_TRANSCRIPT",b2="APPEND_TRANSCRIPT",uT=()=>({type:_2}),dT=(e,t)=>({type:b2,payload:{interimTranscript:e,finalTranscript:t}}),hT=(e,t)=>{switch(t.type){case _2:return{interimTranscript:"",finalTranscript:""};case b2:return{interimTranscript:t.payload.interimTranscript,finalTranscript:Md(e.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};let vo=!!go,Xu=vo&&!Od(),os;const pT=({transcribing:e=!0,clearTranscriptOnListen:t=!0,commands:n=[]}={})=>{const[r]=vt.useState(Fa.getRecognitionManager()),[i,a]=vt.useState(vo),[o,u]=vt.useState(Xu),[{interimTranscript:p,finalTranscript:h},g]=vt.useReducer(hT,{interimTranscript:r.interimTranscript,finalTranscript:""}),[f,_]=vt.useState(r.listening),[w,C]=vt.useState(r.isMicrophoneAvailable),R=vt.useRef(n);R.current=n;const S=()=>{g(uT())},b=vt.useCallback(()=>{r.resetTranscript(),S()},[r]),x=(q,Q,K)=>{const oe=(typeof q=="object"?q.toString():q).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),ce=lT(oe,Q);return ce>=K?{command:q,commandWithoutSpecials:oe,howSimilar:ce,isFuzzyMatch:!0}:null},E=(q,Q)=>{const ee=cT(q).exec(Q);return ee?{command:q,parameters:ee.slice(1)}:null},M=vt.useCallback((q,Q)=>{R.current.forEach(({command:K,callback:ee,matchInterim:oe=!1,isFuzzyMatch:ce=!1,fuzzyMatchingThreshold:ne=.8,bestMatchOnly:ke=!1})=>{const _e=!Q&&oe?q.trim():Q.trim(),fe=(Array.isArray(K)?K:[K]).map(ge=>ce?x(ge,_e,ne):E(ge,_e)).filter(ge=>ge);if(ce&&ke&&fe.length>=2){fe.sort((Je,ut)=>ut.howSimilar-Je.howSimilar);const{command:ge,commandWithoutSpecials:Ee,howSimilar:Oe}=fe[0];ee(Ee,_e,Oe,{command:ge,resetTranscript:b})}else fe.forEach(ge=>{if(ge.isFuzzyMatch){const{command:Ee,commandWithoutSpecials:Oe,howSimilar:Je}=ge;ee(Oe,_e,Je,{command:Ee,resetTranscript:b})}else{const{command:Ee,parameters:Oe}=ge;ee(...Oe,{command:Ee,resetTranscript:b})}})})},[b]),Z=vt.useCallback((q,Q)=>{e&&g(dT(q,Q)),M(q,Q)},[M,e]),$=vt.useCallback(()=>{t&&S()},[t]);return vt.useEffect(()=>{const q=Fa.counter;Fa.counter+=1;const Q={onListeningChange:_,onMicrophoneAvailabilityChange:C,onTranscriptChange:Z,onClearTranscript:$,onBrowserSupportsSpeechRecognitionChange:a,onBrowserSupportsContinuousListeningChange:u};return r.subscribe(q,Q),()=>{r.unsubscribe(q)}},[e,t,r,Z,$]),{transcript:Md(h,p),interimTranscript:p,finalTranscript:h,listening:f,isMicrophoneAvailable:w,resetTranscript:b,browserSupportsSpeechRecognition:i,browserSupportsContinuousListening:o}},Fa={counter:0,applyPolyfill:e=>{os?os.setSpeechRecognition(e):os=new Bp(e);const t=!!e&&y2();vo=t,Xu=t},removePolyfill:()=>{os?os.setSpeechRecognition(go):os=new Bp(go),vo=!!go,Xu=vo&&!Od()},getRecognitionManager:()=>(os||(os=new Bp(go)),os),getRecognition:()=>Fa.getRecognitionManager().getRecognition(),startListening:({continuous:e,language:t}={})=>Ia(function*(){yield Fa.getRecognitionManager().startListening({continuous:e,language:t})})(),stopListening:()=>Ia(function*(){yield Fa.getRecognitionManager().stopListening()})(),abortListening:()=>Ia(function*(){yield Fa.getRecognitionManager().abortListening()})(),browserSupportsSpeechRecognition:()=>vo,browserSupportsContinuousListening:()=>Xu};var S2={exports:{}};(function(e,t){(function(r,i){e.exports=i(vt)})(Ti,function(n){return function(r){var i={};function a(o){if(i[o])return i[o].exports;var u=i[o]={i:o,l:!1,exports:{}};return r[o].call(u.exports,u,u.exports,a),u.l=!0,u.exports}return a.m=r,a.c=i,a.d=function(o,u,p){a.o(o,u)||Object.defineProperty(o,u,{enumerable:!0,get:p})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,u){if(u&1&&(o=a(o)),u&8||u&4&&typeof o=="object"&&o&&o.__esModule)return o;var p=Object.create(null);if(a.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:o}),u&2&&typeof o!="string")for(var h in o)a.d(p,h,(function(g){return o[g]}).bind(null,h));return p},a.n=function(o){var u=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(u,"a",u),u},a.o=function(o,u){return Object.prototype.hasOwnProperty.call(o,u)},a.p="",a(a.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,i,a){a.r(i);var o=a("react"),u=function(){var _=function(w,C){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,S){R.__proto__=S}||function(R,S){for(var b in S)S.hasOwnProperty(b)&&(R[b]=S[b])},_(w,C)};return function(w,C){_(w,C);function R(){this.constructor=w}w.prototype=C===null?Object.create(C):(R.prototype=C.prototype,new R)}}(),p=function(){return p=Object.assign||function(_){for(var w,C=1,R=arguments.length;C<R;C++){w=arguments[C];for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(_[S]=w[S])}return _},p.apply(this,arguments)},h=function(_,w){var C={};for(var R in _)Object.prototype.hasOwnProperty.call(_,R)&&w.indexOf(R)<0&&(C[R]=_[R]);if(_!=null&&typeof Object.getOwnPropertySymbols=="function")for(var S=0,R=Object.getOwnPropertySymbols(_);S<R.length;S++)w.indexOf(R[S])<0&&Object.prototype.propertyIsEnumerable.call(_,R[S])&&(C[R[S]]=_[R[S]]);return C};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(w){var C=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return C?new Promise(function(R,S){C.call(navigator,w,R,S)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function g(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var f=function(_){u(w,_);function w(C){var R=_.call(this,C)||this;return R.canvas=null,R.ctx=null,R.requestUserMediaId=0,R.unmounted=!1,R.state={hasUserMedia:!1},R}return w.prototype.componentDidMount=function(){var C=this,R=C.state,S=C.props;if(this.unmounted=!1,!g()){S.onUserMediaError("getUserMedia not supported");return}R.hasUserMedia||this.requestUserMedia(),S.children&&typeof S.children!="function"&&console.warn("children must be a function")},w.prototype.componentDidUpdate=function(C){var R=this.props;if(!g()){R.onUserMediaError("getUserMedia not supported");return}var S=JSON.stringify(C.audioConstraints)!==JSON.stringify(R.audioConstraints),b=JSON.stringify(C.videoConstraints)!==JSON.stringify(R.videoConstraints),x=C.minScreenshotWidth!==R.minScreenshotWidth,E=C.minScreenshotHeight!==R.minScreenshotHeight;(b||x||E)&&(this.canvas=null,this.ctx=null),(S||b)&&(this.stopAndCleanup(),this.requestUserMedia())},w.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},w.stopMediaStream=function(C){C&&(C.getVideoTracks&&C.getAudioTracks?(C.getVideoTracks().map(function(R){C.removeTrack(R),R.stop()}),C.getAudioTracks().map(function(R){C.removeTrack(R),R.stop()})):C.stop())},w.prototype.stopAndCleanup=function(){var C=this.state;C.hasUserMedia&&(w.stopMediaStream(this.stream),C.src&&window.URL.revokeObjectURL(C.src))},w.prototype.getScreenshot=function(C){var R=this,S=R.state,b=R.props;if(!S.hasUserMedia)return null;var x=this.getCanvas(C);return x&&x.toDataURL(b.screenshotFormat,b.screenshotQuality)},w.prototype.getCanvas=function(C){var R=this,S=R.state,b=R.props;if(!this.video||!S.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var x=this.video.videoWidth,E=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var M=x/E;x=b.minScreenshotWidth||this.video.clientWidth,E=x/M,b.minScreenshotHeight&&E<b.minScreenshotHeight&&(E=b.minScreenshotHeight,x=E*M)}this.canvas=document.createElement("canvas"),this.canvas.width=(C==null?void 0:C.width)||x,this.canvas.height=(C==null?void 0:C.height)||E,this.ctx=this.canvas.getContext("2d")}var Z=this,$=Z.ctx,z=Z.canvas;return $&&z&&(z.width=(C==null?void 0:C.width)||z.width,z.height=(C==null?void 0:C.height)||z.height,b.mirrored&&($.translate(z.width,0),$.scale(-1,1)),$.imageSmoothingEnabled=b.imageSmoothing,$.drawImage(this.video,0,0,(C==null?void 0:C.width)||z.width,(C==null?void 0:C.height)||z.height),b.mirrored&&($.scale(-1,1),$.translate(-z.width,0))),z},w.prototype.requestUserMedia=function(){var C=this,R=this.props,S=function(E,M){var Z={video:typeof M<"u"?M:!0};R.audio&&(Z.audio=typeof E<"u"?E:!0),C.requestUserMediaId++;var $=C.requestUserMediaId;navigator.mediaDevices.getUserMedia(Z).then(function(z){C.unmounted||$!==C.requestUserMediaId?w.stopMediaStream(z):C.handleUserMedia(null,z)}).catch(function(z){C.handleUserMedia(z)})};if("mediaDevices"in navigator)S(R.audioConstraints,R.videoConstraints);else{var b=function(E){return{optional:[{sourceId:E}]}},x=function(E){var M=E.deviceId;return typeof M=="string"?M:Array.isArray(M)&&M.length>0?M[0]:typeof M=="object"&&M.ideal?M.ideal:null};MediaStreamTrack.getSources(function(E){var M=null,Z=null;E.forEach(function(q){q.kind==="audio"?M=q.id:q.kind==="video"&&(Z=q.id)});var $=x(R.audioConstraints);$&&(M=$);var z=x(R.videoConstraints);z&&(Z=z),S(b(M),b(Z))})}},w.prototype.handleUserMedia=function(C,R){var S=this.props;if(C||!R){this.setState({hasUserMedia:!1}),S.onUserMediaError(C);return}this.stream=R;try{this.video&&(this.video.srcObject=R),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(R)})}S.onUserMedia(R)},w.prototype.render=function(){var C=this,R=this,S=R.state,b=R.props,x=b.audio;b.forceScreenshotSourceSize;var E=b.disablePictureInPicture;b.onUserMedia,b.onUserMediaError,b.screenshotFormat,b.screenshotQuality,b.minScreenshotWidth,b.minScreenshotHeight,b.audioConstraints,b.videoConstraints,b.imageSmoothing;var M=b.mirrored,Z=b.style,$=Z===void 0?{}:Z,z=b.children,q=h(b,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),Q=M?p(p({},$),{transform:($.transform||"")+" scaleX(-1)"}):$,K={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",p({autoPlay:!0,disablePictureInPicture:E,src:S.src,muted:!x,playsInline:!0,ref:function(ee){C.video=ee},style:Q},q)),z&&z(K))},w.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},w}(o.Component);i.default=f},react:function(r,i){r.exports=n}}).default})})(S2);var fT=S2.exports;const mT=rm(fT),gT="78d4247e-9c81-45c4-a3ad-cad69d3fa502",vT="q30eIW0sHi102yMNovcPpJm31EX/AbcjpsZnjHbOmoI=",yT=new bl({jti:Wo(),iat:f1(),exp:f1()+60*60*24,scope:{app:{id:gT,turn:!0,actions:["read"],channels:[{id:"*",name:"*",actions:["write"],members:[{id:"*",name:"*",actions:["write"],publication:{actions:["write"]},subscription:{actions:["write"]}}],sfuBots:[{actions:["write"],forwardings:[{actions:["write"]}]}]}]}}}),_T=yT.encode(vT),bT={log:{level:"debug"}},ST={},wu={WIDTH_MAX:window.innerWidth,HEIGHT_MAX:window.innerHeight},wT=window.scrollX,H1=20,xT=({subscription:e,windowInfo:t,participantNum:n,participantAllNums:r,windowMax:i})=>{const a=vt.useRef(null);vt.useEffect(()=>{a!=null&&a.current&&e.stream&&(a.current.srcObject=new MediaStream([e.stream.track]))},[a==null?void 0:a.current,e.stream]);const o=vt.useMemo(()=>(console.log("Window Info:"+t),t?(console.log("participantAllNums = "+r),{position:"absolute",width:(t==null?void 0:t.width)-H1,height:t.height-H1,top:`${0+wu.HEIGHT_MAX*(n%2===1?n/(1+Math.floor((r-1)/2))/2:(n-1)/(1+Math.floor((r-1)/2))/2)-t.height/2+t.topDiff}px`,left:`${window.screenLeft+wT+(r%2===1&&n===r?wu.WIDTH_MAX/2:n%2===1?wu.WIDTH_MAX/4:wu.WIDTH_MAX*3/4)-t.width/2+t.leftDiff+0}px`,border:`10px solid rgba(${t==null?void 0:t.borderRed}, ${t==null?void 0:t.borderGreen}, ${t==null?void 0:t.borderBlue}, ${t.borderAlpha})`}):{}),[t]);return Tt("div",{children:Tt("video",{muted:!0,autoPlay:!0,playsInline:!0,ref:a,onClick:async()=>{e.preferredEncoding==="high"?e.changePreferredEncoding("low"):e.preferredEncoding==="low"&&e.changePreferredEncoding("high")},style:o})})},bt={MOVING_AVERAGE_FRAME:10,WIDTH_MAX:window.innerWidth,WIDTH_MIN:window.innerWidth*.8,HEIGHT_MAX:window.innerHeight,HEIGHT_MIN:window.innerHeight*.8,DISTANCE_RATE_MOVE:1e4,DEFAULT_TOP_DIFF:0,DEFAULT_LEFT_DIFF:0,BORDER_ALPHA_MIN:0,BORDER_ALPHA_MAX:1,BORDER_ALPHA_MIN_THRESHOLD:.015,BORDER_COLORS:{GREEN:{r:83,g:253,b:49,a:0}}},V1=(bt.WIDTH_MAX+bt.WIDTH_MIN)/2,CT=(bt.HEIGHT_MAX+bt.HEIGHT_MIN)/2,ba=bt.BORDER_COLORS.GREEN,ET=window.scrollX,Pn={averageValue:(e,t=0,n=e.length-1)=>{let r=0;for(let i=t;i<n+1;i++)r+=e[i];return r/(n-t+1)},inner:(e,t)=>e[0]*t[0]+e[1]*t[1],norm:e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),getParticipantDirection:e=>e<0||e>360?"Error":e<22.5||e>=337.5?"Left":e>=22.5&&e<67.5?"LeftDown":e>=67.5&&e<112.5?"Down":e>=112.5&&e<157.5?"RightDown":e>=157.5&&e<202.5?"Right":e>=202.5&&e<247.5?"RightUp":e>=247.5&&e<292.5?"Up":e>=292.5&&e<337.5?"LeftUp":"Error"};let Ec=1,Sa=1,Ls="Baseline",q1=0,xu=0;const cs=[],ls=[],us=[],z1=!1,Up=bt.BORDER_ALPHA_MIN,K1=20,PT=()=>{const[e,t]=vt.useState(""),[n,r]=vt.useState(),[i,a]=vt.useState(),[o,u]=vt.useState(),[p,h]=vt.useState([]),[g,f]=vt.useState({topDiff:bt.DEFAULT_TOP_DIFF,leftDiff:bt.DEFAULT_LEFT_DIFF,width:300,height:300,borderRed:ba.r,borderGreen:ba.g,borderBlue:ba.b,borderAlpha:ba.a,borderAlphaValueBasedVoice:Up,widthInCaseOfChange:0,heightInCaseOfChange:0,theta:0,isSpeaking:!1,transcript:"",gazeStatus:""}),[_,w]=vt.useState(new Map),[C,R]=vt.useState(new Map);pT();const[S,b]=vt.useState([]),[x,E]=vt.useState(0),[M,Z]=vt.useState(!1),$=vt.useRef(null),z=vt.useRef(null),q=vt.useRef(null),Q=vt.useRef(),K=vt.useRef(null),ee=vt.useMemo(()=>({position:"absolute",top:`${0+bt.HEIGHT_MAX/(1+Math.floor(xu/2))/2-g.height/2+g.topDiff}px`,left:`${window.screenLeft+ET+(p.length===0?bt.WIDTH_MAX/2:bt.WIDTH_MAX/4)-g.width/2+g.leftDiff+0}px`,width:g.width-K1,height:g.height-K1,border:`10px solid rgba(${g.borderRed}, ${g.borderGreen}, ${g.borderBlue}, ${g.borderAlpha})`}),[g]),oe=vt.useCallback((le,fe,ge,Ee,Oe,Je,ut,ot)=>{let nt=0,He=0,Qe=0,mt=0,Lt=0,Wt=0,Fn=0,Bi=0,fr=0,mi="";const wn=bt.DISTANCE_RATE_MOVE*Pn.norm(fe)*Math.sin(ge),mr=bt.DISTANCE_RATE_MOVE*Pn.norm(fe)*Math.cos(ge-Math.PI);let Dn;const sn=ot===0?bt.WIDTH_MAX:bt.WIDTH_MAX/2,Tn=ot===0?bt.WIDTH_MIN:bt.WIDTH_MIN/2,Kr=ot===0?V1:V1/2,xn=bt.HEIGHT_MAX/(1+Math.floor(ot/2)),ti=bt.HEIGHT_MIN/(1+Math.floor(ot/2)),pn=CT/(1+Math.floor(ot/2));console.log("videoSubscriptionsLength = "+ot),150*Pn.norm(fe)<=1?(nt=1,He=1):(nt=1/(150*Pn.norm(fe)),He=1/(150*Pn.norm(fe))),Qe=sn*nt,mt=xn*nt,Lt=bt.BORDER_ALPHA_MAX*He,Qe<Tn&&(Qe=Tn),mt<ti&&(mt=ti),Lt<bt.BORDER_ALPHA_MIN_THRESHOLD&&(Lt=bt.BORDER_ALPHA_MIN),Wt=Qe,Fn=mt,cs.push(Qe),ls.push(mt),us.push(Lt),cs.length<bt.MOVING_AVERAGE_FRAME?Qe=Pn.averageValue(cs,0,cs.length-1):(cs.length>bt.MOVING_AVERAGE_FRAME+3&&cs.shift(),Qe=Pn.averageValue(cs,cs.length-bt.MOVING_AVERAGE_FRAME,cs.length-1)),ls.length<bt.MOVING_AVERAGE_FRAME?mt=Pn.averageValue(ls,0,ls.length-1):(ls.length>bt.MOVING_AVERAGE_FRAME+3&&ls.shift(),mt=Pn.averageValue(ls,ls.length-bt.MOVING_AVERAGE_FRAME,ls.length-1)),us.length<bt.MOVING_AVERAGE_FRAME?Lt=Pn.averageValue(us,0,us.length-1):(us.length>bt.MOVING_AVERAGE_FRAME+3&&us.shift(),Lt=Pn.averageValue(us,us.length-bt.MOVING_AVERAGE_FRAME,us.length-1)),Qe>sn-(sn-Tn)*.1?Bi=sn:Bi=Tn,mt>xn-(xn-ti)*.1?fr=xn:fr=ti,Wt>sn-(sn-Tn)*.1&&(mi="mutual gaze"),Wt<Tn+(sn-Tn)*.1&&(mi="gaze aversion");const Un={borderRed:ba.r,borderGreen:ba.g,borderBlue:ba.b,borderAlphaValueBasedVoice:Oe,widthInCaseOfChange:Wt,heightInCaseOfChange:Fn,theta:Ee,isSpeaking:Je,transcript:ut,gazeStatus:mi};switch(le){case 1:Dn={...Un,topDiff:bt.DEFAULT_TOP_DIFF,leftDiff:bt.DEFAULT_LEFT_DIFF,width:Kr,height:pn,borderAlpha:Oe};break;case 2:Dn={...Un,topDiff:bt.DEFAULT_TOP_DIFF,leftDiff:bt.DEFAULT_LEFT_DIFF,width:Kr,height:pn,borderAlpha:Lt};break;case 3:Dn={...Un,topDiff:bt.DEFAULT_TOP_DIFF,leftDiff:bt.DEFAULT_LEFT_DIFF,width:Qe,height:mt,borderAlpha:Oe};break;case 4:Dn={...Un,topDiff:bt.DEFAULT_TOP_DIFF,leftDiff:bt.DEFAULT_LEFT_DIFF,width:Bi,height:fr,borderAlpha:Oe};break;case 5:Dn={...Un,topDiff:wn,leftDiff:mr,width:Kr,height:pn,borderAlpha:Oe};break;case 6:Dn={...Un,topDiff:wn,leftDiff:mr,width:Qe,height:mt,borderAlpha:Oe};break;default:Dn={...Un,topDiff:bt.DEFAULT_TOP_DIFF,leftDiff:bt.DEFAULT_LEFT_DIFF,width:Kr,height:pn,borderAlpha:Oe}}return Dn},[]),ce=vt.useCallback(le=>{if(le.multiFaceLandmarks.length>0){Q.current=le;const fe=[],ge=[],Ee=[];if(le.multiFaceLandmarks&&le.multiFaceLandmarks[0])for(let He=0;He<le.multiFaceLandmarks[0].length;He++)le.multiFaceLandmarks[0][He].x<0?fe.push(0):le.multiFaceLandmarks[0][He].x>1?fe.push(1):fe.push(le.multiFaceLandmarks[0][He].x),le.multiFaceLandmarks[0][He].y<0?ge.push(0):le.multiFaceLandmarks[0][He].y>1?ge.push(1):ge.push(le.multiFaceLandmarks[0][He].y),He===1&&(le.multiFaceLandmarks[0][He].x<0?Ee.push(0):le.multiFaceLandmarks[0][He].x>1?Ee.push(1):Ee.push(le.multiFaceLandmarks[0][He].x),le.multiFaceLandmarks[0][He].y<0?Ee.push(0):le.multiFaceLandmarks[0][He].y>1?Ee.push(1):Ee.push(le.multiFaceLandmarks[0][He].y));const Oe=[Pn.averageValue(fe),Pn.averageValue(ge)],Je=[1,0],ut=[Ee[0]-Oe[0],Ee[1]-Oe[1]];let ot=Math.acos(Pn.inner(Je,ut)/(Pn.norm(Je)*Pn.norm(ut))),nt=ot*(180/Math.PI);ut[1]<0&&(ot=-ot,nt=360-nt),f(()=>oe(Sa,ut,ot,nt,Up,z1,"",xu))}},[]);vt.useCallback(le=>{if(le.faceLandmarks.length>0){const fe=[],ge=[],Ee=[];if(le.faceLandmarks&&le.faceLandmarks[0])for(let He=0;He<le.faceLandmarks[0].length;He++)le.faceLandmarks[0][He].x<0?fe.push(0):le.faceLandmarks[0][He].x>1?fe.push(1):fe.push(le.faceLandmarks[0][He].x),le.faceLandmarks[0][He].y<0?ge.push(0):le.faceLandmarks[0][He].y>1?ge.push(1):ge.push(le.faceLandmarks[0][He].y),He===1&&(le.faceLandmarks[0][He].x<0?Ee.push(0):le.faceLandmarks[0][He].x>1?Ee.push(1):Ee.push(le.faceLandmarks[0][He].x),le.faceLandmarks[0][He].y<0?Ee.push(0):le.faceLandmarks[0][He].y>1?Ee.push(1):Ee.push(le.faceLandmarks[0][He].y));const Oe=[Pn.averageValue(fe),Pn.averageValue(ge)],Je=[1,0],ut=[Ee[0]-Oe[0],Ee[1]-Oe[1]];let ot=Math.acos(Pn.inner(Je,ut)/(Pn.norm(Je)*Pn.norm(ut))),nt=ot*(180/Math.PI);ut[1]<0&&(ot=-ot,nt=360-nt),f(()=>oe(Sa,ut,ot,nt,Up,z1,"",xu))}},[]);const ne=vt.useCallback(()=>{b([{ID:Ec,condition:Sa,startTime:0,endTime:0,myTheta:0,myDirection:"",myWindowWidth:0,myWindowHeight:0,myStatusGaze:"",myIsSpeaking:!1,myTranscript:""}]),E(0),q1=performance.now(),Z(!0)},[]),ke=vt.useCallback(()=>{var le;Z(!1),(le=K==null?void 0:K.current)==null||le.link.click()},[]),_e=async()=>{var Je,ut,ot;const le=await em.Create(_T,bT),fe=await fk.FindOrCreate(le,{name:e,type:"p2p",options:ST}),ge=await fe.join();r(ge);const Ee=await I1.createMicrophoneAudioAndCameraStream({video:{frameRate:15}});Ee.video.attach($.current);const Oe=await I1.createDataStream();a(Ee),u(Oe),await((Je=$.current)==null?void 0:Je.play()),await ge.publish(Ee.audio,{maxSubscribers:50}),await ge.publish(Ee.video,{maxSubscribers:50,encodings:[{scaleResolutionDownBy:4,id:"low",maxBitrate:8e4},{scaleResolutionDownBy:1,id:"high",maxBitrate:4e5}]}),Oe!==void 0&&(console.log("published data stream"),await ge.publish(Oe)),ge.onPublicationSubscribed.add(nt=>{if(nt.stream.contentType==="audio"){const He=q?q.current:null,Qe=document.createElement("audio");Qe.srcObject=new MediaStream([nt.stream.track]),Qe.play(),He==null||He.appendChild(Qe),nt.subscription.onCanceled.once(()=>{He==null||He.removeChild(Qe)})}}),ge.onPublicationUnsubscribed.add(nt=>{R(He=>{const Qe=new Map(He);return Qe.delete(nt.subscription.id),Qe})}),ge.onSubscriptionListChanged.add(()=>{const nt=ge.subscriptions.filter(He=>He.contentType==="video");h(nt),console.log("subscriptions.length",nt.length),xu=nt.length}),fe.onStreamPublished.add(async nt=>{if(nt.publication.publisher.id!==ge.id)try{const{stream:He}=await ge.subscribe(nt.publication);He.contentType==="data"&&R(Qe=>new Map(Qe).set(nt.publication.publisher.id,He))}catch(He){console.log("Failed to subscribe to data stream:",He),He instanceof wr&&He.name==="internal"&&console.log("Publisher already left the room, ignoring subscription.")}}),(ut=document.getElementById("active-after-conference"))==null||ut.classList.remove("non-active"),(ot=document.getElementById("active-before-conference"))==null||ot.classList.add("non-active"),await Promise.all(fe.publications.filter(nt=>nt.publisher.id!==ge.id).map(async nt=>{try{const{stream:He}=await ge.subscribe(nt);He.contentType==="data"&&R(Qe=>new Map(Qe).set(nt.publisher.id,He))}catch(He){console.error("Failed to subscribe:",He)}}))};return vt.useEffect(()=>{C.forEach((le,fe)=>{le.onData.add(ge=>{console.log("Receiving Data from",fe,":",ge),w(Ee=>{const Oe=new Map(Ee);return Oe.set(fe,ge),Oe})})})},[C]),vt.useEffect(()=>{o&&(console.log("Sending Data:",g),o.write(g))},[o,g]),vt.useEffect(()=>{var fe;const le=new x4({locateFile:ge=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${ge}`});return le.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),le.onResults(ce),$.current&&((fe=z.current)!=null&&fe.video)&&new w4(z.current.video,{onFrame:async()=>{await le.send({image:z.current.video})}}).start(),()=>{le.close()}},[ce]),vt.useEffect(()=>{if(o&&C&&M){const le=(performance.now()-q1)/1e3,fe={ID:Ec,condition:Sa,startTime:x,endTime:le,myTheta:g.theta,myDirection:Pn.getParticipantDirection(g.theta),myWindowWidth:g.widthInCaseOfChange,myWindowHeight:g.heightInCaseOfChange,myStatusGaze:g.gazeStatus,myIsSpeaking:g.isSpeaking,myTranscript:g.transcript};b(ge=>[...ge,fe]),E(le)}},[M,x,g,C]),Cc("div",{children:[Tt("div",{id:"active-before-conference",children:Cc("p",{children:["Your ID:",Cc("select",{id:"ID",onChange:le=>{Ec=Number(le.target.value)},children:[Tt("option",{value:"1",children:"1"}),Tt("option",{value:"2",children:"2"}),Tt("option",{value:"3",children:"3"}),Tt("option",{value:"4",children:"4"}),Tt("option",{value:"5",children:"5"}),Tt("option",{value:"6",children:"6"}),Tt("option",{value:"7",children:"7"}),Tt("option",{value:"8",children:"8"}),Tt("option",{value:"9",children:"9"}),Tt("option",{value:"10",children:"10"}),Tt("option",{value:"11",children:"11"}),Tt("option",{value:"12",children:"12"}),Tt("option",{value:"13",children:"13"}),Tt("option",{value:"14",children:"14"}),Tt("option",{value:"15",children:"15"}),Tt("option",{value:"16",children:"16"}),Tt("option",{value:"17",children:"17"}),Tt("option",{value:"18",children:"18"}),Tt("option",{value:"19",children:"19"}),Tt("option",{value:"20",children:"20"})]}),"   condition=",Cc("select",{id:"condition",onChange:le=>{switch(Sa=Number(le.target.value),Sa){case 1:Ls="Baseline";break;case 2:Ls="FrameChange";break;case 3:Ls="SizeChange";break;case 4:Ls="SizeChange_Discrete";break;case 5:Ls="PositionChange";break;case 6:Ls="PositionAndSizeChange";break;default:Ls="";break}},children:[Tt("option",{value:"1",children:"Baseline"}),Tt("option",{value:"2",children:"FrameChange"}),Tt("option",{value:"3",children:"SizeChange"}),Tt("option",{value:"4",children:"SizeChange_Discrete"})]}),"   room name:"," ",Tt("input",{type:"text",value:e,onChange:le=>{t(le.target.value)}})," ",Tt("button",{onClick:_e,children:"join"})]})}),Cc("div",{id:"active-after-conference",className:"non-active",children:["ID: ",Ec,"    condition: ",Ls,"    room name: ",e,"          ",Tt("button",{onClick:ne,disabled:M,children:"Measurement Start"}),"     ",Tt("button",{onClick:ke,disabled:!M,children:"Measurement End"})]}),Tt("video",{id:"local-video",ref:$,muted:!0,playsInline:!0,style:ee}),Tt(mT,{id:"local-video-webcam",ref:z,muted:!0,playsInline:!0,style:ee}),Tt("div",{style:{display:"flex",flexWrap:"wrap"},children:p.map(le=>Tt(xT,{subscription:le,windowInfo:_.get(le.publication.publisher.id),participantNum:p.indexOf(le)+2,participantAllNums:p.length+1,windowMax:bt.WIDTH_MAX},le.id))}),Tt("div",{ref:q}),Tt(Mk,{data:S,filename:`C${Sa}_ID${Ec}_headDirectionResults.csv`,ref:K})]})},kT=r_(document.getElementById("root"));kT.render(Tt(PT,{}));
