var O2=Object.defineProperty;var M2=(e,t,n)=>t in e?O2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ac=(e,t,n)=>M2(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var M1={exports:{}},Yr={},Kh={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kg;function L2(){if(kg)return Ft;kg=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),f=Symbol.iterator;function _(ce){return ce===null||typeof ce!="object"?null:(ce=f&&ce[f]||ce["@@iterator"],typeof ce=="function"?ce:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,R={};function S(ce,Ce,je){this.props=ce,this.context=Ce,this.refs=R,this.updater=je||w}S.prototype.isReactComponent={},S.prototype.setState=function(ce,Ce){if(typeof ce!="object"&&typeof ce!="function"&&ce!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ce,Ce,"setState")},S.prototype.forceUpdate=function(ce){this.updater.enqueueForceUpdate(this,ce,"forceUpdate")};function b(){}b.prototype=S.prototype;function x(ce,Ce,je){this.props=ce,this.context=Ce,this.refs=R,this.updater=je||w}var E=x.prototype=new b;E.constructor=x,C(E,S.prototype),E.isPureReactComponent=!0;var M=Array.isArray,Z=Object.prototype.hasOwnProperty,$={current:null},z={key:!0,ref:!0,__self:!0,__source:!0};function q(ce,Ce,je){var $e,et={},it=null,ze=null;if(Ce!=null)for($e in Ce.ref!==void 0&&(ze=Ce.ref),Ce.key!==void 0&&(it=""+Ce.key),Ce)Z.call(Ce,$e)&&!z.hasOwnProperty($e)&&(et[$e]=Ce[$e]);var Ge=arguments.length-2;if(Ge===1)et.children=je;else if(1<Ge){for(var Le=Array(Ge),Je=0;Je<Ge;Je++)Le[Je]=arguments[Je+2];et.children=Le}if(ce&&ce.defaultProps)for($e in Ge=ce.defaultProps,Ge)et[$e]===void 0&&(et[$e]=Ge[$e]);return{$$typeof:e,type:ce,key:it,ref:ze,props:et,_owner:$.current}}function Q(ce,Ce){return{$$typeof:e,type:ce.type,key:Ce,ref:ce.ref,props:ce.props,_owner:ce._owner}}function K(ce){return typeof ce=="object"&&ce!==null&&ce.$$typeof===e}function ee(ce){var Ce={"=":"=0",":":"=2"};return"$"+ce.replace(/[=:]/g,function(je){return Ce[je]})}var ae=/\/+/g;function le(ce,Ce){return typeof ce=="object"&&ce!==null&&ce.key!=null?ee(""+ce.key):Ce.toString(36)}function ne(ce,Ce,je,$e,et){var it=typeof ce;(it==="undefined"||it==="boolean")&&(ce=null);var ze=!1;if(ce===null)ze=!0;else switch(it){case"string":case"number":ze=!0;break;case"object":switch(ce.$$typeof){case e:case t:ze=!0}}if(ze)return ze=ce,et=et(ze),ce=$e===""?"."+le(ze,0):$e,M(et)?(je="",ce!=null&&(je=ce.replace(ae,"$&/")+"/"),ne(et,Ce,je,"",function(Je){return Je})):et!=null&&(K(et)&&(et=Q(et,je+(!et.key||ze&&ze.key===et.key?"":(""+et.key).replace(ae,"$&/")+"/")+ce)),Ce.push(et)),1;if(ze=0,$e=$e===""?".":$e+":",M(ce))for(var Ge=0;Ge<ce.length;Ge++){it=ce[Ge];var Le=$e+le(it,Ge);ze+=ne(it,Ce,je,Le,et)}else if(Le=_(ce),typeof Le=="function")for(ce=Le.call(ce),Ge=0;!(it=ce.next()).done;)it=it.value,Le=$e+le(it,Ge++),ze+=ne(it,Ce,je,Le,et);else if(it==="object")throw Ce=String(ce),Error("Objects are not valid as a React child (found: "+(Ce==="[object Object]"?"object with keys {"+Object.keys(ce).join(", ")+"}":Ce)+"). If you meant to render a collection of children, use an array instead.");return ze}function Re(ce,Ce,je){if(ce==null)return ce;var $e=[],et=0;return ne(ce,$e,"","",function(it){return Ce.call(je,it,et++)}),$e}function ve(ce){if(ce._status===-1){var Ce=ce._result;Ce=Ce(),Ce.then(function(je){(ce._status===0||ce._status===-1)&&(ce._status=1,ce._result=je)},function(je){(ce._status===0||ce._status===-1)&&(ce._status=2,ce._result=je)}),ce._status===-1&&(ce._status=0,ce._result=Ce)}if(ce._status===1)return ce._result.default;throw ce._result}var _e={current:null},we={transition:null},Ee={ReactCurrentDispatcher:_e,ReactCurrentBatchConfig:we,ReactCurrentOwner:$};function fe(){throw Error("act(...) is not supported in production builds of React.")}return Ft.Children={map:Re,forEach:function(ce,Ce,je){Re(ce,function(){Ce.apply(this,arguments)},je)},count:function(ce){var Ce=0;return Re(ce,function(){Ce++}),Ce},toArray:function(ce){return Re(ce,function(Ce){return Ce})||[]},only:function(ce){if(!K(ce))throw Error("React.Children.only expected to receive a single React element child.");return ce}},Ft.Component=S,Ft.Fragment=n,Ft.Profiler=i,Ft.PureComponent=x,Ft.StrictMode=r,Ft.Suspense=p,Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ee,Ft.act=fe,Ft.cloneElement=function(ce,Ce,je){if(ce==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ce+".");var $e=C({},ce.props),et=ce.key,it=ce.ref,ze=ce._owner;if(Ce!=null){if(Ce.ref!==void 0&&(it=Ce.ref,ze=$.current),Ce.key!==void 0&&(et=""+Ce.key),ce.type&&ce.type.defaultProps)var Ge=ce.type.defaultProps;for(Le in Ce)Z.call(Ce,Le)&&!z.hasOwnProperty(Le)&&($e[Le]=Ce[Le]===void 0&&Ge!==void 0?Ge[Le]:Ce[Le])}var Le=arguments.length-2;if(Le===1)$e.children=je;else if(1<Le){Ge=Array(Le);for(var Je=0;Je<Le;Je++)Ge[Je]=arguments[Je+2];$e.children=Ge}return{$$typeof:e,type:ce.type,key:et,ref:it,props:$e,_owner:ze}},Ft.createContext=function(ce){return ce={$$typeof:o,_currentValue:ce,_currentValue2:ce,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ce.Provider={$$typeof:a,_context:ce},ce.Consumer=ce},Ft.createElement=q,Ft.createFactory=function(ce){var Ce=q.bind(null,ce);return Ce.type=ce,Ce},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function(ce){return{$$typeof:u,render:ce}},Ft.isValidElement=K,Ft.lazy=function(ce){return{$$typeof:g,_payload:{_status:-1,_result:ce},_init:ve}},Ft.memo=function(ce,Ce){return{$$typeof:h,type:ce,compare:Ce===void 0?null:Ce}},Ft.startTransition=function(ce){var Ce=we.transition;we.transition={};try{ce()}finally{we.transition=Ce}},Ft.unstable_act=fe,Ft.useCallback=function(ce,Ce){return _e.current.useCallback(ce,Ce)},Ft.useContext=function(ce){return _e.current.useContext(ce)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function(ce){return _e.current.useDeferredValue(ce)},Ft.useEffect=function(ce,Ce){return _e.current.useEffect(ce,Ce)},Ft.useId=function(){return _e.current.useId()},Ft.useImperativeHandle=function(ce,Ce,je){return _e.current.useImperativeHandle(ce,Ce,je)},Ft.useInsertionEffect=function(ce,Ce){return _e.current.useInsertionEffect(ce,Ce)},Ft.useLayoutEffect=function(ce,Ce){return _e.current.useLayoutEffect(ce,Ce)},Ft.useMemo=function(ce,Ce){return _e.current.useMemo(ce,Ce)},Ft.useReducer=function(ce,Ce,je){return _e.current.useReducer(ce,Ce,je)},Ft.useRef=function(ce){return _e.current.useRef(ce)},Ft.useState=function(ce){return _e.current.useState(ce)},Ft.useSyncExternalStore=function(ce,Ce,je){return _e.current.useSyncExternalStore(ce,Ce,je)},Ft.useTransition=function(){return _e.current.useTransition()},Ft.version="18.3.1",Ft}var Tg;function Id(){return Tg||(Tg=1,Kh.exports=L2()),Kh.exports}var L1={exports:{}},j1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(we,Ee){var fe=we.length;we.push(Ee);e:for(;0<fe;){var ce=fe-1>>>1,Ce=we[ce];if(0<i(Ce,Ee))we[ce]=Ee,we[fe]=Ce,fe=ce;else break e}}function n(we){return we.length===0?null:we[0]}function r(we){if(we.length===0)return null;var Ee=we[0],fe=we.pop();if(fe!==Ee){we[0]=fe;e:for(var ce=0,Ce=we.length,je=Ce>>>1;ce<je;){var $e=2*(ce+1)-1,et=we[$e],it=$e+1,ze=we[it];if(0>i(et,fe))it<Ce&&0>i(ze,et)?(we[ce]=ze,we[it]=fe,ce=it):(we[ce]=et,we[$e]=fe,ce=$e);else if(it<Ce&&0>i(ze,fe))we[ce]=ze,we[it]=fe,ce=it;else break e}}return Ee}function i(we,Ee){var fe=we.sortIndex-Ee.sortIndex;return fe!==0?fe:we.id-Ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var p=[],h=[],g=1,f=null,_=3,w=!1,C=!1,R=!1,S=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(we){for(var Ee=n(h);Ee!==null;){if(Ee.callback===null)r(h);else if(Ee.startTime<=we)r(h),Ee.sortIndex=Ee.expirationTime,t(p,Ee);else break;Ee=n(h)}}function M(we){if(R=!1,E(we),!C)if(n(p)!==null)C=!0,ve(Z);else{var Ee=n(h);Ee!==null&&_e(M,Ee.startTime-we)}}function Z(we,Ee){C=!1,R&&(R=!1,b(q),q=-1),w=!0;var fe=_;try{for(E(Ee),f=n(p);f!==null&&(!(f.expirationTime>Ee)||we&&!ee());){var ce=f.callback;if(typeof ce=="function"){f.callback=null,_=f.priorityLevel;var Ce=ce(f.expirationTime<=Ee);Ee=e.unstable_now(),typeof Ce=="function"?f.callback=Ce:f===n(p)&&r(p),E(Ee)}else r(p);f=n(p)}if(f!==null)var je=!0;else{var $e=n(h);$e!==null&&_e(M,$e.startTime-Ee),je=!1}return je}finally{f=null,_=fe,w=!1}}var $=!1,z=null,q=-1,Q=5,K=-1;function ee(){return!(e.unstable_now()-K<Q)}function ae(){if(z!==null){var we=e.unstable_now();K=we;var Ee=!0;try{Ee=z(!0,we)}finally{Ee?le():($=!1,z=null)}}else $=!1}var le;if(typeof x=="function")le=function(){x(ae)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,Re=ne.port2;ne.port1.onmessage=ae,le=function(){Re.postMessage(null)}}else le=function(){S(ae,0)};function ve(we){z=we,$||($=!0,le())}function _e(we,Ee){q=S(function(){we(e.unstable_now())},Ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(we){we.callback=null},e.unstable_continueExecution=function(){C||w||(C=!0,ve(Z))},e.unstable_forceFrameRate=function(we){0>we||125<we?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<we?Math.floor(1e3/we):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return n(p)},e.unstable_next=function(we){switch(_){case 1:case 2:case 3:var Ee=3;break;default:Ee=_}var fe=_;_=Ee;try{return we()}finally{_=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(we,Ee){switch(we){case 1:case 2:case 3:case 4:case 5:break;default:we=3}var fe=_;_=we;try{return Ee()}finally{_=fe}},e.unstable_scheduleCallback=function(we,Ee,fe){var ce=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ce+fe:ce):fe=ce,we){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=fe+Ce,we={id:g++,callback:Ee,priorityLevel:we,startTime:fe,expirationTime:Ce,sortIndex:-1},fe>ce?(we.sortIndex=fe,t(h,we),n(p)===null&&we===n(h)&&(R?(b(q),q=-1):R=!0,_e(M,fe-ce))):(we.sortIndex=Ce,t(p,we),C||w||(C=!0,ve(Z))),we},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(we){var Ee=_;return function(){var fe=_;_=Ee;try{return we.apply(this,arguments)}finally{_=fe}}}})(j1);L1.exports=j1;var j2=L1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B2=Id(),Qr=j2;function He(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var B1=new Set,Bc={};function za(e,t){Eo(e,t),Eo(e+"Capture",t)}function Eo(e,t){for(Bc[e]=t,e=0;e<t.length;e++)B1.add(t[e])}var vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mp=Object.prototype.hasOwnProperty,U2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rg={},Ag={};function H2(e){return Mp.call(Ag,e)?!0:Mp.call(Rg,e)?!1:U2.test(e)?Ag[e]=!0:(Rg[e]=!0,!1)}function V2(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function q2(e,t,n,r){if(t===null||typeof t>"u"||V2(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ar(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var tr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){tr[e]=new Ar(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];tr[t]=new Ar(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){tr[e]=new Ar(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){tr[e]=new Ar(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){tr[e]=new Ar(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){tr[e]=new Ar(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){tr[e]=new Ar(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){tr[e]=new Ar(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){tr[e]=new Ar(e,5,!1,e.toLowerCase(),null,!1,!1)});var Yf=/[\-:]([a-z])/g;function em(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Yf,em);tr[t]=new Ar(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Yf,em);tr[t]=new Ar(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Yf,em);tr[t]=new Ar(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){tr[e]=new Ar(e,1,!1,e.toLowerCase(),null,!1,!1)});tr.xlinkHref=new Ar("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){tr[e]=new Ar(e,1,!1,e.toLowerCase(),null,!0,!0)});function tm(e,t,n,r){var i=tr.hasOwnProperty(t)?tr[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(q2(t,n,i,r)&&(n=null),r||i===null?H2(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var xs=B2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zl=Symbol.for("react.element"),to=Symbol.for("react.portal"),no=Symbol.for("react.fragment"),nm=Symbol.for("react.strict_mode"),Lp=Symbol.for("react.profiler"),U1=Symbol.for("react.provider"),H1=Symbol.for("react.context"),rm=Symbol.for("react.forward_ref"),jp=Symbol.for("react.suspense"),Bp=Symbol.for("react.suspense_list"),im=Symbol.for("react.memo"),Us=Symbol.for("react.lazy"),V1=Symbol.for("react.offscreen"),Ig=Symbol.iterator;function oc(e){return e===null||typeof e!="object"?null:(e=Ig&&e[Ig]||e["@@iterator"],typeof e=="function"?e:null)}var Cn=Object.assign,$h;function Cc(e){if($h===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);$h=t&&t[1]||""}return`
`+$h+e}var Wh=!1;function Gh(e,t){if(!e||Wh)return"";Wh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,u=a.length-1;1<=o&&0<=u&&i[o]!==a[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==a[u]){if(o!==1||u!==1)do if(o--,u--,0>u||i[o]!==a[u]){var p=`
`+i[o].replace(" at new "," at ");return e.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",e.displayName)),p}while(1<=o&&0<=u);break}}}finally{Wh=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Cc(e):""}function z2(e){switch(e.tag){case 5:return Cc(e.type);case 16:return Cc("Lazy");case 13:return Cc("Suspense");case 19:return Cc("SuspenseList");case 0:case 2:case 15:return e=Gh(e.type,!1),e;case 11:return e=Gh(e.type.render,!1),e;case 1:return e=Gh(e.type,!0),e;default:return""}}function Up(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case no:return"Fragment";case to:return"Portal";case Lp:return"Profiler";case nm:return"StrictMode";case jp:return"Suspense";case Bp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case H1:return(e.displayName||"Context")+".Consumer";case U1:return(e._context.displayName||"Context")+".Provider";case rm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case im:return t=e.displayName||null,t!==null?t:Up(e.type)||"Memo";case Us:t=e._payload,e=e._init;try{return Up(e(t))}catch{}}return null}function K2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Up(t);case 8:return t===nm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ta(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function q1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $2(e){var t=q1(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Xl(e){e._valueTracker||(e._valueTracker=$2(e))}function z1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q1(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function $u(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Hp(e,t){var n=t.checked;return Cn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Fg(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ta(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function K1(e,t){t=t.checked,t!=null&&tm(e,"checked",t,!1)}function Vp(e,t){K1(e,t);var n=ta(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?qp(e,t.type,n):t.hasOwnProperty("defaultValue")&&qp(e,t.type,ta(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Dg(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function qp(e,t,n){(t!=="number"||$u(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ec=Array.isArray;function vo(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ta(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function zp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(He(91));return Cn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ng(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(He(92));if(Ec(n)){if(1<n.length)throw Error(He(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ta(n)}}function $1(e,t){var n=ta(t.value),r=ta(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Og(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function W1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?W1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ql,G1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ql=Ql||document.createElement("div"),Ql.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ql.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Uc(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Rc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},W2=["Webkit","ms","Moz","O"];Object.keys(Rc).forEach(function(e){W2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rc[t]=Rc[e]})});function J1(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Rc.hasOwnProperty(e)&&Rc[e]?(""+t).trim():t+"px"}function Z1(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=J1(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var G2=Cn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $p(e,t){if(t){if(G2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(He(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(He(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(He(61))}if(t.style!=null&&typeof t.style!="object")throw Error(He(62))}}function Wp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gp=null;function sm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Jp=null,yo=null,_o=null;function Mg(e){if(e=Sl(e)){if(typeof Jp!="function")throw Error(He(280));var t=e.stateNode;t&&(t=Md(t),Jp(e.stateNode,e.type,t))}}function X1(e){yo?_o?_o.push(e):_o=[e]:yo=e}function Q1(){if(yo){var e=yo,t=_o;if(_o=yo=null,Mg(e),t)for(e=0;e<t.length;e++)Mg(t[e])}}function Y1(e,t){return e(t)}function e0(){}var Jh=!1;function t0(e,t,n){if(Jh)return e(t,n);Jh=!0;try{return Y1(e,t,n)}finally{Jh=!1,(yo!==null||_o!==null)&&(e0(),Q1())}}function Hc(e,t){var n=e.stateNode;if(n===null)return null;var r=Md(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(He(231,t,typeof n));return n}var Zp=!1;if(vs)try{var cc={};Object.defineProperty(cc,"passive",{get:function(){Zp=!0}}),window.addEventListener("test",cc,cc),window.removeEventListener("test",cc,cc)}catch{Zp=!1}function J2(e,t,n,r,i,a,o,u,p){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(g){this.onError(g)}}var Ac=!1,Wu=null,Gu=!1,Xp=null,Z2={onError:function(e){Ac=!0,Wu=e}};function X2(e,t,n,r,i,a,o,u,p){Ac=!1,Wu=null,J2.apply(Z2,arguments)}function Q2(e,t,n,r,i,a,o,u,p){if(X2.apply(this,arguments),Ac){if(Ac){var h=Wu;Ac=!1,Wu=null}else throw Error(He(198));Gu||(Gu=!0,Xp=h)}}function Ka(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function n0(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Lg(e){if(Ka(e)!==e)throw Error(He(188))}function Y2(e){var t=e.alternate;if(!t){if(t=Ka(e),t===null)throw Error(He(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Lg(i),e;if(a===r)return Lg(i),t;a=a.sibling}throw Error(He(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=a;break}if(u===r){o=!0,r=i,n=a;break}u=u.sibling}if(!o){for(u=a.child;u;){if(u===n){o=!0,n=a,r=i;break}if(u===r){o=!0,r=a,n=i;break}u=u.sibling}if(!o)throw Error(He(189))}}if(n.alternate!==r)throw Error(He(190))}if(n.tag!==3)throw Error(He(188));return n.stateNode.current===n?e:t}function r0(e){return e=Y2(e),e!==null?i0(e):null}function i0(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=i0(e);if(t!==null)return t;e=e.sibling}return null}var s0=Qr.unstable_scheduleCallback,jg=Qr.unstable_cancelCallback,eS=Qr.unstable_shouldYield,tS=Qr.unstable_requestPaint,An=Qr.unstable_now,nS=Qr.unstable_getCurrentPriorityLevel,am=Qr.unstable_ImmediatePriority,a0=Qr.unstable_UserBlockingPriority,Ju=Qr.unstable_NormalPriority,rS=Qr.unstable_LowPriority,o0=Qr.unstable_IdlePriority,Fd=null,Zi=null;function iS(e){if(Zi&&typeof Zi.onCommitFiberRoot=="function")try{Zi.onCommitFiberRoot(Fd,e,void 0,(e.current.flags&128)===128)}catch{}}var Ri=Math.clz32?Math.clz32:oS,sS=Math.log,aS=Math.LN2;function oS(e){return e>>>=0,e===0?32:31-(sS(e)/aS|0)|0}var Yl=64,eu=4194304;function Pc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zu(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var u=o&~i;u!==0?r=Pc(u):(a&=o,a!==0&&(r=Pc(a)))}else o=n&~i,o!==0?r=Pc(o):a!==0&&(r=Pc(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ri(t),i=1<<n,r|=e[n],t&=~i;return r}function cS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lS(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Ri(a),u=1<<o,p=i[o];p===-1?(!(u&n)||u&r)&&(i[o]=cS(u,t)):p<=t&&(e.expiredLanes|=u),a&=~u}}function Qp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function c0(){var e=Yl;return Yl<<=1,!(Yl&4194240)&&(Yl=64),e}function Zh(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _l(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ri(t),e[t]=n}function uS(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Ri(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function om(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ri(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Yt=0;function l0(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var u0,cm,d0,h0,p0,Yp=!1,tu=[],Ws=null,Gs=null,Js=null,Vc=new Map,qc=new Map,Vs=[],dS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bg(e,t){switch(e){case"focusin":case"focusout":Ws=null;break;case"dragenter":case"dragleave":Gs=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":Vc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qc.delete(t.pointerId)}}function lc(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Sl(t),t!==null&&cm(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function hS(e,t,n,r,i){switch(t){case"focusin":return Ws=lc(Ws,e,t,n,r,i),!0;case"dragenter":return Gs=lc(Gs,e,t,n,r,i),!0;case"mouseover":return Js=lc(Js,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Vc.set(a,lc(Vc.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,qc.set(a,lc(qc.get(a)||null,e,t,n,r,i)),!0}return!1}function f0(e){var t=Ea(e.target);if(t!==null){var n=Ka(t);if(n!==null){if(t=n.tag,t===13){if(t=n0(n),t!==null){e.blockedOn=t,p0(e.priority,function(){d0(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Su(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ef(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Gp=r,n.target.dispatchEvent(r),Gp=null}else return t=Sl(n),t!==null&&cm(t),e.blockedOn=n,!1;t.shift()}return!0}function Ug(e,t,n){Su(e)&&n.delete(t)}function pS(){Yp=!1,Ws!==null&&Su(Ws)&&(Ws=null),Gs!==null&&Su(Gs)&&(Gs=null),Js!==null&&Su(Js)&&(Js=null),Vc.forEach(Ug),qc.forEach(Ug)}function uc(e,t){e.blockedOn===t&&(e.blockedOn=null,Yp||(Yp=!0,Qr.unstable_scheduleCallback(Qr.unstable_NormalPriority,pS)))}function zc(e){function t(i){return uc(i,e)}if(0<tu.length){uc(tu[0],e);for(var n=1;n<tu.length;n++){var r=tu[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ws!==null&&uc(Ws,e),Gs!==null&&uc(Gs,e),Js!==null&&uc(Js,e),Vc.forEach(t),qc.forEach(t),n=0;n<Vs.length;n++)r=Vs[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Vs.length&&(n=Vs[0],n.blockedOn===null);)f0(n),n.blockedOn===null&&Vs.shift()}var bo=xs.ReactCurrentBatchConfig,Xu=!0;function fS(e,t,n,r){var i=Yt,a=bo.transition;bo.transition=null;try{Yt=1,lm(e,t,n,r)}finally{Yt=i,bo.transition=a}}function mS(e,t,n,r){var i=Yt,a=bo.transition;bo.transition=null;try{Yt=4,lm(e,t,n,r)}finally{Yt=i,bo.transition=a}}function lm(e,t,n,r){if(Xu){var i=ef(e,t,n,r);if(i===null)ap(e,t,r,Qu,n),Bg(e,r);else if(hS(i,e,t,n,r))r.stopPropagation();else if(Bg(e,r),t&4&&-1<dS.indexOf(e)){for(;i!==null;){var a=Sl(i);if(a!==null&&u0(a),a=ef(e,t,n,r),a===null&&ap(e,t,r,Qu,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else ap(e,t,r,null,n)}}var Qu=null;function ef(e,t,n,r){if(Qu=null,e=sm(r),e=Ea(e),e!==null)if(t=Ka(e),t===null)e=null;else if(n=t.tag,n===13){if(e=n0(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qu=e,null}function m0(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nS()){case am:return 1;case a0:return 4;case Ju:case rS:return 16;case o0:return 536870912;default:return 16}default:return 16}}var Ks=null,um=null,wu=null;function g0(){if(wu)return wu;var e,t=um,n=t.length,r,i="value"in Ks?Ks.value:Ks.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return wu=i.slice(e,1<r?1-r:void 0)}function xu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function nu(){return!0}function Hg(){return!1}function ei(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(a):a[u]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?nu:Hg,this.isPropagationStopped=Hg,this}return Cn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=nu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=nu)},persist:function(){},isPersistent:nu}),t}var Bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dm=ei(Bo),bl=Cn({},Bo,{view:0,detail:0}),gS=ei(bl),Xh,Qh,dc,Dd=Cn({},bl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dc&&(dc&&e.type==="mousemove"?(Xh=e.screenX-dc.screenX,Qh=e.screenY-dc.screenY):Qh=Xh=0,dc=e),Xh)},movementY:function(e){return"movementY"in e?e.movementY:Qh}}),Vg=ei(Dd),vS=Cn({},Dd,{dataTransfer:0}),yS=ei(vS),_S=Cn({},bl,{relatedTarget:0}),Yh=ei(_S),bS=Cn({},Bo,{animationName:0,elapsedTime:0,pseudoElement:0}),SS=ei(bS),wS=Cn({},Bo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xS=ei(wS),CS=Cn({},Bo,{data:0}),qg=ei(CS),ES={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},PS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=kS[e])?!!t[e]:!1}function hm(){return TS}var RS=Cn({},bl,{key:function(e){if(e.key){var t=ES[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?PS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hm,charCode:function(e){return e.type==="keypress"?xu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),AS=ei(RS),IS=Cn({},Dd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zg=ei(IS),FS=Cn({},bl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hm}),DS=ei(FS),NS=Cn({},Bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),OS=ei(NS),MS=Cn({},Dd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),LS=ei(MS),jS=[9,13,27,32],pm=vs&&"CompositionEvent"in window,Ic=null;vs&&"documentMode"in document&&(Ic=document.documentMode);var BS=vs&&"TextEvent"in window&&!Ic,v0=vs&&(!pm||Ic&&8<Ic&&11>=Ic),Kg=" ",$g=!1;function y0(e,t){switch(e){case"keyup":return jS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _0(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ro=!1;function US(e,t){switch(e){case"compositionend":return _0(t);case"keypress":return t.which!==32?null:($g=!0,Kg);case"textInput":return e=t.data,e===Kg&&$g?null:e;default:return null}}function HS(e,t){if(ro)return e==="compositionend"||!pm&&y0(e,t)?(e=g0(),wu=um=Ks=null,ro=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return v0&&t.locale!=="ko"?null:t.data;default:return null}}var VS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!VS[e.type]:t==="textarea"}function b0(e,t,n,r){X1(r),t=Yu(t,"onChange"),0<t.length&&(n=new dm("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Fc=null,Kc=null;function qS(e){I0(e,0)}function Nd(e){var t=ao(e);if(z1(t))return e}function zS(e,t){if(e==="change")return t}var S0=!1;if(vs){var ep;if(vs){var tp="oninput"in document;if(!tp){var Gg=document.createElement("div");Gg.setAttribute("oninput","return;"),tp=typeof Gg.oninput=="function"}ep=tp}else ep=!1;S0=ep&&(!document.documentMode||9<document.documentMode)}function Jg(){Fc&&(Fc.detachEvent("onpropertychange",w0),Kc=Fc=null)}function w0(e){if(e.propertyName==="value"&&Nd(Kc)){var t=[];b0(t,Kc,e,sm(e)),t0(qS,t)}}function KS(e,t,n){e==="focusin"?(Jg(),Fc=t,Kc=n,Fc.attachEvent("onpropertychange",w0)):e==="focusout"&&Jg()}function $S(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Nd(Kc)}function WS(e,t){if(e==="click")return Nd(t)}function GS(e,t){if(e==="input"||e==="change")return Nd(t)}function JS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Di=typeof Object.is=="function"?Object.is:JS;function $c(e,t){if(Di(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Mp.call(t,i)||!Di(e[i],t[i]))return!1}return!0}function Zg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xg(e,t){var n=Zg(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zg(n)}}function x0(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?x0(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function C0(){for(var e=window,t=$u();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=$u(e.document)}return t}function fm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ZS(e){var t=C0(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&x0(n.ownerDocument.documentElement,n)){if(r!==null&&fm(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Xg(n,a);var o=Xg(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var XS=vs&&"documentMode"in document&&11>=document.documentMode,io=null,tf=null,Dc=null,nf=!1;function Qg(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nf||io==null||io!==$u(r)||(r=io,"selectionStart"in r&&fm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Dc&&$c(Dc,r)||(Dc=r,r=Yu(tf,"onSelect"),0<r.length&&(t=new dm("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=io)))}function ru(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var so={animationend:ru("Animation","AnimationEnd"),animationiteration:ru("Animation","AnimationIteration"),animationstart:ru("Animation","AnimationStart"),transitionend:ru("Transition","TransitionEnd")},np={},E0={};vs&&(E0=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function Od(e){if(np[e])return np[e];if(!so[e])return e;var t=so[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in E0)return np[e]=t[n];return e}var P0=Od("animationend"),k0=Od("animationiteration"),T0=Od("animationstart"),R0=Od("transitionend"),A0=new Map,Yg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function aa(e,t){A0.set(e,t),za(t,[e])}for(var rp=0;rp<Yg.length;rp++){var ip=Yg[rp],QS=ip.toLowerCase(),YS=ip[0].toUpperCase()+ip.slice(1);aa(QS,"on"+YS)}aa(P0,"onAnimationEnd");aa(k0,"onAnimationIteration");aa(T0,"onAnimationStart");aa("dblclick","onDoubleClick");aa("focusin","onFocus");aa("focusout","onBlur");aa(R0,"onTransitionEnd");Eo("onMouseEnter",["mouseout","mouseover"]);Eo("onMouseLeave",["mouseout","mouseover"]);Eo("onPointerEnter",["pointerout","pointerover"]);Eo("onPointerLeave",["pointerout","pointerover"]);za("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));za("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));za("onBeforeInput",["compositionend","keypress","textInput","paste"]);za("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));za("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));za("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ew=new Set("cancel close invalid load scroll toggle".split(" ").concat(kc));function ev(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Q2(r,t,void 0,e),e.currentTarget=null}function I0(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],p=u.instance,h=u.currentTarget;if(u=u.listener,p!==a&&i.isPropagationStopped())break e;ev(i,u,h),a=p}else for(o=0;o<r.length;o++){if(u=r[o],p=u.instance,h=u.currentTarget,u=u.listener,p!==a&&i.isPropagationStopped())break e;ev(i,u,h),a=p}}}if(Gu)throw e=Xp,Gu=!1,Xp=null,e}function un(e,t){var n=t[cf];n===void 0&&(n=t[cf]=new Set);var r=e+"__bubble";n.has(r)||(F0(t,e,2,!1),n.add(r))}function sp(e,t,n){var r=0;t&&(r|=4),F0(n,e,r,t)}var iu="_reactListening"+Math.random().toString(36).slice(2);function Wc(e){if(!e[iu]){e[iu]=!0,B1.forEach(function(n){n!=="selectionchange"&&(ew.has(n)||sp(n,!1,e),sp(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[iu]||(t[iu]=!0,sp("selectionchange",!1,t))}}function F0(e,t,n,r){switch(m0(t)){case 1:var i=fS;break;case 4:i=mS;break;default:i=lm}n=i.bind(null,t,n,e),i=void 0,!Zp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function ap(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var p=o.tag;if((p===3||p===4)&&(p=o.stateNode.containerInfo,p===i||p.nodeType===8&&p.parentNode===i))return;o=o.return}for(;u!==null;){if(o=Ea(u),o===null)return;if(p=o.tag,p===5||p===6){r=a=o;continue e}u=u.parentNode}}r=r.return}t0(function(){var h=a,g=sm(n),f=[];e:{var _=A0.get(e);if(_!==void 0){var w=dm,C=e;switch(e){case"keypress":if(xu(n)===0)break e;case"keydown":case"keyup":w=AS;break;case"focusin":C="focus",w=Yh;break;case"focusout":C="blur",w=Yh;break;case"beforeblur":case"afterblur":w=Yh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Vg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=yS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=DS;break;case P0:case k0:case T0:w=SS;break;case R0:w=OS;break;case"scroll":w=gS;break;case"wheel":w=LS;break;case"copy":case"cut":case"paste":w=xS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=zg}var R=(t&4)!==0,S=!R&&e==="scroll",b=R?_!==null?_+"Capture":null:_;R=[];for(var x=h,E;x!==null;){E=x;var M=E.stateNode;if(E.tag===5&&M!==null&&(E=M,b!==null&&(M=Hc(x,b),M!=null&&R.push(Gc(x,M,E)))),S)break;x=x.return}0<R.length&&(_=new w(_,C,null,n,g),f.push({event:_,listeners:R}))}}if(!(t&7)){e:{if(_=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",_&&n!==Gp&&(C=n.relatedTarget||n.fromElement)&&(Ea(C)||C[ys]))break e;if((w||_)&&(_=g.window===g?g:(_=g.ownerDocument)?_.defaultView||_.parentWindow:window,w?(C=n.relatedTarget||n.toElement,w=h,C=C?Ea(C):null,C!==null&&(S=Ka(C),C!==S||C.tag!==5&&C.tag!==6)&&(C=null)):(w=null,C=h),w!==C)){if(R=Vg,M="onMouseLeave",b="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(R=zg,M="onPointerLeave",b="onPointerEnter",x="pointer"),S=w==null?_:ao(w),E=C==null?_:ao(C),_=new R(M,x+"leave",w,n,g),_.target=S,_.relatedTarget=E,M=null,Ea(g)===h&&(R=new R(b,x+"enter",C,n,g),R.target=E,R.relatedTarget=S,M=R),S=M,w&&C)t:{for(R=w,b=C,x=0,E=R;E;E=Qa(E))x++;for(E=0,M=b;M;M=Qa(M))E++;for(;0<x-E;)R=Qa(R),x--;for(;0<E-x;)b=Qa(b),E--;for(;x--;){if(R===b||b!==null&&R===b.alternate)break t;R=Qa(R),b=Qa(b)}R=null}else R=null;w!==null&&tv(f,_,w,R,!1),C!==null&&S!==null&&tv(f,S,C,R,!0)}}e:{if(_=h?ao(h):window,w=_.nodeName&&_.nodeName.toLowerCase(),w==="select"||w==="input"&&_.type==="file")var Z=zS;else if(Wg(_))if(S0)Z=GS;else{Z=$S;var $=KS}else(w=_.nodeName)&&w.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(Z=WS);if(Z&&(Z=Z(e,h))){b0(f,Z,n,g);break e}$&&$(e,_,h),e==="focusout"&&($=_._wrapperState)&&$.controlled&&_.type==="number"&&qp(_,"number",_.value)}switch($=h?ao(h):window,e){case"focusin":(Wg($)||$.contentEditable==="true")&&(io=$,tf=h,Dc=null);break;case"focusout":Dc=tf=io=null;break;case"mousedown":nf=!0;break;case"contextmenu":case"mouseup":case"dragend":nf=!1,Qg(f,n,g);break;case"selectionchange":if(XS)break;case"keydown":case"keyup":Qg(f,n,g)}var z;if(pm)e:{switch(e){case"compositionstart":var q="onCompositionStart";break e;case"compositionend":q="onCompositionEnd";break e;case"compositionupdate":q="onCompositionUpdate";break e}q=void 0}else ro?y0(e,n)&&(q="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(q="onCompositionStart");q&&(v0&&n.locale!=="ko"&&(ro||q!=="onCompositionStart"?q==="onCompositionEnd"&&ro&&(z=g0()):(Ks=g,um="value"in Ks?Ks.value:Ks.textContent,ro=!0)),$=Yu(h,q),0<$.length&&(q=new qg(q,e,null,n,g),f.push({event:q,listeners:$}),z?q.data=z:(z=_0(n),z!==null&&(q.data=z)))),(z=BS?US(e,n):HS(e,n))&&(h=Yu(h,"onBeforeInput"),0<h.length&&(g=new qg("onBeforeInput","beforeinput",null,n,g),f.push({event:g,listeners:h}),g.data=z))}I0(f,t)})}function Gc(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Yu(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Hc(e,n),a!=null&&r.unshift(Gc(e,a,i)),a=Hc(e,t),a!=null&&r.push(Gc(e,a,i))),e=e.return}return r}function Qa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function tv(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var u=n,p=u.alternate,h=u.stateNode;if(p!==null&&p===r)break;u.tag===5&&h!==null&&(u=h,i?(p=Hc(n,a),p!=null&&o.unshift(Gc(n,p,u))):i||(p=Hc(n,a),p!=null&&o.push(Gc(n,p,u)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var tw=/\r\n?/g,nw=/\u0000|\uFFFD/g;function nv(e){return(typeof e=="string"?e:""+e).replace(tw,`
`).replace(nw,"")}function su(e,t,n){if(t=nv(t),nv(e)!==t&&n)throw Error(He(425))}function ed(){}var rf=null,sf=null;function af(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var of=typeof setTimeout=="function"?setTimeout:void 0,rw=typeof clearTimeout=="function"?clearTimeout:void 0,rv=typeof Promise=="function"?Promise:void 0,iw=typeof queueMicrotask=="function"?queueMicrotask:typeof rv<"u"?function(e){return rv.resolve(null).then(e).catch(sw)}:of;function sw(e){setTimeout(function(){throw e})}function op(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),zc(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);zc(t)}function Zs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function iv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Uo=Math.random().toString(36).slice(2),Ji="__reactFiber$"+Uo,Jc="__reactProps$"+Uo,ys="__reactContainer$"+Uo,cf="__reactEvents$"+Uo,aw="__reactListeners$"+Uo,ow="__reactHandles$"+Uo;function Ea(e){var t=e[Ji];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ys]||n[Ji]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=iv(e);e!==null;){if(n=e[Ji])return n;e=iv(e)}return t}e=n,n=e.parentNode}return null}function Sl(e){return e=e[Ji]||e[ys],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ao(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(He(33))}function Md(e){return e[Jc]||null}var lf=[],oo=-1;function oa(e){return{current:e}}function dn(e){0>oo||(e.current=lf[oo],lf[oo]=null,oo--)}function sn(e,t){oo++,lf[oo]=e.current,e.current=t}var na={},mr=oa(na),Hr=oa(!1),Ma=na;function Po(e,t){var n=e.type.contextTypes;if(!n)return na;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Vr(e){return e=e.childContextTypes,e!=null}function td(){dn(Hr),dn(mr)}function sv(e,t,n){if(mr.current!==na)throw Error(He(168));sn(mr,t),sn(Hr,n)}function D0(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(He(108,K2(e)||"Unknown",i));return Cn({},n,r)}function nd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||na,Ma=mr.current,sn(mr,e),sn(Hr,Hr.current),!0}function av(e,t,n){var r=e.stateNode;if(!r)throw Error(He(169));n?(e=D0(e,t,Ma),r.__reactInternalMemoizedMergedChildContext=e,dn(Hr),dn(mr),sn(mr,e)):dn(Hr),sn(Hr,n)}var hs=null,Ld=!1,cp=!1;function N0(e){hs===null?hs=[e]:hs.push(e)}function cw(e){Ld=!0,N0(e)}function ca(){if(!cp&&hs!==null){cp=!0;var e=0,t=Yt;try{var n=hs;for(Yt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}hs=null,Ld=!1}catch(i){throw hs!==null&&(hs=hs.slice(e+1)),s0(am,ca),i}finally{Yt=t,cp=!1}}return null}var co=[],lo=0,rd=null,id=0,li=[],ui=0,La=null,fs=1,ms="";function Sa(e,t){co[lo++]=id,co[lo++]=rd,rd=e,id=t}function O0(e,t,n){li[ui++]=fs,li[ui++]=ms,li[ui++]=La,La=e;var r=fs;e=ms;var i=32-Ri(r)-1;r&=~(1<<i),n+=1;var a=32-Ri(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,fs=1<<32-Ri(t)+i|n<<i|r,ms=a+e}else fs=1<<a|n<<i|r,ms=e}function mm(e){e.return!==null&&(Sa(e,1),O0(e,1,0))}function gm(e){for(;e===rd;)rd=co[--lo],co[lo]=null,id=co[--lo],co[lo]=null;for(;e===La;)La=li[--ui],li[ui]=null,ms=li[--ui],li[ui]=null,fs=li[--ui],li[ui]=null}var Xr=null,Zr=null,pn=!1,Pi=null;function M0(e,t){var n=di(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ov(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xr=e,Zr=Zs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xr=e,Zr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=La!==null?{id:fs,overflow:ms}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=di(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Xr=e,Zr=null,!0):!1;default:return!1}}function uf(e){return(e.mode&1)!==0&&(e.flags&128)===0}function df(e){if(pn){var t=Zr;if(t){var n=t;if(!ov(e,t)){if(uf(e))throw Error(He(418));t=Zs(n.nextSibling);var r=Xr;t&&ov(e,t)?M0(r,n):(e.flags=e.flags&-4097|2,pn=!1,Xr=e)}}else{if(uf(e))throw Error(He(418));e.flags=e.flags&-4097|2,pn=!1,Xr=e}}}function cv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xr=e}function au(e){if(e!==Xr)return!1;if(!pn)return cv(e),pn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!af(e.type,e.memoizedProps)),t&&(t=Zr)){if(uf(e))throw L0(),Error(He(418));for(;t;)M0(e,t),t=Zs(t.nextSibling)}if(cv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(He(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Zr=Zs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Zr=null}}else Zr=Xr?Zs(e.stateNode.nextSibling):null;return!0}function L0(){for(var e=Zr;e;)e=Zs(e.nextSibling)}function ko(){Zr=Xr=null,pn=!1}function vm(e){Pi===null?Pi=[e]:Pi.push(e)}var lw=xs.ReactCurrentBatchConfig;function hc(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(He(309));var r=n.stateNode}if(!r)throw Error(He(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var u=i.refs;o===null?delete u[a]:u[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(He(284));if(!n._owner)throw Error(He(290,e))}return e}function ou(e,t){throw e=Object.prototype.toString.call(t),Error(He(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function lv(e){var t=e._init;return t(e._payload)}function j0(e){function t(b,x){if(e){var E=b.deletions;E===null?(b.deletions=[x],b.flags|=16):E.push(x)}}function n(b,x){if(!e)return null;for(;x!==null;)t(b,x),x=x.sibling;return null}function r(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function i(b,x){return b=ea(b,x),b.index=0,b.sibling=null,b}function a(b,x,E){return b.index=E,e?(E=b.alternate,E!==null?(E=E.index,E<x?(b.flags|=2,x):E):(b.flags|=2,x)):(b.flags|=1048576,x)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function u(b,x,E,M){return x===null||x.tag!==6?(x=mp(E,b.mode,M),x.return=b,x):(x=i(x,E),x.return=b,x)}function p(b,x,E,M){var Z=E.type;return Z===no?g(b,x,E.props.children,M,E.key):x!==null&&(x.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Us&&lv(Z)===x.type)?(M=i(x,E.props),M.ref=hc(b,x,E),M.return=b,M):(M=Au(E.type,E.key,E.props,null,b.mode,M),M.ref=hc(b,x,E),M.return=b,M)}function h(b,x,E,M){return x===null||x.tag!==4||x.stateNode.containerInfo!==E.containerInfo||x.stateNode.implementation!==E.implementation?(x=gp(E,b.mode,M),x.return=b,x):(x=i(x,E.children||[]),x.return=b,x)}function g(b,x,E,M,Z){return x===null||x.tag!==7?(x=Da(E,b.mode,M,Z),x.return=b,x):(x=i(x,E),x.return=b,x)}function f(b,x,E){if(typeof x=="string"&&x!==""||typeof x=="number")return x=mp(""+x,b.mode,E),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Zl:return E=Au(x.type,x.key,x.props,null,b.mode,E),E.ref=hc(b,null,x),E.return=b,E;case to:return x=gp(x,b.mode,E),x.return=b,x;case Us:var M=x._init;return f(b,M(x._payload),E)}if(Ec(x)||oc(x))return x=Da(x,b.mode,E,null),x.return=b,x;ou(b,x)}return null}function _(b,x,E,M){var Z=x!==null?x.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return Z!==null?null:u(b,x,""+E,M);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Zl:return E.key===Z?p(b,x,E,M):null;case to:return E.key===Z?h(b,x,E,M):null;case Us:return Z=E._init,_(b,x,Z(E._payload),M)}if(Ec(E)||oc(E))return Z!==null?null:g(b,x,E,M,null);ou(b,E)}return null}function w(b,x,E,M,Z){if(typeof M=="string"&&M!==""||typeof M=="number")return b=b.get(E)||null,u(x,b,""+M,Z);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Zl:return b=b.get(M.key===null?E:M.key)||null,p(x,b,M,Z);case to:return b=b.get(M.key===null?E:M.key)||null,h(x,b,M,Z);case Us:var $=M._init;return w(b,x,E,$(M._payload),Z)}if(Ec(M)||oc(M))return b=b.get(E)||null,g(x,b,M,Z,null);ou(x,M)}return null}function C(b,x,E,M){for(var Z=null,$=null,z=x,q=x=0,Q=null;z!==null&&q<E.length;q++){z.index>q?(Q=z,z=null):Q=z.sibling;var K=_(b,z,E[q],M);if(K===null){z===null&&(z=Q);break}e&&z&&K.alternate===null&&t(b,z),x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K,z=Q}if(q===E.length)return n(b,z),pn&&Sa(b,q),Z;if(z===null){for(;q<E.length;q++)z=f(b,E[q],M),z!==null&&(x=a(z,x,q),$===null?Z=z:$.sibling=z,$=z);return pn&&Sa(b,q),Z}for(z=r(b,z);q<E.length;q++)Q=w(z,b,q,E[q],M),Q!==null&&(e&&Q.alternate!==null&&z.delete(Q.key===null?q:Q.key),x=a(Q,x,q),$===null?Z=Q:$.sibling=Q,$=Q);return e&&z.forEach(function(ee){return t(b,ee)}),pn&&Sa(b,q),Z}function R(b,x,E,M){var Z=oc(E);if(typeof Z!="function")throw Error(He(150));if(E=Z.call(E),E==null)throw Error(He(151));for(var $=Z=null,z=x,q=x=0,Q=null,K=E.next();z!==null&&!K.done;q++,K=E.next()){z.index>q?(Q=z,z=null):Q=z.sibling;var ee=_(b,z,K.value,M);if(ee===null){z===null&&(z=Q);break}e&&z&&ee.alternate===null&&t(b,z),x=a(ee,x,q),$===null?Z=ee:$.sibling=ee,$=ee,z=Q}if(K.done)return n(b,z),pn&&Sa(b,q),Z;if(z===null){for(;!K.done;q++,K=E.next())K=f(b,K.value,M),K!==null&&(x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K);return pn&&Sa(b,q),Z}for(z=r(b,z);!K.done;q++,K=E.next())K=w(z,b,q,K.value,M),K!==null&&(e&&K.alternate!==null&&z.delete(K.key===null?q:K.key),x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K);return e&&z.forEach(function(ae){return t(b,ae)}),pn&&Sa(b,q),Z}function S(b,x,E,M){if(typeof E=="object"&&E!==null&&E.type===no&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Zl:e:{for(var Z=E.key,$=x;$!==null;){if($.key===Z){if(Z=E.type,Z===no){if($.tag===7){n(b,$.sibling),x=i($,E.props.children),x.return=b,b=x;break e}}else if($.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Us&&lv(Z)===$.type){n(b,$.sibling),x=i($,E.props),x.ref=hc(b,$,E),x.return=b,b=x;break e}n(b,$);break}else t(b,$);$=$.sibling}E.type===no?(x=Da(E.props.children,b.mode,M,E.key),x.return=b,b=x):(M=Au(E.type,E.key,E.props,null,b.mode,M),M.ref=hc(b,x,E),M.return=b,b=M)}return o(b);case to:e:{for($=E.key;x!==null;){if(x.key===$)if(x.tag===4&&x.stateNode.containerInfo===E.containerInfo&&x.stateNode.implementation===E.implementation){n(b,x.sibling),x=i(x,E.children||[]),x.return=b,b=x;break e}else{n(b,x);break}else t(b,x);x=x.sibling}x=gp(E,b.mode,M),x.return=b,b=x}return o(b);case Us:return $=E._init,S(b,x,$(E._payload),M)}if(Ec(E))return C(b,x,E,M);if(oc(E))return R(b,x,E,M);ou(b,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,x!==null&&x.tag===6?(n(b,x.sibling),x=i(x,E),x.return=b,b=x):(n(b,x),x=mp(E,b.mode,M),x.return=b,b=x),o(b)):n(b,x)}return S}var To=j0(!0),B0=j0(!1),sd=oa(null),ad=null,uo=null,ym=null;function _m(){ym=uo=ad=null}function bm(e){var t=sd.current;dn(sd),e._currentValue=t}function hf(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function So(e,t){ad=e,ym=uo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ur=!0),e.firstContext=null)}function pi(e){var t=e._currentValue;if(ym!==e)if(e={context:e,memoizedValue:t,next:null},uo===null){if(ad===null)throw Error(He(308));uo=e,ad.dependencies={lanes:0,firstContext:e}}else uo=uo.next=e;return t}var Pa=null;function Sm(e){Pa===null?Pa=[e]:Pa.push(e)}function U0(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Sm(t)):(n.next=i.next,i.next=n),t.interleaved=n,_s(e,r)}function _s(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Hs=!1;function wm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function H0(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Xs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,zt&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,_s(e,n)}return i=r.interleaved,i===null?(t.next=t,Sm(r)):(t.next=i.next,i.next=t),r.interleaved=t,_s(e,n)}function Cu(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,om(e,n)}}function uv(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function od(e,t,n,r){var i=e.updateQueue;Hs=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var p=u,h=p.next;p.next=null,o===null?a=h:o.next=h,o=p;var g=e.alternate;g!==null&&(g=g.updateQueue,u=g.lastBaseUpdate,u!==o&&(u===null?g.firstBaseUpdate=h:u.next=h,g.lastBaseUpdate=p))}if(a!==null){var f=i.baseState;o=0,g=h=p=null,u=a;do{var _=u.lane,w=u.eventTime;if((r&_)===_){g!==null&&(g=g.next={eventTime:w,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var C=e,R=u;switch(_=t,w=n,R.tag){case 1:if(C=R.payload,typeof C=="function"){f=C.call(w,f,_);break e}f=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=R.payload,_=typeof C=="function"?C.call(w,f,_):C,_==null)break e;f=Cn({},f,_);break e;case 2:Hs=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,_=i.effects,_===null?i.effects=[u]:_.push(u))}else w={eventTime:w,lane:_,tag:u.tag,payload:u.payload,callback:u.callback,next:null},g===null?(h=g=w,p=f):g=g.next=w,o|=_;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;_=u,u=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(g===null&&(p=f),i.baseState=p,i.firstBaseUpdate=h,i.lastBaseUpdate=g,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Ba|=o,e.lanes=o,e.memoizedState=f}}function dv(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(He(191,i));i.call(r)}}}var wl={},Xi=oa(wl),Zc=oa(wl),Xc=oa(wl);function ka(e){if(e===wl)throw Error(He(174));return e}function xm(e,t){switch(sn(Xc,t),sn(Zc,e),sn(Xi,wl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Kp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Kp(t,e)}dn(Xi),sn(Xi,t)}function Ro(){dn(Xi),dn(Zc),dn(Xc)}function V0(e){ka(Xc.current);var t=ka(Xi.current),n=Kp(t,e.type);t!==n&&(sn(Zc,e),sn(Xi,n))}function Cm(e){Zc.current===e&&(dn(Xi),dn(Zc))}var wn=oa(0);function cd(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var lp=[];function Em(){for(var e=0;e<lp.length;e++)lp[e]._workInProgressVersionPrimary=null;lp.length=0}var Eu=xs.ReactCurrentDispatcher,up=xs.ReactCurrentBatchConfig,ja=0,xn=null,Bn=null,zn=null,ld=!1,Nc=!1,Qc=0,uw=0;function lr(){throw Error(He(321))}function Pm(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Di(e[n],t[n]))return!1;return!0}function km(e,t,n,r,i,a){if(ja=a,xn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Eu.current=e===null||e.memoizedState===null?fw:mw,e=n(r,i),Nc){a=0;do{if(Nc=!1,Qc=0,25<=a)throw Error(He(301));a+=1,zn=Bn=null,t.updateQueue=null,Eu.current=gw,e=n(r,i)}while(Nc)}if(Eu.current=ud,t=Bn!==null&&Bn.next!==null,ja=0,zn=Bn=xn=null,ld=!1,t)throw Error(He(300));return e}function Tm(){var e=Qc!==0;return Qc=0,e}function Gi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zn===null?xn.memoizedState=zn=e:zn=zn.next=e,zn}function fi(){if(Bn===null){var e=xn.alternate;e=e!==null?e.memoizedState:null}else e=Bn.next;var t=zn===null?xn.memoizedState:zn.next;if(t!==null)zn=t,Bn=e;else{if(e===null)throw Error(He(310));Bn=e,e={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},zn===null?xn.memoizedState=zn=e:zn=zn.next=e}return zn}function Yc(e,t){return typeof t=="function"?t(e):t}function dp(e){var t=fi(),n=t.queue;if(n===null)throw Error(He(311));n.lastRenderedReducer=e;var r=Bn,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var u=o=null,p=null,h=a;do{var g=h.lane;if((ja&g)===g)p!==null&&(p=p.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var f={lane:g,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};p===null?(u=p=f,o=r):p=p.next=f,xn.lanes|=g,Ba|=g}h=h.next}while(h!==null&&h!==a);p===null?o=r:p.next=u,Di(r,t.memoizedState)||(Ur=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=p,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,xn.lanes|=a,Ba|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function hp(e){var t=fi(),n=t.queue;if(n===null)throw Error(He(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Di(a,t.memoizedState)||(Ur=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function q0(){}function z0(e,t){var n=xn,r=fi(),i=t(),a=!Di(r.memoizedState,i);if(a&&(r.memoizedState=i,Ur=!0),r=r.queue,Rm(W0.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||zn!==null&&zn.memoizedState.tag&1){if(n.flags|=2048,el(9,$0.bind(null,n,r,i,t),void 0,null),Kn===null)throw Error(He(349));ja&30||K0(n,t,i)}return i}function K0(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=xn.updateQueue,t===null?(t={lastEffect:null,stores:null},xn.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $0(e,t,n,r){t.value=n,t.getSnapshot=r,G0(t)&&J0(e)}function W0(e,t,n){return n(function(){G0(t)&&J0(e)})}function G0(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Di(e,n)}catch{return!0}}function J0(e){var t=_s(e,1);t!==null&&Ai(t,e,1,-1)}function hv(e){var t=Gi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yc,lastRenderedState:e},t.queue=e,e=e.dispatch=pw.bind(null,xn,e),[t.memoizedState,e]}function el(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=xn.updateQueue,t===null?(t={lastEffect:null,stores:null},xn.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Z0(){return fi().memoizedState}function Pu(e,t,n,r){var i=Gi();xn.flags|=e,i.memoizedState=el(1|t,n,void 0,r===void 0?null:r)}function jd(e,t,n,r){var i=fi();r=r===void 0?null:r;var a=void 0;if(Bn!==null){var o=Bn.memoizedState;if(a=o.destroy,r!==null&&Pm(r,o.deps)){i.memoizedState=el(t,n,a,r);return}}xn.flags|=e,i.memoizedState=el(1|t,n,a,r)}function pv(e,t){return Pu(8390656,8,e,t)}function Rm(e,t){return jd(2048,8,e,t)}function X0(e,t){return jd(4,2,e,t)}function Q0(e,t){return jd(4,4,e,t)}function Y0(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ey(e,t,n){return n=n!=null?n.concat([e]):null,jd(4,4,Y0.bind(null,t,e),n)}function Am(){}function ty(e,t){var n=fi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Pm(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ny(e,t){var n=fi();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Pm(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ry(e,t,n){return ja&21?(Di(n,t)||(n=c0(),xn.lanes|=n,Ba|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ur=!0),e.memoizedState=n)}function dw(e,t){var n=Yt;Yt=n!==0&&4>n?n:4,e(!0);var r=up.transition;up.transition={};try{e(!1),t()}finally{Yt=n,up.transition=r}}function iy(){return fi().memoizedState}function hw(e,t,n){var r=Ys(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},sy(e))ay(t,n);else if(n=U0(e,t,n,r),n!==null){var i=Tr();Ai(n,e,r,i),oy(n,t,r)}}function pw(e,t,n){var r=Ys(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(sy(e))ay(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,u=a(o,n);if(i.hasEagerState=!0,i.eagerState=u,Di(u,o)){var p=t.interleaved;p===null?(i.next=i,Sm(t)):(i.next=p.next,p.next=i),t.interleaved=i;return}}catch{}finally{}n=U0(e,t,i,r),n!==null&&(i=Tr(),Ai(n,e,r,i),oy(n,t,r))}}function sy(e){var t=e.alternate;return e===xn||t!==null&&t===xn}function ay(e,t){Nc=ld=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function oy(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,om(e,n)}}var ud={readContext:pi,useCallback:lr,useContext:lr,useEffect:lr,useImperativeHandle:lr,useInsertionEffect:lr,useLayoutEffect:lr,useMemo:lr,useReducer:lr,useRef:lr,useState:lr,useDebugValue:lr,useDeferredValue:lr,useTransition:lr,useMutableSource:lr,useSyncExternalStore:lr,useId:lr,unstable_isNewReconciler:!1},fw={readContext:pi,useCallback:function(e,t){return Gi().memoizedState=[e,t===void 0?null:t],e},useContext:pi,useEffect:pv,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Pu(4194308,4,Y0.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pu(4,2,e,t)},useMemo:function(e,t){var n=Gi();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Gi();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=hw.bind(null,xn,e),[r.memoizedState,e]},useRef:function(e){var t=Gi();return e={current:e},t.memoizedState=e},useState:hv,useDebugValue:Am,useDeferredValue:function(e){return Gi().memoizedState=e},useTransition:function(){var e=hv(!1),t=e[0];return e=dw.bind(null,e[1]),Gi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=xn,i=Gi();if(pn){if(n===void 0)throw Error(He(407));n=n()}else{if(n=t(),Kn===null)throw Error(He(349));ja&30||K0(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,pv(W0.bind(null,r,a,e),[e]),r.flags|=2048,el(9,$0.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Gi(),t=Kn.identifierPrefix;if(pn){var n=ms,r=fs;n=(r&~(1<<32-Ri(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Qc++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=uw++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},mw={readContext:pi,useCallback:ty,useContext:pi,useEffect:Rm,useImperativeHandle:ey,useInsertionEffect:X0,useLayoutEffect:Q0,useMemo:ny,useReducer:dp,useRef:Z0,useState:function(){return dp(Yc)},useDebugValue:Am,useDeferredValue:function(e){var t=fi();return ry(t,Bn.memoizedState,e)},useTransition:function(){var e=dp(Yc)[0],t=fi().memoizedState;return[e,t]},useMutableSource:q0,useSyncExternalStore:z0,useId:iy,unstable_isNewReconciler:!1},gw={readContext:pi,useCallback:ty,useContext:pi,useEffect:Rm,useImperativeHandle:ey,useInsertionEffect:X0,useLayoutEffect:Q0,useMemo:ny,useReducer:hp,useRef:Z0,useState:function(){return hp(Yc)},useDebugValue:Am,useDeferredValue:function(e){var t=fi();return Bn===null?t.memoizedState=e:ry(t,Bn.memoizedState,e)},useTransition:function(){var e=hp(Yc)[0],t=fi().memoizedState;return[e,t]},useMutableSource:q0,useSyncExternalStore:z0,useId:iy,unstable_isNewReconciler:!1};function xi(e,t){if(e&&e.defaultProps){t=Cn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function pf(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Cn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Bd={isMounted:function(e){return(e=e._reactInternals)?Ka(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Tr(),i=Ys(e),a=gs(r,i);a.payload=t,n!=null&&(a.callback=n),t=Xs(e,a,i),t!==null&&(Ai(t,e,i,r),Cu(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Tr(),i=Ys(e),a=gs(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Xs(e,a,i),t!==null&&(Ai(t,e,i,r),Cu(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Tr(),r=Ys(e),i=gs(n,r);i.tag=2,t!=null&&(i.callback=t),t=Xs(e,i,r),t!==null&&(Ai(t,e,r,n),Cu(t,e,r))}};function fv(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!$c(n,r)||!$c(i,a):!0}function cy(e,t,n){var r=!1,i=na,a=t.contextType;return typeof a=="object"&&a!==null?a=pi(a):(i=Vr(t)?Ma:mr.current,r=t.contextTypes,a=(r=r!=null)?Po(e,i):na),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bd,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function mv(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Bd.enqueueReplaceState(t,t.state,null)}function ff(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},wm(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=pi(a):(a=Vr(t)?Ma:mr.current,i.context=Po(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(pf(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Bd.enqueueReplaceState(i,i.state,null),od(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Ao(e,t){try{var n="",r=t;do n+=z2(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function pp(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function mf(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var vw=typeof WeakMap=="function"?WeakMap:Map;function ly(e,t,n){n=gs(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){hd||(hd=!0,Ef=r),mf(e,t)},n}function uy(e,t,n){n=gs(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){mf(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){mf(e,t),typeof r!="function"&&(Qs===null?Qs=new Set([this]):Qs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function gv(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new vw;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Iw.bind(null,e,t,n),t.then(e,e))}function vv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function yv(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=gs(-1,1),t.tag=2,Xs(n,t,1))),n.lanes|=1),e)}var yw=xs.ReactCurrentOwner,Ur=!1;function Cr(e,t,n,r){t.child=e===null?B0(t,null,n,r):To(t,e.child,n,r)}function _v(e,t,n,r,i){n=n.render;var a=t.ref;return So(t,i),r=km(e,t,n,r,a,i),n=Tm(),e!==null&&!Ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,bs(e,t,i)):(pn&&n&&mm(t),t.flags|=1,Cr(e,t,r,i),t.child)}function bv(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!jm(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,dy(e,t,a,r,i)):(e=Au(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:$c,n(o,r)&&e.ref===t.ref)return bs(e,t,i)}return t.flags|=1,e=ea(a,r),e.ref=t.ref,e.return=t,t.child=e}function dy(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if($c(a,r)&&e.ref===t.ref)if(Ur=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(Ur=!0);else return t.lanes=e.lanes,bs(e,t,i)}return gf(e,t,n,r,i)}function hy(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},sn(po,Gr),Gr|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,sn(po,Gr),Gr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,sn(po,Gr),Gr|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,sn(po,Gr),Gr|=r;return Cr(e,t,i,n),t.child}function py(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function gf(e,t,n,r,i){var a=Vr(n)?Ma:mr.current;return a=Po(t,a),So(t,i),n=km(e,t,n,r,a,i),r=Tm(),e!==null&&!Ur?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,bs(e,t,i)):(pn&&r&&mm(t),t.flags|=1,Cr(e,t,n,i),t.child)}function Sv(e,t,n,r,i){if(Vr(n)){var a=!0;nd(t)}else a=!1;if(So(t,i),t.stateNode===null)ku(e,t),cy(t,n,r),ff(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,u=t.memoizedProps;o.props=u;var p=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=pi(h):(h=Vr(n)?Ma:mr.current,h=Po(t,h));var g=n.getDerivedStateFromProps,f=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||p!==h)&&mv(t,o,r,h),Hs=!1;var _=t.memoizedState;o.state=_,od(t,r,o,i),p=t.memoizedState,u!==r||_!==p||Hr.current||Hs?(typeof g=="function"&&(pf(t,n,g,r),p=t.memoizedState),(u=Hs||fv(t,n,u,r,_,p,h))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=h,r=u):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,H0(e,t),u=t.memoizedProps,h=t.type===t.elementType?u:xi(t.type,u),o.props=h,f=t.pendingProps,_=o.context,p=n.contextType,typeof p=="object"&&p!==null?p=pi(p):(p=Vr(n)?Ma:mr.current,p=Po(t,p));var w=n.getDerivedStateFromProps;(g=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==f||_!==p)&&mv(t,o,r,p),Hs=!1,_=t.memoizedState,o.state=_,od(t,r,o,i);var C=t.memoizedState;u!==f||_!==C||Hr.current||Hs?(typeof w=="function"&&(pf(t,n,w,r),C=t.memoizedState),(h=Hs||fv(t,n,h,r,_,C,p)||!1)?(g||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,p),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,p)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=C),o.props=r,o.state=C,o.context=p,r=h):(typeof o.componentDidUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),r=!1)}return vf(e,t,n,r,a,i)}function vf(e,t,n,r,i,a){py(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&av(t,n,!1),bs(e,t,a);r=t.stateNode,yw.current=t;var u=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=To(t,e.child,null,a),t.child=To(t,null,u,a)):Cr(e,t,u,a),t.memoizedState=r.state,i&&av(t,n,!0),t.child}function fy(e){var t=e.stateNode;t.pendingContext?sv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&sv(e,t.context,!1),xm(e,t.containerInfo)}function wv(e,t,n,r,i){return ko(),vm(i),t.flags|=256,Cr(e,t,n,r),t.child}var yf={dehydrated:null,treeContext:null,retryLane:0};function _f(e){return{baseLanes:e,cachePool:null,transitions:null}}function my(e,t,n){var r=t.pendingProps,i=wn.current,a=!1,o=(t.flags&128)!==0,u;if((u=o)||(u=e!==null&&e.memoizedState===null?!1:(i&2)!==0),u?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),sn(wn,i&1),e===null)return df(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Vd(o,r,0,null),e=Da(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=_f(n),t.memoizedState=yf,e):Im(t,o));if(i=e.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return _w(e,t,o,r,u,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,u=i.sibling;var p={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=p,t.deletions=null):(r=ea(i,p),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?a=ea(u,a):(a=Da(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?_f(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=yf,r}return a=e.child,e=a.sibling,r=ea(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Im(e,t){return t=Vd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cu(e,t,n,r){return r!==null&&vm(r),To(t,e.child,null,n),e=Im(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function _w(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=pp(Error(He(422))),cu(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Vd({mode:"visible",children:r.children},i,0,null),a=Da(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&To(t,e.child,null,o),t.child.memoizedState=_f(o),t.memoizedState=yf,a);if(!(t.mode&1))return cu(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,a=Error(He(419)),r=pp(a,r,void 0),cu(e,t,o,r)}if(u=(o&e.childLanes)!==0,Ur||u){if(r=Kn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,_s(e,i),Ai(r,e,i,-1))}return Lm(),r=pp(Error(He(421))),cu(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=Fw.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Zr=Zs(i.nextSibling),Xr=t,pn=!0,Pi=null,e!==null&&(li[ui++]=fs,li[ui++]=ms,li[ui++]=La,fs=e.id,ms=e.overflow,La=t),t=Im(t,r.children),t.flags|=4096,t)}function xv(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),hf(e.return,t,n)}function fp(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function gy(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Cr(e,t,r.children,n),r=wn.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&xv(e,n,t);else if(e.tag===19)xv(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(sn(wn,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&cd(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),fp(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&cd(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}fp(t,!0,n,null,a);break;case"together":fp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ku(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function bs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ba|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(He(153));if(t.child!==null){for(e=t.child,n=ea(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ea(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function bw(e,t,n){switch(t.tag){case 3:fy(t),ko();break;case 5:V0(t);break;case 1:Vr(t.type)&&nd(t);break;case 4:xm(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;sn(sd,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(sn(wn,wn.current&1),t.flags|=128,null):n&t.child.childLanes?my(e,t,n):(sn(wn,wn.current&1),e=bs(e,t,n),e!==null?e.sibling:null);sn(wn,wn.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return gy(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),sn(wn,wn.current),r)break;return null;case 22:case 23:return t.lanes=0,hy(e,t,n)}return bs(e,t,n)}var vy,bf,yy,_y;vy=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};bf=function(){};yy=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ka(Xi.current);var a=null;switch(n){case"input":i=Hp(e,i),r=Hp(e,r),a=[];break;case"select":i=Cn({},i,{value:void 0}),r=Cn({},r,{value:void 0}),a=[];break;case"textarea":i=zp(e,i),r=zp(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ed)}$p(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var u=i[h];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Bc.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in r){var p=r[h];if(u=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&p!==u&&(p!=null||u!=null))if(h==="style")if(u){for(o in u)!u.hasOwnProperty(o)||p&&p.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in p)p.hasOwnProperty(o)&&u[o]!==p[o]&&(n||(n={}),n[o]=p[o])}else n||(a||(a=[]),a.push(h,n)),n=p;else h==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,u=u?u.__html:void 0,p!=null&&u!==p&&(a=a||[]).push(h,p)):h==="children"?typeof p!="string"&&typeof p!="number"||(a=a||[]).push(h,""+p):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Bc.hasOwnProperty(h)?(p!=null&&h==="onScroll"&&un("scroll",e),a||u===p||(a=[])):(a=a||[]).push(h,p))}n&&(a=a||[]).push("style",n);var h=a;(t.updateQueue=h)&&(t.flags|=4)}};_y=function(e,t,n,r){n!==r&&(t.flags|=4)};function pc(e,t){if(!pn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ur(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Sw(e,t,n){var r=t.pendingProps;switch(gm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ur(t),null;case 1:return Vr(t.type)&&td(),ur(t),null;case 3:return r=t.stateNode,Ro(),dn(Hr),dn(mr),Em(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(au(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Pi!==null&&(Tf(Pi),Pi=null))),bf(e,t),ur(t),null;case 5:Cm(t);var i=ka(Xc.current);if(n=t.type,e!==null&&t.stateNode!=null)yy(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(He(166));return ur(t),null}if(e=ka(Xi.current),au(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Ji]=t,r[Jc]=a,e=(t.mode&1)!==0,n){case"dialog":un("cancel",r),un("close",r);break;case"iframe":case"object":case"embed":un("load",r);break;case"video":case"audio":for(i=0;i<kc.length;i++)un(kc[i],r);break;case"source":un("error",r);break;case"img":case"image":case"link":un("error",r),un("load",r);break;case"details":un("toggle",r);break;case"input":Fg(r,a),un("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},un("invalid",r);break;case"textarea":Ng(r,a),un("invalid",r)}$p(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="children"?typeof u=="string"?r.textContent!==u&&(a.suppressHydrationWarning!==!0&&su(r.textContent,u,e),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(a.suppressHydrationWarning!==!0&&su(r.textContent,u,e),i=["children",""+u]):Bc.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&un("scroll",r)}switch(n){case"input":Xl(r),Dg(r,a,!0);break;case"textarea":Xl(r),Og(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=ed)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=W1(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Ji]=t,e[Jc]=r,vy(e,t,!1,!1),t.stateNode=e;e:{switch(o=Wp(n,r),n){case"dialog":un("cancel",e),un("close",e),i=r;break;case"iframe":case"object":case"embed":un("load",e),i=r;break;case"video":case"audio":for(i=0;i<kc.length;i++)un(kc[i],e);i=r;break;case"source":un("error",e),i=r;break;case"img":case"image":case"link":un("error",e),un("load",e),i=r;break;case"details":un("toggle",e),i=r;break;case"input":Fg(e,r),i=Hp(e,r),un("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Cn({},r,{value:void 0}),un("invalid",e);break;case"textarea":Ng(e,r),i=zp(e,r),un("invalid",e);break;default:i=r}$p(n,i),u=i;for(a in u)if(u.hasOwnProperty(a)){var p=u[a];a==="style"?Z1(e,p):a==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&G1(e,p)):a==="children"?typeof p=="string"?(n!=="textarea"||p!=="")&&Uc(e,p):typeof p=="number"&&Uc(e,""+p):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Bc.hasOwnProperty(a)?p!=null&&a==="onScroll"&&un("scroll",e):p!=null&&tm(e,a,p,o))}switch(n){case"input":Xl(e),Dg(e,r,!1);break;case"textarea":Xl(e),Og(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ta(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?vo(e,!!r.multiple,a,!1):r.defaultValue!=null&&vo(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=ed)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ur(t),null;case 6:if(e&&t.stateNode!=null)_y(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(He(166));if(n=ka(Xc.current),ka(Xi.current),au(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ji]=t,(a=r.nodeValue!==n)&&(e=Xr,e!==null))switch(e.tag){case 3:su(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&su(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ji]=t,t.stateNode=r}return ur(t),null;case 13:if(dn(wn),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pn&&Zr!==null&&t.mode&1&&!(t.flags&128))L0(),ko(),t.flags|=98560,a=!1;else if(a=au(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(He(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(He(317));a[Ji]=t}else ko(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ur(t),a=!1}else Pi!==null&&(Tf(Pi),Pi=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||wn.current&1?Un===0&&(Un=3):Lm())),t.updateQueue!==null&&(t.flags|=4),ur(t),null);case 4:return Ro(),bf(e,t),e===null&&Wc(t.stateNode.containerInfo),ur(t),null;case 10:return bm(t.type._context),ur(t),null;case 17:return Vr(t.type)&&td(),ur(t),null;case 19:if(dn(wn),a=t.memoizedState,a===null)return ur(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)pc(a,!1);else{if(Un!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=cd(e),o!==null){for(t.flags|=128,pc(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return sn(wn,wn.current&1|2),t.child}e=e.sibling}a.tail!==null&&An()>Io&&(t.flags|=128,r=!0,pc(a,!1),t.lanes=4194304)}else{if(!r)if(e=cd(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),pc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!pn)return ur(t),null}else 2*An()-a.renderingStartTime>Io&&n!==1073741824&&(t.flags|=128,r=!0,pc(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=An(),t.sibling=null,n=wn.current,sn(wn,r?n&1|2:n&1),t):(ur(t),null);case 22:case 23:return Mm(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Gr&1073741824&&(ur(t),t.subtreeFlags&6&&(t.flags|=8192)):ur(t),null;case 24:return null;case 25:return null}throw Error(He(156,t.tag))}function ww(e,t){switch(gm(t),t.tag){case 1:return Vr(t.type)&&td(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ro(),dn(Hr),dn(mr),Em(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Cm(t),null;case 13:if(dn(wn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(He(340));ko()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return dn(wn),null;case 4:return Ro(),null;case 10:return bm(t.type._context),null;case 22:case 23:return Mm(),null;case 24:return null;default:return null}}var lu=!1,pr=!1,xw=typeof WeakSet=="function"?WeakSet:Set,tt=null;function ho(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){kn(e,t,r)}else n.current=null}function Sf(e,t,n){try{n()}catch(r){kn(e,t,r)}}var Cv=!1;function Cw(e,t){if(rf=Xu,e=C0(),fm(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,u=-1,p=-1,h=0,g=0,f=e,_=null;t:for(;;){for(var w;f!==n||i!==0&&f.nodeType!==3||(u=o+i),f!==a||r!==0&&f.nodeType!==3||(p=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(w=f.firstChild)!==null;)_=f,f=w;for(;;){if(f===e)break t;if(_===n&&++h===i&&(u=o),_===a&&++g===r&&(p=o),(w=f.nextSibling)!==null)break;f=_,_=f.parentNode}f=w}n=u===-1||p===-1?null:{start:u,end:p}}else n=null}n=n||{start:0,end:0}}else n=null;for(sf={focusedElem:e,selectionRange:n},Xu=!1,tt=t;tt!==null;)if(t=tt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,tt=e;else for(;tt!==null;){t=tt;try{var C=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var R=C.memoizedProps,S=C.memoizedState,b=t.stateNode,x=b.getSnapshotBeforeUpdate(t.elementType===t.type?R:xi(t.type,R),S);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var E=t.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(He(163))}}catch(M){kn(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,tt=e;break}tt=t.return}return C=Cv,Cv=!1,C}function Oc(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&Sf(t,n,a)}i=i.next}while(i!==r)}}function Ud(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function wf(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function by(e){var t=e.alternate;t!==null&&(e.alternate=null,by(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ji],delete t[Jc],delete t[cf],delete t[aw],delete t[ow])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Sy(e){return e.tag===5||e.tag===3||e.tag===4}function Ev(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Sy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ed));else if(r!==4&&(e=e.child,e!==null))for(xf(e,t,n),e=e.sibling;e!==null;)xf(e,t,n),e=e.sibling}function Cf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Cf(e,t,n),e=e.sibling;e!==null;)Cf(e,t,n),e=e.sibling}var Yn=null,Ei=!1;function Fs(e,t,n){for(n=n.child;n!==null;)wy(e,t,n),n=n.sibling}function wy(e,t,n){if(Zi&&typeof Zi.onCommitFiberUnmount=="function")try{Zi.onCommitFiberUnmount(Fd,n)}catch{}switch(n.tag){case 5:pr||ho(n,t);case 6:var r=Yn,i=Ei;Yn=null,Fs(e,t,n),Yn=r,Ei=i,Yn!==null&&(Ei?(e=Yn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Yn.removeChild(n.stateNode));break;case 18:Yn!==null&&(Ei?(e=Yn,n=n.stateNode,e.nodeType===8?op(e.parentNode,n):e.nodeType===1&&op(e,n),zc(e)):op(Yn,n.stateNode));break;case 4:r=Yn,i=Ei,Yn=n.stateNode.containerInfo,Ei=!0,Fs(e,t,n),Yn=r,Ei=i;break;case 0:case 11:case 14:case 15:if(!pr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Sf(n,t,o),i=i.next}while(i!==r)}Fs(e,t,n);break;case 1:if(!pr&&(ho(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){kn(n,t,u)}Fs(e,t,n);break;case 21:Fs(e,t,n);break;case 22:n.mode&1?(pr=(r=pr)||n.memoizedState!==null,Fs(e,t,n),pr=r):Fs(e,t,n);break;default:Fs(e,t,n)}}function Pv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new xw),t.forEach(function(r){var i=Dw.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function yi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,u=o;e:for(;u!==null;){switch(u.tag){case 5:Yn=u.stateNode,Ei=!1;break e;case 3:Yn=u.stateNode.containerInfo,Ei=!0;break e;case 4:Yn=u.stateNode.containerInfo,Ei=!0;break e}u=u.return}if(Yn===null)throw Error(He(160));wy(a,o,i),Yn=null,Ei=!1;var p=i.alternate;p!==null&&(p.return=null),i.return=null}catch(h){kn(i,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)xy(t,e),t=t.sibling}function xy(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yi(t,e),Ki(e),r&4){try{Oc(3,e,e.return),Ud(3,e)}catch(R){kn(e,e.return,R)}try{Oc(5,e,e.return)}catch(R){kn(e,e.return,R)}}break;case 1:yi(t,e),Ki(e),r&512&&n!==null&&ho(n,n.return);break;case 5:if(yi(t,e),Ki(e),r&512&&n!==null&&ho(n,n.return),e.flags&32){var i=e.stateNode;try{Uc(i,"")}catch(R){kn(e,e.return,R)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,u=e.type,p=e.updateQueue;if(e.updateQueue=null,p!==null)try{u==="input"&&a.type==="radio"&&a.name!=null&&K1(i,a),Wp(u,o);var h=Wp(u,a);for(o=0;o<p.length;o+=2){var g=p[o],f=p[o+1];g==="style"?Z1(i,f):g==="dangerouslySetInnerHTML"?G1(i,f):g==="children"?Uc(i,f):tm(i,g,f,h)}switch(u){case"input":Vp(i,a);break;case"textarea":$1(i,a);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var w=a.value;w!=null?vo(i,!!a.multiple,w,!1):_!==!!a.multiple&&(a.defaultValue!=null?vo(i,!!a.multiple,a.defaultValue,!0):vo(i,!!a.multiple,a.multiple?[]:"",!1))}i[Jc]=a}catch(R){kn(e,e.return,R)}}break;case 6:if(yi(t,e),Ki(e),r&4){if(e.stateNode===null)throw Error(He(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(R){kn(e,e.return,R)}}break;case 3:if(yi(t,e),Ki(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{zc(t.containerInfo)}catch(R){kn(e,e.return,R)}break;case 4:yi(t,e),Ki(e);break;case 13:yi(t,e),Ki(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Nm=An())),r&4&&Pv(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(pr=(h=pr)||g,yi(t,e),pr=h):yi(t,e),Ki(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!g&&e.mode&1)for(tt=e,g=e.child;g!==null;){for(f=tt=g;tt!==null;){switch(_=tt,w=_.child,_.tag){case 0:case 11:case 14:case 15:Oc(4,_,_.return);break;case 1:ho(_,_.return);var C=_.stateNode;if(typeof C.componentWillUnmount=="function"){r=_,n=_.return;try{t=r,C.props=t.memoizedProps,C.state=t.memoizedState,C.componentWillUnmount()}catch(R){kn(r,n,R)}}break;case 5:ho(_,_.return);break;case 22:if(_.memoizedState!==null){Tv(f);continue}}w!==null?(w.return=_,tt=w):Tv(f)}g=g.sibling}e:for(g=null,f=e;;){if(f.tag===5){if(g===null){g=f;try{i=f.stateNode,h?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(u=f.stateNode,p=f.memoizedProps.style,o=p!=null&&p.hasOwnProperty("display")?p.display:null,u.style.display=J1("display",o))}catch(R){kn(e,e.return,R)}}}else if(f.tag===6){if(g===null)try{f.stateNode.nodeValue=h?"":f.memoizedProps}catch(R){kn(e,e.return,R)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;g===f&&(g=null),f=f.return}g===f&&(g=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:yi(t,e),Ki(e),r&4&&Pv(e);break;case 21:break;default:yi(t,e),Ki(e)}}function Ki(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Sy(n)){var r=n;break e}n=n.return}throw Error(He(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Uc(i,""),r.flags&=-33);var a=Ev(e);Cf(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=Ev(e);xf(e,u,o);break;default:throw Error(He(161))}}catch(p){kn(e,e.return,p)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ew(e,t,n){tt=e,Cy(e)}function Cy(e,t,n){for(var r=(e.mode&1)!==0;tt!==null;){var i=tt,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||lu;if(!o){var u=i.alternate,p=u!==null&&u.memoizedState!==null||pr;u=lu;var h=pr;if(lu=o,(pr=p)&&!h)for(tt=i;tt!==null;)o=tt,p=o.child,o.tag===22&&o.memoizedState!==null?Rv(i):p!==null?(p.return=o,tt=p):Rv(i);for(;a!==null;)tt=a,Cy(a),a=a.sibling;tt=i,lu=u,pr=h}kv(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,tt=a):kv(e)}}function kv(e){for(;tt!==null;){var t=tt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pr||Ud(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!pr)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:xi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&dv(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}dv(t,o,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var p=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&n.focus();break;case"img":p.src&&(n.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var g=h.memoizedState;if(g!==null){var f=g.dehydrated;f!==null&&zc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(He(163))}pr||t.flags&512&&wf(t)}catch(_){kn(t,t.return,_)}}if(t===e){tt=null;break}if(n=t.sibling,n!==null){n.return=t.return,tt=n;break}tt=t.return}}function Tv(e){for(;tt!==null;){var t=tt;if(t===e){tt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,tt=n;break}tt=t.return}}function Rv(e){for(;tt!==null;){var t=tt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ud(4,t)}catch(p){kn(t,n,p)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(p){kn(t,i,p)}}var a=t.return;try{wf(t)}catch(p){kn(t,a,p)}break;case 5:var o=t.return;try{wf(t)}catch(p){kn(t,o,p)}}}catch(p){kn(t,t.return,p)}if(t===e){tt=null;break}var u=t.sibling;if(u!==null){u.return=t.return,tt=u;break}tt=t.return}}var Pw=Math.ceil,dd=xs.ReactCurrentDispatcher,Fm=xs.ReactCurrentOwner,hi=xs.ReactCurrentBatchConfig,zt=0,Kn=null,Mn=null,er=0,Gr=0,po=oa(0),Un=0,tl=null,Ba=0,Hd=0,Dm=0,Mc=null,Br=null,Nm=0,Io=1/0,ds=null,hd=!1,Ef=null,Qs=null,uu=!1,$s=null,pd=0,Lc=0,Pf=null,Tu=-1,Ru=0;function Tr(){return zt&6?An():Tu!==-1?Tu:Tu=An()}function Ys(e){return e.mode&1?zt&2&&er!==0?er&-er:lw.transition!==null?(Ru===0&&(Ru=c0()),Ru):(e=Yt,e!==0||(e=window.event,e=e===void 0?16:m0(e.type)),e):1}function Ai(e,t,n,r){if(50<Lc)throw Lc=0,Pf=null,Error(He(185));_l(e,n,r),(!(zt&2)||e!==Kn)&&(e===Kn&&(!(zt&2)&&(Hd|=n),Un===4&&qs(e,er)),qr(e,r),n===1&&zt===0&&!(t.mode&1)&&(Io=An()+500,Ld&&ca()))}function qr(e,t){var n=e.callbackNode;lS(e,t);var r=Zu(e,e===Kn?er:0);if(r===0)n!==null&&jg(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&jg(n),t===1)e.tag===0?cw(Av.bind(null,e)):N0(Av.bind(null,e)),iw(function(){!(zt&6)&&ca()}),n=null;else{switch(l0(r)){case 1:n=am;break;case 4:n=a0;break;case 16:n=Ju;break;case 536870912:n=o0;break;default:n=Ju}n=Fy(n,Ey.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ey(e,t){if(Tu=-1,Ru=0,zt&6)throw Error(He(327));var n=e.callbackNode;if(wo()&&e.callbackNode!==n)return null;var r=Zu(e,e===Kn?er:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=fd(e,r);else{t=r;var i=zt;zt|=2;var a=ky();(Kn!==e||er!==t)&&(ds=null,Io=An()+500,Fa(e,t));do try{Rw();break}catch(u){Py(e,u)}while(!0);_m(),dd.current=a,zt=i,Mn!==null?t=0:(Kn=null,er=0,t=Un)}if(t!==0){if(t===2&&(i=Qp(e),i!==0&&(r=i,t=kf(e,i))),t===1)throw n=tl,Fa(e,0),qs(e,r),qr(e,An()),n;if(t===6)qs(e,r);else{if(i=e.current.alternate,!(r&30)&&!kw(i)&&(t=fd(e,r),t===2&&(a=Qp(e),a!==0&&(r=a,t=kf(e,a))),t===1))throw n=tl,Fa(e,0),qs(e,r),qr(e,An()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(He(345));case 2:wa(e,Br,ds);break;case 3:if(qs(e,r),(r&130023424)===r&&(t=Nm+500-An(),10<t)){if(Zu(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Tr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=of(wa.bind(null,e,Br,ds),t);break}wa(e,Br,ds);break;case 4:if(qs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Ri(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=An()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pw(r/1960))-r,10<r){e.timeoutHandle=of(wa.bind(null,e,Br,ds),r);break}wa(e,Br,ds);break;case 5:wa(e,Br,ds);break;default:throw Error(He(329))}}}return qr(e,An()),e.callbackNode===n?Ey.bind(null,e):null}function kf(e,t){var n=Mc;return e.current.memoizedState.isDehydrated&&(Fa(e,t).flags|=256),e=fd(e,t),e!==2&&(t=Br,Br=n,t!==null&&Tf(t)),e}function Tf(e){Br===null?Br=e:Br.push.apply(Br,e)}function kw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Di(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qs(e,t){for(t&=~Dm,t&=~Hd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ri(t),r=1<<n;e[n]=-1,t&=~r}}function Av(e){if(zt&6)throw Error(He(327));wo();var t=Zu(e,0);if(!(t&1))return qr(e,An()),null;var n=fd(e,t);if(e.tag!==0&&n===2){var r=Qp(e);r!==0&&(t=r,n=kf(e,r))}if(n===1)throw n=tl,Fa(e,0),qs(e,t),qr(e,An()),n;if(n===6)throw Error(He(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wa(e,Br,ds),qr(e,An()),null}function Om(e,t){var n=zt;zt|=1;try{return e(t)}finally{zt=n,zt===0&&(Io=An()+500,Ld&&ca())}}function Ua(e){$s!==null&&$s.tag===0&&!(zt&6)&&wo();var t=zt;zt|=1;var n=hi.transition,r=Yt;try{if(hi.transition=null,Yt=1,e)return e()}finally{Yt=r,hi.transition=n,zt=t,!(zt&6)&&ca()}}function Mm(){Gr=po.current,dn(po)}function Fa(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,rw(n)),Mn!==null)for(n=Mn.return;n!==null;){var r=n;switch(gm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&td();break;case 3:Ro(),dn(Hr),dn(mr),Em();break;case 5:Cm(r);break;case 4:Ro();break;case 13:dn(wn);break;case 19:dn(wn);break;case 10:bm(r.type._context);break;case 22:case 23:Mm()}n=n.return}if(Kn=e,Mn=e=ea(e.current,null),er=Gr=t,Un=0,tl=null,Dm=Hd=Ba=0,Br=Mc=null,Pa!==null){for(t=0;t<Pa.length;t++)if(n=Pa[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}Pa=null}return e}function Py(e,t){do{var n=Mn;try{if(_m(),Eu.current=ud,ld){for(var r=xn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ld=!1}if(ja=0,zn=Bn=xn=null,Nc=!1,Qc=0,Fm.current=null,n===null||n.return===null){Un=1,tl=t,Mn=null;break}e:{var a=e,o=n.return,u=n,p=t;if(t=er,u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var h=p,g=u,f=g.tag;if(!(g.mode&1)&&(f===0||f===11||f===15)){var _=g.alternate;_?(g.updateQueue=_.updateQueue,g.memoizedState=_.memoizedState,g.lanes=_.lanes):(g.updateQueue=null,g.memoizedState=null)}var w=vv(o);if(w!==null){w.flags&=-257,yv(w,o,u,a,t),w.mode&1&&gv(a,h,t),t=w,p=h;var C=t.updateQueue;if(C===null){var R=new Set;R.add(p),t.updateQueue=R}else C.add(p);break e}else{if(!(t&1)){gv(a,h,t),Lm();break e}p=Error(He(426))}}else if(pn&&u.mode&1){var S=vv(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),yv(S,o,u,a,t),vm(Ao(p,u));break e}}a=p=Ao(p,u),Un!==4&&(Un=2),Mc===null?Mc=[a]:Mc.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var b=ly(a,p,t);uv(a,b);break e;case 1:u=p;var x=a.type,E=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Qs===null||!Qs.has(E)))){a.flags|=65536,t&=-t,a.lanes|=t;var M=uy(a,u,t);uv(a,M);break e}}a=a.return}while(a!==null)}Ry(n)}catch(Z){t=Z,Mn===n&&n!==null&&(Mn=n=n.return);continue}break}while(!0)}function ky(){var e=dd.current;return dd.current=ud,e===null?ud:e}function Lm(){(Un===0||Un===3||Un===2)&&(Un=4),Kn===null||!(Ba&268435455)&&!(Hd&268435455)||qs(Kn,er)}function fd(e,t){var n=zt;zt|=2;var r=ky();(Kn!==e||er!==t)&&(ds=null,Fa(e,t));do try{Tw();break}catch(i){Py(e,i)}while(!0);if(_m(),zt=n,dd.current=r,Mn!==null)throw Error(He(261));return Kn=null,er=0,Un}function Tw(){for(;Mn!==null;)Ty(Mn)}function Rw(){for(;Mn!==null&&!eS();)Ty(Mn)}function Ty(e){var t=Iy(e.alternate,e,Gr);e.memoizedProps=e.pendingProps,t===null?Ry(e):Mn=t,Fm.current=null}function Ry(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=ww(n,t),n!==null){n.flags&=32767,Mn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Un=6,Mn=null;return}}else if(n=Sw(n,t,Gr),n!==null){Mn=n;return}if(t=t.sibling,t!==null){Mn=t;return}Mn=t=e}while(t!==null);Un===0&&(Un=5)}function wa(e,t,n){var r=Yt,i=hi.transition;try{hi.transition=null,Yt=1,Aw(e,t,n,r)}finally{hi.transition=i,Yt=r}return null}function Aw(e,t,n,r){do wo();while($s!==null);if(zt&6)throw Error(He(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(He(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(uS(e,a),e===Kn&&(Mn=Kn=null,er=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||uu||(uu=!0,Fy(Ju,function(){return wo(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=hi.transition,hi.transition=null;var o=Yt;Yt=1;var u=zt;zt|=4,Fm.current=null,Cw(e,n),xy(n,e),ZS(sf),Xu=!!rf,sf=rf=null,e.current=n,Ew(n),tS(),zt=u,Yt=o,hi.transition=a}else e.current=n;if(uu&&(uu=!1,$s=e,pd=i),a=e.pendingLanes,a===0&&(Qs=null),iS(n.stateNode),qr(e,An()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(hd)throw hd=!1,e=Ef,Ef=null,e;return pd&1&&e.tag!==0&&wo(),a=e.pendingLanes,a&1?e===Pf?Lc++:(Lc=0,Pf=e):Lc=0,ca(),null}function wo(){if($s!==null){var e=l0(pd),t=hi.transition,n=Yt;try{if(hi.transition=null,Yt=16>e?16:e,$s===null)var r=!1;else{if(e=$s,$s=null,pd=0,zt&6)throw Error(He(331));var i=zt;for(zt|=4,tt=e.current;tt!==null;){var a=tt,o=a.child;if(tt.flags&16){var u=a.deletions;if(u!==null){for(var p=0;p<u.length;p++){var h=u[p];for(tt=h;tt!==null;){var g=tt;switch(g.tag){case 0:case 11:case 15:Oc(8,g,a)}var f=g.child;if(f!==null)f.return=g,tt=f;else for(;tt!==null;){g=tt;var _=g.sibling,w=g.return;if(by(g),g===h){tt=null;break}if(_!==null){_.return=w,tt=_;break}tt=w}}}var C=a.alternate;if(C!==null){var R=C.child;if(R!==null){C.child=null;do{var S=R.sibling;R.sibling=null,R=S}while(R!==null)}}tt=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,tt=o;else e:for(;tt!==null;){if(a=tt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Oc(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,tt=b;break e}tt=a.return}}var x=e.current;for(tt=x;tt!==null;){o=tt;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,tt=E;else e:for(o=x;tt!==null;){if(u=tt,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Ud(9,u)}}catch(Z){kn(u,u.return,Z)}if(u===o){tt=null;break e}var M=u.sibling;if(M!==null){M.return=u.return,tt=M;break e}tt=u.return}}if(zt=i,ca(),Zi&&typeof Zi.onPostCommitFiberRoot=="function")try{Zi.onPostCommitFiberRoot(Fd,e)}catch{}r=!0}return r}finally{Yt=n,hi.transition=t}}return!1}function Iv(e,t,n){t=Ao(n,t),t=ly(e,t,1),e=Xs(e,t,1),t=Tr(),e!==null&&(_l(e,1,t),qr(e,t))}function kn(e,t,n){if(e.tag===3)Iv(e,e,n);else for(;t!==null;){if(t.tag===3){Iv(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Qs===null||!Qs.has(r))){e=Ao(n,e),e=uy(t,e,1),t=Xs(t,e,1),e=Tr(),t!==null&&(_l(t,1,e),qr(t,e));break}}t=t.return}}function Iw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Tr(),e.pingedLanes|=e.suspendedLanes&n,Kn===e&&(er&n)===n&&(Un===4||Un===3&&(er&130023424)===er&&500>An()-Nm?Fa(e,0):Dm|=n),qr(e,t)}function Ay(e,t){t===0&&(e.mode&1?(t=eu,eu<<=1,!(eu&130023424)&&(eu=4194304)):t=1);var n=Tr();e=_s(e,t),e!==null&&(_l(e,t,n),qr(e,n))}function Fw(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ay(e,n)}function Dw(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(He(314))}r!==null&&r.delete(t),Ay(e,n)}var Iy;Iy=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Hr.current)Ur=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ur=!1,bw(e,t,n);Ur=!!(e.flags&131072)}else Ur=!1,pn&&t.flags&1048576&&O0(t,id,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ku(e,t),e=t.pendingProps;var i=Po(t,mr.current);So(t,n),i=km(null,t,r,e,i,n);var a=Tm();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vr(r)?(a=!0,nd(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,wm(t),i.updater=Bd,t.stateNode=i,i._reactInternals=t,ff(t,r,e,n),t=vf(null,t,r,!0,a,n)):(t.tag=0,pn&&a&&mm(t),Cr(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ku(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Ow(r),e=xi(r,e),i){case 0:t=gf(null,t,r,e,n);break e;case 1:t=Sv(null,t,r,e,n);break e;case 11:t=_v(null,t,r,e,n);break e;case 14:t=bv(null,t,r,xi(r.type,e),n);break e}throw Error(He(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xi(r,i),gf(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xi(r,i),Sv(e,t,r,i,n);case 3:e:{if(fy(t),e===null)throw Error(He(387));r=t.pendingProps,a=t.memoizedState,i=a.element,H0(e,t),od(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Ao(Error(He(423)),t),t=wv(e,t,r,n,i);break e}else if(r!==i){i=Ao(Error(He(424)),t),t=wv(e,t,r,n,i);break e}else for(Zr=Zs(t.stateNode.containerInfo.firstChild),Xr=t,pn=!0,Pi=null,n=B0(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ko(),r===i){t=bs(e,t,n);break e}Cr(e,t,r,n)}t=t.child}return t;case 5:return V0(t),e===null&&df(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,af(r,i)?o=null:a!==null&&af(r,a)&&(t.flags|=32),py(e,t),Cr(e,t,o,n),t.child;case 6:return e===null&&df(t),null;case 13:return my(e,t,n);case 4:return xm(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=To(t,null,r,n):Cr(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xi(r,i),_v(e,t,r,i,n);case 7:return Cr(e,t,t.pendingProps,n),t.child;case 8:return Cr(e,t,t.pendingProps.children,n),t.child;case 12:return Cr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,sn(sd,r._currentValue),r._currentValue=o,a!==null)if(Di(a.value,o)){if(a.children===i.children&&!Hr.current){t=bs(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var u=a.dependencies;if(u!==null){o=a.child;for(var p=u.firstContext;p!==null;){if(p.context===r){if(a.tag===1){p=gs(-1,n&-n),p.tag=2;var h=a.updateQueue;if(h!==null){h=h.shared;var g=h.pending;g===null?p.next=p:(p.next=g.next,g.next=p),h.pending=p}}a.lanes|=n,p=a.alternate,p!==null&&(p.lanes|=n),hf(a.return,n,t),u.lanes|=n;break}p=p.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(He(341));o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),hf(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Cr(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,So(t,n),i=pi(i),r=r(i),t.flags|=1,Cr(e,t,r,n),t.child;case 14:return r=t.type,i=xi(r,t.pendingProps),i=xi(r.type,i),bv(e,t,r,i,n);case 15:return dy(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xi(r,i),ku(e,t),t.tag=1,Vr(r)?(e=!0,nd(t)):e=!1,So(t,n),cy(t,r,i),ff(t,r,i,n),vf(null,t,r,!0,e,n);case 19:return gy(e,t,n);case 22:return hy(e,t,n)}throw Error(He(156,t.tag))};function Fy(e,t){return s0(e,t)}function Nw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(e,t,n,r){return new Nw(e,t,n,r)}function jm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ow(e){if(typeof e=="function")return jm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rm)return 11;if(e===im)return 14}return 2}function ea(e,t){var n=e.alternate;return n===null?(n=di(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Au(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")jm(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case no:return Da(n.children,i,a,t);case nm:o=8,i|=8;break;case Lp:return e=di(12,n,t,i|2),e.elementType=Lp,e.lanes=a,e;case jp:return e=di(13,n,t,i),e.elementType=jp,e.lanes=a,e;case Bp:return e=di(19,n,t,i),e.elementType=Bp,e.lanes=a,e;case V1:return Vd(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case U1:o=10;break e;case H1:o=9;break e;case rm:o=11;break e;case im:o=14;break e;case Us:o=16,r=null;break e}throw Error(He(130,e==null?e:typeof e,""))}return t=di(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function Da(e,t,n,r){return e=di(7,e,r,t),e.lanes=n,e}function Vd(e,t,n,r){return e=di(22,e,r,t),e.elementType=V1,e.lanes=n,e.stateNode={isHidden:!1},e}function mp(e,t,n){return e=di(6,e,null,t),e.lanes=n,e}function gp(e,t,n){return t=di(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Mw(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zh(0),this.expirationTimes=Zh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bm(e,t,n,r,i,a,o,u,p){return e=new Mw(e,t,n,u,p),t===1?(t=1,a===!0&&(t|=8)):t=0,a=di(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},wm(a),e}function Lw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:to,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Dy(e){if(!e)return na;e=e._reactInternals;e:{if(Ka(e)!==e||e.tag!==1)throw Error(He(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(He(171))}if(e.tag===1){var n=e.type;if(Vr(n))return D0(e,n,t)}return t}function Ny(e,t,n,r,i,a,o,u,p){return e=Bm(n,r,!0,e,i,a,o,u,p),e.context=Dy(null),n=e.current,r=Tr(),i=Ys(n),a=gs(r,i),a.callback=t??null,Xs(n,a,i),e.current.lanes=i,_l(e,i,r),qr(e,r),e}function qd(e,t,n,r){var i=t.current,a=Tr(),o=Ys(i);return n=Dy(n),t.context===null?t.context=n:t.pendingContext=n,t=gs(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Xs(i,t,o),e!==null&&(Ai(e,i,o,a),Cu(e,i,o)),o}function md(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Fv(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Um(e,t){Fv(e,t),(e=e.alternate)&&Fv(e,t)}function jw(){return null}var Oy=typeof reportError=="function"?reportError:function(e){console.error(e)};function Hm(e){this._internalRoot=e}zd.prototype.render=Hm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(He(409));qd(e,t,null,null)};zd.prototype.unmount=Hm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ua(function(){qd(null,e,null,null)}),t[ys]=null}};function zd(e){this._internalRoot=e}zd.prototype.unstable_scheduleHydration=function(e){if(e){var t=h0();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Vs.length&&t!==0&&t<Vs[n].priority;n++);Vs.splice(n,0,e),n===0&&f0(e)}};function Vm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Kd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dv(){}function Bw(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var h=md(o);a.call(h)}}var o=Ny(t,r,e,0,null,!1,!1,"",Dv);return e._reactRootContainer=o,e[ys]=o.current,Wc(e.nodeType===8?e.parentNode:e),Ua(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var h=md(p);u.call(h)}}var p=Bm(e,0,!1,null,null,!1,!1,"",Dv);return e._reactRootContainer=p,e[ys]=p.current,Wc(e.nodeType===8?e.parentNode:e),Ua(function(){qd(t,p,n,r)}),p}function $d(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var u=i;i=function(){var p=md(o);u.call(p)}}qd(t,o,e,i)}else o=Bw(n,t,e,i,r);return md(o)}u0=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Pc(t.pendingLanes);n!==0&&(om(t,n|1),qr(t,An()),!(zt&6)&&(Io=An()+500,ca()))}break;case 13:Ua(function(){var r=_s(e,1);if(r!==null){var i=Tr();Ai(r,e,1,i)}}),Um(e,1)}};cm=function(e){if(e.tag===13){var t=_s(e,134217728);if(t!==null){var n=Tr();Ai(t,e,134217728,n)}Um(e,134217728)}};d0=function(e){if(e.tag===13){var t=Ys(e),n=_s(e,t);if(n!==null){var r=Tr();Ai(n,e,t,r)}Um(e,t)}};h0=function(){return Yt};p0=function(e,t){var n=Yt;try{return Yt=e,t()}finally{Yt=n}};Jp=function(e,t,n){switch(t){case"input":if(Vp(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Md(r);if(!i)throw Error(He(90));z1(r),Vp(r,i)}}}break;case"textarea":$1(e,n);break;case"select":t=n.value,t!=null&&vo(e,!!n.multiple,t,!1)}};Y1=Om;e0=Ua;var Uw={usingClientEntryPoint:!1,Events:[Sl,ao,Md,X1,Q1,Om]},fc={findFiberByHostInstance:Ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Hw={bundleType:fc.bundleType,version:fc.version,rendererPackageName:fc.rendererPackageName,rendererConfig:fc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=r0(e),e===null?null:e.stateNode},findFiberByHostInstance:fc.findFiberByHostInstance||jw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!du.isDisabled&&du.supportsFiber)try{Fd=du.inject(Hw),Zi=du}catch{}}Yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Uw;Yr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vm(t))throw Error(He(200));return Lw(e,t,null,n)};Yr.createRoot=function(e,t){if(!Vm(e))throw Error(He(299));var n=!1,r="",i=Oy;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Bm(e,1,!1,null,null,n,!1,r,i),e[ys]=t.current,Wc(e.nodeType===8?e.parentNode:e),new Hm(t)};Yr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(He(188)):(e=Object.keys(e).join(","),Error(He(268,e)));return e=r0(t),e=e===null?null:e.stateNode,e};Yr.flushSync=function(e){return Ua(e)};Yr.hydrate=function(e,t,n){if(!Kd(t))throw Error(He(200));return $d(null,e,t,!0,n)};Yr.hydrateRoot=function(e,t,n){if(!Vm(e))throw Error(He(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=Oy;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Ny(t,null,e,1,n??null,i,!1,a,o),e[ys]=t.current,Wc(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new zd(t)};Yr.render=function(e,t,n){if(!Kd(t))throw Error(He(200));return $d(null,e,t,!1,n)};Yr.unmountComponentAtNode=function(e){if(!Kd(e))throw Error(He(40));return e._reactRootContainer?(Ua(function(){$d(null,null,e,!1,function(){e._reactRootContainer=null,e[ys]=null})}),!0):!1};Yr.unstable_batchedUpdates=Om;Yr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Kd(n))throw Error(He(200));if(e==null||e._reactInternals===void 0)throw Error(He(38));return $d(e,t,n,!1,r)};Yr.version="18.3.1-next-f1338f8080-20240426";function My(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(My)}catch(e){console.error(e)}}My(),M1.exports=Yr;var Vw=M1.exports,Ly,Nv=Vw;Ly=Nv.createRoot,Nv.hydrateRoot;(function(){function e(K){var ee=0;return function(){return ee<K.length?{done:!1,value:K[ee++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(K,ee,ae){return K==Array.prototype||K==Object.prototype||(K[ee]=ae.value),K};function n(K){K=[typeof globalThis=="object"&&globalThis,K,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ti=="object"&&Ti];for(var ee=0;ee<K.length;++ee){var ae=K[ee];if(ae&&ae.Math==Math)return ae}throw Error("Cannot find global object")}var r=n(this);function i(K,ee){if(ee)e:{var ae=r;K=K.split(".");for(var le=0;le<K.length-1;le++){var ne=K[le];if(!(ne in ae))break e;ae=ae[ne]}K=K[K.length-1],le=ae[K],ee=ee(le),ee!=le&&ee!=null&&t(ae,K,{configurable:!0,writable:!0,value:ee})}}i("Symbol",function(K){function ee(Re){if(this instanceof ee)throw new TypeError("Symbol is not a constructor");return new ae(le+(Re||"")+"_"+ne++,Re)}function ae(Re,ve){this.g=Re,t(this,"description",{configurable:!0,writable:!0,value:ve})}if(K)return K;ae.prototype.toString=function(){return this.g};var le="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ne=0;return ee}),i("Symbol.iterator",function(K){if(K)return K;K=Symbol("Symbol.iterator");for(var ee="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),ae=0;ae<ee.length;ae++){var le=r[ee[ae]];typeof le=="function"&&typeof le.prototype[K]!="function"&&t(le.prototype,K,{configurable:!0,writable:!0,value:function(){return a(e(this))}})}return K});function a(K){return K={next:K},K[Symbol.iterator]=function(){return this},K}function o(K){var ee=typeof Symbol<"u"&&Symbol.iterator&&K[Symbol.iterator];return ee?ee.call(K):{next:e(K)}}function u(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function p(K){if(K.i)throw new TypeError("Generator is already running");K.i=!0}u.prototype.l=function(K){this.o=K};function h(K,ee){K.h={F:ee,G:!0},K.j=K.m}u.prototype.return=function(K){this.h={return:K},this.j=this.m};function g(K){this.g=new u,this.h=K}function f(K,ee){p(K.g);var ae=K.g.g;return ae?_(K,"return"in ae?ae.return:function(le){return{value:le,done:!0}},ee,K.g.return):(K.g.return(ee),w(K))}function _(K,ee,ae,le){try{var ne=ee.call(K.g.g,ae);if(!(ne instanceof Object))throw new TypeError("Iterator result "+ne+" is not an object");if(!ne.done)return K.g.i=!1,ne;var Re=ne.value}catch(ve){return K.g.g=null,h(K.g,ve),w(K)}return K.g.g=null,le.call(K.g,Re),w(K)}function w(K){for(;K.g.j;)try{var ee=K.h(K.g);if(ee)return K.g.i=!1,{value:ee.value,done:!1}}catch(ae){K.g.o=void 0,h(K.g,ae)}if(K.g.i=!1,K.g.h){if(ee=K.g.h,K.g.h=null,ee.G)throw ee.F;return{value:ee.return,done:!0}}return{value:void 0,done:!0}}function C(K){this.next=function(ee){return p(K.g),K.g.g?ee=_(K,K.g.g.next,ee,K.g.l):(K.g.l(ee),ee=w(K)),ee},this.throw=function(ee){return p(K.g),K.g.g?ee=_(K,K.g.g.throw,ee,K.g.l):(h(K.g,ee),ee=w(K)),ee},this.return=function(ee){return f(K,ee)},this[Symbol.iterator]=function(){return this}}function R(K){function ee(le){return K.next(le)}function ae(le){return K.throw(le)}return new Promise(function(le,ne){function Re(ve){ve.done?le(ve.value):Promise.resolve(ve.value).then(ee,ae).then(Re,ne)}Re(K.next())})}i("Promise",function(K){function ee(ve){this.h=0,this.i=void 0,this.g=[],this.o=!1;var _e=this.j();try{ve(_e.resolve,_e.reject)}catch(we){_e.reject(we)}}function ae(){this.g=null}function le(ve){return ve instanceof ee?ve:new ee(function(_e){_e(ve)})}if(K)return K;ae.prototype.h=function(ve){if(this.g==null){this.g=[];var _e=this;this.i(function(){_e.l()})}this.g.push(ve)};var ne=r.setTimeout;ae.prototype.i=function(ve){ne(ve,0)},ae.prototype.l=function(){for(;this.g&&this.g.length;){var ve=this.g;this.g=[];for(var _e=0;_e<ve.length;++_e){var we=ve[_e];ve[_e]=null;try{we()}catch(Ee){this.j(Ee)}}}this.g=null},ae.prototype.j=function(ve){this.i(function(){throw ve})},ee.prototype.j=function(){function ve(Ee){return function(fe){we||(we=!0,Ee.call(_e,fe))}}var _e=this,we=!1;return{resolve:ve(this.A),reject:ve(this.l)}},ee.prototype.A=function(ve){if(ve===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(ve instanceof ee)this.C(ve);else{e:switch(typeof ve){case"object":var _e=ve!=null;break e;case"function":_e=!0;break e;default:_e=!1}_e?this.v(ve):this.m(ve)}},ee.prototype.v=function(ve){var _e=void 0;try{_e=ve.then}catch(we){this.l(we);return}typeof _e=="function"?this.D(_e,ve):this.m(ve)},ee.prototype.l=function(ve){this.u(2,ve)},ee.prototype.m=function(ve){this.u(1,ve)},ee.prototype.u=function(ve,_e){if(this.h!=0)throw Error("Cannot settle("+ve+", "+_e+"): Promise already settled in state"+this.h);this.h=ve,this.i=_e,this.h===2&&this.B(),this.H()},ee.prototype.B=function(){var ve=this;ne(function(){if(ve.I()){var _e=r.console;typeof _e<"u"&&_e.error(ve.i)}},1)},ee.prototype.I=function(){if(this.o)return!1;var ve=r.CustomEvent,_e=r.Event,we=r.dispatchEvent;return typeof we>"u"?!0:(typeof ve=="function"?ve=new ve("unhandledrejection",{cancelable:!0}):typeof _e=="function"?ve=new _e("unhandledrejection",{cancelable:!0}):(ve=r.document.createEvent("CustomEvent"),ve.initCustomEvent("unhandledrejection",!1,!0,ve)),ve.promise=this,ve.reason=this.i,we(ve))},ee.prototype.H=function(){if(this.g!=null){for(var ve=0;ve<this.g.length;++ve)Re.h(this.g[ve]);this.g=null}};var Re=new ae;return ee.prototype.C=function(ve){var _e=this.j();ve.s(_e.resolve,_e.reject)},ee.prototype.D=function(ve,_e){var we=this.j();try{ve.call(_e,we.resolve,we.reject)}catch(Ee){we.reject(Ee)}},ee.prototype.then=function(ve,_e){function we(Ce,je){return typeof Ce=="function"?function($e){try{Ee(Ce($e))}catch(et){fe(et)}}:je}var Ee,fe,ce=new ee(function(Ce,je){Ee=Ce,fe=je});return this.s(we(ve,Ee),we(_e,fe)),ce},ee.prototype.catch=function(ve){return this.then(void 0,ve)},ee.prototype.s=function(ve,_e){function we(){switch(Ee.h){case 1:ve(Ee.i);break;case 2:_e(Ee.i);break;default:throw Error("Unexpected state: "+Ee.h)}}var Ee=this;this.g==null?Re.h(we):this.g.push(we),this.o=!0},ee.resolve=le,ee.reject=function(ve){return new ee(function(_e,we){we(ve)})},ee.race=function(ve){return new ee(function(_e,we){for(var Ee=o(ve),fe=Ee.next();!fe.done;fe=Ee.next())le(fe.value).s(_e,we)})},ee.all=function(ve){var _e=o(ve),we=_e.next();return we.done?le([]):new ee(function(Ee,fe){function ce($e){return function(et){Ce[$e]=et,je--,je==0&&Ee(Ce)}}var Ce=[],je=0;do Ce.push(void 0),je++,le(we.value).s(ce(Ce.length-1),fe),we=_e.next();while(!we.done)})},ee});var S=typeof Object.assign=="function"?Object.assign:function(K,ee){for(var ae=1;ae<arguments.length;ae++){var le=arguments[ae];if(le)for(var ne in le)Object.prototype.hasOwnProperty.call(le,ne)&&(K[ne]=le[ne])}return K};i("Object.assign",function(K){return K||S});var b=this||self,x={facingMode:"user",width:640,height:480};function E(K,ee){this.video=K,this.i=0,this.h=Object.assign(Object.assign({},x),ee)}E.prototype.stop=function(){var K=this,ee,ae,le,ne;return R(new C(new g(function(Re){if(K.g){for(ee=K.g.getTracks(),ae=o(ee),le=ae.next();!le.done;le=ae.next())ne=le.value,ne.stop();K.g=void 0}Re.j=0})))},E.prototype.start=function(){var K=this,ee;return R(new C(new g(function(ae){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),ee=K.h,ae.return(navigator.mediaDevices.getUserMedia({video:{facingMode:ee.facingMode,width:ee.width,height:ee.height}}).then(function(le){Z(K,le)}).catch(function(le){var ne="Failed to acquire camera feed: "+le;throw console.error(ne),alert(ne),le}))})))};function M(K){window.requestAnimationFrame(function(){$(K)})}function Z(K,ee){K.g=ee,K.video.srcObject=ee,K.video.onloadedmetadata=function(){K.video.play(),M(K)}}function $(K){var ee=null;K.video.paused||K.video.currentTime===K.i||(K.i=K.video.currentTime,ee=K.h.onFrame()),ee?ee.then(function(){M(K)}):M(K)}var z=["Camera"],q=b;z[0]in q||typeof q.execScript>"u"||q.execScript("var "+z[0]);for(var Q;z.length&&(Q=z.shift());)z.length||E===void 0?q[Q]&&q[Q]!==Object.prototype[Q]?q=q[Q]:q=q[Q]={}:q[Q]=E}).call(Ti);var qw=Camera;(function(){var e;function t(I){var B=0;return function(){return B<I.length?{done:!1,value:I[B++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(I,B,V){return I==Array.prototype||I==Object.prototype||(I[B]=V.value),I};function r(I){I=[typeof globalThis=="object"&&globalThis,I,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ti=="object"&&Ti];for(var B=0;B<I.length;++B){var V=I[B];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")}var i=r(this);function a(I,B){if(B)e:{var V=i;I=I.split(".");for(var oe=0;oe<I.length-1;oe++){var be=I[oe];if(!(be in V))break e;V=V[be]}I=I[I.length-1],oe=V[I],B=B(oe),B!=oe&&B!=null&&n(V,I,{configurable:!0,writable:!0,value:B})}}a("Symbol",function(I){function B(xe){if(this instanceof B)throw new TypeError("Symbol is not a constructor");return new V(oe+(xe||"")+"_"+be++,xe)}function V(xe,Te){this.g=xe,n(this,"description",{configurable:!0,writable:!0,value:Te})}if(I)return I;V.prototype.toString=function(){return this.g};var oe="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",be=0;return B}),a("Symbol.iterator",function(I){if(I)return I;I=Symbol("Symbol.iterator");for(var B="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),V=0;V<B.length;V++){var oe=i[B[V]];typeof oe=="function"&&typeof oe.prototype[I]!="function"&&n(oe.prototype,I,{configurable:!0,writable:!0,value:function(){return o(t(this))}})}return I});function o(I){return I={next:I},I[Symbol.iterator]=function(){return this},I}function u(I){var B=typeof Symbol<"u"&&Symbol.iterator&&I[Symbol.iterator];return B?B.call(I):{next:t(I)}}function p(I){if(!(I instanceof Array)){I=u(I);for(var B,V=[];!(B=I.next()).done;)V.push(B.value);I=V}return I}var h=typeof Object.create=="function"?Object.create:function(I){function B(){}return B.prototype=I,new B},g;if(typeof Object.setPrototypeOf=="function")g=Object.setPrototypeOf;else{var f;e:{var _={a:!0},w={};try{w.__proto__=_,f=w.a;break e}catch{}f=!1}g=f?function(I,B){if(I.__proto__=B,I.__proto__!==B)throw new TypeError(I+" is not extensible");return I}:null}var C=g;function R(I,B){if(I.prototype=h(B.prototype),I.prototype.constructor=I,C)C(I,B);else for(var V in B)if(V!="prototype")if(Object.defineProperties){var oe=Object.getOwnPropertyDescriptor(B,V);oe&&Object.defineProperty(I,V,oe)}else I[V]=B[V];I.ea=B.prototype}function S(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function b(I){if(I.l)throw new TypeError("Generator is already running");I.l=!0}S.prototype.o=function(I){this.h=I};function x(I,B){I.j={U:B,V:!0},I.g=I.m||I.s}S.prototype.return=function(I){this.j={return:I},this.g=this.s};function E(I,B,V){return I.g=V,{value:B}}function M(I){this.g=new S,this.h=I}function Z(I,B){b(I.g);var V=I.g.i;return V?$(I,"return"in V?V.return:function(oe){return{value:oe,done:!0}},B,I.g.return):(I.g.return(B),z(I))}function $(I,B,V,oe){try{var be=B.call(I.g.i,V);if(!(be instanceof Object))throw new TypeError("Iterator result "+be+" is not an object");if(!be.done)return I.g.l=!1,be;var xe=be.value}catch(Te){return I.g.i=null,x(I.g,Te),z(I)}return I.g.i=null,oe.call(I.g,xe),z(I)}function z(I){for(;I.g.g;)try{var B=I.h(I.g);if(B)return I.g.l=!1,{value:B.value,done:!1}}catch(V){I.g.h=void 0,x(I.g,V)}if(I.g.l=!1,I.g.j){if(B=I.g.j,I.g.j=null,B.V)throw B.U;return{value:B.return,done:!0}}return{value:void 0,done:!0}}function q(I){this.next=function(B){return b(I.g),I.g.i?B=$(I,I.g.i.next,B,I.g.o):(I.g.o(B),B=z(I)),B},this.throw=function(B){return b(I.g),I.g.i?B=$(I,I.g.i.throw,B,I.g.o):(x(I.g,B),B=z(I)),B},this.return=function(B){return Z(I,B)},this[Symbol.iterator]=function(){return this}}function Q(I,B){return B=new q(new M(B)),C&&I.prototype&&C(B,I.prototype),B}function K(I,B){I instanceof String&&(I+="");var V=0,oe=!1,be={next:function(){if(!oe&&V<I.length){var xe=V++;return{value:B(xe,I[xe]),done:!1}}return oe=!0,{done:!0,value:void 0}}};return be[Symbol.iterator]=function(){return be},be}var ee=typeof Object.assign=="function"?Object.assign:function(I,B){for(var V=1;V<arguments.length;V++){var oe=arguments[V];if(oe)for(var be in oe)Object.prototype.hasOwnProperty.call(oe,be)&&(I[be]=oe[be])}return I};a("Object.assign",function(I){return I||ee}),a("Promise",function(I){function B(Te){this.h=0,this.i=void 0,this.g=[],this.o=!1;var De=this.j();try{Te(De.resolve,De.reject)}catch(Ve){De.reject(Ve)}}function V(){this.g=null}function oe(Te){return Te instanceof B?Te:new B(function(De){De(Te)})}if(I)return I;V.prototype.h=function(Te){if(this.g==null){this.g=[];var De=this;this.i(function(){De.l()})}this.g.push(Te)};var be=i.setTimeout;V.prototype.i=function(Te){be(Te,0)},V.prototype.l=function(){for(;this.g&&this.g.length;){var Te=this.g;this.g=[];for(var De=0;De<Te.length;++De){var Ve=Te[De];Te[De]=null;try{Ve()}catch(Xe){this.j(Xe)}}}this.g=null},V.prototype.j=function(Te){this.i(function(){throw Te})},B.prototype.j=function(){function Te(Xe){return function(mt){Ve||(Ve=!0,Xe.call(De,mt))}}var De=this,Ve=!1;return{resolve:Te(this.C),reject:Te(this.l)}},B.prototype.C=function(Te){if(Te===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(Te instanceof B)this.F(Te);else{e:switch(typeof Te){case"object":var De=Te!=null;break e;case"function":De=!0;break e;default:De=!1}De?this.u(Te):this.m(Te)}},B.prototype.u=function(Te){var De=void 0;try{De=Te.then}catch(Ve){this.l(Ve);return}typeof De=="function"?this.G(De,Te):this.m(Te)},B.prototype.l=function(Te){this.s(2,Te)},B.prototype.m=function(Te){this.s(1,Te)},B.prototype.s=function(Te,De){if(this.h!=0)throw Error("Cannot settle("+Te+", "+De+"): Promise already settled in state"+this.h);this.h=Te,this.i=De,this.h===2&&this.D(),this.A()},B.prototype.D=function(){var Te=this;be(function(){if(Te.B()){var De=i.console;typeof De<"u"&&De.error(Te.i)}},1)},B.prototype.B=function(){if(this.o)return!1;var Te=i.CustomEvent,De=i.Event,Ve=i.dispatchEvent;return typeof Ve>"u"?!0:(typeof Te=="function"?Te=new Te("unhandledrejection",{cancelable:!0}):typeof De=="function"?Te=new De("unhandledrejection",{cancelable:!0}):(Te=i.document.createEvent("CustomEvent"),Te.initCustomEvent("unhandledrejection",!1,!0,Te)),Te.promise=this,Te.reason=this.i,Ve(Te))},B.prototype.A=function(){if(this.g!=null){for(var Te=0;Te<this.g.length;++Te)xe.h(this.g[Te]);this.g=null}};var xe=new V;return B.prototype.F=function(Te){var De=this.j();Te.J(De.resolve,De.reject)},B.prototype.G=function(Te,De){var Ve=this.j();try{Te.call(De,Ve.resolve,Ve.reject)}catch(Xe){Ve.reject(Xe)}},B.prototype.then=function(Te,De){function Ve(ot,bt){return typeof ot=="function"?function(st){try{Xe(ot(st))}catch(gt){mt(gt)}}:bt}var Xe,mt,Kt=new B(function(ot,bt){Xe=ot,mt=bt});return this.J(Ve(Te,Xe),Ve(De,mt)),Kt},B.prototype.catch=function(Te){return this.then(void 0,Te)},B.prototype.J=function(Te,De){function Ve(){switch(Xe.h){case 1:Te(Xe.i);break;case 2:De(Xe.i);break;default:throw Error("Unexpected state: "+Xe.h)}}var Xe=this;this.g==null?xe.h(Ve):this.g.push(Ve),this.o=!0},B.resolve=oe,B.reject=function(Te){return new B(function(De,Ve){Ve(Te)})},B.race=function(Te){return new B(function(De,Ve){for(var Xe=u(Te),mt=Xe.next();!mt.done;mt=Xe.next())oe(mt.value).J(De,Ve)})},B.all=function(Te){var De=u(Te),Ve=De.next();return Ve.done?oe([]):new B(function(Xe,mt){function Kt(st){return function(gt){ot[st]=gt,bt--,bt==0&&Xe(ot)}}var ot=[],bt=0;do ot.push(void 0),bt++,oe(Ve.value).J(Kt(ot.length-1),mt),Ve=De.next();while(!Ve.done)})},B}),a("Object.is",function(I){return I||function(B,V){return B===V?B!==0||1/B===1/V:B!==B&&V!==V}}),a("Array.prototype.includes",function(I){return I||function(B,V){var oe=this;oe instanceof String&&(oe=String(oe));var be=oe.length;for(V=V||0,0>V&&(V=Math.max(V+be,0));V<be;V++){var xe=oe[V];if(xe===B||Object.is(xe,B))return!0}return!1}}),a("String.prototype.includes",function(I){return I||function(B,V){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(B instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(B,V||0)!==-1}}),a("Array.prototype.keys",function(I){return I||function(){return K(this,function(B){return B})}});var ae=this||self;function le(I,B){I=I.split(".");var V=ae;I[0]in V||typeof V.execScript>"u"||V.execScript("var "+I[0]);for(var oe;I.length&&(oe=I.shift());)I.length||B===void 0?V[oe]&&V[oe]!==Object.prototype[oe]?V=V[oe]:V=V[oe]={}:V[oe]=B}function ne(I,B){return B=String.fromCharCode.apply(null,B),I==null?B:I+B}var Re,ve=typeof TextDecoder<"u",_e,we=typeof TextEncoder<"u";function Ee(I){if(we)I=(_e||(_e=new TextEncoder)).encode(I);else{var B=void 0;B=B===void 0?!1:B;for(var V=0,oe=new Uint8Array(3*I.length),be=0;be<I.length;be++){var xe=I.charCodeAt(be);if(128>xe)oe[V++]=xe;else{if(2048>xe)oe[V++]=xe>>6|192;else{if(55296<=xe&&57343>=xe){if(56319>=xe&&be<I.length){var Te=I.charCodeAt(++be);if(56320<=Te&&57343>=Te){xe=1024*(xe-55296)+Te-56320+65536,oe[V++]=xe>>18|240,oe[V++]=xe>>12&63|128,oe[V++]=xe>>6&63|128,oe[V++]=xe&63|128;continue}else be--}if(B)throw Error("Found an unpaired surrogate");xe=65533}oe[V++]=xe>>12|224,oe[V++]=xe>>6&63|128}oe[V++]=xe&63|128}}I=oe.subarray(0,V)}return I}var fe={},ce=null;function Ce(I,B){B===void 0&&(B=0),et(),B=fe[B];for(var V=Array(Math.floor(I.length/3)),oe=B[64]||"",be=0,xe=0;be<I.length-2;be+=3){var Te=I[be],De=I[be+1],Ve=I[be+2],Xe=B[Te>>2];Te=B[(Te&3)<<4|De>>4],De=B[(De&15)<<2|Ve>>6],Ve=B[Ve&63],V[xe++]=Xe+Te+De+Ve}switch(Xe=0,Ve=oe,I.length-be){case 2:Xe=I[be+1],Ve=B[(Xe&15)<<2]||oe;case 1:I=I[be],V[xe]=B[I>>2]+B[(I&3)<<4|Xe>>4]+Ve+oe}return V.join("")}function je(I){var B=I.length,V=3*B/4;V%3?V=Math.floor(V):"=.".indexOf(I[B-1])!=-1&&(V="=.".indexOf(I[B-2])!=-1?V-2:V-1);var oe=new Uint8Array(V),be=0;return $e(I,function(xe){oe[be++]=xe}),oe.subarray(0,be)}function $e(I,B){function V(Ve){for(;oe<I.length;){var Xe=I.charAt(oe++),mt=ce[Xe];if(mt!=null)return mt;if(!/^[\s\xa0]*$/.test(Xe))throw Error("Unknown base64 encoding at char: "+Xe)}return Ve}et();for(var oe=0;;){var be=V(-1),xe=V(0),Te=V(64),De=V(64);if(De===64&&be===-1)break;B(be<<2|xe>>4),Te!=64&&(B(xe<<4&240|Te>>2),De!=64&&B(Te<<6&192|De))}}function et(){if(!ce){ce={};for(var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),B=["+/=","+/","-_=","-_.","-_"],V=0;5>V;V++){var oe=I.concat(B[V].split(""));fe[V]=oe;for(var be=0;be<oe.length;be++){var xe=oe[be];ce[xe]===void 0&&(ce[xe]=be)}}}}var it=typeof Uint8Array.prototype.slice=="function",ze;function Ge(I,B,V){return B===V?ze||(ze=new Uint8Array(0)):it?I.slice(B,V):new Uint8Array(I.subarray(B,V))}var Le=0,Je=0;function Tt(I,B){B=B===void 0?{}:B,B=B.v===void 0?!1:B.v,this.h=null,this.g=this.j=this.l=0,this.m=!1,this.v=B,I&&Ir(this,I)}function Ir(I,B){B=B.constructor===Uint8Array?B:B.constructor===ArrayBuffer?new Uint8Array(B):B.constructor===Array?new Uint8Array(B):B.constructor===String?je(B):B instanceof Uint8Array?new Uint8Array(B.buffer,B.byteOffset,B.byteLength):new Uint8Array(0),I.h=B,I.l=0,I.j=I.h.length,I.g=I.l}Tt.prototype.reset=function(){this.g=this.l};function nr(I){for(var B=128,V=0,oe=0,be=0;4>be&&128<=B;be++)B=I.h[I.g++],V|=(B&127)<<7*be;if(128<=B&&(B=I.h[I.g++],V|=(B&127)<<28,oe|=(B&127)>>4),128<=B)for(be=0;5>be&&128<=B;be++)B=I.h[I.g++],oe|=(B&127)<<7*be+3;if(128>B)return I=V>>>0,B=oe>>>0,(oe=B&2147483648)&&(I=~I+1>>>0,B=~B>>>0,I==0&&(B=B+1>>>0)),I=4294967296*B+(I>>>0),oe?-I:I;I.m=!0}Tt.prototype.i=function(){var I=this.h,B=I[this.g],V=B&127;return 128>B?(this.g+=1,V):(B=I[this.g+1],V|=(B&127)<<7,128>B?(this.g+=2,V):(B=I[this.g+2],V|=(B&127)<<14,128>B?(this.g+=3,V):(B=I[this.g+3],V|=(B&127)<<21,128>B?(this.g+=4,V):(B=I[this.g+4],V|=(B&15)<<28,128>B?(this.g+=5,V>>>0):(this.g+=5,128<=I[this.g++]&&128<=I[this.g++]&&128<=I[this.g++]&&128<=I[this.g++]&&this.g++,V)))))},Tt.prototype.o=function(){var I=this.h[this.g],B=this.h[this.g+1],V=this.h[this.g+2],oe=this.h[this.g+3];return this.g+=4,V=(I<<0|B<<8|V<<16|oe<<24)>>>0,I=2*(V>>31)+1,B=V>>>23&255,V&=8388607,B==255?V?NaN:1/0*I:B==0?I*Math.pow(2,-149)*V:I*Math.pow(2,B-150)*(V+Math.pow(2,23))};var Bi=[];function fn(){this.g=new Uint8Array(64),this.h=0}fn.prototype.push=function(I){if(!(this.h+1<this.g.length)){var B=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(B)}this.g[this.h++]=I},fn.prototype.length=function(){return this.h},fn.prototype.end=function(){var I=this.g,B=this.h;return this.h=0,Ge(I,0,B)};function rr(I,B){for(;127<B;)I.push(B&127|128),B>>>=7;I.push(B)}function gr(I){var B={},V=B.N===void 0?!1:B.N;this.o={v:B.v===void 0?!1:B.v},this.N=V,B=this.o,Bi.length?(V=Bi.pop(),B&&(V.v=B.v),I&&Ir(V,I),I=V):I=new Tt(I,B),this.g=I,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}gr.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};function In(I){var B=I.g;if((B=B.g==B.j)||(B=I.j)||(B=I.g,B=B.m||0>B.g||B.g>B.j),B)return!1;I.m=I.g.g,B=I.g.i();var V=B&7;return V!=0&&V!=5&&V!=1&&V!=2&&V!=3&&V!=4?(I.j=!0,!1):(I.i=B,I.l=B>>>3,I.h=V,!0)}function ir(I){switch(I.h){case 0:if(I.h!=0)ir(I);else{for(I=I.g;I.h[I.g]&128;)I.g++;I.g++}break;case 1:I.h!=1?ir(I):(I=I.g,I.g+=8);break;case 2:if(I.h!=2)ir(I);else{var B=I.g.i();I=I.g,I.g+=B}break;case 5:I.h!=5?ir(I):(I=I.g,I.g+=4);break;case 3:B=I.l;do{if(!In(I)){I.j=!0;break}if(I.h==4){I.l!=B&&(I.j=!0);break}ir(I)}while(!0);break;default:I.j=!0}}function $n(I,B,V){var oe=I.g.j,be=I.g.i(),xe=I.g.g+be;if(I.g.j=xe,V(B,I),V=xe-I.g.g,V!==0)throw Error("Message parsing ended unexpectedly. Expected to read "+be+" bytes, instead read "+(be-V)+" bytes, either the data ended unexpectedly or the message misreported its own length");return I.g.g=xe,I.g.j=oe,B}function an(I){return I.g.o()}function vr(I){var B=I.g.i();I=I.g;var V=I.g;I.g+=B,I=I.h;var oe;if(ve)(oe=Re)||(oe=Re=new TextDecoder("utf-8",{fatal:!1})),oe=oe.decode(I.subarray(V,V+B));else{B=V+B;for(var be=[],xe=null,Te,De,Ve;V<B;)Te=I[V++],128>Te?be.push(Te):224>Te?V>=B?be.push(65533):(De=I[V++],194>Te||(De&192)!==128?(V--,be.push(65533)):be.push((Te&31)<<6|De&63)):240>Te?V>=B-1?be.push(65533):(De=I[V++],(De&192)!==128||Te===224&&160>De||Te===237&&160<=De||((oe=I[V++])&192)!==128?(V--,be.push(65533)):be.push((Te&15)<<12|(De&63)<<6|oe&63)):244>=Te?V>=B-2?be.push(65533):(De=I[V++],(De&192)!==128||(Te<<28)+(De-144)>>30||((oe=I[V++])&192)!==128||((Ve=I[V++])&192)!==128?(V--,be.push(65533)):(Te=(Te&7)<<18|(De&63)<<12|(oe&63)<<6|Ve&63,Te-=65536,be.push((Te>>10&1023)+55296,(Te&1023)+56320))):be.push(65533),8192<=be.length&&(xe=ne(xe,be),be.length=0);oe=ne(xe,be)}return oe}function mn(I,B,V){var oe=I.g.i();for(oe=I.g.g+oe;I.g.g<oe;)V.push(B.call(I.g))}function sr(I,B){I.h==2?mn(I,Tt.prototype.o,B):B.push(an(I))}function yr(){this.h=[],this.i=0,this.g=new fn}function ht(I,B){B.length!==0&&(I.h.push(B),I.i+=B.length)}function _t(I){var B=I.i+I.g.length();if(B===0)return new Uint8Array(0);B=new Uint8Array(B);for(var V=I.h,oe=V.length,be=0,xe=0;xe<oe;xe++){var Te=V[xe];Te.length!==0&&(B.set(Te,be),be+=Te.length)}return V=I.g,oe=V.h,oe!==0&&(B.set(V.g.subarray(0,oe),be),V.h=0),I.h=[B],B}function ct(I,B,V){if(V!=null){rr(I.g,8*B+5),I=I.g;var oe=V;oe=(V=0>oe?1:0)?-oe:oe,oe===0?0<1/oe?Le=Je=0:(Je=0,Le=2147483648):isNaN(oe)?(Je=0,Le=2147483647):34028234663852886e22<oe?(Je=0,Le=(V<<31|2139095040)>>>0):11754943508222875e-54>oe?(oe=Math.round(oe/Math.pow(2,-149)),Je=0,Le=(V<<31|oe)>>>0):(B=Math.floor(Math.log(oe)/Math.LN2),oe*=Math.pow(2,-B),oe=Math.round(8388608*oe),16777216<=oe&&++B,Je=0,Le=(V<<31|B+127<<23|oe&8388607)>>>0),V=Le,I.push(V>>>0&255),I.push(V>>>8&255),I.push(V>>>16&255),I.push(V>>>24&255)}}var $t=typeof Uint8Array=="function";function Fr(I,B,V){if(I!=null)return typeof I=="object"?$t&&I instanceof Uint8Array?V(I):_r(I,B,V):B(I)}function _r(I,B,V){if(Array.isArray(I)){for(var oe=Array(I.length),be=0;be<I.length;be++)oe[be]=Fr(I[be],B,V);return Array.isArray(I)&&I.W&&Hn(oe),oe}oe={};for(be in I)oe[be]=Fr(I[be],B,V);return oe}function Vt(I){return typeof I=="number"?isFinite(I)?I:String(I):I}var pt={W:{value:!0,configurable:!0}};function Hn(I){return Array.isArray(I)&&!Object.isFrozen(I)&&Object.defineProperties(I,pt),I}var Ps;function gn(I,B,V){var oe=Ps;Ps=null,I||(I=oe),oe=this.constructor.ca,I||(I=oe?[oe]:[]),this.j=oe?0:-1,this.m=this.g=null,this.h=I;e:{if(oe=this.h.length,I=oe-1,oe&&(oe=this.h[I],!(oe===null||typeof oe!="object"||Array.isArray(oe)||$t&&oe instanceof Uint8Array))){this.l=I-this.j,this.i=oe;break e}B!==void 0&&-1<B?(this.l=Math.max(B,I+1-this.j),this.i=null):this.l=Number.MAX_VALUE}if(V)for(B=0;B<V.length;B++)I=V[B],I<this.l?(I+=this.j,(oe=this.h[I])?Hn(oe):this.h[I]=Wa):(Rl(this),(oe=this.i[I])?Hn(oe):this.i[I]=Wa)}var Wa=Object.freeze(Hn([]));function Rl(I){var B=I.l+I.j;I.h[B]||(I.i=I.h[B]={})}function rn(I,B,V){return B===-1?null:V!==void 0&&V||B>=I.l?I.i?I.i[B]:void 0:I.h[B+I.j]}function ks(I,B){var V=V===void 0?!1:V,oe=rn(I,B,V);return oe==null&&(oe=Wa),oe===Wa&&(oe=Hn([]),It(I,B,oe,V)),oe}function Al(I){var B=ks(I,3);if(I.m||(I.m={}),!I.m[3]){for(var V=0;V<B.length;V++)B[V]=+B[V];I.m[3]=!0}return B}function Ui(I,B,V){return I=rn(I,B),I??V}function ri(I,B,V){return I=rn(I,B),I=I==null?I:+I,I??(V===void 0?0:V)}function It(I,B,V,oe){oe!==void 0&&oe||B>=I.l?(Rl(I),I.i[B]=V):I.h[B+I.j]=V}function Il(I,B,V){if(V===-1)return null;if(I.g||(I.g={}),!I.g[V]){var oe=rn(I,V,!1);oe&&(I.g[V]=new B(oe))}return I.g[V]}function Ga(I,B){I.g||(I.g={});var V=I.g[1];if(!V){var oe=ks(I,1);V=[];for(var be=0;be<oe.length;be++)V[be]=new B(oe[be]);I.g[1]=V}return V}function Fl(I,B,V){var oe=oe===void 0?!1:oe;I.g||(I.g={});var be=V&&ts(V);I.g[B]=V,It(I,B,be,oe)}function Dl(I,B,V,oe){var be=Ga(I,V);B=B||new V,I=ks(I,1),oe!=null?(be.splice(oe,0,B),I.splice(oe,0,ts(B))):(be.push(B),I.push(ts(B)))}gn.prototype.toJSON=function(){var I=ts(this);return _r(I,Vt,Ce)};function ts(I,B){if(I.g)for(var V in I.g){var oe=I.g[V];if(Array.isArray(oe))for(var be=0;be<oe.length;be++)oe[be]&&ts(oe[be]);else oe&&ts(oe)}return I.h}gn.prototype.toString=function(){return ts(this).toString()};function $o(I,B){if(I=I.o){ht(B,B.g.end());for(var V=0;V<I.length;V++)ht(B,I[V])}}function Hi(I,B){if(B.h==4)return!1;var V=B.m;return ir(B),B.N||(B=Ge(B.g.h,V,B.g.g),(V=I.o)?V.push(B):I.o=[B]),!0}function ns(I){gn.call(this,I,-1,gh)}R(ns,gn),ns.prototype.getRows=function(){return rn(this,1)},ns.prototype.getCols=function(){return rn(this,2)},ns.prototype.getPackedDataList=function(){return Al(this)},ns.prototype.getLayout=function(){return Ui(this,4,0)};function mh(I,B){for(;In(B);)switch(B.i){case 8:var V=B.g.i();It(I,1,V);break;case 16:V=B.g.i(),It(I,2,V);break;case 29:case 26:sr(B,I.getPackedDataList());break;case 32:V=nr(B.g),It(I,4,V);break;default:if(!Hi(I,B))return I}return I}var gh=[3];function Wn(I,B){var V=void 0;return new(V||(V=Promise))(function(oe,be){function xe(Ve){try{De(B.next(Ve))}catch(Xe){be(Xe)}}function Te(Ve){try{De(B.throw(Ve))}catch(Xe){be(Xe)}}function De(Ve){Ve.done?oe(Ve.value):new V(function(Xe){Xe(Ve.value)}).then(xe,Te)}De((B=B.apply(I,void 0)).next())})}function da(I){gn.call(this,I)}R(da,gn);function vh(I,B){for(;In(B);)switch(B.i){case 8:var V=B.g.i();It(I,1,V);break;case 21:V=an(B),It(I,2,V);break;case 26:V=vr(B),It(I,3,V);break;case 34:V=vr(B),It(I,4,V);break;default:if(!Hi(I,B))return I}return I}function Wo(I){gn.call(this,I,-1,yh)}R(Wo,gn),Wo.prototype.addClassification=function(I,B){return Dl(this,I,da,B),this};var yh=[1];function Ts(I){gn.call(this,I)}R(Ts,gn);function _h(I,B){for(;In(B);)switch(B.i){case 13:var V=an(B);It(I,1,V);break;case 21:V=an(B),It(I,2,V);break;case 29:V=an(B),It(I,3,V);break;case 37:V=an(B),It(I,4,V);break;case 45:V=an(B),It(I,5,V);break;default:if(!Hi(I,B))return I}return I}function Nl(I){gn.call(this,I,-1,bh)}R(Nl,gn);function Ol(I){e:{var B=new Nl;for(I=new gr(I);In(I);)switch(I.i){case 10:var V=$n(I,new Ts,_h);Dl(B,V,Ts,void 0);break;default:if(!Hi(B,I))break e}}return B}var bh=[1];function Go(I){gn.call(this,I)}R(Go,gn);function rs(I){gn.call(this,I,-1,ha)}R(rs,gn),rs.prototype.getVertexType=function(){return Ui(this,1,0)},rs.prototype.getPrimitiveType=function(){return Ui(this,2,0)},rs.prototype.getVertexBufferList=function(){return Al(this)},rs.prototype.getIndexBufferList=function(){return ks(this,4)};function Sh(I,B){for(;In(B);)switch(B.i){case 8:var V=nr(B.g);It(I,1,V);break;case 16:V=nr(B.g),It(I,2,V);break;case 29:case 26:sr(B,I.getVertexBufferList());break;case 32:case 34:V=B;var oe=I.getIndexBufferList();V.h==2?mn(V,Tt.prototype.i,oe):oe.push(V.g.i());break;default:if(!Hi(I,B))return I}return I}var ha=[3,4];function pa(I){gn.call(this,I)}R(pa,gn),pa.prototype.getMesh=function(){return Il(this,rs,1)},pa.prototype.getPoseTransformMatrix=function(){return Il(this,ns,2)};function wh(I){e:{var B=new pa;for(I=new gr(I);In(I);)switch(I.i){case 10:var V=$n(I,new rs,Sh);Fl(B,1,V);break;case 18:V=$n(I,new ns,mh),Fl(B,2,V);break;default:if(!Hi(B,I))break e}}return B}function Ml(I,B,V){if(V=I.createShader(V===0?I.VERTEX_SHADER:I.FRAGMENT_SHADER),I.shaderSource(V,B),I.compileShader(V),!I.getShaderParameter(V,I.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+I.getShaderInfoLog(V));return V}function xh(I){return Ga(I,da).map(function(B){return{index:Ui(B,1,0),Y:ri(B,2),label:rn(B,3)!=null?Ui(B,3,""):void 0,displayName:rn(B,4)!=null?Ui(B,4,""):void 0}})}function Ll(I){return{x:ri(I,1),y:ri(I,2),z:ri(I,3),visibility:rn(I,4)!=null?ri(I,4):void 0}}function Jo(I,B){this.h=I,this.g=B,this.l=0}function is(I,B,V){return Ch(I,B),typeof I.g.canvas.transferToImageBitmap=="function"?Promise.resolve(I.g.canvas.transferToImageBitmap()):V?Promise.resolve(I.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(I.g.canvas):(I.i===void 0&&(I.i=document.createElement("canvas")),new Promise(function(oe){I.i.height=I.g.canvas.height,I.i.width=I.g.canvas.width,I.i.getContext("2d",{}).drawImage(I.g.canvas,0,0,I.g.canvas.width,I.g.canvas.height),oe(I.i)}))}function Ch(I,B){var V=I.g;if(I.m===void 0){var oe=Ml(V,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),be=Ml(V,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),xe=V.createProgram();if(V.attachShader(xe,oe),V.attachShader(xe,be),V.linkProgram(xe),!V.getProgramParameter(xe,V.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+V.getProgramInfoLog(xe));oe=I.m=xe,V.useProgram(oe),be=V.getUniformLocation(oe,"sampler0"),I.j={I:V.getAttribLocation(oe,"aVertex"),H:V.getAttribLocation(oe,"aTex"),da:be},I.s=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,I.s),V.enableVertexAttribArray(I.j.I),V.vertexAttribPointer(I.j.I,2,V.FLOAT,!1,0,0),V.bufferData(V.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null),I.o=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,I.o),V.enableVertexAttribArray(I.j.H),V.vertexAttribPointer(I.j.H,2,V.FLOAT,!1,0,0),V.bufferData(V.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null),V.uniform1i(be,0)}oe=I.j,V.useProgram(I.m),V.canvas.width=B.width,V.canvas.height=B.height,V.viewport(0,0,B.width,B.height),V.activeTexture(V.TEXTURE0),I.h.bindTexture2d(B.glName),V.enableVertexAttribArray(oe.I),V.bindBuffer(V.ARRAY_BUFFER,I.s),V.vertexAttribPointer(oe.I,2,V.FLOAT,!1,0,0),V.enableVertexAttribArray(oe.H),V.bindBuffer(V.ARRAY_BUFFER,I.o),V.vertexAttribPointer(oe.H,2,V.FLOAT,!1,0,0),V.bindFramebuffer(V.DRAW_FRAMEBUFFER?V.DRAW_FRAMEBUFFER:V.FRAMEBUFFER,null),V.clearColor(0,0,0,0),V.clear(V.COLOR_BUFFER_BIT),V.colorMask(!0,!0,!0,!0),V.drawArrays(V.TRIANGLE_FAN,0,4),V.disableVertexAttribArray(oe.I),V.disableVertexAttribArray(oe.H),V.bindBuffer(V.ARRAY_BUFFER,null),I.h.bindTexture2d(0)}function Eh(I){this.g=I}var Ph=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function kh(I,B){return B+I}function jl(I,B){window[I]=B}function Th(I){var B=document.createElement("script");return B.setAttribute("src",I),B.setAttribute("crossorigin","anonymous"),new Promise(function(V){B.addEventListener("load",function(){V()},!1),B.addEventListener("error",function(){V()},!1),document.body.appendChild(B)})}function Rh(){return Wn(this,function I(){return Q(I,function(B){switch(B.g){case 1:return B.m=2,E(B,WebAssembly.instantiate(Ph),4);case 4:B.g=3,B.m=0;break;case 2:return B.m=0,B.j=null,B.return(!1);case 3:return B.return(!0)}})})}function Zo(I){if(this.g=I,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=I&&I.locateFile||kh,typeof window=="object")var B=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")B=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.S=B,I.options){B=u(Object.keys(I.options));for(var V=B.next();!V.done;V=B.next()){V=V.value;var oe=I.options[V].default;oe!==void 0&&(this.j[V]=typeof oe=="function"?oe():oe)}}}e=Zo.prototype,e.close=function(){return this.i&&this.i.delete(),Promise.resolve()};function Ah(I,B){return I.g.files===void 0?[]:typeof I.g.files=="function"?I.g.files(B):I.g.files}function Gn(I){return Wn(I,function B(){var V=this,oe,be,xe,Te,De,Ve,Xe,mt,Kt,ot,bt;return Q(B,function(st){switch(st.g){case 1:return oe=V,V.R?(be=Ah(V,V.j),E(st,Rh(),2)):st.return();case 2:if(xe=st.h,typeof window=="object")return jl("createMediapipeSolutionsWasm",{locateFile:V.locateFile}),jl("createMediapipeSolutionsPackedAssets",{locateFile:V.locateFile}),Ve=be.filter(function(gt){return gt.data!==void 0}),Xe=be.filter(function(gt){return gt.data===void 0}),mt=Promise.all(Ve.map(function(gt){var Ct=Xo(oe,gt.url);if(gt.path!==void 0){var Nt=gt.path;Ct=Ct.then(function(Fn){return oe.overrideFile(Nt,Fn),Promise.resolve(Fn)})}return Ct})),Kt=Promise.all(Xe.map(function(gt){return gt.simd===void 0||gt.simd&&xe||!gt.simd&&!xe?Th(oe.locateFile(gt.url,oe.S)):Promise.resolve()})).then(function(){return Wn(oe,function gt(){var Ct,Nt,Fn=this;return Q(gt,function(Jt){if(Jt.g==1)return Ct=window.createMediapipeSolutionsWasm,Nt=window.createMediapipeSolutionsPackedAssets,E(Jt,Ct(Nt),2);Fn.h=Jt.h,Jt.g=0})})}),ot=function(){return Wn(oe,function gt(){var Ct=this;return Q(gt,function(Nt){return Ct.g.graph&&Ct.g.graph.url?Nt=E(Nt,Xo(Ct,Ct.g.graph.url),0):(Nt.g=0,Nt=void 0),Nt})})}(),E(st,Promise.all([Kt,mt,ot]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return Te=be.filter(function(gt){return gt.simd===void 0||gt.simd&&xe||!gt.simd&&!xe}).map(function(gt){return oe.locateFile(gt.url,oe.S)}),importScripts.apply(null,p(Te)),E(st,createMediapipeSolutionsWasm(Module),6);case 6:V.h=st.h,V.l=new OffscreenCanvas(1,1),V.h.canvas=V.l,De=V.h.GL.createContext(V.l,{antialias:!1,alpha:!1,ba:typeof WebGL2RenderingContext<"u"?2:1}),V.h.GL.makeContextCurrent(De),st.g=4;break;case 7:if(V.l=document.createElement("canvas"),bt=V.l.getContext("webgl2",{}),!bt&&(bt=V.l.getContext("webgl",{}),!bt))return alert("Failed to create WebGL canvas context when passing video frame."),st.return();V.D=bt,V.h.canvas=V.l,V.h.createContext(V.l,!0,!0,{});case 4:V.i=new V.h.SolutionWasm,V.R=!1,st.g=0}})})}function Ih(I){return Wn(I,function B(){var V=this,oe,be,xe,Te,De,Ve,Xe,mt;return Q(B,function(Kt){if(Kt.g==1){if(V.g.graph&&V.g.graph.url&&V.P===V.g.graph.url)return Kt.return();if(V.o=!0,!V.g.graph||!V.g.graph.url){Kt.g=2;return}return V.P=V.g.graph.url,E(Kt,Xo(V,V.g.graph.url),3)}for(Kt.g!=2&&(oe=Kt.h,V.i.loadGraph(oe)),be=u(Object.keys(V.B)),xe=be.next();!xe.done;xe=be.next())Te=xe.value,V.i.overrideFile(Te,V.B[Te]);if(V.B={},V.g.listeners)for(De=u(V.g.listeners),Ve=De.next();!Ve.done;Ve=De.next())Xe=Ve.value,Nh(V,Xe);mt=V.j,V.j={},V.setOptions(mt),Kt.g=0})})}e.reset=function(){return Wn(this,function I(){var B=this;return Q(I,function(V){B.i&&(B.i.reset(),B.m={},B.s={}),V.g=0})})},e.setOptions=function(I,B){var V=this;if(B=B||this.g.options){for(var oe=[],be=[],xe={},Te=u(Object.keys(I)),De=Te.next();!De.done;xe={K:xe.K,L:xe.L},De=Te.next()){var Ve=De.value;Ve in this.j&&this.j[Ve]===I[Ve]||(this.j[Ve]=I[Ve],De=B[Ve],De!==void 0&&(De.onChange&&(xe.K=De.onChange,xe.L=I[Ve],oe.push(function(Xe){return function(){return Wn(V,function mt(){var Kt,ot=this;return Q(mt,function(bt){if(bt.g==1)return E(bt,Xe.K(Xe.L),2);Kt=bt.h,Kt===!0&&(ot.o=!0),bt.g=0})})}}(xe))),De.graphOptionXref&&(Ve={valueNumber:De.type===1?I[Ve]:0,valueBoolean:De.type===0?I[Ve]:!1,valueString:De.type===2?I[Ve]:""},De=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),De.graphOptionXref),Ve),be.push(De))))}(oe.length!==0||be.length!==0)&&(this.o=!0,this.A=(this.A===void 0?[]:this.A).concat(be),this.u=(this.u===void 0?[]:this.u).concat(oe))}};function Fh(I){return Wn(I,function B(){var V=this,oe,be,xe,Te,De,Ve,Xe;return Q(B,function(mt){switch(mt.g){case 1:if(!V.o)return mt.return();if(!V.u){mt.g=2;break}oe=u(V.u),be=oe.next();case 3:if(be.done){mt.g=5;break}return xe=be.value,E(mt,xe(),4);case 4:be=oe.next(),mt.g=3;break;case 5:V.u=void 0;case 2:if(V.A){for(Te=new V.h.GraphOptionChangeRequestList,De=u(V.A),Ve=De.next();!Ve.done;Ve=De.next())Xe=Ve.value,Te.push_back(Xe);V.i.changeOptions(Te),Te.delete(),V.A=void 0}V.o=!1,mt.g=0}})})}e.initialize=function(){return Wn(this,function I(){var B=this;return Q(I,function(V){return V.g==1?E(V,Gn(B),2):V.g!=3?E(V,Ih(B),3):E(V,Fh(B),0)})})};function Xo(I,B){return Wn(I,function V(){var oe=this,be,xe;return Q(V,function(Te){return B in oe.F?Te.return(oe.F[B]):(be=oe.locateFile(B,""),xe=fetch(be).then(function(De){return De.arrayBuffer()}),oe.F[B]=xe,Te.return(xe))})})}e.overrideFile=function(I,B){this.i?this.i.overrideFile(I,B):this.B[I]=B},e.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},e.send=function(I,B){return Wn(this,function V(){var oe=this,be,xe,Te,De,Ve,Xe,mt,Kt,ot;return Q(V,function(bt){switch(bt.g){case 1:return oe.g.inputs?(be=1e3*(B??performance.now()),E(bt,oe.C,2)):bt.return();case 2:return E(bt,oe.initialize(),3);case 3:for(xe=new oe.h.PacketDataList,Te=u(Object.keys(I)),De=Te.next();!De.done;De=Te.next())if(Ve=De.value,Xe=oe.g.inputs[Ve]){e:{var st=oe,gt=I[Ve];switch(Xe.type){case"video":var Ct=st.m[Xe.stream];if(Ct||(Ct=new Jo(st.h,st.D),st.m[Xe.stream]=Ct),st=Ct,st.l===0&&(st.l=st.h.createTexture()),typeof HTMLVideoElement<"u"&&gt instanceof HTMLVideoElement){var Nt=gt.videoWidth;Ct=gt.videoHeight}else typeof HTMLImageElement<"u"&&gt instanceof HTMLImageElement?(Nt=gt.naturalWidth,Ct=gt.naturalHeight):(Nt=gt.width,Ct=gt.height);Ct={glName:st.l,width:Nt,height:Ct},Nt=st.g,Nt.canvas.width=Ct.width,Nt.canvas.height=Ct.height,Nt.activeTexture(Nt.TEXTURE0),st.h.bindTexture2d(st.l),Nt.texImage2D(Nt.TEXTURE_2D,0,Nt.RGBA,Nt.RGBA,Nt.UNSIGNED_BYTE,gt),st.h.bindTexture2d(0),st=Ct;break e;case"detections":for(Ct=st.m[Xe.stream],Ct||(Ct=new Eh(st.h),st.m[Xe.stream]=Ct),st=Ct,st.data||(st.data=new st.g.DetectionListData),st.data.reset(gt.length),Ct=0;Ct<gt.length;++Ct){Nt=gt[Ct];var Fn=st.data,Jt=Fn.setBoundingBox,Jn=Ct,lt=Nt.T,St=new Go;It(St,1,lt.Z),It(St,2,lt.$),It(St,3,lt.height),It(St,4,lt.width),It(St,5,lt.rotation),It(St,6,lt.X);var Lt=lt=new yr;ct(Lt,1,rn(St,1)),ct(Lt,2,rn(St,2)),ct(Lt,3,rn(St,3)),ct(Lt,4,rn(St,4)),ct(Lt,5,rn(St,5));var Ut=rn(St,6);if(Ut!=null&&Ut!=null){rr(Lt.g,48);var Rt=Lt.g,jt=Ut;Ut=0>jt,jt=Math.abs(jt);var Ht=jt>>>0;for(jt=Math.floor((jt-Ht)/4294967296),jt>>>=0,Ut&&(jt=~jt>>>0,Ht=(~Ht>>>0)+1,4294967295<Ht&&(Ht=0,jt++,4294967295<jt&&(jt=0))),Le=Ht,Je=jt,Ut=Le,Ht=Je;0<Ht||127<Ut;)Rt.push(Ut&127|128),Ut=(Ut>>>7|Ht<<25)>>>0,Ht>>>=7;Rt.push(Ut)}if($o(St,Lt),lt=_t(lt),Jt.call(Fn,Jn,lt),Nt.O)for(Fn=0;Fn<Nt.O.length;++Fn)St=Nt.O[Fn],Lt=!!St.visibility,Jt=st.data,Jn=Jt.addNormalizedLandmark,lt=Ct,St=Object.assign(Object.assign({},St),{visibility:Lt?St.visibility:0}),Lt=new Ts,It(Lt,1,St.x),It(Lt,2,St.y),It(Lt,3,St.z),St.visibility&&It(Lt,4,St.visibility),Rt=St=new yr,ct(Rt,1,rn(Lt,1)),ct(Rt,2,rn(Lt,2)),ct(Rt,3,rn(Lt,3)),ct(Rt,4,rn(Lt,4)),ct(Rt,5,rn(Lt,5)),$o(Lt,Rt),St=_t(St),Jn.call(Jt,lt,St);if(Nt.M)for(Fn=0;Fn<Nt.M.length;++Fn){if(Jt=st.data,Jn=Jt.addClassification,lt=Ct,St=Nt.M[Fn],Lt=new da,It(Lt,2,St.Y),St.index&&It(Lt,1,St.index),St.label&&It(Lt,3,St.label),St.displayName&&It(Lt,4,St.displayName),Rt=St=new yr,Ht=rn(Lt,1),Ht!=null&&Ht!=null)if(rr(Rt.g,8),Ut=Rt.g,0<=Ht)rr(Ut,Ht);else{for(jt=0;9>jt;jt++)Ut.push(Ht&127|128),Ht>>=7;Ut.push(1)}ct(Rt,2,rn(Lt,2)),Ut=rn(Lt,3),Ut!=null&&(Ut=Ee(Ut),rr(Rt.g,26),rr(Rt.g,Ut.length),ht(Rt,Rt.g.end()),ht(Rt,Ut)),Ut=rn(Lt,4),Ut!=null&&(Ut=Ee(Ut),rr(Rt.g,34),rr(Rt.g,Ut.length),ht(Rt,Rt.g.end()),ht(Rt,Ut)),$o(Lt,Rt),St=_t(St),Jn.call(Jt,lt,St)}}st=st.data;break e;default:st={}}}switch(mt=st,Kt=Xe.stream,Xe.type){case"video":xe.pushTexture2d(Object.assign(Object.assign({},mt),{stream:Kt,timestamp:be}));break;case"detections":ot=mt,ot.stream=Kt,ot.timestamp=be,xe.pushDetectionList(ot);break;default:throw Error("Unknown input config type: '"+Xe.type+"'")}}return oe.i.send(xe),E(bt,oe.C,4);case 4:xe.delete(),bt.g=0}})})};function Qo(I,B,V){return Wn(I,function oe(){var be,xe,Te,De,Ve,Xe,mt=this,Kt,ot,bt,st,gt,Ct,Nt,Fn;return Q(oe,function(Jt){switch(Jt.g){case 1:if(!V)return Jt.return(B);for(be={},xe=0,Te=u(Object.keys(V)),De=Te.next();!De.done;De=Te.next())Ve=De.value,Xe=V[Ve],typeof Xe!="string"&&Xe.type==="texture"&&B[Xe.stream]!==void 0&&++xe;1<xe&&(mt.G=!1),Kt=u(Object.keys(V)),De=Kt.next();case 2:if(De.done){Jt.g=4;break}if(ot=De.value,bt=V[ot],typeof bt=="string")return Nt=be,Fn=ot,E(Jt,Dh(mt,ot,B[bt]),14);if(st=B[bt.stream],bt.type==="detection_list"){if(st){for(var Jn=st.getRectList(),lt=st.getLandmarksList(),St=st.getClassificationsList(),Lt=[],Ut=0;Ut<Jn.size();++Ut){var Rt=Jn.get(Ut);e:{var jt=new Go;for(Rt=new gr(Rt);In(Rt);)switch(Rt.i){case 13:var Ht=an(Rt);It(jt,1,Ht);break;case 21:Ht=an(Rt),It(jt,2,Ht);break;case 29:Ht=an(Rt),It(jt,3,Ht);break;case 37:Ht=an(Rt),It(jt,4,Ht);break;case 45:Ht=an(Rt),It(jt,5,Ht);break;case 48:Ht=nr(Rt.g),It(jt,6,Ht);break;default:if(!Hi(jt,Rt))break e}}jt={Z:ri(jt,1),$:ri(jt,2),height:ri(jt,3),width:ri(jt,4),rotation:ri(jt,5,0),X:Ui(jt,6,0)},Rt=Ga(Ol(lt.get(Ut)),Ts).map(Ll);var Rs=St.get(Ut);e:for(Ht=new Wo,Rs=new gr(Rs);In(Rs);)switch(Rs.i){case 10:Ht.addClassification($n(Rs,new da,vh));break;default:if(!Hi(Ht,Rs))break e}jt={T:jt,O:Rt,M:xh(Ht)},Lt.push(jt)}Jn=Lt}else Jn=[];be[ot]=Jn,Jt.g=7;break}if(bt.type==="proto_list"){if(st){for(Jn=Array(st.size()),lt=0;lt<st.size();lt++)Jn[lt]=st.get(lt);st.delete()}else Jn=[];be[ot]=Jn,Jt.g=7;break}if(st===void 0){Jt.g=3;break}if(bt.type==="float_list"){be[ot]=st,Jt.g=7;break}if(bt.type==="proto"){be[ot]=st,Jt.g=7;break}if(bt.type!=="texture")throw Error("Unknown output config type: '"+bt.type+"'");return gt=mt.s[ot],gt||(gt=new Jo(mt.h,mt.D),mt.s[ot]=gt),E(Jt,is(gt,st,mt.G),13);case 13:Ct=Jt.h,be[ot]=Ct;case 7:bt.transform&&be[ot]&&(be[ot]=bt.transform(be[ot])),Jt.g=3;break;case 14:Nt[Fn]=Jt.h;case 3:De=Kt.next(),Jt.g=2;break;case 4:return Jt.return(be)}})})}function Dh(I,B,V){return Wn(I,function oe(){var be=this,xe;return Q(oe,function(Te){return typeof V=="number"||V instanceof Uint8Array||V instanceof be.h.Uint8BlobList?Te.return(V):V instanceof be.h.Texture2dDataOut?(xe=be.s[B],xe||(xe=new Jo(be.h,be.D),be.s[B]=xe),Te.return(is(xe,V,be.G))):Te.return(void 0)})})}function Nh(I,B){for(var V=B.name||"$",oe=[].concat(p(B.wants)),be=new I.h.StringList,xe=u(B.wants),Te=xe.next();!Te.done;Te=xe.next())be.push_back(Te.value);xe=I.h.PacketListener.implement({onResults:function(De){for(var Ve={},Xe=0;Xe<B.wants.length;++Xe)Ve[oe[Xe]]=De.get(Xe);var mt=I.listeners[V];mt&&(I.C=Qo(I,Ve,B.outs).then(function(Kt){Kt=mt(Kt);for(var ot=0;ot<B.wants.length;++ot){var bt=Ve[oe[ot]];typeof bt=="object"&&bt.hasOwnProperty&&bt.hasOwnProperty("delete")&&bt.delete()}Kt&&(I.C=Kt)}))}}),I.i.attachMultiListener(be,xe),be.delete()}e.onResults=function(I,B){this.listeners[B||"$"]=I},le("Solution",Zo),le("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"});function Oh(I){I=wh(I);var B=I.getMesh();if(!B)return I;var V=new Float32Array(B.getVertexBufferList());B.getVertexBufferList=function(){return V};var oe=new Uint32Array(B.getIndexBufferList());return B.getIndexBufferList=function(){return oe},I}var Yo={files:[{url:"face_mesh_solution_packed_assets_loader.js"},{simd:!0,url:"face_mesh_solution_simd_wasm_bin.js"},{simd:!1,url:"face_mesh_solution_wasm_bin.js"}],graph:{url:"face_mesh.binarypb"},listeners:[{wants:["multi_face_geometry","image_transformed","multi_face_landmarks"],outs:{image:"image_transformed",multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:function(I){return I.map(Oh)}},multiFaceLandmarks:{type:"proto_list",stream:"multi_face_landmarks",transform:function(I){return I.map(function(B){return Ga(Ol(B),Ts).map(Ll)})}}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumFaces:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorNumFaces",fieldName:"int_value"}},refineLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facelandmarkfrontgpu__facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"facelandmarkfrontgpu__facelandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}},fa=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],ar=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],Tn=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Bl=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Ja=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Dr=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],ec=[].concat(p(fa),p(ar),p(Tn),p(Bl),p(Ja),p(Dr));function Za(I){I=I||{},I=Object.assign(Object.assign({},Yo),I),this.g=new Zo(I)}e=Za.prototype,e.close=function(){return this.g.close(),Promise.resolve()},e.onResults=function(I){this.g.onResults(I)},e.initialize=function(){return Wn(this,function I(){var B=this;return Q(I,function(V){return E(V,B.g.initialize(),0)})})},e.reset=function(){this.g.reset()},e.send=function(I){return Wn(this,function B(){var V=this;return Q(B,function(oe){return E(oe,V.g.send(I),0)})})},e.setOptions=function(I){this.g.setOptions(I)},le("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),le("FaceMesh",Za),le("FACEMESH_LIPS",fa),le("FACEMESH_LEFT_EYE",ar),le("FACEMESH_LEFT_EYEBROW",Tn),le("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),le("FACEMESH_RIGHT_EYE",Bl),le("FACEMESH_RIGHT_EYEBROW",Ja),le("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),le("FACEMESH_FACE_OVAL",Dr),le("FACEMESH_CONTOURS",ec),le("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),le("matrixDataToMatrix",function(I){for(var B=I.getCols(),V=I.getRows(),oe=I.getPackedDataList(),be=[],xe=0;xe<V;xe++)be.push(Array(B));for(xe=0;xe<V;xe++)for(var Te=0;Te<B;Te++){var De=I.getLayout()===1?xe*B+Te:Te*V+xe;be[xe][Te]=oe[De]}return be}),le("VERSION","0.4.1633559619")}).call(Ti);var zw=FaceMesh,Kw=Object.create,Wd=Object.defineProperty,$w=Object.defineProperties,Ww=Object.getOwnPropertyDescriptor,Gw=Object.getOwnPropertyDescriptors,qm=Object.getOwnPropertyNames,Ov=Object.getOwnPropertySymbols,Jw=Object.getPrototypeOf,jy=Object.prototype.hasOwnProperty,Zw=Object.prototype.propertyIsEnumerable,xo=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),zm=e=>{throw TypeError(e)},Ss=Math.pow,Rf=(e,t,n)=>t in e?Wd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ie=(e,t)=>{for(var n in t||(t={}))jy.call(t,n)&&Rf(e,n,t[n]);if(Ov)for(var n of Ov(t))Zw.call(t,n)&&Rf(e,n,t[n]);return e},Se=(e,t)=>$w(e,Gw(t)),Xw=(e,t)=>function(){return e&&(t=(0,e[qm(e)[0]])(e=0)),t},ke=(e,t)=>function(){return t||(0,e[qm(e)[0]])((t={exports:{}}).exports,t),t.exports},By=(e,t)=>{for(var n in t)Wd(e,n,{get:t[n],enumerable:!0})},Qw=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of qm(t))!jy.call(e,i)&&i!==n&&Wd(e,i,{get:()=>t[i],enumerable:!(r=Ww(t,i))||r.enumerable});return e},$r=(e,t,n)=>(n=e!=null?Kw(Jw(e)):{},Qw(!e||!e.__esModule?Wd(n,"default",{value:e,enumerable:!0}):n,e)),me=(e,t,n)=>Rf(e,typeof t!="symbol"?t+"":t,n),Uy=(e,t,n)=>t.has(e)||zm("Cannot "+n),Et=(e,t,n)=>(Uy(e,t,"read from private field"),n?n.call(e):t.get(e)),dr=(e,t,n)=>t.has(e)?zm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),hn=(e,t,n,r)=>(Uy(e,t,"write to private field"),t.set(e,n),n),H=(e,t,n)=>new Promise((r,i)=>{var a=p=>{try{u(n.next(p))}catch(h){i(h)}},o=p=>{try{u(n.throw(p))}catch(h){i(h)}},u=p=>p.done?r(p.value):Promise.resolve(p.value).then(a,o);u((n=n.apply(e,t)).next())}),Fo=function(e,t){this[0]=e,this[1]=t},Hy=(e,t,n)=>{var r=(o,u,p,h)=>{try{var g=n[o](u),f=(u=g.value)instanceof Fo,_=g.done;Promise.resolve(f?u[0]:u).then(w=>f?r(o==="return"?o:"next",u[1]?{done:w.done,value:w.value}:w,p,h):p({value:w,done:_})).catch(w=>r("throw",w,p,h))}catch(w){h(w)}},i=o=>a[o]=u=>new Promise((p,h)=>r(o,u,p,h)),a={};return n=n.apply(e,t),a[xo("asyncIterator")]=()=>a,i("next"),i("throw"),i("return"),a},Vy=e=>{var t=e[xo("asyncIterator")],n=!1,r,i={};return t==null?(t=e[xo("iterator")](),r=a=>i[a]=o=>t[a](o)):(t=t.call(e),r=a=>i[a]=o=>{if(n){if(n=!1,a==="throw")throw o;return o}return n=!0,{done:!1,value:new Fo(new Promise(u=>{var p=t[a](o);p instanceof Object||zm("Object expected"),u(p)}),1)}}),i[xo("iterator")]=()=>i,r("next"),"throw"in t?r("throw"):i.throw=a=>{throw a},"return"in t&&r("return"),i},Yw=(e,t,n)=>(t=e[xo("asyncIterator")])?t.call(e):(e=e[xo("iterator")](),t={},n=(r,i)=>(i=e[r])&&(t[r]=a=>new Promise((o,u,p)=>(a=i.call(e,a),p=a.done,Promise.resolve(a.value).then(h=>o({value:h,done:p}),u)))),n("next"),n("return"),t),Co,Y=Xw({"shims/process.js"(){Co=void 0}}),e4=ke({"../../node_modules/.pnpm/bowser@2.11.0/node_modules/bowser/es5.js"(e,t){Y(),function(n,r){typeof e=="object"&&typeof t=="object"?t.exports=r():typeof define=="function"&&define.amd?define([],r):typeof e=="object"?e.bowser=r():n.bowser=r()}(e,function(){return function(n){var r={};function i(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return n[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(a,o,u){i.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:u})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,o){if(1&o&&(a=i(a)),8&o||4&o&&typeof a=="object"&&a&&a.__esModule)return a;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:a}),2&o&&typeof a!="string")for(var p in a)i.d(u,p,(function(h){return a[h]}).bind(null,p));return u},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=90)}({17:function(n,r,i){r.__esModule=!0,r.default=void 0;var a=i(18),o=function(){function u(){}return u.getFirstMatch=function(p,h){var g=h.match(p);return g&&g.length>0&&g[1]||""},u.getSecondMatch=function(p,h){var g=h.match(p);return g&&g.length>1&&g[2]||""},u.matchAndReturnConst=function(p,h,g){if(p.test(h))return g},u.getWindowsVersionName=function(p){switch(p){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},u.getMacOSVersionName=function(p){var h=p.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(h.push(0),h[0]===10)switch(h[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},u.getAndroidVersionName=function(p){var h=p.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(h.push(0),!(h[0]===1&&h[1]<5))return h[0]===1&&h[1]<6?"Cupcake":h[0]===1&&h[1]>=6?"Donut":h[0]===2&&h[1]<2?"Eclair":h[0]===2&&h[1]===2?"Froyo":h[0]===2&&h[1]>2?"Gingerbread":h[0]===3?"Honeycomb":h[0]===4&&h[1]<1?"Ice Cream Sandwich":h[0]===4&&h[1]<4?"Jelly Bean":h[0]===4&&h[1]>=4?"KitKat":h[0]===5?"Lollipop":h[0]===6?"Marshmallow":h[0]===7?"Nougat":h[0]===8?"Oreo":h[0]===9?"Pie":void 0},u.getVersionPrecision=function(p){return p.split(".").length},u.compareVersions=function(p,h,g){g===void 0&&(g=!1);var f=u.getVersionPrecision(p),_=u.getVersionPrecision(h),w=Math.max(f,_),C=0,R=u.map([p,h],function(S){var b=w-u.getVersionPrecision(S),x=S+new Array(b+1).join(".0");return u.map(x.split("."),function(E){return new Array(20-E.length).join("0")+E}).reverse()});for(g&&(C=w-Math.min(f,_)),w-=1;w>=C;){if(R[0][w]>R[1][w])return 1;if(R[0][w]===R[1][w]){if(w===C)return 0;w-=1}else if(R[0][w]<R[1][w])return-1}},u.map=function(p,h){var g,f=[];if(Array.prototype.map)return Array.prototype.map.call(p,h);for(g=0;g<p.length;g+=1)f.push(h(p[g]));return f},u.find=function(p,h){var g,f;if(Array.prototype.find)return Array.prototype.find.call(p,h);for(g=0,f=p.length;g<f;g+=1){var _=p[g];if(h(_,g))return _}},u.assign=function(p){for(var h,g,f=p,_=arguments.length,w=new Array(_>1?_-1:0),C=1;C<_;C++)w[C-1]=arguments[C];if(Object.assign)return Object.assign.apply(Object,[p].concat(w));var R=function(){var S=w[h];typeof S=="object"&&S!==null&&Object.keys(S).forEach(function(b){f[b]=S[b]})};for(h=0,g=w.length;h<g;h+=1)R();return p},u.getBrowserAlias=function(p){return a.BROWSER_ALIASES_MAP[p]},u.getBrowserTypeByAlias=function(p){return a.BROWSER_MAP[p]||""},u}();r.default=o,n.exports=r.default},18:function(n,r,i){r.__esModule=!0,r.ENGINE_MAP=r.OS_MAP=r.PLATFORMS_MAP=r.BROWSER_MAP=r.BROWSER_ALIASES_MAP=void 0,r.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},r.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},r.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},r.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},r.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(91))&&a.__esModule?a:{default:a},u=i(18);function p(g,f){for(var _=0;_<f.length;_++){var w=f[_];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(g,w.key,w)}}var h=function(){function g(){}var f,_,w;return g.getParser=function(C,R){if(R===void 0&&(R=!1),typeof C!="string")throw new Error("UserAgent should be a string");return new o.default(C,R)},g.parse=function(C){return new o.default(C).getResult()},f=g,w=[{key:"BROWSER_MAP",get:function(){return u.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return u.ENGINE_MAP}},{key:"OS_MAP",get:function(){return u.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return u.PLATFORMS_MAP}}],(_=null)&&p(f.prototype,_),w&&p(f,w),g}();r.default=h,n.exports=r.default},91:function(n,r,i){r.__esModule=!0,r.default=void 0;var a=g(i(92)),o=g(i(93)),u=g(i(94)),p=g(i(95)),h=g(i(17));function g(_){return _&&_.__esModule?_:{default:_}}var f=function(){function _(C,R){if(R===void 0&&(R=!1),C==null||C==="")throw new Error("UserAgent parameter can't be empty");this._ua=C,this.parsedResult={},R!==!0&&this.parse()}var w=_.prototype;return w.getUA=function(){return this._ua},w.test=function(C){return C.test(this._ua)},w.parseBrowser=function(){var C=this;this.parsedResult.browser={};var R=h.default.find(a.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.browser=R.describe(this.getUA())),this.parsedResult.browser},w.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},w.getBrowserName=function(C){return C?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},w.getBrowserVersion=function(){return this.getBrowser().version},w.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},w.parseOS=function(){var C=this;this.parsedResult.os={};var R=h.default.find(o.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.os=R.describe(this.getUA())),this.parsedResult.os},w.getOSName=function(C){var R=this.getOS().name;return C?String(R).toLowerCase()||"":R||""},w.getOSVersion=function(){return this.getOS().version},w.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},w.getPlatformType=function(C){C===void 0&&(C=!1);var R=this.getPlatform().type;return C?String(R).toLowerCase()||"":R||""},w.parsePlatform=function(){var C=this;this.parsedResult.platform={};var R=h.default.find(u.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.platform=R.describe(this.getUA())),this.parsedResult.platform},w.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},w.getEngineName=function(C){return C?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},w.parseEngine=function(){var C=this;this.parsedResult.engine={};var R=h.default.find(p.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.engine=R.describe(this.getUA())),this.parsedResult.engine},w.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},w.getResult=function(){return h.default.assign({},this.parsedResult)},w.satisfies=function(C){var R=this,S={},b=0,x={},E=0;if(Object.keys(C).forEach(function(ee){var ae=C[ee];typeof ae=="string"?(x[ee]=ae,E+=1):typeof ae=="object"&&(S[ee]=ae,b+=1)}),b>0){var M=Object.keys(S),Z=h.default.find(M,function(ee){return R.isOS(ee)});if(Z){var $=this.satisfies(S[Z]);if($!==void 0)return $}var z=h.default.find(M,function(ee){return R.isPlatform(ee)});if(z){var q=this.satisfies(S[z]);if(q!==void 0)return q}}if(E>0){var Q=Object.keys(x),K=h.default.find(Q,function(ee){return R.isBrowser(ee,!0)});if(K!==void 0)return this.compareVersion(x[K])}},w.isBrowser=function(C,R){R===void 0&&(R=!1);var S=this.getBrowserName().toLowerCase(),b=C.toLowerCase(),x=h.default.getBrowserTypeByAlias(b);return R&&x&&(b=x.toLowerCase()),b===S},w.compareVersion=function(C){var R=[0],S=C,b=!1,x=this.getBrowserVersion();if(typeof x=="string")return C[0]===">"||C[0]==="<"?(S=C.substr(1),C[1]==="="?(b=!0,S=C.substr(2)):R=[],C[0]===">"?R.push(1):R.push(-1)):C[0]==="="?S=C.substr(1):C[0]==="~"&&(b=!0,S=C.substr(1)),R.indexOf(h.default.compareVersions(x,S,b))>-1},w.isOS=function(C){return this.getOSName(!0)===String(C).toLowerCase()},w.isPlatform=function(C){return this.getPlatformType(!0)===String(C).toLowerCase()},w.isEngine=function(C){return this.getEngineName(!0)===String(C).toLowerCase()},w.is=function(C,R){return R===void 0&&(R=!1),this.isBrowser(C,R)||this.isOS(C)||this.isPlatform(C)},w.some=function(C){var R=this;return C===void 0&&(C=[]),C.some(function(S){return R.is(S)})},_}();r.default=f,n.exports=r.default},92:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=/version\/(\d+(\.?_?\d+)+)/i,p=[{test:[/googlebot/i],describe:function(h){var g={name:"Googlebot"},f=o.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/opera/i],describe:function(h){var g={name:"Opera"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/opr\/|opios/i],describe:function(h){var g={name:"Opera"},f=o.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/SamsungBrowser/i],describe:function(h){var g={name:"Samsung Internet for Android"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/Whale/i],describe:function(h){var g={name:"NAVER Whale Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/MZBrowser/i],describe:function(h){var g={name:"MZ Browser"},f=o.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/focus/i],describe:function(h){var g={name:"Focus"},f=o.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/swing/i],describe:function(h){var g={name:"Swing"},f=o.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/coast/i],describe:function(h){var g={name:"Opera Coast"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(h){var g={name:"Opera Touch"},f=o.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/yabrowser/i],describe:function(h){var g={name:"Yandex Browser"},f=o.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/ucbrowser/i],describe:function(h){var g={name:"UC Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/Maxthon|mxios/i],describe:function(h){var g={name:"Maxthon"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/epiphany/i],describe:function(h){var g={name:"Epiphany"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/puffin/i],describe:function(h){var g={name:"Puffin"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/sleipnir/i],describe:function(h){var g={name:"Sleipnir"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/k-meleon/i],describe:function(h){var g={name:"K-Meleon"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/micromessenger/i],describe:function(h){var g={name:"WeChat"},f=o.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/qqbrowser/i],describe:function(h){var g={name:/qqbrowserlite/i.test(h)?"QQ Browser Lite":"QQ Browser"},f=o.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/msie|trident/i],describe:function(h){var g={name:"Internet Explorer"},f=o.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/\sedg\//i],describe:function(h){var g={name:"Microsoft Edge"},f=o.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/edg([ea]|ios)/i],describe:function(h){var g={name:"Microsoft Edge"},f=o.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/vivaldi/i],describe:function(h){var g={name:"Vivaldi"},f=o.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/seamonkey/i],describe:function(h){var g={name:"SeaMonkey"},f=o.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/sailfish/i],describe:function(h){var g={name:"Sailfish"},f=o.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,h);return f&&(g.version=f),g}},{test:[/silk/i],describe:function(h){var g={name:"Amazon Silk"},f=o.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/phantom/i],describe:function(h){var g={name:"PhantomJS"},f=o.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/slimerjs/i],describe:function(h){var g={name:"SlimerJS"},f=o.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(h){var g={name:"BlackBerry"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/(web|hpw)[o0]s/i],describe:function(h){var g={name:"WebOS Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/bada/i],describe:function(h){var g={name:"Bada"},f=o.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/tizen/i],describe:function(h){var g={name:"Tizen"},f=o.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/qupzilla/i],describe:function(h){var g={name:"QupZilla"},f=o.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/firefox|iceweasel|fxios/i],describe:function(h){var g={name:"Firefox"},f=o.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/electron/i],describe:function(h){var g={name:"Electron"},f=o.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/MiuiBrowser/i],describe:function(h){var g={name:"Miui"},f=o.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/chromium/i],describe:function(h){var g={name:"Chromium"},f=o.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/chrome|crios|crmo/i],describe:function(h){var g={name:"Chrome"},f=o.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/GSA/i],describe:function(h){var g={name:"Google Search"},f=o.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:function(h){var g=!h.test(/like android/i),f=h.test(/android/i);return g&&f},describe:function(h){var g={name:"Android Browser"},f=o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/playstation 4/i],describe:function(h){var g={name:"PlayStation 4"},f=o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/safari|applewebkit/i],describe:function(h){var g={name:"Safari"},f=o.default.getFirstMatch(u,h);return f&&(g.version=f),g}},{test:[/.*/i],describe:function(h){var g=h.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:o.default.getFirstMatch(g,h),version:o.default.getSecondMatch(g,h)}}}];r.default=p,n.exports=r.default},93:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:[/Roku\/DVP/],describe:function(h){var g=o.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,h);return{name:u.OS_MAP.Roku,version:g}}},{test:[/windows phone/i],describe:function(h){var g=o.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.WindowsPhone,version:g}}},{test:[/windows /i],describe:function(h){var g=o.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,h),f=o.default.getWindowsVersionName(g);return{name:u.OS_MAP.Windows,version:g,versionName:f}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(h){var g={name:u.OS_MAP.iOS},f=o.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,h);return f&&(g.version=f),g}},{test:[/macintosh/i],describe:function(h){var g=o.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,h).replace(/[_\s]/g,"."),f=o.default.getMacOSVersionName(g),_={name:u.OS_MAP.MacOS,version:g};return f&&(_.versionName=f),_}},{test:[/(ipod|iphone|ipad)/i],describe:function(h){var g=o.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,h).replace(/[_\s]/g,".");return{name:u.OS_MAP.iOS,version:g}}},{test:function(h){var g=!h.test(/like android/i),f=h.test(/android/i);return g&&f},describe:function(h){var g=o.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,h),f=o.default.getAndroidVersionName(g),_={name:u.OS_MAP.Android,version:g};return f&&(_.versionName=f),_}},{test:[/(web|hpw)[o0]s/i],describe:function(h){var g=o.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,h),f={name:u.OS_MAP.WebOS};return g&&g.length&&(f.version=g),f}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(h){var g=o.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,h)||o.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,h)||o.default.getFirstMatch(/\bbb(\d+)/i,h);return{name:u.OS_MAP.BlackBerry,version:g}}},{test:[/bada/i],describe:function(h){var g=o.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.Bada,version:g}}},{test:[/tizen/i],describe:function(h){var g=o.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.Tizen,version:g}}},{test:[/linux/i],describe:function(){return{name:u.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:u.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(h){var g=o.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.PlayStation4,version:g}}}];r.default=p,n.exports=r.default},94:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(h){var g=o.default.getFirstMatch(/(can-l01)/i,h)&&"Nova",f={type:u.PLATFORMS_MAP.mobile,vendor:"Huawei"};return g&&(f.model=g),f}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet}}},{test:function(h){var g=h.test(/ipod|iphone/i),f=h.test(/like (ipod|iphone)/i);return g&&!f},describe:function(h){var g=o.default.getFirstMatch(/(ipod|iphone)/i,h);return{type:u.PLATFORMS_MAP.mobile,vendor:"Apple",model:g}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getBrowserName(!0)==="blackberry"},describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(h){return h.getBrowserName(!0)==="bada"},describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getBrowserName()==="windows phone"},describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(h){var g=Number(String(h.getOSVersion()).split(".")[0]);return h.getOSName(!0)==="android"&&g>=3},describe:function(){return{type:u.PLATFORMS_MAP.tablet}}},{test:function(h){return h.getOSName(!0)==="android"},describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getOSName(!0)==="macos"},describe:function(){return{type:u.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(h){return h.getOSName(!0)==="windows"},describe:function(){return{type:u.PLATFORMS_MAP.desktop}}},{test:function(h){return h.getOSName(!0)==="linux"},describe:function(){return{type:u.PLATFORMS_MAP.desktop}}},{test:function(h){return h.getOSName(!0)==="playstation 4"},describe:function(){return{type:u.PLATFORMS_MAP.tv}}},{test:function(h){return h.getOSName(!0)==="roku"},describe:function(){return{type:u.PLATFORMS_MAP.tv}}}];r.default=p,n.exports=r.default},95:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:function(h){return h.getBrowserName(!0)==="microsoft edge"},describe:function(h){if(/\sedg\//i.test(h))return{name:u.ENGINE_MAP.Blink};var g=o.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,h);return{name:u.ENGINE_MAP.EdgeHTML,version:g}}},{test:[/trident/i],describe:function(h){var g={name:u.ENGINE_MAP.Trident},f=o.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:function(h){return h.test(/presto/i)},describe:function(h){var g={name:u.ENGINE_MAP.Presto},f=o.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:function(h){var g=h.test(/gecko/i),f=h.test(/like gecko/i);return g&&!f},describe:function(h){var g={name:u.ENGINE_MAP.Gecko},f=o.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:u.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(h){var g={name:u.ENGINE_MAP.WebKit},f=o.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,h);return f&&(g.version=f),g}}];r.default=p,n.exports=r.default}})})}}),Km=ke({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/grammar.js"(e,t){Y();var n=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(r){return r.encoding?"rtpmap:%d %s/%s/%s":r.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(r){return r.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(r){return r.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(r){return"extmap:%d"+(r.direction?"/%s":"%v")+(r["encrypt-uri"]?" %s":"%v")+" %s"+(r.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(r){return r.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(r){var i="candidate:%s %d %s %d %s %d typ %s";return i+=r.raddr!=null?" raddr %s rport %d":"%v%v",i+=r.tcptype!=null?" tcptype %s":"%v",r.generation!=null&&(i+=" generation %d"),i+=r["network-id"]!=null?" network-id %d":"%v",i+=r["network-cost"]!=null?" network-cost %d":"%v",i}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(r){var i="ssrc:%d";return r.attribute!=null&&(i+=" %s",r.value!=null&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(r){return r.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(r){return r.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(r){return"imageattr:%s %s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(r){return"simulcast:%s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(r){return"ts-refclk:%s"+(r.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(r){var i="mediaclk:";return i+=r.id!=null?"id=%s %s":"%v%s",i+=r.mediaClockValue!=null?"=%s":"",i+=r.rateNumerator!=null?" rate=%s":"",i+=r.rateDenominator!=null?"/%s":"",i}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(r){var i=n[r];i.forEach(function(a){a.reg||(a.reg=/(.*)/),a.format||(a.format="%s")})})}}),t4=ke({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/parser.js"(e){Y();var t=function(u){return String(Number(u))===u?Number(u):u},n=function(u,p,h,g){if(g&&!h)p[g]=t(u[1]);else for(var f=0;f<h.length;f+=1)u[f+1]!=null&&(p[h[f]]=t(u[f+1]))},r=function(u,p,h){var g=u.name&&u.names;u.push&&!p[u.push]?p[u.push]=[]:g&&!p[u.name]&&(p[u.name]={});var f=u.push?{}:g?p[u.name]:p;n(h.match(u.reg),f,u.names,u.name),u.push&&p[u.push].push(f)},i=Km(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(u){var p={},h=[],g=p;return u.split(/(\r\n|\r|\n)/).filter(a).forEach(function(f){var _=f[0],w=f.slice(2);_==="m"&&(h.push({rtp:[],fmtp:[]}),g=h[h.length-1]);for(var C=0;C<(i[_]||[]).length;C+=1){var R=i[_][C];if(R.reg.test(w))return r(R,g,w)}}),p.media=h,p};var o=function(u,p){var h=p.split(/=(.+)/,2);return h.length===2?u[h[0]]=t(h[1]):h.length===1&&p.length>1&&(u[h[0]]=void 0),u};e.parseParams=function(u){return u.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(u){return u.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(u){for(var p=[],h=u.split(" ").map(t),g=0;g<h.length;g+=3)p.push({component:h[g],ip:h[g+1],port:h[g+2]});return p},e.parseImageAttributes=function(u){return u.split(" ").map(function(p){return p.substring(1,p.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(u){return u.split(";").map(function(p){return p.split(",").map(function(h){var g,f=!1;return h[0]!=="~"?g=t(h):(g=t(h.substring(1,h.length)),f=!0),{scid:g,paused:f}})})}}}),n4=ke({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/writer.js"(e,t){Y();var n=Km(),r=/%[sdv%]/g,i=function(p){var h=1,g=arguments,f=g.length;return p.replace(r,function(_){if(h>=f)return _;var w=g[h];switch(h+=1,_){case"%%":return"%";case"%s":return String(w);case"%d":return Number(w);case"%v":return""}})},a=function(p,h,g){var f=h.format instanceof Function?h.format(h.push?g:g[h.name]):h.format,_=[p+"="+f];if(h.names)for(var w=0;w<h.names.length;w+=1){var C=h.names[w];h.name?_.push(g[h.name][C]):_.push(g[h.names[w]])}else _.push(g[h.name]);return i.apply(null,_)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],u=["i","c","b","a"];t.exports=function(p,h){h=h||{},p.version==null&&(p.version=0),p.name==null&&(p.name=" "),p.media.forEach(function(w){w.payloads==null&&(w.payloads="")});var g=h.outerOrder||o,f=h.innerOrder||u,_=[];return g.forEach(function(w){n[w].forEach(function(C){C.name in p&&p[C.name]!=null?_.push(a(w,C,p)):C.push in p&&p[C.push]!=null&&p[C.push].forEach(function(R){_.push(a(w,C,R))})})}),p.media.forEach(function(w){_.push(a("m",n.m[0],w)),f.forEach(function(C){n[C].forEach(function(R){R.name in w&&w[R.name]!=null?_.push(a(C,R,w)):R.push in w&&w[R.push]!=null&&w[R.push].forEach(function(S){_.push(a(C,R,S))})})})}),_.join(`\r
`)+`\r
`}}}),Oi=ke({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/index.js"(e){Y();var t=t4(),n=n4(),r=Km();e.grammar=r,e.write=n,e.parse=t.parse,e.parseParams=t.parseParams,e.parseFmtpConfig=t.parseFmtpConfig,e.parsePayloads=t.parsePayloads,e.parseRemoteCandidates=t.parseRemoteCandidates,e.parseImageAttributes=t.parseImageAttributes,e.parseSimulcastStreamList=t.parseSimulcastStreamList}}),qy=ke({"../../node_modules/.pnpm/ua-parser-js@1.0.40/node_modules/ua-parser-js/src/ua-parser.js"(e,t){Y(),function(n,r){var i="1.0.40",a="",o="?",u="function",p="undefined",h="object",g="string",f="major",_="model",w="name",C="type",R="vendor",S="version",b="architecture",x="console",E="mobile",M="tablet",Z="smarttv",$="wearable",z="embedded",q=500,Q="Amazon",K="Apple",ee="ASUS",ae="BlackBerry",le="Browser",ne="Chrome",Re="Edge",ve="Firefox",_e="Google",we="Huawei",Ee="LG",fe="Microsoft",ce="Motorola",Ce="Opera",je="Samsung",$e="Sharp",et="Sony",it="Xiaomi",ze="Zebra",Ge="Facebook",Le="Chromium OS",Je="Mac OS",Tt=" Browser",Ir=function(ht,_t){var ct={};for(var $t in ht)_t[$t]&&_t[$t].length%2===0?ct[$t]=_t[$t].concat(ht[$t]):ct[$t]=ht[$t];return ct},nr=function(ht){for(var _t={},ct=0;ct<ht.length;ct++)_t[ht[ct].toUpperCase()]=ht[ct];return _t},Bi=function(ht,_t){return typeof ht===g?fn(_t).indexOf(fn(ht))!==-1:!1},fn=function(ht){return ht.toLowerCase()},rr=function(ht){return typeof ht===g?ht.replace(/[^\d\.]/g,a).split(".")[0]:r},gr=function(ht,_t){if(typeof ht===g)return ht=ht.replace(/^\s\s*/,a),typeof _t===p?ht:ht.substring(0,q)},In=function(ht,_t){for(var ct=0,$t,Fr,_r,Vt,pt,Hn;ct<_t.length&&!pt;){var Ps=_t[ct],gn=_t[ct+1];for($t=Fr=0;$t<Ps.length&&!pt&&Ps[$t];)if(pt=Ps[$t++].exec(ht),pt)for(_r=0;_r<gn.length;_r++)Hn=pt[++Fr],Vt=gn[_r],typeof Vt===h&&Vt.length>0?Vt.length===2?typeof Vt[1]==u?this[Vt[0]]=Vt[1].call(this,Hn):this[Vt[0]]=Vt[1]:Vt.length===3?typeof Vt[1]===u&&!(Vt[1].exec&&Vt[1].test)?this[Vt[0]]=Hn?Vt[1].call(this,Hn,Vt[2]):r:this[Vt[0]]=Hn?Hn.replace(Vt[1],Vt[2]):r:Vt.length===4&&(this[Vt[0]]=Hn?Vt[3].call(this,Hn.replace(Vt[1],Vt[2])):r):this[Vt]=Hn||r;ct+=2}},ir=function(ht,_t){for(var ct in _t)if(typeof _t[ct]===h&&_t[ct].length>0){for(var $t=0;$t<_t[ct].length;$t++)if(Bi(_t[ct][$t],ht))return ct===o?r:ct}else if(Bi(_t[ct],ht))return ct===o?r:ct;return _t.hasOwnProperty("*")?_t["*"]:ht},$n={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},an={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},vr={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[S,[w,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[S,[w,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[w,S],[/opios[\/ ]+([\w\.]+)/i],[S,[w,Ce+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[S,[w,Ce+" GX"]],[/\bopr\/([\w\.]+)/i],[S,[w,Ce]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[S,[w,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[S,[w,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[w,S],[/quark(?:pc)?\/([-\w\.]+)/i],[S,[w,"Quark"]],[/\bddg\/([\w\.]+)/i],[S,[w,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[S,[w,"UC"+le]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[S,[w,"WeChat"]],[/konqueror\/([\w\.]+)/i],[S,[w,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[S,[w,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[S,[w,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[S,[w,"Smart Lenovo "+le]],[/(avast|avg)\/([\w\.]+)/i],[[w,/(.+)/,"$1 Secure "+le],S],[/\bfocus\/([\w\.]+)/i],[S,[w,ve+" Focus"]],[/\bopt\/([\w\.]+)/i],[S,[w,Ce+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[S,[w,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[S,[w,"Dolphin"]],[/coast\/([\w\.]+)/i],[S,[w,Ce+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[S,[w,"MIUI"+Tt]],[/fxios\/([\w\.-]+)/i],[S,[w,ve]],[/\bqihoobrowser\/?([\w\.]*)/i],[S,[w,"360"]],[/\b(qq)\/([\w\.]+)/i],[[w,/(.+)/,"$1Browser"],S],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[w,/(.+)/,"$1"+Tt],S],[/samsungbrowser\/([\w\.]+)/i],[S,[w,je+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[S,[w,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[w,"Sogou Mobile"],S],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[w,S],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[w],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[S,w],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[w,Ge],S],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[w,S],[/\bgsa\/([\w\.]+) .*safari\//i],[S,[w,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[S,[w,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[S,[w,ne+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[w,ne+" WebView"],S],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[S,[w,"Android "+le]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[w,S],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[S,[w,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[S,w],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[w,[S,ir,$n]],[/(webkit|khtml)\/([\w\.]+)/i],[w,S],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[w,"Netscape"],S],[/(wolvic|librewolf)\/([\w\.]+)/i],[w,S],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[S,[w,ve+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[w,[S,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[w,[S,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[b,"amd64"]],[/(ia32(?=;))/i],[[b,fn]],[/((?:i[346]|x)86)[;\)]/i],[[b,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[b,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[b,"armhf"]],[/windows (ce|mobile); ppc;/i],[[b,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[b,/ower/,a,fn]],[/(sun4\w)[;\)]/i],[[b,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[b,fn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[_,[R,je],[C,M]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[_,[R,je],[C,E]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[_,[R,K],[C,E]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[_,[R,K],[C,M]],[/(macintosh);/i],[_,[R,K]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[_,[R,$e],[C,E]],[/(?:honor)([-\w ]+)[;\)]/i],[_,[R,"Honor"],[C,E]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[_,[R,we],[C,M]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[_,[R,we],[C,E]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[_,/_/g," "],[R,it],[C,E]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[_,/_/g," "],[R,it],[C,M]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[_,[R,"OPPO"],[C,E]],[/\b(opd2\d{3}a?) bui/i],[_,[R,"OPPO"],[C,M]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[_,[R,"Vivo"],[C,E]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[_,[R,"Realme"],[C,E]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[_,[R,ce],[C,E]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[_,[R,ce],[C,M]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[_,[R,Ee],[C,M]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[_,[R,Ee],[C,E]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[_,[R,"Lenovo"],[C,M]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[_,/_/g," "],[R,"Nokia"],[C,E]],[/(pixel c)\b/i],[_,[R,_e],[C,M]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[_,[R,_e],[C,E]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_,[R,et],[C,E]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[_,"Xperia Tablet"],[R,et],[C,M]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[_,[R,"OnePlus"],[C,E]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[_,[R,Q],[C,M]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[_,/(.+)/g,"Fire Phone $1"],[R,Q],[C,E]],[/(playbook);[-\w\),; ]+(rim)/i],[_,R,[C,M]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[_,[R,ae],[C,E]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[_,[R,ee],[C,M]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[_,[R,ee],[C,E]],[/(nexus 9)/i],[_,[R,"HTC"],[C,M]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[R,[_,/_/g," "],[C,E]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[_,[R,"TCL"],[C,M]],[/(itel) ((\w+))/i],[[R,fn],_,[C,ir,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[_,[R,"Acer"],[C,M]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[_,[R,"Meizu"],[C,E]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[_,[R,"Ulefone"],[C,E]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[_,[R,"Energizer"],[C,E]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[_,[R,"Cat"],[C,E]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[_,[R,"Smartfren"],[C,E]],[/droid.+; (a(?:015|06[35]|142p?))/i],[_,[R,"Nothing"],[C,E]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[R,_,[C,E]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[R,_,[C,M]],[/(surface duo)/i],[_,[R,fe],[C,M]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[_,[R,"Fairphone"],[C,E]],[/(u304aa)/i],[_,[R,"AT&T"],[C,E]],[/\bsie-(\w*)/i],[_,[R,"Siemens"],[C,E]],[/\b(rct\w+) b/i],[_,[R,"RCA"],[C,M]],[/\b(venue[\d ]{2,7}) b/i],[_,[R,"Dell"],[C,M]],[/\b(q(?:mv|ta)\w+) b/i],[_,[R,"Verizon"],[C,M]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[_,[R,"Barnes & Noble"],[C,M]],[/\b(tm\d{3}\w+) b/i],[_,[R,"NuVision"],[C,M]],[/\b(k88) b/i],[_,[R,"ZTE"],[C,M]],[/\b(nx\d{3}j) b/i],[_,[R,"ZTE"],[C,E]],[/\b(gen\d{3}) b.+49h/i],[_,[R,"Swiss"],[C,E]],[/\b(zur\d{3}) b/i],[_,[R,"Swiss"],[C,M]],[/\b((zeki)?tb.*\b) b/i],[_,[R,"Zeki"],[C,M]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[R,"Dragon Touch"],_,[C,M]],[/\b(ns-?\w{0,9}) b/i],[_,[R,"Insignia"],[C,M]],[/\b((nxa|next)-?\w{0,9}) b/i],[_,[R,"NextBook"],[C,M]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[R,"Voice"],_,[C,E]],[/\b(lvtel\-)?(v1[12]) b/i],[[R,"LvTel"],_,[C,E]],[/\b(ph-1) /i],[_,[R,"Essential"],[C,E]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[_,[R,"Envizen"],[C,M]],[/\b(trio[-\w\. ]+) b/i],[_,[R,"MachSpeed"],[C,M]],[/\btu_(1491) b/i],[_,[R,"Rotor"],[C,M]],[/(shield[\w ]+) b/i],[_,[R,"Nvidia"],[C,M]],[/(sprint) (\w+)/i],[R,_,[C,E]],[/(kin\.[onetw]{3})/i],[[_,/\./g," "],[R,fe],[C,E]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[_,[R,ze],[C,M]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[_,[R,ze],[C,E]],[/smart-tv.+(samsung)/i],[R,[C,Z]],[/hbbtv.+maple;(\d+)/i],[[_,/^/,"SmartTV"],[R,je],[C,Z]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[R,Ee],[C,Z]],[/(apple) ?tv/i],[R,[_,K+" TV"],[C,Z]],[/crkey/i],[[_,ne+"cast"],[R,_e],[C,Z]],[/droid.+aft(\w+)( bui|\))/i],[_,[R,Q],[C,Z]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[_,[R,$e],[C,Z]],[/(bravia[\w ]+)( bui|\))/i],[_,[R,et],[C,Z]],[/(mitv-\w{5}) bui/i],[_,[R,it],[C,Z]],[/Hbbtv.*(technisat) (.*);/i],[R,_,[C,Z]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[R,gr],[_,gr],[C,Z]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[C,Z]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[R,_,[C,x]],[/droid.+; (shield) bui/i],[_,[R,"Nvidia"],[C,x]],[/(playstation [345portablevi]+)/i],[_,[R,et],[C,x]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[_,[R,fe],[C,x]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[_,[R,je],[C,$]],[/((pebble))app/i],[R,_,[C,$]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[_,[R,K],[C,$]],[/droid.+; (glass) \d/i],[_,[R,_e],[C,$]],[/droid.+; (wt63?0{2,3})\)/i],[_,[R,ze],[C,$]],[/droid.+; (glass) \d/i],[_,[R,_e],[C,$]],[/(pico) (4|neo3(?: link|pro)?)/i],[R,_,[C,$]],[/; (quest( \d| pro)?)/i],[_,[R,Ge],[C,$]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[R,[C,z]],[/(aeobc)\b/i],[_,[R,Q],[C,z]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[_,[C,E]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[_,[C,M]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[C,M]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[C,E]],[/(android[-\w\. ]{0,9});.+buil/i],[_,[R,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[S,[w,Re+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[w,S],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[S,[w,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[w,S],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[S,w]],os:[[/microsoft (windows) (vista|xp)/i],[w,S],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[w,[S,ir,an]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[S,ir,an],[w,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[S,/_/g,"."],[w,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[w,Je],[S,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[S,w],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[w,S],[/\(bb(10);/i],[S,[w,ae]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[S,[w,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[S,[w,ve+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[S,[w,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[S,[w,"watchOS"]],[/crkey\/([\d\.]+)/i],[S,[w,ne+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[w,Le],S],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[w,S],[/(sunos) ?([\w\.\d]*)/i],[[w,"Solaris"],S],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[w,S]]},mn=function(ht,_t){if(typeof ht===h&&(_t=ht,ht=r),!(this instanceof mn))return new mn(ht,_t).getResult();var ct=typeof n!==p&&n.navigator?n.navigator:r,$t=ht||(ct&&ct.userAgent?ct.userAgent:a),Fr=ct&&ct.userAgentData?ct.userAgentData:r,_r=_t?Ir(vr,_t):vr,Vt=ct&&ct.userAgent==$t;return this.getBrowser=function(){var pt={};return pt[w]=r,pt[S]=r,In.call(pt,$t,_r.browser),pt[f]=rr(pt[S]),Vt&&ct&&ct.brave&&typeof ct.brave.isBrave==u&&(pt[w]="Brave"),pt},this.getCPU=function(){var pt={};return pt[b]=r,In.call(pt,$t,_r.cpu),pt},this.getDevice=function(){var pt={};return pt[R]=r,pt[_]=r,pt[C]=r,In.call(pt,$t,_r.device),Vt&&!pt[C]&&Fr&&Fr.mobile&&(pt[C]=E),Vt&&pt[_]=="Macintosh"&&ct&&typeof ct.standalone!==p&&ct.maxTouchPoints&&ct.maxTouchPoints>2&&(pt[_]="iPad",pt[C]=M),pt},this.getEngine=function(){var pt={};return pt[w]=r,pt[S]=r,In.call(pt,$t,_r.engine),pt},this.getOS=function(){var pt={};return pt[w]=r,pt[S]=r,In.call(pt,$t,_r.os),Vt&&!pt[w]&&Fr&&Fr.platform&&Fr.platform!="Unknown"&&(pt[w]=Fr.platform.replace(/chrome os/i,Le).replace(/macos/i,Je)),pt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return $t},this.setUA=function(pt){return $t=typeof pt===g&&pt.length>q?gr(pt,q):pt,this},this.setUA($t),this};mn.VERSION=i,mn.BROWSER=nr([w,S,f]),mn.CPU=nr([b]),mn.DEVICE=nr([_,R,C,x,E,Z,M,$,z]),mn.ENGINE=mn.OS=nr([w,S]),typeof e!==p?(typeof t!==p&&t.exports&&(e=t.exports=mn),e.UAParser=mn):typeof define===u&&define.amd?define(function(){return mn}):typeof n!==p&&(n.UAParser=mn);var sr=typeof n!==p&&(n.jQuery||n.Zepto);if(sr&&!sr.ua){var yr=new mn;sr.ua=yr.getResult(),sr.ua.get=function(){return yr.getUA()},sr.ua.set=function(ht){yr.setUA(ht);var _t=yr.getResult();for(var ct in _t)sr.ua[ct]=_t[ct]}}}(typeof window=="object"?window:e)}}),r4=ke({"../../node_modules/.pnpm/jsrsasign@11.1.0/node_modules/jsrsasign/lib/jsrsasign.js"(e){Y();var t={};t.userAgent=!1;var n={},r="11.1.0",i="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license",a=a||function(s,c){var l={},d=l.lib={},v=d.Base=function(){function P(){}return{extend:function(D){P.prototype=this;var A=new P;return D&&A.mixIn(D),A.hasOwnProperty("init")||(A.init=function(){A.$super.init.apply(this,arguments)}),A.init.prototype=A,A.$super=this,A},create:function(){var D=this.extend();return D.init.apply(D,arguments),D},init:function(){},mixIn:function(D){for(var A in D)D.hasOwnProperty(A)&&(this[A]=D[A]);D.hasOwnProperty("toString")&&(this.toString=D.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),m=d.WordArray=v.extend({init:function(P,D){P=this.words=P||[],D!=c?this.sigBytes=D:this.sigBytes=P.length*4},toString:function(P){return(P||k).stringify(this)},concat:function(P){var D=this.words,A=P.words,N=this.sigBytes,j=P.sigBytes;if(this.clamp(),N%4)for(var W=0;W<j;W++){var se=A[W>>>2]>>>24-W%4*8&255;D[N+W>>>2]|=se<<24-(N+W)%4*8}else for(var W=0;W<j;W+=4)D[N+W>>>2]=A[W>>>2];return this.sigBytes+=j,this},clamp:function(){var P=this.words,D=this.sigBytes;P[D>>>2]&=4294967295<<32-D%4*8,P.length=s.ceil(D/4)},clone:function(){var P=v.clone.call(this);return P.words=this.words.slice(0),P},random:function(P){for(var D=[],A=0;A<P;A+=4)D.push(s.random()*4294967296|0);return new m.init(D,P)}}),T=l.enc={},k=T.Hex={stringify:function(P){for(var D=P.words,A=P.sigBytes,N=[],j=0;j<A;j++){var W=D[j>>>2]>>>24-j%4*8&255;N.push((W>>>4).toString(16)),N.push((W&15).toString(16))}return N.join("")},parse:function(P){for(var D=P.length,A=[],N=0;N<D;N+=2)A[N>>>3]|=parseInt(P.substr(N,2),16)<<24-N%8*4;return new m.init(A,D/2)}},O=T.Latin1={stringify:function(P){for(var D=P.words,A=P.sigBytes,N=[],j=0;j<A;j++){var W=D[j>>>2]>>>24-j%4*8&255;N.push(String.fromCharCode(W))}return N.join("")},parse:function(P){for(var D=P.length,A=[],N=0;N<D;N++)A[N>>>2]|=(P.charCodeAt(N)&255)<<24-N%4*8;return new m.init(A,D)}},F=T.Utf8={stringify:function(P){try{return decodeURIComponent(escape(O.stringify(P)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(P){return O.parse(unescape(encodeURIComponent(P)))}},U=d.BufferedBlockAlgorithm=v.extend({reset:function(){this._data=new m.init,this._nDataBytes=0},_append:function(P){typeof P=="string"&&(P=F.parse(P)),this._data.concat(P),this._nDataBytes+=P.sigBytes},_process:function(P){var D=this._data,A=D.words,N=D.sigBytes,j=this.blockSize,W=j*4,se=N/W;P?se=s.ceil(se):se=s.max((se|0)-this._minBufferSize,0);var de=se*j,ue=s.min(de*4,N);if(de){for(var pe=0;pe<de;pe+=j)this._doProcessBlock(A,pe);var G=A.splice(0,de);D.sigBytes-=ue}return new m.init(G,ue)},clone:function(){var P=v.clone.call(this);return P._data=this._data.clone(),P},_minBufferSize:0});d.Hasher=U.extend({cfg:v.extend(),init:function(P){this.cfg=this.cfg.extend(P),this.reset()},reset:function(){U.reset.call(this),this._doReset()},update:function(P){return this._append(P),this._process(),this},finalize:function(P){P&&this._append(P);var D=this._doFinalize();return D},blockSize:512/32,_createHelper:function(P){return function(D,A){return new P.init(A).finalize(D)}},_createHmacHelper:function(P){return function(D,A){return new L.HMAC.init(P,A).finalize(D)}}});var L=l.algo={};return l}(Math);(function(s){var v=a,c=v.lib,l=c.Base,d=c.WordArray,v=v.x64={};v.Word=l.extend({init:function(m,T){this.high=m,this.low=T}}),v.WordArray=l.extend({init:function(m,T){m=this.words=m||[],this.sigBytes=T!=s?T:8*m.length},toX32:function(){for(var m=this.words,T=m.length,k=[],O=0;O<T;O++){var F=m[O];k.push(F.high),k.push(F.low)}return d.create(k,this.sigBytes)},clone:function(){for(var m=l.clone.call(this),T=m.words=this.words.slice(0),k=T.length,O=0;O<k;O++)T[O]=T[O].clone();return m}})})(),a.lib.Cipher||function(s){var D=a,c=D.lib,l=c.Base,d=c.WordArray,v=c.BufferedBlockAlgorithm,m=D.enc.Base64,T=D.algo.EvpKDF,k=c.Cipher=v.extend({cfg:l.extend(),createEncryptor:function(N,j){return this.create(this._ENC_XFORM_MODE,N,j)},createDecryptor:function(N,j){return this.create(this._DEC_XFORM_MODE,N,j)},init:function(N,j,W){this.cfg=this.cfg.extend(W),this._xformMode=N,this._key=j,this.reset()},reset:function(){v.reset.call(this),this._doReset()},process:function(N){return this._append(N),this._process()},finalize:function(N){return N&&this._append(N),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(N){return{encrypt:function(j,W,se){return(typeof W=="string"?A:P).encrypt(N,j,W,se)},decrypt:function(j,W,se){return(typeof W=="string"?A:P).decrypt(N,j,W,se)}}}});c.StreamCipher=k.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var L=D.mode={},O=function(N,j,W){var se=this._iv;se?this._iv=s:se=this._prevBlock;for(var de=0;de<W;de++)N[j+de]^=se[de]},F=(c.BlockCipherMode=l.extend({createEncryptor:function(N,j){return this.Encryptor.create(N,j)},createDecryptor:function(N,j){return this.Decryptor.create(N,j)},init:function(N,j){this._cipher=N,this._iv=j}})).extend();F.Encryptor=F.extend({processBlock:function(N,j){var W=this._cipher,se=W.blockSize;O.call(this,N,j,se),W.encryptBlock(N,j),this._prevBlock=N.slice(j,j+se)}}),F.Decryptor=F.extend({processBlock:function(N,j){var W=this._cipher,se=W.blockSize,de=N.slice(j,j+se);W.decryptBlock(N,j),O.call(this,N,j,se),this._prevBlock=de}}),L=L.CBC=F,F=(D.pad={}).Pkcs7={pad:function(N,j){for(var W=4*j,W=W-N.sigBytes%W,se=W<<24|W<<16|W<<8|W,de=[],ue=0;ue<W;ue+=4)de.push(se);W=d.create(de,W),N.concat(W)},unpad:function(N){N.sigBytes-=N.words[N.sigBytes-1>>>2]&255}},c.BlockCipher=k.extend({cfg:k.cfg.extend({mode:L,padding:F}),reset:function(){k.reset.call(this);var j=this.cfg,N=j.iv,j=j.mode;if(this._xformMode==this._ENC_XFORM_MODE)var W=j.createEncryptor;else W=j.createDecryptor,this._minBufferSize=1;this._mode=W.call(j,this,N&&N.words)},_doProcessBlock:function(N,j){this._mode.processBlock(N,j)},_doFinalize:function(){var N=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){N.pad(this._data,this.blockSize);var j=this._process(!0)}else j=this._process(!0),N.unpad(j);return j},blockSize:4});var U=c.CipherParams=l.extend({init:function(N){this.mixIn(N)},toString:function(N){return(N||this.formatter).stringify(this)}}),L=(D.format={}).OpenSSL={stringify:function(N){var j=N.ciphertext;return N=N.salt,(N?d.create([1398893684,1701076831]).concat(N).concat(j):j).toString(m)},parse:function(N){N=m.parse(N);var j=N.words;if(j[0]==1398893684&&j[1]==1701076831){var W=d.create(j.slice(2,4));j.splice(0,4),N.sigBytes-=16}return U.create({ciphertext:N,salt:W})}},P=c.SerializableCipher=l.extend({cfg:l.extend({format:L}),encrypt:function(N,j,W,se){se=this.cfg.extend(se);var de=N.createEncryptor(W,se);return j=de.finalize(j),de=de.cfg,U.create({ciphertext:j,key:W,iv:de.iv,algorithm:N,mode:de.mode,padding:de.padding,blockSize:N.blockSize,formatter:se.format})},decrypt:function(N,j,W,se){return se=this.cfg.extend(se),j=this._parse(j,se.format),N.createDecryptor(W,se).finalize(j.ciphertext)},_parse:function(N,j){return typeof N=="string"?j.parse(N,this):N}}),D=(D.kdf={}).OpenSSL={execute:function(N,j,W,se){return se||(se=d.random(8)),N=T.create({keySize:j+W}).compute(N,se),W=d.create(N.words.slice(j),4*W),N.sigBytes=4*j,U.create({key:N,iv:W,salt:se})}},A=c.PasswordBasedCipher=P.extend({cfg:P.cfg.extend({kdf:D}),encrypt:function(N,j,W,se){return se=this.cfg.extend(se),W=se.kdf.execute(W,N.keySize,N.ivSize),se.iv=W.iv,N=P.encrypt.call(this,N,j,W.key,se),N.mixIn(W),N},decrypt:function(N,j,W,se){return se=this.cfg.extend(se),j=this._parse(j,se.format),W=se.kdf.execute(W,N.keySize,N.ivSize,j.salt),se.iv=W.iv,P.decrypt.call(this,N,j,W.key,se)}})}(),function(){for(var s=a,c=s.lib.BlockCipher,G=s.algo,l=[],d=[],v=[],m=[],T=[],k=[],O=[],F=[],U=[],L=[],P=[],D=0;256>D;D++)P[D]=128>D?D<<1:D<<1^283;for(var A=0,N=0,D=0;256>D;D++){var j=N^N<<1^N<<2^N<<3^N<<4,j=j>>>8^j&255^99;l[A]=j,d[j]=A;var W=P[A],se=P[W],de=P[se],ue=257*P[j]^16843008*j;v[A]=ue<<24|ue>>>8,m[A]=ue<<16|ue>>>16,T[A]=ue<<8|ue>>>24,k[A]=ue,ue=16843009*de^65537*se^257*W^16843008*A,O[j]=ue<<24|ue>>>8,F[j]=ue<<16|ue>>>16,U[j]=ue<<8|ue>>>24,L[j]=ue,A?(A=W^P[P[P[de^W]]],N^=P[P[N]]):A=N=1}var pe=[0,1,2,4,8,16,32,64,128,27,54],G=G.AES=c.extend({_doReset:function(){for(var J=this._key,X=J.words,te=J.sigBytes/4,J=4*((this._nRounds=te+6)+1),re=this._keySchedule=[],he=0;he<J;he++)if(he<te)re[he]=X[he];else{var ye=re[he-1];he%te?6<te&&he%te==4&&(ye=l[ye>>>24]<<24|l[ye>>>16&255]<<16|l[ye>>>8&255]<<8|l[ye&255]):(ye=ye<<8|ye>>>24,ye=l[ye>>>24]<<24|l[ye>>>16&255]<<16|l[ye>>>8&255]<<8|l[ye&255],ye^=pe[he/te|0]<<24),re[he]=re[he-te]^ye}for(X=this._invKeySchedule=[],te=0;te<J;te++)he=J-te,ye=te%4?re[he]:re[he-4],X[te]=4>te||4>=he?ye:O[l[ye>>>24]]^F[l[ye>>>16&255]]^U[l[ye>>>8&255]]^L[l[ye&255]]},encryptBlock:function(X,te){this._doCryptBlock(X,te,this._keySchedule,v,m,T,k,l)},decryptBlock:function(X,te){var J=X[te+1];X[te+1]=X[te+3],X[te+3]=J,this._doCryptBlock(X,te,this._invKeySchedule,O,F,U,L,d),J=X[te+1],X[te+1]=X[te+3],X[te+3]=J},_doCryptBlock:function(X,te,J,re,he,ye,Fe,ge){for(var Pe=this._nRounds,Vn=X[te]^J[0],Zn=X[te+1]^J[1],qn=X[te+2]^J[2],Dn=X[te+3]^J[3],Ne=4,Me=1;Me<Pe;Me++)var cr=re[Vn>>>24]^he[Zn>>>16&255]^ye[qn>>>8&255]^Fe[Dn&255]^J[Ne++],vn=re[Zn>>>24]^he[qn>>>16&255]^ye[Dn>>>8&255]^Fe[Vn&255]^J[Ne++],nn=re[qn>>>24]^he[Dn>>>16&255]^ye[Vn>>>8&255]^Fe[Zn&255]^J[Ne++],Dn=re[Dn>>>24]^he[Vn>>>16&255]^ye[Zn>>>8&255]^Fe[qn&255]^J[Ne++],Vn=cr,Zn=vn,qn=nn;cr=(ge[Vn>>>24]<<24|ge[Zn>>>16&255]<<16|ge[qn>>>8&255]<<8|ge[Dn&255])^J[Ne++],vn=(ge[Zn>>>24]<<24|ge[qn>>>16&255]<<16|ge[Dn>>>8&255]<<8|ge[Vn&255])^J[Ne++],nn=(ge[qn>>>24]<<24|ge[Dn>>>16&255]<<16|ge[Vn>>>8&255]<<8|ge[Zn&255])^J[Ne++],Dn=(ge[Dn>>>24]<<24|ge[Vn>>>16&255]<<16|ge[Zn>>>8&255]<<8|ge[qn&255])^J[Ne++],X[te]=cr,X[te+1]=vn,X[te+2]=nn,X[te+3]=Dn},keySize:8});s.AES=c._createHelper(G)}(),function(){function s(P,D){var A=(this._lBlock>>>P^this._rBlock)&D;this._rBlock^=A,this._lBlock^=A<<P}function c(P,D){var A=(this._rBlock>>>P^this._lBlock)&D;this._lBlock^=A,this._rBlock^=A<<P}var l=a,v=l.lib,d=v.WordArray,v=v.BlockCipher,m=l.algo,T=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],k=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],O=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],F=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],U=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],L=m.DES=v.extend({_doReset:function(){for(var P=this._key.words,D=[],A=0;56>A;A++){var N=T[A]-1;D[A]=P[N>>>5]>>>31-N%32&1}for(P=this._subKeys=[],N=0;16>N;N++){for(var j=P[N]=[],W=O[N],A=0;24>A;A++)j[A/6|0]|=D[(k[A]-1+W)%28]<<31-A%6,j[4+(A/6|0)]|=D[28+(k[A+24]-1+W)%28]<<31-A%6;for(j[0]=j[0]<<1|j[0]>>>31,A=1;7>A;A++)j[A]>>>=4*(A-1)+3;j[7]=j[7]<<5|j[7]>>>27}for(D=this._invSubKeys=[],A=0;16>A;A++)D[A]=P[15-A]},encryptBlock:function(P,D){this._doCryptBlock(P,D,this._subKeys)},decryptBlock:function(P,D){this._doCryptBlock(P,D,this._invSubKeys)},_doCryptBlock:function(P,D,A){this._lBlock=P[D],this._rBlock=P[D+1],s.call(this,4,252645135),s.call(this,16,65535),c.call(this,2,858993459),c.call(this,8,16711935),s.call(this,1,1431655765);for(var N=0;16>N;N++){for(var j=A[N],W=this._lBlock,se=this._rBlock,de=0,ue=0;8>ue;ue++)de|=F[ue][((se^j[ue])&U[ue])>>>0];this._lBlock=se,this._rBlock=W^de}A=this._lBlock,this._lBlock=this._rBlock,this._rBlock=A,s.call(this,1,1431655765),c.call(this,8,16711935),c.call(this,2,858993459),s.call(this,16,65535),s.call(this,4,252645135),P[D]=this._lBlock,P[D+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});l.DES=v._createHelper(L),m=m.TripleDES=v.extend({_doReset:function(){var P=this._key.words;this._des1=L.createEncryptor(d.create(P.slice(0,2))),this._des2=L.createEncryptor(d.create(P.slice(2,4))),this._des3=L.createEncryptor(d.create(P.slice(4,6)))},encryptBlock:function(P,D){this._des1.encryptBlock(P,D),this._des2.decryptBlock(P,D),this._des3.encryptBlock(P,D)},decryptBlock:function(P,D){this._des3.decryptBlock(P,D),this._des2.encryptBlock(P,D),this._des1.decryptBlock(P,D)},keySize:6,ivSize:2,blockSize:2}),l.TripleDES=v._createHelper(m)}(),function(){var s=a,c=s.lib.WordArray;s.enc.Base64={stringify:function(l){var d=l.words,v=l.sigBytes,m=this._map;l.clamp(),l=[];for(var T=0;T<v;T+=3)for(var k=(d[T>>>2]>>>24-8*(T%4)&255)<<16|(d[T+1>>>2]>>>24-8*((T+1)%4)&255)<<8|d[T+2>>>2]>>>24-8*((T+2)%4)&255,O=0;4>O&&T+.75*O<v;O++)l.push(m.charAt(k>>>6*(3-O)&63));if(d=m.charAt(64))for(;l.length%4;)l.push(d);return l.join("")},parse:function(l){var d=l.length,v=this._map,m=v.charAt(64);m&&(m=l.indexOf(m),m!=-1&&(d=m));for(var m=[],T=0,k=0;k<d;k++)if(k%4){var O=v.indexOf(l.charAt(k-1))<<2*(k%4),F=v.indexOf(l.charAt(k))>>>6-2*(k%4);m[T>>>2]|=(O|F)<<24-8*(T%4),T++}return c.create(m,T)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(s){function c(L,P,D,A,N,j,W){return L=L+(P&D|~P&A)+N+W,(L<<j|L>>>32-j)+P}function l(L,P,D,A,N,j,W){return L=L+(P&A|D&~A)+N+W,(L<<j|L>>>32-j)+P}function d(L,P,D,A,N,j,W){return L=L+(P^D^A)+N+W,(L<<j|L>>>32-j)+P}function v(L,P,D,A,N,j,W){return L=L+(D^(P|~A))+N+W,(L<<j|L>>>32-j)+P}for(var m=a,O=m.lib,T=O.WordArray,k=O.Hasher,O=m.algo,F=[],U=0;64>U;U++)F[U]=4294967296*s.abs(s.sin(U+1))|0;O=O.MD5=k.extend({_doReset:function(){this._hash=new T.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(L,P){for(var D=0;16>D;D++){var A=P+D,N=L[A];L[A]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}var D=this._hash.words,A=L[P+0],N=L[P+1],j=L[P+2],W=L[P+3],se=L[P+4],de=L[P+5],ue=L[P+6],pe=L[P+7],G=L[P+8],X=L[P+9],te=L[P+10],J=L[P+11],re=L[P+12],he=L[P+13],ye=L[P+14],Fe=L[P+15],ge=D[0],Me=D[1],Ne=D[2],Pe=D[3],ge=c(ge,Me,Ne,Pe,A,7,F[0]),Pe=c(Pe,ge,Me,Ne,N,12,F[1]),Ne=c(Ne,Pe,ge,Me,j,17,F[2]),Me=c(Me,Ne,Pe,ge,W,22,F[3]),ge=c(ge,Me,Ne,Pe,se,7,F[4]),Pe=c(Pe,ge,Me,Ne,de,12,F[5]),Ne=c(Ne,Pe,ge,Me,ue,17,F[6]),Me=c(Me,Ne,Pe,ge,pe,22,F[7]),ge=c(ge,Me,Ne,Pe,G,7,F[8]),Pe=c(Pe,ge,Me,Ne,X,12,F[9]),Ne=c(Ne,Pe,ge,Me,te,17,F[10]),Me=c(Me,Ne,Pe,ge,J,22,F[11]),ge=c(ge,Me,Ne,Pe,re,7,F[12]),Pe=c(Pe,ge,Me,Ne,he,12,F[13]),Ne=c(Ne,Pe,ge,Me,ye,17,F[14]),Me=c(Me,Ne,Pe,ge,Fe,22,F[15]),ge=l(ge,Me,Ne,Pe,N,5,F[16]),Pe=l(Pe,ge,Me,Ne,ue,9,F[17]),Ne=l(Ne,Pe,ge,Me,J,14,F[18]),Me=l(Me,Ne,Pe,ge,A,20,F[19]),ge=l(ge,Me,Ne,Pe,de,5,F[20]),Pe=l(Pe,ge,Me,Ne,te,9,F[21]),Ne=l(Ne,Pe,ge,Me,Fe,14,F[22]),Me=l(Me,Ne,Pe,ge,se,20,F[23]),ge=l(ge,Me,Ne,Pe,X,5,F[24]),Pe=l(Pe,ge,Me,Ne,ye,9,F[25]),Ne=l(Ne,Pe,ge,Me,W,14,F[26]),Me=l(Me,Ne,Pe,ge,G,20,F[27]),ge=l(ge,Me,Ne,Pe,he,5,F[28]),Pe=l(Pe,ge,Me,Ne,j,9,F[29]),Ne=l(Ne,Pe,ge,Me,pe,14,F[30]),Me=l(Me,Ne,Pe,ge,re,20,F[31]),ge=d(ge,Me,Ne,Pe,de,4,F[32]),Pe=d(Pe,ge,Me,Ne,G,11,F[33]),Ne=d(Ne,Pe,ge,Me,J,16,F[34]),Me=d(Me,Ne,Pe,ge,ye,23,F[35]),ge=d(ge,Me,Ne,Pe,N,4,F[36]),Pe=d(Pe,ge,Me,Ne,se,11,F[37]),Ne=d(Ne,Pe,ge,Me,pe,16,F[38]),Me=d(Me,Ne,Pe,ge,te,23,F[39]),ge=d(ge,Me,Ne,Pe,he,4,F[40]),Pe=d(Pe,ge,Me,Ne,A,11,F[41]),Ne=d(Ne,Pe,ge,Me,W,16,F[42]),Me=d(Me,Ne,Pe,ge,ue,23,F[43]),ge=d(ge,Me,Ne,Pe,X,4,F[44]),Pe=d(Pe,ge,Me,Ne,re,11,F[45]),Ne=d(Ne,Pe,ge,Me,Fe,16,F[46]),Me=d(Me,Ne,Pe,ge,j,23,F[47]),ge=v(ge,Me,Ne,Pe,A,6,F[48]),Pe=v(Pe,ge,Me,Ne,pe,10,F[49]),Ne=v(Ne,Pe,ge,Me,ye,15,F[50]),Me=v(Me,Ne,Pe,ge,de,21,F[51]),ge=v(ge,Me,Ne,Pe,re,6,F[52]),Pe=v(Pe,ge,Me,Ne,W,10,F[53]),Ne=v(Ne,Pe,ge,Me,te,15,F[54]),Me=v(Me,Ne,Pe,ge,N,21,F[55]),ge=v(ge,Me,Ne,Pe,G,6,F[56]),Pe=v(Pe,ge,Me,Ne,Fe,10,F[57]),Ne=v(Ne,Pe,ge,Me,ue,15,F[58]),Me=v(Me,Ne,Pe,ge,he,21,F[59]),ge=v(ge,Me,Ne,Pe,se,6,F[60]),Pe=v(Pe,ge,Me,Ne,J,10,F[61]),Ne=v(Ne,Pe,ge,Me,j,15,F[62]),Me=v(Me,Ne,Pe,ge,X,21,F[63]);D[0]=D[0]+ge|0,D[1]=D[1]+Me|0,D[2]=D[2]+Ne|0,D[3]=D[3]+Pe|0},_doFinalize:function(){var L=this._data,P=L.words,D=8*this._nDataBytes,A=8*L.sigBytes;P[A>>>5]|=128<<24-A%32;var N=s.floor(D/4294967296);for(P[(A+64>>>9<<4)+15]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,P[(A+64>>>9<<4)+14]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,L.sigBytes=4*(P.length+1),this._process(),L=this._hash,P=L.words,D=0;4>D;D++)A=P[D],P[D]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;return L},clone:function(){var L=k.clone.call(this);return L._hash=this._hash.clone(),L}}),m.MD5=k._createHelper(O),m.HmacMD5=k._createHmacHelper(O)}(Math),function(){var s=a,v=s.lib,c=v.WordArray,l=v.Hasher,d=[],v=s.algo.SHA1=l.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,T){for(var k=this._hash.words,O=k[0],F=k[1],U=k[2],L=k[3],P=k[4],D=0;80>D;D++){if(16>D)d[D]=m[T+D]|0;else{var A=d[D-3]^d[D-8]^d[D-14]^d[D-16];d[D]=A<<1|A>>>31}A=(O<<5|O>>>27)+P+d[D],A=20>D?A+((F&U|~F&L)+1518500249):40>D?A+((F^U^L)+1859775393):60>D?A+((F&U|F&L|U&L)-1894007588):A+((F^U^L)-899497514),P=L,L=U,U=F<<30|F>>>2,F=O,O=A}k[0]=k[0]+O|0,k[1]=k[1]+F|0,k[2]=k[2]+U|0,k[3]=k[3]+L|0,k[4]=k[4]+P|0},_doFinalize:function(){var m=this._data,T=m.words,k=8*this._nDataBytes,O=8*m.sigBytes;return T[O>>>5]|=128<<24-O%32,T[(O+64>>>9<<4)+14]=Math.floor(k/4294967296),T[(O+64>>>9<<4)+15]=k,m.sigBytes=4*T.length,this._process(),this._hash},clone:function(){var m=l.clone.call(this);return m._hash=this._hash.clone(),m}});s.SHA1=l._createHelper(v),s.HmacSHA1=l._createHmacHelper(v)}(),function(s){for(var c=a,D=c.lib,l=D.WordArray,d=D.Hasher,D=c.algo,v=[],m=[],T=function(N){return 4294967296*(N-(N|0))|0},k=2,O=0;64>O;){var F;e:{F=k;for(var U=s.sqrt(F),L=2;L<=U;L++)if(!(F%L)){F=!1;break e}F=!0}F&&(8>O&&(v[O]=T(s.pow(k,.5))),m[O]=T(s.pow(k,1/3)),O++),k++}var P=[],D=D.SHA256=d.extend({_doReset:function(){this._hash=new l.init(v.slice(0))},_doProcessBlock:function(A,N){for(var j=this._hash.words,W=j[0],se=j[1],de=j[2],ue=j[3],pe=j[4],G=j[5],X=j[6],te=j[7],J=0;64>J;J++){if(16>J)P[J]=A[N+J]|0;else{var re=P[J-15],he=P[J-2];P[J]=((re<<25|re>>>7)^(re<<14|re>>>18)^re>>>3)+P[J-7]+((he<<15|he>>>17)^(he<<13|he>>>19)^he>>>10)+P[J-16]}re=te+((pe<<26|pe>>>6)^(pe<<21|pe>>>11)^(pe<<7|pe>>>25))+(pe&G^~pe&X)+m[J]+P[J],he=((W<<30|W>>>2)^(W<<19|W>>>13)^(W<<10|W>>>22))+(W&se^W&de^se&de),te=X,X=G,G=pe,pe=ue+re|0,ue=de,de=se,se=W,W=re+he|0}j[0]=j[0]+W|0,j[1]=j[1]+se|0,j[2]=j[2]+de|0,j[3]=j[3]+ue|0,j[4]=j[4]+pe|0,j[5]=j[5]+G|0,j[6]=j[6]+X|0,j[7]=j[7]+te|0},_doFinalize:function(){var A=this._data,N=A.words,j=8*this._nDataBytes,W=8*A.sigBytes;return N[W>>>5]|=128<<24-W%32,N[(W+64>>>9<<4)+14]=s.floor(j/4294967296),N[(W+64>>>9<<4)+15]=j,A.sigBytes=4*N.length,this._process(),this._hash},clone:function(){var A=d.clone.call(this);return A._hash=this._hash.clone(),A}});c.SHA256=d._createHelper(D),c.HmacSHA256=d._createHmacHelper(D)}(Math),function(){var s=a,c=s.lib.WordArray,d=s.algo,l=d.SHA256,d=d.SHA224=l.extend({_doReset:function(){this._hash=new c.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var v=l._doFinalize.call(this);return v.sigBytes-=4,v}});s.SHA224=l._createHelper(d),s.HmacSHA224=l._createHmacHelper(d)}(),function(){function s(){return d.create.apply(d,arguments)}for(var c=a,l=c.lib.Hasher,m=c.x64,d=m.Word,v=m.WordArray,m=c.algo,T=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],k=[],O=0;80>O;O++)k[O]=s();m=m.SHA512=l.extend({_doReset:function(){this._hash=new v.init([new d.init(1779033703,4089235720),new d.init(3144134277,2227873595),new d.init(1013904242,4271175723),new d.init(2773480762,1595750129),new d.init(1359893119,2917565137),new d.init(2600822924,725511199),new d.init(528734635,4215389547),new d.init(1541459225,327033209)])},_doProcessBlock:function(F,U){for(var se=this._hash.words,L=se[0],P=se[1],D=se[2],A=se[3],N=se[4],j=se[5],W=se[6],se=se[7],de=L.high,ue=L.low,pe=P.high,G=P.low,X=D.high,te=D.low,J=A.high,re=A.low,he=N.high,ye=N.low,Fe=j.high,ge=j.low,Pe=W.high,Ne=W.low,Me=se.high,cr=se.low,vn=de,nn=ue,Dn=pe,Vn=G,Zn=X,qn=te,ic=J,br=re,Bt=he,Qt=ye,yn=Fe,_n=ge,Mr=Pe,Pn=Ne,sc=Me,ma=cr,vi=0;80>vi;vi++){var Is=k[vi];if(16>vi)var ii=Is.high=F[U+2*vi]|0,Wt=Is.low=F[U+2*vi+1]|0;else{var ii=k[vi-15],Wt=ii.high,qi=ii.low,ii=(Wt>>>1|qi<<31)^(Wt>>>8|qi<<24)^Wt>>>7,qi=(qi>>>1|Wt<<31)^(qi>>>8|Wt<<24)^(qi>>>7|Wt<<25),ga=k[vi-2],Wt=ga.high,cn=ga.low,ga=(Wt>>>19|cn<<13)^(Wt<<3|cn>>>29)^Wt>>>6,cn=(cn>>>19|Wt<<13)^(cn<<3|Wt>>>29)^(cn>>>6|Wt<<26),Wt=k[vi-7],zh=Wt.high,As=k[vi-16],zi=As.high,As=As.low,Wt=qi+Wt.low,ii=ii+zh+(Wt>>>0<qi>>>0?1:0),Wt=Wt+cn,ii=ii+ga+(Wt>>>0<cn>>>0?1:0),Wt=Wt+As,ii=ii+zi+(Wt>>>0<As>>>0?1:0);Is.high=ii,Is.low=Wt}var zh=Bt&yn^~Bt&Mr,As=Qt&_n^~Qt&Pn,Is=vn&Dn^vn&Zn^Dn&Zn,D2=nn&Vn^nn&qn^Vn&qn,qi=(vn>>>28|nn<<4)^(vn<<30|nn>>>2)^(vn<<25|nn>>>7),ga=(nn>>>28|vn<<4)^(nn<<30|vn>>>2)^(nn<<25|vn>>>7),cn=T[vi],N2=cn.high,Pg=cn.low,cn=ma+((Qt>>>14|Bt<<18)^(Qt>>>18|Bt<<14)^(Qt<<23|Bt>>>9)),zi=sc+((Bt>>>14|Qt<<18)^(Bt>>>18|Qt<<14)^(Bt<<23|Qt>>>9))+(cn>>>0<ma>>>0?1:0),cn=cn+As,zi=zi+zh+(cn>>>0<As>>>0?1:0),cn=cn+Pg,zi=zi+N2+(cn>>>0<Pg>>>0?1:0),cn=cn+Wt,zi=zi+ii+(cn>>>0<Wt>>>0?1:0),Wt=ga+D2,Is=qi+Is+(Wt>>>0<ga>>>0?1:0),sc=Mr,ma=Pn,Mr=yn,Pn=_n,yn=Bt,_n=Qt,Qt=br+cn|0,Bt=ic+zi+(Qt>>>0<br>>>0?1:0)|0,ic=Zn,br=qn,Zn=Dn,qn=Vn,Dn=vn,Vn=nn,nn=cn+Wt|0,vn=zi+Is+(nn>>>0<cn>>>0?1:0)|0}ue=L.low=ue+nn,L.high=de+vn+(ue>>>0<nn>>>0?1:0),G=P.low=G+Vn,P.high=pe+Dn+(G>>>0<Vn>>>0?1:0),te=D.low=te+qn,D.high=X+Zn+(te>>>0<qn>>>0?1:0),re=A.low=re+br,A.high=J+ic+(re>>>0<br>>>0?1:0),ye=N.low=ye+Qt,N.high=he+Bt+(ye>>>0<Qt>>>0?1:0),ge=j.low=ge+_n,j.high=Fe+yn+(ge>>>0<_n>>>0?1:0),Ne=W.low=Ne+Pn,W.high=Pe+Mr+(Ne>>>0<Pn>>>0?1:0),cr=se.low=cr+ma,se.high=Me+sc+(cr>>>0<ma>>>0?1:0)},_doFinalize:function(){var F=this._data,U=F.words,L=8*this._nDataBytes,P=8*F.sigBytes;return U[P>>>5]|=128<<24-P%32,U[(P+128>>>10<<5)+30]=Math.floor(L/4294967296),U[(P+128>>>10<<5)+31]=L,F.sigBytes=4*U.length,this._process(),this._hash.toX32()},clone:function(){var F=l.clone.call(this);return F._hash=this._hash.clone(),F},blockSize:32}),c.SHA512=l._createHelper(m),c.HmacSHA512=l._createHmacHelper(m)}(),function(){var s=a,v=s.x64,c=v.Word,l=v.WordArray,v=s.algo,d=v.SHA512,v=v.SHA384=d.extend({_doReset:function(){this._hash=new l.init([new c.init(3418070365,3238371032),new c.init(1654270250,914150663),new c.init(2438529370,812702999),new c.init(355462360,4144912697),new c.init(1731405415,4290775857),new c.init(2394180231,1750603025),new c.init(3675008525,1694076839),new c.init(1203062813,3204075428)])},_doFinalize:function(){var m=d._doFinalize.call(this);return m.sigBytes-=16,m}});s.SHA384=d._createHelper(v),s.HmacSHA384=d._createHmacHelper(v)}(),function(){var s=a,F=s.lib,c=F.WordArray,l=F.Hasher,F=s.algo,d=c.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),v=c.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),m=c.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),T=c.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),k=c.create([0,1518500249,1859775393,2400959708,2840853838]),O=c.create([1352829926,1548603684,1836072691,2053994217,0]),F=F.RIPEMD160=l.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(U,L){for(var P=0;16>P;P++){var D=L+P,A=U[D];U[D]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var D=this._hash.words,A=k.words,N=O.words,j=d.words,W=v.words,se=m.words,de=T.words,ue,pe,G,X,te,J,re,he,ye,Fe;J=ue=D[0],re=pe=D[1],he=G=D[2],ye=X=D[3],Fe=te=D[4];for(var ge,P=0;80>P;P+=1)ge=ue+U[L+j[P]]|0,ge=16>P?ge+((pe^G^X)+A[0]):32>P?ge+((pe&G|~pe&X)+A[1]):48>P?ge+(((pe|~G)^X)+A[2]):64>P?ge+((pe&X|G&~X)+A[3]):ge+((pe^(G|~X))+A[4]),ge|=0,ge=ge<<se[P]|ge>>>32-se[P],ge=ge+te|0,ue=te,te=X,X=G<<10|G>>>22,G=pe,pe=ge,ge=J+U[L+W[P]]|0,ge=16>P?ge+((re^(he|~ye))+N[0]):32>P?ge+((re&ye|he&~ye)+N[1]):48>P?ge+(((re|~he)^ye)+N[2]):64>P?ge+((re&he|~re&ye)+N[3]):ge+((re^he^ye)+N[4]),ge|=0,ge=ge<<de[P]|ge>>>32-de[P],ge=ge+Fe|0,J=Fe,Fe=ye,ye=he<<10|he>>>22,he=re,re=ge;ge=D[1]+G+ye|0,D[1]=D[2]+X+Fe|0,D[2]=D[3]+te+J|0,D[3]=D[4]+ue+re|0,D[4]=D[0]+pe+he|0,D[0]=ge},_doFinalize:function(){var U=this._data,L=U.words,P=8*this._nDataBytes,D=8*U.sigBytes;for(L[D>>>5]|=128<<24-D%32,L[(D+64>>>9<<4)+14]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,U.sigBytes=4*(L.length+1),this._process(),U=this._hash,L=U.words,P=0;5>P;P++)D=L[P],L[P]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360;return U},clone:function(){var U=l.clone.call(this);return U._hash=this._hash.clone(),U}});s.RIPEMD160=l._createHelper(F),s.HmacRIPEMD160=l._createHmacHelper(F)}(),function(){var s=a,c=s.enc.Utf8;s.algo.HMAC=s.lib.Base.extend({init:function(l,d){l=this._hasher=new l.init,typeof d=="string"&&(d=c.parse(d));var v=l.blockSize,m=4*v;d.sigBytes>m&&(d=l.finalize(d)),d.clamp();for(var T=this._oKey=d.clone(),k=this._iKey=d.clone(),O=T.words,F=k.words,U=0;U<v;U++)O[U]^=1549556828,F[U]^=909522486;T.sigBytes=k.sigBytes=m,this.reset()},reset:function(){var l=this._hasher;l.reset(),l.update(this._iKey)},update:function(l){return this._hasher.update(l),this},finalize:function(l){var d=this._hasher;return l=d.finalize(l),d.reset(),d.finalize(this._oKey.clone().concat(l))}})}(),function(){var s=a,d=s.lib,c=d.Base,l=d.WordArray,d=s.algo,v=d.HMAC,m=d.PBKDF2=c.extend({cfg:c.extend({keySize:4,hasher:d.SHA1,iterations:1}),init:function(T){this.cfg=this.cfg.extend(T)},compute:function(T,k){for(var A=this.cfg,O=v.create(A.hasher,T),F=l.create(),U=l.create([1]),L=F.words,P=U.words,D=A.keySize,A=A.iterations;L.length<D;){var N=O.update(k).finalize(U);O.reset();for(var j=N.words,W=j.length,se=N,de=1;de<A;de++){se=O.finalize(se),O.reset();for(var ue=se.words,pe=0;pe<W;pe++)j[pe]^=ue[pe]}F.concat(N),P[0]++}return F.sigBytes=4*D,F}});s.PBKDF2=function(T,k,O){return m.create(O).compute(T,k)}}();var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="=";function p(s){var c,l,d="";for(c=0;c+3<=s.length;c+=3)l=parseInt(s.substring(c,c+3),16),d+=o.charAt(l>>6)+o.charAt(l&63);for(c+1==s.length?(l=parseInt(s.substring(c,c+1),16),d+=o.charAt(l<<2)):c+2==s.length&&(l=parseInt(s.substring(c,c+2),16),d+=o.charAt(l>>2)+o.charAt((l&3)<<4));(d.length&3)>0;)d+=u;return d}function h(s){var c="",l,d=0,v,m;for(l=0;l<s.length&&s.charAt(l)!=u;++l)m=o.indexOf(s.charAt(l)),!(m<0)&&(d==0?(c+=$(m>>2),v=m&3,d=1):d==1?(c+=$(v<<2|m>>4),v=m&15,d=2):d==2?(c+=$(v),c+=$(m>>2),v=m&3,d=3):(c+=$(v<<2|m>>4),c+=$(m&15),d=0));return d==1&&(c+=$(v<<2)),c}function g(s){var c=h(s),l,d=new Array;for(l=0;2*l<c.length;++l)d[l]=parseInt(c.substring(2*l,2*l+2),16);return d}var f;function _(s,c,l){s!=null&&(typeof s=="number"?this.fromNumber(s,c,l):c==null&&typeof s!="string"?this.fromString(s,256):this.fromString(s,c))}function w(){return new _(null)}function C(s,c,l,d,v,m){for(;--m>=0;){var T=c*this[s++]+l[d]+v;v=Math.floor(T/67108864),l[d++]=T&67108863}return v}function R(s,c,l,d,v,m){for(var T=c&32767,k=c>>15;--m>=0;){var O=this[s]&32767,F=this[s++]>>15,U=k*O+F*T;O=T*O+((U&32767)<<15)+l[d]+(v&1073741823),v=(O>>>30)+(U>>>15)+k*F+(v>>>30),l[d++]=O&1073741823}return v}function S(s,c,l,d,v,m){for(var T=c&16383,k=c>>14;--m>=0;){var O=this[s]&16383,F=this[s++]>>14,U=k*O+F*T;O=T*O+((U&16383)<<14)+l[d]+v,v=(O>>28)+(U>>14)+k*F,l[d++]=O&268435455}return v}t.appName=="Microsoft Internet Explorer"?(_.prototype.am=R,f=30):t.appName!="Netscape"?(_.prototype.am=C,f=26):(_.prototype.am=S,f=28),_.prototype.DB=f,_.prototype.DM=(1<<f)-1,_.prototype.DV=1<<f;var b=52;_.prototype.FV=Math.pow(2,b),_.prototype.F1=b-f,_.prototype.F2=2*f-b;var x="0123456789abcdefghijklmnopqrstuvwxyz",E=new Array,M,Z;for(M=48,Z=0;Z<=9;++Z)E[M++]=Z;for(M=97,Z=10;Z<36;++Z)E[M++]=Z;for(M=65,Z=10;Z<36;++Z)E[M++]=Z;function $(s){return x.charAt(s)}function z(s,c){var l=E[s.charCodeAt(c)];return l??-1}function q(s){for(var c=this.t-1;c>=0;--c)s[c]=this[c];s.t=this.t,s.s=this.s}function Q(s){this.t=1,this.s=s<0?-1:0,s>0?this[0]=s:s<-1?this[0]=s+this.DV:this.t=0}function K(s){var c=w();return c.fromInt(s),c}function ee(s,c){var l;if(c==16)l=4;else if(c==8)l=3;else if(c==256)l=8;else if(c==2)l=1;else if(c==32)l=5;else if(c==4)l=2;else{this.fromRadix(s,c);return}this.t=0,this.s=0;for(var d=s.length,v=!1,m=0;--d>=0;){var T=l==8?s[d]&255:z(s,d);if(T<0){s.charAt(d)=="-"&&(v=!0);continue}v=!1,m==0?this[this.t++]=T:m+l>this.DB?(this[this.t-1]|=(T&(1<<this.DB-m)-1)<<m,this[this.t++]=T>>this.DB-m):this[this.t-1]|=T<<m,m+=l,m>=this.DB&&(m-=this.DB)}l==8&&s[0]&128&&(this.s=-1,m>0&&(this[this.t-1]|=(1<<this.DB-m)-1<<m)),this.clamp(),v&&_.ZERO.subTo(this,this)}function ae(){for(var s=this.s&this.DM;this.t>0&&this[this.t-1]==s;)--this.t}function le(s){if(this.s<0)return"-"+this.negate().toString(s);var c;if(s==16)c=4;else if(s==8)c=3;else if(s==2)c=1;else if(s==32)c=5;else if(s==4)c=2;else return this.toRadix(s);var l=(1<<c)-1,d,v=!1,m="",T=this.t,k=this.DB-T*this.DB%c;if(T-- >0)for(k<this.DB&&(d=this[T]>>k)>0&&(v=!0,m=$(d));T>=0;)k<c?(d=(this[T]&(1<<k)-1)<<c-k,d|=this[--T]>>(k+=this.DB-c)):(d=this[T]>>(k-=c)&l,k<=0&&(k+=this.DB,--T)),d>0&&(v=!0),v&&(m+=$(d));return v?m:"0"}function ne(){var s=w();return _.ZERO.subTo(this,s),s}function Re(){return this.s<0?this.negate():this}function ve(s){var c=this.s-s.s;if(c!=0)return c;var l=this.t;if(c=l-s.t,c!=0)return this.s<0?-c:c;for(;--l>=0;)if((c=this[l]-s[l])!=0)return c;return 0}function _e(s){var c=1,l;return(l=s>>>16)!=0&&(s=l,c+=16),(l=s>>8)!=0&&(s=l,c+=8),(l=s>>4)!=0&&(s=l,c+=4),(l=s>>2)!=0&&(s=l,c+=2),(l=s>>1)!=0&&(s=l,c+=1),c}function we(){return this.t<=0?0:this.DB*(this.t-1)+_e(this[this.t-1]^this.s&this.DM)}function Ee(s,c){var l;for(l=this.t-1;l>=0;--l)c[l+s]=this[l];for(l=s-1;l>=0;--l)c[l]=0;c.t=this.t+s,c.s=this.s}function fe(s,c){for(var l=s;l<this.t;++l)c[l-s]=this[l];c.t=Math.max(this.t-s,0),c.s=this.s}function ce(s,c){var l=s%this.DB,d=this.DB-l,v=(1<<d)-1,m=Math.floor(s/this.DB),T=this.s<<l&this.DM,k;for(k=this.t-1;k>=0;--k)c[k+m+1]=this[k]>>d|T,T=(this[k]&v)<<l;for(k=m-1;k>=0;--k)c[k]=0;c[m]=T,c.t=this.t+m+1,c.s=this.s,c.clamp()}function Ce(s,c){c.s=this.s;var l=Math.floor(s/this.DB);if(l>=this.t){c.t=0;return}var d=s%this.DB,v=this.DB-d,m=(1<<d)-1;c[0]=this[l]>>d;for(var T=l+1;T<this.t;++T)c[T-l-1]|=(this[T]&m)<<v,c[T-l]=this[T]>>d;d>0&&(c[this.t-l-1]|=(this.s&m)<<v),c.t=this.t-l,c.clamp()}function je(s,c){for(var l=0,d=0,v=Math.min(s.t,this.t);l<v;)d+=this[l]-s[l],c[l++]=d&this.DM,d>>=this.DB;if(s.t<this.t){for(d-=s.s;l<this.t;)d+=this[l],c[l++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;l<s.t;)d-=s[l],c[l++]=d&this.DM,d>>=this.DB;d-=s.s}c.s=d<0?-1:0,d<-1?c[l++]=this.DV+d:d>0&&(c[l++]=d),c.t=l,c.clamp()}function $e(s,c){var l=this.abs(),d=s.abs(),v=l.t;for(c.t=v+d.t;--v>=0;)c[v]=0;for(v=0;v<d.t;++v)c[v+l.t]=l.am(0,d[v],c,v,0,l.t);c.s=0,c.clamp(),this.s!=s.s&&_.ZERO.subTo(c,c)}function et(s){for(var c=this.abs(),l=s.t=2*c.t;--l>=0;)s[l]=0;for(l=0;l<c.t-1;++l){var d=c.am(l,c[l],s,2*l,0,1);(s[l+c.t]+=c.am(l+1,2*c[l],s,2*l+1,d,c.t-l-1))>=c.DV&&(s[l+c.t]-=c.DV,s[l+c.t+1]=1)}s.t>0&&(s[s.t-1]+=c.am(l,c[l],s,2*l,0,1)),s.s=0,s.clamp()}function it(s,c,l){var d=s.abs();if(!(d.t<=0)){var v=this.abs();if(v.t<d.t){c!=null&&c.fromInt(0),l!=null&&this.copyTo(l);return}l==null&&(l=w());var m=w(),T=this.s,k=s.s,O=this.DB-_e(d[d.t-1]);O>0?(d.lShiftTo(O,m),v.lShiftTo(O,l)):(d.copyTo(m),v.copyTo(l));var F=m.t,U=m[F-1];if(U!=0){var L=U*(1<<this.F1)+(F>1?m[F-2]>>this.F2:0),P=this.FV/L,D=(1<<this.F1)/L,A=1<<this.F2,N=l.t,j=N-F,W=c??w();for(m.dlShiftTo(j,W),l.compareTo(W)>=0&&(l[l.t++]=1,l.subTo(W,l)),_.ONE.dlShiftTo(F,W),W.subTo(m,m);m.t<F;)m[m.t++]=0;for(;--j>=0;){var se=l[--N]==U?this.DM:Math.floor(l[N]*P+(l[N-1]+A)*D);if((l[N]+=m.am(0,se,l,j,0,F))<se)for(m.dlShiftTo(j,W),l.subTo(W,l);l[N]<--se;)l.subTo(W,l)}c!=null&&(l.drShiftTo(F,c),T!=k&&_.ZERO.subTo(c,c)),l.t=F,l.clamp(),O>0&&l.rShiftTo(O,l),T<0&&_.ZERO.subTo(l,l)}}}function ze(s){var c=w();return this.abs().divRemTo(s,null,c),this.s<0&&c.compareTo(_.ZERO)>0&&s.subTo(c,c),c}function Ge(s){this.m=s}function Le(s){return s.s<0||s.compareTo(this.m)>=0?s.mod(this.m):s}function Je(s){return s}function Tt(s){s.divRemTo(this.m,null,s)}function Ir(s,c,l){s.multiplyTo(c,l),this.reduce(l)}function nr(s,c){s.squareTo(c),this.reduce(c)}Ge.prototype.convert=Le,Ge.prototype.revert=Je,Ge.prototype.reduce=Tt,Ge.prototype.mulTo=Ir,Ge.prototype.sqrTo=nr;function Bi(){if(this.t<1)return 0;var s=this[0];if(!(s&1))return 0;var c=s&3;return c=c*(2-(s&15)*c)&15,c=c*(2-(s&255)*c)&255,c=c*(2-((s&65535)*c&65535))&65535,c=c*(2-s*c%this.DV)%this.DV,c>0?this.DV-c:-c}function fn(s){this.m=s,this.mp=s.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<s.DB-15)-1,this.mt2=2*s.t}function rr(s){var c=w();return s.abs().dlShiftTo(this.m.t,c),c.divRemTo(this.m,null,c),s.s<0&&c.compareTo(_.ZERO)>0&&this.m.subTo(c,c),c}function gr(s){var c=w();return s.copyTo(c),this.reduce(c),c}function In(s){for(;s.t<=this.mt2;)s[s.t++]=0;for(var c=0;c<this.m.t;++c){var l=s[c]&32767,d=l*this.mpl+((l*this.mph+(s[c]>>15)*this.mpl&this.um)<<15)&s.DM;for(l=c+this.m.t,s[l]+=this.m.am(0,d,s,c,0,this.m.t);s[l]>=s.DV;)s[l]-=s.DV,s[++l]++}s.clamp(),s.drShiftTo(this.m.t,s),s.compareTo(this.m)>=0&&s.subTo(this.m,s)}function ir(s,c){s.squareTo(c),this.reduce(c)}function $n(s,c,l){s.multiplyTo(c,l),this.reduce(l)}fn.prototype.convert=rr,fn.prototype.revert=gr,fn.prototype.reduce=In,fn.prototype.mulTo=$n,fn.prototype.sqrTo=ir;function an(){return(this.t>0?this[0]&1:this.s)==0}function vr(s,c){if(s>4294967295||s<1)return _.ONE;var l=w(),d=w(),v=c.convert(this),m=_e(s)-1;for(v.copyTo(l);--m>=0;)if(c.sqrTo(l,d),(s&1<<m)>0)c.mulTo(d,v,l);else{var T=l;l=d,d=T}return c.revert(l)}function mn(s,c){var l;return s<256||c.isEven()?l=new Ge(c):l=new fn(c),this.exp(s,l)}_.prototype.copyTo=q,_.prototype.fromInt=Q,_.prototype.fromString=ee,_.prototype.clamp=ae,_.prototype.dlShiftTo=Ee,_.prototype.drShiftTo=fe,_.prototype.lShiftTo=ce,_.prototype.rShiftTo=Ce,_.prototype.subTo=je,_.prototype.multiplyTo=$e,_.prototype.squareTo=et,_.prototype.divRemTo=it,_.prototype.invDigit=Bi,_.prototype.isEven=an,_.prototype.exp=vr,_.prototype.toString=le,_.prototype.negate=ne,_.prototype.abs=Re,_.prototype.compareTo=ve,_.prototype.bitLength=we,_.prototype.mod=ze,_.prototype.modPowInt=mn,_.ZERO=K(0),_.ONE=K(1);function sr(){var s=w();return this.copyTo(s),s}function yr(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function ht(){return this.t==0?this.s:this[0]<<24>>24}function _t(){return this.t==0?this.s:this[0]<<16>>16}function ct(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function $t(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Fr(s){if(s==null&&(s=10),this.signum()==0||s<2||s>36)return"0";var c=this.chunkSize(s),l=Math.pow(s,c),d=K(l),v=w(),m=w(),T="";for(this.divRemTo(d,v,m);v.signum()>0;)T=(l+m.intValue()).toString(s).substr(1)+T,v.divRemTo(d,v,m);return m.intValue().toString(s)+T}function _r(s,c){this.fromInt(0),c==null&&(c=10);for(var l=this.chunkSize(c),d=Math.pow(c,l),v=!1,m=0,T=0,k=0;k<s.length;++k){var O=z(s,k);if(O<0){s.charAt(k)=="-"&&this.signum()==0&&(v=!0);continue}T=c*T+O,++m>=l&&(this.dMultiply(d),this.dAddOffset(T,0),m=0,T=0)}m>0&&(this.dMultiply(Math.pow(c,m)),this.dAddOffset(T,0)),v&&_.ZERO.subTo(this,this)}function Vt(s,c,l){if(typeof c=="number")if(s<2)this.fromInt(1);else for(this.fromNumber(s,l),this.testBit(s-1)||this.bitwiseTo(_.ONE.shiftLeft(s-1),ks,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>s&&this.subTo(_.ONE.shiftLeft(s-1),this);else{var d=new Array,v=s&7;d.length=(s>>3)+1,c.nextBytes(d),v>0?d[0]&=(1<<v)-1:d[0]=0,this.fromString(d,256)}}function pt(){var s=this.t,c=new Array;c[0]=this.s;var l=this.DB-s*this.DB%8,d,v=0;if(s-- >0)for(l<this.DB&&(d=this[s]>>l)!=(this.s&this.DM)>>l&&(c[v++]=d|this.s<<this.DB-l);s>=0;)l<8?(d=(this[s]&(1<<l)-1)<<8-l,d|=this[--s]>>(l+=this.DB-8)):(d=this[s]>>(l-=8)&255,l<=0&&(l+=this.DB,--s)),d&128&&(d|=-256),v==0&&(this.s&128)!=(d&128)&&++v,(v>0||d!=this.s)&&(c[v++]=d);return c}function Hn(s){return this.compareTo(s)==0}function Ps(s){return this.compareTo(s)<0?this:s}function gn(s){return this.compareTo(s)>0?this:s}function Wa(s,c,l){var d,v,m=Math.min(s.t,this.t);for(d=0;d<m;++d)l[d]=c(this[d],s[d]);if(s.t<this.t){for(v=s.s&this.DM,d=m;d<this.t;++d)l[d]=c(this[d],v);l.t=this.t}else{for(v=this.s&this.DM,d=m;d<s.t;++d)l[d]=c(v,s[d]);l.t=s.t}l.s=c(this.s,s.s),l.clamp()}function Rl(s,c){return s&c}function rn(s){var c=w();return this.bitwiseTo(s,Rl,c),c}function ks(s,c){return s|c}function Al(s){var c=w();return this.bitwiseTo(s,ks,c),c}function Ui(s,c){return s^c}function ri(s){var c=w();return this.bitwiseTo(s,Ui,c),c}function It(s,c){return s&~c}function Il(s){var c=w();return this.bitwiseTo(s,It,c),c}function Ga(){for(var s=w(),c=0;c<this.t;++c)s[c]=this.DM&~this[c];return s.t=this.t,s.s=~this.s,s}function Fl(s){var c=w();return s<0?this.rShiftTo(-s,c):this.lShiftTo(s,c),c}function Dl(s){var c=w();return s<0?this.lShiftTo(-s,c):this.rShiftTo(s,c),c}function ts(s){if(s==0)return-1;var c=0;return s&65535||(s>>=16,c+=16),s&255||(s>>=8,c+=8),s&15||(s>>=4,c+=4),s&3||(s>>=2,c+=2),s&1||++c,c}function $o(){for(var s=0;s<this.t;++s)if(this[s]!=0)return s*this.DB+ts(this[s]);return this.s<0?this.t*this.DB:-1}function Hi(s){for(var c=0;s!=0;)s&=s-1,++c;return c}function ns(){for(var s=0,c=this.s&this.DM,l=0;l<this.t;++l)s+=Hi(this[l]^c);return s}function mh(s){var c=Math.floor(s/this.DB);return c>=this.t?this.s!=0:(this[c]&1<<s%this.DB)!=0}function gh(s,c){var l=_.ONE.shiftLeft(s);return this.bitwiseTo(l,c,l),l}function Wn(s){return this.changeBit(s,ks)}function da(s){return this.changeBit(s,It)}function vh(s){return this.changeBit(s,Ui)}function Wo(s,c){for(var l=0,d=0,v=Math.min(s.t,this.t);l<v;)d+=this[l]+s[l],c[l++]=d&this.DM,d>>=this.DB;if(s.t<this.t){for(d+=s.s;l<this.t;)d+=this[l],c[l++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;l<s.t;)d+=s[l],c[l++]=d&this.DM,d>>=this.DB;d+=s.s}c.s=d<0?-1:0,d>0?c[l++]=d:d<-1&&(c[l++]=this.DV+d),c.t=l,c.clamp()}function yh(s){var c=w();return this.addTo(s,c),c}function Ts(s){var c=w();return this.subTo(s,c),c}function _h(s){var c=w();return this.multiplyTo(s,c),c}function Nl(){var s=w();return this.squareTo(s),s}function Ol(s){var c=w();return this.divRemTo(s,c,null),c}function bh(s){var c=w();return this.divRemTo(s,null,c),c}function Go(s){var c=w(),l=w();return this.divRemTo(s,c,l),new Array(c,l)}function rs(s){this[this.t]=this.am(0,s-1,this,0,0,this.t),++this.t,this.clamp()}function Sh(s,c){if(s!=0){for(;this.t<=c;)this[this.t++]=0;for(this[c]+=s;this[c]>=this.DV;)this[c]-=this.DV,++c>=this.t&&(this[this.t++]=0),++this[c]}}function ha(){}function pa(s){return s}function wh(s,c,l){s.multiplyTo(c,l)}function Ml(s,c){s.squareTo(c)}ha.prototype.convert=pa,ha.prototype.revert=pa,ha.prototype.mulTo=wh,ha.prototype.sqrTo=Ml;function xh(s){return this.exp(s,new ha)}function Ll(s,c,l){var d=Math.min(this.t+s.t,c);for(l.s=0,l.t=d;d>0;)l[--d]=0;var v;for(v=l.t-this.t;d<v;++d)l[d+this.t]=this.am(0,s[d],l,d,0,this.t);for(v=Math.min(s.t,c);d<v;++d)this.am(0,s[d],l,d,0,c-d);l.clamp()}function Jo(s,c,l){--c;var d=l.t=this.t+s.t-c;for(l.s=0;--d>=0;)l[d]=0;for(d=Math.max(c-this.t,0);d<s.t;++d)l[this.t+d-c]=this.am(c-d,s[d],l,0,0,this.t+d-c);l.clamp(),l.drShiftTo(1,l)}function is(s){this.r2=w(),this.q3=w(),_.ONE.dlShiftTo(2*s.t,this.r2),this.mu=this.r2.divide(s),this.m=s}function Ch(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);if(s.compareTo(this.m)<0)return s;var c=w();return s.copyTo(c),this.reduce(c),c}function Eh(s){return s}function Ph(s){for(s.drShiftTo(this.m.t-1,this.r2),s.t>this.m.t+1&&(s.t=this.m.t+1,s.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);s.compareTo(this.r2)<0;)s.dAddOffset(1,this.m.t+1);for(s.subTo(this.r2,s);s.compareTo(this.m)>=0;)s.subTo(this.m,s)}function kh(s,c){s.squareTo(c),this.reduce(c)}function jl(s,c,l){s.multiplyTo(c,l),this.reduce(l)}is.prototype.convert=Ch,is.prototype.revert=Eh,is.prototype.reduce=Ph,is.prototype.mulTo=jl,is.prototype.sqrTo=kh;function Th(s,c){var l=s.bitLength(),d,v=K(1),m;if(l<=0)return v;l<18?d=1:l<48?d=3:l<144?d=4:l<768?d=5:d=6,l<8?m=new Ge(c):c.isEven()?m=new is(c):m=new fn(c);var T=new Array,k=3,O=d-1,F=(1<<d)-1;if(T[1]=m.convert(this),d>1){var U=w();for(m.sqrTo(T[1],U);k<=F;)T[k]=w(),m.mulTo(U,T[k-2],T[k]),k+=2}var L=s.t-1,P,D=!0,A=w(),N;for(l=_e(s[L])-1;L>=0;){for(l>=O?P=s[L]>>l-O&F:(P=(s[L]&(1<<l+1)-1)<<O-l,L>0&&(P|=s[L-1]>>this.DB+l-O)),k=d;!(P&1);)P>>=1,--k;if((l-=k)<0&&(l+=this.DB,--L),D)T[P].copyTo(v),D=!1;else{for(;k>1;)m.sqrTo(v,A),m.sqrTo(A,v),k-=2;k>0?m.sqrTo(v,A):(N=v,v=A,A=N),m.mulTo(A,T[P],v)}for(;L>=0&&!(s[L]&1<<l);)m.sqrTo(v,A),N=v,v=A,A=N,--l<0&&(l=this.DB-1,--L)}return m.revert(v)}function Rh(s){var c=this.s<0?this.negate():this.clone(),l=s.s<0?s.negate():s.clone();if(c.compareTo(l)<0){var d=c;c=l,l=d}var v=c.getLowestSetBit(),m=l.getLowestSetBit();if(m<0)return c;for(v<m&&(m=v),m>0&&(c.rShiftTo(m,c),l.rShiftTo(m,l));c.signum()>0;)(v=c.getLowestSetBit())>0&&c.rShiftTo(v,c),(v=l.getLowestSetBit())>0&&l.rShiftTo(v,l),c.compareTo(l)>=0?(c.subTo(l,c),c.rShiftTo(1,c)):(l.subTo(c,l),l.rShiftTo(1,l));return m>0&&l.lShiftTo(m,l),l}function Zo(s){if(s<=0)return 0;var c=this.DV%s,l=this.s<0?s-1:0;if(this.t>0)if(c==0)l=this[0]%s;else for(var d=this.t-1;d>=0;--d)l=(c*l+this[d])%s;return l}function Ah(s){var c=s.isEven();if(this.isEven()&&c||s.signum()==0)return _.ZERO;for(var l=s.clone(),d=this.clone(),v=K(1),m=K(0),T=K(0),k=K(1);l.signum()!=0;){for(;l.isEven();)l.rShiftTo(1,l),c?((!v.isEven()||!m.isEven())&&(v.addTo(this,v),m.subTo(s,m)),v.rShiftTo(1,v)):m.isEven()||m.subTo(s,m),m.rShiftTo(1,m);for(;d.isEven();)d.rShiftTo(1,d),c?((!T.isEven()||!k.isEven())&&(T.addTo(this,T),k.subTo(s,k)),T.rShiftTo(1,T)):k.isEven()||k.subTo(s,k),k.rShiftTo(1,k);l.compareTo(d)>=0?(l.subTo(d,l),c&&v.subTo(T,v),m.subTo(k,m)):(d.subTo(l,d),c&&T.subTo(v,T),k.subTo(m,k))}if(d.compareTo(_.ONE)!=0)return _.ZERO;if(k.compareTo(s)>=0)return k.subtract(s);if(k.signum()<0)k.addTo(s,k);else return k;return k.signum()<0?k.add(s):k}var Gn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ih=(1<<26)/Gn[Gn.length-1];function Fh(s){var c,l=this.abs();if(l.t==1&&l[0]<=Gn[Gn.length-1]){for(c=0;c<Gn.length;++c)if(l[0]==Gn[c])return!0;return!1}if(l.isEven())return!1;for(c=1;c<Gn.length;){for(var d=Gn[c],v=c+1;v<Gn.length&&d<Ih;)d*=Gn[v++];for(d=l.modInt(d);c<v;)if(d%Gn[c++]==0)return!1}return l.millerRabin(s)}function Xo(s){var c=this.subtract(_.ONE),l=c.getLowestSetBit();if(l<=0)return!1;var d=c.shiftRight(l);s=s+1>>1,s>Gn.length&&(s=Gn.length);for(var v=w(),m=0;m<s;++m){v.fromInt(Gn[Math.floor(Math.random()*Gn.length)]);var T=v.modPow(d,this);if(T.compareTo(_.ONE)!=0&&T.compareTo(c)!=0){for(var k=1;k++<l&&T.compareTo(c)!=0;)if(T=T.modPowInt(2,this),T.compareTo(_.ONE)==0)return!1;if(T.compareTo(c)!=0)return!1}}return!0}_.prototype.chunkSize=ct,_.prototype.toRadix=Fr,_.prototype.fromRadix=_r,_.prototype.fromNumber=Vt,_.prototype.bitwiseTo=Wa,_.prototype.changeBit=gh,_.prototype.addTo=Wo,_.prototype.dMultiply=rs,_.prototype.dAddOffset=Sh,_.prototype.multiplyLowerTo=Ll,_.prototype.multiplyUpperTo=Jo,_.prototype.modInt=Zo,_.prototype.millerRabin=Xo,_.prototype.clone=sr,_.prototype.intValue=yr,_.prototype.byteValue=ht,_.prototype.shortValue=_t,_.prototype.signum=$t,_.prototype.toByteArray=pt,_.prototype.equals=Hn,_.prototype.min=Ps,_.prototype.max=gn,_.prototype.and=rn,_.prototype.or=Al,_.prototype.xor=ri,_.prototype.andNot=Il,_.prototype.not=Ga,_.prototype.shiftLeft=Fl,_.prototype.shiftRight=Dl,_.prototype.getLowestSetBit=$o,_.prototype.bitCount=ns,_.prototype.testBit=mh,_.prototype.setBit=Wn,_.prototype.clearBit=da,_.prototype.flipBit=vh,_.prototype.add=yh,_.prototype.subtract=Ts,_.prototype.multiply=_h,_.prototype.divide=Ol,_.prototype.remainder=bh,_.prototype.divideAndRemainder=Go,_.prototype.modPow=Th,_.prototype.modInverse=Ah,_.prototype.pow=xh,_.prototype.gcd=Rh,_.prototype.isProbablePrime=Fh,_.prototype.square=Nl;function Qo(){this.i=0,this.j=0,this.S=new Array}function Dh(s){var c,l,d;for(c=0;c<256;++c)this.S[c]=c;for(l=0,c=0;c<256;++c)l=l+this.S[c]+s[c%s.length]&255,d=this.S[c],this.S[c]=this.S[l],this.S[l]=d;this.i=0,this.j=0}function Nh(){var s;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,s=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=s,this.S[s+this.S[this.i]&255]}Qo.prototype.init=Dh,Qo.prototype.next=Nh;function Oh(){return new Qo}var Yo=256,fa,ar,Tn;function Bl(s){ar[Tn++]^=s&255,ar[Tn++]^=s>>8&255,ar[Tn++]^=s>>16&255,ar[Tn++]^=s>>24&255,Tn>=Yo&&(Tn-=Yo)}function Ja(){Bl(new Date().getTime())}if(ar==null){if(ar=new Array,Tn=0,n!==void 0&&(n.crypto!==void 0||n.msCrypto!==void 0)){if(ec=n.crypto||n.msCrypto,ec.getRandomValues)for(Za=new Uint8Array(32),ec.getRandomValues(Za),Dr=0;Dr<32;++Dr)ar[Tn++]=Za[Dr];else if(t.appName=="Netscape"&&t.appVersion<"5")for(I=n.crypto.random(32),Dr=0;Dr<I.length;++Dr)ar[Tn++]=I.charCodeAt(Dr)&255}for(;Tn<Yo;)Dr=Math.floor(65536*Math.random()),ar[Tn++]=Dr>>>8,ar[Tn++]=Dr&255;Tn=0,Ja()}var Dr,ec,Za,I;function B(){if(fa==null){for(Ja(),fa=Oh(),fa.init(ar),Tn=0;Tn<ar.length;++Tn)ar[Tn]=0;Tn=0}return fa.next()}function V(s){var c;for(c=0;c<s.length;++c)s[c]=B()}function oe(){}oe.prototype.nextBytes=V;function be(s,c){return new _(s,c)}function xe(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Te(s,c){if(this.isPublic=!0,this.isPrivate=!1,typeof s!="string")this.n=s,this.e=c;else if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=be(s,16),this.e=parseInt(c,16);else throw"Invalid RSA public key"}function De(s){return s.modPowInt(this.e,this.n)}xe.prototype.doPublic=De,xe.prototype.setPublic=Te,xe.prototype.type="RSA";function Ve(s,c,l){if(this.isPrivate=!0,typeof s!="string")this.n=s,this.e=c,this.d=l;else if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=be(s,16),this.e=parseInt(c,16),this.d=be(l,16);else throw"Invalid RSA private key"}function Xe(s,c,l,d,v,m,T,k){if(this.isPrivate=!0,this.isPublic=!1,s==null)throw"RSASetPrivateEx N == null";if(c==null)throw"RSASetPrivateEx E == null";if(s.length==0)throw"RSASetPrivateEx N.length == 0";if(c.length==0)throw"RSASetPrivateEx E.length == 0";if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=be(s,16),this.e=parseInt(c,16),this.d=be(l,16),this.p=be(d,16),this.q=be(v,16),this.dmp1=be(m,16),this.dmq1=be(T,16),this.coeff=be(k,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function mt(s,c){var l=new oe,d=s>>1;this.e=parseInt(c,16);for(var v=new _(c,16),m=s/2-100,T=_.ONE.shiftLeft(m);;){for(;this.p=new _(s-d,1,l),!(this.p.subtract(_.ONE).gcd(v).compareTo(_.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new _(d,1,l),!(this.q.subtract(_.ONE).gcd(v).compareTo(_.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var k=this.p;this.p=this.q,this.q=k}var O=this.q.subtract(this.p).abs();if(!(O.bitLength()<m||O.compareTo(T)<=0)){var F=this.p.subtract(_.ONE),U=this.q.subtract(_.ONE),L=F.multiply(U);if(L.gcd(v).compareTo(_.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==s)){this.d=v.modInverse(L),this.dmp1=this.d.mod(F),this.dmq1=this.d.mod(U),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function Kt(s){if(this.p==null||this.q==null)return s.modPow(this.d,this.n);for(var c=s.mod(this.p).modPow(this.dmp1,this.p),l=s.mod(this.q).modPow(this.dmq1,this.q);c.compareTo(l)<0;)c=c.add(this.p);return c.subtract(l).multiply(this.coeff).mod(this.p).multiply(this.q).add(l)}xe.prototype.doPrivate=Kt,xe.prototype.setPrivate=Ve,xe.prototype.setPrivateEx=Xe,xe.prototype.generate=mt;function ot(s,c){this.x=c,this.q=s}function bt(s){return s==this?!0:this.q.equals(s.q)&&this.x.equals(s.x)}function st(){return this.x}function gt(){return new ot(this.q,this.x.negate().mod(this.q))}function Ct(s){return new ot(this.q,this.x.add(s.toBigInteger()).mod(this.q))}function Nt(s){return new ot(this.q,this.x.subtract(s.toBigInteger()).mod(this.q))}function Fn(s){return new ot(this.q,this.x.multiply(s.toBigInteger()).mod(this.q))}function Jt(){return new ot(this.q,this.x.square().mod(this.q))}function Jn(s){return new ot(this.q,this.x.multiply(s.toBigInteger().modInverse(this.q)).mod(this.q))}ot.prototype.equals=bt,ot.prototype.toBigInteger=st,ot.prototype.negate=gt,ot.prototype.add=Ct,ot.prototype.subtract=Nt,ot.prototype.multiply=Fn,ot.prototype.square=Jt,ot.prototype.divide=Jn,ot.prototype.sqrt=function(){return new ot(this.q,this.x.sqrt().mod(this.q))};function lt(s,c,l,d){this.curve=s,this.x=c,this.y=l,d==null?this.z=_.ONE:this.z=d,this.zinv=null}function St(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Lt(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Ut(s){if(s==this)return!0;if(this.isInfinity())return s.isInfinity();if(s.isInfinity())return this.isInfinity();var c,l;return c=s.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(s.z)).mod(this.curve.q),c.equals(_.ZERO)?(l=s.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(s.z)).mod(this.curve.q),l.equals(_.ZERO)):!1}function Rt(){return this.x==null&&this.y==null?!0:this.z.equals(_.ZERO)&&!this.y.toBigInteger().equals(_.ZERO)}function jt(){return new lt(this.curve,this.x,this.y.negate(),this.z)}function Ht(s){if(this.isInfinity())return s;if(s.isInfinity())return this;var c=s.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(s.z)).mod(this.curve.q),l=s.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(s.z)).mod(this.curve.q);if(_.ZERO.equals(l))return _.ZERO.equals(c)?this.twice():this.curve.getInfinity();var d=new _("3"),v=this.x.toBigInteger(),m=this.y.toBigInteger();s.x.toBigInteger(),s.y.toBigInteger();var T=l.square(),k=T.multiply(l),O=v.multiply(T),F=c.square().multiply(this.z),U=F.subtract(O.shiftLeft(1)).multiply(s.z).subtract(k).multiply(l).mod(this.curve.q),L=O.multiply(d).multiply(c).subtract(m.multiply(k)).subtract(F.multiply(c)).multiply(s.z).add(c.multiply(k)).mod(this.curve.q),P=k.multiply(this.z).multiply(s.z).mod(this.curve.q);return new lt(this.curve,this.curve.fromBigInteger(U),this.curve.fromBigInteger(L),P)}function Rs(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var s=new _("3"),c=this.x.toBigInteger(),l=this.y.toBigInteger(),d=l.multiply(this.z),v=d.multiply(l).mod(this.curve.q),m=this.curve.a.toBigInteger(),T=c.square().multiply(s);_.ZERO.equals(m)||(T=T.add(this.z.square().multiply(m))),T=T.mod(this.curve.q);var k=T.square().subtract(c.shiftLeft(3).multiply(v)).shiftLeft(1).multiply(d).mod(this.curve.q),O=T.multiply(s).multiply(c).subtract(v.shiftLeft(1)).shiftLeft(2).multiply(v).subtract(T.square().multiply(T)).mod(this.curve.q),F=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new lt(this.curve,this.curve.fromBigInteger(k),this.curve.fromBigInteger(O),F)}function r2(s){if(this.isInfinity())return this;if(s.signum()==0)return this.curve.getInfinity();var c=s,l=c.multiply(new _("3")),d=this.negate(),v=this,m=this.curve.q.subtract(s),T=m.multiply(new _("3")),k=new lt(this.curve,this.x,this.y),O=k.negate(),F;for(F=l.bitLength()-2;F>0;--F){v=v.twice();var U=l.testBit(F),L=c.testBit(F);U!=L&&(v=v.add(U?this:d))}for(F=T.bitLength()-2;F>0;--F){k=k.twice();var P=T.testBit(F),D=m.testBit(F);P!=D&&(k=k.add(P?k:O))}return v}function i2(s,c,l){var d;s.bitLength()>l.bitLength()?d=s.bitLength()-1:d=l.bitLength()-1;for(var v=this.curve.getInfinity(),m=this.add(c);d>=0;)v=v.twice(),s.testBit(d)?l.testBit(d)?v=v.add(m):v=v.add(this):l.testBit(d)&&(v=v.add(c)),--d;return v}lt.prototype.getX=St,lt.prototype.getY=Lt,lt.prototype.equals=Ut,lt.prototype.isInfinity=Rt,lt.prototype.negate=jt,lt.prototype.add=Ht,lt.prototype.twice=Rs,lt.prototype.multiply=r2,lt.prototype.multiplyTwo=i2;function ss(s,c,l){this.q=s,this.a=this.fromBigInteger(c),this.b=this.fromBigInteger(l),this.infinity=new lt(this,null,null)}function s2(){return this.q}function a2(){return this.a}function o2(){return this.b}function c2(s){return s==this?!0:this.q.equals(s.q)&&this.a.equals(s.a)&&this.b.equals(s.b)}function l2(){return this.infinity}function u2(s){return new ot(this.q,s)}function d2(s){switch(parseInt(s.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var c=s.substr(0,2);s.substr(2);var l=this.fromBigInteger(new _(O,16)),d=this.getA(),v=this.getB(),m=l.square().add(d).multiply(l).add(v),T=m.sqrt();return c=="03"&&(T=T.negate()),new lt(this,l,T);case 4:case 6:case 7:var k=(s.length-2)/2,O=s.substr(2,k),F=s.substr(k+2,k);return new lt(this,this.fromBigInteger(new _(O,16)),this.fromBigInteger(new _(F,16)));default:return null}}ss.prototype.getQ=s2,ss.prototype.getA=a2,ss.prototype.getB=o2,ss.prototype.equals=c2,ss.prototype.getInfinity=l2,ss.prototype.fromBigInteger=u2,ss.prototype.decodePointHex=d2,ot.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},lt.prototype.getEncoded=function(s){var c=function(m,T){var k=m.toByteArrayUnsigned();if(T<k.length)k=k.slice(k.length-T);else for(;T>k.length;)k.unshift(0);return k},l=this.getX().toBigInteger(),d=this.getY().toBigInteger(),v=c(l,32);return s?d.isEven()?v.unshift(2):v.unshift(3):(v.unshift(4),v=v.concat(c(d,32))),v},lt.decodeFrom=function(s,c){c[0];var l=c.length-1,d=c.slice(1,1+l/2),v=c.slice(1+l/2,1+l);d.unshift(0),v.unshift(0);var m=new _(d),T=new _(v);return new lt(s,s.fromBigInteger(m),s.fromBigInteger(T))},lt.decodeFromHex=function(s,c){c.substr(0,2);var l=c.length-2,d=c.substr(2,l/2),v=c.substr(2+l/2,l/2),m=new _(d,16),T=new _(v,16);return new lt(s,s.fromBigInteger(m),s.fromBigInteger(T))},lt.prototype.add2D=function(s){if(this.isInfinity())return s;if(s.isInfinity())return this;if(this.x.equals(s.x))return this.y.equals(s.y)?this.twice():this.curve.getInfinity();var c=s.x.subtract(this.x),l=s.y.subtract(this.y),d=l.divide(c),v=d.square().subtract(this.x).subtract(s.x),m=d.multiply(this.x.subtract(v)).subtract(this.y);return new lt(this.curve,v,m)},lt.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var s=this.curve.fromBigInteger(_.valueOf(2)),c=this.curve.fromBigInteger(_.valueOf(3)),l=this.x.square().multiply(c).add(this.curve.a).divide(this.y.multiply(s)),d=l.square().subtract(this.x.multiply(s)),v=l.multiply(this.x.subtract(d)).subtract(this.y);return new lt(this.curve,d,v)},lt.prototype.multiply2D=function(s){if(this.isInfinity())return this;if(s.signum()==0)return this.curve.getInfinity();var c=s,l=c.multiply(new _("3")),d=this.negate(),v=this,m;for(m=l.bitLength()-2;m>0;--m){v=v.twice();var T=l.testBit(m),k=c.testBit(m);T!=k&&(v=v.add2D(T?this:d))}return v},lt.prototype.isOnCurve=function(){var s=this.getX().toBigInteger(),c=this.getY().toBigInteger(),l=this.curve.getA().toBigInteger(),d=this.curve.getB().toBigInteger(),v=this.curve.getQ(),m=c.multiply(c).mod(v),T=s.multiply(s).multiply(s).add(l.multiply(s)).add(d).mod(v);return m.equals(T)},lt.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},lt.prototype.validate=function(){var s=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var c=this.getX().toBigInteger(),l=this.getY().toBigInteger();if(c.compareTo(_.ONE)<0||c.compareTo(s.subtract(_.ONE))>0)throw new Error("x coordinate out of bounds");if(l.compareTo(_.ONE)<0||l.compareTo(s.subtract(_.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(s).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var lg=function(){var s="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",c='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',l='(?:"'+c+'*")',d=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+s+"|"+l+")","g"),v=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),m={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function T(U,L,P){return L?m[L]:String.fromCharCode(parseInt(P,16))}var k=new String(""),O="\\",F=Object.hasOwnProperty;return function(U,L){var P=U.match(d),D,A=P[0],N=!1;A==="{"?D={}:A==="["?D=[]:(D=[],N=!0);for(var j,W=[D],se=1-N,de=P.length;se<de;++se){A=P[se];var ue;switch(A.charCodeAt(0)){default:ue=W[0],ue[j||ue.length]=+A,j=void 0;break;case 34:if(A=A.substring(1,A.length-1),A.indexOf(O)!==-1&&(A=A.replace(v,T)),ue=W[0],!j)if(ue instanceof Array)j=ue.length;else{j=A||k;break}ue[j]=A,j=void 0;break;case 91:ue=W[0],W.unshift(ue[j||ue.length]=[]),j=void 0;break;case 93:W.shift();break;case 102:ue=W[0],ue[j||ue.length]=!1,j=void 0;break;case 110:ue=W[0],ue[j||ue.length]=null,j=void 0;break;case 116:ue=W[0],ue[j||ue.length]=!0,j=void 0;break;case 123:ue=W[0],W.unshift(ue[j||ue.length]={}),j=void 0;break;case 125:W.shift();break}}if(N){if(W.length!==1)throw new Error;D=D[0]}else if(W.length)throw new Error;if(L){var pe=function(G,X){var te=G[X];if(te&&typeof te=="object"){var J=null;for(var re in te)if(F.call(te,re)&&te!==G){var he=pe(te,re);he!==void 0?te[re]=he:(J||(J=[]),J.push(re))}if(J)for(var ye=J.length;--ye>=0;)delete te[J[ye]]}return L.call(G,X,te)};D=pe({"":D},"")}return D}}();(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),y.asn1.ASN1Util=new function(){this.integerToByteHex=function(s){var c=s.toString(16);return c.length%2==1&&(c="0"+c),c},this.bigIntToMinTwosComplementsHex=function(s){return rc(s)},this.getPEMStringFromHex=function(s,c){return or(s,c)},this.newObject=function(s){var c=y,l=c.asn1,d=l.ASN1Object,v=l.DERBoolean,m=l.DERInteger,T=l.DERBitString,k=l.DEROctetString,O=l.DERNull,F=l.DERObjectIdentifier,U=l.DEREnumerated,L=l.DERUTF8String,P=l.DERNumericString,D=l.DERPrintableString,A=l.DERTeletexString,N=l.DERIA5String,j=l.DERUTCTime,W=l.DERGeneralizedTime,se=l.DERVisibleString,de=l.DERBMPString,ue=l.DERSequence,pe=l.DERSet,G=l.DERTaggedObject,X=l.ASN1Util.newObject;if(s instanceof l.ASN1Object)return s;var te=Object.keys(s);if(te.length!=1)throw new Error("key of param shall be only one.");var J=te[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+J+":")==-1)throw new Error("undefined key: "+J);if(J=="bool")return new v(s[J]);if(J=="int")return new m(s[J]);if(J=="bitstr")return new T(s[J]);if(J=="octstr")return new k(s[J]);if(J=="null")return new O(s[J]);if(J=="oid")return new F(s[J]);if(J=="enum")return new U(s[J]);if(J=="utf8str")return new L(s[J]);if(J=="numstr")return new P(s[J]);if(J=="prnstr")return new D(s[J]);if(J=="telstr")return new A(s[J]);if(J=="ia5str")return new N(s[J]);if(J=="utctime")return new j(s[J]);if(J=="gentime")return new W(s[J]);if(J=="visstr")return new se(s[J]);if(J=="bmpstr")return new de(s[J]);if(J=="asn1")return new d(s[J]);if(J=="seq"){for(var re=s[J],he=[],ye=0;ye<re.length;ye++){var Fe=X(re[ye]);he.push(Fe)}return new ue({array:he})}if(J=="set"){for(var re=s[J],he=[],ye=0;ye<re.length;ye++){var Fe=X(re[ye]);he.push(Fe)}return new pe({array:he})}if(J=="tag"){var ge=s[J];if(Object.prototype.toString.call(ge)==="[object Array]"&&ge.length==3){var Pe=X(ge[2]);return new G({tag:ge[0],explicit:ge[1],obj:Pe})}else return new G(ge)}},this.jsonToASN1HEX=function(s){var c=this.newObject(s);return c.tohex()}},y.asn1.ASN1Util.oidHexToInt=function(s){for(var v="",c=parseInt(s.substr(0,2),16),l=Math.floor(c/40),d=c%40,v=l+"."+d,m="",T=2;T<s.length;T+=2){var k=parseInt(s.substr(T,2),16),O=("00000000"+k.toString(2)).slice(-8);if(m=m+O.substr(1,7),O.substr(0,1)=="0"){var F=new _(m,2);v=v+"."+F.toString(10),m=""}}return v},y.asn1.ASN1Util.oidIntToHex=function(s){var c=function(k){var O=k.toString(16);return O.length==1&&(O="0"+O),O},l=function(k){var O="",F=new _(k,10),U=F.toString(2),L=7-U.length%7;L==7&&(L=0);for(var P="",D=0;D<L;D++)P+="0";U=P+U;for(var D=0;D<U.length-1;D+=7){var A=U.substr(D,7);D!=U.length-7&&(A="1"+A),O+=c(parseInt(A,2))}return O};if(!s.match(/^[0-9.]+$/))throw"malformed oid string: "+s;var d="",v=s.split("."),m=parseInt(v[0])*40+parseInt(v[1]);d+=c(m),v.splice(0,2);for(var T=0;T<v.length;T++)d+=l(v[T]);return d},y.asn1.ASN1Object=function(s){var c="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+c.length+",v="+this.hV);var l=this.hV.length/2,d=l.toString(16);if(d.length%2==1&&(d="0"+d),l<128)return d;var v=d.length/2;if(v>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+l.toString(16));var m=128+v;return m.toString(16)+d},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(l){this.params=l},s!=null&&s.tlv!=null&&(this.hTLV=s.tlv,this.isModified=!1)},y.asn1.DERAbstractString=function(s){y.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(c){this.hTLV=null,this.isModified=!0,this.s=c,this.hV=Hl(this.s).toLowerCase()},this.setStringHex=function(c){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=c},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s=="string"?this.setString(s):typeof s.str<"u"?this.setString(s.str):typeof s.hex<"u"&&this.setStringHex(s.hex))},Ie(y.asn1.DERAbstractString,y.asn1.ASN1Object),y.asn1.DERAbstractTime=function(s){y.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(c){var l=c.getTime()+c.getTimezoneOffset()*6e4,d=new Date(l);return d},this.formatDate=function(c,l,d){var v=this.zeroPadding,m=this.localDateToUTC(c),T=String(m.getFullYear());l=="utc"&&(T=T.substr(2,2));var k=v(String(m.getMonth()+1),2),O=v(String(m.getDate()),2),F=v(String(m.getHours()),2),U=v(String(m.getMinutes()),2),L=v(String(m.getSeconds()),2),P=T+k+O+F+U+L;if(d===!0){var D=m.getMilliseconds();if(D!=0){var A=v(String(D),3);A=A.replace(/[0]+$/,""),P=P+"."+A}}return P+"Z"},this.zeroPadding=function(c,l){return c.length>=l?c:new Array(l-c.length+1).join("0")+c},this.setByParam=function(c){this.hV=null,this.hTLV=null,this.params=c},this.getString=function(){},this.setString=function(c){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=c},this.setByDate=function(c){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=c},this.setByDateValue=function(c,l,d,v,m,T){var k=new Date(Date.UTC(c,l-1,d,v,m,T,0));this.setByDate(k)},this.getFreshValueHex=function(){return this.hV}},Ie(y.asn1.DERAbstractTime,y.asn1.ASN1Object),y.asn1.DERAbstractStructured=function(s){y.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array=c},this.appendASN1Object=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array.push(c)},this.asn1Array=new Array,typeof s<"u"&&typeof s.array<"u"&&(this.asn1Array=s.array)},Ie(y.asn1.DERAbstractStructured,y.asn1.ASN1Object),y.asn1.DERBoolean=function(s){y.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",s==!1?this.hTLV="010100":this.hTLV="0101ff"},Ie(y.asn1.DERBoolean,y.asn1.ASN1Object),y.asn1.DERInteger=function(s){y.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var c=rc;this.setByBigInteger=function(l){this.isModified=!0,this.params={bigint:l}},this.setByInteger=function(l){this.isModified=!0,this.params=l},this.setValueHex=function(l){this.isModified=!0,this.params={hex:l}},this.getFreshValueHex=function(){var l=this.params,d=null;if(l==null)throw new Error("value not set");if(typeof l=="object"&&l.hex!=null)return this.hV=l.hex,this.hV;if(typeof l=="number")d=new _(String(l),10);else if(l.int!=null)d=new _(String(l.int),10);else if(l.bigint!=null)d=l.bigint;else throw new Error("wrong parameter");return this.hV=c(d),this.hV},s!=null&&(this.params=s)},Ie(y.asn1.DERInteger,y.asn1.ASN1Object),y.asn1.DERBitString=function(s){if(s!==void 0&&typeof s.obj<"u"){var c=y.asn1.ASN1Util.newObject(s.obj);s.hex="00"+c.tohex()}y.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(l){this.hTLV=null,this.isModified=!0,this.hV=l},this.setUnusedBitsAndHexValue=function(l,d){if(l<0||7<l)throw"unused bits shall be from 0 to 7: u = "+l;var v="0"+l;this.hTLV=null,this.isModified=!0,this.hV=v+d},this.setByBinaryString=function(l){l=l.replace(/0+$/,"");var d=8-l.length%8;d==8&&(d=0),l+="0000000".substr(0,d);for(var v="",m=0;m<l.length-1;m+=8){var T=l.substr(m,8),k=parseInt(T,2).toString(16);k.length==1&&(k="0"+k),v+=k}this.hTLV=null,this.isModified=!0,this.hV="0"+d+v},this.setByBooleanArray=function(l){for(var d="",v=0;v<l.length;v++)l[v]==!0?d+="1":d+="0";this.setByBinaryString(d)},this.newFalseArray=function(l){for(var d=new Array(l),v=0;v<l;v++)d[v]=!1;return d},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s=="string"&&s.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(s):typeof s.hex<"u"?this.setHexValueIncludingUnusedBits(s.hex):typeof s.bin<"u"?this.setByBinaryString(s.bin):typeof s.array<"u"&&this.setByBooleanArray(s.array))},Ie(y.asn1.DERBitString,y.asn1.ASN1Object),y.asn1.DEROctetString=function(s){if(s!==void 0&&typeof s.obj<"u"){var c=y.asn1.ASN1Util.newObject(s.obj);s.hex=c.tohex()}y.asn1.DEROctetString.superclass.constructor.call(this,s),this.hT="04"},Ie(y.asn1.DEROctetString,y.asn1.DERAbstractString),y.asn1.DERNull=function(){y.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Ie(y.asn1.DERNull,y.asn1.ASN1Object),y.asn1.DERObjectIdentifier=function(s){y.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(c){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=c},this.setValueOidString=function(c){var l=yg(c);if(l==null)throw new Error("malformed oid string: "+c);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=l},this.setValueName=function(c){var l=y.asn1.x509.OID.name2oid(c);if(l!=="")this.setValueOidString(l);else throw new Error("DERObjectIdentifier oidName undefined: "+c)},this.setValueNameOrOid=function(c){c.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(c):this.setValueName(c)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(c){typeof c=="string"?this.setValueNameOrOid(c):c.oid!==void 0?this.setValueNameOrOid(c.oid):c.name!==void 0?this.setValueNameOrOid(c.name):c.hex!==void 0&&this.setValueHex(c.hex)},s!==void 0&&this.setByParam(s)},Ie(y.asn1.DERObjectIdentifier,y.asn1.ASN1Object),y.asn1.DEREnumerated=function(s){y.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(c){this.hTLV=null,this.isModified=!0,this.hV=rc(c)},this.setByInteger=function(c){var l=new _(String(c),10);this.setByBigInteger(l)},this.setValueHex=function(c){this.hV=c},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s.int<"u"?this.setByInteger(s.int):typeof s=="number"?this.setByInteger(s):typeof s.hex<"u"&&this.setValueHex(s.hex))},Ie(y.asn1.DEREnumerated,y.asn1.ASN1Object),y.asn1.DERUTF8String=function(s){y.asn1.DERUTF8String.superclass.constructor.call(this,s),this.hT="0c"},Ie(y.asn1.DERUTF8String,y.asn1.DERAbstractString),y.asn1.DERNumericString=function(s){y.asn1.DERNumericString.superclass.constructor.call(this,s),this.hT="12"},Ie(y.asn1.DERNumericString,y.asn1.DERAbstractString),y.asn1.DERPrintableString=function(s){y.asn1.DERPrintableString.superclass.constructor.call(this,s),this.hT="13"},Ie(y.asn1.DERPrintableString,y.asn1.DERAbstractString),y.asn1.DERTeletexString=function(s){y.asn1.DERTeletexString.superclass.constructor.call(this,s),this.hT="14"},Ie(y.asn1.DERTeletexString,y.asn1.DERAbstractString),y.asn1.DERIA5String=function(s){y.asn1.DERIA5String.superclass.constructor.call(this,s),this.hT="16"},Ie(y.asn1.DERIA5String,y.asn1.DERAbstractString),y.asn1.DERVisibleString=function(s){y.asn1.DERIA5String.superclass.constructor.call(this,s),this.hT="1a"},Ie(y.asn1.DERVisibleString,y.asn1.DERAbstractString),y.asn1.DERBMPString=function(s){y.asn1.DERBMPString.superclass.constructor.call(this,s),this.hT="1e"},Ie(y.asn1.DERBMPString,y.asn1.DERAbstractString),y.asn1.DERUTCTime=function(s){y.asn1.DERUTCTime.superclass.constructor.call(this,s),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var c=this.params;if(this.params==null&&(c={date:new Date}),typeof c=="string")if(c.match(/^[0-9]{12}Z$/)||c.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=Nr(c);else throw new Error("malformed string for UTCTime: "+c);else if(c.str!=null)this.hV=Nr(c.str);else if(c.date==null&&c.millis==!0){var l=new Date;this.hV=Nr(this.formatDate(l,"utc",!0))}else if(c.date!=null&&c.date instanceof Date){var d=c.millis===!0;this.hV=Nr(this.formatDate(c.date,"utc",d))}else c instanceof Date&&(this.hV=Nr(this.formatDate(c,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},s!=null&&this.setByParam(s)},Ie(y.asn1.DERUTCTime,y.asn1.DERAbstractTime),y.asn1.DERGeneralizedTime=function(s){y.asn1.DERGeneralizedTime.superclass.constructor.call(this,s),this.hT="18",this.params=s,this.getFreshValueHex=function(){var c=this.params;if(this.params==null&&(c={date:new Date}),typeof c=="string")if(c.match(/^[0-9]{14}Z$/)||c.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=Nr(c);else throw new Error("malformed string for GeneralizedTime: "+c);else if(c.str!=null)this.hV=Nr(c.str);else if(c.date==null&&c.millis==!0){var l=new Date;this.hV=Nr(this.formatDate(l,"gen",!0))}else if(c.date!=null&&c.date instanceof Date){var d=c.millis===!0;this.hV=Nr(this.formatDate(c.date,"gen",d))}else c instanceof Date&&(this.hV=Nr(this.formatDate(c,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},s!=null&&this.setByParam(s)},Ie(y.asn1.DERGeneralizedTime,y.asn1.DERAbstractTime),y.asn1.DERSequence=function(s){y.asn1.DERSequence.superclass.constructor.call(this,s),this.hT="30",this.getFreshValueHex=function(){for(var c="",l=0;l<this.asn1Array.length;l++){var d=this.asn1Array[l];c+=d.tohex()}return this.hV=c,this.hV}},Ie(y.asn1.DERSequence,y.asn1.DERAbstractStructured),y.asn1.DERSet=function(s){y.asn1.DERSet.superclass.constructor.call(this,s),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var c=new Array,l=0;l<this.asn1Array.length;l++){var d=this.asn1Array[l];c.push(d.tohex())}return this.sortFlag==!0&&c.sort(),this.hV=c.join(""),this.hV},typeof s<"u"&&typeof s.sortflag<"u"&&s.sortflag==!1&&(this.sortFlag=!1)},Ie(y.asn1.DERSet,y.asn1.DERAbstractStructured),y.asn1.DERTaggedObject=function(s){y.asn1.DERTaggedObject.superclass.constructor.call(this);var c=y.asn1,l=Be,d=l.getV;l.isASN1HEX;var v=c.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(m,T,k){this.params={tag:T,explicit:m,obj:k}},this.getFreshValueHex=function(){var m=this.params;if(m.explicit==null&&(m.explicit=!0),m.tage!=null&&(m.tag=m.tage,m.explicit=!0),m.tagi!=null&&(m.tag=m.tagi,m.explicit=!1),m.str!=null)this.hV=Hl(m.str);else if(m.hex!=null)this.hV=m.hex;else if(m.obj!=null){var T;m.obj instanceof c.ASN1Object?T=m.obj.tohex():typeof m.obj=="object"&&(T=v(m.obj).tohex()),m.explicit?this.hV=T:this.hV=d(T,0)}else throw new Error("str, hex nor obj not specified");return m.tag==null&&(m.tag="a0"),this.hT=m.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(m){this.params=m},s!==void 0&&this.setByParam(s)},Ie(y.asn1.DERTaggedObject,y.asn1.ASN1Object);var Be=new function(){};Be.getLblen=function(s,c){if(s.substr(c+2,1)!="8")return 1;var l=parseInt(s.substr(c+3,1));return l==0?-1:0<l&&l<10?l+1:-2},Be.getL=function(s,c){var l=Be.getLblen(s,c);return l<1?"":s.substr(c+2,l*2)},Be.getVblen=function(s,c){var l,d;return l=Be.getL(s,c),l==""?-1:(l.substr(0,1)==="8"?d=new _(l.substr(2),16):d=new _(l,16),d.intValue())},Be.getVidx=function(s,c){var l=Be.getLblen(s,c);return l<0?l:c+(l+1)*2},Be.getV=function(s,c){var l=Be.getVidx(s,c),d=Be.getVblen(s,c);return s.substr(l,d*2)},Be.getTLV=function(s,c){return s.substr(c,2)+Be.getL(s,c)+Be.getV(s,c)},Be.getTLVblen=function(s,c){return 2+Be.getLblen(s,c)*2+Be.getVblen(s,c)*2},Be.getNextSiblingIdx=function(s,c){var l=Be.getVidx(s,c),d=Be.getVblen(s,c);return l+d*2},Be.getChildIdx=function(s,c){var l=Be,d=[],v,m,T;v=l.getVidx(s,c),m=l.getVblen(s,c)*2,s.substr(c,2)=="03"&&(v+=2,m-=2),T=0;for(var k=v;T<=m;){var O=l.getTLVblen(s,k);if(T+=O,T<=m&&d.push(k),k+=O,T>=m)break}return d},Be.getNthChildIdx=function(s,c,l){var d=Be.getChildIdx(s,c);return d[l]},Be.getIdxbyList=function(s,c,l,d){var v=Be,m,T;return l.length==0?d!==void 0&&s.substr(c,2)!==d?-1:c:(m=l.shift(),T=v.getChildIdx(s,c),m>=T.length?-1:v.getIdxbyList(s,T[m],l,d))},Be.getIdxbyListEx=function(s,c,l,d){var v=Be,m,T;if(l.length==0)return d!==void 0&&s.substr(c,2)!==d?-1:c;m=l.shift(),T=v.getChildIdx(s,c);for(var k=0,O=0;O<T.length;O++){var F=s.substr(T[O],2);if(typeof m=="number"&&!v.isContextTag(F)&&k==m||typeof m=="string"&&v.isContextTag(F,m))return v.getIdxbyListEx(s,T[O],l,d);v.isContextTag(F)||k++}return-1},Be.getTLVbyList=function(s,c,l,d){var v=Be,m=v.getIdxbyList(s,c,l,d);return m==-1||m>=s.length?null:v.getTLV(s,m)},Be.getTLVbyListEx=function(s,c,l,d){var v=Be,m=v.getIdxbyListEx(s,c,l,d);return m==-1?null:v.getTLV(s,m)},Be.getVbyList=function(s,c,l,d,v){var m=Be,T,k;return T=m.getIdxbyList(s,c,l,d),T==-1||T>=s.length?null:(k=m.getV(s,T),v===!0&&(k=k.substr(2)),k)},Be.getVbyListEx=function(s,c,l,d,v){var m=Be,T,k;return T=m.getIdxbyListEx(s,c,l,d),T==-1?null:(k=m.getV(s,T),s.substr(T,2)=="03"&&v!==!1&&(k=k.substr(2)),k)},Be.getInt=function(s,c,l){l==null&&(l=-1);try{var d=s.substr(c,2);if(d!="02"&&d!="03")return l;var v=Be.getV(s,c);return d=="02"?parseInt(v,16):bg(v)}catch{return l}},Be.getOID=function(s,c,l){l==null&&(l=null);try{if(s.substr(c,2)!="06")return l;var d=Be.getV(s,c);return Wl(d)}catch{return l}},Be.getOIDName=function(s,c,l){l==null&&(l=null);try{var d=Be.getOID(s,c,l);if(d==l)return l;var v=y.asn1.x509.OID.oid2name(d);return v==""?d:v}catch{return l}},Be.getString=function(s,c,l){l==null&&(l=null);try{var d=Be.getV(s,c);return Or(d)}catch{return l}},Be.hextooidstr=function(s){var c=function(L,P){return L.length>=P?L:new Array(P-L.length+1).join("0")+L},l=[],d=s.substr(0,2),v=parseInt(d,16);l[0]=new String(Math.floor(v/40)),l[1]=new String(v%40);for(var m=s.substr(2),T=[],k=0;k<m.length/2;k++)T.push(parseInt(m.substr(k*2,2),16));for(var O=[],F="",k=0;k<T.length;k++)T[k]&128?F=F+c((T[k]&127).toString(2),7):(F=F+c((T[k]&127).toString(2),7),O.push(new String(parseInt(F,2))),F="");var U=l.join(".");return O.length>0&&(U=U+"."+O.join(".")),U},Be.dump=function(s,c,l,d){var v=Be,m=v.getV,T=v.dump,k=v.getChildIdx,O=s;s instanceof y.asn1.ASN1Object&&(O=s.tohex());var F=function(X,te){if(X.length<=te*2)return X;var J=X.substr(0,te)+"..(total "+X.length/2+"bytes).."+X.substr(X.length-te,te);return J};c===void 0&&(c={ommit_long_octet:32}),l===void 0&&(l=0),d===void 0&&(d="");var U=c.ommit_long_octet,pe=O.substr(l,2);if(pe=="01"){var L=m(O,l);return L=="00"?d+`BOOLEAN FALSE
`:d+`BOOLEAN TRUE
`}if(pe=="02"){var L=m(O,l);return d+"INTEGER "+F(L,U)+`
`}if(pe=="03"){var L=m(O,l);if(v.isASN1HEX(L.substr(2))){var P=d+`BITSTRING, encapsulates
`;return P=P+T(L.substr(2),c,0,d+"  "),P}else return d+"BITSTRING "+F(L,U)+`
`}if(pe=="04"){var L=m(O,l);if(v.isASN1HEX(L)){var P=d+`OCTETSTRING, encapsulates
`;return P=P+T(L,c,0,d+"  "),P}else return d+"OCTETSTRING "+F(L,U)+`
`}if(pe=="05")return d+`NULL
`;if(pe=="06"){var D=m(O,l),A=y.asn1.ASN1Util.oidHexToInt(D),N=y.asn1.x509.OID.oid2name(A),j=A.replace(/\./g," ");return N!=""?d+"ObjectIdentifier "+N+" ("+j+`)
`:d+"ObjectIdentifier ("+j+`)
`}if(pe=="0a")return d+"ENUMERATED "+parseInt(m(O,l))+`
`;if(pe=="0c")return d+"UTF8String '"+Zt(m(O,l))+`'
`;if(pe=="13")return d+"PrintableString '"+Zt(m(O,l))+`'
`;if(pe=="14")return d+"TeletexString '"+Zt(m(O,l))+`'
`;if(pe=="16")return d+"IA5String '"+Zt(m(O,l))+`'
`;if(pe=="17")return d+"UTCTime "+Zt(m(O,l))+`
`;if(pe=="18")return d+"GeneralizedTime "+Zt(m(O,l))+`
`;if(pe=="1a")return d+"VisualString '"+Zt(m(O,l))+`'
`;if(pe=="1e")return d+"BMPString '"+Hh(m(O,l))+`'
`;if(pe=="30"){if(O.substr(l,4)=="3000")return d+`SEQUENCE {}
`;var P=d+`SEQUENCE
`,W=k(O,l),se=c;if((W.length==2||W.length==3)&&O.substr(W[0],2)=="06"&&O.substr(W[W.length-1],2)=="04"){var N=v.oidname(m(O,W[0])),de=JSON.parse(JSON.stringify(c));de.x509ExtName=N,se=de}for(var ue=0;ue<W.length;ue++)P=P+T(O,se,W[ue],d+"  ");return P}if(pe=="31"){for(var P=d+`SET
`,W=k(O,l),ue=0;ue<W.length;ue++)P=P+T(O,c,W[ue],d+"  ");return P}var pe=parseInt(pe,16);if(pe&128){var G=pe&31;if(pe&32){for(var P=d+"["+G+`]
`,W=k(O,l),ue=0;ue<W.length;ue++)P=P+T(O,c,W[ue],d+"  ");return P}else{var L=m(O,l);if(Be.isASN1HEX(L)){var P=d+"["+G+`]
`;return P=P+T(L,c,0,d+"  "),P}else(L.substr(0,8)=="68747470"||c.x509ExtName==="subjectAltName"&&G==2)&&(L=Zt(L));var P=d+"["+G+"] "+L+`
`;return P}}return d+"UNKNOWN("+pe+") "+m(O,l)+`
`},Be.parse=function(s){var c=Be,l=c.parse,d=c.isASN1HEX,v=c.getV,m=c.getTLV,T=c.getChildIdx,k=y.asn1,O=k.ASN1Util.oidHexToInt,F=k.x509.OID.oid2name,U=Zt,L=Hh,P=v2,D={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},A=function(J){for(var re=[],he=T(J,0),ye=0;ye<he.length;ye++){var Fe=he[ye],ge=m(J,Fe),Pe=l(ge);re.push(Pe)}return re},N=s.substr(0,2),j={},W=v(s,0);if(N=="01")return s=="0101ff"?{bool:!0}:{bool:!1};if(N=="02")return{int:{hex:W}};if(N=="03")try{if(W.substr(0,2)!="00")throw"not encap";var se=W.substr(2);if(!d(se))throw"not encap";return{bitstr:{obj:l(se)}}}catch{var de=null;return W.length<=10&&(de=wg(W)),de==null?{bitstr:{hex:W}}:{bitstr:{bin:de}}}else if(N=="04")try{if(!d(W))throw"not encap";return{octstr:{obj:l(W)}}}catch{return{octstr:{hex:W}}}else{if(N=="05")return{null:""};if(N=="06"){var ue=O(W),pe=F(ue);return pe==""?{oid:ue}:{oid:pe}}else{if(N=="0a")return W.length>4?{enum:{hex:W}}:{enum:parseInt(W,16)};if(N=="30"||N=="31")return j[D[N]]=A(s),j;if(N=="14"){var G=P(W);return j[D[N]]={str:G},j}else if(N=="1e"){var G=L(W);return j[D[N]]={str:G},j}else if(":0c:12:13:16:17:18:1a:".indexOf(N)!=-1){var G=U(W);return j[D[N]]={str:G},j}else if(N.match(/^8[0-9]$/)){var G=U(W);return G==null|G==""?{tag:{tag:N,explicit:!1,hex:W}}:G.match(/[\x00-\x1F\x7F-\x9F]/)!=null||G.match(/[\u0000-\u001F\u0080\u009F]/)!=null?{tag:{tag:N,explicit:!1,hex:W}}:{tag:{tag:N,explicit:!1,str:G}}}else if(N.match(/^a[0-9]$/))try{if(!d(W))throw new Error("not encap");return{tag:{tag:N,explicit:!0,obj:l(W)}}}catch{return{tag:{tag:N,explicit:!0,hex:W}}}else{var X=new y.asn1.ASN1Object;X.hV=W;var te=X.getLengthHexFromValue();return{asn1:{tlv:N+te+W}}}}}},Be.isContextTag=function(s,c){s=s.toLowerCase();var l,d;try{l=parseInt(s,16)}catch{return-1}if(c===void 0)return(l&192)==128;try{var v=c.match(/^\[[0-9]+\]$/);return v==null||(d=parseInt(c.substr(1,c.length-1),10),d>31)?!1:(l&192)==128&&(l&31)==d}catch{return!1}},Be.isASN1HEX=function(s){var c=Be;if(s.length%2==1)return!1;var l=c.getVblen(s,0),d=s.substr(0,2),v=c.getL(s,0),m=s.length-d.length-v.length;return m==l*2},Be.checkStrictDER=function(s,c,l,d,v){var m=Be;if(l===void 0){if(typeof s!="string")throw new Error("not hex string");if(s=s.toLowerCase(),!y.lang.String.isHex(s))throw new Error("not hex string");l=s.length,d=s.length/2,d<128?v=1:v=Math.ceil(d.toString(16))+1}var T=m.getL(s,c);if(T.length>v*2)throw new Error("L of TLV too long: idx="+c);var k=m.getVblen(s,c);if(k>d)throw new Error("value of L too long than hex: idx="+c);var O=m.getTLV(s,c),F=O.length-2-m.getL(s,c).length;if(F!==k*2)throw new Error("V string length and L's value not the same:"+F+"/"+k*2);if(c===0&&s.length!=O.length)throw new Error("total length and TLV length unmatch:"+s.length+"!="+O.length);var U=s.substr(c,2);if(U==="02"){var L=m.getVidx(s,c);if(s.substr(L,2)=="00"&&s.charCodeAt(L+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(U,16)&32){for(var P=m.getVblen(s,c),D=0,A=m.getChildIdx(s,c),N=0;N<A.length;N++){var j=m.getTLV(s,A[N]);D+=j.length,m.checkStrictDER(s,A[N],l,d,v)}if(P*2!=D)throw new Error("sum of children's TLV length and L unmatch: "+P*2+"!="+D)}},Be.oidname=function(s){var c=y.asn1;y.lang.String.isHex(s)&&(s=c.ASN1Util.oidHexToInt(s));var l=c.x509.OID.oid2name(s);return l===""&&(l=s),l},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.x509>"u"||!y.asn1.x509)&&(y.asn1.x509={}),y.asn1.x509.Certificate=function(s){y.asn1.x509.Certificate.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERBitString,v=l.DERSequence,m=l.x509,T=m.TBSCertificate,k=m.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(O){this.params=O},this.sign=function(){var O=this.params,F=O.sigalg;O.sigalg.name!=null&&(F=O.sigalg.name);var U=O.tbsobj.tohex(),L=new y.crypto.Signature({alg:F});L.init(O.cakey),L.updateHex(U),O.sighex=L.sign()},this.getPEM=function(){return or(this.tohex(),"CERTIFICATE")},this.tohex=function(){var O=this.params;if((O.tbsobj==null||O.tbsobj==null)&&(O.tbsobj=new T(O)),O.sighex==null&&O.cakey!=null&&this.sign(),O.sighex==null)throw new Error("sighex or cakey parameter not defined");var F=[];F.push(O.tbsobj),F.push(new k({name:O.sigalg})),F.push(new d({hex:"00"+O.sighex}));var U=new v({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&(this.params=s)},Ie(y.asn1.x509.Certificate,y.asn1.ASN1Object),y.asn1.x509.TBSCertificate=function(s){y.asn1.x509.TBSCertificate.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509,v=l.DERTaggedObject,m=l.DERInteger,T=l.DERSequence,k=d.AlgorithmIdentifier,O=d.Time,F=d.X500Name,U=d.Extensions,L=d.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(P){this.params=P},this.tohex=function(){var P=[],D=this.params;if(D.version!=null||D.version!=1){var A=2;D.version!=null&&(A=D.version-1);var N=new v({obj:new m({int:A})});P.push(N)}P.push(new m(D.serial)),P.push(new k({name:D.sigalg})),P.push(new F(D.issuer)),P.push(new T({array:[new O(D.notbefore),new O(D.notafter)]})),P.push(new F(D.subject)),P.push(new L(Ot.getKey(D.sbjpubkey))),D.ext!==void 0&&D.ext.length>0&&P.push(new v({tag:"a3",obj:new U(D.ext)}));var j=new y.asn1.DERSequence({array:P});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.TBSCertificate,y.asn1.ASN1Object),y.asn1.x509.Extensions=function(s){y.asn1.x509.Extensions.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERSequence,v=l.x509;this.aParam=[],this.setByParam=function(m){this.aParam=m},this.tohex=function(){for(var m=[],T=0;T<this.aParam.length;T++){var k=this.aParam[T],O=k.extname,F=null;if(k.extn!=null)F=new v.PrivateExtension(k);else if(O=="subjectKeyIdentifier")F=new v.SubjectKeyIdentifier(k);else if(O=="keyUsage")F=new v.KeyUsage(k);else if(O=="subjectAltName")F=new v.SubjectAltName(k);else if(O=="issuerAltName")F=new v.IssuerAltName(k);else if(O=="basicConstraints")F=new v.BasicConstraints(k);else if(O=="nameConstraints")F=new v.NameConstraints(k);else if(O=="cRLDistributionPoints")F=new v.CRLDistributionPoints(k);else if(O=="certificatePolicies")F=new v.CertificatePolicies(k);else if(O=="policyMappings")F=new v.PolicyMappings(k);else if(O=="policyConstraints")F=new v.PolicyConstraints(k);else if(O=="inhibitAnyPolicy")F=new v.InhibitAnyPolicy(k);else if(O=="authorityKeyIdentifier")F=new v.AuthorityKeyIdentifier(k);else if(O=="extKeyUsage")F=new v.ExtKeyUsage(k);else if(O=="authorityInfoAccess")F=new v.AuthorityInfoAccess(k);else if(O=="cRLNumber")F=new v.CRLNumber(k);else if(O=="cRLReason")F=new v.CRLReason(k);else if(O=="ocspNonce")F=new v.OCSPNonce(k);else if(O=="ocspNoCheck")F=new v.OCSPNoCheck(k);else if(O=="adobeTimeStamp")F=new v.AdobeTimeStamp(k);else if(O=="subjectDirectoryAttributes")F=new v.SubjectDirectoryAttributes(k);else throw new Error("extension not supported:"+JSON.stringify(k));F!=null&&m.push(F)}var U=new d({array:m});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.x509.Extensions,y.asn1.ASN1Object),y.asn1.x509.Extension=function(s){y.asn1.x509.Extension.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERObjectIdentifier,v=l.DEROctetString;l.DERBitString;var m=l.DERBoolean,T=l.DERSequence;this.tohex=function(){var k=new d({oid:this.oid}),O=new v({hex:this.getExtnValueHex()}),F=new Array;F.push(k),this.critical&&F.push(new m),F.push(O);var U=new T({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,s!==void 0&&s.critical!==void 0&&(this.critical=s.critical)},Ie(y.asn1.x509.Extension,y.asn1.ASN1Object),y.asn1.x509.KeyUsage=function(s){y.asn1.x509.KeyUsage.superclass.constructor.call(this,s);var c=Error,l={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var d=this.getBinValue();return this.asn1ExtnValue=new y.asn1.DERBitString({bin:d}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var d=this.params;if(typeof d!="object"||typeof d.names!="object"&&typeof d.bin!="string")throw new c("parameter not yet set");if(d.names!=null)return Jl(d.names,l);if(d.bin!=null)return d.bin;throw new c("parameter not set properly")},this.oid="2.5.29.15",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.KeyUsage,y.asn1.x509.Extension),y.asn1.x509.BasicConstraints=function(s){y.asn1.x509.BasicConstraints.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERBoolean,d=c.DERInteger,v=c.DERSequence;this.getExtnValueHex=function(){var m=new Array;this.cA&&m.push(new l),this.pathLen>-1&&m.push(new d({int:this.pathLen}));var T=new v({array:m});return this.asn1ExtnValue=T,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,s!==void 0&&(s.cA!==void 0&&(this.cA=s.cA),s.pathLen!==void 0&&(this.pathLen=s.pathLen))},Ie(y.asn1.x509.BasicConstraints,y.asn1.x509.Extension),y.asn1.x509.CRLDistributionPoints=function(s){y.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(v){for(var m=[],T=0;T<v.length;T++)if(v[T]instanceof y.asn1.ASN1Object)m.push(v[T]);else{var k=new d.DistributionPoint(v[T]);m.push(k)}this.asn1ExtnValue=new l.DERSequence({array:m})},this.setByOneURI=function(v){var m=new d.DistributionPoint({fulluri:v});this.setByDPArray([m])},this.oid="2.5.29.31",s!==void 0&&(s.array!==void 0?this.setByDPArray(s.array):s.uri!==void 0&&this.setByOneURI(s.uri))},Ie(y.asn1.x509.CRLDistributionPoints,y.asn1.x509.Extension),y.asn1.x509.DistributionPoint=function(s){y.asn1.x509.DistributionPoint.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509.DistributionPointName;this.tohex=function(){var v=new l.DERSequence;if(this.asn1DP!=null){var m=new l.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});v.appendASN1Object(m)}return this.hTLV=v.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.dpobj!==void 0?this.asn1DP=s.dpobj:s.dpname!==void 0?this.asn1DP=new d(s.dpname):s.fulluri!==void 0&&(this.asn1DP=new d({full:[{uri:s.fulluri}]})))},Ie(y.asn1.x509.DistributionPoint,y.asn1.ASN1Object),y.asn1.x509.DistributionPointName=function(s){y.asn1.x509.DistributionPointName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new d({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0)if(l.x509.GeneralNames.prototype.isPrototypeOf(s))this.type="full",this.tag="a0",this.asn1V=s;else if(s.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new l.x509.GeneralNames(s.full);else throw new Error("This class supports GeneralNames only as argument")},Ie(y.asn1.x509.DistributionPointName,y.asn1.ASN1Object),y.asn1.x509.CertificatePolicies=function(s){y.asn1.x509.CertificatePolicies.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509,v=l.DERSequence,m=d.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var T=[],k=0;k<this.params.array.length;k++)T.push(new m(this.params.array[k]));var O=new v({array:T});return this.asn1ExtnValue=O,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.CertificatePolicies,y.asn1.x509.Extension),y.asn1.x509.PolicyInformation=function(s){y.asn1.x509.PolicyInformation.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.DERObjectIdentifier,v=c.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var m=[new d(this.params.policyoid)];if(this.params.array!==void 0){for(var T=[],k=0;k<this.params.array.length;k++)T.push(new v(this.params.array[k]));T.length>0&&m.push(new l({array:T}))}var O=new l({array:m});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Ie(y.asn1.x509.PolicyInformation,y.asn1.ASN1Object),y.asn1.x509.PolicyQualifierInfo=function(s){y.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.DERIA5String,v=c.DERObjectIdentifier,m=c.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var T=new l({array:[new v({oid:"1.3.6.1.5.5.7.2.1"}),new d({str:this.params.cps})]});return T.tohex()}if(this.params.unotice!=null){var T=new l({array:[new v({oid:"1.3.6.1.5.5.7.2.2"}),new m(this.params.unotice)]});return T.tohex()}},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Ie(y.asn1.x509.PolicyQualifierInfo,y.asn1.ASN1Object),y.asn1.x509.UserNotice=function(s){y.asn1.x509.UserNotice.superclass.constructor.call(this,s);var c=y.asn1.DERSequence;y.asn1.DERInteger;var l=y.asn1.x509.DisplayText,d=y.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var v=[];this.params.noticeref!==void 0&&v.push(new d(this.params.noticeref)),this.params.exptext!==void 0&&v.push(new l(this.params.exptext));var m=new c({array:v});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Ie(y.asn1.x509.UserNotice,y.asn1.ASN1Object),y.asn1.x509.NoticeReference=function(s){y.asn1.x509.NoticeReference.superclass.constructor.call(this,s);var c=y.asn1.DERSequence,l=y.asn1.DERInteger,d=y.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var v=[];if(this.params.org!==void 0&&v.push(new d(this.params.org)),this.params.noticenum!==void 0){for(var m=[],T=this.params.noticenum,k=0;k<T.length;k++)m.push(new l(T[k]));v.push(new c({array:m}))}if(v.length==0)throw new Error("parameter is empty");var O=new c({array:v});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Ie(y.asn1.x509.NoticeReference,y.asn1.ASN1Object),y.asn1.x509.DisplayText=function(s){y.asn1.x509.DisplayText.superclass.constructor.call(this,s),this.hT="0c",s!==void 0&&(s.type==="ia5"?this.hT="16":s.type==="vis"?this.hT="1a":s.type==="bmp"&&(this.hT="1e"))},Ie(y.asn1.x509.DisplayText,y.asn1.DERAbstractString),y.asn1.x509.PolicyMappings=function(s){y.asn1.x509.PolicyMappings.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var v=this.params,m=[],T=0;T<v.array.length;T++){var k=v.array[T];m.push({seq:[{oid:k[0]},{oid:k[1]}]})}return this.asn1ExtnValue=d({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.PolicyMappings,y.asn1.x509.Extension),y.asn1.x509.PolicyConstraints=function(s){y.asn1.x509.PolicyConstraints.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var v=this.params,m=[];return v.reqexp!=null&&m.push({tag:{tagi:"80",obj:{int:v.reqexp}}}),v.inhibit!=null&&m.push({tag:{tagi:"81",obj:{int:v.inhibit}}}),this.asn1ExtnValue=d({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.PolicyConstraints,y.asn1.x509.Extension),y.asn1.x509.InhibitAnyPolicy=function(s){y.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=d({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.InhibitAnyPolicy,y.asn1.x509.Extension),y.asn1.x509.NameConstraints=function(s){y.asn1.x509.NameConstraints.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509,v=l.ASN1Util.newObject,m=d.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var T=this.params,k=[];if(T.permit!=null&&T.permit.length!=null){for(var O=[],F=0;F<T.permit.length;F++)O.push(new m(T.permit[F]));k.push({tag:{tagi:"a0",obj:{seq:O}}})}if(T.exclude!=null&&T.exclude.length!=null){for(var U=[],F=0;F<T.exclude.length;F++)U.push(new m(T.exclude[F]));k.push({tag:{tagi:"a1",obj:{seq:U}}})}return this.asn1ExtnValue=v({seq:k}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.NameConstraints,y.asn1.x509.Extension),y.asn1.x509.GeneralSubtree=function(s){y.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var c=y.asn1,l=c.x509,d=l.GeneralName,v=c.ASN1Util.newObject;this.params=null,this.setByParam=function(m){this.params=m},this.tohex=function(){var m=this.params,T=[new d(m)];m.min!=null&&T.push({tag:{tagi:"80",obj:{int:m.min}}}),m.max!=null&&T.push({tag:{tagi:"81",obj:{int:m.max}}});var k=v({seq:T});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.GeneralSubtree,y.asn1.ASN1Object),y.asn1.x509.ExtKeyUsage=function(s){y.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,s);var c=y,l=c.asn1;this.setPurposeArray=function(d){this.asn1ExtnValue=new l.DERSequence;for(var v=0;v<d.length;v++){var m=new l.DERObjectIdentifier(d[v]);this.asn1ExtnValue.appendASN1Object(m)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",s!==void 0&&s.array!==void 0&&this.setPurposeArray(s.array)},Ie(y.asn1.x509.ExtKeyUsage,y.asn1.x509.Extension),y.asn1.x509.AuthorityKeyIdentifier=function(s){y.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DERTaggedObject,v=l.x509.GeneralNames;c.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var m=new Array;this.asn1KID&&m.push(new d({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&m.push(new d({explicit:!1,tag:"a1",obj:new v([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&m.push(new d({explicit:!1,tag:"82",obj:this.asn1CertSN}));var T=new l.DERSequence({array:m});return this.asn1ExtnValue=T,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(m){if(m.str!==void 0||m.hex!==void 0)this.asn1KID=new y.asn1.DEROctetString(m);else if(typeof m=="object"&&y.crypto.Util.isKey(m)||typeof m=="string"&&m.indexOf("BEGIN ")!=-1){var T=m;typeof m=="string"&&(T=Ot.getKey(m));var k=Ot.getKeyID(T);this.asn1KID=new y.asn1.DEROctetString({hex:k})}},this.setCertIssuerByParam=function(m){m.str!==void 0||m.ldapstr!==void 0||m.hex!==void 0||m.certsubject!==void 0||m.certissuer!==void 0?this.asn1CertIssuer=new y.asn1.x509.X500Name(m):typeof m=="string"&&m.indexOf("BEGIN ")!=-1&&m.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new y.asn1.x509.X500Name({certissuer:m}))},this.setCertSNByParam=function(m){if(m.str!==void 0||m.bigint!==void 0||m.hex!==void 0)this.asn1CertSN=new y.asn1.DERInteger(m);else if(typeof m=="string"&&m.indexOf("BEGIN ")!=-1&&m.indexOf("CERTIFICATE")){var T=new ut;T.readCertPEM(m);var k=T.getSerialNumberHex();this.asn1CertSN=new y.asn1.DERInteger({hex:k})}},this.oid="2.5.29.35",s!==void 0&&(s.kid!==void 0&&this.setKIDByParam(s.kid),s.issuer!==void 0&&this.setCertIssuerByParam(s.issuer),s.sn!==void 0&&this.setCertSNByParam(s.sn),s.issuersn!==void 0&&typeof s.issuersn=="string"&&s.issuersn.indexOf("BEGIN ")!=-1&&s.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(s.issuersn),this.setCertIssuerByParam(s.issuersn)))},Ie(y.asn1.x509.AuthorityKeyIdentifier,y.asn1.x509.Extension),y.asn1.x509.SubjectKeyIdentifier=function(s){y.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(v){if(v.str!==void 0||v.hex!==void 0)this.asn1KID=new d(v);else if(typeof v=="object"&&y.crypto.Util.isKey(v)||typeof v=="string"&&v.indexOf("BEGIN")!=-1){var m=v;typeof v=="string"&&(m=Ot.getKey(v));var T=Ot.getKeyID(m);this.asn1KID=new y.asn1.DEROctetString({hex:T})}},this.oid="2.5.29.14",s!==void 0&&s.kid!==void 0&&this.setKIDByParam(s.kid)},Ie(y.asn1.x509.SubjectKeyIdentifier,y.asn1.x509.Extension),y.asn1.x509.AuthorityInfoAccess=function(s){y.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,s),this.setAccessDescriptionArray=function(c){for(var l=new Array,d=y,v=d.asn1,m=v.DERSequence,T=v.DERObjectIdentifier,k=v.x509.GeneralName,O=0;O<c.length;O++){var F,U=c[O];if(U.ocsp!==void 0)F=new m({array:[new T({oid:"1.3.6.1.5.5.7.48.1"}),new k({uri:U.ocsp})]});else if(U.caissuer!==void 0)F=new m({array:[new T({oid:"1.3.6.1.5.5.7.48.2"}),new k({uri:U.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(U));l.push(F)}this.asn1ExtnValue=new m({array:l})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",s!==void 0&&s.array!==void 0&&this.setAccessDescriptionArray(s.array)},Ie(y.asn1.x509.AuthorityInfoAccess,y.asn1.x509.Extension),y.asn1.x509.SubjectAltName=function(s){y.asn1.x509.SubjectAltName.superclass.constructor.call(this,s),this.setNameArray=function(c){this.asn1ExtnValue=new y.asn1.x509.GeneralNames(c)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",s!==void 0&&s.array!==void 0&&this.setNameArray(s.array)},Ie(y.asn1.x509.SubjectAltName,y.asn1.x509.Extension),y.asn1.x509.IssuerAltName=function(s){y.asn1.x509.IssuerAltName.superclass.constructor.call(this,s),this.setNameArray=function(c){this.asn1ExtnValue=new y.asn1.x509.GeneralNames(c)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",s!==void 0&&s.array!==void 0&&this.setNameArray(s.array)},Ie(y.asn1.x509.IssuerAltName,y.asn1.x509.Extension),y.asn1.x509.SubjectDirectoryAttributes=function(s){y.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.ASN1Util.newObject,v=c.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var m=[],T=0;T<this.params.array.length;T++){var k=this.params.array[T];if(k.attr!=null&&k.array!=null){var O={seq:[{oid:k.attr},{set:k.array}]};m.push(d(O));continue}var F={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(k.attr=="dateOfBirth")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={gentime:k.str};else if(k.attr=="placeOfBirth")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={utf8str:k.str};else if(k.attr=="gender")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={prnstr:k.str};else if(k.attr=="countryOfCitizenship")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={prnstr:k.str};else if(k.attr=="countryOfResidence")F.seq[0].oid=v(k.attr),F.seq[1].set[0]={prnstr:k.str};else throw new Error("unsupported attribute: "+k.attr);m.push(new d(F))}var U=new l({array:m});return this.asn1ExtnValue=U,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.SubjectDirectoryAttributes,y.asn1.x509.Extension),y.asn1.x509.PrivateExtension=function(s){y.asn1.x509.PrivateExtension.superclass.constructor.call(this,s);var c=y,l=c.lang.String.isHex,d=c.asn1,v=d.x509.OID.name2oid,m=d.ASN1Util.newObject;this.params=null,this.setByParam=function(T){this.oid=v(T.extname),this.params=T},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var T=this.params.extn;if(typeof T=="string"&&l(T))return T;if(typeof T=="object")try{return m(T).tohex()}catch{}throw new Error("unsupported extn value")},s!=null&&this.setByParam(s)},Ie(y.asn1.x509.PrivateExtension,y.asn1.x509.Extension),y.asn1.x509.CRL=function(s){y.asn1.x509.CRL.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERSequence,v=l.DERBitString,m=l.x509,T=m.AlgorithmIdentifier,k=m.TBSCertList;this.params=void 0,this.setByParam=function(O){this.params=O},this.sign=function(){var O=new k(this.params).tohex(),F=new y.crypto.Signature({alg:this.params.sigalg});F.init(this.params.cakey),F.updateHex(O);var U=F.sign();this.params.sighex=U},this.getPEM=function(){return or(this.tohex(),"X509 CRL")},this.tohex=function(){var O=this.params;if(O.tbsobj==null&&(O.tbsobj=new k(O)),O.sighex==null&&O.cakey!=null&&this.sign(),O.sighex==null)throw new Error("sighex or cakey parameter not defined");var F=[];F.push(O.tbsobj),F.push(new T({name:O.sigalg})),F.push(new v({hex:"00"+O.sighex}));var U=new d({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&(this.params=s)},Ie(y.asn1.x509.CRL,y.asn1.ASN1Object),y.asn1.x509.TBSCertList=function(s){y.asn1.x509.TBSCertList.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERInteger,v=l.DERSequence,m=l.DERTaggedObject;l.DERObjectIdentifier;var T=l.x509,k=T.AlgorithmIdentifier,O=T.Time,F=T.Extensions,U=T.X500Name;this.params=null,this.setByParam=function(L){this.params=L},this.getRevCertSequence=function(){for(var L=[],P=this.params.revcert,D=0;D<P.length;D++){var A=[new d(P[D].sn),new O(P[D].date)];P[D].ext!=null&&A.push(new F(P[D].ext)),L.push(new v({array:A}))}return new v({array:L})},this.tohex=function(){var L=[],P=this.params;if(P.version!=null){var D=P.version-1,A=new d({int:D});L.push(A)}if(L.push(new k({name:P.sigalg})),L.push(new U(P.issuer)),L.push(new O(P.thisupdate)),P.nextupdate!=null&&L.push(new O(P.nextupdate)),P.revcert!=null&&L.push(this.getRevCertSequence()),P.ext!=null){var N=new F(P.ext);L.push(new m({tag:"a0",explicit:!0,obj:N}))}var j=new v({array:L});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.TBSCertList,y.asn1.ASN1Object),y.asn1.x509.CRLEntry=function(s){y.asn1.x509.CRLEntry.superclass.constructor.call(this);var c=y,l=c.asn1;this.setCertSerial=function(d){this.sn=new l.DERInteger(d)},this.setRevocationDate=function(d){this.time=new l.x509.Time(d)},this.tohex=function(){var d=new l.DERSequence({array:[this.sn,this.time]});return this.TLV=d.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.time!==void 0&&this.setRevocationDate(s.time),s.sn!==void 0&&this.setCertSerial(s.sn))},Ie(y.asn1.x509.CRLEntry,y.asn1.ASN1Object),y.asn1.x509.CRLNumber=function(s){y.asn1.x509.CRLNumber.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",s!=null&&(this.params=s)},Ie(y.asn1.x509.CRLNumber,y.asn1.x509.Extension),y.asn1.x509.CRLReason=function(s){y.asn1.x509.CRLReason.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",s!=null&&(this.params=s)},Ie(y.asn1.x509.CRLReason,y.asn1.x509.Extension),y.asn1.x509.OCSPNonce=function(s){y.asn1.x509.OCSPNonce.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",s!=null&&(this.params=s)},Ie(y.asn1.x509.OCSPNonce,y.asn1.x509.Extension),y.asn1.x509.OCSPNoCheck=function(s){y.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",s!=null&&(this.params=s)},Ie(y.asn1.x509.OCSPNoCheck,y.asn1.x509.Extension),y.asn1.x509.AdobeTimeStamp=function(s){y.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DERInteger,v=l.DERBoolean,m=l.DERSequence,T=l.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var k=this.params,O=[new d(1)];return O.push(new T({uri:k.uri})),k.reqauth!=null&&O.push(new v(k.reqauth)),this.asn1ExtnValue=new m({array:O}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.AdobeTimeStamp,y.asn1.x509.Extension),y.asn1.x509.X500Name=function(s){y.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var c=y,l=c.asn1,d=l.x509,v=d.RDN;this.setByString=function(m,T){T!==void 0&&(this.sRule=T);var k=m.split("/");k.shift();for(var O=[],F=0;F<k.length;F++)if(k[F].match(/^[^=]+=.+$/))O.push(k[F]);else{var U=O.length-1;O[U]=O[U]+"/"+k[F]}for(var F=0;F<O.length;F++)this.asn1Array.push(new v({str:O[F],rule:this.sRule}))},this.setByLdapString=function(m,T){T!==void 0&&(this.sRule=T);var k=d.X500Name.ldapToCompat(m);this.setByString(k,T)},this.setByObject=function(m,T){T!==void 0&&(this.sRule=T);for(var k in m)if(m.hasOwnProperty(k)){var O=new v({str:k+"="+m[k],rule:this.sRule});this.asn1Array?this.asn1Array.push(O):this.asn1Array=[O]}},this.setByParam=function(m){if(m.rule!==void 0&&(this.sRule=m.rule),m.array!==void 0)this.paramArray=m.array;else if(m.str!==void 0)this.setByString(m.str);else if(m.ldapstr!==void 0)this.setByLdapString(m.ldapstr);else if(m.hex!==void 0)this.hTLV=m.hex;else if(m.certissuer!==void 0){var T=new ut;T.readCertPEM(m.certissuer),this.hTLV=T.getIssuerHex()}else if(m.certsubject!==void 0){var T=new ut;T.readCertPEM(m.certsubject),this.hTLV=T.getSubjectHex()}else typeof m=="object"&&m.certsubject===void 0&&m.certissuer===void 0&&this.setByObject(m)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var m=0;m<this.paramArray.length;m++){var T={array:this.paramArray[m]};this.sRule!="utf8"&&(T.rule=this.sRule);var k=new v(T);this.asn1Array.push(k)}var O=new l.DERSequence({array:this.asn1Array});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.X500Name,y.asn1.ASN1Object),y.asn1.x509.X500Name.compatToLDAP=function(s){if(s.substr(0,1)!=="/")throw"malformed input";s=s.substr(1);var c=s.split("/");return c.reverse(),c=c.map(function(l){return l.replace(/,/,"\\,")}),c.join(",")},y.asn1.x509.X500Name.onelineToLDAP=function(s){return y.asn1.x509.X500Name.compatToLDAP(s)},y.asn1.x509.X500Name.ldapToCompat=function(s){for(var c=s.split(","),l=!1,d=[],v=0;c.length>0;v++){var m=c.shift();if(l===!0){var T=d.pop(),k=(T+","+m).replace(/\\,/g,",");d.push(k),l=!1}else d.push(m);m.substr(-1,1)==="\\"&&(l=!0)}return d=d.map(function(O){return O.replace("/","\\/")}),d.reverse(),"/"+d.join("/")},y.asn1.x509.X500Name.ldapToOneline=function(s){return y.asn1.x509.X500Name.ldapToCompat(s)},y.asn1.x509.RDN=function(s){y.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var c=y.asn1.x509.AttributeTypeAndValue;this.setByParam=function(l){l.rule!==void 0&&(this.sRule=l.rule),l.str!==void 0&&this.addByMultiValuedString(l.str),l.array!==void 0&&(this.paramArray=l.array)},this.addByString=function(l){this.asn1Array.push(new y.asn1.x509.AttributeTypeAndValue({str:l,rule:this.sRule}))},this.addByMultiValuedString=function(l){for(var d=y.asn1.x509.RDN.parseString(l),v=0;v<d.length;v++)this.addByString(d[v])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var l=0;l<this.paramArray.length;l++){var d=this.paramArray[l];d.rule!==void 0&&this.sRule!="utf8"&&(d.rule=this.sRule);var v=new c(d);this.asn1Array.push(v)}var m=new y.asn1.DERSet({array:this.asn1Array});return this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.RDN,y.asn1.ASN1Object),y.asn1.x509.RDN.parseString=function(s){for(var c=s.split(/\+/),l=!1,d=[],v=0;c.length>0;v++){var m=c.shift();if(l===!0){var T=d.pop(),k=(T+"+"+m).replace(/\\\+/g,"+");d.push(k),l=!1}else d.push(m);m.substr(-1,1)==="\\"&&(l=!0)}for(var O=!1,F=[],v=0;d.length>0;v++){var m=d.shift();if(O===!0){var U=F.pop();if(m.match(/"$/)){var k=(U+"+"+m).replace(/^([^=]+)="(.*)"$/,"$1=$2");F.push(k),O=!1}else F.push(U+"+"+m)}else F.push(m);m.match(/^[^=]+="/)&&(O=!0)}return F},y.asn1.x509.AttributeTypeAndValue=function(s){y.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var c=y,l=c.asn1,d=l.DERSequence,v=l.DERUTF8String,m=l.DERPrintableString,T=l.DERTeletexString,k=l.DERIA5String,O=l.DERVisibleString,F=l.DERBMPString,U=c.lang.String.isMail,L=c.lang.String.isPrintable;this.setByParam=function(P){if(P.rule!==void 0&&(this.sRule=P.rule),P.ds!==void 0&&(this.dsType=P.ds),P.value===void 0&&P.str!==void 0){var D=P.str,A=D.match(/^([^=]+)=(.+)$/);if(A)this.sType=A[1],this.sValue=A[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=P.type,this.sValue=P.value},this.setByString=function(P,D){D!==void 0&&(this.sRule=D);var A=P.match(/^([^=]+)=(.+)$/);if(A)this.setByAttrTypeAndValueStr(A[1],A[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var P=this.sType,D=this.sValue,A=this.sRule;return A==="prn"?P=="CN"&&U(D)?"ia5":L(D)?"prn":"utf8":A==="utf8"?P=="CN"&&U(D)?"ia5":P=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(P,D,A){A!==void 0&&(this.sRule=A),this.sType=P,this.sValue=D},this.getValueObj=function(P,D){if(P=="utf8")return new v({str:D});if(P=="prn")return new m({str:D});if(P=="tel")return new T({str:D});if(P=="ia5")return new k({str:D});if(P=="vis")return new O({str:D});if(P=="bmp")return new F({str:D});throw new Error("unsupported directory string type: type="+P+" value="+D)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var P=y.asn1.x509.OID.atype2obj(this.sType),D=this.getValueObj(this.dsType,this.sValue),A=new d({array:[P,D]});return this.TLV=A.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.AttributeTypeAndValue,y.asn1.ASN1Object),y.asn1.x509.SubjectPublicKeyInfo=function(s){y.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERInteger,v=l.DERBitString,m=l.DERObjectIdentifier,T=l.DERSequence,k=l.ASN1Util.newObject,O=l.x509,F=O.AlgorithmIdentifier,U=c.crypto;U.ECDSA,U.DSA,this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var L=new T({array:[this.asn1AlgId,this.asn1SubjPKey]});return L},this.tohex=function(){var L=this.getASN1Object();return this.hTLV=L.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(L){try{if(L instanceof xe){var P=k({seq:[{int:{bigint:L.n}},{int:{int:L.e}}]}),D=P.tohex();this.asn1AlgId=new F({name:"rsaEncryption"}),this.asn1SubjPKey=new v({hex:"00"+D})}}catch{}try{if(L instanceof y.crypto.ECDSA){var A=new m({name:L.curveName});this.asn1AlgId=new F({name:"ecPublicKey",asn1params:A}),this.asn1SubjPKey=new v({hex:"00"+L.pubKeyHex})}}catch{}try{if(L instanceof y.crypto.DSA){var A=new k({seq:[{int:{bigint:L.p}},{int:{bigint:L.q}},{int:{bigint:L.g}}]});this.asn1AlgId=new F({name:"dsa",asn1params:A});var N=new d({bigint:L.y});this.asn1SubjPKey=new v({hex:"00"+N.tohex()})}}catch{}},s!==void 0&&this.setPubKey(s)},Ie(y.asn1.x509.SubjectPublicKeyInfo,y.asn1.ASN1Object),y.asn1.x509.Time=function(s){y.asn1.x509.Time.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERUTCTime,v=l.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(m){this.timeParams=m},this.setByParam=function(m){this.params=m},this.getType=function(m){return m.match(/^[0-9]{12}Z$/)?"utc":m.match(/^[0-9]{14}Z$/)?"gen":m.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":m.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var m=this.params,T=null;if(typeof m=="string"&&(m={str:m}),m!=null&&m.str&&(m.type==null||m.type==null)&&(m.type=this.getType(m.str)),m!=null&&m.str?(m.type=="utc"&&(T=new d(m.str)),m.type=="gen"&&(T=new v(m.str))):this.type=="gen"?T=new v:T=new d,T==null)throw new Error("wrong setting for Time");return this.TLV=T.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},y.asn1.x509.Time_bak=function(s){y.asn1.x509.Time_bak.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERUTCTime,v=l.DERGeneralizedTime;this.setTimeParams=function(m){this.timeParams=m},this.tohex=function(){var m=null;return this.timeParams!=null?this.type=="utc"?m=new d(this.timeParams):m=new v(this.timeParams):this.type=="utc"?m=new d:m=new v,this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",s!==void 0&&(s.type!==void 0?this.type=s.type:s.str!==void 0&&(s.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),s.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=s)},Ie(y.asn1.x509.Time,y.asn1.ASN1Object),y.asn1.x509.AlgorithmIdentifier=function(s){y.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var c=y,l=c.asn1,d=l.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var m=null;for(var T in d)T===this.nameAlg&&(m=d[T]);if(m!==null)return this.hTLV=m,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=l.x509.OID.name2obj(this.nameAlg));var k=[this.asn1Alg];this.asn1Params!==null&&k.push(this.asn1Params);var O=new l.DERSequence({array:k});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.name!==void 0&&(this.nameAlg=s.name),s.asn1params!==void 0&&(this.asn1Params=s.asn1params),s.paramempty!==void 0&&(this.paramEmpty=s.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var v=this.nameAlg.toLowerCase();v.substr(-7,7)!=="withdsa"&&v.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new l.DERNull)}},Ie(y.asn1.x509.AlgorithmIdentifier,y.asn1.ASN1Object),y.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},y.asn1.x509.GeneralName=function(s){y.asn1.x509.GeneralName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509,v=d.X500Name,m=d.OtherName,T=l.DERIA5String;l.DERPrintableString;var k=l.DEROctetString,O=l.DERTaggedObject,F=l.ASN1Object,U=Error;this.params=null,this.setByParam=function(L){this.params=L},this.tohex=function(){var L=this.params,P,A,D,A=!1;if(L.other!==void 0)P="a0",D=new m(L.other);else if(L.rfc822!==void 0)P="81",D=new T({str:L.rfc822});else if(L.dns!==void 0)P="82",D=new T({str:L.dns});else if(L.dn!==void 0)P="a4",A=!0,typeof L.dn=="string"?D=new v({str:L.dn}):L.dn instanceof y.asn1.x509.X500Name?D=L.dn:D=new v(L.dn);else if(L.ldapdn!==void 0)P="a4",A=!0,D=new v({ldapstr:L.ldapdn});else if(L.certissuer!==void 0||L.certsubj!==void 0){P="a4",A=!0;var N,j,W=null;if(L.certsubj!==void 0?(N=!1,j=L.certsubj):(N=!0,j=L.certissuer),j.match(/^[0-9A-Fa-f]+$/),j.indexOf("-----BEGIN ")!=-1&&(W=En(j)),W==null)throw new Error("certsubj/certissuer not cert");var se=new ut;se.hex=W;var de;N?de=se.getIssuerHex():de=se.getSubjectHex(),D=new F,D.hTLV=de}else if(L.uri!==void 0)P="86",D=new T({str:L.uri});else if(L.ip!==void 0){P="87";var ue,pe=L.ip;try{if(pe.match(/^[0-9a-f]+$/)){var G=pe.length;if(G==8||G==16||G==32||G==64)ue=pe;else throw"err"}else ue=Uh(pe)}catch(te){throw new U("malformed IP address: "+L.ip+":"+te.message)}D=new k({hex:ue})}else throw new U("improper params");var X=new O({tag:P,explicit:A,obj:D});return X.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.GeneralName,y.asn1.ASN1Object),y.asn1.x509.GeneralNames=function(s){y.asn1.x509.GeneralNames.superclass.constructor.call(this);var c=y,l=c.asn1;this.setByParamArray=function(d){for(var v=0;v<d.length;v++){var m=new l.x509.GeneralName(d[v]);this.asn1Array.push(m)}},this.tohex=function(){var d=new l.DERSequence({array:this.asn1Array});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof s<"u"&&this.setByParamArray(s)},Ie(y.asn1.x509.GeneralNames,y.asn1.ASN1Object),y.asn1.x509.OtherName=function(s){y.asn1.x509.OtherName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERObjectIdentifier,v=l.DERSequence,m=l.ASN1Util.newObject;this.params=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(T.oid==null||T.value==null)throw new Error("oid or value not specified");var k=new d({oid:T.oid}),O=m({tag:{tag:"a0",explicit:!0,obj:T.value}}),F=new v({array:[k,O]});return F.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.OtherName,y.asn1.ASN1Object),y.asn1.x509.OID=new function(){var s=y.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(c){if(typeof this.objCache[c]<"u")return this.objCache[c];if(typeof this.name2oidList[c]>"u")throw"Name of ObjectIdentifier not defined: "+c;var l=this.name2oidList[c],d=new s({oid:l});return this.objCache[c]=d,d},this.atype2obj=function(c){if(this.objCache[c]!==void 0)return this.objCache[c];var l;if(c.match(/^\d+\.\d+\.[0-9.]+$/))l=c;else if(this.atype2oidList[c]!==void 0)l=this.atype2oidList[c];else if(this.name2oidList[c]!==void 0)l=this.name2oidList[c];else throw new Error("AttributeType name undefined: "+c);var d=new s({oid:l});return this.objCache[c]=d,d},this.registerOIDs=function(c){if(this.checkOIDs(c))for(var l in c)this.name2oidList[l]=c[l]},this.checkOIDs=function(c){try{var l=Object.keys(c);return l.length==0?!1:(l.map(function(d,v,m){var T=this[d];if(!T.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},c),!0)}catch{return!1}}},y.asn1.x509.OID.oid2name=function(s){var c=y.asn1.x509.OID.name2oidList;for(var l in c)if(c[l]==s)return l;return""},y.asn1.x509.OID.oid2atype=function(s){var c=y.asn1.x509.OID.atype2oidList;for(var l in c)if(c[l]==s)return l;return s},y.asn1.x509.OID.name2oid=function(s){if(s.match(/^[0-9.]+$/))return s;var c=y.asn1.x509.OID.name2oidList;return c[s]===void 0?"":c[s]},y.asn1.x509.X509Util={},y.asn1.x509.X509Util.newCertPEM=function(s){var c=y.asn1.x509;c.TBSCertificate;var l=c.Certificate,d=new l(s);return d.getPEM()},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.cms>"u"||!y.asn1.cms)&&(y.asn1.cms={}),y.asn1.cms.Attribute=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.DERSet,T=d.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(k){this.params=k},this.getValueArray=function(){throw new c("not yet implemented abstract")},this.tohex=function(){var k=new T({oid:this.typeOid}),O=new m({array:this.getValueArray()}),F=new v({array:[k,O]});return F.tohex()},this.getEncodedHex=function(){return this.tohex()}},Ie(y.asn1.cms.Attribute,y.asn1.ASN1Object),y.asn1.cms.ContentType=function(s){var c=y,l=c.asn1;l.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var d=new l.DERObjectIdentifier(this.params.type);return[d]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.ContentType,y.asn1.cms.Attribute),y.asn1.cms.MessageDigest=function(s){var c=y,l=c.asn1,d=l.DEROctetString,v=l.cms;v.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var m=new d(this.params);return[m]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.MessageDigest,y.asn1.cms.Attribute),y.asn1.cms.SigningTime=function(s){var c=y,l=c.asn1;l.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var d=new l.x509.Time(this.params);return[d]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SigningTime,y.asn1.cms.Attribute),y.asn1.cms.SigningCertificate=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.cms,T=m.ESSCertID;l.crypto,m.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new c("parameter 'array' not specified");for(var k=this.params.array,O=[],F=0;F<k.length;F++){var U=k[F];s.hasis==!1&&typeof U=="string"&&(U.indexOf("-----BEGIN")!=-1||Be.isASN1HEX(U))&&(U={cert:U}),U.hasis!=!1&&s.hasis==!1&&(U.hasis=!1),O.push(new T(U))}var L=new v({array:O}),P=new v({array:[L]});return[P]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SigningCertificate,y.asn1.cms.Attribute),y.asn1.cms.ESSCertID=function(s){y.asn1.cms.ESSCertID.superclass.constructor.call(this);var c=Error,l=y,d=l.asn1,v=d.DEROctetString,m=d.DERSequence,T=d.cms.IssuerSerial;this.params=null,this.getCertHash=function(k,O){if(k.hash!=null)return k.hash;if(typeof k=="string"&&k.indexOf("-----BEGIN")==-1&&!Be.isASN1HEX(k))return k;var F;if(typeof k=="string")F=k;else if(k.cert!=null)F=k.cert;else throw new c("hash nor cert unspecified");var U;F.indexOf("-----BEGIN")!=-1?U=En(F):U=F,typeof k=="string"&&(k.indexOf("-----BEGIN")!=-1?U=En(k):Be.isASN1HEX(k)&&(U=k));var L;if(k.alg!=null)L=k.alg;else if(O!=null)L=O;else throw new c("hash alg unspecified");return l.crypto.Util.hashHex(U,L)},this.tohex=function(){var k=this.params,O=this.getCertHash(k,"sha1"),F=[];F.push(new v({hex:O})),(typeof k=="string"&&k.indexOf("-----BEGIN")!=-1||k.cert!=null&&k.hasis!=!1||k.issuer!=null&&k.serial!=null)&&F.push(new T(k));var U=new m({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.ESSCertID,y.asn1.ASN1Object),y.asn1.cms.SigningCertificateV2=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence;d.x509;var m=d.cms,T=m.ESSCertIDv2;l.crypto,m.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new c("parameter 'array' not specified");for(var k=this.params.array,O=[],F=0;F<k.length;F++){var U=k[F];(s.alg!=null||s.hasis==!1)&&typeof U=="string"&&(U.indexOf("-----BEGIN")!=-1||Be.isASN1HEX(U))&&(U={cert:U}),U.alg==null&&s.alg!=null&&(U.alg=s.alg),U.hasis!=!1&&s.hasis==!1&&(U.hasis=!1),O.push(new T(U))}var L=new v({array:O}),P=new v({array:[L]});return[P]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SigningCertificateV2,y.asn1.cms.Attribute),y.asn1.cms.ESSCertIDv2=function(s){y.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DEROctetString,v=l.DERSequence,m=l.cms.IssuerSerial,T=l.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var k=this.params,O=this.getCertHash(k,"sha256"),F=[];k.alg!=null&&k.alg!="sha256"&&F.push(new T({name:k.alg})),F.push(new d({hex:O})),(typeof k=="string"&&k.indexOf("-----BEGIN")!=-1||k.cert!=null&&k.hasis!=!1||k.issuer!=null&&k.serial!=null)&&F.push(new m(k));var U=new v({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.ESSCertIDv2,y.asn1.cms.ESSCertID),y.asn1.cms.IssuerSerial=function(s){var c=Error,l=y,d=l.asn1,v=d.DERInteger,m=d.DERSequence,T=d.cms,k=d.x509,O=k.GeneralNames,F=ut;T.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(U){this.params=U},this.tohex=function(){var U=this.params,L,P;if(typeof U=="string"&&U.indexOf("-----BEGIN")!=-1||U.cert!=null){var D;U.cert!=null?D=U.cert:D=U;var A=new F;A.readCertPEM(D),L=A.getIssuer(),P={hex:A.getSerialNumberHex()}}else if(U.issuer!=null&&U.serial)L=U.issuer,P=U.serial;else throw new c("cert or issuer and serial parameter not specified");var N=new O([{dn:L}]),j=new v(P),W=new m({array:[N,j]});return W.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.IssuerSerial,y.asn1.ASN1Object),y.asn1.cms.SignerIdentifier=function(s){var c=y,l=c.asn1;l.DERInteger,l.DERSequence;var d=l.cms,v=d.IssuerAndSerialNumber,m=d.SubjectKeyIdentifier,T=l.x509;T.X500Name,d.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;if(k.type=="isssn"){var O=new v(k);return O.tohex()}else if(k.type=="skid"){var F=new m(k);return F.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SignerIdentifier,y.asn1.ASN1Object),y.asn1.cms.IssuerAndSerialNumber=function(s){var c=y,l=c.asn1,d=l.DERInteger,v=l.DERSequence,m=l.cms,T=l.x509,k=T.X500Name,O=ut,F=Error;m.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var U=this.params,L,P;if(typeof U=="string"&&U.indexOf("-----BEGIN")!=-1||U.cert!=null){var D;U.cert!=null?D=U.cert:D=U;var A=new O;A.readCertPEM(D),L=A.getIssuer(),P={hex:A.getSerialNumberHex()}}else if(U.issuer!=null&&U.serial)L=U.issuer,P=U.serial;else throw new F("cert or issuer and serial parameter not specified");var N=new k(L),j=new d(P),W=new v({array:[N,j]});return W.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(U){this.params=U},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.IssuerAndSerialNumber,y.asn1.ASN1Object),y.asn1.cms.SubjectKeyIdentifier=function(s){var c=y,l=c.asn1;l.DERInteger,l.DERSequence;var d=l.ASN1Util.newObject,v=l.cms;v.IssuerAndSerialName,v.SubjectKeyIdentifier;var m=l.x509;m.X500Name;var T=ut,k=Error;v.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var O=this.params;if(O.cert==null&&O.skid==null)throw new k("property cert nor skid undefined");var F;if(O.cert!=null){var U=new T(O.cert),L=U.getExtSubjectKeyIdentifier();F=L.kid.hex}else O.skid!=null&&(F=O.skid);var P=d({tag:{tage:"a0",obj:{octstr:{hex:F}}}});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SubjectKeyIdentifier,y.asn1.ASN1Object),y.asn1.cms.AttributeList=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSet,m=d.cms;m.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(this.hTLV!=null)return this.hTLV;var k=!0;T.sortflag!=null&&(k=T.sortflag);for(var O=T.array,F=[],U=0;U<O.length;U++){var L=O[U],P=L.attr;if(P=="contentType")F.push(new m.ContentType(L));else if(P=="messageDigest")F.push(new m.MessageDigest(L));else if(P=="signingTime")F.push(new m.SigningTime(L));else if(P=="signingCertificate")F.push(new m.SigningCertificate(L));else if(P=="signingCertificateV2")F.push(new m.SigningCertificateV2(L));else if(P=="signaturePolicyIdentifier")F.push(new y.asn1.cades.SignaturePolicyIdentifier(L));else if(P=="signatureTimeStamp"||P=="timeStampToken")F.push(new y.asn1.cades.SignatureTimeStamp(L));else throw new c("unknown attr: "+P)}var D=new v({array:F,sortflag:k});return this.hTLV=D.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.AttributeList,y.asn1.ASN1Object),y.asn1.cms.SignerInfo=function(s){var c=Error,l=y,d=l.asn1,v=d.DERInteger,m=d.DEROctetString,T=d.DERSequence,k=d.DERTaggedObject,O=d.cms,F=O.SignerIdentifier,U=O.AttributeList;O.ContentType,O.EncapsulatedContentInfo,O.MessageDigest,O.SignedData;var L=d.x509,P=L.AlgorithmIdentifier,D=l.crypto,A=Ot;O.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var N=this.params,j=N.sigalg,W=new U(N.sattrs).tohex(),se=A.getKey(N.signkey),de=new D.Signature({alg:j});de.init(se),de.updateHex(W);var ue=de.sign();N.sighex=ue},this.tohex=function(){var N=this.params,j=[];if(j.push(new v({int:N.version})),j.push(new F(N.id)),j.push(new P({name:N.hashalg})),N.sattrs!=null){var W=new U(N.sattrs);try{j.push(new k({tag:"a0",explicit:!1,obj:W}))}catch(de){throw new c("si sattr error: "+de)}}if(N.sigalgfield!=null?j.push(new P({name:N.sigalgfield})):j.push(new P({name:N.sigalg})),N.sighex==null&&N.signkey!=null&&this.sign(),j.push(new m({hex:N.sighex})),N.uattrs!=null){var W=new U(N.uattrs);try{j.push(new k({tag:"a1",explicit:!1,obj:W}))}catch(ue){throw new c("si uattr error: "+ue)}}var se=new T({array:j});return se.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SignerInfo,y.asn1.ASN1Object),y.asn1.cms.EncapsulatedContentInfo=function(s){var c=y,l=c.asn1,d=l.DERTaggedObject,v=l.DERSequence,m=l.DERObjectIdentifier,T=l.DEROctetString,k=l.cms;k.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var O=this.params,F=[];if(F.push(new m(O.type)),O.content!=null&&(O.content.hex!=null||O.content.str!=null)&&O.isDetached!=!0){var U=new T(O.content),L=new d({tag:"a0",explicit:!0,obj:U});F.push(L)}var P=new v({array:F});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(O){this.params=O},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.EncapsulatedContentInfo,y.asn1.ASN1Object),y.asn1.cms.ContentInfo=function(s){var c=y,l=c.asn1,d=l.DERTaggedObject,v=l.DERSequence,m=l.DERObjectIdentifier,T=l.x509;T.OID.name2obj,y.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params,O=[];O.push(new m(k.type));var F=new d({tag:"a0",explicit:!0,obj:k.obj});O.push(F);var U=new v({array:O});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(k){this.params=k},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.ContentInfo,y.asn1.ASN1Object),y.asn1.cms.SignedData=function(s){var c=y,l=c.asn1;l.ASN1Object;var d=l.DERInteger,v=l.DERSet,m=l.DERSequence;l.DERTaggedObject;var T=l.cms,k=T.EncapsulatedContentInfo,O=T.SignerInfo,F=T.ContentInfo,U=T.CertificateSet,L=T.RevocationInfoChoices,P=l.x509,D=P.AlgorithmIdentifier;y.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var A=this.params;this._setDigestAlgs(A),this._setContentTypeByEContent(A),this._setMessageDigestByEContent(A),this._setSignerInfoVersion(A),this._setSignedDataVersion(A)},this._setDigestAlgs=function(A){for(var N={},j=A.sinfos,W=0;W<j.length;W++){var se=j[W];N[se.hashalg]=1}A.hashalgs=Object.keys(N).sort()},this._setContentTypeByEContent=function(A){for(var N=A.econtent.type,j=A.sinfos,W=0;W<j.length;W++){var se=j[W],de=this._getAttrParamByName(se,"contentType");de.type=N}},this._setMessageDigestByEContent=function(A){var N=A.econtent;A.econtent.type;var j=N.content.hex;j==null&&N.type=="data"&&N.content.str!=null&&(j=Vi(N.content.str));for(var W=A.sinfos,se=0;se<W.length;se++){var de=W[se],ue=de.hashalg,pe=this._getAttrParamByName(de,"messageDigest"),G=y.crypto.Util.hashHex(j,ue);pe.hex=G}},this._getAttrParamByName=function(A,N){for(var j=A.sattrs.array,W=0;W<j.length;W++)if(j[W].attr==N)return j[W]},this._setSignerInfoVersion=function(A){for(var N=A.sinfos,j=0;j<N.length;j++){var W=N[j],se=1;W.id.type=="skid"&&(se=3),W.version=se}},this._setSignedDataVersion=function(A){var N=this._getSignedDataVersion(A);A.version=N},this._getSignedDataVersion=function(A){if(A.revinfos!=null)for(var N=A.revinfos,j=0;j<N.length;j++){var W=N[j];if(W.ocsp!=null)return 5}for(var se=A.sinfos,j=0;j<se.length;j++){var de=A.sinfos[j];if(de.version==3)return 3}return A.econtent.type!="data"?3:1},this.tohex=function(){var A=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),A.fixed!=!0&&this.checkAndFixParam();var N=[];N.push(new d({int:A.version}));for(var j=[],W=0;W<A.hashalgs.length;W++){var se=A.hashalgs[W];j.push(new D({name:se}))}N.push(new v({array:j})),N.push(new k(A.econtent)),A.certs!=null&&N.push(new U(A.certs)),A.revinfos!=null&&N.push(new L(A.revinfos));for(var de=[],W=0;W<A.sinfos.length;W++){var ue=A.sinfos[W];de.push(new O(ue))}N.push(new v({array:de}));var pe=new m({array:N});return pe.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var A=new F({type:"signed-data",obj:this});return A},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SignedData,y.asn1.ASN1Object),y.asn1.cms.CertificateSet=function(s){y.asn1.cms.CertificateSet.superclass.constructor.call(this);var c=Error,l=y.asn1,d=l.DERTaggedObject,v=l.DERSet,m=l.ASN1Object;this.params=null,this.tohex=function(){var T=this.params,k=[],O;if(T instanceof Array)O=T;else if(T.array!=null)O=T.array;else throw new c("cert array not specified");for(var F=0;F<O.length;F++){var U=O[F],L=En(U),P=new m;P.hTLV=L,k.push(P)}var D={array:k};T.sortflag==!1&&(D.sortflag=!1);var A=new v(D),N=new d({tag:"a0",explicit:!1,obj:A});return N.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.CertificateSet,y.asn1.ASN1Object),y.asn1.cms.RevocationInfoChoices=function(s){y.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(!c instanceof Array)throw new Error("params is not array");for(var l=[],d=0;d<c.length;d++)l.push(new y.asn1.cms.RevocationInfoChoice(c[d]));var v=y.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:l}}});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.RevocationInfoChoices,y.asn1.ASN1Object),y.asn1.cms.RevocationInfoChoice=function(s){y.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(c.crl!=null&&typeof c.crl=="string"){var l=c.crl;return c.crl.indexOf("-----BEGIN")!=-1&&(l=En(c.crl)),l}else if(c.ocsp!=null){var d=y.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new y.asn1.cms.OtherRevocationFormat(c)}});return d.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.RevocationInfoChoice,y.asn1.ASN1Object),y.asn1.cms.OtherRevocationFormat=function(s){y.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var c=Error,l=y,d=l.asn1,v=d.ASN1Util.newObject,m=l.lang.String.isHex;this.params=null,this.tohex=function(){var T=this.params;if(T.ocsp==null)throw new c("property ocsp not specified");if(!m(T.ocsp)||!Be.isASN1HEX(T.ocsp))throw new c("ocsp value not ASN.1 hex string");var k=v({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:T.ocsp}}]});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.OtherRevocationFormat,y.asn1.ASN1Object),y.asn1.cms.CMSUtil=new function(){},y.asn1.cms.CMSUtil.newSignedData=function(s){return new y.asn1.cms.SignedData(s)},y.asn1.cms.CMSUtil.verifySignedData=function(s){var c=y,l=c.asn1,d=l.cms;d.SignerInfo,d.SignedData,d.SigningTime,d.SigningCertificate,d.SigningCertificateV2;var v=l.cades;v.SignaturePolicyIdentifier;var m=c.lang.String.isHex,T=Be,k=T.getVbyList,O=T.getTLVbyList,F=T.getIdxbyList,U=T.getChildIdx,L=T.getTLV,P=T.oidname,D=c.crypto.Util.hashHex;s.cms===void 0&&m(s.cms);var A=s.cms,N=function(te,J){for(var re,he=3;he<6;he++)if(re=F(te,0,[1,0,he]),re!==void 0){var ye=te.substr(re,2);ye==="a0"&&(J.certsIdx=re),ye==="a1"&&(J.revinfosIdx=re),ye==="31"&&(J.signerinfosIdx=re)}},j=function(te,J){var re=J.signerinfosIdx;if(re!==void 0){var he=U(te,re);J.signerInfoIdxList=he;for(var ye=0;ye<he.length;ye++){var Fe=he[ye],ge={idx:Fe};W(te,ge),J.signerInfos.push(ge)}}},W=function(te,J){var re=J.idx;J.signerid_issuer1=O(te,re,[1,0],"30"),J.signerid_serial1=k(te,re,[1,1],"02"),J.hashalg=P(k(te,re,[2,0],"06"));var he=F(te,re,[3],"a0");J.idxSignedAttrs=he,se(te,J,he);var ye=U(te,re),Fe=ye.length;if(Fe<6)throw"malformed SignerInfo";J.sigalg=P(k(te,re,[Fe-2,0],"06")),J.sigval=k(te,re,[Fe-1],"04")},se=function(te,J,re){var he=U(te,re);J.signedAttrIdxList=he;for(var ye=0;ye<he.length;ye++){var Fe=he[ye],ge=k(te,Fe,[0],"06"),Pe;ge==="2a864886f70d010905"?(Pe=Zt(k(te,Fe,[1,0])),J.saSigningTime=Pe):ge==="2a864886f70d010904"&&(Pe=k(te,Fe,[1,0],"04"),J.saMessageDigest=Pe)}},de=function(te,J){if(k(te,0,[0],"06")!=="2a864886f70d010702")return J;J.cmsType="signedData",J.econtent=k(te,0,[1,0,2,1,0]),N(te,J),J.signerInfos=[],j(te,J)},ue=function(te,J){for(var re=J.parse.signerInfos,he=re.length,ye=!0,Fe=0;Fe<he;Fe++){var ge=re[Fe];G(te,J,ge),ge.isValid||(ye=!1)}J.isValid=ye},pe=function(te,J,re,he){var ye=J.parse.certsIdx,Fe;if(J.certs===void 0){Fe=[],J.certkeys=[];for(var ge=U(te,ye),Pe=0;Pe<ge.length;Pe++){var Ne=L(te,ge[Pe]),Me=new ut;Me.readCertHex(Ne),Fe[Pe]=Me,J.certkeys[Pe]=Me.getPublicKey()}J.certs=Fe}else Fe=J.certs;J.cccc=Fe.length,J.cccci=ge.length;for(var Pe=0;Pe<Fe.length;Pe++){var cr=Me.getIssuerHex(),vn=Me.getSerialNumberHex();re.signerid_issuer1===cr&&re.signerid_serial1===vn&&(re.certkey_idx=Pe)}},G=function(te,J,re,he){re.verifyDetail={};var ye=re.verifyDetail,Fe=J.parse.econtent,ge=re.hashalg,Pe=re.saMessageDigest;ye.validMessageDigest=!1,D(Fe,ge)===Pe&&(ye.validMessageDigest=!0),pe(te,J,re),ye.validSignatureValue=!1;var Ne=re.sigalg,Me="31"+L(te,re.idxSignedAttrs).substr(2);re.signedattrshex=Me;var cr=J.certs[re.certkey_idx].getPublicKey(),vn=new y.crypto.Signature({alg:Ne});vn.init(cr),vn.updateHex(Me);var nn=vn.verify(re.sigval);ye.validSignatureValue_isValid=nn,nn===!0&&(ye.validSignatureValue=!0),re.isValid=!1,ye.validMessageDigest&&ye.validSignatureValue&&(re.isValid=!0)},X={isValid:!1,parse:{}};return de(A,X.parse),ue(A,X),X},y.asn1.cms.CMSParser=function(){var s=Error,c=ut,l=new c,d=Be,v=d.getV,m=d.getTLV;d.getIdxbyList;var T=d.getTLVbyList,k=d.getTLVbyListEx,O=d.getVbyList,F=d.getVbyListEx,U=d.getChildIdx;this.getCMSSignedData=function(L){var P=T(L,0,[1,0]),D=this.getSignedData(P);return D},this.getSignedData=function(L){var P=U(L,0),D={},A=v(L,P[0]),N=parseInt(A,16);D.version=N;var j=m(L,P[1]);D.hashalgs=this.getHashAlgArray(j);var W=m(L,P[2]);D.econtent=this.getEContent(W);var se=k(L,0,["[0]"]);se!=null&&(D.certs=this.getCertificateSet(se)),k(L,0,["[1]"]);var de=k(L,0,[3]);return D.sinfos=this.getSignerInfos(de),D},this.getHashAlgArray=function(L){for(var P=U(L,0),D=new c,A=[],N=0;N<P.length;N++){var j=m(L,P[N]),W=D.getAlgorithmIdentifierName(j);A.push(W)}return A},this.getEContent=function(L){var P={},D=O(L,0,[0]),A=O(L,0,[1,0]);return P.type=y.asn1.x509.OID.oid2name(Be.hextooidstr(D)),P.content={hex:A},P},this.getSignerInfos=function(L){for(var P=[],D=U(L,0),A=0;A<D.length;A++){var N=m(L,D[A]),j=this.getSignerInfo(N);P.push(j)}return P},this.getSignerInfo=function(L){var P={},D=U(L,0),A=d.getInt(L,D[0],-1);A!=-1&&(P.version=A);var N=m(L,D[1]),j=this.getIssuerAndSerialNumber(N);P.id=j;var W=m(L,D[2]),se=l.getAlgorithmIdentifierName(W);P.hashalg=se;var de=k(L,0,["[0]"]);if(de!=null){var ue=this.getAttributeList(de);P.sattrs=ue}var pe=k(L,0,[3]),G=l.getAlgorithmIdentifierName(pe);P.sigalg=G;var X=F(L,0,[4]);P.sighex=X;var te=k(L,0,["[1]"]);if(te!=null){var J=this.getAttributeList(te);P.uattrs=J}return P},this.getSignerIdentifier=function(L){if(L.substr(0,2)=="30")return this.getIssuerAndSerialNumber(L);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(L){var P={type:"isssn"},D=U(L,0),A=m(L,D[0]);P.issuer=l.getX500Name(A);var N=v(L,D[1]);return P.serial={hex:N},P},this.getAttributeList=function(L){for(var P=[],D=U(L,0),A=0;A<D.length;A++){var N=m(L,D[A]),j=this.getAttribute(N);P.push(j)}return{array:P}},this.getAttribute=function(L){var P={},D=U(L,0),A=d.getOID(L,D[0]),N=y.asn1.x509.OID.oid2name(A);P.attr=N;var j=m(L,D[1]),W=U(j,0);if(W.length==1)P.valhex=m(j,W[0]);else{for(var se=[],de=0;de<W.length;de++)se.push(m(j,W[de]));P.valhex=se}return N=="contentType"?this.setContentType(P):N=="messageDigest"?this.setMessageDigest(P):N=="signingTime"?this.setSigningTime(P):N=="signingCertificate"?this.setSigningCertificate(P):N=="signingCertificateV2"?this.setSigningCertificateV2(P):N=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(P),P},this.setContentType=function(L){var P=d.getOIDName(L.valhex,0,null);P!=null&&(L.type=P,delete L.valhex)},this.setSigningTime=function(L){var P=v(L.valhex,0),D=Zt(P);L.str=D,delete L.valhex},this.setMessageDigest=function(L){var P=v(L.valhex,0);L.hex=P,delete L.valhex},this.setSigningCertificate=function(L){var P=U(L.valhex,0);if(P.length>0){for(var D=m(L.valhex,P[0]),A=U(D,0),N=[],j=0;j<A.length;j++){var W=m(D,A[j]),se=this.getESSCertID(W);N.push(se)}L.array=N}if(P.length>1){var de=m(L.valhex,P[1]);L.polhex=de}delete L.valhex},this.setSignaturePolicyIdentifier=function(L){var P=U(L.valhex,0);if(P.length>0){var D=d.getOID(L.valhex,P[0]);L.oid=D}if(P.length>1){var A=new c,N=U(L.valhex,P[1]),j=m(L.valhex,N[0]),W=A.getAlgorithmIdentifierName(j);L.alg=W;var se=v(L.valhex,N[1]);L.hash=se}delete L.valhex},this.setSigningCertificateV2=function(L){var P=U(L.valhex,0);if(P.length>0){for(var D=m(L.valhex,P[0]),A=U(D,0),N=[],j=0;j<A.length;j++){var W=m(D,A[j]),se=this.getESSCertIDv2(W);N.push(se)}L.array=N}if(P.length>1){var de=m(L.valhex,P[1]);L.polhex=de}delete L.valhex},this.getESSCertID=function(L){var P={},D=U(L,0);if(D.length>0){var A=v(L,D[0]);P.hash=A}if(D.length>1){var N=m(L,D[1]),j=this.getIssuerSerial(N);j.serial!=null&&(P.serial=j.serial),j.issuer!=null&&(P.issuer=j.issuer)}return P},this.getESSCertIDv2=function(L){var P={},D=U(L,0);if(D.length<1||3<D.length)throw new s("wrong number of elements");var A=0;if(L.substr(D[0],2)=="30"){var N=m(L,D[0]);P.alg=l.getAlgorithmIdentifierName(N),A++}else P.alg="sha256";var j=v(L,D[A]);if(P.hash=j,D.length>A+1){var W=m(L,D[A+1]),se=this.getIssuerSerial(W);P.issuer=se.issuer,P.serial=se.serial}return P},this.getIssuerSerial=function(L){var P={},D=U(L,0),A=m(L,D[0]),N=l.getGeneralNames(A),j=N[0].dn;P.issuer=j;var W=v(L,D[1]);return P.serial={hex:W},P},this.getCertificateSet=function(L){for(var P=U(L,0),D=[],A=0;A<P.length;A++){var N=m(L,P[A]);if(N.substr(0,2)=="30"){var j=or(N,"CERTIFICATE");D.push(j)}}return{array:D,sortflag:!1}}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.tsp>"u"||!y.asn1.tsp)&&(y.asn1.tsp={}),y.asn1.tsp.TimeStampToken=function(s){var c=y,l=c.asn1,d=l.tsp;d.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var v=new d.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=v.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.TimeStampToken,y.asn1.cms.SignedData),y.asn1.tsp.TSTInfo=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.DERInteger,m=l.DERBoolean,T=l.DERGeneralizedTime,k=l.DERObjectIdentifier,O=l.DERTaggedObject,F=l.tsp,U=F.MessageImprint,L=F.Accuracy;l.x509.X500Name;var P=l.x509.GeneralName;if(F.TSTInfo.superclass.constructor.call(this),this.dVersion=new v({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var D=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(D.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(D.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(D.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");D.push(this.dGenTime),this.dAccuracy!=null&&D.push(this.dAccuracy),this.dOrdering!=null&&D.push(this.dOrdering),this.dNonce!=null&&D.push(this.dNonce),this.dTsa!=null&&D.push(this.dTsa);var A=new d({array:D});return this.hTLV=A.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0){if(typeof s.policy=="string"){if(!s.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new k({oid:s.policy})}s.messageImprint!==void 0&&(this.dMessageImprint=new U(s.messageImprint)),s.serial!==void 0&&(this.dSerial=new v(s.serial)),s.genTime!==void 0&&(this.dGenTime=new T(s.genTime)),s.accuracy!==void 0&&(this.dAccuracy=new L(s.accuracy)),s.ordering!==void 0&&s.ordering==!0&&(this.dOrdering=new m),s.nonce!==void 0&&(this.dNonce=new v(s.nonce)),s.tsa!==void 0&&(this.dTsa=new O({tag:"a0",explicit:!0,obj:new P({dn:s.tsa})}))}},Ie(y.asn1.tsp.TSTInfo,y.asn1.ASN1Object),y.asn1.tsp.Accuracy=function(s){var c=y,l=c.asn1,d=l.ASN1Util.newObject;l.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var v=this.params,m=[];return v.seconds!=null&&typeof v.seconds=="number"&&m.push({int:v.seconds}),v.millis!=null&&typeof v.millis=="number"&&m.push({tag:{tagi:"80",obj:{int:v.millis}}}),v.micros!=null&&typeof v.micros=="number"&&m.push({tag:{tagi:"81",obj:{int:v.micros}}}),d({seq:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.Accuracy,y.asn1.ASN1Object),y.asn1.tsp.MessageImprint=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.DEROctetString,m=l.x509,T=m.AlgorithmIdentifier;l.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params,O=new T({name:k.alg}),F=new v({hex:k.hash}),U=new d({array:[O,F]});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.tsp.MessageImprint,y.asn1.ASN1Object),y.asn1.tsp.TimeStampReq=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.DERInteger,m=l.DERBoolean;l.ASN1Object;var T=l.DERObjectIdentifier,k=l.tsp,O=k.MessageImprint;k.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];U.push(new v({int:1})),F.messageImprint instanceof y.asn1.ASN1Object?U.push(F.messageImprint):U.push(new O(F.messageImprint)),F.policy!=null&&U.push(new T(F.policy)),F.nonce!=null&&U.push(new v(F.nonce)),F.certreq==!0&&U.push(new m);var L=new d({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.TimeStampReq,y.asn1.ASN1Object),y.asn1.tsp.TimeStampResp=function(s){var c=y,l=c.asn1,d=l.DERSequence;l.ASN1Object;var v=l.tsp,m=v.PKIStatusInfo;v.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var T=this.params,k=[];if(T.econtent!=null||T.tst!=null)if(T.statusinfo!=null?k.push(new m(T.statusinfo)):k.push(new m("granted")),T.econtent!=null)k.push(new v.TimeStampToken(T).getContentInfo());else if(T.tst instanceof l.ASN1Object)k.push(T.tst);else throw new Error("improper member tst value");else if(T.statusinfo!=null)k.push(new m(T.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var O=new d({array:k});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.TimeStampResp,y.asn1.ASN1Object),y.asn1.tsp.PKIStatusInfo=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.tsp,T=m.PKIStatus,k=m.PKIFreeText,O=m.PKIFailureInfo;m.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];if(typeof F=="string")U.push(new T(F));else{if(F.status==null)throw new c("property 'status' unspecified");U.push(new T(F.status)),F.statusstr!=null&&U.push(new k(F.statusstr)),F.failinfo!=null&&U.push(new O(F.failinfo))}var L=new v({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.PKIStatusInfo,y.asn1.ASN1Object),y.asn1.tsp.PKIStatus=function(s){var c=Error,l=y,d=l.asn1,v=d.DERInteger,m=d.tsp;m.PKIStatus.superclass.constructor.call(this);var T={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var k=this.params,O;if(typeof k=="string")try{O=T[k]}catch{throw new c("undefined name: "+k)}else if(typeof k=="number")O=k;else throw new c("unsupported params");return new v({int:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.PKIStatus,y.asn1.ASN1Object),y.asn1.tsp.PKIFreeText=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.DERUTF8String,T=d.tsp;T.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;if(!k instanceof Array)throw new c("wrong params: not array");for(var O=[],F=0;F<k.length;F++)O.push(new m({str:k[F]}));var U=new v({array:O});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.PKIFreeText,y.asn1.ASN1Object),y.asn1.tsp.PKIFailureInfo=function(s){var c=Error,l=y,d=l.asn1,v=d.DERBitString,m=d.tsp,T=m.PKIFailureInfo,k={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};T.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var O=this.params,F=0;if(typeof O=="number"&&0<=O&&O<=25){F|=1<<O;for(var U=F.toString(2),L="",P=U.length-1;P>=0;P--)L+=U[P];return L}else{if(typeof O=="string"&&k[O]!=null)return Jl([O],k);if(typeof O=="object"&&O.length!=null)return Jl(O,k);throw new c("wrong params")}},this.tohex=function(){this.params;var O=this.getBinValue();return new v({bin:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.PKIFailureInfo,y.asn1.ASN1Object),y.asn1.tsp.AbstractTSAAdapter=function(s){this.getTSTHex=function(c,l){throw"not implemented yet"}},y.asn1.tsp.SimpleTSAAdapter=function(s){var c=y,l=c.asn1,d=l.tsp,v=c.crypto.Util.hashHex;d.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(m,T){var k=v(m,T);this.params.econtent.content.messageImprint={alg:T,hash:k},this.params.econtent.content.serial={int:this.serial++};var O=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:O};var F=new d.TimeStampToken(this.params);return F.getContentInfoEncodedHex()},s!==void 0&&(this.params=s)},Ie(y.asn1.tsp.SimpleTSAAdapter,y.asn1.tsp.AbstractTSAAdapter),y.asn1.tsp.FixedTSAAdapter=function(s){var c=y,l=c.asn1,d=l.tsp,v=c.crypto.Util.hashHex;d.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(m,T){var k=v(m,T);this.params.econtent.content.messageImprint={alg:T,hash:k};var O=new d.TimeStampToken(this.params);return O.getContentInfoEncodedHex()},s!==void 0&&(this.params=s)},Ie(y.asn1.tsp.FixedTSAAdapter,y.asn1.tsp.AbstractTSAAdapter),y.asn1.tsp.TSPUtil=new function(){},y.asn1.tsp.TSPUtil.newTimeStampToken=function(s){return new y.asn1.tsp.TimeStampToken(s)},y.asn1.tsp.TSPUtil.parseTimeStampReq=function(s){var c=new y.asn1.tsp.TSPParser;return c.getTimeStampReq(s)},y.asn1.tsp.TSPUtil.parseMessageImprint=function(s){var c=new y.asn1.tsp.TSPParser;return c.getMessageImprint(s)},y.asn1.tsp.TSPParser=function(){var s=ut,c=new s,l=Be,d=l.getV,v=l.getTLV,m=l.getIdxbyList;l.getTLVbyListEx;var T=l.getChildIdx,k=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],O={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(F){var U=T(F,0);if(U.length==1)return this.getPKIStatusInfo(v(F,U[0]));if(U.length>1){var L=this.getPKIStatusInfo(v(F,U[0])),P=v(F,U[1]),D=this.getToken(P);return D.statusinfo=L,D}},this.getToken=function(F){var U=new y.asn1.cms.CMSParser,L=U.getCMSSignedData(F);return this.setTSTInfo(L),L},this.setTSTInfo=function(F){var U=F.econtent;if(U.type=="tstinfo"){var L=U.content.hex,P=this.getTSTInfo(L);U.content=P}},this.getTSTInfo=function(F){var U={},L=T(F,0),P=d(F,L[1]);U.policy=Wl(P);var D=v(F,L[2]);U.messageImprint=this.getMessageImprint(D);var A=d(F,L[3]);U.serial={hex:A};var N=d(F,L[4]);U.genTime={str:Zt(N)};var j=0;if(L.length>5&&F.substr(L[5],2)=="30"){var W=v(F,L[5]);U.accuracy=this.getAccuracy(W),j++}if(L.length>5+j&&F.substr(L[5+j],2)=="01"){var se=d(F,L[5+j]);se=="ff"&&(U.ordering=!0),j++}if(L.length>5+j&&F.substr(L[5+j],2)=="02"){var de=d(F,L[5+j]);U.nonce={hex:de},j++}if(L.length>5+j&&F.substr(L[5+j],2)=="a0"){var ue=v(F,L[5+j]);ue="30"+ue.substr(2),pGeneralNames=c.getGeneralNames(ue);var pe=pGeneralNames[0].dn;U.tsa=pe,j++}if(L.length>5+j&&F.substr(L[5+j],2)=="a1"){var G=v(F,L[5+j]);G="30"+G.substr(2);var X=c.getExtParamArray(G);U.ext=X,j++}return U},this.getAccuracy=function(F){for(var U={},L=T(F,0),P=0;P<L.length;P++){var D=F.substr(L[P],2),A=d(F,L[P]),N=parseInt(A,16);D=="02"?U.seconds=N:D=="80"?U.millis=N:D=="81"&&(U.micros=N)}return U},this.getMessageImprint=function(F){if(F.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var U={};T(F,0);var L=m(F,0,[0,0]),P=d(F,L),D=l.hextooidstr(P),A=y.asn1.x509.OID.oid2name(D);if(A=="")throw new Error("hashAlg name undefined: "+D);var N=A,j=m(F,0,[1]);return U.alg=N,U.hash=d(F,j),U},this.getPKIStatusInfo=function(F){var U={},L=T(F,0),P=0;try{var D=d(F,L[0]),A=parseInt(D,16);U.status=k[A]}catch{}if(L.length>1&&F.substr(L[1],2)=="30"){var N=v(F,L[1]);U.statusstr=this.getPKIFreeText(N),P++}if(L.length>P&&F.substr(L[1+P],2)=="03"){var j=v(F,L[1+P]);U.failinfo=this.getPKIFailureInfo(j)}return U},this.getPKIFreeText=function(F){for(var U=[],L=T(F,0),P=0;P<L.length;P++)U.push(l.getString(F,L[P]));return U},this.getPKIFailureInfo=function(F){var U=l.getInt(F,0);return O[U]!=null?O[U]:U},this.getTimeStampReq=function(F){var U={};U.certreq=!1;var L=T(F,0);if(L.length<2)throw new Error("TimeStampReq must have at least 2 items");var P=v(F,L[1]);U.messageImprint=y.asn1.tsp.TSPUtil.parseMessageImprint(P);for(var D=2;D<L.length;D++){var A=L[D],N=F.substr(A,2);if(N=="06"){var j=d(F,A);U.policy=l.hextooidstr(j)}N=="02"&&(U.nonce=d(F,A)),N=="01"&&(U.certreq=!0)}return U}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.cades>"u"||!y.asn1.cades)&&(y.asn1.cades={}),y.asn1.cades.SignaturePolicyIdentifier=function(s){var c=y,l=c.asn1,d=l.cades,v=d.SignaturePolicyId;d.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new v(this.params)]},this.setByParam=function(m){this.params=m},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.SignaturePolicyIdentifier,y.asn1.cms.Attribute),y.asn1.cades.SignaturePolicyId=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.DERObjectIdentifier,m=l.x509;m.AlgorithmIdentifier;var T=l.cades,k=T.SignaturePolicyId,O=T.OtherHashAlgAndValue;k.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];U.push(new v(F.oid)),U.push(new O(F));var L=new d({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(F){this.params=F},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.SignaturePolicyId,y.asn1.ASN1Object),y.asn1.cades.OtherHashAlgAndValue=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.DEROctetString,T=d.x509,k=T.AlgorithmIdentifier,O=d.cades,F=O.OtherHashAlgAndValue;F.superclass.constructor.call(this),this.params=null,this.tohex=function(){var U=this.params;if(U.alg==null)throw new c("property 'alg' not specified");if(U.hash==null&&U.cert==null)throw new c("property 'hash' nor 'cert' not specified");var L=null;if(U.hash!=null)L=U.hash;else if(U.cert!=null){if(typeof U.cert!="string")throw new c("cert not string");var P=U.cert;U.cert.indexOf("-----BEGIN")!=-1&&(P=En(U.cert)),L=y.crypto.Util.hashHex(P,U.alg)}var D=[];D.push(new k({name:U.alg})),D.push(new m({hex:L}));var A=new v({array:D});return A.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.OtherHashAlgAndValue,y.asn1.ASN1Object),y.asn1.cades.OtherHashValue=function(s){y.asn1.cades.OtherHashValue.superclass.constructor.call(this);var c=Error,l=y;l.lang.String.isHex;var d=l.asn1,v=d.DEROctetString;l.crypto.Util.hashHex,this.params=null,this.tohex=function(){var m=this.params;if(m.hash==null&&m.cert==null)throw new c("hash or cert not specified");var T=null;if(m.hash!=null)T=m.hash;else if(m.cert!=null){if(typeof m.cert!="string")throw new c("cert not string");var k=m.cert;m.cert.indexOf("-----BEGIN")!=-1&&(k=En(m.cert)),T=y.crypto.Util.hashHex(k,"sha1")}return new v({hex:T}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.OtherHashValue,y.asn1.ASN1Object),y.asn1.cades.SignatureTimeStamp=function(s){var c=Error,l=y,d=l.lang.String.isHex,v=l.asn1,m=v.ASN1Object;v.x509;var T=v.cades;T.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var k=this.params;if(k.tst!=null)if(d(k.tst)){var O=new m;return O.hTLV=k.tst,[O]}else{if(k.tst instanceof m)return[k.tst];throw new c("params.tst has wrong value")}else if(k.res!=null){var F=k.res;if(F instanceof m&&(F=F.tohex()),typeof F!="string"||!d(F))throw new c("params.res has wrong value");Be.getTLVbyList(F,0,[1]);var O=new m;return O.hTLV=k.tst,[O]}},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.SignatureTimeStamp,y.asn1.cms.Attribute),y.asn1.cades.CompleteCertificateRefs=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.cades,T=m.OtherCertID,k=l.lang.String.isHex;m.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var O=this.params,F=[],U=0;U<O.array.length;U++){var L=O.array[U];if(typeof L=="string")if(L.indexOf("-----BEGIN")!=-1)L={cert:L};else if(k(L))L={hash:L};else throw new c("unsupported value: "+L);O.alg!=null&&L.alg==null&&(L.alg=O.alg),O.hasis!=null&&L.hasis==null&&(L.hasis=O.hasis);var P=new T(L);F.push(P)}var D=new v({array:F});return[D]},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.CompleteCertificateRefs,y.asn1.cms.Attribute),y.asn1.cades.OtherCertID=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.cms,m=v.IssuerSerial,T=l.cades,k=T.OtherHashValue,O=T.OtherHashAlgAndValue;T.OtherCertID.superclass.constructor.call(this),this.params=s,this.tohex=function(){var F=this.params;typeof F=="string"&&(F.indexOf("-----BEGIN")!=-1?F={cert:F}:_isHex(F)&&(F={hash:F}));var U=[],L=null;if(F.alg!=null?L=new O(F):L=new k(F),U.push(L),F.cert!=null&&F.hasis==!0||F.issuer!=null&&F.serial!=null){var P=new m(F);U.push(P)}var D=new d({array:U});return D.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.OtherCertID,y.asn1.ASN1Object),y.asn1.cades.OtherHash=function(s){var c=y,l=c.asn1;l.cms;var d=l.cades,v=d.OtherHashAlgAndValue,m=d.OtherHashValue;c.crypto.Util.hashHex;var T=c.lang.String.isHex;d.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;typeof k=="string"&&(k.indexOf("-----BEGIN")!=-1?k={cert:k}:T(k)&&(k={hash:k}));var O=null;return k.alg!=null?O=new v(k):O=new m(k),O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.OtherHash,y.asn1.ASN1Object),y.asn1.cades.CAdESUtil=new function(){},y.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(s){var c=new y.asn1.cms.CMSParser,l=c.getCMSSignedData(s);return l},y.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(s,c,l){var d=Be,v=d.getChildIdx,m=d.getTLV,T=d.getV,k=y,O=k.asn1,F=O.ASN1Object,U=O.cms,L=U.AttributeList,P=U.SignerInfo,D={},A=v(s,c);if(A.length!=6)throw"not supported items for SignerInfo (!=6)";var N=A.shift();D.version=m(s,N);var j=A.shift();D.si=m(s,j);var W=A.shift();D.digalg=m(s,W);var se=A.shift();D.sattrs=m(s,se);var de=A.shift();D.sigalg=m(s,de);var ue=A.shift();D.sig=m(s,ue),D.sigval=T(s,ue);var pe=null;return D.obj=new P,pe=new F,pe.hTLV=D.version,D.obj.dCMSVersion=pe,pe=new F,pe.hTLV=D.si,D.obj.dSignerIdentifier=pe,pe=new F,pe.hTLV=D.digalg,D.obj.dDigestAlgorithm=pe,pe=new F,pe.hTLV=D.sattrs,D.obj.dSignedAttrs=pe,pe=new F,pe.hTLV=D.sigalg,D.obj.dSigAlg=pe,pe=new F,pe.hTLV=D.sig,D.obj.dSig=pe,D.obj.dUnsignedAttrs=new L,D},(typeof y.asn1.csr>"u"||!y.asn1.csr)&&(y.asn1.csr={}),y.asn1.csr.CertificationRequest=function(s){var c=y,l=c.asn1,d=l.DERBitString,v=l.DERSequence,m=l.csr;l.x509;var T=m.CertificationRequestInfo;m.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(k){this.params=k},this.sign=function(){var k=new T(this.params).tohex(),O=new y.crypto.Signature({alg:this.params.sigalg});O.init(this.params.sbjprvkey),O.updateHex(k);var F=O.sign();this.params.sighex=F},this.getPEM=function(){return or(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var k=this.params,O=new y.asn1.csr.CertificationRequestInfo(this.params),F=new y.asn1.x509.AlgorithmIdentifier({name:k.sigalg});if(k.sighex==null&&k.sbjprvkey!=null&&this.sign(),k.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var U=new d({hex:"00"+k.sighex}),L=new v({array:[O,F,U]});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.csr.CertificationRequest,y.asn1.ASN1Object),y.asn1.csr.CertificationRequestInfo=function(s){var c=y,l=c.asn1;l.DERBitString;var d=l.DERSequence,v=l.DERInteger,m=l.DERUTF8String,T=l.DERTaggedObject,k=l.ASN1Util.newObject,O=l.csr,F=l.x509,U=F.X500Name,L=F.Extensions,P=F.SubjectPublicKeyInfo;O.AttributeList,O.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(A){A!=null&&(this.params=A)},this.tohex=function(){var A=this.params,N=[];if(N.push(new v({int:0})),N.push(new U(A.subject)),N.push(new P(Ot.getKey(A.sbjpubkey))),A.attrs!=null){var j=D(A.attrs),W=k({tag:{tage:"a0",obj:j}});N.push(W)}else if(A.extreq!=null){var se=new L(A.extreq),W=k({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[se]}]}}});N.push(W)}else N.push(new T({tag:"a0",explicit:!1,obj:new m({str:""})}));var de=new d({array:N});return de.tohex()},this.getEncodedHex=function(){return this.tohex()};function D(A){for(var N=Error,j=y.asn1.x509.Extensions,W=[],se=0;se<A.length;se++){var de=A[se],ue=de.attr;if(ue=="extensionRequest"){var pe=new j(de.ext),G={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[pe]}]};W.push(G)}else if(ue=="unstructuredName"){var G={seq:[{oid:"1.2.840.113549.1.9.2"},{set:de.names}]};W.push(G)}else if(ue=="challengePassword"){var G={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:de.password}]}]};W.push(G)}else throw new N("unknown CSR attribute")}return{set:W}}s!=null&&this.setByParam(s)},Ie(y.asn1.csr.CertificationRequestInfo,y.asn1.ASN1Object),y.asn1.csr.AttributeList=function(s){},Ie(y.asn1.csr.AttributeList,y.asn1.ASN1Object),y.asn1.csr.CSRUtil=new function(){},y.asn1.csr.CSRUtil.newCSRPEM=function(s){var c=y.asn1.csr,l=new c.CertificationRequest(s),d=l.getPEM();return d},y.asn1.csr.CSRUtil.getParam=function(s,c){var l=Be,d=l.getV,v=l.getIdxbyList,m=l.getTLVbyList,T=l.getTLVbyListEx,k=l.getVbyListEx,O=function(se){var de=v(se,0,[0,3,0,0],"06");return d(se,de)!="2a864886f70d01090e"?null:m(se,0,[0,3,0,1,0],"30")},F={};if(s.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var U=En(s,"CERTIFICATE REQUEST");c&&(F.tbs=m(U,0,[0]));try{var L=T(U,0,[0,1]);if(L=="3000")F.subject={};else{var N=new ut;F.subject=N.getX500Name(L)}}catch{}var P=T(U,0,[0,2]),D=Ot.getKey(P,null,"pkcs8pub");F.sbjpubkey=Ot.getPEM(D,"PKCS8PUB");var A=O(U),N=new ut;A!=null&&(F.extreq=N.getExtParamArray(A));try{var j=T(U,0,[1],"30"),N=new ut;F.sigalg=N.getAlgorithmIdentifierName(j)}catch{}try{var W=k(U,0,[2]);F.sighex=W}catch{}return F},y.asn1.csr.CSRUtil.verifySignature=function(s){try{var c=null;if(typeof s=="string"&&s.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?c=y.asn1.csr.CSRUtil.getParam(s,!0):typeof s=="object"&&s.sbjpubkey!=null&&s.sigalg!=null&&s.sighex!=null&&s.tbs!=null&&(c=s),c==null)return!1;var l=new y.crypto.Signature({alg:c.sigalg});return l.init(c.sbjpubkey),l.updateHex(c.tbs),l.verify(c.sighex)}catch(d){return alert(d),!1}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.ocsp>"u"||!y.asn1.ocsp)&&(y.asn1.ocsp={}),y.asn1.ocsp.DEFAULT_HASH="sha1",y.asn1.ocsp.OCSPResponse=function(s){y.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),y.asn1.DEREnumerated;var c=y.asn1.ASN1Util.newObject,l=y.asn1.ocsp.ResponseBytes,d=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var v=this.params.resstatus;return typeof v=="number"?v:typeof v!="string"?-1:d.indexOf(v)},this.setByParam=function(v){this.params=v},this.tohex=function(){var v=this.params,m=this._getStatusCode();if(m==-1)throw new Error("responseStatus not supported: "+v.resstatus);if(m!=0)return c({seq:[{enum:{int:m}}]}).tohex();var T=new l(v);return c({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:T}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.OCSPResponse,y.asn1.ASN1Object),y.asn1.ocsp.ResponseBytes=function(s){y.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.DERObjectIdentifier,v=c.DEROctetString,m=c.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(T.restype!="ocspBasic")throw new Error("not supported responseType: "+T.restype);var k=new m(T),O=[];O.push(new d({name:"ocspBasic"})),O.push(new v({hex:k.tohex()}));var F=new l({array:O});return F.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.ResponseBytes,y.asn1.ASN1Object),y.asn1.ocsp.BasicOCSPResponse=function(s){y.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var c=Error,l=y.asn1,d=l.ASN1Object,v=l.DERSequence;l.DERGeneralizedTime;var m=l.DERTaggedObject,T=l.DERBitString;l.x509.Extensions;var k=l.x509.AlgorithmIdentifier,O=l.ocsp;O.ResponderID,_SingleResponseList=O.SingleResponseList,_ResponseData=O.ResponseData,this.params=null,this.setByParam=function(F){this.params=F},this.sign=function(){var F=this.params,U=F.tbsresp.tohex(),L=new y.crypto.Signature({alg:F.sigalg});L.init(F.reskey),L.updateHex(U),F.sighex=L.sign()},this.tohex=function(){var F=this.params;F.tbsresp==null&&(F.tbsresp=new _ResponseData(F)),F.sighex==null&&F.reskey!=null&&this.sign();var U=[];if(U.push(F.tbsresp),U.push(new k({name:F.sigalg})),U.push(new T({hex:"00"+F.sighex})),F.certs!=null&&F.certs.length!=null){for(var L=[],P=0;P<F.certs.length;P++){var D=F.certs[P],A=null;if(Be.isASN1HEX(D))A=D;else if(D.match(/-----BEGIN/))A=En(D);else throw new c("certs["+P+"] not hex or PEM");L.push(new d({tlv:A}))}var N=new v({array:L});U.push(new m({tag:"a0",explicit:!0,obj:N}))}var j=new v({array:U});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.BasicOCSPResponse,y.asn1.ASN1Object),y.asn1.ocsp.ResponseData=function(s){y.asn1.ocsp.ResponseData.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.DERGeneralizedTime,v=c.DERTaggedObject,m=c.x509.Extensions,T=c.ocsp,k=T.ResponderID;_SingleResponseList=T.SingleResponseList,this.params=null,this.tohex=function(){var O=this.params;O.respid!=null,O.prodat!=null,O.array!=null;var F=[];if(F.push(new k(O.respid)),F.push(new d(O.prodat)),F.push(new _SingleResponseList(O.array)),O.ext!=null){var U=new m(O.ext);F.push(new v({tag:"a1",explicit:!0,obj:U}))}var L=new l({array:F});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(O){this.params=O},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.ResponseData,y.asn1.ASN1Object),y.asn1.ocsp.ResponderID=function(s){y.asn1.ocsp.ResponderID.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.ASN1Util.newObject,v=l.x509.X500Name,m=c.lang.String.isHex,T=Error;this.params=null,this.tohex=function(){var k=this.params;if(k.key!=null){var O=null;if(typeof k.key=="string"){if(m(k.key)&&(O=k.key),k.key.match(/-----BEGIN CERTIFICATE/)){var F=new ut(k.key),U=F.getExtSubjectKeyIdentifier();U!=null&&(O=U.kid.hex)}}else if(k.key instanceof ut){var U=k.key.getExtSubjectKeyIdentifier();U!=null&&(O=U.kid.hex)}if(O==null)throw new T("wrong key member value");var L=d({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:O}}}});return L.tohex()}else if(k.name!=null){var P=null;if(typeof k.name=="string"&&k.name.match(/-----BEGIN CERTIFICATE/)){var F=new ut(k.name);P=F.getSubject()}else k.name instanceof ut?P=k.name.getSubject():typeof k.name=="object"&&(k.name.array!=null||k.name.str!=null)&&(P=k.name);if(P==null)throw new T("wrong name member value");var L=d({tag:{tag:"a1",explicit:!0,obj:new v(P)}});return L.tohex()}throw new T("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(k){this.params=k},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.ResponderID,y.asn1.ASN1Object),y.asn1.ocsp.SingleResponseList=function(s){y.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.ocsp.SingleResponse;this.params=null,this.tohex=function(){var v=this.params;if(typeof v!="object"||v.length==null)throw new Error("params not specified properly");for(var m=[],T=0;T<v.length;T++)m.push(new d(v[T]));var k=new l({array:m});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(v){this.params=v},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.SingleResponseList,y.asn1.ASN1Object),y.asn1.ocsp.SingleResponse=function(s){var c=Error,l=y,d=l.asn1,v=d.DERSequence,m=d.DERGeneralizedTime,T=d.DERTaggedObject,k=d.ocsp,O=k.CertID,F=k.CertStatus,U=d.x509,L=U.Extensions;k.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P=this.params,D=[];if(P.certid==null)throw new c("certid unspecified");if(P.status==null)throw new c("status unspecified");if(P.thisupdate==null)throw new c("thisupdate unspecified");if(D.push(new O(P.certid)),D.push(new F(P.status)),D.push(new m(P.thisupdate)),P.nextupdate!=null){var A=new m(P.nextupdate);D.push(new T({tag:"a0",explicit:!0,obj:A}))}if(P.ext!=null){var N=new L(P.ext);D.push(new T({tag:"a1",explicit:!0,obj:N}))}var j=new v({array:D});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(P){this.params=P},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.SingleResponse,y.asn1.ASN1Object),y.asn1.ocsp.CertID=function(s){var c=y,l=c.asn1,d=l.DEROctetString,v=l.DERInteger,m=l.DERSequence,T=l.x509,k=T.AlgorithmIdentifier,O=l.ocsp;O.DEFAULT_HASH;var F=c.crypto,U=F.Util.hashHex,L=ut,P=Be,D=P.getVbyList;O.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(A,N,j,W){W==null&&(W=this.DEFAULT_HASH),this.params={alg:W,issname:A,isskey:N,sbjsn:j}},this.setByCert=function(A,N,j){j==null&&(j=this.DEFAULT_HASH),this.params={alg:j,issuerCert:A,subjectCert:N}},this.getParamByCerts=function(A,N,j){j==null&&(j=this.DEFAULT_HASH);var W=new L(A),se=new L(N),de=U(W.getSubjectHex(),j),ue=W.getPublicKeyHex(),pe=U(D(ue,0,[1],"03",!0),j),G=se.getSerialNumberHex(),X={alg:j,issname:de,isskey:pe,sbjsn:G};return X},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var A=this.params,N,j,W,se;if(A.alg==null?se=this.DEFAULT_HASH:se=A.alg,A.issuerCert!=null&&A.subjectCert!=null){var de=this.getParamByCerts(A.issuerCert,A.subjectCert,se);N=de.issname,j=de.isskey,W=de.sbjsn}else if(A.issname!=null&&A.isskey!=null&&A.sbjsn!=null)N=A.issname,j=A.isskey,W=A.sbjsn;else throw new Error("required param members not defined");var ue=new k({name:se}),pe=new d({hex:N}),G=new d({hex:j}),X=new v({hex:W}),te=new m({array:[ue,pe,G,X]});return this.hTLV=te.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.CertID,y.asn1.ASN1Object),y.asn1.ocsp.CertStatus=function(s){y.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(c.status=="good")return"8000";if(c.status=="unknown")return"8200";if(c.status=="revoked"){var l=[{gentime:{str:c.time}}];c.reason!=null&&l.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:c.reason}}}});var d={tag:"a1",explicit:!1,obj:{seq:l}};return y.asn1.ASN1Util.newObject({tag:d}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.CertStatus,y.asn1.ASN1Object),y.asn1.ocsp.Request=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.ocsp;if(v.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var T=[];if(this.dReqCert===null)throw"reqCert not set";T.push(this.dReqCert);var k=new d({array:T});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof s<"u"){var m=new v.CertID(s);this.dReqCert=m}},Ie(y.asn1.ocsp.Request,y.asn1.ASN1Object),y.asn1.ocsp.TBSRequest=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.ocsp;v.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(m){for(var T=[],k=0;k<m.length;k++){var O=new v.Request(m[0]);T.push(O)}this.dRequestList=T},this.tohex=function(){var m=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var T=new d({array:this.dRequestList});if(m.push(T),this.dRequestExt!==null)throw"requestExtensions not supported";var k=new d({array:m});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&s.reqList!==void 0&&this.setRequestListByParam(s.reqList)},Ie(y.asn1.ocsp.TBSRequest,y.asn1.ASN1Object),y.asn1.ocsp.OCSPRequest=function(s){var c=y,l=c.asn1,d=l.DERSequence,v=l.ocsp;if(v.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var T=[];if(this.dTbsRequest!==null)T.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var k=new d({array:T});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&s.reqList!==void 0){var m=new v.TBSRequest(s);this.dTbsRequest=m}},Ie(y.asn1.ocsp.OCSPRequest,y.asn1.ASN1Object),y.asn1.ocsp.OCSPUtil={},y.asn1.ocsp.OCSPUtil.getRequestHex=function(s,c,l){var d=y,v=d.asn1,m=v.ocsp;l===void 0&&(l=m.DEFAULT_HASH);var T={alg:l,issuerCert:s,subjectCert:c},k=new m.OCSPRequest({reqList:[T]});return k.tohex()},y.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(s){var c=Be,l=c.getVbyList,d=c.getVbyListEx,v=c.getIdxbyList;c.getIdxbyListEx;var m=c.getV,T={};try{var k=d(s,0,[0],"0a");T.responseStatus=parseInt(k,16)}catch{}if(T.responseStatus!==0)return T;try{var O=v(s,0,[1,0,1,0,0,2,0,1]);s.substr(O,2)==="80"?T.certStatus="good":s.substr(O,2)==="a1"?(T.certStatus="revoked",T.revocationTime=Zt(l(s,O,[0]))):s.substr(O,2)==="82"&&(T.certStatus="unknown")}catch{}try{var F=v(s,0,[1,0,1,0,0,2,0,2]);T.thisUpdate=Zt(m(s,F))}catch{}try{var U=v(s,0,[1,0,1,0,0,2,0,3]);s.substr(U,2)==="a0"&&(T.nextUpdate=Zt(l(s,U,[0])))}catch{}return T},y.asn1.ocsp.OCSPParser=function(){var s=Error,c=ut,l=new c,d=Be,v=d.getV,m=d.getTLV,T=d.getIdxbyList,k=d.getVbyList,O=d.getTLVbyList,F=d.getVbyListEx,U=d.getTLVbyListEx,L=d.getChildIdx;this.getOCSPRequest=function(P){var D=L(P,0);if(D.length!=1&&D.length!=2)throw new s("wrong number elements: "+D.length);var A=this.getTBSRequest(m(P,D[0]));return A},this.getTBSRequest=function(P){var D={},A=U(P,0,[0],"30");D.array=this.getRequestList(A);var N=U(P,0,["[2]",0],"30");return N!=null&&(D.ext=l.getExtParamArray(N)),D},this.getRequestList=function(P){for(var D=[],A=L(P,0),N=0;N<A.length;N++){var P=m(P,A[N]);D.push(this.getRequest(P))}return D},this.getRequest=function(P){var D=L(P,0);if(D.length!=1&&D.length!=2)throw new s("wrong number elements: "+D.length);var A=this.getCertID(m(P,D[0]));if(D.length==2){var N=T(P,0,[1,0]);A.ext=l.getExtParamArray(m(P,N))}return A},this.getCertID=function(P){var D=L(P,0);if(D.length!=4)throw new s("wrong number elements: "+D.length);var A=new c,N={};return N.alg=A.getAlgorithmIdentifierName(m(P,D[0])),N.issname=v(P,D[1]),N.isskey=v(P,D[2]),N.sbjsn=v(P,D[3]),N},this.getOCSPResponse=function(P){var D=L(P,0),A,N=v(P,D[0]),j=parseInt(N);if(D.length==1)return{resstatus:j};var W=O(P,0,[1,0]);return A=this.getResponseBytes(W),A.resstatus=j,A},this.getResponseBytes=function(P){var D=L(P,0),A,N=O(P,0,[1,0]);A=this.getBasicOCSPResponse(N);var j=v(P,D[0]);return A.restype=y.asn1.x509.OID.oid2name(Wl(j)),A},this.getBasicOCSPResponse=function(P){var D=L(P,0),A;A=this.getResponseData(m(P,D[0]));var N=new ut;A.alg=N.getAlgorithmIdentifierName(m(P,D[1]));var j=v(P,D[2]);A.sighex=j.substr(2);var W=F(P,0,["[0]"]);if(W!=null){for(var se=L(W,0),de=[],ue=0;ue<se.length;ue++){var pe=m(W,se[ue]);de.push(pe)}A.certs=de}return A},this.getResponseData=function(P){var D=L(P,0),A=D.length,N={},j=0;P.substr(D[0],2)=="a0"&&j++,N.respid=this.getResponderID(m(P,D[j++]));var W=v(P,D[j++]);if(N.prodat=Zt(W),N.array=this.getSingleResponseList(m(P,D[j++])),P.substr(D[A-1],2)=="a1"){var se=O(P,D[A-1],[0]),de=new ut;N.ext=de.getExtParamArray(se)}return N},this.getResponderID=function(P){var D={};if(P.substr(0,2)=="a2"){var A=k(P,0,[0]);D.key=A}if(P.substr(0,2)=="a1"){var N=O(P,0,[0]),j=new ut;D.name=j.getX500Name(N)}return D},this.getSingleResponseList=function(P){for(var D=L(P,0),A=[],N=0;N<D.length;N++){var j=this.getSingleResponse(m(P,D[N]));A.push(j)}return A},this.getSingleResponse=function(P){var D=L(P,0),A={},N=this.getCertID(m(P,D[0]));A.certid=N;var j=this.getCertStatus(m(P,D[1]));if(A.status=j,P.substr(D[2],2)=="18"){var W=v(P,D[2]);A.thisupdate=Zt(W)}for(var se=3;se<D.length;se++){if(P.substr(D[se],2)=="a0"){var de=k(P,D[se],[0],"18");A.nextupdate=Zt(de)}if(P.substr(D[se],2)=="a1"){var ue=new ut,pe=O(P,0,[se,0]);A.ext=ue.getExtParamArray(pe)}}return A},this.getCertStatus=function(P){var D={};if(P=="8000")return{status:"good"};if(P=="8200")return{status:"unknown"};if(P.substr(0,2)=="a1"){D.status="revoked";var A=k(P,0,[0]),N=Zt(A);D.time=N}return D}};var y;(typeof y>"u"||!y)&&(y={}),(typeof y.lang>"u"||!y.lang)&&(y.lang={}),y.lang.String=function(){};function ug(s){for(var c=new Array,l=0;l<s.length;l++)c[l]=s.charCodeAt(l);return c}function dg(s){for(var c="",l=0;l<s.length;l++)c=c+String.fromCharCode(s[l]);return c}function Ul(s){for(var c="",l=0;l<s.length;l++){var d=s[l].toString(16);d.length==1&&(d="0"+d),c=c+d}return c}function Nr(s){return Ul(ug(s))}function h2(s){return p(Nr(s))}function p2(s){return Xa(p(Nr(s)))}function f2(s){return dg(g(tc(s)))}function Xa(s){return s=s.replace(/\=/g,""),s=s.replace(/\+/g,"-"),s=s.replace(/\//g,"_"),s}function tc(s){return s.length%4==2?s=s+"==":s.length%4==3&&(s=s+"="),s=s.replace(/-/g,"+"),s=s.replace(/_/g,"/"),s}function jn(s){return s.length%2==1&&(s="0"+s),Xa(p(s))}function on(s){return h(tc(s))}var nc,gi;typeof Buffer=="function"?(nc=function(s){return Xa(Buffer.from(s,"utf8").toString("base64"))},gi=function(s){return Buffer.from(tc(s),"base64").toString("utf8")}):(nc=function(s){return jn(ql($l(s)))},gi=function(s){return decodeURIComponent(zl(on(s)))});function m2(s){return p(ql($l(s)))}function g2(s){return decodeURIComponent(zl(h(s)))}function Hl(s){return ql($l(s)).toLowerCase()}function Zt(s){try{return decodeURIComponent(zl(s))}catch{return null}}function v2(s){return Zt(y2(s))}function y2(s){for(var c=s.match(/.{1,2}/g),l=[],d=0;d<c.length;d++){var v=parseInt(c[d],16);161<=v&&v<=191?(l.push("c2"),l.push(c[d])):192<=v&&v<=255?(l.push("c3"),l.push((v-64).toString(16))):l.push(c[d])}return l.join("")}function Or(s){for(var c="",l=0;l<s.length-1;l+=2)c+=String.fromCharCode(parseInt(s.substr(l,2),16));return c}function Vi(s){for(var c="",l=0;l<s.length;l++)c+=("0"+s.charCodeAt(l).toString(16)).slice(-2);return c}function Mh(s){return p(s)}function _2(s){return Vl(Mh(s),64)}function Vl(s,c){return s=s.replace(new RegExp("(.{"+c+"})","g"),`$1\r
`),s=s.replace(/\s+$/,""),s}function hg(s){var c=s.replace(/[^0-9A-Za-z\/+=]*/g,""),l=h(c);return l}function b2(s,c){return"-----BEGIN "+c+`-----\r
`+Vl(s,64)+`\r
-----END `+c+`-----\r
`}function or(s,c){return"-----BEGIN "+c+`-----\r
`+Vl(Mh(s),64)+`\r
-----END `+c+`-----\r
`}function En(s,c){if(s.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return c!==void 0?(s=s.replace(new RegExp("^[^]*-----BEGIN "+c+"-----"),""),s=s.replace(new RegExp("-----END "+c+"-----[^]*$"),"")):(s=s.replace(/^[^]*-----BEGIN [^-]+-----/,""),s=s.replace(/-----END [^-]+-----[^]*$/,"")),hg(s)}function S2(s){return s.indexOf("-----BEGIN ")==-1||s.indexOf("-----END ")==-1?null:(s=s.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),s=s.replace(/-----END [\s\S]+$/m,""),s=s.replace(/\s+/g,""),s.match(/^[0-9a-zA-Z+/=]+$/)?s:null)}function w2(s){if(s.length%2!=0)throw"input is not even length";if(s.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var c=new ArrayBuffer(s.length/2),l=new DataView(c),d=0;d<s.length/2;d++)l.setUint8(d,parseInt(s.substr(d*2,2),16));return c}function x2(s){for(var c="",l=new DataView(s),d=0;d<s.byteLength;d++)c+=("00"+l.getUint8(d).toString(16)).slice(-2);return c}function Lh(s){var c,l,d,v,m,T,k,O,F,U;if(s=fg(s),U=s.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),U)return c=parseInt(U[1]),l=parseInt(U[2])-1,d=parseInt(U[3]),v=parseInt(U[4]),m=parseInt(U[5]),T=parseInt(U[6]),k=0,O=U[7],O!==""&&(F=(O.substr(1)+"00").substr(0,3),k=parseInt(F)),Date.UTC(c,l,d,v,m,T,k);throw new Error("unsupported zulu format: "+s)}function C2(s){var c=new Date(s),l=("0000"+c.getUTCFullYear()).slice(-4),d=("00"+(c.getUTCMonth()+1)).slice(-2),v=("00"+c.getUTCDate()).slice(-2),m=("00"+c.getUTCHours()).slice(-2),T=("00"+c.getUTCMinutes()).slice(-2),k=("00"+c.getUTCSeconds()).slice(-2),O=("000"+c.getUTCMilliseconds()).slice(-3);return O=O.replace(/0+$/,""),O=O!=""?"."+O:O,l+d+v+m+T+k+O+"Z"}function pg(s){return Math.round(Lh(s)/1e3)}function E2(s){return new Date(Lh(s))}function P2(s,c,l){var d,v=s.getUTCFullYear();if(c){if(v<1950||2049<v)throw"not proper year for UTCTime: "+v;d=(""+v).slice(-2)}else d=("000"+v).slice(-4);if(d+=("0"+(s.getUTCMonth()+1)).slice(-2),d+=("0"+s.getUTCDate()).slice(-2),d+=("0"+s.getUTCHours()).slice(-2),d+=("0"+s.getUTCMinutes()).slice(-2),d+=("0"+s.getUTCSeconds()).slice(-2),l){var m=s.getUTCMilliseconds();m!==0&&(m=("00"+m).slice(-3),m=m.replace(/0+$/g,""),d+="."+m)}return d+="Z",d}function fg(s){return s.match(/^[0-9]{12}Z$/)||s.match(/^[0-9]{12}[.][0-9]*Z$/)?s.match(/^[0-4]/)?"20"+s:"19"+s:s}function ql(s){return s.replace(/%/g,"")}function zl(s){return s.replace(/(..)/g,"%$1")}function jh(s){var c="malformed IPv6 address";if(!s.match(/^[0-9A-Fa-f:]+$/))throw c;s=s.toLowerCase();var l=s.split(":").length-1;if(l<2)throw c;var d=":".repeat(7-l+2);s=s.replace("::",d);var v=s.split(":");if(v.length!=8)throw c;for(var m=0;m<8;m++)v[m]=("0000"+v[m]).slice(-4);return v.join("")}function Bh(s){if(!s.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+s);s=s.toLowerCase();var c=s.match(/.{1,4}/g);c=c.map(function(v){return v.replace(/^0+/,"")}),c=c.map(function(v){return v==""?"0":v}),s=":"+c.join(":")+":";var l=s.match(/:(0:){2,}/g);if(l==null)return s.slice(1,-1);var d=l.sort().slice(-1)[0];return s=s.replace(d.substr(0,d.length-1),":"),s.substr(0,2)!="::"&&(s=s.substr(1)),s.substr(-2,2)!="::"&&(s=s.substr(0,s.length-1)),s}function Kl(s){var c=new Error("malformed hex value");if(!s.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw c;if(s.length==8){var l;try{return l=parseInt(s.substr(0,2),16)+"."+parseInt(s.substr(2,2),16)+"."+parseInt(s.substr(4,2),16)+"."+parseInt(s.substr(6,2),16),l}catch{throw c}}else if(s.length==16)try{return Kl(s.substr(0,8))+"/"+mg(s.substr(8))}catch{throw c}else{if(s.length==32)return Bh(s);if(s.length==64){try{return Bh(s.substr(0,32))+"/"+mg(s.substr(32))}catch{throw c}return}else return s}}function mg(s){var c=new Error("malformed mask"),l;try{l=new _(s,16).toString(2)}catch{throw c}if(!l.match(/^1*0*$/))throw c;return l.replace(/0+$/,"").length}function Uh(s){var c=new Error("malformed IP address");if(s=s.toLowerCase(s),!s.match(/^[0-9a-f.:/]+$/))throw c;if(s.match(/^[0-9.]+$/)){var l=s.split(".");if(l.length!==4)throw c;var d="";try{for(var v=0;v<4;v++){var m=parseInt(l[v]);d+=("0"+m.toString(16)).slice(-2)}return d}catch{throw c}}else if(s.match(/^[0-9.]+\/[0-9]+$/)){var T=s.split("/");return Uh(T[0])+gg(parseInt(T[1]),32)}else{if(s.match(/^[0-9a-f:]+$/)&&s.indexOf(":")!==-1)return jh(s);if(s.match(/^[0-9a-f:]+\/[0-9]+$/)&&s.indexOf(":")!==-1){var T=s.split("/");return jh(T[0])+gg(parseInt(T[1]),128)}else throw c}}function gg(s,c){if(c==32&&s==0)return"00000000";if(c==128&&s==0)return"00000000000000000000000000000000";var l=Array(s+1).join("1")+Array(c-s+1).join("0");return new _(l,2).toString(16)}function Hh(s){function c(v){var m=parseInt(v.substr(0,2),16),T=parseInt(v.substr(2),16);if(m==0&T<128)return String.fromCharCode(T);if(m<8){var k=192|(m&7)<<3|(T&192)>>6,O=128|T&63;return Zt(k.toString(16)+O.toString(16))}var k=224|(m&240)>>4,O=128|(m&15)<<2|(T&192)>>6,F=128|T&63;return Zt(k.toString(16)+O.toString(16)+F.toString(16))}var l=s.match(/.{4}/g),d=l.map(c);return d.join("")}function $l(s){for(var c=encodeURIComponent(s),l="",d=0;d<c.length;d++)c[d]=="%"?(l=l+c.substr(d,3),d=d+2):l=l+"%"+Nr(c[d]);return l}function k2(s){return s=s.replace(/\r\n/mg,`
`),s}function T2(s){return s=s.replace(/\r\n/mg,`
`),s=s.replace(/\n/mg,`\r
`),s}y.lang.String.isInteger=function(s){return s.match(/^[0-9]+$/)?!0:!!s.match(/^-[0-9]+$/)},y.lang.String.isHex=function(s){return vg(s)};function vg(s){return!!(s.length%2==0&&(s.match(/^[0-9a-f]+$/)||s.match(/^[0-9A-F]+$/)))}y.lang.String.isBase64=function(s){return s=s.replace(/\s+/g,""),!!(s.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&s.length%4==0)},y.lang.String.isBase64URL=function(s){return s.match(/[+/=]/)?!1:(s=tc(s),y.lang.String.isBase64(s))};function Vh(s){return!!s.match(/^[0-9A-Za-z-_.]+$/)}y.lang.String.isIntegerArray=function(s){return s=s.replace(/\s+/g,""),!!s.match(/^\[[0-9,]+\]$/)},y.lang.String.isPrintable=function(s){return s.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},y.lang.String.isIA5=function(s){return s.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},y.lang.String.isMail=function(s){return s.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function qh(s){return s.length%2==1?"0"+s:s.substr(0,1)>"7"?"00"+s:s}function R2(s){s=s.replace(/^\s*\[\s*/,""),s=s.replace(/\s*\]\s*$/,""),s=s.replace(/\s*/g,"");try{var c=s.split(/,/).map(function(l,d,v){var m=parseInt(l);if(m<0||255<m)throw"integer not in range 0-255";var T=("00"+m.toString(16)).slice(-2);return T}).join("");return c}catch(l){throw"malformed integer array string: "+l}}var A2=function(s,c){var l=s.length;s.length>c.length&&(l=c.length);for(var d=0;d<l;d++)if(s.charCodeAt(d)!=c.charCodeAt(d))return d;return s.length!=c.length?l:-1};function yg(s){var c=function(k){var O=k.toString(16);return O.length==1&&(O="0"+O),O},l=function(k){var O="",F=parseInt(k,10),U=F.toString(2),L=7-U.length%7;L==7&&(L=0);for(var P="",D=0;D<L;D++)P+="0";U=P+U;for(var D=0;D<U.length-1;D+=7){var A=U.substr(D,7);D!=U.length-7&&(A="1"+A),O+=c(parseInt(A,2))}return O};try{if(!s.match(/^[0-9.]+$/))return null;var d="",v=s.split("."),m=parseInt(v[0],10)*40+parseInt(v[1],10);d+=c(m),v.splice(0,2);for(var T=0;T<v.length;T++)d+=l(v[T]);return d}catch{return null}}function Wl(s){if(!vg(s))return null;try{var c=[],l=s.substr(0,2),d=parseInt(l,16);c[0]=new String(Math.floor(d/40)),c[1]=new String(d%40);for(var v=s.substr(2),m=[],T=0;T<v.length/2;T++)m.push(parseInt(v.substr(T*2,2),16));for(var k=[],O="",T=0;T<m.length;T++)m[T]&128?O=O+Gl((m[T]&127).toString(2),7):(O=O+Gl((m[T]&127).toString(2),7),k.push(new String(parseInt(O,2))),O="");var F=c.join(".");return k.length>0&&(F=F+"."+k.join(".")),F}catch{return null}}function _g(s){var c=new _(String(s),10);return rc(c)}function rc(s){var c=s.toString(16);if(c.substr(0,1)!="-")return c.length%2==1?c="0"+c:c.match(/^[0-7]/)||(c="00"+c),c;var l=c.substr(1),d=l.length;d%2==1?d+=1:c.match(/^[0-7]/)||(d+=2);for(var v="",m=0;m<d;m++)v+="f";var T=new _(v,16),k=T.xor(s).add(_.ONE);return c=k.toString(16).replace(/^-/,""),c}var Gl=function(s,c,l){return l==null&&(l="0"),s.length>=c?s:new Array(c-s.length+1).join(l)+s};function bg(s){if(s.length%2!=0||(s=s.toLowerCase(),s.match(/^[0-9a-f]+$/)==null))return-1;try{var c=s.substr(0,2);if(c=="00")return parseInt(s.substr(2),16);var l=parseInt(c,16);if(l>7)return-1;var d=s.substr(2),v=parseInt(d,16).toString(2);v=="0"&&(v="00000000"),v=v.slice(0,0-l);var m=parseInt(v,2);return m==NaN?-1:m}catch{return-1}}function Sg(s){if(typeof s!="number"||s<0)return null;var c=Number(s).toString(2),l=8-c.length%8;l==8&&(l=0),c=c+Gl("",l,"0");var d=parseInt(c,2).toString(16);d.length%2==1&&(d="0"+d);var v="0"+l;return v+d}function wg(s){if(typeof s!="string"||s.length%2!=0||!s.match(/^[0-9a-f]+$/))return null;try{var c=parseInt(s.substr(0,2),16);if(c<0||7<c)return null;for(var l=s.substr(2),d="",v=0;v<l.length;v+=2){var m=l.substr(v,2),T=parseInt(m,16).toString(2);T=("0000000"+T).slice(-8),d+=T}return d.substr(0,d.length-c)}catch{return null}}function I2(s){if(typeof s!="string"||s.match(/^[01]+$/)==null)return null;try{var c=parseInt(s,2);return Sg(c)}catch{return null}}function Jl(s,c){for(var l=0,d=0;d<s.length;d++)l|=1<<c[s[d]];for(var v=l.toString(2),m="",d=v.length-1;d>=0;d--)m+=v[d];return m}function en(s,d,l){if(typeof s=="object"){for(var d=String(d).split("."),v=0;v<d.length&&s;v++){var m=d[v];m.match(/^[0-9]+$/)&&(m=parseInt(m)),s=s[m]}return s||s===!1?s:l}}function Ie(s,c){var l=function(){};l.prototype=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.superclass=c.prototype,c.prototype.constructor==Object.prototype.constructor&&(c.prototype.constructor=c)}(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:a.algo.MD5,sha1:a.algo.SHA1,sha224:a.algo.SHA224,sha256:a.algo.SHA256,sha384:a.algo.SHA384,sha512:a.algo.SHA512,ripemd160:a.algo.RIPEMD160},this.getDigestInfoHex=function(s,c){if(typeof this.DIGESTINFOHEAD[c]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+c;return this.DIGESTINFOHEAD[c]+s},this.getPaddedDigestInfoHex=function(s,c,l){var d=this.getDigestInfoHex(s,c),v=l/4;if(d.length+22>v)throw"key is too short for SigAlg: keylen="+l+","+c;for(var m="0001",T="00"+d,k="",O=v-m.length-T.length,F=0;F<O;F+=2)k+="ff";var U=m+k+T;return U},this.hashString=function(s,c){var l=new y.crypto.MessageDigest({alg:c});return l.digestString(s)},this.hashHex=function(s,c){var l=new y.crypto.MessageDigest({alg:c});return l.digestHex(s)},this.sha1=function(s){return this.hashString(s,"sha1")},this.sha256=function(s){return this.hashString(s,"sha256")},this.sha256Hex=function(s){return this.hashHex(s,"sha256")},this.sha512=function(s){return this.hashString(s,"sha512")},this.sha512Hex=function(s){return this.hashHex(s,"sha512")},this.isKey=function(s){return s instanceof xe||s instanceof y.crypto.DSA||s instanceof y.crypto.ECDSA}},y.crypto.Util.md5=function(s){var c=new y.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return c.digestString(s)},y.crypto.Util.ripemd160=function(s){var c=new y.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return c.digestString(s)},y.crypto.Util.SECURERANDOMGEN=new oe,y.crypto.Util.getRandomHexOfNbytes=function(s){var c=new Array(s);return y.crypto.Util.SECURERANDOMGEN.nextBytes(c),Ul(c)},y.crypto.Util.getRandomBigIntegerOfNbytes=function(s){return new _(y.crypto.Util.getRandomHexOfNbytes(s),16)},y.crypto.Util.getRandomHexOfNbits=function(s){var c=s%8,l=(s-c)/8,d=new Array(l+1);return y.crypto.Util.SECURERANDOMGEN.nextBytes(d),d[0]=(255<<c&255^255)&d[0],Ul(d)},y.crypto.Util.getRandomBigIntegerOfNbits=function(s){return new _(y.crypto.Util.getRandomHexOfNbits(s),16)},y.crypto.Util.getRandomBigIntegerZeroToMax=function(s){for(var c=s.bitLength();;){var l=y.crypto.Util.getRandomBigIntegerOfNbits(c);if(s.compareTo(l)!=-1)return l}},y.crypto.Util.getRandomBigIntegerMinToMax=function(s,c){var l=s.compareTo(c);if(l==1)throw"biMin is greater than biMax";if(l==0)return s;var d=c.subtract(s),v=y.crypto.Util.getRandomBigIntegerZeroToMax(d);return v.add(s)},y.crypto.MessageDigest=function(s){this.setAlgAndProvider=function(c,l){if(c=y.crypto.MessageDigest.getCanonicalAlgName(c),c!==null&&l===void 0&&(l=y.crypto.Util.DEFAULTPROVIDER[c]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)!=-1&&l=="cryptojs"){try{this.md=y.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c].create()}catch(d){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+d}this.updateString=function(d){this.md.update(d)},this.updateHex=function(d){var v=a.enc.Hex.parse(d);this.md.update(v)},this.digest=function(){var d=this.md.finalize();return d.toString(a.enc.Hex)},this.digestString=function(d){return this.updateString(d),this.digest()},this.digestHex=function(d){return this.updateHex(d),this.digest()}}if(":sha256:".indexOf(c)!=-1&&l=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(d){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+d}this.updateString=function(d){this.md.update(d)},this.updateHex=function(d){var v=sjcl.codec.hex.toBits(d);this.md.update(v)},this.digest=function(){var d=this.md.finalize();return sjcl.codec.hex.fromBits(d)},this.digestString=function(d){return this.updateString(d),this.digest()},this.digestHex=function(d){return this.updateHex(d),this.digest()}}},this.updateString=function(c){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(c){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(c){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},s!==void 0&&s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0&&(this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},y.crypto.MessageDigest.getCanonicalAlgName=function(s){return typeof s=="string"&&(s=s.toLowerCase(),s=s.replace(/-/,"")),s},y.crypto.MessageDigest.getHashLength=function(s){var c=y.crypto.MessageDigest,l=c.getCanonicalAlgName(s);if(c.HASHLENGTH[l]===void 0)throw"not supported algorithm: "+s;return c.HASHLENGTH[l]},y.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},y.crypto.Mac=function(s){this.setAlgAndProvider=function(c,l){if(c=c.toLowerCase(),c==null&&(c="hmacsha1"),c=c.toLowerCase(),c.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+c;l===void 0&&(l=y.crypto.Util.DEFAULTPROVIDER[c]),this.algProv=c+"/"+l;var d=c.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(d)!=-1&&l=="cryptojs"){try{var v=y.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[d];this.mac=a.algo.HMAC.create(v,this.pass)}catch(m){throw"setAlgAndProvider hash alg set fail hashAlg="+d+"/"+m}this.updateString=function(m){this.mac.update(m)},this.updateHex=function(m){var T=a.enc.Hex.parse(m);this.mac.update(T)},this.doFinal=function(){var m=this.mac.finalize();return m.toString(a.enc.Hex)},this.doFinalString=function(m){return this.updateString(m),this.doFinal()},this.doFinalHex=function(m){return this.updateHex(m),this.doFinal()}}},this.updateString=function(c){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(c){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(c){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(c){if(typeof c=="string"){var l=c;(c.length%2==1||!c.match(/^[0-9A-Fa-f]+$/))&&(l=Vi(c)),this.pass=a.enc.Hex.parse(l);return}if(typeof c!="object")throw"KJUR.crypto.Mac unsupported password type: "+c;var l=null;if(c.hex!==void 0){if(c.hex.length%2!=0||!c.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+c.hex;l=c.hex}if(c.utf8!==void 0&&(l=Hl(c.utf8)),c.rstr!==void 0&&(l=Vi(c.rstr)),c.b64!==void 0&&(l=h(c.b64)),c.b64u!==void 0&&(l=on(c.b64u)),l==null)throw"KJUR.crypto.Mac unsupported password type: "+c;this.pass=a.enc.Hex.parse(l)},s!==void 0&&(s.pass!==void 0&&this.setPassword(s.pass),s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0&&(this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},y.crypto.Signature=function(s){var c=null;if(this._setAlgNames=function(){var l=this.algName.match(/^(.+)with(.+)$/);l&&(this.mdAlgName=l[1].toLowerCase(),this.pubkeyAlgName=l[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(l,d){for(var v="",m=d/4-l.length,T=0;T<m;T++)v=v+"0";return v+l},this.setAlgAndProvider=function(l,d){if(this._setAlgNames(),d!="cryptojs/jsrsa")throw new Error("provider not supported: "+d);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new y.crypto.MessageDigest({alg:this.mdAlgName})}catch(v){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+v)}this.init=function(v,m){var T=null;try{m===void 0?T=Ot.getKey(v):T=Ot.getKey(v,m)}catch(k){throw"init failed:"+k}if(T.isPrivate===!0)this.prvKey=T,this.state="SIGN";else if(T.isPublic===!0)this.pubKey=T,this.state="VERIFY";else throw"init failed.:"+T},this.updateString=function(v){this.md.updateString(v)},this.updateHex=function(v){this.md.updateHex(v)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&y.crypto.ECDSA!==void 0&&(this.prvKey=new y.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof xe&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof xe&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof y.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof y.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(v){return this.updateString(v),this.sign()},this.signHex=function(v){return this.updateHex(v),this.sign()},this.verify=function(v){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&y.crypto.ECDSA!==void 0&&(this.pubKey=new y.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof xe&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,v,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof xe&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,v);if(y.crypto.ECDSA!==void 0&&this.pubKey instanceof y.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,v);if(y.crypto.DSA!==void 0&&this.pubKey instanceof y.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,v);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(l,d){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(l){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(l){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(l){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(l){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(l){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=s,s!==void 0&&(s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0?this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=s.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),s.psssaltlen!==void 0&&(this.pssSaltLen=s.psssaltlen),s.prvkeypem!==void 0)){if(s.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var c=Ot.getKey(s.prvkeypem);this.init(c)}catch(l){throw"fatal error to load pem private key: "+l}}},y.crypto.Cipher=function(s){},y.crypto.Cipher.encrypt=function(s,c,l,d){if(en(d,"enclag")!=null&&(l=d.encalg),typeof l=="string"&&l.substr(-4)=="-CBC"){var v=c,m=s;en(d,"key")!=null&&(v=d.key),en(d,"enc")!=null&&(hEnc=d.enc);var T=a.enc.Hex.parse(v),k=a.enc.Hex.parse(m),O=a.enc.Hex.parse(d.iv),F;if(l=="des-EDE3-CBC")F=a.TripleDES.encrypt(k,T,{iv:O});else if(l=="aes128-CBC"||l=="aes256-CBC")F=a.AES.encrypt(k,T,{iv:O});else throw new Error("unsupported algorithm: "+l);return F+""}else throw new Error("Cipher.encrypt: unsupported key or algorithm")},y.crypto.Cipher.decrypt=function(s,c,l,d){if(en(d,"enclag")!=null&&(l=d.encalg),typeof l=="string"&&l.substr(-4)=="-CBC"){var v=c,m=s;en(d,"key")!=null&&(v=d.key),en(d,"enc")!=null&&(m=d.enc);var T=a.enc.Hex.parse(v),k=a.enc.Hex.parse(m),O=a.enc.Hex.parse(d.iv),F;if(l=="des-EDE3-CBC")F=a.TripleDES.decrypt({ciphertext:k},T,{iv:O});else if(l=="aes128-CBC"||l=="aes256-CBC")F=a.AES.decrypt({ciphertext:k},T,{iv:O});else throw new Error("unsupported algorithm: "+l);return a.enc.Hex.stringify(F)}else throw new Error("Cipher.decrypt: unsupported key or algorithm")},y.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.ECDSA=function(s){var c="secp256r1",l=Error,d=_,v=lt,m=y.crypto.ECDSA,T=y.crypto.ECParameterDB,k=m.getName,O=Be,F=O.getVbyListEx,U=O.isASN1HEX,L=new oe;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(P){return new d(P.bitLength(),L).mod(P.subtract(d.ONE)).add(d.ONE)},this.setNamedCurve=function(P){this.ecparams=T.getByName(P),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=P},this.setPrivateKeyHex=function(P){this.isPrivate=!0,this.prvKeyHex=P},this.setPublicKeyHex=function(P){this.isPublic=!0,this.pubKeyHex=P},this.getPublicKeyXYHex=function(){var P=this.pubKeyHex;if(P.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var D=this.ecparams.keycharlen;if(P.length!==2+D*2)throw"malformed public key hex length";var A={};return A.x=P.substr(2,D),A.y=P.substr(2+D),A},this.getShortNISTPCurveName=function(){var P=this.curveName;return P==="secp256r1"||P==="NIST P-256"||P==="P-256"||P==="prime256v1"?"P-256":P==="secp384r1"||P==="NIST P-384"||P==="P-384"?"P-384":P==="secp521r1"||P==="NIST P-521"||P==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var P=this.ecparams.n,D=this.getBigRandom(P),A=this.ecparams.keycharlen,N=("0000000000"+D.toString(16)).slice(-A);this.setPrivateKeyHex(N);var j=this.generatePublicKeyHex();return{ecprvhex:N,ecpubhex:j}},this.generatePublicKeyHex=function(){var P=new d(this.prvKeyHex,16),D=this.ecparams.G.multiply(P),A=D.getX().toBigInteger(),N=D.getY().toBigInteger(),j=this.ecparams.keycharlen,W=("0000000000"+A.toString(16)).slice(-j),se=("0000000000"+N.toString(16)).slice(-j),de="04"+W+se;return this.setPublicKeyHex(de),de},this.signWithMessageHash=function(P){return this.signHex(P,this.prvKeyHex)},this.signHex=function(P,D){var A=new d(D,16),N=this.ecparams.n,j=new d(P.substring(0,this.ecparams.keycharlen),16);do var W=this.getBigRandom(N),se=this.ecparams.G,de=se.multiply(W),ue=de.getX().toBigInteger().mod(N);while(ue.compareTo(d.ZERO)<=0);var pe=W.modInverse(N).multiply(j.add(A.multiply(ue))).mod(N);return m.biRSSigToASN1Sig(ue,pe)},this.sign=function(P,D){var A=D,N=this.ecparams.n,j=d.fromByteArrayUnsigned(P);do var W=this.getBigRandom(N),se=this.ecparams.G,de=se.multiply(W),ue=de.getX().toBigInteger().mod(N);while(ue.compareTo(_.ZERO)<=0);var pe=W.modInverse(N).multiply(j.add(A.multiply(ue))).mod(N);return this.serializeSig(ue,pe)},this.verifyWithMessageHash=function(P,D){return this.verifyHex(P,D,this.pubKeyHex)},this.verifyHex=function(P,D,A){try{var N,j,W=m.parseSigHex(D);N=W.r,j=W.s;var se=v.decodeFromHex(this.ecparams.curve,A),de=new d(P.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(de,N,j,se)}catch{return!1}},this.verify=function(P,D,A){var N,j;if(Bitcoin.Util.isArray(D)){var W=this.parseSig(D);N=W.r,j=W.s}else if(typeof D=="object"&&D.r&&D.s)N=D.r,j=D.s;else throw"Invalid value for signature";var se;if(A instanceof lt)se=A;else if(Bitcoin.Util.isArray(A))se=v.decodeFrom(this.ecparams.curve,A);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var de=d.fromByteArrayUnsigned(P);return this.verifyRaw(de,N,j,se)},this.verifyRaw=function(P,D,A,N){var j=this.ecparams.n,W=this.ecparams.G;if(D.compareTo(d.ONE)<0||D.compareTo(j)>=0||A.compareTo(d.ONE)<0||A.compareTo(j)>=0)return!1;var se=A.modInverse(j),de=P.multiply(se).mod(j),ue=D.multiply(se).mod(j),pe=W.multiply(de).add(N.multiply(ue)),G=pe.getX().toBigInteger().mod(j);return G.equals(D)},this.serializeSig=function(P,D){var A=P.toByteArraySigned(),N=D.toByteArraySigned(),j=[];return j.push(2),j.push(A.length),j=j.concat(A),j.push(2),j.push(N.length),j=j.concat(N),j.unshift(j.length),j.unshift(48),j},this.parseSig=function(P){var D;if(P[0]!=48)throw new Error("Signature not a valid DERSequence");if(D=2,P[D]!=2)throw new Error("First element in signature must be a DERInteger");var A=P.slice(D+2,D+2+P[D+1]);if(D+=2+P[D+1],P[D]!=2)throw new Error("Second element in signature must be a DERInteger");var N=P.slice(D+2,D+2+P[D+1]);D+=2+P[D+1];var j=d.fromByteArrayUnsigned(A),W=d.fromByteArrayUnsigned(N);return{r:j,s:W}},this.parseSigCompact=function(P){if(P.length!==65)throw"Signature has the wrong length";var D=P[0]-27;if(D<0||D>7)throw"Invalid signature type";var A=this.ecparams.n,N=d.fromByteArrayUnsigned(P.slice(1,33)).mod(A),j=d.fromByteArrayUnsigned(P.slice(33,65)).mod(A);return{r:N,s:j,i:D}},this.readPKCS5PrvKeyHex=function(P){if(U(P)===!1)throw new Error("not ASN.1 hex string");var D,A,N;try{D=F(P,0,["[0]",0],"06"),A=F(P,0,[1],"04");try{N=F(P,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=k(D),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(N),this.setPrivateKeyHex(A),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(P){if(U(P)===!1)throw new l("not ASN.1 hex string");var D,A,N,j;try{D=F(P,0,[1,0],"06"),A=F(P,0,[1,1],"06"),N=F(P,0,[2,0,1],"04");try{j=F(P,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new l("malformed PKCS#8 plain ECC private key")}if(this.curveName=k(A),this.curveName===void 0)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(j),this.setPrivateKeyHex(N),this.isPublic=!1},this.readPKCS8PubKeyHex=function(P){if(U(P)===!1)throw new l("not ASN.1 hex string");var D,A,N;try{D=F(P,0,[0,0],"06"),A=F(P,0,[0,1],"06"),N=F(P,0,[1],"03")}catch{throw new l("malformed PKCS#8 ECC public key")}if(this.curveName=k(A),this.curveName===null)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(N)},this.readCertPubKeyHex=function(P,D){if(U(P)===!1)throw new l("not ASN.1 hex string");var A,N;try{A=F(P,0,[0,5,0,1],"06"),N=F(P,0,[0,5,1],"03")}catch{throw new l("malformed X.509 certificate ECC public key")}if(this.curveName=k(A),this.curveName===null)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(N)},s!==void 0&&s.curve!==void 0&&(this.curveName=s.curve),this.curveName===void 0&&(this.curveName=c),this.setNamedCurve(this.curveName),s!==void 0&&(s.prv!==void 0&&this.setPrivateKeyHex(s.prv),s.pub!==void 0&&this.setPublicKeyHex(s.pub))},y.crypto.ECDSA.parseSigHex=function(s){var c=y.crypto.ECDSA.parseSigHexInHexRS(s),l=new _(c.r,16),d=new _(c.s,16);return{r:l,s:d}},y.crypto.ECDSA.parseSigHexInHexRS=function(s){var c=Be,l=c.getChildIdx,d=c.getV;if(c.checkStrictDER(s,0),s.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var v=l(s,0);if(v.length!=2)throw new Error("signature shall have two elements");var m=v[0],T=v[1];if(s.substr(m,2)!="02")throw new Error("1st item not ASN.1 integer");if(s.substr(T,2)!="02")throw new Error("2nd item not ASN.1 integer");var k=d(s,m),O=d(s,T);return{r:k,s:O}},y.crypto.ECDSA.asn1SigToConcatSig=function(s){var c=y.crypto.ECDSA.parseSigHexInHexRS(s),l=c.r,d=c.s;if(l.length>=130&&l.length<=134){if(l.length%2!=0)throw Error("unknown ECDSA sig r length error");if(d.length%2!=0)throw Error("unknown ECDSA sig s length error");l.substr(0,2)=="00"&&(l=l.substr(2)),d.substr(0,2)=="00"&&(d=d.substr(2));var v=Math.max(l.length,d.length);return l=("000000"+l).slice(-v),d=("000000"+d).slice(-v),l+d}if(l.substr(0,2)=="00"&&l.length%32==2&&(l=l.substr(2)),d.substr(0,2)=="00"&&d.length%32==2&&(d=d.substr(2)),l.length%32==30&&(l="00"+l),d.length%32==30&&(d="00"+d),l.length%32!=0)throw Error("unknown ECDSA sig r length error");if(d.length%32!=0)throw Error("unknown ECDSA sig s length error");return l+d},y.crypto.ECDSA.concatSigToASN1Sig=function(s){if(s.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var c=s.substr(0,s.length/2),l=s.substr(s.length/2);return y.crypto.ECDSA.hexRSSigToASN1Sig(c,l)},y.crypto.ECDSA.hexRSSigToASN1Sig=function(s,c){var l=new _(s,16),d=new _(c,16);return y.crypto.ECDSA.biRSSigToASN1Sig(l,d)},y.crypto.ECDSA.biRSSigToASN1Sig=function(s,c){var l=y.asn1,d=new l.DERInteger({bigint:s}),v=new l.DERInteger({bigint:c}),m=new l.DERSequence({array:[d,v]});return m.tohex()},y.crypto.ECDSA.getName=function(s){return s==="2b8104001f"?"secp192k1":s==="2a8648ce3d030107"?"secp256r1":s==="2b8104000a"?"secp256k1":s==="2b81040021"?"secp224r1":s==="2b81040022"?"secp384r1":s==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(s)!==-1?"secp256r1":"|secp256k1|".indexOf(s)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(s)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(s)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(s)!==-1?"secp521r1":null},(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.ECParameterDB=new function(){var s={},c={};function l(d){return new _(d,16)}this.getByName=function(d){var v=d;if(typeof c[v]<"u"&&(v=c[d]),typeof s[v]<"u")return s[v];throw"unregistered EC curve name: "+v},this.regist=function(d,v,m,T,k,O,F,U,L,P,D,A){s[d]={};var N=l(m),j=l(T),W=l(k),se=l(O),de=l(F),ue=new ss(N,j,W),pe=ue.decodePointHex("04"+U+L);s[d].name=d,s[d].keylen=v,s[d].keycharlen=Math.ceil(v/8)*2,s[d].curve=ue,s[d].G=pe,s[d].n=se,s[d].h=de,s[d].oid=D,s[d].info=A;for(var G=0;G<P.length;G++)c[P[G]]=d}},y.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),y.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),y.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),y.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),y.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),y.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),y.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),y.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),y.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),y.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.DSA=function(){var s=Be;s.getVbyList;var c=s.getVbyListEx,l=s.isASN1HEX,d=_;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(v,m,T,k,O){this.isPrivate=!0,this.p=v,this.q=m,this.g=T,this.y=k,this.x=O},this.setPrivateHex=function(v,m,T,k,O){var F,U,L,P,D;F=new _(v,16),U=new _(m,16),L=new _(T,16),typeof k=="string"&&k.length>1?P=new _(k,16):P=null,D=new _(O,16),this.setPrivate(F,U,L,P,D)},this.setPublic=function(v,m,T,k){this.isPublic=!0,this.p=v,this.q=m,this.g=T,this.y=k,this.x=null},this.setPublicHex=function(v,m,T,k){var O,F,U,L;O=new _(v,16),F=new _(m,16),U=new _(T,16),L=new _(k,16),this.setPublic(O,F,U,L)},this.signWithMessageHash=function(v){var m=this.p,T=this.q,k=this.g;this.y;var O=this.x,F=y.crypto.Util.getRandomBigIntegerMinToMax(_.ONE.add(_.ONE),T.subtract(_.ONE)),U=v.substr(0,T.bitLength()/4),L=new _(U,16),P=k.modPow(F,m).mod(T),D=F.modInverse(T).multiply(L.add(O.multiply(P))).mod(T),A=y.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:P}},{int:{bigint:D}}]});return A},this.verifyWithMessageHash=function(v,m){var T=this.p,k=this.q,O=this.g,F=this.y,U=this.parseASN1Signature(m),L=U[0],P=U[1],D=v.substr(0,k.bitLength()/4),A=new _(D,16);if(_.ZERO.compareTo(L)>0||L.compareTo(k)>0||_.ZERO.compareTo(P)>=0||P.compareTo(k)>0)throw"invalid DSA signature";var N=P.modInverse(k),j=A.multiply(N).mod(k),W=L.multiply(N).mod(k),se=O.modPow(j,T).multiply(F.modPow(W,T)).mod(T).mod(k);return se.compareTo(L)==0},this.parseASN1Signature=function(v){try{var m=new d(c(v,0,[0],"02"),16),T=new d(c(v,0,[1],"02"),16);return[m,T]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(v){var m,T,k,O,F;if(l(v)===!1)throw new Error("not ASN.1 hex string");try{m=c(v,0,[1],"02"),T=c(v,0,[2],"02"),k=c(v,0,[3],"02"),O=c(v,0,[4],"02"),F=c(v,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(m,T,k,O,F)},this.readPKCS8PrvKeyHex=function(v){var m,T,k,O;if(l(v)===!1)throw new Error("not ASN.1 hex string");try{m=c(v,0,[1,1,0],"02"),T=c(v,0,[1,1,1],"02"),k=c(v,0,[1,1,2],"02"),O=c(v,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(m,T,k,null,O)},this.readPKCS8PubKeyHex=function(v){var m,T,k,O;if(l(v)===!1)throw new Error("not ASN.1 hex string");try{m=c(v,0,[0,1,0],"02"),T=c(v,0,[0,1,1],"02"),k=c(v,0,[0,1,2],"02"),O=c(v,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(m,T,k,O)},this.readCertPubKeyHex=function(v,m){var T,k,O,F;if(l(v)===!1)throw new Error("not ASN.1 hex string");try{T=c(v,0,[0,5,0,1,0],"02"),k=c(v,0,[0,5,0,1,1],"02"),O=c(v,0,[0,5,0,1,2],"02"),F=c(v,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(T,k,O,F)}};var Ot=function(){var s=function(A,N,j){return d(a.AES,A,N,j)},c=function(A,N,j){return d(a.TripleDES,A,N,j)},l=function(A,N,j){return d(a.DES,A,N,j)},d=function(A,N,j,W){var se=a.enc.Hex.parse(N),de=a.enc.Hex.parse(j),ue=a.enc.Hex.parse(W),pe={};pe.key=de,pe.iv=ue,pe.ciphertext=se;var G=A.decrypt(pe,de,{iv:ue});return a.enc.Hex.stringify(G)},v=function(A,N,j){return k(a.AES,A,N,j)},m=function(A,N,j){return k(a.TripleDES,A,N,j)},T=function(A,N,j){return k(a.DES,A,N,j)},k=function(A,N,j,W){var se=a.enc.Hex.parse(N),de=a.enc.Hex.parse(j),ue=a.enc.Hex.parse(W),pe=A.encrypt(se,de,{iv:ue}),G=a.enc.Hex.parse(pe.toString()),X=a.enc.Base64.stringify(G);return X},O={"AES-256-CBC":{proc:s,eproc:v,keylen:32,ivlen:16},"AES-192-CBC":{proc:s,eproc:v,keylen:24,ivlen:16},"AES-128-CBC":{proc:s,eproc:v,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:c,eproc:m,keylen:24,ivlen:8},"DES-CBC":{proc:l,eproc:T,keylen:8,ivlen:8}},F=function(A){var N=a.lib.WordArray.random(A),j=a.enc.Hex.stringify(N);return j},U=function(A){var N={},j=A.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));j&&(N.cipher=j[1],N.ivsalt=j[2]);var W=A.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));W&&(N.type=W[1]);var se=-1,de=0;A.indexOf(`\r
\r
`)!=-1&&(se=A.indexOf(`\r
\r
`),de=2),A.indexOf(`

`)!=-1&&(se=A.indexOf(`

`),de=1);var ue=A.indexOf("-----END");if(se!=-1&&ue!=-1){var pe=A.substring(se+de*2,ue-de);pe=pe.replace(/\s+/g,""),N.data=pe}return N},L=function(A,N,j){for(var W=j.substring(0,16),se=a.enc.Hex.parse(W),de=a.enc.Utf8.parse(N),ue=O[A].keylen+O[A].ivlen,pe="",G=null;;){var X=a.algo.MD5.create();if(G!=null&&X.update(G),X.update(de),X.update(se),G=X.finalize(),pe=pe+a.enc.Hex.stringify(G),pe.length>=ue*2)break}var te={};return te.keyhex=pe.substr(0,O[A].keylen*2),te.ivhex=pe.substr(O[A].keylen*2,O[A].ivlen*2),te},P=function(A,N,j,W){var se=a.enc.Base64.parse(A),de=a.enc.Hex.stringify(se),ue=O[N].proc,pe=ue(de,j,W);return pe},D=function(A,N,j,W){var se=O[N].eproc,de=se(A,j,W);return de};return{version:"1.0.0",parsePKCS5PEM:function(A){return U(A)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(A,N,j){return L(A,N,j)},decryptKeyB64:function(A,N,j,W){return P(A,N,j,W)},getDecryptedKeyHex:function(A,N){var j=U(A),W=j.cipher,se=j.ivsalt,de=j.data,ue=L(W,N,se),pe=ue.keyhex,G=P(de,W,pe,se);return G},getEncryptedPKCS5PEMFromPrvKeyHex:function(A,N,j,W,se){var J="";if((typeof W>"u"||W==null)&&(W="AES-256-CBC"),typeof O[W]>"u")throw new Error("KEYUTIL unsupported algorithm: "+W);if(typeof se>"u"||se==null){var de=O[W].ivlen,ue=F(de);se=ue.toUpperCase()}var pe=L(W,j,se),G=pe.keyhex,X=D(N,W,G,se),te=X.replace(/(.{64})/g,`$1\r
`),J="-----BEGIN "+A+` PRIVATE KEY-----\r
`;return J+=`Proc-Type: 4,ENCRYPTED\r
`,J+="DEK-Info: "+W+","+se+`\r
`,J+=`\r
`,J+=te,J+=`\r
-----END `+A+` PRIVATE KEY-----\r
`,J},getEncryptedPKCS8PEM:function(A,N,j){var W=this.getEncryptedPKCS8Hex(A,N,j);return or(W,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(A,N,j){var W;j==null||j==null?W={}:W=JSON.parse(JSON.stringify(j)),W.plain=A,this.initPBES2Param(W),this.encryptPBES2Param(W,N);var se=this.generatePBES2ASN1Param(W);return y.asn1.ASN1Util.newObject(se).tohex()},initPBES2Param:function(A){if(en(A,"encalg")==null&&(A.encalg="aes256-CBC"),en(A,"iter")==null&&(A.iter=2048),en(A,"prf")==null&&(A.prf="hmacWithSHA256"),en(A,"salt")==null&&(A.salt=a.enc.Hex.stringify(a.lib.WordArray.random(8))),en(A,"enciv")==null){var N;A.encalg=="des-EDE3-CBC"&&(N=8),A.encalg=="aes128-CBC"&&(N=16),A.encalg=="aes256-CBC"&&(N=16),A.enciv=a.enc.Hex.stringify(a.lib.WordArray.random(N))}},encryptPBES2Param:function(A,N){var j=Ot.getDKFromPBES2Param(A,N);try{var W=y.crypto.Cipher.encrypt(A.plain,j,A.encalg,{iv:A.enciv})}catch{throw new Error("encrypt error: "+A.plain+" "+j+" "+A.encalg+" "+A.enciv)}A.enc=W},generatePBES2ASN1Param:function(A){var N={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:A.salt}},{int:{hex:_g(A.iter)}}]}]},{seq:[{oid:A.encalg},{octstr:{hex:A.enciv}}]}]}]},{octstr:{hex:A.enc}}]};return A.prf!="hmacWithSHA1"&&N.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:A.prf},{null:""}]}),N},parseHexOfEncryptedPKCS8:function(A){var N=Be,j=N.getChildIdx,W=N.getV,se={},de=j(A,0);if(de.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+de.length);se.ciphertext=W(A,de[1]);var ue=j(A,de[0]);if(ue.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+ue.length);if(W(A,ue[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var pe=j(A,ue[1]);if(ue.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+pe.length);var G=j(A,pe[1]);if(G.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+G.length);if(W(A,G[0])!="2a864886f70d0307")throw"this only supports TripleDES";se.encryptionSchemeAlg="TripleDES",se.encryptionSchemeIV=W(A,G[1]);var X=j(A,pe[0]);if(X.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+X.length);if(W(A,X[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var te=j(A,X[1]);if(te.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+te.length);se.pbkdf2Salt=W(A,te[0]);var J=W(A,te[1]);try{se.pbkdf2Iter=parseInt(J,16)}catch{throw new Error("malformed format pbkdf2Iter: "+J)}return se},getPBKDF2KeyHexFromParam:function(A,N){var j=a.enc.Hex.parse(A.pbkdf2Salt),W=A.pbkdf2Iter,se=a.PBKDF2(N,j,{keySize:192/32,iterations:W}),de=a.enc.Hex.stringify(se);return de},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(A,N){var j=En(A,"ENCRYPTED PRIVATE KEY"),W=this.parseHexOfEncryptedPKCS8(j),se=Ot.getPBKDF2KeyHexFromParam(W,N),de={};de.ciphertext=a.enc.Hex.parse(W.ciphertext);var ue=a.enc.Hex.parse(se),pe=a.enc.Hex.parse(W.encryptionSchemeIV),G=a.TripleDES.decrypt(de,ue,{iv:pe}),X=a.enc.Hex.stringify(G);return X},parsePBES2:function(A){var N=Be.parse(A);if(en(N,"seq.0.seq.0.oid")!="pkcs5PBES2"||en(N,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var j=en(N,"seq.0.seq.1.seq.0.seq.1.seq");if(j==null)throw new Error("PBKDF2 parameter not found");var W=en(j,"0.octstr.hex"),se=en(j,"1.int.hex"),de=en(j,"2.seq.0.oid","hmacWithSHA1"),ue=-1;try{ue=parseInt(se,16)}catch{throw new Error("iter not proper value")}var pe=en(N,"seq.0.seq.1.seq.1.seq.0.oid"),G=en(N,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),X=en(N,"seq.1.octstr.hex");if(pe==null||G==null||X==null)throw new Error("encalg, enciv or enc is undefined");var te={salt:W,iter:ue,prf:de,encalg:pe,enciv:G,enc:X};return te},getDKFromPBES2Param:function(A,N){var j={hmacWithSHA1:a.algo.SHA1,hmacWithSHA224:a.algo.SHA224,hmacWithSHA256:a.algo.SHA256,hmacWithSHA384:a.algo.SHA384,hmacWithSHA512:a.algo.SHA512},W={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},se=j[A.prf];if(se==null)throw new Error("unsupported prf");var de=W[A.encalg];if(de==null)throw new Error("unsupported encalg");var ue=a.enc.Hex.parse(A.salt),pe=A.iter;try{var G=a.PBKDF2(N,ue,{keySize:de,iterations:pe,hasher:se});return a.enc.Hex.stringify(G)}catch(X){throw new Error("PBKDF2 error: "+X+" "+JSON.stringify(A)+" "+N)}},getPlainHexFromEncryptedPKCS8PEM:function(A,N){if(A.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var j=En(A),W;try{W=Ot.parsePBES2(j)}catch(de){throw new Error("malformed PBES2 format: "+de.message)}var se=Ot.getDKFromPBES2Param(W,N);return y.crypto.Cipher.decrypt(W.enc,se,W.encalg,{iv:W.enciv})},getKeyFromEncryptedPKCS8PEM:function(A,N){var j=this.getPlainHexFromEncryptedPKCS8PEM(A,N),W=this.getKeyFromPlainPrivatePKCS8Hex(j);return W},parsePlainPrivatePKCS8Hex:function(A){var N=Be,j=N.getChildIdx,W=N.getV,se={};if(se.algparam=null,A.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var de=j(A,0);if(de.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(A.substr(de[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var ue=j(A,de[1]);if(ue.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(A.substr(ue[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(se.algoid=W(A,ue[0]),A.substr(ue[1],2)=="06"&&(se.algparam=W(A,ue[1])),A.substr(de[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return se.keyidx=N.getVidx(A,de[2]),se},getKeyFromPlainPrivatePKCS8PEM:function(A){var N=En(A,"PRIVATE KEY"),j=this.getKeyFromPlainPrivatePKCS8Hex(N);return j},getKeyFromPlainPrivatePKCS8Hex:function(A){var N=this.parsePlainPrivatePKCS8Hex(A),j;if(N.algoid=="2a864886f70d010101")j=new xe;else if(N.algoid=="2a8648ce380401")j=new y.crypto.DSA;else if(N.algoid=="2a8648ce3d0201")j=new y.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return j.readPKCS8PrvKeyHex(A),j},_getKeyFromPublicPKCS8Hex:function(A){var N,j=Be.getVbyList(A,0,[0,0],"06");if(j==="2a864886f70d010101")N=new xe;else if(j==="2a8648ce380401")N=new y.crypto.DSA;else if(j==="2a8648ce3d0201")N=new y.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return N.readPKCS8PubKeyHex(A),N},parsePublicRawRSAKeyHex:function(A){var N=Be,j=N.getChildIdx,W=N.getV,se={};if(A.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var de=j(A,0);if(de.length!=2)throw new Error("malformed RSA key(code:002)");if(A.substr(de[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(se.n=W(A,de[0]),A.substr(de[1],2)!="02")throw new Error("malformed RSA key(code:004)");return se.e=W(A,de[1]),se},parsePublicPKCS8Hex:function(A){var N=Be,j=N.getChildIdx,W=N.getV,se={};se.algparam=null;var de=j(A,0);if(de.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+de.length);var ue=de[0];if(A.substr(ue,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var pe=j(A,ue);if(pe.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(A.substr(pe[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(se.algoid=W(A,pe[0]),A.substr(pe[1],2)=="06"?se.algparam=W(A,pe[1]):A.substr(pe[1],2)=="30"&&(se.algparam={},se.algparam.p=N.getVbyList(A,pe[1],[0],"02"),se.algparam.q=N.getVbyList(A,pe[1],[1],"02"),se.algparam.g=N.getVbyList(A,pe[1],[2],"02")),A.substr(de[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return se.key=W(A,de[1]).substr(2),se}}}();Ot.getKey=function(s,c,l){var d=Be,v=d.getChildIdx;d.getV;var m=d.getVbyList,T=y.crypto,k=T.ECDSA,O=T.DSA,F=xe,U=En,L=Ot;if(typeof F<"u"&&s instanceof F||typeof k<"u"&&s instanceof k||typeof O<"u"&&s instanceof O)return s;if(s.curve!==void 0&&s.xy!==void 0&&s.d===void 0)return new k({pub:s.xy,curve:s.curve});if(s.curve!==void 0&&s.d!==void 0)return new k({prv:s.d,curve:s.curve});if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d===void 0){var P=new F;return P.setPublic(s.n,s.e),P}if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p!==void 0&&s.q!==void 0&&s.dp!==void 0&&s.dq!==void 0&&s.co!==void 0&&s.qi===void 0){var P=new F;return P.setPrivateEx(s.n,s.e,s.d,s.p,s.q,s.dp,s.dq,s.co),P}if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p===void 0){var P=new F;return P.setPrivate(s.n,s.e,s.d),P}if(s.p!==void 0&&s.q!==void 0&&s.g!==void 0&&s.y!==void 0&&s.x===void 0){var P=new O;return P.setPublic(s.p,s.q,s.g,s.y),P}if(s.p!==void 0&&s.q!==void 0&&s.g!==void 0&&s.y!==void 0&&s.x!==void 0){var P=new O;return P.setPrivate(s.p,s.q,s.g,s.y,s.x),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d===void 0){var P=new F;return P.setPublic(on(s.n),on(s.e)),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p!==void 0&&s.q!==void 0&&s.dp!==void 0&&s.dq!==void 0&&s.qi!==void 0){var P=new F;return P.setPrivateEx(on(s.n),on(s.e),on(s.d),on(s.p),on(s.q),on(s.dp),on(s.dq),on(s.qi)),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0){var P=new F;return P.setPrivate(on(s.n),on(s.e),on(s.d)),P}if(s.kty==="EC"&&s.crv!==void 0&&s.x!==void 0&&s.y!==void 0&&s.d===void 0){var D=new k({curve:s.crv}),A=D.ecparams.keycharlen,N=("0000000000"+on(s.x)).slice(-A),j=("0000000000"+on(s.y)).slice(-A),W="04"+N+j;return D.setPublicKeyHex(W),D}if(s.kty==="EC"&&s.crv!==void 0&&s.x!==void 0&&s.y!==void 0&&s.d!==void 0){var D=new k({curve:s.crv}),A=D.ecparams.keycharlen,N=("0000000000"+on(s.x)).slice(-A),j=("0000000000"+on(s.y)).slice(-A),W="04"+N+j,se=("0000000000"+on(s.d)).slice(-A);return D.setPublicKeyHex(W),D.setPrivateKeyHex(se),D}if(l==="pkcs5prv"){var de=s,d=Be,ue,P;if(ue=v(de,0),ue.length===9)P=new F,P.readPKCS5PrvKeyHex(de);else if(ue.length===6)P=new O,P.readPKCS5PrvKeyHex(de);else if(ue.length>2&&de.substr(ue[1],2)==="04")P=new k,P.readPKCS5PrvKeyHex(de);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return P}if(l==="pkcs8prv"){var P=L.getKeyFromPlainPrivatePKCS8Hex(s);return P}if(l==="pkcs8pub")return L._getKeyFromPublicPKCS8Hex(s);if(l==="x509pub")return ut.getPublicKeyFromCertHex(s);if(s.indexOf("-END CERTIFICATE-",0)!=-1||s.indexOf("-END X509 CERTIFICATE-",0)!=-1||s.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return ut.getPublicKeyFromCertPEM(s);if(s.indexOf("-END PUBLIC KEY-")!=-1){var pe=En(s,"PUBLIC KEY");return L._getKeyFromPublicPKCS8Hex(pe)}if(s.indexOf("-END RSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var G=U(s,"RSA PRIVATE KEY");return L.getKey(G,null,"pkcs5prv")}if(s.indexOf("-END DSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var X=U(s,"DSA PRIVATE KEY"),te=m(X,0,[1],"02"),J=m(X,0,[2],"02"),re=m(X,0,[3],"02"),he=m(X,0,[4],"02"),ye=m(X,0,[5],"02"),P=new O;return P.setPrivate(new _(te,16),new _(J,16),new _(re,16),new _(he,16),new _(ye,16)),P}if(s.indexOf("-END EC PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var G=U(s,"EC PRIVATE KEY");return L.getKey(G,null,"pkcs5prv")}if(s.indexOf("-END PRIVATE KEY-")!=-1)return L.getKeyFromPlainPrivatePKCS8PEM(s);if(s.indexOf("-END RSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var Fe=L.getDecryptedKeyHex(s,c),ge=new xe;return ge.readPKCS5PrvKeyHex(Fe),ge}if(s.indexOf("-END EC PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var X=L.getDecryptedKeyHex(s,c),P=m(X,0,[1],"04"),Pe=m(X,0,[2,0],"06"),Ne=m(X,0,[3,0],"03").substr(2),Me="";if(y.crypto.OID.oidhex2name[Pe]!==void 0)Me=y.crypto.OID.oidhex2name[Pe];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+Pe);var D=new k({curve:Me});return D.setPublicKeyHex(Ne),D.setPrivateKeyHex(P),D.isPublic=!1,D}if(s.indexOf("-END DSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var X=L.getDecryptedKeyHex(s,c),te=m(X,0,[1],"02"),J=m(X,0,[2],"02"),re=m(X,0,[3],"02"),he=m(X,0,[4],"02"),ye=m(X,0,[5],"02"),P=new O;return P.setPrivate(new _(te,16),new _(J,16),new _(re,16),new _(he,16),new _(ye,16)),P}if(s.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return L.getKeyFromEncryptedPKCS8PEM(s,c);throw new Error("not supported argument")},Ot.generateKeypair=function(s,c){if(s=="RSA"){var l=c,d=new xe;d.generate(l,"10001"),d.isPrivate=!0,d.isPublic=!0;var v=new xe,m=d.n.toString(16),T=d.e.toString(16);v.setPublic(m,T),v.isPrivate=!1,v.isPublic=!0;var k={};return k.prvKeyObj=d,k.pubKeyObj=v,k}else if(s=="EC"){var O=c,F=new y.crypto.ECDSA({curve:O}),U=F.generateKeyPairHex(),d=new y.crypto.ECDSA({curve:O});d.setPublicKeyHex(U.ecpubhex),d.setPrivateKeyHex(U.ecprvhex),d.isPrivate=!0,d.isPublic=!1;var v=new y.crypto.ECDSA({curve:O});v.setPublicKeyHex(U.ecpubhex),v.isPrivate=!1,v.isPublic=!0;var k={};return k.prvKeyObj=d,k.pubKeyObj=v,k}else throw new Error("unknown algorithm: "+s)},Ot.getPEM=function(s,c,l,d,v,m){var T=y,k=T.asn1,O=k.DERObjectIdentifier,F=k.DERInteger,U=k.ASN1Util.newObject,L=k.x509,P=L.SubjectPublicKeyInfo,D=T.crypto,A=D.DSA,N=D.ECDSA,j=xe;function W(Pe){var Ne=U({seq:[{int:0},{int:{bigint:Pe.n}},{int:Pe.e},{int:{bigint:Pe.d}},{int:{bigint:Pe.p}},{int:{bigint:Pe.q}},{int:{bigint:Pe.dmp1}},{int:{bigint:Pe.dmq1}},{int:{bigint:Pe.coeff}}]});return Ne}function se(Pe){var Ne=U({seq:[{int:1},{octstr:{hex:Pe.prvKeyHex}},{tag:["a0",!0,{oid:{name:Pe.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+Pe.pubKeyHex}}]}]});return Ne}function de(Pe){var Ne=U({seq:[{int:0},{int:{bigint:Pe.p}},{int:{bigint:Pe.q}},{int:{bigint:Pe.g}},{int:{bigint:Pe.y}},{int:{bigint:Pe.x}}]});return Ne}if((j!==void 0&&s instanceof j||A!==void 0&&s instanceof A||N!==void 0&&s instanceof N)&&s.isPublic==!0&&(c===void 0||c=="PKCS8PUB")){var ue=new P(s),pe=ue.tohex();return or(pe,"PUBLIC KEY")}if(c=="PKCS1PRV"&&j!==void 0&&s instanceof j&&(l===void 0||l==null)&&s.isPrivate==!0){var ue=W(s),pe=ue.tohex();return or(pe,"RSA PRIVATE KEY")}if(c=="PKCS1PRV"&&N!==void 0&&s instanceof N&&(l===void 0||l==null)&&s.isPrivate==!0){var G=new O({name:s.curveName}),X=G.tohex(),te=se(s),J=te.tohex(),re="";return re+=or(X,"EC PARAMETERS"),re+=or(J,"EC PRIVATE KEY"),re}if(c=="PKCS1PRV"&&A!==void 0&&s instanceof A&&(l===void 0||l==null)&&s.isPrivate==!0){var ue=de(s),pe=ue.tohex();return or(pe,"DSA PRIVATE KEY")}if(c=="PKCS5PRV"&&j!==void 0&&s instanceof j&&l!==void 0&&l!=null&&s.isPrivate==!0){var ue=W(s),pe=ue.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",pe,l,d,m)}if(c=="PKCS5PRV"&&N!==void 0&&s instanceof N&&l!==void 0&&l!=null&&s.isPrivate==!0){var ue=se(s),pe=ue.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",pe,l,d,m)}if(c=="PKCS5PRV"&&A!==void 0&&s instanceof A&&l!==void 0&&l!=null&&s.isPrivate==!0){var ue=de(s),pe=ue.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",pe,l,d,m)}var he=function(Pe,Ne){if(typeof Ne=="string")return Ot.getEncryptedPKCS8PEM(Pe,Ne);if(typeof Ne=="object"&&en(Ne,"passcode")!=null){var Me=JSON.parse(JSON.stringify(Ne)),cr=Me.passcode;return delete Me.passcode,Ot.getEncryptedPKCS8PEM(Pe,cr,Me)}};if(c=="PKCS8PRV"&&j!=null&&s instanceof j&&s.isPrivate==!0){var ye=W(s),Fe=ye.tohex(),ue=U({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:Fe}}]}),pe=ue.tohex();return l===void 0||l==null?or(pe,"PRIVATE KEY"):he(pe,l)}if(c=="PKCS8PRV"&&N!==void 0&&s instanceof N&&s.isPrivate==!0){var ge={seq:[{int:1},{octstr:{hex:s.prvKeyHex}}]};typeof s.pubKeyHex=="string"&&ge.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+s.pubKeyHex}}]});var ye=new U(ge),Fe=ye.tohex(),ue=U({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:s.curveName}}]},{octstr:{hex:Fe}}]}),pe=ue.tohex();return l===void 0||l==null?or(pe,"PRIVATE KEY"):he(pe,l)}if(c=="PKCS8PRV"&&A!==void 0&&s instanceof A&&s.isPrivate==!0){var ye=new F({bigint:s.x}),Fe=ye.tohex(),ue=U({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:s.p}},{int:{bigint:s.q}},{int:{bigint:s.g}}]}]},{octstr:{hex:Fe}}]}),pe=ue.tohex();return l===void 0||l==null?or(pe,"PRIVATE KEY"):he(pe,l)}throw new Error("unsupported object nor format")},Ot.getKeyFromCSRPEM=function(s){var c=En(s,"CERTIFICATE REQUEST"),l=Ot.getKeyFromCSRHex(c);return l},Ot.getKeyFromCSRHex=function(s){var c=Ot.parseCSRHex(s),l=Ot.getKey(c.p8pubkeyhex,null,"pkcs8pub");return l},Ot.parseCSRHex=function(s){var c=Be,l=c.getChildIdx,d=c.getTLV,v={},m=s;if(m.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var T=l(m,0);if(T.length<1)throw new Error("malformed CSR(code:002)");if(m.substr(T[0],2)!="30")throw new Error("malformed CSR(code:003)");var k=l(m,T[0]);if(k.length<3)throw new Error("malformed CSR(code:004)");return v.p8pubkeyhex=d(m,k[2]),v},Ot.getKeyID=function(s){var c=Ot,l=Be;typeof s=="string"&&s.indexOf("BEGIN ")!=-1&&(s=c.getKey(s));var d=En(c.getPEM(s)),v=l.getIdxbyList(d,0,[1]),m=l.getV(d,v).substring(2);return y.crypto.Util.hashHex(m,"sha1")},Ot.getJWK=function(s,c,l,d,v){var m,T={},k,O=y.crypto.Util.hashHex;if(typeof s=="string")m=Ot.getKey(s),s.indexOf("CERTIFICATE")!=-1&&(k=En(s));else if(typeof s=="object")s instanceof ut?(m=s.getPublicKey(),k=s.hex):m=s;else throw new Error("unsupported keyinfo type");if(m instanceof xe&&m.isPrivate)T.kty="RSA",T.n=jn(m.n.toString(16)),T.e=jn(m.e.toString(16)),T.d=jn(m.d.toString(16)),T.p=jn(m.p.toString(16)),T.q=jn(m.q.toString(16)),T.dp=jn(m.dmp1.toString(16)),T.dq=jn(m.dmq1.toString(16)),T.qi=jn(m.coeff.toString(16));else if(m instanceof xe&&m.isPublic)T.kty="RSA",T.n=jn(m.n.toString(16)),T.e=jn(m.e.toString(16));else if(m instanceof y.crypto.ECDSA&&m.isPrivate){var F=m.getShortNISTPCurveName();if(F!=="P-256"&&F!=="P-384"&&F!=="P-521")throw new Error("unsupported curve name for JWT: "+F);var U=m.getPublicKeyXYHex();T.kty="EC",T.crv=F,T.x=jn(U.x),T.y=jn(U.y),T.d=jn(m.prvKeyHex)}else if(m instanceof y.crypto.ECDSA&&m.isPublic){var F=m.getShortNISTPCurveName();if(F!=="P-256"&&F!=="P-384"&&F!=="P-521")throw new Error("unsupported curve name for JWT: "+F);var U=m.getPublicKeyXYHex();T.kty="EC",T.crv=F,T.x=jn(U.x),T.y=jn(U.y)}if(T.kty==null)throw new Error("unsupported keyinfo");return!m.isPrivate&&c!=!0&&(T.kid=y.jws.JWS.getJWKthumbprint(T)),k!=null&&l!=!0&&(T.x5c=[p(k)]),k!=null&&d!=!0&&(T.x5t=Xa(p(O(k,"sha1")))),k!=null&&v!=!0&&(T["x5t#S256"]=Xa(p(O(k,"sha256")))),T},Ot.getJWKFromKey=function(s){return Ot.getJWK(s,!0,!0,!0,!0)},xe.getPosArrayOfChildrenFromHex=function(s){return Be.getChildIdx(s,0)},xe.getHexValueArrayOfChildrenFromHex=function(s){var c=Be,l=c.getV,P=xe.getPosArrayOfChildrenFromHex(s),d=l(s,P[0]),v=l(s,P[1]),m=l(s,P[2]),T=l(s,P[3]),k=l(s,P[4]),O=l(s,P[5]),F=l(s,P[6]),U=l(s,P[7]),L=l(s,P[8]),P=new Array;return P.push(d,v,m,T,k,O,F,U,L),P},xe.prototype.readPrivateKeyFromPEMString=function(s){var c=En(s),l=xe.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8])},xe.prototype.readPKCS5PrvKeyHex=function(s){var c=xe.getHexValueArrayOfChildrenFromHex(s);this.setPrivateEx(c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])},xe.prototype.readPKCS8PrvKeyHex=function(s){var c,l,d,v,m,T,k,O,F=Be,U=F.getVbyListEx;if(F.isASN1HEX(s)===!1)throw new Error("not ASN.1 hex string");try{c=U(s,0,[2,0,1],"02"),l=U(s,0,[2,0,2],"02"),d=U(s,0,[2,0,3],"02"),v=U(s,0,[2,0,4],"02"),m=U(s,0,[2,0,5],"02"),T=U(s,0,[2,0,6],"02"),k=U(s,0,[2,0,7],"02"),O=U(s,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(c,l,d,v,m,T,k,O)},xe.prototype.readPKCS5PubKeyHex=function(s){var c=Be,l=c.getV;if(c.isASN1HEX(s)===!1)throw new Error("keyHex is not ASN.1 hex string");var d=c.getChildIdx(s,0);if(d.length!==2||s.substr(d[0],2)!=="02"||s.substr(d[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var v=l(s,d[0]),m=l(s,d[1]);this.setPublic(v,m)},xe.prototype.readPKCS8PubKeyHex=function(s){var c=Be;if(c.isASN1HEX(s)===!1)throw new Error("not ASN.1 hex string");if(c.getTLVbyListEx(s,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var l=c.getTLVbyListEx(s,0,[1,0]);this.readPKCS5PubKeyHex(l)},xe.prototype.readCertPubKeyHex=function(s,c){var l,d;l=new ut,l.readCertHex(s),d=l.getPublicKeyHex(),this.readPKCS8PubKeyHex(d)};function xg(s,c){for(var l="",d=c/4-s.length,v=0;v<d;v++)l=l+"0";return l+s}xe.prototype.sign=function(s,c){var l=function(v){return y.crypto.Util.hashString(v,c)},d=l(s);return this.signWithMessageHash(d,c)},xe.prototype.signWithMessageHash=function(s,c){var l=y.crypto.Util.getPaddedDigestInfoHex(s,c,this.n.bitLength()),d=be(l,16),v=this.doPrivate(d),m=v.toString(16);return xg(m,this.n.bitLength())};function Cg(s,c,l){for(var d="",v=0;d.length<c;)d+=Or(l(Vi(s+String.fromCharCode.apply(String,[(v&4278190080)>>24,(v&16711680)>>16,(v&65280)>>8,v&255])))),v+=1;return d}xe.prototype.signPSS=function(s,c,l){var d=function(m){return y.crypto.Util.hashHex(m,c)},v=d(Vi(s));return l===void 0&&(l=-1),this.signWithMessageHashPSS(v,c,l)},xe.prototype.signWithMessageHashPSS=function(s,c,l){var d=Or(s),v=d.length,m=this.n.bitLength()-1,T=Math.ceil(m/8),k,O=function(j){return y.crypto.Util.hashHex(j,c)};if(l===-1||l===void 0)l=v;else if(l===-2)l=T-v-2;else if(l<-2)throw new Error("invalid salt length");if(T<v+l+2)throw new Error("data too long");var F="";l>0&&(F=new Array(l),new oe().nextBytes(F),F=String.fromCharCode.apply(String,F));var U=Or(O(Vi("\0\0\0\0\0\0\0\0"+d+F))),L=[];for(k=0;k<T-l-v-2;k+=1)L[k]=0;var P=String.fromCharCode.apply(String,L)+""+F,D=Cg(U,P.length,O),A=[];for(k=0;k<P.length;k+=1)A[k]=P.charCodeAt(k)^D.charCodeAt(k);var N=65280>>8*T-m&255;for(A[0]&=~N,k=0;k<v;k++)A.push(U.charCodeAt(k));return A.push(188),xg(this.doPrivate(new _(A)).toString(16),this.n.bitLength())};function Eg(s){for(var c in y.crypto.Util.DIGESTINFOHEAD){var l=y.crypto.Util.DIGESTINFOHEAD[c],d=l.length;if(s.substring(0,d)==l){var v=[c,s.substring(d)];return v}}return[]}xe.prototype.verify=function(s,c){if(c=c.toLowerCase(),c.match(/^[0-9a-f]+$/)==null)return!1;var l=be(c,16),d=this.n.bitLength();if(l.bitLength()>d)return!1;var v=this.doPublic(l),m=v.toString(16);if(m.length+3!=d/4)return!1;var T=m.replace(/^1f+00/,""),k=Eg(T);if(k.length==0)return!1;var O=k[0],F=k[1],U=function(P){return y.crypto.Util.hashString(P,O)},L=U(s);return F==L},xe.prototype.verifyWithMessageHash=function(s,c){if(c.length!=Math.ceil(this.n.bitLength()/4))return!1;var l=be(c,16);if(l.bitLength()>this.n.bitLength())return 0;var d=this.doPublic(l),v=d.toString(16).replace(/^1f+00/,""),m=Eg(v);if(m.length==0)return!1;m[0];var T=m[1];return T==s},xe.prototype.verifyPSS=function(s,c,l,d){var v=function(T){return y.crypto.Util.hashHex(T,l)},m=v(Vi(s));return d===void 0&&(d=-1),this.verifyWithMessageHashPSS(m,c,l,d)},xe.prototype.verifyWithMessageHashPSS=function(s,c,l,d){if(c.length!=Math.ceil(this.n.bitLength()/4))return!1;var v=new _(c,16),m=function(se){return y.crypto.Util.hashHex(se,l)},T=Or(s),k=T.length,O=this.n.bitLength()-1,F=Math.ceil(O/8),U;if(d===-1||d===void 0)d=k;else if(d===-2)d=F-k-2;else if(d<-2)throw new Error("invalid salt length");if(F<k+d+2)throw new Error("data too long");var L=this.doPublic(v).toByteArray();for(U=0;U<L.length;U+=1)L[U]&=255;for(;L.length<F;)L.unshift(0);if(L[F-1]!==188)throw new Error("encoded message does not end in 0xbc");L=String.fromCharCode.apply(String,L);var P=L.substr(0,F-k-1),D=L.substr(P.length,k),A=65280>>8*F-O&255;if(P.charCodeAt(0)&A)throw new Error("bits beyond keysize not zero");var N=Cg(D,P.length,m),j=[];for(U=0;U<P.length;U+=1)j[U]=P.charCodeAt(U)^N.charCodeAt(U);j[0]&=~A;var W=F-k-d-2;for(U=0;U<W;U+=1)if(j[U]!==0)throw new Error("leftmost octets not zero");if(j[W]!==1)throw new Error("0x01 marker not found");return D===Or(m(Vi("\0\0\0\0\0\0\0\0"+T+String.fromCharCode.apply(String,j.slice(-d)))))},xe.SALT_LEN_HLEN=-1,xe.SALT_LEN_MAX=-2,xe.SALT_LEN_RECOVER=-2;function ut(s){var c=Be,l=c.getChildIdx,d=c.getV;c.dump;var v=c.parse,m=c.getTLV,T=c.getVbyList,k=c.getVbyListEx,O=c.getTLVbyList,F=c.getTLVbyListEx,U=c.getIdxbyList,L=c.getIdxbyListEx,P=c.getVidx,D=c.getInt,A=c.oidname,N=c.hextooidstr,j=En,W,se=Error;try{W=y.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var G=O(this.hex,0,[0,0]);if(G.substr(0,2)=="a0"){var X=O(G,0,[0]),te=D(X,0);if(te<0||2<te)throw new Error("malformed version field");return this.version=te+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return k(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var G=F(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(G)},this.getAlgorithmIdentifierName=function(G){for(var X in W)if(G===W[X])return X;return A(k(G,0,[0],"06"))},this.getIssuer=function(G,X){return this.getX500Name(this.getIssuerHex(),G,X)},this.getIssuerHex=function(){return O(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var G=this.getIssuer();return G.str},this.getSubject=function(G,X){return this.getX500Name(this.getSubjectHex(),G,X)},this.getSubjectHex=function(){return O(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var G=this.getSubject();return G.str},this.getNotBefore=function(){var G=T(this.hex,0,[0,4+this.foffset,0]);return G=G.replace(/(..)/g,"%$1"),G=decodeURIComponent(G),G},this.getNotAfter=function(){var G=T(this.hex,0,[0,4+this.foffset,1]);return G=G.replace(/(..)/g,"%$1"),G=decodeURIComponent(G),G},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return O(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var G=this.getSPKI();return G==null?null:T(G,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return U(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var G=this.getPublicKeyIdx();return U(this.hex,G,[1,0],"30")},this.getPublicKey=function(){return Ot.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var G=O(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(G)},this.getSignatureValueHex=function(){return T(this.hex,0,[2],"03",!0)},this.verifySignature=function(G){var X=this.getSignatureAlgorithmField(),te=this.getSignatureValueHex(),J=O(this.hex,0,[0],"30"),re=new y.crypto.Signature({alg:X});return re.init(G),re.updateHex(J),re.verify(te)},this.parseExt=function(G){var X,te,J;if(G===void 0){if(J=this.hex,this.version!==3)return-1;X=U(J,0,[0,7,0],"30"),te=l(J,X)}else{J=En(G);var re=U(J,0,[0,3,0,0],"06");if(d(J,re)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}X=U(J,0,[0,3,0,1,0],"30"),te=l(J,X),this.hex=J}this.aExtInfo=new Array;for(var he=0;he<te.length;he++){var ye={};ye.critical=!1;var Fe=l(J,te[he]),ge=0;Fe.length===3&&(ye.critical=!0,ge=1),ye.oid=c.hextooidstr(T(J,te[he],[0],"06"));var Pe=U(J,te[he],[1+ge]);ye.vidx=P(J,Pe),this.aExtInfo.push(ye)}},this.getExtInfo=function(G){var X=this.aExtInfo,te=G;if(G.match(/^[0-9.]+$/)||(te=y.asn1.x509.OID.name2oid(G)),te!==""){for(var J=0;J<X.length;J++)if(X[J].oid===te)return X[J]}},this.getCriticalExtV=function(G,X,te){if(X!=null)return[X,te];var J=this.getExtInfo(G);return J==null?[null,null]:[m(this.hex,J.vidx),J.critical]},this.getExtBasicConstraints=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("basicConstraints");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"basicConstraints"};if(X&&(J.critical=!0),G==="3000")return J;if(G==="30030101ff")return J.cA=!0,J;if(G.substr(0,12)==="30060101ff02"){var re=d(G,10),he=parseInt(re,16);return J.cA=!0,J.pathLen=he,J}throw new Error("hExtV parse error: "+G)},this.getExtNameConstraints=function(G,X){var te=this.getCriticalExtV("nameConstraints",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"nameConstraints"};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){for(var ye=[],Fe=l(G,re[he]),ge=0;ge<Fe.length;ge++){var Pe=m(G,Fe[ge]),Ne=this.getGeneralSubtree(Pe);ye.push(Ne)}var Me=G.substr(re[he],2);Me=="a0"?J.permit=ye:Me=="a1"&&(J.exclude=ye)}return J}},this.getGeneralSubtree=function(G){var X=l(G,0),te=X.length;if(te<1||2<te)throw new Error("wrong num elements");for(var J=this.getGeneralName(m(G,X[0])),re=1;re<te;re++){var he=G.substr(X[re],2),ye=d(G,X[re]),Fe=parseInt(ye,16);he=="80"&&(J.min=Fe),he=="81"&&(J.max=Fe)}return J},this.getExtKeyUsage=function(G,X){var te=this.getCriticalExtV("keyUsage",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"keyUsage"};return X&&(J.critical=!0),J.names=this.getExtKeyUsageString(G).split(","),J}},this.getExtKeyUsageBin=function(G){if(G===void 0){var X=this.getExtInfo("keyUsage");if(X===void 0)return"";G=m(this.hex,X.vidx)}if(G.length!=8&&G.length!=10)throw new Error("malformed key usage value: "+G);var te="000000000000000"+parseInt(G.substr(6),16).toString(2);return G.length==8&&(te=te.slice(-8)),G.length==10&&(te=te.slice(-16)),te=te.replace(/0+$/,""),te==""&&(te="0"),te},this.getExtKeyUsageString=function(G){for(var X=this.getExtKeyUsageBin(G),te=new Array,J=0;J<X.length;J++)X.substr(J,1)=="1"&&te.push(ut.KEYUSAGE_NAME[J]);return te.join(",")},this.getExtSubjectKeyIdentifier=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("subjectKeyIdentifier");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"subjectKeyIdentifier"};X&&(J.critical=!0);var re=d(G,0);return J.kid={hex:re},J},this.getExtAuthorityKeyIdentifier=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("authorityKeyIdentifier");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"authorityKeyIdentifier"};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){var ye=G.substr(re[he],2);if(ye==="80"&&(J.kid={hex:d(G,re[he])}),ye==="a1"){var Fe=m(G,re[he]),ge=this.getGeneralNames(Fe);J.issuer=ge[0].dn}ye==="82"&&(J.sn={hex:d(G,re[he])})}return J},this.getExtExtKeyUsage=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("extKeyUsage");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"extKeyUsage",array:[]};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++)J.array.push(A(d(G,re[he])));return J},this.getExtExtKeyUsageName=function(){var G=this.getExtInfo("extKeyUsage");if(G===void 0)return G;var X=new Array,te=m(this.hex,G.vidx);if(te==="")return X;for(var J=l(te,0),re=0;re<J.length;re++)X.push(A(d(te,J[re])));return X},this.getExtSubjectAltName=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("subjectAltName");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"subjectAltName",array:[]};return X&&(J.critical=!0),J.array=this.getGeneralNames(G),J},this.getExtIssuerAltName=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("issuerAltName");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"issuerAltName",array:[]};return X&&(J.critical=!0),J.array=this.getGeneralNames(G),J},this.getGeneralNames=function(G){for(var X=l(G,0),te=[],J=0;J<X.length;J++){var re=this.getGeneralName(m(G,X[J]));re!==void 0&&te.push(re)}return te},this.getGeneralName=function(G){var X=G.substr(0,2),te=d(G,0),J=Or(te);if(X=="81")return{rfc822:J};if(X=="82")return{dns:J};if(X=="86")return{uri:J};if(X=="87")return{ip:Kl(te)};if(X=="a4")return{dn:this.getX500Name(te)};if(X=="a0")return{other:this.getOtherName(G)}},this.getExtSubjectAltName2=function(){var G,X,te,J=this.getExtInfo("subjectAltName");if(J===void 0)return J;for(var re=new Array,he=m(this.hex,J.vidx),ye=l(he,0),Fe=0;Fe<ye.length;Fe++)te=he.substr(ye[Fe],2),G=d(he,ye[Fe]),te==="81"&&(X=Zt(G),re.push(["MAIL",X])),te==="82"&&(X=Zt(G),re.push(["DNS",X])),te==="84"&&(X=ut.hex2dn(G,0),re.push(["DN",X])),te==="86"&&(X=Zt(G),re.push(["URI",X])),te==="87"&&(X=Kl(G),re.push(["IP",X]));return re},this.getExtCRLDistributionPoints=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("cRLDistributionPoints");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"cRLDistributionPoints",array:[]};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){var ye=m(G,re[he]);J.array.push(this.getDistributionPoint(ye))}return J},this.getDistributionPoint=function(G){for(var X={},te=l(G,0),J=0;J<te.length;J++){var re=G.substr(te[J],2),he=m(G,te[J]);re=="a0"&&(X.dpname=this.getDistributionPointName(he))}return X},this.getDistributionPointName=function(G){for(var X={},te=l(G,0),J=0;J<te.length;J++){var re=G.substr(te[J],2),he=m(G,te[J]);re=="a0"&&(X.full=this.getGeneralNames(he))}return X},this.getExtCRLDistributionPointsURI=function(){var G=this.getExtCRLDistributionPoints();if(G==null)return G;for(var X=G.array,te=[],J=0;J<X.length;J++)try{X[J].dpname.full[0].uri!=null&&te.push(X[J].dpname.full[0].uri)}catch{}return te},this.getExtAIAInfo=function(){var G=this.getExtInfo("authorityInfoAccess");if(G===void 0)return G;for(var X={ocsp:[],caissuer:[]},te=l(this.hex,G.vidx),J=0;J<te.length;J++){var re=T(this.hex,te[J],[0],"06"),he=T(this.hex,te[J],[1],"86");re==="2b06010505073001"&&X.ocsp.push(Zt(he)),re==="2b06010505073002"&&X.caissuer.push(Zt(he))}return X},this.getExtAuthorityInfoAccess=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("authorityInfoAccess");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"authorityInfoAccess",array:[]};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){var ye=k(G,re[he],[0],"06"),Fe=T(G,re[he],[1],"86"),ge=Zt(Fe);if(ye=="2b06010505073001")J.array.push({ocsp:ge});else if(ye=="2b06010505073002")J.array.push({caissuer:ge});else throw new Error("unknown method: "+ye)}return J},this.getExtCertificatePolicies=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("certificatePolicies");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"certificatePolicies",array:[]};X&&(J.critical=!0);for(var re=l(G,0),he=0;he<re.length;he++){var ye=m(G,re[he]),Fe=this.getPolicyInformation(ye);J.array.push(Fe)}return J},this.getPolicyInformation=function(G){var X={},te=T(G,0,[0],"06");X.policyoid=A(te);var J=L(G,0,[1],"30");if(J!=-1){X.array=[];for(var re=l(G,J),he=0;he<re.length;he++){var ye=m(G,re[he]),Fe=this.getPolicyQualifierInfo(ye);X.array.push(Fe)}}return X},this.getOtherName=function(G){var X={},te=l(G,0),J=T(G,te[0],[],"06"),re=T(G,te[1],[]);return X.oid=A(J),X.value=v(re),X},this.getPolicyQualifierInfo=function(G){var X={},te=T(G,0,[0],"06");if(te==="2b06010505070201"){var J=k(G,0,[1],"16");X.cps=Or(J)}else if(te==="2b06010505070202"){var re=O(G,0,[1],"30");X.unotice=this.getUserNotice(re)}return X},this.getUserNotice=function(G){var X=null;try{X=c.parse(G);var te=this._asn1ToUnotice(X);return te}catch{return}},this._asn1ToUnotice=function(G){try{for(var X={},te=en(G,"seq"),J=0;J<te.length;J++){var re=this._asn1ToNoticeRef(te[J]);re!=null&&(X.noticeref=re);var he=this.asn1ToDisplayText(te[J]);he!=null&&(X.exptext=he)}return Object.keys(X).length>0?X:void 0}catch{return}},this._asn1ToNoticeRef=function(G){try{for(var X={},te=en(G,"seq"),J=0;J<te.length;J++){var re=this._asn1ToNoticeNum(te[J]);re!=null&&(X.noticenum=re);var he=this.asn1ToDisplayText(te[J]);he!=null&&(X.org=he)}return Object.keys(X).length>0?X:void 0}catch{return}},this._asn1ToNoticeNum=function(G){try{for(var X=en(G,"seq"),te=[],J=0;J<X.length;J++){var re=X[J];te.push(parseInt(en(re,"int.hex"),16))}return te}catch{return}},this.getDisplayText=function(G){var X={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},te={};return te.type=X[G.substr(0,2)],te.str=Or(d(G,0)),te},this.asn1ToDisplayText=function(G){if(G.utf8str!=null)return{type:"utf8",str:G.utf8str.str};if(G.ia5str!=null)return{type:"ia5",str:G.ia5str.str};if(G.visstr!=null)return{type:"vis",str:G.visstr.str};if(G.bmpstr!=null)return{type:"bmp",str:G.bmpstr.str};if(G.prnstr!=null)return{type:"prn",str:G.prnstr.str}},this.getExtPolicyMappings=function(G,X){var te=this.getCriticalExtV("policyMappings",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"policyMappings"};X&&(J.critical=!0);try{for(var re=v(G),he=re.seq,ye=[],Fe=0;Fe<he.length;Fe++){var ge=he[Fe].seq;ye.push([ge[0].oid,ge[1].oid])}J.array=ye}catch{throw new se("malformed policyMappings")}return J}},this.getExtPolicyConstraints=function(G,X){var te=this.getCriticalExtV("policyConstraints",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"policyConstraints"};X&&(J.critical=!0);var re=v(G);try{for(var he=re.seq,ye=0;ye<he.length;ye++){var Fe=he[ye].tag;Fe.explicit==!1&&(Fe.tag=="80"&&(J.reqexp=parseInt(Fe.hex,16)),Fe.tag=="81"&&(J.inhibit=parseInt(Fe.hex,16)))}}catch{return new se("malformed policyConstraints value")}return J}},this.getExtInhibitAnyPolicy=function(G,X){var te=this.getCriticalExtV("inhibitAnyPolicy",G,X);if(G=te[0],X=te[1],G!=null){var J={extname:"inhibitAnyPolicy"};X&&(J.critical=!0);var re=D(G,0);return re==-1?new se("wrong value"):(J.skip=re,J)}},this.getExtCRLNumber=function(G,X){var te={extname:"cRLNumber"};if(X&&(te.critical=!0),G.substr(0,2)=="02")return te.num={hex:d(G,0)},te;throw new se("hExtV parse error: "+G)},this.getExtCRLReason=function(G,X){var te={extname:"cRLReason"};if(X&&(te.critical=!0),G.substr(0,2)=="0a")return te.code=parseInt(d(G,0),16),te;throw new Error("hExtV parse error: "+G)},this.getExtOcspNonce=function(G,X){var te={extname:"ocspNonce"};X&&(te.critical=!0);var J=d(G,0);return te.hex=J,te},this.getExtOcspNoCheck=function(G,X){var te={extname:"ocspNoCheck"};return X&&(te.critical=!0),te},this.getExtAdobeTimeStamp=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("adobeTimeStamp");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"adobeTimeStamp"};X&&(J.critical=!0);var re=l(G,0);if(re.length>1){var he=m(G,re[1]),ye=this.getGeneralName(he);ye.uri!=null&&(J.uri=ye.uri)}if(re.length>2){var Fe=m(G,re[2]);Fe=="0101ff"&&(J.reqauth=!0),Fe=="010100"&&(J.reqauth=!1)}return J},this.getExtSubjectDirectoryAttributes=function(G,X){if(G===void 0&&X===void 0){var te=this.getExtInfo("subjectDirectoryAttributes");if(te===void 0)return;G=m(this.hex,te.vidx),X=te.critical}var J={extname:"subjectDirectoryAttributes"};X&&(J.critical=!0);try{for(var re=v(G),he=[],ye=0;ye<re.seq.length;ye++){var Fe=re.seq[ye],ge=en(Fe,"seq.0.oid"),Pe=en(Fe,"seq.1.set");if(ge==null||Pe==null)throw"error";he.push({attr:ge,array:Pe})}return J.array=he,J}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var de=function(G){var X={};try{var te=G.seq[0].oid,J=y.asn1.x509.OID.name2oid(te);X.type=y.asn1.x509.OID.oid2atype(J);var re=G.seq[1];if(re.utf8str!=null)X.ds="utf8",X.value=re.utf8str.str;else if(re.numstr!=null)X.ds="num",X.value=re.numstr.str;else if(re.telstr!=null)X.ds="tel",X.value=re.telstr.str;else if(re.prnstr!=null)X.ds="prn",X.value=re.prnstr.str;else if(re.ia5str!=null)X.ds="ia5",X.value=re.ia5str.str;else if(re.visstr!=null)X.ds="vis",X.value=re.visstr.str;else if(re.bmpstr!=null)X.ds="bmp",X.value=re.bmpstr.str;else throw"error";return X}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},ue=function(G){try{return G.set.map(function(X){return de(X)})}catch(X){throw new Error("improper ASN.1 parsed RDN: "+X)}},pe=function(G){try{return G.seq.map(function(X){return ue(X)})}catch(X){throw new Error("improper ASN.1 parsed X500Name: "+X)}};this.getX500NameRule=function(G){for(var X=null,te=[],J=0;J<G.length;J++)for(var re=G[J],he=0;he<re.length;he++)te.push(re[he]);for(var J=0;J<te.length;J++){var ye=te[J],Fe=ye.ds,ge=ye.value,Pe=ye.type;if(Fe!="prn"&&Fe!="utf8"&&Fe!="ia5")return"mixed";if(Fe=="ia5"){if(Pe!="CN")return"mixed";if(y.lang.String.isMail(ge))continue;return"mixed"}if(Pe=="C"){if(Fe=="prn")continue;return"mixed"}if(X==null)X=Fe;else if(X!==Fe)return"mixed"}return X??"prn"},this.getAttrTypeAndValue=function(G){var X=v(G);return de(X)},this.getRDN=function(G){var X=v(G);return ue(X)},this.getX500NameArray=function(G){var X=v(G);return pe(X)},this.getX500Name=function(G,X,te){var J=this.getX500NameArray(G),re=this.dnarraytostr(J),he={str:re};return he.array=J,te==!0&&(he.hex=G),X==!0&&(he.canon=this.c14nRDNArray(J)),he},this.readCertPEM=function(G){this.readCertHex(j(G))},this.readCertHex=function(G){this.hex=G,this.getVersion();try{U(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(G){var X={};return G==null&&(G={}),X.version=this.getVersion(),X.serial={hex:this.getSerialNumberHex()},X.sigalg=this.getSignatureAlgorithmField(),X.issuer=this.getIssuer(G.dncanon,G.dnhex),X.notbefore=this.getNotBefore(),X.notafter=this.getNotAfter(),X.subject=this.getSubject(G.dncanon,G.dnhex),X.sbjpubkey=or(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(X.ext=this.getExtParamArray()),X.sighex=this.getSignatureValueHex(),G.tbshex==!0&&(X.tbshex=O(this.hex,0,[0])),G.nodnarray==!0&&(delete X.issuer.array,delete X.subject.array),X},this.getExtParamArray=function(G){if(G==null){var X=L(this.hex,0,[0,"[3]"]);X!=-1&&(G=F(this.hex,0,[0,"[3]",0],"30"))}for(var te=[],J=l(G,0),re=0;re<J.length;re++){var he=m(G,J[re]),ye=this.getExtParam(he);ye!=null&&te.push(ye)}return te},this.getExtParam=function(G){var X=l(G,0),te=X.length;if(te!=2&&te!=3)throw new Error("wrong number elements in Extension: "+te+" "+G);var J=N(T(G,0,[0],"06")),re=!1;te==3&&O(G,0,[1])=="0101ff"&&(re=!0);var he=O(G,0,[te-1,0]),ye=void 0;if(J=="2.5.29.14"?ye=this.getExtSubjectKeyIdentifier(he,re):J=="2.5.29.15"?ye=this.getExtKeyUsage(he,re):J=="2.5.29.17"?ye=this.getExtSubjectAltName(he,re):J=="2.5.29.18"?ye=this.getExtIssuerAltName(he,re):J=="2.5.29.19"?ye=this.getExtBasicConstraints(he,re):J=="2.5.29.30"?ye=this.getExtNameConstraints(he,re):J=="2.5.29.31"?ye=this.getExtCRLDistributionPoints(he,re):J=="2.5.29.32"?ye=this.getExtCertificatePolicies(he,re):J=="2.5.29.33"?ye=this.getExtPolicyMappings(he,re):J=="2.5.29.35"?ye=this.getExtAuthorityKeyIdentifier(he,re):J=="2.5.29.36"?ye=this.getExtPolicyConstraints(he,re):J=="2.5.29.37"?ye=this.getExtExtKeyUsage(he,re):J=="2.5.29.54"?ye=this.getExtInhibitAnyPolicy(he,re):J=="1.3.6.1.5.5.7.1.1"?ye=this.getExtAuthorityInfoAccess(he,re):J=="2.5.29.20"?ye=this.getExtCRLNumber(he,re):J=="2.5.29.21"?ye=this.getExtCRLReason(he,re):J=="2.5.29.9"?ye=this.getExtSubjectDirectoryAttributes(he,re):J=="1.3.6.1.5.5.7.48.1.2"?ye=this.getExtOcspNonce(he,re):J=="1.3.6.1.5.5.7.48.1.5"?ye=this.getExtOcspNoCheck(he,re):J=="1.2.840.113583.1.1.9.1"?ye=this.getExtAdobeTimeStamp(he,re):ut.EXT_PARSER[J]!=null&&(ye=ut.EXT_PARSER[J](J,re,he)),ye!=null)return ye;var Fe={extname:J,extn:he};try{Fe.extn=v(he)}catch{}return re&&(Fe.critical=!0),Fe},this.findExt=function(G,X){for(var te=0;te<G.length;te++)if(G[te].extname==X)return G[te];return null},this.updateExtCDPFullURI=function(G,X){var te=this.findExt(G,"cRLDistributionPoints");if(te!=null&&te.array!=null){for(var J=te.array,re=0;re<J.length;re++)if(J[re].dpname!=null&&J[re].dpname.full!=null)for(var he=J[re].dpname.full,ye=0;ye<he.length;ye++){var Fe=he[re];Fe.uri!=null&&(Fe.uri=X)}}},this.updateExtAIAOCSP=function(G,X){var te=this.findExt(G,"authorityInfoAccess");if(te!=null&&te.array!=null)for(var J=te.array,re=0;re<J.length;re++)J[re].ocsp!=null&&(J[re].ocsp=X)},this.updateExtAIACAIssuer=function(G,X){var te=this.findExt(G,"authorityInfoAccess");if(te!=null&&te.array!=null)for(var J=te.array,re=0;re<J.length;re++)J[re].caissuer!=null&&(J[re].caissuer=X)},this.dnarraytostr=function(G){function X(J){return J.map(function(re){return te(re).replace(/\+/,"\\+")}).join("+")}function te(J){return J.type+"="+J.value}return"/"+G.map(function(J){return X(J).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(G){var X;if(G.str!=null&&G.array==null){var te=new y.asn1.x509.X500Name({str:G.str}),J=te.tohex();X=this.getX500NameArray(J)}else X=G.array;G.canon==null&&(G.canon=this.c14nRDNArray(X))},this.c14nRDNArray=function(G){for(var X=[],te=0;te<G.length;te++){for(var J=G[te],re=[],he=0;he<J.length;he++){var ye=J[he],Fe=ye.value;Fe=Fe.replace(/^\s*/,""),Fe=Fe.replace(/\s*$/,""),Fe=Fe.replace(/\s+/g," "),Fe=Fe.toLowerCase(),re.push(ye.type.toLowerCase()+"="+Fe)}X.push(re.join("+"))}return"/"+X.join("/")},this.getInfo=function(){var G=function(br){for(var Bt="",Qt="    ",yn=`
`,_n=br.array,Mr=0;Mr<_n.length;Mr++){var Pn=_n[Mr];if(Pn.dn!=null&&(Bt+=Qt+"dn: "+Pn.dn.str+yn),Pn.ip!=null&&(Bt+=Qt+"ip: "+Pn.ip+yn),Pn.rfc822!=null&&(Bt+=Qt+"rfc822: "+Pn.rfc822+yn),Pn.dns!=null&&(Bt+=Qt+"dns: "+Pn.dns+yn),Pn.uri!=null&&(Bt+=Qt+"uri: "+Pn.uri+yn),Pn.other!=null){var sc=Pn.other.oid,ma=JSON.stringify(Pn.other.value).replace(/\"/g,"");Bt+=Qt+"other: "+sc+"="+ma+yn}}return Bt=Bt.replace(/\n$/,""),Bt},X=function(br){for(var Bt="",Qt=br.array,yn=0;yn<Qt.length;yn++){var _n=Qt[yn];if(Bt+="    policy oid: "+_n.policyoid+`
`,_n.array!==void 0)for(var Mr=0;Mr<_n.array.length;Mr++){var Pn=_n.array[Mr];Pn.cps!==void 0&&(Bt+="    cps: "+Pn.cps+`
`)}}return Bt},te=function(br){for(var Bt="",Qt=br.array,yn=0;yn<Qt.length;yn++){var _n=Qt[yn];try{_n.dpname.full[0].uri!==void 0&&(Bt+="    "+_n.dpname.full[0].uri+`
`)}catch{}try{_n.dname.full[0].dn.hex!==void 0&&(Bt+="    "+ut.hex2dn(_n.dpname.full[0].dn.hex)+`
`)}catch{}}return Bt},J=function(br){for(var Bt="",Qt=br.array,yn=0;yn<Qt.length;yn++){var _n=Qt[yn];_n.caissuer!==void 0&&(Bt+="    caissuer: "+_n.caissuer+`
`),_n.ocsp!==void 0&&(Bt+="    ocsp: "+_n.ocsp+`
`)}return Bt},re,he,ye;if(re=`Basic Fields
`,re+="  serial number: "+this.getSerialNumberHex()+`
`,re+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,re+="  issuer: "+this.getIssuerString()+`
`,re+="  notBefore: "+this.getNotBefore()+`
`,re+="  notAfter: "+this.getNotAfter()+`
`,re+="  subject: "+this.getSubjectString()+`
`,re+=`  subject public key info: 
`,he=this.getPublicKey(),re+="    key algorithm: "+he.type+`
`,he.type==="RSA"&&(re+="    n="+qh(he.n.toString(16)).substr(0,16)+`...
`,re+="    e="+qh(he.e.toString(16))+`
`),ye=this.aExtInfo,ye!=null){re+=`X509v3 Extensions:
`;for(var Fe=0;Fe<ye.length;Fe++){var ge=ye[Fe],Pe=y.asn1.x509.OID.oid2name(ge.oid);Pe===""&&(Pe=ge.oid);var Ne="";if(ge.critical===!0&&(Ne="CRITICAL"),re+="  "+Pe+" "+Ne+`:
`,Pe==="basicConstraints"){var Me=this.getExtBasicConstraints();Me.cA===void 0?re+=`    {}
`:(re+="    cA=true",Me.pathLen!==void 0&&(re+=", pathLen="+Me.pathLen),re+=`
`)}else if(Pe=="policyMappings"){var cr=this.getExtPolicyMappings().array,vn=cr.map(function(br){var Bt=br;return Bt[0]+":"+Bt[1]}).join(", ");re+="    "+vn+`
`}else if(Pe=="policyConstraints"){var nn=this.getExtPolicyConstraints();re+="    ",nn.reqexp!=null&&(re+=" reqexp="+nn.reqexp),nn.inhibit!=null&&(re+=" inhibit="+nn.inhibit),re+=`
`}else if(Pe=="inhibitAnyPolicy"){var nn=this.getExtInhibitAnyPolicy();re+="    skip="+nn.skip+`
`}else if(Pe=="keyUsage")re+="    "+this.getExtKeyUsageString()+`
`;else if(Pe=="subjectKeyIdentifier")re+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(Pe=="authorityKeyIdentifier"){var Dn=this.getExtAuthorityKeyIdentifier();Dn.kid!==void 0&&(re+="    kid="+Dn.kid.hex+`
`)}else if(Pe=="extKeyUsage"){var Vn=this.getExtExtKeyUsage().array;re+="    "+Vn.join(", ")+`
`}else if(Pe=="subjectAltName"){var Zn=G(this.getExtSubjectAltName());re+=Zn+`
`}else if(Pe=="cRLDistributionPoints"){var qn=this.getExtCRLDistributionPoints();re+=te(qn)}else if(Pe=="authorityInfoAccess"){var ic=this.getExtAuthorityInfoAccess();re+=J(ic)}else Pe=="certificatePolicies"&&(re+=X(this.getExtCertificatePolicies()))}}return re+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,re+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,re},typeof s=="string"&&(s.indexOf("-----BEGIN")!=-1?this.readCertPEM(s):y.lang.String.isHex(s)&&this.readCertHex(s))}ut.EXT_PARSER={},ut.registExtParser=function(s,c){ut.EXT_PARSER[s]=c},ut.hex2dn=function(s,c){c===void 0&&(c=0);var l=new ut;Be.getTLV(s,c);var d=l.getX500Name(s);return d.str},ut.hex2rdn=function(s,c){if(c===void 0&&(c=0),s.substr(c,2)!=="31")throw new Error("malformed RDN");for(var l=new Array,d=Be.getChildIdx(s,c),v=0;v<d.length;v++)l.push(ut.hex2attrTypeValue(s,d[v]));return l=l.map(function(m){return m.replace("+","\\+")}),l.join("+")},ut.hex2attrTypeValue=function(s,c){var l=Be,d=l.getV;if(c===void 0&&(c=0),s.substr(c,2)!=="30")throw new Error("malformed attribute type and value");var v=l.getChildIdx(s,c);v.length!==2||s.substr(v[0],2);var m=d(s,v[0]),T=y.asn1.ASN1Util.oidHexToInt(m),k=y.asn1.x509.OID.oid2atype(T),O=d(s,v[1]),F=Or(O);return k+"="+F},ut.getPublicKeyFromCertHex=function(s){var c=new ut;return c.readCertHex(s),c.getPublicKey()},ut.getPublicKeyFromCertPEM=function(s){var c=new ut;return c.readCertPEM(s),c.getPublicKey()},ut.getPublicKeyInfoPropOfCertPEM=function(s){var c=Be,l=c.getVbyList,d={},v,m;return d.algparam=null,v=new ut,v.readCertPEM(s),m=v.getPublicKeyHex(),d.keyhex=l(m,0,[1],"03").substr(2),d.algoid=l(m,0,[0,0],"06"),d.algoid==="2a8648ce3d0201"&&(d.algparam=l(m,0,[0,1],"06")),d},ut.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var F2=function(s){var c=y,l=c.lang.String.isHex,d=Be,v=d.getV,m=d.getTLV,T=d.getVbyList,k=d.getTLVbyList,O=d.getTLVbyListEx,F=d.getIdxbyList,U=d.getIdxbyListEx,L=d.getChildIdx,P=new ut;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var D=F(this.hex,0,[0,0]),A=this.hex.substr(D,2);if(A=="02")this.posSigAlg=1;else if(A=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+A);var N=F(this.hex,0,[0,this.posSigAlg+3]),j=this.hex.substr(N,2);if(j=="17"||j=="18"){var W,se;W=F(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,W!=-1&&(se=this.hex.substr(W,2),se=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(j=="30")this.posRevCert=this.posSigAlg+3;else if(j=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+j)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(T(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var D=k(this.hex,0,[0,this.posSigAlg],"30");return P.getAlgorithmIdentifierName(D)},this.getIssuer=function(){return P.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return k(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var D=T(this.hex,0,[0,this.posSigAlg+2]);return result=Or(D)},this.getNextUpdate=function(){var D=F(this.hex,0,[0,this.posSigAlg+3]),A=this.hex.substr(D,2);return A!="17"&&A!="18"?null:Or(v(this.hex,D))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var D=[],A=F(this.hex,0,[0,this.posRevCert]),N=L(this.hex,A),j=0;j<N.length;j++){var W=m(this.hex,N[j]);D.push(this.getRevCert(W))}return D},this.getRevCert=function(D){var A={},N=L(D,0);return A.sn={hex:T(D,0,[0],"02")},A.date=Or(T(D,0,[1])),N.length==3&&(A.ext=P.getExtParamArray(k(D,0,[2]))),A},this.findRevCert=function(D){var A=new ut(D),N=A.getSerialNumberHex();return this.findRevCertBySN(N)},this.findRevCertBySN=function(D){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var A=this.parsed.revcert,N=0;N<A.length;N++)if(D==A[N].sn.hex)return A[N];return null},this.getSignatureValueHex=function(){return T(this.hex,0,[2],"03",!0)},this.verifySignature=function(D){var A=this.getSignatureAlgorithmField(),N=this.getSignatureValueHex(),j=k(this.hex,0,[0],"30"),W=new y.crypto.Signature({alg:A});return W.init(D),W.updateHex(j),W.verify(N)},this.getParam=function(D){var A={},N=this.getVersion();N!=null&&(A.version=N),A.sigalg=this.getSignatureAlgorithmField(),A.issuer=this.getIssuer(),A.thisupdate=this.getThisUpdate();var j=this.getNextUpdate();j!=null&&(A.nextupdate=j);var W=this.getRevCertArray();W!=null&&(A.revcert=W);var se=U(this.hex,0,[0,"[0]"]);if(se!=-1){var de=O(this.hex,0,[0,"[0]",0]);A.ext=P.getExtParamArray(de)}return A.sighex=this.getSignatureValueHex(),this.parsed=A,typeof D=="object"&&(D.tbshex==!0&&(A.tbshex=k(this.hex,0,[0])),D.nodnarray==!0&&delete A.issuer.array),A},typeof s=="string"&&(l(s)?this.hex=s:s.match(/-----BEGIN X509 CRL/)&&(this.hex=En(s)),this._setPos())};(typeof y>"u"||!y)&&(y={}),(typeof y.jws>"u"||!y.jws)&&(y.jws={}),y.jws.JWS=function(){var s=y,c=s.jws.JWS,l=c.isSafeJSONString;this.parseJWS=function(d,v){if(!(this.parsedJWS!==void 0&&(v||this.parsedJWS.sigvalH!==void 0))){var m=d.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(m==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var T=m[1],k=m[2],O=m[3],F=T+"."+k;if(this.parsedJWS={},this.parsedJWS.headB64U=T,this.parsedJWS.payloadB64U=k,this.parsedJWS.sigvalB64U=O,this.parsedJWS.si=F,!v){var U=on(O),L=be(U,16);this.parsedJWS.sigvalH=U,this.parsedJWS.sigvalBI=L}var P=gi(T),D=gi(k);if(this.parsedJWS.headS=P,this.parsedJWS.payloadS=D,!l(P,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+P}}},y.jws.JWS.sign=function(s,c,l,d,v){var m=y,T=m.jws,k=T.JWS,O=k.readSafeJSONString,F=k.isSafeJSONString,U=m.crypto;U.ECDSA;var L=U.Mac,P=U.Signature,D=JSON,A,N,j;if(typeof c!="string"&&typeof c!="object")throw"spHeader must be JSON string or object: "+c;if(typeof c=="object"&&(N=c,A=D.stringify(N)),typeof c=="string"){if(A=c,!F(A))throw"JWS Head is not safe JSON string: "+A;N=O(A)}if(j=l,typeof l=="object"&&(j=D.stringify(l)),(s==""||s==null)&&N.alg!==void 0&&(s=N.alg),s!=""&&s!=null&&N.alg===void 0&&(N.alg=s,A=D.stringify(N)),s!==N.alg)throw"alg and sHeader.alg doesn't match: "+s+"!="+N.alg;var W=null;if(k.jwsalg2sigalg[s]===void 0)throw"unsupported alg name: "+s;W=k.jwsalg2sigalg[s];var se=nc(A),de=nc(j),ue=se+"."+de,pe="";if(W.substr(0,4)=="Hmac"){if(d===void 0)throw"mac key shall be specified for HS* alg";var G=new L({alg:W,prov:"cryptojs",pass:d});G.updateString(ue),pe=G.doFinal()}else if(W.indexOf("withECDSA")!=-1){var X=new P({alg:W});X.init(d,v),X.updateString(ue);var te=X.sign();pe=y.crypto.ECDSA.asn1SigToConcatSig(te)}else if(W!="none"){var X=new P({alg:W});X.init(d,v),X.updateString(ue),pe=X.sign()}var J=jn(pe);return ue+"."+J},y.jws.JWS.verify=function(s,c,l){var d=y,v=d.jws,m=v.JWS,T=m.readSafeJSONString,k=d.crypto,O=k.ECDSA,F=k.Mac,U=k.Signature,L;if(typeof xe!==void 0&&(L=xe),!Vh(s))return!1;var P=s.split(".");if(P.length!==3)return!1;var D=P[0],A=P[1],N=D+"."+A,j=on(P[2]),W=T(gi(P[0])),se=null,de=null;if(W.alg===void 0)throw"algorithm not specified in header";if(se=W.alg,de=se.substr(0,2),l!=null&&Object.prototype.toString.call(l)==="[object Array]"&&l.length>0){var ue=":"+l.join(":")+":";if(ue.indexOf(":"+se+":")==-1)throw"algorithm '"+se+"' not accepted in the list"}if(se!="none"&&c===null)throw"key shall be specified to verify.";if(typeof c=="string"&&c.indexOf("-----BEGIN ")!=-1&&(c=Ot.getKey(c)),(de=="RS"||de=="PS")&&!(c instanceof L))throw"key shall be a RSAKey obj for RS* and PS* algs";if(de=="ES"&&!(c instanceof O))throw"key shall be a ECDSA obj for ES* algs";var pe=null;if(m.jwsalg2sigalg[W.alg]===void 0)throw"unsupported alg name: "+se;if(pe=m.jwsalg2sigalg[se],pe=="none")throw"not supported";if(pe.substr(0,4)=="Hmac"){var G=null;if(c===void 0)throw"hexadecimal key shall be specified for HMAC";var X=new F({alg:pe,pass:c});return X.updateString(N),G=X.doFinal(),j==G}else if(pe.indexOf("withECDSA")!=-1){var te=null;try{te=O.concatSigToASN1Sig(j)}catch{return!1}var J=new U({alg:pe});return J.init(c),J.updateString(N),J.verify(te)}else{var J=new U({alg:pe});return J.init(c),J.updateString(N),J.verify(j)}},y.jws.JWS.parse=function(s){var c=s.split("."),l={},d,v,m;if(c.length!=2&&c.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return d=c[0],v=c[1],c.length==3&&(m=c[2]),l.headerObj=y.jws.JWS.readSafeJSONString(gi(d)),l.payloadObj=y.jws.JWS.readSafeJSONString(gi(v)),l.headerPP=JSON.stringify(l.headerObj,null,"  "),l.payloadObj==null?l.payloadPP=gi(v):l.payloadPP=JSON.stringify(l.payloadObj,null,"  "),m!==void 0&&(l.sigHex=on(m)),l},y.jws.JWS.verifyJWT=function(s,c,l){var d=y,v=d.jws,m=v.JWS,T=m.readSafeJSONString,k=m.inArray,O=m.includedArray;if(!Vh(s))return!1;var F=s.split(".");if(F.length!=3)return!1;var U=F[0],L=F[1];on(F[2]);var P=T(gi(U)),D=T(gi(L));if(P.alg===void 0)return!1;if(l.alg===void 0)throw"acceptField.alg shall be specified";if(!k(P.alg,l.alg)||D.iss!==void 0&&typeof l.iss=="object"&&!k(D.iss,l.iss)||D.sub!==void 0&&typeof l.sub=="object"&&!k(D.sub,l.sub))return!1;if(D.aud!==void 0&&typeof l.aud=="object"){if(typeof D.aud=="string"){if(!k(D.aud,l.aud))return!1}else if(typeof D.aud=="object"&&!O(D.aud,l.aud))return!1}var A=v.IntDate.getNow();return l.verifyAt!==void 0&&typeof l.verifyAt=="number"&&(A=l.verifyAt),(l.gracePeriod===void 0||typeof l.gracePeriod!="number")&&(l.gracePeriod=0),!(D.exp!==void 0&&typeof D.exp=="number"&&D.exp+l.gracePeriod<A||D.nbf!==void 0&&typeof D.nbf=="number"&&A<D.nbf-l.gracePeriod||D.iat!==void 0&&typeof D.iat=="number"&&A<D.iat-l.gracePeriod||D.jti!==void 0&&l.jti!==void 0&&D.jti!==l.jti||!m.verify(s,c,l.alg))},y.jws.JWS.includedArray=function(s,c){var l=y.jws.JWS.inArray;if(s===null||typeof s!="object"||typeof s.length!="number")return!1;for(var d=0;d<s.length;d++)if(!l(s[d],c))return!1;return!0},y.jws.JWS.inArray=function(s,c){if(c===null||typeof c!="object"||typeof c.length!="number")return!1;for(var l=0;l<c.length;l++)if(c[l]==s)return!0;return!1},y.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},y.jws.JWS.isSafeJSONString=function(s,c,l){var d=null;try{return d=lg(s),typeof d!="object"||d.constructor===Array?0:(c&&(c[l]=d),1)}catch{return 0}},y.jws.JWS.readSafeJSONString=function(s){var c=null;try{return c=lg(s),typeof c!="object"||c.constructor===Array?null:c}catch{return null}},y.jws.JWS.getEncodedSignatureValueFromJWS=function(s){var c=s.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(c==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return c[1]},y.jws.JWS.getJWKthumbprint=function(s){if(s.kty!=="RSA"&&s.kty!=="EC"&&s.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var c="{";if(s.kty==="RSA"){if(typeof s.n!="string"||typeof s.e!="string")throw"wrong n and e value for RSA key";c+='"e":"'+s.e+'",',c+='"kty":"'+s.kty+'",',c+='"n":"'+s.n+'"}'}else if(s.kty==="EC"){if(typeof s.crv!="string"||typeof s.x!="string"||typeof s.y!="string")throw"wrong crv, x and y value for EC key";c+='"crv":"'+s.crv+'",',c+='"kty":"'+s.kty+'",',c+='"x":"'+s.x+'",',c+='"y":"'+s.y+'"}'}else if(s.kty==="oct"){if(typeof s.k!="string")throw"wrong k value for oct(symmetric) key";c+='"kty":"'+s.kty+'",',c+='"k":"'+s.k+'"}'}var l=Vi(c),d=y.crypto.Util.hashHex(l,"sha256"),v=jn(d);return v},y.jws.IntDate={},y.jws.IntDate.get=function(s){var c=y.jws.IntDate,l=c.getNow,d=c.getZulu;if(s=="now")return l();if(s=="now + 1hour")return l()+60*60;if(s=="now + 1day")return l()+60*60*24;if(s=="now + 1month")return l()+60*60*24*30;if(s=="now + 1year")return l()+60*60*24*365;if(s.match(/Z$/))return d(s);if(s.match(/^[0-9]+$/))return parseInt(s);throw"unsupported format: "+s},y.jws.IntDate.getZulu=function(s){return pg(s)},y.jws.IntDate.getNow=function(){var s=~~(new Date/1e3);return s},y.jws.IntDate.intDate2UTCString=function(s){var c=new Date(s*1e3);return c.toUTCString()},y.jws.IntDate.intDate2Zulu=function(s){var c=new Date(s*1e3),l=("0000"+c.getUTCFullYear()).slice(-4),d=("00"+(c.getUTCMonth()+1)).slice(-2),v=("00"+c.getUTCDate()).slice(-2),m=("00"+c.getUTCHours()).slice(-2),T=("00"+c.getUTCMinutes()).slice(-2),k=("00"+c.getUTCSeconds()).slice(-2);return l+d+v+m+T+k+"Z"},(typeof y>"u"||!y)&&(y={}),(typeof y.jws>"u"||!y.jws)&&(y.jws={}),y.jws.JWSJS=function(){var s=y,c=s.jws,l=c.JWS,d=l.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(v){this.init();var m=v.split(".");if(m.length!=3)throw"malformed input JWS";this.aHeader.push(m[0]),this.sPayload=m[1],this.aSignature.push(m[2])},this.addSignature=function(v,m,T,k){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var O=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var F=y.jws.JWS.sign(v,m,this.sPayload,T,k),U=F.split("."),L=U[0],P=U[2];this.aHeader.push(U[0]),this.aSignature.push(U[2])}catch(D){throw this.aHeader.length>O&&this.aHeader.pop(),this.aSignature.length>O&&this.aSignature.pop(),"addSignature failed: "+D}},this.verifyAll=function(v){if(this.aHeader.length!==v.length||this.aSignature.length!==v.length)return!1;for(var m=0;m<v.length;m++){var T=v[m];if(T.length!==2)return!1;var k=this.verifyNth(m,T[0],T[1]);if(k===!1)return!1}return!0},this.verifyNth=function(v,m,T){if(this.aHeader.length<=v||this.aSignature.length<=v)return!1;var k=this.aHeader[v],O=this.aSignature[v],F=k+"."+this.sPayload+"."+O,U=!1;try{U=l.verify(F,m,T)}catch{return!1}return U},this.readJWSJS=function(v){if(typeof v=="string"){var m=d(v);if(m==null)throw"argument is not safe JSON object string";this.aHeader=m.headers,this.sPayload=m.payload,this.aSignature=m.signatures}else try{if(v.headers.length>0)this.aHeader=v.headers;else throw"malformed header";if(typeof v.payload=="string")this.sPayload=v.payload;else throw"malformed signatures";if(v.signatures.length>0)this.aSignature=v.signatures;else throw"malformed signatures"}catch(T){throw"malformed JWS-JS JSON object: "+T}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}},e.SecureRandom=oe,e.rng_seed_time=Ja,e.BigInteger=_,e.RSAKey=xe,e.ECDSA=y.crypto.ECDSA,e.DSA=y.crypto.DSA,e.Signature=y.crypto.Signature,e.MessageDigest=y.crypto.MessageDigest,e.Mac=y.crypto.Mac,e.KEYUTIL=Ot,e.ASN1HEX=Be,e.X509=ut,e.X509CRL=F2,e.CryptoJS=a,e.b64tohex=h,e.b64toBA=g,e.ECFieldElementFp=ot,e.ECPointFp=lt,e.ECCurveFp=ss,e.stoBA=ug,e.BAtos=dg,e.BAtohex=Ul,e.stohex=Nr,e.stob64=h2,e.stob64u=p2,e.b64utos=f2,e.b64tob64u=Xa,e.b64utob64=tc,e.hex2b64=p,e.hextob64u=jn,e.b64utohex=on,e.utf8tob64u=nc,e.b64utoutf8=gi,e.utf8tob64=m2,e.b64toutf8=g2,e.utf8tohex=Hl,e.hextoutf8=Zt,e.hextorstr=Or,e.rstrtohex=Vi,e.hextob64=Mh,e.hextob64nl=_2,e.b64nltohex=hg,e.hextopem=or,e.pemtohex=En,e.hextoArrayBuffer=w2,e.ArrayBuffertohex=x2,e.zulutomsec=Lh,e.msectozulu=C2,e.zulutosec=pg,e.zulutodate=E2,e.datetozulu=P2,e.uricmptohex=ql,e.hextouricmp=zl,e.ipv6tohex=jh,e.hextoipv6=Bh,e.hextoip=Kl,e.iptohex=Uh,e.ucs2hextoutf8=Hh,e.encodeURIComponentAll=$l,e.newline_toUnix=k2,e.newline_toDos=T2,e.hextoposhex=qh,e.intarystrtohex=R2,e.strdiffidx=A2,e.oidtohex=yg,e.hextooid=Wl,e.strpad=Gl,e.bitstrtoint=bg,e.inttobitstr=Sg,e.bitstrtobinstr=wg,e.binstrtobitstr=I2,e.isBase64URLDot=Vh,e.namearraytobinstr=Jl,e.extendClass=Ie,e.foldnl=Vl,e.b64topem=b2,e.pemtob64=S2,e.timeogen=fg,e.aryval=en,e.inttohex=_g,e.twoscompl=rc,e.KJUR=y,e.crypto=y.crypto,e.asn1=y.asn1,e.jws=y.jws,e.lang=y.lang,e.VERSION=r,e.VERSION_FULL=i}}),$m=ke({"../../node_modules/.pnpm/isomorphic-ws@4.0.1_ws@8.18.2/node_modules/isomorphic-ws/browser.js"(e,t){Y();var n=null;typeof WebSocket<"u"?n=WebSocket:typeof MozWebSocket<"u"?n=MozWebSocket:typeof global<"u"?n=global.WebSocket||global.MozWebSocket:typeof window<"u"?n=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(n=self.WebSocket||self.MozWebSocket),t.exports=n}}),zy=ke({"../../node_modules/.pnpm/deepmerge@4.3.1/node_modules/deepmerge/dist/cjs.js"(e,t){Y();var n=function(M){return r(M)&&!i(M)};function r(E){return!!E&&typeof E=="object"}function i(E){var M=Object.prototype.toString.call(E);return M==="[object RegExp]"||M==="[object Date]"||u(E)}var a=typeof Symbol=="function"&&Symbol.for,o=a?Symbol.for("react.element"):60103;function u(E){return E.$$typeof===o}function p(E){return Array.isArray(E)?[]:{}}function h(E,M){return M.clone!==!1&&M.isMergeableObject(E)?b(p(E),E,M):E}function g(E,M,Z){return E.concat(M).map(function($){return h($,Z)})}function f(E,M){if(!M.customMerge)return b;var Z=M.customMerge(E);return typeof Z=="function"?Z:b}function _(E){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(E).filter(function(M){return Object.propertyIsEnumerable.call(E,M)}):[]}function w(E){return Object.keys(E).concat(_(E))}function C(E,M){try{return M in E}catch{return!1}}function R(E,M){return C(E,M)&&!(Object.hasOwnProperty.call(E,M)&&Object.propertyIsEnumerable.call(E,M))}function S(E,M,Z){var $={};return Z.isMergeableObject(E)&&w(E).forEach(function(z){$[z]=h(E[z],Z)}),w(M).forEach(function(z){R(E,z)||(C(E,z)&&Z.isMergeableObject(M[z])?$[z]=f(z,Z)(E[z],M[z],Z):$[z]=h(M[z],Z))}),$}function b(E,M,Z){Z=Z||{},Z.arrayMerge=Z.arrayMerge||g,Z.isMergeableObject=Z.isMergeableObject||n,Z.cloneUnlessOtherwiseSpecified=h;var $=Array.isArray(M),z=Array.isArray(E),q=$===z;return q?$?Z.arrayMerge(E,M,Z):S(E,M,Z):h(M,Z)}b.all=function(M,Z){if(!Array.isArray(M))throw new Error("first argument should be an array");return M.reduce(function($,z){return b($,z,Z)},{})};var x=b;t.exports=x}}),i4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheClear.js"(e,t){Y();function n(){this.__data__=[],this.size=0}t.exports=n}}),Ky=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/eq.js"(e,t){Y();function n(r,i){return r===i||r!==r&&i!==i}t.exports=n}}),Gd=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_assocIndexOf.js"(e,t){Y();var n=Ky();function r(i,a){for(var o=i.length;o--;)if(n(i[o][0],a))return o;return-1}t.exports=r}}),s4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheDelete.js"(e,t){Y();var n=Gd(),r=Array.prototype,i=r.splice;function a(o){var u=this.__data__,p=n(u,o);if(p<0)return!1;var h=u.length-1;return p==h?u.pop():i.call(u,p,1),--this.size,!0}t.exports=a}}),a4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheGet.js"(e,t){Y();var n=Gd();function r(i){var a=this.__data__,o=n(a,i);return o<0?void 0:a[o][1]}t.exports=r}}),o4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheHas.js"(e,t){Y();var n=Gd();function r(i){return n(this.__data__,i)>-1}t.exports=r}}),c4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheSet.js"(e,t){Y();var n=Gd();function r(i,a){var o=this.__data__,u=n(o,i);return u<0?(++this.size,o.push([i,a])):o[u][1]=a,this}t.exports=r}}),Jd=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_ListCache.js"(e,t){Y();var n=i4(),r=s4(),i=a4(),a=o4(),o=c4();function u(p){var h=-1,g=p==null?0:p.length;for(this.clear();++h<g;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),l4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackClear.js"(e,t){Y();var n=Jd();function r(){this.__data__=new n,this.size=0}t.exports=r}}),u4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackDelete.js"(e,t){Y();function n(r){var i=this.__data__,a=i.delete(r);return this.size=i.size,a}t.exports=n}}),d4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackGet.js"(e,t){Y();function n(r){return this.__data__.get(r)}t.exports=n}}),h4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackHas.js"(e,t){Y();function n(r){return this.__data__.has(r)}t.exports=n}}),$y=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_freeGlobal.js"(e,t){Y();var n=typeof global=="object"&&global&&global.Object===Object&&global;t.exports=n}}),Cs=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_root.js"(e,t){Y();var n=$y(),r=typeof self=="object"&&self&&self.Object===Object&&self,i=n||r||Function("return this")();t.exports=i}}),Wm=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Symbol.js"(e,t){Y();var n=Cs(),r=n.Symbol;t.exports=r}}),p4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getRawTag.js"(e,t){Y();var n=Wm(),r=Object.prototype,i=r.hasOwnProperty,a=r.toString,o=n?n.toStringTag:void 0;function u(p){var h=i.call(p,o),g=p[o];try{p[o]=void 0;var f=!0}catch{}var _=a.call(p);return f&&(h?p[o]=g:delete p[o]),_}t.exports=u}}),f4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_objectToString.js"(e,t){Y();var n=Object.prototype,r=n.toString;function i(a){return r.call(a)}t.exports=i}}),Zd=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseGetTag.js"(e,t){Y();var n=Wm(),r=p4(),i=f4(),a="[object Null]",o="[object Undefined]",u=n?n.toStringTag:void 0;function p(h){return h==null?h===void 0?o:a:u&&u in Object(h)?r(h):i(h)}t.exports=p}}),Wy=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObject.js"(e,t){Y();function n(r){var i=typeof r;return r!=null&&(i=="object"||i=="function")}t.exports=n}}),Gy=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isFunction.js"(e,t){Y();var n=Zd(),r=Wy(),i="[object AsyncFunction]",a="[object Function]",o="[object GeneratorFunction]",u="[object Proxy]";function p(h){if(!r(h))return!1;var g=n(h);return g==a||g==o||g==i||g==u}t.exports=p}}),m4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_coreJsData.js"(e,t){Y();var n=Cs(),r=n["__core-js_shared__"];t.exports=r}}),g4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isMasked.js"(e,t){Y();var n=m4(),r=function(){var a=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();function i(a){return!!r&&r in a}t.exports=i}}),Jy=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_toSource.js"(e,t){Y();var n=Function.prototype,r=n.toString;function i(a){if(a!=null){try{return r.call(a)}catch{}try{return a+""}catch{}}return""}t.exports=i}}),v4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsNative.js"(e,t){Y();var n=Gy(),r=g4(),i=Wy(),a=Jy(),o=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,p=Function.prototype,h=Object.prototype,g=p.toString,f=h.hasOwnProperty,_=RegExp("^"+g.call(f).replace(o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function w(C){if(!i(C)||r(C))return!1;var R=n(C)?_:u;return R.test(a(C))}t.exports=w}}),y4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getValue.js"(e,t){Y();function n(r,i){return r==null?void 0:r[i]}t.exports=n}}),Ho=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getNative.js"(e,t){Y();var n=v4(),r=y4();function i(a,o){var u=r(a,o);return n(u)?u:void 0}t.exports=i}}),Gm=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Map.js"(e,t){Y();var n=Ho(),r=Cs(),i=n(r,"Map");t.exports=i}}),Xd=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nativeCreate.js"(e,t){Y();var n=Ho(),r=n(Object,"create");t.exports=r}}),_4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashClear.js"(e,t){Y();var n=Xd();function r(){this.__data__=n?n(null):{},this.size=0}t.exports=r}}),b4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashDelete.js"(e,t){Y();function n(r){var i=this.has(r)&&delete this.__data__[r];return this.size-=i?1:0,i}t.exports=n}}),S4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashGet.js"(e,t){Y();var n=Xd(),r="__lodash_hash_undefined__",i=Object.prototype,a=i.hasOwnProperty;function o(u){var p=this.__data__;if(n){var h=p[u];return h===r?void 0:h}return a.call(p,u)?p[u]:void 0}t.exports=o}}),w4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashHas.js"(e,t){Y();var n=Xd(),r=Object.prototype,i=r.hasOwnProperty;function a(o){var u=this.__data__;return n?u[o]!==void 0:i.call(u,o)}t.exports=a}}),x4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashSet.js"(e,t){Y();var n=Xd(),r="__lodash_hash_undefined__";function i(a,o){var u=this.__data__;return this.size+=this.has(a)?0:1,u[a]=n&&o===void 0?r:o,this}t.exports=i}}),C4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Hash.js"(e,t){Y();var n=_4(),r=b4(),i=S4(),a=w4(),o=x4();function u(p){var h=-1,g=p==null?0:p.length;for(this.clear();++h<g;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),E4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheClear.js"(e,t){Y();var n=C4(),r=Jd(),i=Gm();function a(){this.size=0,this.__data__={hash:new n,map:new(i||r),string:new n}}t.exports=a}}),P4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isKeyable.js"(e,t){Y();function n(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}t.exports=n}}),Qd=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getMapData.js"(e,t){Y();var n=P4();function r(i,a){var o=i.__data__;return n(a)?o[typeof a=="string"?"string":"hash"]:o.map}t.exports=r}}),k4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheDelete.js"(e,t){Y();var n=Qd();function r(i){var a=n(this,i).delete(i);return this.size-=a?1:0,a}t.exports=r}}),T4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheGet.js"(e,t){Y();var n=Qd();function r(i){return n(this,i).get(i)}t.exports=r}}),R4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheHas.js"(e,t){Y();var n=Qd();function r(i){return n(this,i).has(i)}t.exports=r}}),A4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheSet.js"(e,t){Y();var n=Qd();function r(i,a){var o=n(this,i),u=o.size;return o.set(i,a),this.size+=o.size==u?0:1,this}t.exports=r}}),Zy=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_MapCache.js"(e,t){Y();var n=E4(),r=k4(),i=T4(),a=R4(),o=A4();function u(p){var h=-1,g=p==null?0:p.length;for(this.clear();++h<g;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),I4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackSet.js"(e,t){Y();var n=Jd(),r=Gm(),i=Zy(),a=200;function o(u,p){var h=this.__data__;if(h instanceof n){var g=h.__data__;if(!r||g.length<a-1)return g.push([u,p]),this.size=++h.size,this;h=this.__data__=new i(g)}return h.set(u,p),this.size=h.size,this}t.exports=o}}),F4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Stack.js"(e,t){Y();var n=Jd(),r=l4(),i=u4(),a=d4(),o=h4(),u=I4();function p(h){var g=this.__data__=new n(h);this.size=g.size}p.prototype.clear=r,p.prototype.delete=i,p.prototype.get=a,p.prototype.has=o,p.prototype.set=u,t.exports=p}}),D4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setCacheAdd.js"(e,t){Y();var n="__lodash_hash_undefined__";function r(i){return this.__data__.set(i,n),this}t.exports=r}}),N4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setCacheHas.js"(e,t){Y();function n(r){return this.__data__.has(r)}t.exports=n}}),O4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_SetCache.js"(e,t){Y();var n=Zy(),r=D4(),i=N4();function a(o){var u=-1,p=o==null?0:o.length;for(this.__data__=new n;++u<p;)this.add(o[u])}a.prototype.add=a.prototype.push=r,a.prototype.has=i,t.exports=a}}),M4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arraySome.js"(e,t){Y();function n(r,i){for(var a=-1,o=r==null?0:r.length;++a<o;)if(i(r[a],a,r))return!0;return!1}t.exports=n}}),L4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_cacheHas.js"(e,t){Y();function n(r,i){return r.has(i)}t.exports=n}}),Xy=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalArrays.js"(e,t){Y();var n=O4(),r=M4(),i=L4(),a=1,o=2;function u(p,h,g,f,_,w){var C=g&a,R=p.length,S=h.length;if(R!=S&&!(C&&S>R))return!1;var b=w.get(p),x=w.get(h);if(b&&x)return b==h&&x==p;var E=-1,M=!0,Z=g&o?new n:void 0;for(w.set(p,h),w.set(h,p);++E<R;){var $=p[E],z=h[E];if(f)var q=C?f(z,$,E,h,p,w):f($,z,E,p,h,w);if(q!==void 0){if(q)continue;M=!1;break}if(Z){if(!r(h,function(Q,K){if(!i(Z,K)&&($===Q||_($,Q,g,f,w)))return Z.push(K)})){M=!1;break}}else if(!($===z||_($,z,g,f,w))){M=!1;break}}return w.delete(p),w.delete(h),M}t.exports=u}}),j4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Uint8Array.js"(e,t){Y();var n=Cs(),r=n.Uint8Array;t.exports=r}}),B4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapToArray.js"(e,t){Y();function n(r){var i=-1,a=Array(r.size);return r.forEach(function(o,u){a[++i]=[u,o]}),a}t.exports=n}}),U4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setToArray.js"(e,t){Y();function n(r){var i=-1,a=Array(r.size);return r.forEach(function(o){a[++i]=o}),a}t.exports=n}}),H4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalByTag.js"(e,t){Y();var n=Wm(),r=j4(),i=Ky(),a=Xy(),o=B4(),u=U4(),p=1,h=2,g="[object Boolean]",f="[object Date]",_="[object Error]",w="[object Map]",C="[object Number]",R="[object RegExp]",S="[object Set]",b="[object String]",x="[object Symbol]",E="[object ArrayBuffer]",M="[object DataView]",Z=n?n.prototype:void 0,$=Z?Z.valueOf:void 0;function z(q,Q,K,ee,ae,le,ne){switch(K){case M:if(q.byteLength!=Q.byteLength||q.byteOffset!=Q.byteOffset)return!1;q=q.buffer,Q=Q.buffer;case E:return!(q.byteLength!=Q.byteLength||!le(new r(q),new r(Q)));case g:case f:case C:return i(+q,+Q);case _:return q.name==Q.name&&q.message==Q.message;case R:case b:return q==Q+"";case w:var Re=o;case S:var ve=ee&p;if(Re||(Re=u),q.size!=Q.size&&!ve)return!1;var _e=ne.get(q);if(_e)return _e==Q;ee|=h,ne.set(q,Q);var we=a(Re(q),Re(Q),ee,ae,le,ne);return ne.delete(q),we;case x:if($)return $.call(q)==$.call(Q)}return!1}t.exports=z}}),V4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayPush.js"(e,t){Y();function n(r,i){for(var a=-1,o=i.length,u=r.length;++a<o;)r[u+a]=i[a];return r}t.exports=n}}),Jm=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArray.js"(e,t){Y();var n=Array.isArray;t.exports=n}}),q4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseGetAllKeys.js"(e,t){Y();var n=V4(),r=Jm();function i(a,o,u){var p=o(a);return r(a)?p:n(p,u(a))}t.exports=i}}),z4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayFilter.js"(e,t){Y();function n(r,i){for(var a=-1,o=r==null?0:r.length,u=0,p=[];++a<o;){var h=r[a];i(h,a,r)&&(p[u++]=h)}return p}t.exports=n}}),K4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/stubArray.js"(e,t){Y();function n(){return[]}t.exports=n}}),$4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getSymbols.js"(e,t){Y();var n=z4(),r=K4(),i=Object.prototype,a=i.propertyIsEnumerable,o=Object.getOwnPropertySymbols,u=o?function(p){return p==null?[]:(p=Object(p),n(o(p),function(h){return a.call(p,h)}))}:r;t.exports=u}}),W4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseTimes.js"(e,t){Y();function n(r,i){for(var a=-1,o=Array(r);++a<r;)o[a]=i(a);return o}t.exports=n}}),Yd=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObjectLike.js"(e,t){Y();function n(r){return r!=null&&typeof r=="object"}t.exports=n}}),G4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsArguments.js"(e,t){Y();var n=Zd(),r=Yd(),i="[object Arguments]";function a(o){return r(o)&&n(o)==i}t.exports=a}}),J4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArguments.js"(e,t){Y();var n=G4(),r=Yd(),i=Object.prototype,a=i.hasOwnProperty,o=i.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(p){return r(p)&&a.call(p,"callee")&&!o.call(p,"callee")};t.exports=u}}),Z4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/stubFalse.js"(e,t){Y();function n(){return!1}t.exports=n}}),Qy=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isBuffer.js"(e,t){Y();var n=Cs(),r=Z4(),i=typeof e=="object"&&e&&!e.nodeType&&e,a=i&&typeof t=="object"&&t&&!t.nodeType&&t,o=a&&a.exports===i,u=o?n.Buffer:void 0,p=u?u.isBuffer:void 0,h=p||r;t.exports=h}}),X4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isIndex.js"(e,t){Y();var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;function i(a,o){var u=typeof a;return o=o??n,!!o&&(u=="number"||u!="symbol"&&r.test(a))&&a>-1&&a%1==0&&a<o}t.exports=i}}),Yy=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isLength.js"(e,t){Y();var n=9007199254740991;function r(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=n}t.exports=r}}),Q4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsTypedArray.js"(e,t){Y();var n=Zd(),r=Yy(),i=Yd(),a="[object Arguments]",o="[object Array]",u="[object Boolean]",p="[object Date]",h="[object Error]",g="[object Function]",f="[object Map]",_="[object Number]",w="[object Object]",C="[object RegExp]",R="[object Set]",S="[object String]",b="[object WeakMap]",x="[object ArrayBuffer]",E="[object DataView]",M="[object Float32Array]",Z="[object Float64Array]",$="[object Int8Array]",z="[object Int16Array]",q="[object Int32Array]",Q="[object Uint8Array]",K="[object Uint8ClampedArray]",ee="[object Uint16Array]",ae="[object Uint32Array]",le={};le[M]=le[Z]=le[$]=le[z]=le[q]=le[Q]=le[K]=le[ee]=le[ae]=!0,le[a]=le[o]=le[x]=le[u]=le[E]=le[p]=le[h]=le[g]=le[f]=le[_]=le[w]=le[C]=le[R]=le[S]=le[b]=!1;function ne(Re){return i(Re)&&r(Re.length)&&!!le[n(Re)]}t.exports=ne}}),Y4=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseUnary.js"(e,t){Y();function n(r){return function(i){return r(i)}}t.exports=n}}),e3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nodeUtil.js"(e,t){Y();var n=$y(),r=typeof e=="object"&&e&&!e.nodeType&&e,i=r&&typeof t=="object"&&t&&!t.nodeType&&t,a=i&&i.exports===r,o=a&&n.process,u=function(){try{var p=i&&i.require&&i.require("util").types;return p||o&&o.binding&&o.binding("util")}catch{}}();t.exports=u}}),e_=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isTypedArray.js"(e,t){Y();var n=Q4(),r=Y4(),i=e3(),a=i&&i.isTypedArray,o=a?r(a):n;t.exports=o}}),t3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayLikeKeys.js"(e,t){Y();var n=W4(),r=J4(),i=Jm(),a=Qy(),o=X4(),u=e_(),p=Object.prototype,h=p.hasOwnProperty;function g(f,_){var w=i(f),C=!w&&r(f),R=!w&&!C&&a(f),S=!w&&!C&&!R&&u(f),b=w||C||R||S,x=b?n(f.length,String):[],E=x.length;for(var M in f)(_||h.call(f,M))&&!(b&&(M=="length"||R&&(M=="offset"||M=="parent")||S&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||o(M,E)))&&x.push(M);return x}t.exports=g}}),n3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isPrototype.js"(e,t){Y();var n=Object.prototype;function r(i){var a=i&&i.constructor,o=typeof a=="function"&&a.prototype||n;return i===o}t.exports=r}}),r3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_overArg.js"(e,t){Y();function n(r,i){return function(a){return r(i(a))}}t.exports=n}}),i3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nativeKeys.js"(e,t){Y();var n=r3(),r=n(Object.keys,Object);t.exports=r}}),s3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseKeys.js"(e,t){Y();var n=n3(),r=i3(),i=Object.prototype,a=i.hasOwnProperty;function o(u){if(!n(u))return r(u);var p=[];for(var h in Object(u))a.call(u,h)&&h!="constructor"&&p.push(h);return p}t.exports=o}}),a3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArrayLike.js"(e,t){Y();var n=Gy(),r=Yy();function i(a){return a!=null&&r(a.length)&&!n(a)}t.exports=i}}),o3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/keys.js"(e,t){Y();var n=t3(),r=s3(),i=a3();function a(o){return i(o)?n(o):r(o)}t.exports=a}}),c3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getAllKeys.js"(e,t){Y();var n=q4(),r=$4(),i=o3();function a(o){return n(o,i,r)}t.exports=a}}),l3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalObjects.js"(e,t){Y();var n=c3(),r=1,i=Object.prototype,a=i.hasOwnProperty;function o(u,p,h,g,f,_){var w=h&r,C=n(u),R=C.length,S=n(p),b=S.length;if(R!=b&&!w)return!1;for(var x=R;x--;){var E=C[x];if(!(w?E in p:a.call(p,E)))return!1}var M=_.get(u),Z=_.get(p);if(M&&Z)return M==p&&Z==u;var $=!0;_.set(u,p),_.set(p,u);for(var z=w;++x<R;){E=C[x];var q=u[E],Q=p[E];if(g)var K=w?g(Q,q,E,p,u,_):g(q,Q,E,u,p,_);if(!(K===void 0?q===Q||f(q,Q,h,g,_):K)){$=!1;break}z||(z=E=="constructor")}if($&&!z){var ee=u.constructor,ae=p.constructor;ee!=ae&&"constructor"in u&&"constructor"in p&&!(typeof ee=="function"&&ee instanceof ee&&typeof ae=="function"&&ae instanceof ae)&&($=!1)}return _.delete(u),_.delete(p),$}t.exports=o}}),u3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_DataView.js"(e,t){Y();var n=Ho(),r=Cs(),i=n(r,"DataView");t.exports=i}}),d3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Promise.js"(e,t){Y();var n=Ho(),r=Cs(),i=n(r,"Promise");t.exports=i}}),h3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Set.js"(e,t){Y();var n=Ho(),r=Cs(),i=n(r,"Set");t.exports=i}}),p3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_WeakMap.js"(e,t){Y();var n=Ho(),r=Cs(),i=n(r,"WeakMap");t.exports=i}}),f3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getTag.js"(e,t){Y();var n=u3(),r=Gm(),i=d3(),a=h3(),o=p3(),u=Zd(),p=Jy(),h="[object Map]",g="[object Object]",f="[object Promise]",_="[object Set]",w="[object WeakMap]",C="[object DataView]",R=p(n),S=p(r),b=p(i),x=p(a),E=p(o),M=u;(n&&M(new n(new ArrayBuffer(1)))!=C||r&&M(new r)!=h||i&&M(i.resolve())!=f||a&&M(new a)!=_||o&&M(new o)!=w)&&(M=function(Z){var $=u(Z),z=$==g?Z.constructor:void 0,q=z?p(z):"";if(q)switch(q){case R:return C;case S:return h;case b:return f;case x:return _;case E:return w}return $}),t.exports=M}}),m3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsEqualDeep.js"(e,t){Y();var n=F4(),r=Xy(),i=H4(),a=l3(),o=f3(),u=Jm(),p=Qy(),h=e_(),g=1,f="[object Arguments]",_="[object Array]",w="[object Object]",C=Object.prototype,R=C.hasOwnProperty;function S(b,x,E,M,Z,$){var z=u(b),q=u(x),Q=z?_:o(b),K=q?_:o(x);Q=Q==f?w:Q,K=K==f?w:K;var ee=Q==w,ae=K==w,le=Q==K;if(le&&p(b)){if(!p(x))return!1;z=!0,ee=!1}if(le&&!ee)return $||($=new n),z||h(b)?r(b,x,E,M,Z,$):i(b,x,Q,E,M,Z,$);if(!(E&g)){var ne=ee&&R.call(b,"__wrapped__"),Re=ae&&R.call(x,"__wrapped__");if(ne||Re){var ve=ne?b.value():b,_e=Re?x.value():x;return $||($=new n),Z(ve,_e,E,M,$)}}return le?($||($=new n),a(b,x,E,M,Z,$)):!1}t.exports=S}}),g3=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsEqual.js"(e,t){Y();var n=m3(),r=Yd();function i(a,o,u,p,h){return a===o?!0:a==null||o==null||!r(a)&&!r(o)?a!==a&&o!==o:n(a,o,u,p,i,h)}t.exports=i}}),t_=ke({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEqual.js"(e,t){Y();var n=g3();function r(i,a){return n(i,a)}t.exports=r}}),v3=ke({"../../node_modules/.pnpm/ms@2.1.3/node_modules/ms/index.js"(e,t){Y();var n=1e3,r=n*60,i=r*60,a=i*24,o=a*7,u=a*365.25;t.exports=function(_,w){w=w||{};var C=typeof _;if(C==="string"&&_.length>0)return p(_);if(C==="number"&&isFinite(_))return w.long?g(_):h(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function p(_){if(_=String(_),!(_.length>100)){var w=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(w){var C=parseFloat(w[1]),R=(w[2]||"ms").toLowerCase();switch(R){case"years":case"year":case"yrs":case"yr":case"y":return C*u;case"weeks":case"week":case"w":return C*o;case"days":case"day":case"d":return C*a;case"hours":case"hour":case"hrs":case"hr":case"h":return C*i;case"minutes":case"minute":case"mins":case"min":case"m":return C*r;case"seconds":case"second":case"secs":case"sec":case"s":return C*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return C;default:return}}}}function h(_){var w=Math.abs(_);return w>=a?Math.round(_/a)+"d":w>=i?Math.round(_/i)+"h":w>=r?Math.round(_/r)+"m":w>=n?Math.round(_/n)+"s":_+"ms"}function g(_){var w=Math.abs(_);return w>=a?f(_,w,a,"day"):w>=i?f(_,w,i,"hour"):w>=r?f(_,w,r,"minute"):w>=n?f(_,w,n,"second"):_+" ms"}function f(_,w,C,R){var S=w>=C*1.5;return Math.round(_/C)+" "+R+(S?"s":"")}}}),y3=ke({"../../node_modules/.pnpm/debug@4.4.1_supports-color@10.2.0/node_modules/debug/src/common.js"(e,t){Y();function n(r){a.debug=a,a.default=a,a.coerce=f,a.disable=h,a.enable=u,a.enabled=g,a.humanize=v3(),a.destroy=_,Object.keys(r).forEach(w=>{a[w]=r[w]}),a.names=[],a.skips=[],a.formatters={};function i(w){let C=0;for(let R=0;R<w.length;R++)C=(C<<5)-C+w.charCodeAt(R),C|=0;return a.colors[Math.abs(C)%a.colors.length]}a.selectColor=i;function a(w){let C,R=null,S,b;function x(...E){if(!x.enabled)return;const M=x,Z=Number(new Date),$=Z-(C||Z);M.diff=$,M.prev=C,M.curr=Z,C=Z,E[0]=a.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let z=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(Q,K)=>{if(Q==="%%")return"%";z++;const ee=a.formatters[K];if(typeof ee=="function"){const ae=E[z];Q=ee.call(M,ae),E.splice(z,1),z--}return Q}),a.formatArgs.call(M,E),(M.log||a.log).apply(M,E)}return x.namespace=w,x.useColors=a.useColors(),x.color=a.selectColor(w),x.extend=o,x.destroy=a.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>R!==null?R:(S!==a.namespaces&&(S=a.namespaces,b=a.enabled(w)),b),set:E=>{R=E}}),typeof a.init=="function"&&a.init(x),x}function o(w,C){const R=a(this.namespace+(typeof C>"u"?":":C)+w);return R.log=this.log,R}function u(w){a.save(w),a.namespaces=w,a.names=[],a.skips=[];const C=(typeof w=="string"?w:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const R of C)R[0]==="-"?a.skips.push(R.slice(1)):a.names.push(R)}function p(w,C){let R=0,S=0,b=-1,x=0;for(;R<w.length;)if(S<C.length&&(C[S]===w[R]||C[S]==="*"))C[S]==="*"?(b=S,x=R,S++):(R++,S++);else if(b!==-1)S=b+1,x++,R=x;else return!1;for(;S<C.length&&C[S]==="*";)S++;return S===C.length}function h(){const w=[...a.names,...a.skips.map(C=>"-"+C)].join(",");return a.enable(""),w}function g(w){for(const C of a.skips)if(p(w,C))return!1;for(const C of a.names)if(p(w,C))return!0;return!1}function f(w){return w instanceof Error?w.stack||w.message:w}function _(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}t.exports=n}}),eh=ke({"../../node_modules/.pnpm/debug@4.4.1_supports-color@10.2.0/node_modules/debug/src/browser.js"(e,t){Y(),e.formatArgs=r,e.save=i,e.load=a,e.useColors=n,e.storage=o(),e.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let p;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(p=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(p[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const h="color: "+this.color;p.splice(1,0,h,"color: inherit");let g=0,f=0;p[0].replace(/%[a-zA-Z%]/g,_=>{_!=="%%"&&(g++,_==="%c"&&(f=g))}),p.splice(f,0,h)}e.log=console.debug||console.log||(()=>{});function i(p){try{p?e.storage.setItem("debug",p):e.storage.removeItem("debug")}catch{}}function a(){let p;try{p=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!p&&typeof Co<"u"&&"env"in Co&&(p=Co.env.DEBUG),p}function o(){try{return localStorage}catch{}}t.exports=y3()(e);var{formatters:u}=t.exports;u.j=function(p){try{return JSON.stringify(p)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}}),_3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/types.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0})}}),Wr=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Logger.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var t=eh(),n="mediasoup-client",r=class{constructor(i){me(this,"_debug"),me(this,"_warn"),me(this,"_error"),i?(this._debug=(0,t.default)(`${n}:${i}`),this._warn=(0,t.default)(`${n}:WARN:${i}`),this._error=(0,t.default)(`${n}:ERROR:${i}`)):(this._debug=(0,t.default)(n),this._warn=(0,t.default)(`${n}:WARN`),this._error=(0,t.default)(`${n}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=r}}),b3=ke({"../../node_modules/.pnpm/events@3.3.0/node_modules/events/events.js"(e,t){Y();var n=typeof Reflect=="object"?Reflect:null,r=n&&typeof n.apply=="function"?n.apply:function(z,q,Q){return Function.prototype.apply.call(z,q,Q)},i;n&&typeof n.ownKeys=="function"?i=n.ownKeys:Object.getOwnPropertySymbols?i=function(z){return Object.getOwnPropertyNames(z).concat(Object.getOwnPropertySymbols(z))}:i=function(z){return Object.getOwnPropertyNames(z)};function a($){console&&console.warn&&console.warn($)}var o=Number.isNaN||function(z){return z!==z};function u(){u.init.call(this)}t.exports=u,t.exports.once=E,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var p=10;function h($){if(typeof $!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof $)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function($){if(typeof $!="number"||$<0||o($))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+$+".");p=$}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(z){if(typeof z!="number"||z<0||o(z))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+z+".");return this._maxListeners=z,this};function g($){return $._maxListeners===void 0?u.defaultMaxListeners:$._maxListeners}u.prototype.getMaxListeners=function(){return g(this)},u.prototype.emit=function(z){for(var q=[],Q=1;Q<arguments.length;Q++)q.push(arguments[Q]);var K=z==="error",ee=this._events;if(ee!==void 0)K=K&&ee.error===void 0;else if(!K)return!1;if(K){var ae;if(q.length>0&&(ae=q[0]),ae instanceof Error)throw ae;var le=new Error("Unhandled error."+(ae?" ("+ae.message+")":""));throw le.context=ae,le}var ne=ee[z];if(ne===void 0)return!1;if(typeof ne=="function")r(ne,this,q);else for(var Re=ne.length,ve=S(ne,Re),Q=0;Q<Re;++Q)r(ve[Q],this,q);return!0};function f($,z,q,Q){var K,ee,ae;if(h(q),ee=$._events,ee===void 0?(ee=$._events=Object.create(null),$._eventsCount=0):(ee.newListener!==void 0&&($.emit("newListener",z,q.listener?q.listener:q),ee=$._events),ae=ee[z]),ae===void 0)ae=ee[z]=q,++$._eventsCount;else if(typeof ae=="function"?ae=ee[z]=Q?[q,ae]:[ae,q]:Q?ae.unshift(q):ae.push(q),K=g($),K>0&&ae.length>K&&!ae.warned){ae.warned=!0;var le=new Error("Possible EventEmitter memory leak detected. "+ae.length+" "+String(z)+" listeners added. Use emitter.setMaxListeners() to increase limit");le.name="MaxListenersExceededWarning",le.emitter=$,le.type=z,le.count=ae.length,a(le)}return $}u.prototype.addListener=function(z,q){return f(this,z,q,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(z,q){return f(this,z,q,!0)};function _(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w($,z,q){var Q={fired:!1,wrapFn:void 0,target:$,type:z,listener:q},K=_.bind(Q);return K.listener=q,Q.wrapFn=K,K}u.prototype.once=function(z,q){return h(q),this.on(z,w(this,z,q)),this},u.prototype.prependOnceListener=function(z,q){return h(q),this.prependListener(z,w(this,z,q)),this},u.prototype.removeListener=function(z,q){var Q,K,ee,ae,le;if(h(q),K=this._events,K===void 0)return this;if(Q=K[z],Q===void 0)return this;if(Q===q||Q.listener===q)--this._eventsCount===0?this._events=Object.create(null):(delete K[z],K.removeListener&&this.emit("removeListener",z,Q.listener||q));else if(typeof Q!="function"){for(ee=-1,ae=Q.length-1;ae>=0;ae--)if(Q[ae]===q||Q[ae].listener===q){le=Q[ae].listener,ee=ae;break}if(ee<0)return this;ee===0?Q.shift():b(Q,ee),Q.length===1&&(K[z]=Q[0]),K.removeListener!==void 0&&this.emit("removeListener",z,le||q)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(z){var q,Q,K;if(Q=this._events,Q===void 0)return this;if(Q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Q[z]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete Q[z]),this;if(arguments.length===0){var ee=Object.keys(Q),ae;for(K=0;K<ee.length;++K)ae=ee[K],ae!=="removeListener"&&this.removeAllListeners(ae);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(q=Q[z],typeof q=="function")this.removeListener(z,q);else if(q!==void 0)for(K=q.length-1;K>=0;K--)this.removeListener(z,q[K]);return this};function C($,z,q){var Q=$._events;if(Q===void 0)return[];var K=Q[z];return K===void 0?[]:typeof K=="function"?q?[K.listener||K]:[K]:q?x(K):S(K,K.length)}u.prototype.listeners=function(z){return C(this,z,!0)},u.prototype.rawListeners=function(z){return C(this,z,!1)},u.listenerCount=function($,z){return typeof $.listenerCount=="function"?$.listenerCount(z):R.call($,z)},u.prototype.listenerCount=R;function R($){var z=this._events;if(z!==void 0){var q=z[$];if(typeof q=="function")return 1;if(q!==void 0)return q.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function S($,z){for(var q=new Array(z),Q=0;Q<z;++Q)q[Q]=$[Q];return q}function b($,z){for(;z+1<$.length;z++)$[z]=$[z+1];$.pop()}function x($){for(var z=new Array($.length),q=0;q<z.length;++q)z[q]=$[q].listener||$[q];return z}function E($,z){return new Promise(function(q,Q){function K(ae){$.removeListener(z,ee),Q(ae)}function ee(){typeof $.removeListener=="function"&&$.removeListener("error",K),q([].slice.call(arguments))}Z($,z,ee,{once:!0}),z!=="error"&&M($,K,{once:!0})})}function M($,z,q){typeof $.on=="function"&&Z($,"error",z,q)}function Z($,z,q,Q){if(typeof $.on=="function")Q.once?$.once(z,q):$.on(z,q);else if(typeof $.addEventListener=="function")$.addEventListener(z,function K(ee){Q.once&&$.removeEventListener(z,K),q(ee)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof $)}}}),ti=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/enhancedEvents.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.EnhancedEventEmitter=void 0;var t=b3(),n=Wr(),r=new n.Logger("EnhancedEventEmitter"),i=class extends t.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}close(){super.removeAllListeners()}emit(a,...o){return super.emit(a,...o)}safeEmit(a,...o){try{return super.emit(a,...o)}catch(u){r.error("safeEmit() | event listener threw an error [eventName:%s]:%o",a,u);try{super.emit("listenererror",a,u)}catch{}return!!super.listenerCount(a)}}on(a,o){return super.on(a,o),this}off(a,o){return super.off(a,o),this}addListener(a,o){return super.on(a,o),this}prependListener(a,o){return super.prependListener(a,o),this}once(a,o){return super.once(a,o),this}prependOnceListener(a,o){return super.prependOnceListener(a,o),this}removeListener(a,o){return super.off(a,o),this}removeAllListeners(a){return super.removeAllListeners(a),this}listenerCount(a){return super.listenerCount(a)}listeners(a){return super.listeners(a)}rawListeners(a){return super.rawListeners(a)}};e.EnhancedEventEmitter=i}}),Mi=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/errors.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidStateError=e.UnsupportedError=void 0;var t=class n_ extends Error{constructor(i){super(i),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,n_):this.stack=new Error(i).stack}};e.UnsupportedError=t;var n=class r_ extends Error{constructor(i){super(i),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,r_):this.stack=new Error(i).stack}};e.InvalidStateError=n}}),Vo=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.clone=t,e.generateRandomNumber=n,e.deepFreeze=r;function t(i){if(i!==void 0)return Number.isNaN(i)?NaN:typeof structuredClone=="function"?structuredClone(i):JSON.parse(JSON.stringify(i))}function n(){return Math.round(Math.random()*1e7)}function r(i){const a=Reflect.ownKeys(i);for(const o of a){const u=i[o];(u&&typeof u=="object"||typeof u=="function")&&r(u)}return Object.freeze(i)}}}),S3=ke({"../../node_modules/.pnpm/h264-profile-level-id@2.2.3_supports-color@10.2.0/node_modules/h264-profile-level-id/lib/Logger.js"(e){Y();var t=e&&e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var n=t(eh()),r="h264-profile-level-id",i=class{constructor(a){a?(this._debug=(0,n.default)(`${r}:${a}`),this._warn=(0,n.default)(`${r}:WARN:${a}`),this._error=(0,n.default)(`${r}:ERROR:${a}`)):(this._debug=(0,n.default)(r),this._warn=(0,n.default)(`${r}:WARN`),this._error=(0,n.default)(`${r}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=i}}),w3=ke({"../../node_modules/.pnpm/h264-profile-level-id@2.2.3_supports-color@10.2.0/node_modules/h264-profile-level-id/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.ProfileLevelId=e.Level=e.Profile=void 0,e.parseProfileLevelId=f,e.profileLevelIdToString=_,e.profileToString=w,e.levelToString=C,e.parseSdpProfileLevelId=R,e.isSameProfile=S,e.isSameProfileAndLevel=b,e.generateProfileLevelIdStringForAnswer=x,e.supportedLevel=E;var t=S3(),n=new t.Logger,r;(function(q){q[q.ConstrainedBaseline=1]="ConstrainedBaseline",q[q.Baseline=2]="Baseline",q[q.Main=3]="Main",q[q.ConstrainedHigh=4]="ConstrainedHigh",q[q.High=5]="High",q[q.PredictiveHigh444=6]="PredictiveHigh444"})(r||(e.Profile=r={}));var i;(function(q){q[q.L1_b=0]="L1_b",q[q.L1=10]="L1",q[q.L1_1=11]="L1_1",q[q.L1_2=12]="L1_2",q[q.L1_3=13]="L1_3",q[q.L2=20]="L2",q[q.L2_1=21]="L2_1",q[q.L2_2=22]="L2_2",q[q.L3=30]="L3",q[q.L3_1=31]="L3_1",q[q.L3_2=32]="L3_2",q[q.L4=40]="L4",q[q.L4_1=41]="L4_1",q[q.L4_2=42]="L4_2",q[q.L5=50]="L5",q[q.L5_1=51]="L5_1",q[q.L5_2=52]="L5_2"})(i||(e.Level=i={}));var a=class{constructor(q,Q){this.profile=q,this.level=Q}};e.ProfileLevelId=a;var o=new a(r.ConstrainedBaseline,i.L3_1),u=class{constructor(q){this.mask=~M("x",q),this.masked_value=M("1",q)}isMatch(q){return this.masked_value===(q&this.mask)}},p=class{constructor(q,Q,K){this.profile_idc=q,this.profile_iop=Q,this.profile=K}},h=[new p(66,new u("x1xx0000"),r.ConstrainedBaseline),new p(77,new u("1xxx0000"),r.ConstrainedBaseline),new p(88,new u("11xx0000"),r.ConstrainedBaseline),new p(66,new u("x0xx0000"),r.Baseline),new p(88,new u("10xx0000"),r.Baseline),new p(77,new u("0x0x0000"),r.Main),new p(100,new u("00000000"),r.High),new p(100,new u("00001100"),r.ConstrainedHigh),new p(244,new u("00000000"),r.PredictiveHigh444)],g=[{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:i.L1},{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:i.L1_b},{max_macroblocks_per_second:3e3,max_macroblock_frame_size:396,level:i.L1_1},{max_macroblocks_per_second:6e3,max_macroblock_frame_size:396,level:i.L1_2},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:i.L1_3},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:i.L2},{max_macroblocks_per_second:19800,max_macroblock_frame_size:792,level:i.L2_1},{max_macroblocks_per_second:20250,max_macroblock_frame_size:1620,level:i.L2_2},{max_macroblocks_per_second:40500,max_macroblock_frame_size:1620,level:i.L3},{max_macroblocks_per_second:108e3,max_macroblock_frame_size:3600,level:i.L3_1},{max_macroblocks_per_second:216e3,max_macroblock_frame_size:5120,level:i.L3_2},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:i.L4},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:i.L4_1},{max_macroblocks_per_second:522240,max_macroblock_frame_size:8704,level:i.L4_2},{max_macroblocks_per_second:589824,max_macroblock_frame_size:22080,level:i.L5},{max_macroblocks_per_second:983040,max_macroblock_frame_size:36864,level:i.L5_1},{max_macroblocks_per_second:2073600,max_macroblock_frame_size:36864,level:i.L5_2}];function f(q){if(typeof q!="string"||q.length!==6)return;const K=parseInt(q,16);if(K===0)return;const ee=K&255,ae=K>>8&255,le=K>>16&255;let ne;switch(ee){case i.L1_1:{ne=ae&16?i.L1_b:i.L1_1;break}case i.L1:case i.L1_2:case i.L1_3:case i.L2:case i.L2_1:case i.L2_2:case i.L3:case i.L3_1:case i.L3_2:case i.L4:case i.L4_1:case i.L4_2:case i.L5:case i.L5_1:case i.L5_2:{ne=ee;break}default:{n.warn(`parseProfileLevelId() | unrecognized level_idc [str:${q}, level_idc:${ee}]`);return}}for(const Re of h)if(le===Re.profile_idc&&Re.profile_iop.isMatch(ae))return n.debug(`parseProfileLevelId() | result [str:${q}, profile:${Re.profile}, level:${ne}]`),new a(Re.profile,ne);n.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${q}, profile_idc:${le}, profile_iop:${ae}]`)}function _(q){if(q.level==i.L1_b)switch(q.profile){case r.ConstrainedBaseline:return"42f00b";case r.Baseline:return"42100b";case r.Main:return"4d100b";default:{n.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${q.profile}`);return}}let Q;switch(q.profile){case r.ConstrainedBaseline:{Q="42e0";break}case r.Baseline:{Q="4200";break}case r.Main:{Q="4d00";break}case r.ConstrainedHigh:{Q="640c";break}case r.High:{Q="6400";break}case r.PredictiveHigh444:{Q="f400";break}default:{n.warn(`profileLevelIdToString() | unrecognized profile ${q.profile}`);return}}let K=q.level.toString(16);return K.length===1&&(K=`0${K}`),`${Q}${K}`}function w(q){switch(q){case r.ConstrainedBaseline:return"ConstrainedBaseline";case r.Baseline:return"Baseline";case r.Main:return"Main";case r.ConstrainedHigh:return"ConstrainedHigh";case r.High:return"High";case r.PredictiveHigh444:return"PredictiveHigh444";default:{n.warn(`profileToString() | unrecognized profile ${q}`);return}}}function C(q){switch(q){case i.L1_b:return"1b";case i.L1:return"1";case i.L1_1:return"1.1";case i.L1_2:return"1.2";case i.L1_3:return"1.3";case i.L2:return"2";case i.L2_1:return"2.1";case i.L2_2:return"2.2";case i.L3:return"3";case i.L3_1:return"3.1";case i.L3_2:return"3.2";case i.L4:return"4";case i.L4_1:return"4.1";case i.L4_2:return"4.2";case i.L5:return"5";case i.L5_1:return"5.1";case i.L5_2:return"5.2";default:{n.warn(`levelToString() | unrecognized level ${q}`);return}}}function R(q={}){const Q=q["profile-level-id"];return Q?f(Q):o}function S(q={},Q={}){const K=R(q),ee=R(Q);return!!(K&&ee&&K.profile===ee.profile)}function b(q={},Q={}){const K=R(q),ee=R(Q);return!!(K&&ee&&K.profile===ee.profile&&K.level==ee.level)}function x(q={},Q={}){if(!q["profile-level-id"]&&!Q["profile-level-id"]){n.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const K=R(q),ee=R(Q);if(!K)throw new TypeError("invalid local_profile_level_id");if(!ee)throw new TypeError("invalid remote_profile_level_id");if(K.profile!==ee.profile)throw new TypeError("H264 Profile mismatch");const ae=z(q)&&z(Q),le=K.level,ne=ee.level,Re=$(le,ne),ve=ae?le:Re;return n.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${K.profile}, level:${ve}]`),_(new a(K.profile,ve))}function E(q,Q){for(let ee=g.length-1;ee>=0;--ee){const ae=g[ee];if(ae.max_macroblock_frame_size*256<=q&&ae.max_macroblocks_per_second<=Q*ae.max_macroblock_frame_size)return n.debug(`supportedLevel() | result [max_frame_pixel_count:${q}, max_fps:${Q}, level:${ae.level}]`),ae.level}n.warn(`supportedLevel() | no level supported [max_frame_pixel_count:${q}, max_fps:${Q}]`)}function M(q,Q){return+(Q[0]===q)<<7|+(Q[1]===q)<<6|+(Q[2]===q)<<5|+(Q[3]===q)<<4|+(Q[4]===q)<<3|+(Q[5]===q)<<2|+(Q[6]===q)<<1|+(Q[7]===q)<<0}function Z(q,Q){return q===i.L1_b?Q!==i.L1&&Q!==i.L1_b:Q===i.L1_b?q!==i.L1:q<Q}function $(q,Q){return Z(q,Q)?q:Q}function z(q={}){const Q=q["level-asymmetry-allowed"];return Q===!0||Q===1||Q==="1"}}}),Es=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/ortc.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.validateRtpCapabilities=o,e.validateRtpParameters=u,e.validateSctpStreamParameters=p,e.validateSctpCapabilities=h,e.getExtendedRtpCapabilities=g,e.getRecvRtpCapabilities=f,e.getSendingRtpParameters=_,e.getSendingRemoteRtpParameters=w,e.reduceCodecs=C,e.generateProbatorRtpParameters=R,e.canSend=S,e.canReceive=b;var t=w3(),n=Vo(),r="probator",i=1234,a=127;function o(ne){if(typeof ne!="object")throw new TypeError("caps is not an object");if(ne.codecs&&!Array.isArray(ne.codecs))throw new TypeError("caps.codecs is not an array");ne.codecs||(ne.codecs=[]);for(const Re of ne.codecs)x(Re);if(ne.headerExtensions&&!Array.isArray(ne.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");ne.headerExtensions||(ne.headerExtensions=[]);for(const Re of ne.headerExtensions)M(Re)}function u(ne){if(typeof ne!="object")throw new TypeError("params is not an object");if(ne.mid&&typeof ne.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(ne.codecs))throw new TypeError("missing params.codecs");for(const Re of ne.codecs)Z(Re);if(ne.headerExtensions&&!Array.isArray(ne.headerExtensions))throw new TypeError("params.headerExtensions is not an array");ne.headerExtensions||(ne.headerExtensions=[]);for(const Re of ne.headerExtensions)$(Re);if(ne.encodings&&!Array.isArray(ne.encodings))throw new TypeError("params.encodings is not an array");ne.encodings||(ne.encodings=[]);for(const Re of ne.encodings)z(Re);if(ne.rtcp&&typeof ne.rtcp!="object")throw new TypeError("params.rtcp is not an object");ne.rtcp||(ne.rtcp={}),q(ne.rtcp)}function p(ne){if(typeof ne!="object")throw new TypeError("params is not an object");if(typeof ne.streamId!="number")throw new TypeError("missing params.streamId");let Re=!1;if(typeof ne.ordered=="boolean"?Re=!0:ne.ordered=!0,ne.maxPacketLifeTime&&typeof ne.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(ne.maxRetransmits&&typeof ne.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(ne.maxPacketLifeTime&&ne.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(Re&&ne.ordered&&(ne.maxPacketLifeTime||ne.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!Re&&(ne.maxPacketLifeTime||ne.maxRetransmits)&&(ne.ordered=!1),ne.label&&typeof ne.label!="string")throw new TypeError("invalid params.label");if(ne.protocol&&typeof ne.protocol!="string")throw new TypeError("invalid params.protocol")}function h(ne){if(typeof ne!="object")throw new TypeError("caps is not an object");if(!ne.numStreams||typeof ne.numStreams!="object")throw new TypeError("missing caps.numStreams");Q(ne.numStreams)}function g(ne,Re,ve){var _e,we,Ee,fe,ce,Ce,je,$e,et;const it={codecs:[],headerExtensions:[]};if(ve)for(const ze of(_e=ne.codecs)!=null?_e:[]){if(K(ze))continue;const Ge=((we=Re.codecs)!=null?we:[]).find(Je=>ee(Je,ze,{strict:!0,modify:!0}));if(!Ge)continue;const Le={kind:ze.kind,mimeType:ze.mimeType,clockRate:ze.clockRate,channels:ze.channels,localPayloadType:ze.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:Ge.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:(Ee=ze.parameters)!=null?Ee:{},remoteParameters:(fe=Ge.parameters)!=null?fe:{},rtcpFeedback:le(ze,Ge)};it.codecs.push(Le)}else for(const ze of(ce=Re.codecs)!=null?ce:[]){if(K(ze))continue;const Ge=((Ce=ne.codecs)!=null?Ce:[]).find(Je=>ee(Je,ze,{strict:!0,modify:!0}));if(!Ge)continue;const Le={kind:Ge.kind,mimeType:Ge.mimeType,clockRate:Ge.clockRate,channels:Ge.channels,localPayloadType:Ge.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:ze.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:(je=Ge.parameters)!=null?je:{},remoteParameters:($e=ze.parameters)!=null?$e:{},rtcpFeedback:le(Ge,ze)};it.codecs.push(Le)}for(const ze of it.codecs){const Ge=ne.codecs.find(Je=>{var Tt;return K(Je)&&((Tt=Je.parameters)==null?void 0:Tt.apt)===ze.localPayloadType}),Le=Re.codecs.find(Je=>{var Tt;return K(Je)&&((Tt=Je.parameters)==null?void 0:Tt.apt)===ze.remotePayloadType});Ge&&Le&&(ze.localRtxPayloadType=Ge.preferredPayloadType,ze.remoteRtxPayloadType=Le.preferredPayloadType)}for(const ze of Re.headerExtensions){const Ge=ne.headerExtensions.find(Je=>ae(Je,ze));if(!Ge)continue;const Le={kind:ze.kind,uri:ze.uri,sendId:Ge.preferredId,recvId:ze.preferredId,encrypt:(et=Ge.preferredEncrypt)!=null?et:!1,direction:"sendrecv"};switch(ze.direction){case"sendrecv":{Le.direction="sendrecv";break}case"recvonly":{Le.direction="sendonly";break}case"sendonly":{Le.direction="recvonly";break}case"inactive":{Le.direction="inactive";break}}it.headerExtensions.push(Le)}return it}function f(ne){var Re;const ve={codecs:[],headerExtensions:[]};for(const _e of ne.codecs){const we={kind:_e.kind,mimeType:_e.mimeType,preferredPayloadType:_e.remotePayloadType,clockRate:_e.clockRate,channels:_e.channels,parameters:_e.localParameters,rtcpFeedback:_e.rtcpFeedback};if(ve.codecs.push(we),!_e.remoteRtxPayloadType)continue;const Ee={kind:_e.kind,mimeType:`${_e.kind}/rtx`,preferredPayloadType:_e.remoteRtxPayloadType,clockRate:_e.clockRate,parameters:{apt:_e.remotePayloadType},rtcpFeedback:[]};ve.codecs.push(Ee)}for(const _e of ne.headerExtensions){if(_e.direction!=="sendrecv"&&_e.direction!=="recvonly")continue;const we={kind:_e.kind,uri:_e.uri,preferredId:_e.recvId,preferredEncrypt:(Re=_e.encrypt)!=null?Re:!1,direction:_e.direction};ve.headerExtensions.push(we)}return ve}function _(ne,Re){const ve={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const _e of Re.codecs){if(_e.kind!==ne)continue;const we={mimeType:_e.mimeType,payloadType:_e.localPayloadType,clockRate:_e.clockRate,channels:_e.channels,parameters:_e.localParameters,rtcpFeedback:_e.rtcpFeedback};if(ve.codecs.push(we),_e.localRtxPayloadType){const Ee={mimeType:`${_e.kind}/rtx`,payloadType:_e.localRtxPayloadType,clockRate:_e.clockRate,parameters:{apt:_e.localPayloadType},rtcpFeedback:[]};ve.codecs.push(Ee)}}for(const _e of Re.headerExtensions){if(_e.kind&&_e.kind!==ne||_e.direction!=="sendrecv"&&_e.direction!=="sendonly")continue;const we={uri:_e.uri,id:_e.sendId,encrypt:_e.encrypt,parameters:{}};ve.headerExtensions.push(we)}return ve}function w(ne,Re){var ve,_e,we;const Ee={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const fe of Re.codecs){if(fe.kind!==ne)continue;const ce={mimeType:fe.mimeType,payloadType:fe.localPayloadType,clockRate:fe.clockRate,channels:fe.channels,parameters:fe.remoteParameters,rtcpFeedback:fe.rtcpFeedback};if(Ee.codecs.push(ce),fe.localRtxPayloadType){const Ce={mimeType:`${fe.kind}/rtx`,payloadType:fe.localRtxPayloadType,clockRate:fe.clockRate,parameters:{apt:fe.localPayloadType},rtcpFeedback:[]};Ee.codecs.push(Ce)}}for(const fe of Re.headerExtensions){if(fe.kind&&fe.kind!==ne||fe.direction!=="sendrecv"&&fe.direction!=="sendonly")continue;const ce={uri:fe.uri,id:fe.sendId,encrypt:fe.encrypt,parameters:{}};Ee.headerExtensions.push(ce)}if(Ee.headerExtensions.some(fe=>fe.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const fe of Ee.codecs)fe.rtcpFeedback=((ve=fe.rtcpFeedback)!=null?ve:[]).filter(ce=>ce.type!=="goog-remb");else if(Ee.headerExtensions.some(fe=>fe.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const fe of Ee.codecs)fe.rtcpFeedback=((_e=fe.rtcpFeedback)!=null?_e:[]).filter(ce=>ce.type!=="transport-cc");else for(const fe of Ee.codecs)fe.rtcpFeedback=((we=fe.rtcpFeedback)!=null?we:[]).filter(ce=>ce.type!=="transport-cc"&&ce.type!=="goog-remb");return Ee}function C(ne,Re){const ve=[];if(!Re)ve.push(ne[0]),K(ne[1])&&ve.push(ne[1]);else{for(let _e=0;_e<ne.length;++_e)if(ee(ne[_e],Re,{strict:!0})){ve.push(ne[_e]),K(ne[_e+1])&&ve.push(ne[_e+1]);break}if(ve.length===0)throw new TypeError("no matching codec found")}return ve}function R(ne){ne=n.clone(ne),u(ne);const Re={mid:r,codecs:[],headerExtensions:[],encodings:[{ssrc:i}],rtcp:{cname:"probator"}};return Re.codecs.push(ne.codecs[0]),Re.codecs[0].payloadType=a,Re.headerExtensions=ne.headerExtensions,Re}function S(ne,Re){var ve;return((ve=Re.codecs)!=null?ve:[]).some(_e=>_e.kind===ne)}function b(ne,Re){var ve;if(u(ne),ne.codecs.length===0)return!1;const _e=ne.codecs[0];return((ve=Re.codecs)!=null?ve:[]).some(we=>we.preferredPayloadType===_e.payloadType)}function x(ne){const Re=new RegExp("^(audio|video)/(.+)","i");if(typeof ne!="object")throw new TypeError("codec is not an object");if(!ne.mimeType||typeof ne.mimeType!="string")throw new TypeError("missing codec.mimeType");const ve=Re.exec(ne.mimeType);if(!ve)throw new TypeError("invalid codec.mimeType");if(ne.kind=ve[1].toLowerCase(),typeof ne.preferredPayloadType!="number")throw new TypeError("missing codec.preferredPayloadType");if(typeof ne.clockRate!="number")throw new TypeError("missing codec.clockRate");ne.kind==="audio"?typeof ne.channels!="number"&&(ne.channels=1):delete ne.channels,(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const _e of Object.keys(ne.parameters)){let we=ne.parameters[_e];if(we===void 0&&(ne.parameters[_e]="",we=""),typeof we!="string"&&typeof we!="number")throw new TypeError(`invalid codec parameter [key:${_e}s, value:${we}]`);if(_e==="apt"&&typeof we!="number")throw new TypeError("invalid codec apt parameter")}(!ne.rtcpFeedback||!Array.isArray(ne.rtcpFeedback))&&(ne.rtcpFeedback=[]);for(const _e of ne.rtcpFeedback)E(_e)}function E(ne){if(typeof ne!="object")throw new TypeError("fb is not an object");if(!ne.type||typeof ne.type!="string")throw new TypeError("missing fb.type");(!ne.parameter||typeof ne.parameter!="string")&&(ne.parameter="")}function M(ne){if(typeof ne!="object")throw new TypeError("ext is not an object");if(ne.kind!=="audio"&&ne.kind!=="video")throw new TypeError("invalid ext.kind");if(!ne.uri||typeof ne.uri!="string")throw new TypeError("missing ext.uri");if(typeof ne.preferredId!="number")throw new TypeError("missing ext.preferredId");if(ne.preferredEncrypt&&typeof ne.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(ne.preferredEncrypt||(ne.preferredEncrypt=!1),ne.direction&&typeof ne.direction!="string")throw new TypeError("invalid ext.direction");ne.direction||(ne.direction="sendrecv")}function Z(ne){const Re=new RegExp("^(audio|video)/(.+)","i");if(typeof ne!="object")throw new TypeError("codec is not an object");if(!ne.mimeType||typeof ne.mimeType!="string")throw new TypeError("missing codec.mimeType");const ve=Re.exec(ne.mimeType);if(!ve)throw new TypeError("invalid codec.mimeType");if(typeof ne.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof ne.clockRate!="number")throw new TypeError("missing codec.clockRate");ve[1].toLowerCase()==="audio"?typeof ne.channels!="number"&&(ne.channels=1):delete ne.channels,(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const we of Object.keys(ne.parameters)){let Ee=ne.parameters[we];if(Ee===void 0&&(ne.parameters[we]="",Ee=""),typeof Ee!="string"&&typeof Ee!="number")throw new TypeError(`invalid codec parameter [key:${we}s, value:${Ee}]`);if(we==="apt"&&typeof Ee!="number")throw new TypeError("invalid codec apt parameter")}(!ne.rtcpFeedback||!Array.isArray(ne.rtcpFeedback))&&(ne.rtcpFeedback=[]);for(const we of ne.rtcpFeedback)E(we)}function $(ne){if(typeof ne!="object")throw new TypeError("ext is not an object");if(!ne.uri||typeof ne.uri!="string")throw new TypeError("missing ext.uri");if(typeof ne.id!="number")throw new TypeError("missing ext.id");if(ne.encrypt&&typeof ne.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");ne.encrypt||(ne.encrypt=!1),(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const Re of Object.keys(ne.parameters)){let ve=ne.parameters[Re];if(ve===void 0&&(ne.parameters[Re]="",ve=""),typeof ve!="string"&&typeof ve!="number")throw new TypeError("invalid header extension parameter")}}function z(ne){if(typeof ne!="object")throw new TypeError("encoding is not an object");if(ne.ssrc&&typeof ne.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(ne.rid&&typeof ne.rid!="string")throw new TypeError("invalid encoding.rid");if(ne.rtx&&typeof ne.rtx!="object")throw new TypeError("invalid encoding.rtx");if(ne.rtx&&typeof ne.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!ne.dtx||typeof ne.dtx!="boolean")&&(ne.dtx=!1),ne.scalabilityMode&&typeof ne.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function q(ne){if(typeof ne!="object")throw new TypeError("rtcp is not an object");if(ne.cname&&typeof ne.cname!="string")throw new TypeError("invalid rtcp.cname");(!ne.reducedSize||typeof ne.reducedSize!="boolean")&&(ne.reducedSize=!0)}function Q(ne){if(typeof ne!="object")throw new TypeError("numStreams is not an object");if(typeof ne.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof ne.MIS!="number")throw new TypeError("missing numStreams.MIS")}function K(ne){return ne?/.+\/rtx$/i.test(ne.mimeType):!1}function ee(ne,Re,{strict:ve=!1,modify:_e=!1}={}){var we,Ee,fe,ce;const Ce=ne.mimeType.toLowerCase(),je=Re.mimeType.toLowerCase();if(Ce!==je||ne.clockRate!==Re.clockRate||ne.channels!==Re.channels)return!1;switch(Ce){case"video/h264":{if(ve){const $e=(we=ne.parameters["packetization-mode"])!=null?we:0,et=(Ee=Re.parameters["packetization-mode"])!=null?Ee:0;if($e!==et||!t.isSameProfile(ne.parameters,Re.parameters))return!1;let it;try{it=t.generateProfileLevelIdStringForAnswer(ne.parameters,Re.parameters)}catch{return!1}_e&&(it?(ne.parameters["profile-level-id"]=it,Re.parameters["profile-level-id"]=it):(delete ne.parameters["profile-level-id"],delete Re.parameters["profile-level-id"]))}break}case"video/vp9":{if(ve){const $e=(fe=ne.parameters["profile-id"])!=null?fe:0,et=(ce=Re.parameters["profile-id"])!=null?ce:0;if($e!==et)return!1}break}}return!0}function ae(ne,Re){return!(ne.kind&&Re.kind&&ne.kind!==Re.kind||ne.uri!==Re.uri)}function le(ne,Re){var ve,_e;const we=[];for(const Ee of(ve=ne.rtcpFeedback)!=null?ve:[]){const fe=((_e=Re.rtcpFeedback)!=null?_e:[]).find(ce=>ce.type===Ee.type&&(ce.parameter===Ee.parameter||!ce.parameter&&!Ee.parameter));fe&&we.push(fe)}return we}}}),x3=ke({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/Logger.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var t=eh(),n="awaitqueue",r=class{constructor(i){me(this,"_debug"),me(this,"_warn"),me(this,"_error"),i?(this._debug=t(`${n}:${i}`),this._warn=t(`${n}:WARN:${i}`),this._error=t(`${n}:ERROR:${i}`)):(this._debug=t(n),this._warn=t(`${n}:WARN`),this._error=t(`${n}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=r}}),i_=ke({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/errors.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=void 0;var t=class s_ extends Error{constructor(i){super(i??"queue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,s_)}};e.AwaitQueueStoppedError=t;var n=class a_ extends Error{constructor(i){super(i??"queue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,a_)}};e.AwaitQueueRemovedTaskError=n}}),C3=ke({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/AwaitQueue.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueue=void 0;var t=x3(),n=i_(),r=new t.Logger("AwaitQueue"),i=class{constructor(){me(this,"pendingTasks",new Map),me(this,"nextTaskId",0),me(this,"stopping",!1),r.debug("constructor()")}get size(){return this.pendingTasks.size}push(a,o){return H(this,null,function*(){if(o=o??a.name,r.debug(`push() [name:${o}]`),typeof a!="function")throw new TypeError("given task is not a function");if(o)try{Object.defineProperty(a,"name",{value:o})}catch{}return new Promise((u,p)=>{const h={id:this.nextTaskId++,task:a,name:o,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:g=>{if(h.completed)return;h.completed=!0,this.pendingTasks.delete(h.id),r.debug(`resolving task [name:${h.name}]`),u(g);const[f]=this.pendingTasks.values();f&&!f.executedAt&&this.execute(f)},reject:g=>{if(!h.completed&&(h.completed=!0,this.pendingTasks.delete(h.id),r.debug(`rejecting task [name:${h.name}]: %s`,String(g)),p(g),!this.stopping)){const[f]=this.pendingTasks.values();f&&!f.executedAt&&this.execute(f)}}};this.pendingTasks.set(h.id,h),this.pendingTasks.size===1&&this.execute(h)})})}stop(){r.debug("stop()"),this.stopping=!0;for(const a of this.pendingTasks.values())r.debug(`stop() | stopping task [name:${a.name}]`),a.reject(new n.AwaitQueueStoppedError);this.stopping=!1}remove(a){r.debug(`remove() [taskIdx:${a}]`);const o=Array.from(this.pendingTasks.values())[a];if(!o){r.debug(`stop() | no task with given idx [taskIdx:${a}]`);return}o.reject(new n.AwaitQueueRemovedTaskError)}dump(){const a=Date.now();let o=0;return Array.from(this.pendingTasks.values()).map(u=>({idx:o++,task:u.task,name:u.name,enqueuedTime:u.executedAt?u.executedAt-u.enqueuedAt:a-u.enqueuedAt,executionTime:u.executedAt?a-u.executedAt:0}))}execute(a){return H(this,null,function*(){if(r.debug(`execute() [name:${a.name}]`),a.executedAt)throw new Error("task already being executed");a.executedAt=Date.now();try{const o=yield a.task();a.resolve(o)}catch(o){a.reject(o)}})}};e.AwaitQueue=i}}),E3=ke({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=e.AwaitQueue=void 0;var t=C3();Object.defineProperty(e,"AwaitQueue",{enumerable:!0,get:function(){return t.AwaitQueue}});var n=i_();Object.defineProperty(e,"AwaitQueueStoppedError",{enumerable:!0,get:function(){return n.AwaitQueueStoppedError}}),Object.defineProperty(e,"AwaitQueueRemovedTaskError",{enumerable:!0,get:function(){return n.AwaitQueueRemovedTaskError}})}}),P3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Producer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Producer=void 0;var t=Wr(),n=ti(),r=Mi(),i=new t.Logger("Producer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,localId:u,rtpSender:p,track:h,rtpParameters:g,stopTracks:f,disableTrackOnPause:_,zeroRtpOnPause:w,appData:C}){super(),me(this,"_id"),me(this,"_localId"),me(this,"_closed",!1),me(this,"_rtpSender"),me(this,"_track"),me(this,"_kind"),me(this,"_rtpParameters"),me(this,"_paused"),me(this,"_maxSpatialLayer"),me(this,"_stopTracks"),me(this,"_disableTrackOnPause"),me(this,"_zeroRtpOnPause"),me(this,"_appData"),me(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._localId=u,this._rtpSender=p,this._track=h,this._kind=h.kind,this._rtpParameters=g,this._paused=_?!h.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=f,this._disableTrackOnPause=_,this._zeroRtpOnPause=w,this._appData=C??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}getStats(){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");return new Promise((o,u)=>{this.safeEmit("@getstats",o,u)})})}pause(){if(i.debug("pause()"),this._closed){i.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((o,u)=>{this.safeEmit("@pause",o,u)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(i.debug("resume()"),this._closed){i.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((o,u)=>{this.safeEmit("@resume",o,u)}).catch(()=>{}),this._observer.safeEmit("resume")}replaceTrack(o){return H(this,arguments,function*({track:u}){if(i.debug("replaceTrack() [track:%o]",u),this._closed){if(u&&this._stopTracks)try{u.stop()}catch{}throw new r.InvalidStateError("closed")}else if(u&&u.readyState==="ended")throw new r.InvalidStateError("track ended");if(u===this._track){i.debug("replaceTrack() | same track, ignored");return}yield new Promise((p,h)=>{this.safeEmit("@replacetrack",u,p,h)}),this.destroyTrack(),this._track=u,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()})}setMaxSpatialLayer(o){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");if(this._kind!=="video")throw new r.UnsupportedError("not a video Producer");if(typeof o!="number")throw new TypeError("invalid spatialLayer");o!==this._maxSpatialLayer&&(yield new Promise((u,p)=>{this.safeEmit("@setmaxspatiallayer",o,u,p)}).catch(()=>{}),this._maxSpatialLayer=o)})}setRtpEncodingParameters(o){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");if(typeof o!="object")throw new TypeError("invalid params");yield new Promise((u,p)=>{this.safeEmit("@setrtpencodingparameters",o,u,p)})})}onTrackEnded(){i.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}};e.Producer=a}}),k3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Consumer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Consumer=void 0;var t=Wr(),n=ti(),r=Mi(),i=new t.Logger("Consumer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,localId:u,producerId:p,rtpReceiver:h,track:g,rtpParameters:f,appData:_}){super(),me(this,"_id"),me(this,"_localId"),me(this,"_producerId"),me(this,"_closed",!1),me(this,"_rtpReceiver"),me(this,"_track"),me(this,"_rtpParameters"),me(this,"_paused"),me(this,"_appData"),me(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._localId=u,this._producerId=p,this._rtpReceiver=h,this._track=g,this._rtpParameters=f,this._paused=!g.enabled,this._appData=_??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}getStats(){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");return new Promise((o,u)=>{this.safeEmit("@getstats",o,u)})})}pause(){if(i.debug("pause()"),this._closed){i.error("pause() | Consumer closed");return}if(this._paused){i.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(i.debug("resume()"),this._closed){i.error("resume() | Consumer closed");return}if(!this._paused){i.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){i.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}};e.Consumer=a}}),T3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/DataProducer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataProducer=void 0;var t=Wr(),n=ti(),r=Mi(),i=new t.Logger("DataProducer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,dataChannel:u,sctpStreamParameters:p,appData:h}){super(),me(this,"_id"),me(this,"_dataChannel"),me(this,"_closed",!1),me(this,"_sctpStreamParameters"),me(this,"_appData"),me(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._dataChannel=u,this._sctpStreamParameters=p,this._appData=h??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(o){this._dataChannel.bufferedAmountLowThreshold=o}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(o){if(i.debug("send()"),this._closed)throw new r.InvalidStateError("closed");this._dataChannel.send(o)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(i.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",o=>{var u,p,h;if(this._closed)return;const g=(u=o.error)!=null?u:new Error("unknown DataChannel error");((p=o.error)==null?void 0:p.errorDetail)==="sctp-failure"?i.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",(h=o.error)==null?void 0:h.sctpCauseCode,o.error.message):i.error('DataChannel "error" event: %o',g),this.safeEmit("error",g)}),this._dataChannel.addEventListener("close",()=>{this._closed||(i.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||i.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}};e.DataProducer=a}}),R3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/DataConsumer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataConsumer=void 0;var t=Wr(),n=ti(),r=new t.Logger("DataConsumer"),i=class extends n.EnhancedEventEmitter{constructor({id:a,dataProducerId:o,dataChannel:u,sctpStreamParameters:p,appData:h}){super(),me(this,"_id"),me(this,"_dataProducerId"),me(this,"_dataChannel"),me(this,"_closed",!1),me(this,"_sctpStreamParameters"),me(this,"_appData"),me(this,"_observer",new n.EnhancedEventEmitter),r.debug("constructor()"),this._id=a,this._dataProducerId=o,this._dataChannel=u,this._sctpStreamParameters=p,this._appData=h??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(a){this._dataChannel.binaryType=a}get appData(){return this._appData}set appData(a){this._appData=a}get observer(){return this._observer}close(){this._closed||(r.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(r.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(r.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",a=>{var o,u,p;if(this._closed)return;const h=(o=a.error)!=null?o:new Error("unknown DataChannel error");((u=a.error)==null?void 0:u.errorDetail)==="sctp-failure"?r.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",(p=a.error)==null?void 0:p.sctpCauseCode,a.error.message):r.error('DataChannel "error" event: %o',h),this.safeEmit("error",h)}),this._dataChannel.addEventListener("close",()=>{this._closed||(r.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",a=>{this._closed||this.safeEmit("message",a.data)})}};e.DataConsumer=i}}),A3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Transport.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Transport=void 0;var t=E3(),n=Wr(),r=ti(),i=Mi(),a=Vo(),o=Es(),u=P3(),p=k3(),h=T3(),g=R3(),f=new n.Logger("Transport"),_=class{constructor(C){me(this,"consumerOptions"),me(this,"promise"),me(this,"resolve"),me(this,"reject"),this.consumerOptions=C,this.promise=new Promise((R,S)=>{this.resolve=R,this.reject=S})}},w=class extends r.EnhancedEventEmitter{constructor({direction:C,id:R,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:$,appData:z,handlerFactory:q,getSendExtendedRtpCapabilities:Q,recvRtpCapabilities:K,canProduceByKind:ee}){var ae;super(),me(this,"_id"),me(this,"_closed",!1),me(this,"_direction"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_recvRtpCapabilities"),me(this,"_canProduceByKind"),me(this,"_maxSctpMessageSize"),me(this,"_handler"),me(this,"_iceGatheringState","new"),me(this,"_connectionState","new"),me(this,"_appData"),me(this,"_producers",new Map),me(this,"_consumers",new Map),me(this,"_dataProducers",new Map),me(this,"_dataConsumers",new Map),me(this,"_probatorConsumerCreated",!1),me(this,"_awaitQueue",new t.AwaitQueue),me(this,"_pendingConsumerTasks",[]),me(this,"_consumerCreationInProgress",!1),me(this,"_pendingPauseConsumers",new Map),me(this,"_consumerPauseInProgress",!1),me(this,"_pendingResumeConsumers",new Map),me(this,"_consumerResumeInProgress",!1),me(this,"_pendingCloseConsumers",new Map),me(this,"_consumerCloseInProgress",!1),me(this,"_observer",new r.EnhancedEventEmitter),f.debug("constructor() [id:%s, direction:%s]",R,C),this._id=R,this._direction=C,this._getSendExtendedRtpCapabilities=Q,this._recvRtpCapabilities=K,this._canProduceByKind=ee,this._maxSctpMessageSize=E?E.maxMessageSize:null;const le=(ae=a.clone($))!=null?ae:{};delete le.iceServers,delete le.iceTransportPolicy,delete le.bundlePolicy,delete le.rtcpMuxPolicy,this._handler=q.factory({direction:C,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:le,getSendExtendedRtpCapabilities:this._getSendExtendedRtpCapabilities}),this._appData=z??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(C){this._appData=C}get observer(){return this._observer}close(){if(!this._closed){f.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const C of this._producers.values())C.transportClosed();this._producers.clear();for(const C of this._consumers.values())C.transportClosed();this._consumers.clear();for(const C of this._dataProducers.values())C.transportClosed();this._dataProducers.clear();for(const C of this._dataConsumers.values())C.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close"),super.close(),this._observer.close()}}getStats(){return H(this,null,function*(){if(this._closed)throw new i.InvalidStateError("closed");return this._handler.getTransportStats()})}restartIce(C){return H(this,arguments,function*({iceParameters:R}){if(f.debug("restartIce()"),this._closed)throw new i.InvalidStateError("closed");if(!R)throw new TypeError("missing iceParameters");return this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.restartIce(R)}),"transport.restartIce()")})}updateIceServers(){return H(this,arguments,function*({iceServers:C}={}){if(f.debug("updateIceServers()"),this._closed)throw new i.InvalidStateError("closed");if(!Array.isArray(C))throw new TypeError("missing iceServers");return this._awaitQueue.push(()=>H(this,null,function*(){return this._handler.updateIceServers(C)}),"transport.updateIceServers()")})}produce(){return H(this,arguments,function*({track:C,encodings:R,codecOptions:S,codec:b,stopTracks:x=!0,disableTrackOnPause:E=!0,zeroRtpOnPause:M=!1,onRtpSender:Z,appData:$={}}={}){if(f.debug("produce() [track:%o]",C),this._closed)throw new i.InvalidStateError("closed");if(C){if(this._direction!=="send")throw new i.UnsupportedError("not a sending Transport");if(this._canProduceByKind[C.kind]){if(C.readyState==="ended")throw new i.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if($&&typeof $!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError(`cannot produce ${C.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(()=>H(this,null,function*(){let z;if(R&&!Array.isArray(R))throw TypeError("encodings must be an array");R&&R.length===0?z=void 0:R&&(z=R.map(ee=>{const ae={active:!0};return ee.active===!1&&(ae.active=!1),typeof ee.dtx=="boolean"&&(ae.dtx=ee.dtx),typeof ee.scalabilityMode=="string"&&(ae.scalabilityMode=ee.scalabilityMode),typeof ee.scaleResolutionDownBy=="number"&&(ae.scaleResolutionDownBy=ee.scaleResolutionDownBy),typeof ee.maxBitrate=="number"&&(ae.maxBitrate=ee.maxBitrate),typeof ee.maxFramerate=="number"&&(ae.maxFramerate=ee.maxFramerate),typeof ee.adaptivePtime=="boolean"&&(ae.adaptivePtime=ee.adaptivePtime),typeof ee.priority=="string"&&(ae.priority=ee.priority),typeof ee.networkPriority=="string"&&(ae.networkPriority=ee.networkPriority),ae}));const{localId:q,rtpParameters:Q,rtpSender:K}=yield this._handler.send({track:C,encodings:z,codecOptions:S,codec:b,onRtpSender:Z});try{o.validateRtpParameters(Q);const{id:ee}=yield new Promise((le,ne)=>{this.safeEmit("produce",{kind:C.kind,rtpParameters:Q,appData:$},le,ne)}),ae=new u.Producer({id:ee,localId:q,rtpSender:K,track:C,rtpParameters:Q,stopTracks:x,disableTrackOnPause:E,zeroRtpOnPause:M,appData:$});return this._producers.set(ae.id,ae),this.handleProducer(ae),this._observer.safeEmit("newproducer",ae),ae}catch(ee){throw this._handler.stopSending(q).catch(()=>{}),ee}}),"transport.produce()").catch(z=>{if(x)try{C.stop()}catch{}throw z})})}consume(C){return H(this,arguments,function*({id:R,producerId:S,kind:b,rtpParameters:x,streamId:E,onRtpReceiver:M,appData:Z={}}){if(f.debug("consume()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="recv")throw new i.UnsupportedError("not a receiving Transport");if(typeof R!="string")throw new TypeError("missing id");if(typeof S!="string")throw new TypeError("missing producerId");if(b!=="audio"&&b!=="video")throw new TypeError(`invalid kind '${b}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(Z&&typeof Z!="object")throw new TypeError("if given, appData must be an object");const $=a.clone(x);if(!o.canReceive($,this._recvRtpCapabilities))throw new i.UnsupportedError("cannot consume this Producer");const q=new _({id:R,producerId:S,kind:b,rtpParameters:$,streamId:E,onRtpReceiver:M,appData:Z});return this._pendingConsumerTasks.push(q),queueMicrotask(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),q.promise})}produceData(){return H(this,arguments,function*({ordered:C=!0,maxPacketLifeTime:R,maxRetransmits:S,label:b="",protocol:x="",appData:E={}}={}){if(f.debug("produceData()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="send")throw new i.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(E&&typeof E!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError("SCTP not enabled by remote Transport");return(R||S)&&(C=!1),this._awaitQueue.push(()=>H(this,null,function*(){const{dataChannel:M,sctpStreamParameters:Z}=yield this._handler.sendDataChannel({ordered:C,maxPacketLifeTime:R,maxRetransmits:S,label:b,protocol:x});o.validateSctpStreamParameters(Z);const{id:$}=yield new Promise((q,Q)=>{this.safeEmit("producedata",{sctpStreamParameters:Z,label:b,protocol:x,appData:E},q,Q)}),z=new h.DataProducer({id:$,dataChannel:M,sctpStreamParameters:Z,appData:E});return this._dataProducers.set(z.id,z),this.handleDataProducer(z),this._observer.safeEmit("newdataproducer",z),z}),"transport.produceData()")})}consumeData(C){return H(this,arguments,function*({id:R,dataProducerId:S,sctpStreamParameters:b,label:x="",protocol:E="",appData:M={}}){if(f.debug("consumeData()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="recv")throw new i.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof R!="string")throw new TypeError("missing id");if(typeof S!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(M&&typeof M!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError("SCTP not enabled by remote Transport");const Z=a.clone(b);return o.validateSctpStreamParameters(Z),this._awaitQueue.push(()=>H(this,null,function*(){const{dataChannel:$}=yield this._handler.receiveDataChannel({sctpStreamParameters:Z,label:x,protocol:E}),z=new g.DataConsumer({id:R,dataProducerId:S,dataChannel:$,sctpStreamParameters:Z,appData:M});return this._dataConsumers.set(z.id,z),this.handleDataConsumer(z),this._observer.safeEmit("newdataconsumer",z),z}),"transport.consumeData()")})}createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingConsumerTasks.length===0){f.debug("createPendingConsumers() | there is no Consumer to be created");return}const C=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let R;const S=[];for(const b of C){const{id:x,kind:E,rtpParameters:M,streamId:Z,onRtpReceiver:$}=b.consumerOptions;S.push({trackId:x,kind:E,rtpParameters:M,streamId:Z,onRtpReceiver:$})}try{const b=yield this._handler.receive(S);for(let x=0;x<b.length;++x){const E=C[x],M=b[x],{id:Z,producerId:$,kind:z,rtpParameters:q,appData:Q}=E.consumerOptions,{localId:K,rtpReceiver:ee,track:ae}=M,le=new p.Consumer({id:Z,localId:K,producerId:$,rtpReceiver:ee,track:ae,rtpParameters:q,appData:Q});this._consumers.set(le.id,le),this.handleConsumer(le),!this._probatorConsumerCreated&&!R&&z==="video"&&(R=le),this._observer.safeEmit("newconsumer",le),E.resolve(le)}}catch(b){for(const x of C)x.reject(b)}if(R)try{const b=o.generateProbatorRtpParameters(R.rtpParameters);yield this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:b}]),f.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(b){f.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",b)}}),"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingPauseConsumers.size===0){f.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const C=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const R=C.map(S=>S.localId);yield this._handler.pauseReceiving(R)}catch(R){f.error("pausePendingConsumers() | failed to pause Consumers:",R)}}),"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingResumeConsumers.size===0){f.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const C=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const R=C.map(S=>S.localId);yield this._handler.resumeReceiving(R)}catch(R){f.error("resumePendingConsumers() | failed to resume Consumers:",R)}}),"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingCloseConsumers.size===0){f.debug("closePendingConsumers() | there is no Consumer to be closed");return}const C=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{yield this._handler.stopReceiving(C.map(R=>R.localId))}catch(R){f.error("closePendingConsumers() | failed to close Consumers:",R)}}),"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const C=this._handler;C.on("@connect",({dtlsParameters:R},S,b)=>{if(this._closed){b(new i.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:R},S,b)}),C.on("@icegatheringstatechange",R=>{R!==this._iceGatheringState&&(f.debug("ICE gathering state changed to %s",R),this._iceGatheringState=R,this._closed||this.safeEmit("icegatheringstatechange",R))}),C.on("@icecandidateerror",R=>{f.warn(`ICE candidate error [url:${R.url}, localAddress:${R.address}, localPort:${R.port}]: ${R.errorCode} "${R.errorText}"`),this.safeEmit("icecandidateerror",R)}),C.on("@connectionstatechange",R=>{R!==this._connectionState&&(f.debug("connection state changed to %s",R),this._connectionState=R,this._closed||this.safeEmit("connectionstatechange",R))})}handleProducer(C){C.on("@close",()=>{this._producers.delete(C.id),!this._closed&&this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.stopSending(C.localId)}),"producer @close event").catch(R=>f.warn("producer.close() failed:%o",R))}),C.on("@pause",(R,S)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.pauseSending(C.localId)}),"producer @pause event").then(R).catch(S)}),C.on("@resume",(R,S)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.resumeSending(C.localId)}),"producer @resume event").then(R).catch(S)}),C.on("@replacetrack",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.replaceTrack(C.localId,R)}),"producer @replacetrack event").then(S).catch(b)}),C.on("@setmaxspatiallayer",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.setMaxSpatialLayer(C.localId,R)}),"producer @setmaxspatiallayer event").then(S).catch(b)}),C.on("@setrtpencodingparameters",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.setRtpEncodingParameters(C.localId,R)}),"producer @setrtpencodingparameters event").then(S).catch(b)}),C.on("@getstats",(R,S)=>{if(this._closed)return S(new i.InvalidStateError("closed"));this._handler.getSenderStats(C.localId).then(R).catch(S)})}handleConsumer(C){C.on("@close",()=>{this._consumers.delete(C.id),this._pendingPauseConsumers.delete(C.id),this._pendingResumeConsumers.delete(C.id),!this._closed&&(this._pendingCloseConsumers.set(C.id,C),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),C.on("@pause",()=>{this._pendingResumeConsumers.has(C.id)&&this._pendingResumeConsumers.delete(C.id),this._pendingPauseConsumers.set(C.id,C),queueMicrotask(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),C.on("@resume",()=>{this._pendingPauseConsumers.has(C.id)&&this._pendingPauseConsumers.delete(C.id),this._pendingResumeConsumers.set(C.id,C),queueMicrotask(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),C.on("@getstats",(R,S)=>{if(this._closed)return S(new i.InvalidStateError("closed"));this._handler.getReceiverStats(C.localId).then(R).catch(S)})}handleDataProducer(C){C.on("@close",()=>{this._dataProducers.delete(C.id)})}handleDataConsumer(C){C.on("@close",()=>{this._dataConsumers.delete(C.id)})}};e.Transport=w}}),qo=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/scalabilityModes.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.parse=n;var t=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function n(r){const i=t.exec(r??"");return i?{spatialLayers:Number(i[1]),temporalLayers:Number(i[2])}:{spatialLayers:1,temporalLayers:1}}}}),xl=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/commonUtils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.extractRtpCapabilities=n,e.extractDtlsParameters=r,e.getCname=i,e.applyCodecParameters=a;var t=Oi();function n({sdpObject:o}){var u,p,h;const g=new Map,f=new Map;for(const w of o.media){const C=w.type;switch(C){case"audio":case"video":break;default:continue}for(const R of w.rtp){const S={kind:C,mimeType:`${C}/${R.codec}`,preferredPayloadType:R.payload,clockRate:R.rate,channels:R.encoding,parameters:{},rtcpFeedback:[]};g.set(S.preferredPayloadType,S)}for(const R of(u=w.fmtp)!=null?u:[]){const S=t.parseParams(R.config),b=g.get(R.payload);b&&(S!=null&&S.hasOwnProperty("profile-level-id")&&(S["profile-level-id"]=String(S["profile-level-id"])),b.parameters=S)}for(const R of(p=w.rtcpFb)!=null?p:[]){const S={type:R.type,parameter:R.subtype};if(S.parameter||delete S.parameter,R.payload!=="*"){const b=g.get(Number(R.payload));if(!b)continue;b.rtcpFeedback.push(S)}else for(const b of g.values())b.kind===C&&!/.+\/rtx$/i.test(b.mimeType)&&b.rtcpFeedback.push(S)}for(const R of(h=w.ext)!=null?h:[]){if(R["encrypt-uri"])continue;const S={kind:C,uri:R.uri,preferredId:R.value};f.set(S.preferredId,S)}}return{codecs:Array.from(g.values()),headerExtensions:Array.from(f.values())}}function r({sdpObject:o}){var u;let p=o.setup,h=o.fingerprint;if(!p||!h){const _=((u=o.media)!=null?u:[]).find(w=>w.port!==0);_&&(p??(p=_.setup),h??(h=_.fingerprint))}if(p){if(!h)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let g;switch(p){case"active":{g="client";break}case"passive":{g="server";break}case"actpass":{g="auto";break}}return{role:g,fingerprints:[{algorithm:h.type,value:h.hash}]}}function i({offerMediaObject:o}){var u;const p=((u=o.ssrcs)!=null?u:[]).find(h=>h.attribute==="cname");return p?p.value:""}function a({offerRtpParameters:o,answerMediaObject:u}){var p,h,g;for(const f of o.codecs){const _=f.mimeType.toLowerCase();if(_!=="audio/opus"||!((p=u.rtp)!=null?p:[]).find(S=>S.payload===f.payloadType))continue;u.fmtp=(h=u.fmtp)!=null?h:[];let C=u.fmtp.find(S=>S.payload===f.payloadType);C||(C={payload:f.payloadType,config:""},u.fmtp.push(C));const R=t.parseParams(C.config);switch(_){case"audio/opus":{const S=(g=f.parameters)==null?void 0:g["sprop-stereo"];S!==void 0&&(R.stereo=Number(S)?1:0);break}}C.config="";for(const S of Object.keys(R))C.config&&(C.config+=";"),C.config+=`${S}=${R[S]}`}}}}),Cl=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.getRtpEncodings=t,e.addLegacySimulcast=n;function t({offerMediaObject:r}){var i,a;const o=new Set;for(const h of(i=r.ssrcs)!=null?i:[]){const g=h.id;g&&o.add(g)}if(o.size===0)throw new Error("no a=ssrc lines found");const u=new Map;for(const h of(a=r.ssrcGroups)!=null?a:[]){if(h.semantics!=="FID")continue;const g=h.ssrcs.split(/\s+/),f=Number(g[0]),_=Number(g[1]);o.has(f)&&(o.delete(f),o.delete(_),u.set(f,_))}for(const h of o)u.set(h,void 0);const p=[];for(const[h,g]of u){const f={ssrc:h};g&&(f.rtx={ssrc:g}),p.push(f)}return p}function n({offerMediaObject:r,numStreams:i}){var a,o,u;if(i<=1)throw new TypeError("numStreams must be greater than 1");const p=((a=r.ssrcs)!=null?a:[]).find(b=>b.attribute==="msid");if(!p)throw new Error("a=ssrc line with msid information not found");const[h,g]=p.value.split(" "),f=Number(p.id);let _;((o=r.ssrcGroups)!=null?o:[]).some(b=>{if(b.semantics!=="FID")return!1;const x=b.ssrcs.split(/\s+/);return Number(x[0])===f?(_=Number(x[1]),!0):!1});const w=((u=r.ssrcs)!=null?u:[]).find(b=>b.attribute==="cname");if(!w)throw new Error("a=ssrc line with cname information not found");const C=w.value,R=[],S=[];for(let b=0;b<i;++b)R.push(f+b),_&&S.push(_+b);r.ssrcGroups=[],r.ssrcs=[],r.ssrcGroups.push({semantics:"SIM",ssrcs:R.join(" ")});for(const b of R)r.ssrcs.push({id:b,attribute:"cname",value:C}),r.ssrcs.push({id:b,attribute:"msid",value:`${h} ${g}`});for(let b=0;b<S.length;++b){const x=R[b],E=S[b];r.ssrcs.push({id:E,attribute:"cname",value:C}),r.ssrcs.push({id:E,attribute:"msid",value:`${h} ${g}`}),r.ssrcGroups.push({semantics:"FID",ssrcs:`${x} ${E}`})}}}}),th=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/ortc/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.addNackSupportForOpus=t;function t(n){var r,i;for(const a of(r=n.codecs)!=null?r:[])(a.mimeType.toLowerCase()==="audio/opus"||a.mimeType.toLowerCase()==="audio/multiopus")&&!((i=a.rtcpFeedback)!=null&&i.some(o=>o.type==="nack"&&!o.parameter))&&(a.rtcpFeedback||(a.rtcpFeedback=[]),a.rtcpFeedback.push({type:"nack"}))}}}),I3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/MediaSection.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.OfferMediaSection=e.AnswerMediaSection=e.MediaSection=void 0;var t=Oi(),n=Vo(),r=class{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h}){me(this,"_mediaObject");var g;if(this._mediaObject={type:"",port:0,protocol:"",payloads:"",rtp:[],fmtp:[]},u&&this.setIceParameters(u),p){this._mediaObject.candidates=[];for(const f of p){const _={foundation:f.foundation,component:1,ip:(g=f.address)!=null?g:f.ip,port:f.port,priority:f.priority,transport:f.protocol,type:f.type};f.tcpType&&(_.tcptype=f.tcpType),this._mediaObject.candidates.push(_)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}h&&this.setDtlsRole(h.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(u){this._mediaObject.iceUfrag=u.usernameFragment,this._mediaObject.icePwd=u.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}};e.MediaSection=r;var i=class extends r{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:g,plainRtpParameters:f,offerMediaObject:_,offerRtpParameters:w,answerRtpParameters:C,codecOptions:R}){var S,b,x,E,M;switch(super({iceParameters:u,iceCandidates:p,dtlsParameters:h}),this._mediaObject.mid=String(_.mid),this._mediaObject.type=_.type,this._mediaObject.protocol=_.protocol,f?(this._mediaObject.connection={ip:f.ip,version:f.ipVersion},this._mediaObject.port=f.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),_.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const Z of C.codecs){const $={payload:Z.payloadType,codec:o(Z),rate:Z.clockRate};Z.channels>1&&($.encoding=Z.channels),this._mediaObject.rtp.push($);const z=(S=n.clone(Z.parameters))!=null?S:{};let q=(b=n.clone(Z.rtcpFeedback))!=null?b:[];if(R){const{opusStereo:K,opusFec:ee,opusDtx:ae,opusMaxPlaybackRate:le,opusMaxAverageBitrate:ne,opusPtime:Re,opusNack:ve,videoGoogleStartBitrate:_e,videoGoogleMaxBitrate:we,videoGoogleMinBitrate:Ee}=R,fe=w.codecs.find(ce=>ce.payloadType===Z.payloadType);switch(Z.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{K!==void 0&&(fe.parameters["sprop-stereo"]=K?1:0,z.stereo=K?1:0),ee!==void 0&&(fe.parameters.useinbandfec=ee?1:0,z.useinbandfec=ee?1:0),ae!==void 0&&(fe.parameters.usedtx=ae?1:0,z.usedtx=ae?1:0),le!==void 0&&(z.maxplaybackrate=le),ne!==void 0&&(z.maxaveragebitrate=ne),Re!==void 0&&(fe.parameters.ptime=Re,z.ptime=Re),ve||(fe.rtcpFeedback=fe.rtcpFeedback.filter(ce=>ce.type!=="nack"||ce.parameter),q=q.filter(ce=>ce.type!=="nack"||ce.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":case"video/av1":{_e!==void 0&&(z["x-google-start-bitrate"]=_e),we!==void 0&&(z["x-google-max-bitrate"]=we),Ee!==void 0&&(z["x-google-min-bitrate"]=Ee);break}}}const Q={payload:Z.payloadType,config:""};for(const K of Object.keys(z))Q.config&&(Q.config+=";"),Q.config+=`${K}=${z[K]}`;Q.config&&this._mediaObject.fmtp.push(Q);for(const K of q)this._mediaObject.rtcpFb.push({payload:Z.payloadType,type:K.type,subtype:K.parameter})}this._mediaObject.payloads=C.codecs.map(Z=>Z.payloadType).join(" "),this._mediaObject.ext=[];for(const Z of C.headerExtensions)((x=_.ext)!=null?x:[]).some(z=>z.uri===Z.uri)&&this._mediaObject.ext.push({uri:Z.uri,value:Z.id});if(_.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),_.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:_.simulcast.list1},this._mediaObject.rids=[];for(const Z of(E=_.rids)!=null?E:[])Z.direction==="send"&&this._mediaObject.rids.push({id:Z.id,direction:"recv"})}else if(_.simulcast_03){this._mediaObject.simulcast_03={value:_.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const Z of(M=_.rids)!=null?M:[])Z.direction==="send"&&this._mediaObject.rids.push({id:Z.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";break}case"application":{typeof _.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=g.port,this._mediaObject.maxMessageSize=g.maxMessageSize):_.sctpmap&&(this._mediaObject.payloads=String(g.port),this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:g.port,maxMessageSize:g.maxMessageSize});break}}}setDtlsRole(u){switch(u){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(u){var p,h;if(!((p=this._mediaObject.simulcast)!=null&&p.list1))return;const g={};for(const w of u)w.rid&&(g[w.rid]=w);const f=this._mediaObject.simulcast.list1,_=t.parseSimulcastStreamList(f);for(const w of _)for(const C of w)C.paused=!((h=g[C.scid])!=null&&h.active);this._mediaObject.simulcast.list1=_.map(w=>w.map(C=>`${C.paused?"~":""}${C.scid}`).join(",")).join(";")}};e.AnswerMediaSection=i;var a=class extends r{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:g,plainRtpParameters:f,mid:_,kind:w,offerRtpParameters:C,streamId:R,trackId:S}){var b,x;switch(super({iceParameters:u,iceCandidates:p,dtlsParameters:h}),this._mediaObject.mid=String(_),this._mediaObject.type=w,f?(this._mediaObject.connection={ip:f.ip,version:f.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=f.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},g?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),this._mediaObject.extmapAllowMixed="extmap-allow-mixed",w){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._mediaObject.msid=`${R??"-"} ${S}`;for(const $ of C.codecs){const z={payload:$.payloadType,codec:o($),rate:$.clockRate};$.channels>1&&(z.encoding=$.channels),this._mediaObject.rtp.push(z);const q={payload:$.payloadType,config:""};for(const Q of Object.keys((b=$.parameters)!=null?b:{}))q.config&&(q.config+=";"),q.config+=`${Q}=${$.parameters[Q]}`;q.config&&this._mediaObject.fmtp.push(q);for(const Q of $.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:$.payloadType,type:Q.type,subtype:Q.parameter})}this._mediaObject.payloads=C.codecs.map($=>$.payloadType).join(" "),this._mediaObject.ext=[];for(const $ of C.headerExtensions)this._mediaObject.ext.push({uri:$.uri,value:$.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const E=C.encodings[0],M=E.ssrc,Z=(x=E.rtx)==null?void 0:x.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],M&&C.rtcp.cname&&this._mediaObject.ssrcs.push({id:M,attribute:"cname",value:C.rtcp.cname}),Z&&(C.rtcp.cname&&this._mediaObject.ssrcs.push({id:Z,attribute:"cname",value:C.rtcp.cname}),M&&this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${M} ${Z}`}));break}case"application":{this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=g.port,this._mediaObject.maxMessageSize=g.maxMessageSize;break}}}setDtlsRole(u){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}};e.OfferMediaSection=a;function o(u){const h=new RegExp("^(audio|video)/(.+)","i").exec(u.mimeType);if(!h)throw new TypeError("invalid codec.mimeType");return h[2]}}}),El=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteSdp=void 0;var t=Oi(),n=Wr(),r=I3(),i=["av1","h264"],a=new n.Logger("RemoteSdp"),o=class{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:g,plainRtpParameters:f}){if(me(this,"_iceParameters"),me(this,"_iceCandidates"),me(this,"_dtlsParameters"),me(this,"_sctpParameters"),me(this,"_plainRtpParameters"),me(this,"_mediaSections",[]),me(this,"_midToIndex",new Map),me(this,"_firstMid"),me(this,"_sdpObject"),this._iceParameters=u,this._iceCandidates=p,this._dtlsParameters=h,this._sctpParameters=g,this._plainRtpParameters=f,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:"10000",sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},u!=null&&u.iceLite&&(this._sdpObject.icelite="ice-lite"),h){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const _=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:h.fingerprints[_-1].algorithm,hash:h.fingerprints[_-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}f&&(this._sdpObject.origin.address=f.ip,this._sdpObject.origin.ipVer=f.ipVersion)}updateIceParameters(u){a.debug("updateIceParameters() [iceParameters:%o]",u),this._iceParameters=u,this._sdpObject.icelite=u.iceLite?"ice-lite":void 0;for(const p of this._mediaSections)p.setIceParameters(u)}updateDtlsRole(u){a.debug("updateDtlsRole() [role:%s]",u),this._dtlsParameters.role=u;for(const p of this._mediaSections)p.setDtlsRole(u)}setSessionExtmapAllowMixed(){a.debug("setSessionExtmapAllowMixed()"),this._sdpObject.extmapAllowMixed="extmap-allow-mixed"}getNextMediaSectionIdx(){for(let u=0;u<this._mediaSections.length;++u){const p=this._mediaSections[u];if(p.closed)return{idx:u,reuseMid:p.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:u,reuseMid:p,offerRtpParameters:h,answerRtpParameters:g,codecOptions:f}){var _;const w=new r.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:u,offerRtpParameters:h,answerRtpParameters:g,codecOptions:f}),C=w.getObject();C.rtp.find(S=>i.includes(S.codec.toLowerCase()))||(C.ext=(_=C.ext)==null?void 0:_.filter(S=>S.uri!=="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension")),p?this._replaceMediaSection(w,p):this._midToIndex.has(w.mid)?this._replaceMediaSection(w):this._addMediaSection(w)}receive({mid:u,kind:p,offerRtpParameters:h,streamId:g,trackId:f}){this.setSessionExtmapAllowMixed();const _=new r.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,mid:u,kind:p,offerRtpParameters:h,streamId:g,trackId:f}),w=this._mediaSections.find(C=>C.closed);w?this._replaceMediaSection(_,w.mid):this._addMediaSection(_)}pauseMediaSection(u){this._findMediaSection(u).pause()}resumeSendingMediaSection(u){this._findMediaSection(u).resume()}resumeReceivingMediaSection(u){this._findMediaSection(u).resume()}disableMediaSection(u){this._findMediaSection(u).disable()}closeMediaSection(u){const p=this._findMediaSection(u);return u===this._firstMid?(a.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",u),this.disableMediaSection(u),!1):(p.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(u,p){const h=this._findMediaSection(u);h.muxSimulcastStreams(p),this._replaceMediaSection(h)}sendSctpAssociation({offerMediaObject:u}){const p=new r.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:u});this._addMediaSection(p)}receiveSctpAssociation(){const u=new r.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application"});this._addMediaSection(u)}getSdp(){return this._sdpObject.origin.sessionVersion++,t.write(this._sdpObject)}_addMediaSection(u){this._firstMid||(this._firstMid=u.mid),this._mediaSections.push(u),this._midToIndex.set(u.mid,this._mediaSections.length-1),this._sdpObject.media.push(u.getObject()),this._regenerateBundleMids()}_replaceMediaSection(u,p){if(typeof p=="string"){const h=this._midToIndex.get(p);if(h===void 0)throw new Error(`no media section found for reuseMid '${p}'`);const g=this._mediaSections[h];this._mediaSections[h]=u,this._midToIndex.delete(g.mid),this._midToIndex.set(u.mid,h),this._sdpObject.media[h]=u.getObject(),this._regenerateBundleMids()}else{const h=this._midToIndex.get(u.mid);if(h===void 0)throw new Error(`no media section found with mid '${u.mid}'`);this._mediaSections[h]=u,this._sdpObject.media[h]=u.getObject()}}_findMediaSection(u){const p=this._midToIndex.get(u);if(p===void 0)throw new Error(`no media section found with mid '${u}'`);return this._mediaSections[p]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(u=>!u.closed).map(u=>u.mid).join(" "))}};e.RemoteSdp=o}}),F3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Chrome111.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome111=void 0;var t=Oi(),n=ti(),r=Wr(),i=Es(),a=Mi(),o=qo(),u=xl(),p=Cl(),h=th(),g=El(),f=new r.Logger("Chrome111"),_="Chrome111",w={OS:1024,MIS:1024},C=class Iu extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_forcedLocalDtlsRole"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",Q=>{this.emit("@icecandidateerror",Q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new g.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Iu(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video",{sendEncodings:[{scalabilityMode:"L3T3"}]});const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Iu.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=u.extractRtpCapabilities({sdpObject:S});return h.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $;if(this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1){let we=1;for(const Ee of x){const fe=Ee.scalabilityMode?(0,o.parse)(Ee.scalabilityMode).temporalLayers:3;fe>we&&(we=fe)}x.forEach((Ee,fe)=>{Ee.rid=`r${fe}`,Ee.scalabilityMode=`L1T${we}`})}const z=this._remoteSdp.getNextMediaSectionIdx(),q=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});Z&&Z(q.sender);const Q=yield this._pc.createOffer();let K=t.parse(Q.sdp);K.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const ee=Iu.getLocalRtpCapabilities(K),ae=this._getSendExtendedRtpCapabilities(ee),le=i.getSendingRtpParameters(b.kind,ae);le.codecs=i.reduceCodecs(le.codecs,M);const ne=i.getSendingRemoteRtpParameters(b.kind,ae);ne.codecs=i.reduceCodecs(ne.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:K})),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",Q),yield this._pc.setLocalDescription(Q);const Re=q.mid;le.mid=Re,K=t.parse(this._pc.localDescription.sdp);const ve=K.media[z.idx];if(le.rtcp.cname=u.getCname({offerMediaObject:ve}),!x)le.encodings=p.getRtpEncodings({offerMediaObject:ve});else if(x.length===1){const we=p.getRtpEncodings({offerMediaObject:ve});Object.assign(we[0],x[0]),le.encodings=we}else le.encodings=x;this._remoteSdp.send({offerMediaObject:ve,reuseMid:z.reuseMid,offerRtpParameters:le,answerRtpParameters:ne,codecOptions:E});const _e={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",_e),yield this._pc.setRemoteDescription(_e),this._mapMidTransceiver.set(Re,q),{localId:Re,rtpParameters:le,rtpSender:q.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),f.debug("stopSending() [localId:%s]",S),this._closed)return;const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),ae=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:ae});const le={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",le),yield this._pc.setRemoteDescription(le),this._hasDataChannelMediaSection=!0}const Q={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:Q}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:Q,kind:K,rtpParameters:ee,streamId:ae}=q;f.debug("receive() [trackId:%s, kind:%s]",Q,K);const le=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(Q,le),this._remoteSdp.receive({mid:le,kind:K,offerRtpParameters:ee,streamId:ae??ee.rtcp.cname,trackId:Q})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:Q,onRtpReceiver:K}=q;if(K){const ee=M.get(Q),ae=this._pc.getTransceivers().find(le=>le.mid===ee);if(!ae)throw new Error("transceiver not found");K(ae.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:Q,rtpParameters:K}=q,ee=M.get(Q),ae=z.media.find(le=>String(le.mid)===ee);u.applyCodecParameters({offerRtpParameters:K,answerMediaObject:ae})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:Q}=q,K=M.get(Q),ee=this._pc.getTransceivers().find(ae=>ae.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,Q={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",Q);const K=this._pc.createDataChannel(x,Q);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const ae=yield this._pc.createAnswer();if(!this._transportReady){const le=t.parse(ae.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:le})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ae),yield this._pc.setLocalDescription(ae),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=u.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Chrome111=C}}),D3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Chrome74.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome74=void 0;var t=Oi(),n=Wr(),r=ti(),i=Es(),a=Mi(),o=qo(),u=xl(),p=Cl(),h=th(),g=El(),f=new n.Logger("Chrome74"),_="Chrome74",w={OS:1024,MIS:1024},C=class Fu extends r.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_forcedLocalDtlsRole"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",Q=>{this.emit("@icecandidateerror",Q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new g.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Fu(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Fu.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=u.extractRtpCapabilities({sdpObject:S});return h.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M}){var Z;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1&&x.forEach((Ee,fe)=>{Ee.rid=`r${fe}`});const $=this._remoteSdp.getNextMediaSectionIdx(),z=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});let q=yield this._pc.createOffer(),Q=t.parse(q.sdp);Q.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const K=Fu.getLocalRtpCapabilities(Q),ee=this._getSendExtendedRtpCapabilities(K),ae=i.getSendingRtpParameters(b.kind,ee);ae.codecs=i.reduceCodecs(ae.codecs,M);const le=i.getSendingRemoteRtpParameters(b.kind,ee);le.codecs=i.reduceCodecs(le.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:(Z=this._forcedLocalDtlsRole)!=null?Z:"client",localSdpObject:Q}));let ne=!1;const Re=(0,o.parse)((x??[{}])[0].scalabilityMode);let ve;x&&x.length===1&&Re.spatialLayers>1&&ae.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),ne=!0,Q=t.parse(q.sdp),ve=Q.media[$.idx],p.addLegacySimulcast({offerMediaObject:ve,numStreams:Re.spatialLayers}),q={type:"offer",sdp:t.write(Q)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",q),yield this._pc.setLocalDescription(q);const _e=z.mid;if(ae.mid=_e,Q=t.parse(this._pc.localDescription.sdp),ve=Q.media[$.idx],ae.rtcp.cname=u.getCname({offerMediaObject:ve}),!x)ae.encodings=p.getRtpEncodings({offerMediaObject:ve});else if(x.length===1){let Ee=p.getRtpEncodings({offerMediaObject:ve});Object.assign(Ee[0],x[0]),ne&&(Ee=[Ee[0]]),ae.encodings=Ee}else ae.encodings=x;if(ae.encodings.length>1&&(ae.codecs[0].mimeType.toLowerCase()==="video/vp8"||ae.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const Ee of ae.encodings)Ee.scalabilityMode?Ee.scalabilityMode=`L1T${Re.temporalLayers}`:Ee.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:ve,reuseMid:$.reuseMid,offerRtpParameters:ae,answerRtpParameters:le,codecOptions:E});const we={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",we),yield this._pc.setRemoteDescription(we),this._mapMidTransceiver.set(_e,z),{localId:_e,rtpParameters:ae,rtpSender:z.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),f.debug("stopSending() [localId:%s]",S),this._closed)return;const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),ae=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:ae});const le={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",le),yield this._pc.setRemoteDescription(le),this._hasDataChannelMediaSection=!0}const Q={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:Q}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:Q,kind:K,rtpParameters:ee,streamId:ae}=q;f.debug("receive() [trackId:%s, kind:%s]",Q,K);const le=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(Q,le),this._remoteSdp.receive({mid:le,kind:K,offerRtpParameters:ee,streamId:ae??ee.rtcp.cname,trackId:Q})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:Q,rtpParameters:K}=q,ee=M.get(Q),ae=z.media.find(le=>String(le.mid)===ee);u.applyCodecParameters({offerRtpParameters:K,answerMediaObject:ae})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:Q}=q,K=M.get(Q),ee=this._pc.getTransceivers().find(ae=>ae.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,Q={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",Q);const K=this._pc.createDataChannel(x,Q);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const ae=yield this._pc.createAnswer();if(!this._transportReady){const le=t.parse(ae.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:le})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ae),yield this._pc.setLocalDescription(ae),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=u.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Chrome74=C}}),N3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Firefox120.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Firefox120=void 0;var t=Oi(),n=ti(),r=Wr(),i=Mi(),a=Es(),o=qo(),u=xl(),p=Cl(),h=El(),g=new r.Logger("Firefox120"),f="Firefox120",_={OS:16,MIS:2048},w=class Du extends n.EnhancedEventEmitter{constructor({direction:R,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:$,getSendExtendedRtpCapabilities:z}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",q=>{this.emit("@icecandidateerror",q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),g.debug("constructor()"),this._direction=R,this._remoteSdp=new h.RemoteSdp({iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E}),this._getSendExtendedRtpCapabilities=z,this._pc=new RTCPeerConnection(ie({iceServers:M??[],iceTransportPolicy:Z??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},$)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(g.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:f,factory:R=>new Du(R),getNativeRtpCapabilities:()=>H(null,null,function*(){g.debug("getNativeRtpCapabilities()");let R=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});const S=document.createElement("canvas");S.getContext("2d");const x=S.captureStream().getVideoTracks()[0];try{R.addTransceiver("audio",{direction:"sendrecv"}),R.addTransceiver(x,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const E=yield R.createOffer();try{S.remove()}catch{}try{x.stop()}catch{}try{R.close()}catch{}R=void 0;const M=t.parse(E.sdp);return Du.getLocalRtpCapabilities(M)}catch(E){try{S.remove()}catch{}try{x.stop()}catch{}try{R==null||R.close()}catch{}throw R=void 0,E}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return g.debug("getNativeSctpCapabilities()"),{numStreams:_}})}}static getLocalRtpCapabilities(R){return u.extractRtpCapabilities({sdpObject:R})}get name(){return f}close(){if(g.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(R){return H(this,null,function*(){throw this.assertNotClosed(),new i.UnsupportedError("not supported")})}restartIce(R){return H(this,null,function*(){if(this.assertNotClosed(),g.debug("restartIce()"),this._remoteSdp.updateIceParameters(R),!!this._transportReady)if(this._direction==="send"){const S=yield this._pc.createOffer({iceRestart:!0});g.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",S),yield this._pc.setLocalDescription(S);const b={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",b),yield this._pc.setRemoteDescription(b)}else{const S={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();g.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(R){return H(this,arguments,function*({track:S,encodings:b,codecOptions:x,codec:E,onRtpSender:M}){this.assertNotClosed(),this.assertSendDirection(),g.debug("send() [kind:%s, track.id:%s]",S.kind,S.id),b&&b.length>1&&b.forEach((ve,_e)=>{ve.rid=`r${_e}`});const Z=this._pc.addTransceiver(S,{direction:"sendonly",streams:[this._sendStream],sendEncodings:b});M&&M(Z.sender);const $=yield this._pc.createOffer();let z=t.parse($.sdp);z.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const q=Du.getLocalRtpCapabilities(z),Q=this._getSendExtendedRtpCapabilities(q),K=a.getSendingRtpParameters(S.kind,Q);K.codecs=a.reduceCodecs(K.codecs,E);const ee=a.getSendingRemoteRtpParameters(S.kind,Q);ee.codecs=a.reduceCodecs(ee.codecs,E),this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:z}));const ae=(0,o.parse)((b??[{}])[0].scalabilityMode);g.debug("send() | calling pc.setLocalDescription() [offer:%o]",$),yield this._pc.setLocalDescription($);const le=Z.mid;K.mid=le,z=t.parse(this._pc.localDescription.sdp);const ne=z.media[z.media.length-1];if(K.rtcp.cname=u.getCname({offerMediaObject:ne}),!b)K.encodings=p.getRtpEncodings({offerMediaObject:ne});else if(b.length===1){const ve=p.getRtpEncodings({offerMediaObject:ne});Object.assign(ve[0],b[0]),K.encodings=ve}else K.encodings=b;if(K.encodings.length>1&&(K.codecs[0].mimeType.toLowerCase()==="video/vp8"||K.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const ve of K.encodings)ve.scalabilityMode?ve.scalabilityMode=`L1T${ae.temporalLayers}`:ve.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:ne,offerRtpParameters:K,answerRtpParameters:ee,codecOptions:x});const Re={type:"answer",sdp:this._remoteSdp.getSdp()};return g.debug("send() | calling pc.setRemoteDescription() [answer:%o]",Re),yield this._pc.setRemoteDescription(Re),this._mapMidTransceiver.set(le,Z),{localId:le,rtpParameters:K,rtpSender:Z.sender}})}stopSending(R){return H(this,null,function*(){if(this.assertSendDirection(),g.debug("stopSending() [localId:%s]",R),this._closed)return;const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated transceiver not found");S.sender.replaceTrack(null),this._pc.removeTrack(S.sender),this._remoteSdp.disableMediaSection(S.mid);const b=yield this._pc.createOffer();g.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x),this._mapMidTransceiver.delete(R)})}pauseSending(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),g.debug("pauseSending() [localId:%s]",R);const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");S.direction="inactive",this._remoteSdp.pauseMediaSection(R);const b=yield this._pc.createOffer();g.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)})}resumeSending(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),g.debug("resumeSending() [localId:%s]",R);const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");S.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(R);const b=yield this._pc.createOffer();g.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)})}replaceTrack(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),S?g.debug("replaceTrack() [localId:%s, track.id:%s]",R,S.id):g.debug("replaceTrack() [localId:%s, no track]",R);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated RTCRtpTransceiver not found");yield b.sender.replaceTrack(S)})}setMaxSpatialLayer(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),g.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",R,S);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated transceiver not found");const x=b.sender.getParameters();x.encodings.forEach((Z,$)=>{$<=S?Z.active=!0:Z.active=!1}),yield b.sender.setParameters(x),this._remoteSdp.muxMediaSectionSimulcast(R,x.encodings);const E=yield this._pc.createOffer();g.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M)})}setRtpEncodingParameters(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),g.debug("setRtpEncodingParameters() [localId:%s, params:%o]",R,S);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated RTCRtpTransceiver not found");const x=b.sender.getParameters();x.encodings.forEach((Z,$)=>{x.encodings[$]=ie(ie({},Z),S)}),yield b.sender.setParameters(x),this._remoteSdp.muxMediaSectionSimulcast(R,x.encodings);const E=yield this._pc.createOffer();g.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M)})}getSenderStats(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");return S.sender.getStats()})}sendDataChannel(R){return H(this,arguments,function*({ordered:S,maxPacketLifeTime:b,maxRetransmits:x,label:E,protocol:M}){this.assertNotClosed(),this.assertSendDirection();const Z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:S,maxPacketLifeTime:b,maxRetransmits:x,protocol:M};g.debug("sendDataChannel() [options:%o]",Z);const $=this._pc.createDataChannel(E,Z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%_.MIS,!this._hasDataChannelMediaSection){const q=yield this._pc.createOffer(),Q=t.parse(q.sdp),K=Q.media.find(ae=>ae.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:Q})),g.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",q),yield this._pc.setLocalDescription(q),this._remoteSdp.sendSctpAssociation({offerMediaObject:K});const ee={type:"answer",sdp:this._remoteSdp.getSdp()};g.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ee),yield this._pc.setRemoteDescription(ee),this._hasDataChannelMediaSection=!0}const z={streamId:Z.id,ordered:Z.ordered,maxPacketLifeTime:Z.maxPacketLifeTime,maxRetransmits:Z.maxRetransmits};return{dataChannel:$,sctpStreamParameters:z}})}receive(R){return H(this,null,function*(){var S;this.assertNotClosed(),this.assertRecvDirection();const b=[],x=new Map;for(const $ of R){const{trackId:z,kind:q,rtpParameters:Q,streamId:K}=$;g.debug("receive() [trackId:%s, kind:%s]",z,q);const ee=(S=Q.mid)!=null?S:String(this._mapMidTransceiver.size);x.set(z,ee),this._remoteSdp.receive({mid:ee,kind:q,offerRtpParameters:Q,streamId:K??Q.rtcp.cname,trackId:z})}const E={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",E),yield this._pc.setRemoteDescription(E);for(const $ of R){const{trackId:z,onRtpReceiver:q}=$;if(q){const Q=x.get(z),K=this._pc.getTransceivers().find(ee=>ee.mid===Q);if(!K)throw new Error("transceiver not found");q(K.receiver)}}let M=yield this._pc.createAnswer();const Z=t.parse(M.sdp);for(const $ of R){const{trackId:z,rtpParameters:q}=$,Q=x.get(z),K=Z.media.find(ee=>String(ee.mid)===Q);u.applyCodecParameters({offerRtpParameters:q,answerMediaObject:K}),M={type:"answer",sdp:t.write(Z)}}this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:Z})),g.debug("receive() | calling pc.setLocalDescription() [answer:%o]",M),yield this._pc.setLocalDescription(M);for(const $ of R){const{trackId:z}=$,q=x.get(z),Q=this._pc.getTransceivers().find(K=>K.mid===q);if(!Q)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(q,Q),b.push({localId:q,track:Q.receiver.track,rtpReceiver:Q.receiver})}return b})}stopReceiving(R){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const x of R){g.debug("stopReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(E.mid)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();g.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b);for(const x of R)this._mapMidTransceiver.delete(x)})}pauseReceiving(R){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const x of R){g.debug("pauseReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");E.direction="inactive",this._remoteSdp.pauseMediaSection(x)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();g.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)})}resumeReceiving(R){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const x of R){g.debug("resumeReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");E.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(x)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();g.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)})}getReceiverStats(R){return H(this,null,function*(){this.assertRecvDirection();const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");return S.receiver.getStats()})}receiveDataChannel(R){return H(this,arguments,function*({sctpStreamParameters:S,label:b,protocol:x}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:E,ordered:M,maxPacketLifeTime:Z,maxRetransmits:$}=S,z={negotiated:!0,id:E,ordered:M,maxPacketLifeTime:Z,maxRetransmits:$,protocol:x};g.debug("receiveDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(b,z);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const Q={type:"offer",sdp:this._remoteSdp.getSdp()};g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",Q),yield this._pc.setRemoteDescription(Q);const K=yield this._pc.createAnswer();if(!this._transportReady){const ee=t.parse(K.sdp);yield this.setupTransport({localDtlsRole:"client",localSdpObject:ee})}g.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",K),yield this._pc.setLocalDescription(K),this._hasDataChannelMediaSection=!0}return{dataChannel:q}})}setupTransport(R){return H(this,arguments,function*({localDtlsRole:S,localSdpObject:b}){b||(b=t.parse(this._pc.localDescription.sdp));const x=u.extractDtlsParameters({sdpObject:b});x.role=S,this._remoteSdp.updateDtlsRole(S==="client"?"server":"client"),yield new Promise((E,M)=>{this.safeEmit("@connect",{dtlsParameters:x},E,M)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new i.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Firefox120=w}}),O3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Safari12.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Safari12=void 0;var t=Oi(),n=ti(),r=Wr(),i=Es(),a=Mi(),o=qo(),u=El(),p=xl(),h=Cl(),g=th(),f=new r.Logger("Safari12"),_="Safari12",w={OS:1024,MIS:1024},C=class Nu extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_forcedLocalDtlsRole"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",Q=>{this.emit("@icecandidateerror",Q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new u.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",Q=>{this.emit("@icecandidateerror",Q)}),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Nu(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Nu.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=p.extractRtpCapabilities({sdpObject:S});return g.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id);const z=this._remoteSdp.getNextMediaSectionIdx(),q=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream]});Z&&Z(q.sender);let Q=yield this._pc.createOffer(),K=t.parse(Q.sdp);K.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const ee=Nu.getLocalRtpCapabilities(K),ae=this._getSendExtendedRtpCapabilities(ee),le=i.getSendingRtpParameters(b.kind,ae);le.codecs=i.reduceCodecs(le.codecs,M);const ne=i.getSendingRemoteRtpParameters(b.kind,ae);ne.codecs=i.reduceCodecs(ne.codecs,M);let Re;this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:K}));const ve=(0,o.parse)((x??[{}])[0].scalabilityMode);x&&x.length>1&&(f.debug("send() | enabling legacy simulcast"),K=t.parse(Q.sdp),Re=K.media[z.idx],h.addLegacySimulcast({offerMediaObject:Re,numStreams:x.length}),Q={type:"offer",sdp:t.write(K)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",Q),yield this._pc.setLocalDescription(Q);const _e=q.mid;if(le.mid=_e,K=t.parse(this._pc.localDescription.sdp),Re=K.media[z.idx],le.rtcp.cname=p.getCname({offerMediaObject:Re}),le.encodings=h.getRtpEncodings({offerMediaObject:Re}),x)for(let Ee=0;Ee<le.encodings.length;++Ee)x[Ee]&&Object.assign(le.encodings[Ee],x[Ee]);if(le.encodings.length>1&&(le.codecs[0].mimeType.toLowerCase()==="video/vp8"||le.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const Ee of le.encodings)Ee.scalabilityMode?Ee.scalabilityMode=`L1T${ve.temporalLayers}`:Ee.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:Re,reuseMid:z.reuseMid,offerRtpParameters:le,answerRtpParameters:ne,codecOptions:E});const we={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",we),yield this._pc.setRemoteDescription(we),this._mapMidTransceiver.set(_e,q),{localId:_e,rtpParameters:le,rtpSender:q.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),this._closed)return;f.debug("stopSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(S);const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),ae=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:ae});const le={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",le),yield this._pc.setRemoteDescription(le),this._hasDataChannelMediaSection=!0}const Q={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:Q}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:Q,kind:K,rtpParameters:ee,streamId:ae}=q;f.debug("receive() [trackId:%s, kind:%s]",Q,K);const le=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(Q,le),this._remoteSdp.receive({mid:le,kind:K,offerRtpParameters:ee,streamId:ae??ee.rtcp.cname,trackId:Q})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:Q,onRtpReceiver:K}=q;if(K){const ee=M.get(Q),ae=this._pc.getTransceivers().find(le=>le.mid===ee);if(!ae)throw new Error("transceiver not found");K(ae.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:Q,rtpParameters:K}=q,ee=M.get(Q),ae=z.media.find(le=>String(le.mid)===ee);p.applyCodecParameters({offerRtpParameters:K,answerMediaObject:ae})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:Q}=q,K=M.get(Q),ee=this._pc.getTransceivers().find(ae=>ae.mid===K);if(!ee)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver})}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,Q={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",Q);const K=this._pc.createDataChannel(x,Q);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const ae=yield this._pc.createAnswer();if(!this._transportReady){const le=t.parse(ae.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:le})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ae),yield this._pc.setLocalDescription(ae),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=p.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Safari12=C}}),M3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/ReactNative106.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.ReactNative106=void 0;var t=Oi(),n=ti(),r=Wr(),i=Es(),a=Mi(),o=qo(),u=El(),p=xl(),h=Cl(),g=th(),f=new r.Logger("ReactNative106"),_="ReactNative106",w={OS:1024,MIS:1024},C=class Ou extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),me(this,"_closed",!1),me(this,"_direction"),me(this,"_remoteSdp"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_forcedLocalDtlsRole"),me(this,"_pc"),me(this,"_mapMidTransceiver",new Map),me(this,"_sendStream",new MediaStream),me(this,"_hasDataChannelMediaSection",!1),me(this,"_nextSendSctpStreamId",0),me(this,"_transportReady",!1),me(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),me(this,"onIceCandidateError",Q=>{this.emit("@icecandidateerror",Q)}),me(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),me(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new u.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Ou(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Ou.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=p.extractRtpCapabilities({sdpObject:S});return g.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0,this._sendStream.release(!1);try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $,z;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1&&x.forEach((ce,Ce)=>{ce.rid=`r${Ce}`});const q=this._remoteSdp.getNextMediaSectionIdx(),Q=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});Z&&Z(Q.sender);let K=yield this._pc.createOffer(),ee=t.parse(K.sdp);ee.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const ae=Ou.getLocalRtpCapabilities(ee),le=this._getSendExtendedRtpCapabilities(ae),ne=i.getSendingRtpParameters(b.kind,le);ne.codecs=i.reduceCodecs(ne.codecs,M);const Re=i.getSendingRemoteRtpParameters(b.kind,le);Re.codecs=i.reduceCodecs(Re.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee}));let ve=!1;const _e=(0,o.parse)((x??[{}])[0].scalabilityMode);let we;x&&x.length===1&&_e.spatialLayers>1&&ne.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),ve=!0,ee=t.parse(K.sdp),we=ee.media[q.idx],h.addLegacySimulcast({offerMediaObject:we,numStreams:_e.spatialLayers}),K={type:"offer",sdp:t.write(ee)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K);let Ee=(z=Q.mid)!=null?z:void 0;if(Ee||f.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),ne.mid=Ee,ee=t.parse(this._pc.localDescription.sdp),we=ee.media[q.idx],ne.rtcp.cname=p.getCname({offerMediaObject:we}),!x)ne.encodings=h.getRtpEncodings({offerMediaObject:we});else if(x.length===1){let ce=h.getRtpEncodings({offerMediaObject:we});Object.assign(ce[0],x[0]),ve&&(ce=[ce[0]]),ne.encodings=ce}else ne.encodings=x;if(ne.encodings.length>1&&(ne.codecs[0].mimeType.toLowerCase()==="video/vp8"||ne.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const ce of ne.encodings)ce.scalabilityMode?ce.scalabilityMode=`L1T${_e.temporalLayers}`:ce.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:we,reuseMid:q.reuseMid,offerRtpParameters:ne,answerRtpParameters:Re,codecOptions:E});const fe={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",fe),yield this._pc.setRemoteDescription(fe),Ee||(Ee=Q.mid,ne.mid=Ee),this._mapMidTransceiver.set(Ee,Q),{localId:Ee,rtpParameters:ne,rtpSender:Q.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),this._closed)return;f.debug("stopSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),ae=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:ae});const le={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",le),yield this._pc.setRemoteDescription(le),this._hasDataChannelMediaSection=!0}const Q={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:Q}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:Q,kind:K,rtpParameters:ee,streamId:ae}=q;f.debug("receive() [trackId:%s, kind:%s]",Q,K);const le=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(Q,le),this._remoteSdp.receive({mid:le,kind:K,offerRtpParameters:ee,streamId:ae??ee.rtcp.cname,trackId:Q})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:Q,onRtpReceiver:K}=q;if(K){const ee=M.get(Q),ae=this._pc.getTransceivers().find(le=>le.mid===ee);if(!ae)throw new Error("transceiver not found");K(ae.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:Q,rtpParameters:K}=q,ee=M.get(Q),ae=z.media.find(le=>String(le.mid)===ee);p.applyCodecParameters({offerRtpParameters:K,answerMediaObject:ae})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:Q}=q,K=M.get(Q),ee=this._pc.getTransceivers().find(ae=>ae.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,Q={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",Q);const K=this._pc.createDataChannel(x,Q);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const ae=yield this._pc.createAnswer();if(!this._transportReady){const le=t.parse(ae.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:le})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ae),yield this._pc.setLocalDescription(ae),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=p.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.ReactNative106=C}}),L3=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Device.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Device=void 0,e.detectDeviceAsync=C,e.detectDevice=R;var t=qy(),n=Wr(),r=ti(),i=Mi(),a=Vo(),o=Es(),u=A3(),p=F3(),h=D3(),g=N3(),f=O3(),_=M3(),w=new n.Logger("Device");function C(x){return H(this,null,function*(){w.debug("detectDeviceAsync() [userAgent:%s]",x),!x&&typeof navigator=="object"&&(x=navigator.userAgent);const E=(0,t.UAParser)(x);return b(E)})}function R(x){w.debug("detectDevice() [userAgent:%s]",x),!x&&typeof navigator=="object"&&(x=navigator.userAgent);const E=(0,t.UAParser)(x);return b(E)}var S=class o_{constructor({handlerName:E,handlerFactory:M}={}){if(me(this,"_handlerFactory"),me(this,"_handlerName"),me(this,"_loaded",!1),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_recvRtpCapabilities"),me(this,"_canProduceByKind",{audio:!1,video:!1}),me(this,"_sctpCapabilities"),me(this,"_observer",new r.EnhancedEventEmitter),w.debug("constructor()"),E&&M)throw new TypeError("just one of handlerName or handlerInterface can be given");if(M)this._handlerFactory=M;else{if(E)w.debug("constructor() | handler given: %s",E);else if(E=R(),E)w.debug("constructor() | detected handler: %s",E);else throw new i.UnsupportedError("device not supported");switch(E){case"Chrome111":{this._handlerFactory=p.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=h.Chrome74.createFactory();break}case"Firefox120":{this._handlerFactory=g.Firefox120.createFactory();break}case"Safari12":{this._handlerFactory=f.Safari12.createFactory();break}case"ReactNative106":{this._handlerFactory=_.ReactNative106.createFactory();break}default:throw new TypeError(`unknown handlerName "${E}"`)}}this._handlerName=this._handlerFactory.name}static factory(){return H(this,arguments,function*({handlerName:E,handlerFactory:M}={}){if(w.debug("factory()"),E&&M)throw new TypeError("just one of handlerName or handlerInterface can be given");if(!E&&!M&&(E=yield C(),!E))throw new i.UnsupportedError("device not supported");return new o_({handlerName:E,handlerFactory:M})})}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new i.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new i.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}load(E){return H(this,arguments,function*({routerRtpCapabilities:M,preferLocalCodecsOrder:Z=!1}){if(w.debug("load() [routerRtpCapabilities:%o]",M),this._loaded)throw new i.InvalidStateError("already loaded");const $=a.clone(M);o.validateRtpCapabilities($);const{getNativeRtpCapabilities:z,getNativeSctpCapabilities:q}=this._handlerFactory,Q=a.clone(yield z());o.validateRtpCapabilities(Q),w.debug("load() | got native RTP capabilities:%o",Q),this._getSendExtendedRtpCapabilities=ee=>a.clone(o.getExtendedRtpCapabilities(ee,$,Z));const K=o.getExtendedRtpCapabilities(Q,$,!1);this._recvRtpCapabilities=o.getRecvRtpCapabilities(K),o.validateRtpCapabilities(this._recvRtpCapabilities),w.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._canProduceByKind.audio=o.canSend("audio",this._recvRtpCapabilities),this._canProduceByKind.video=o.canSend("video",this._recvRtpCapabilities),this._sctpCapabilities=yield q(),o.validateSctpCapabilities(this._sctpCapabilities),w.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),w.debug("load() succeeded"),this._loaded=!0})}canProduce(E){if(this._loaded){if(E!=="audio"&&E!=="video")throw new TypeError(`invalid kind "${E}"`)}else throw new i.InvalidStateError("not loaded");return this._canProduceByKind[E]}createSendTransport({id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:Q,additionalSettings:K,appData:ee}){return w.debug("createSendTransport()"),this.createTransport({direction:"send",id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:Q,additionalSettings:K,appData:ee})}createRecvTransport({id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:Q,additionalSettings:K,appData:ee}){return w.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:Q,additionalSettings:K,appData:ee})}createTransport({direction:E,id:M,iceParameters:Z,iceCandidates:$,dtlsParameters:z,sctpParameters:q,iceServers:Q,iceTransportPolicy:K,additionalSettings:ee,appData:ae}){if(this._loaded){if(typeof M!="string")throw new TypeError("missing id");if(typeof Z!="object")throw new TypeError("missing iceParameters");if(Array.isArray($)){if(typeof z!="object")throw new TypeError("missing dtlsParameters");if(q&&typeof q!="object")throw new TypeError("wrong sctpParameters");if(ae&&typeof ae!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new i.InvalidStateError("not loaded");const le=new u.Transport({direction:E,id:M,iceParameters:Z,iceCandidates:$,dtlsParameters:z,sctpParameters:q,iceServers:Q,iceTransportPolicy:K,additionalSettings:ee,appData:ae,handlerFactory:this._handlerFactory,getSendExtendedRtpCapabilities:this._getSendExtendedRtpCapabilities,recvRtpCapabilities:this._recvRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",le),le}};e.Device=S;function b(x){var E,M,Z,$,z,q;if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(w.debug("detectDeviceImpl() | React-Native detected"),typeof RTCPeerConnection>"u"||typeof RTCRtpTransceiver>"u"){w.warn("detectDeviceImpl() | unsupported react-native-webrtc without RTCPeerConnection or RTCRtpTransceiver, forgot to call registerGlobals() on it?");return}return"ReactNative106"}else{w.debug("detectDeviceImpl() | browser detected [userAgent:%s, parsed:%o]",x.ua,x);const Q=x.browser,K=(E=Q.name)==null?void 0:E.toLowerCase(),ee=parseInt((M=Q.major)!=null?M:"0"),le=(Z=x.engine.name)==null?void 0:Z.toLowerCase(),ne=x.os,Re=($=ne.name)==null?void 0:$.toLowerCase(),ve=parseFloat((z=ne.version)!=null?z:"0"),we=(q=x.device.model)==null?void 0:q.toLowerCase(),Ee=Re==="ios"||we==="ipad",fe=K&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(K),ce=K&&["firefox","mobile firefox","mobile focus"].includes(K),Ce=K&&["safari","mobile safari"].includes(K),je=K&&["edge"].includes(K);if((fe||je)&&!Ee&&ee>=111)return"Chrome111";if(fe&&!Ee&&ee>=74||je&&!Ee&&ee>=88)return"Chrome74";if(ce&&!Ee&&ee>=120)return"Firefox120";if(ce&&Ee&&ve>=14.3)return"Safari12";if(Ce&&ee>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(le==="webkit"&&Ee&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(le==="blink"){const $e=x.ua.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);return $e?Number($e[1])>=111?"Chrome111":"Chrome74":"Chrome111"}else{w.warn("detectDeviceImpl() | browser not supported [name:%s, version:%s]",K,ee);return}}}}}),j3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/max.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default="ffffffff-ffff-ffff-ffff-ffffffffffff"}}),B3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/nil.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default="00000000-0000-0000-0000-000000000000"}}),U3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/regex.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i}}),nh=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/validate.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=U3();function n(r){return typeof r=="string"&&t.default.test(r)}e.default=n}}),rh=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/parse.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=nh();function n(r){if(!(0,t.default)(r))throw TypeError("Invalid UUID");let i;return Uint8Array.of((i=parseInt(r.slice(0,8),16))>>>24,i>>>16&255,i>>>8&255,i&255,(i=parseInt(r.slice(9,13),16))>>>8,i&255,(i=parseInt(r.slice(14,18),16))>>>8,i&255,(i=parseInt(r.slice(19,23),16))>>>8,i&255,(i=parseInt(r.slice(24,36),16))/1099511627776&255,i/4294967296&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255)}e.default=n}}),la=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/stringify.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.unsafeStringify=void 0;var t=nh(),n=[];for(let a=0;a<256;++a)n.push((a+256).toString(16).slice(1));function r(a,o=0){return(n[a[o+0]]+n[a[o+1]]+n[a[o+2]]+n[a[o+3]]+"-"+n[a[o+4]]+n[a[o+5]]+"-"+n[a[o+6]]+n[a[o+7]]+"-"+n[a[o+8]]+n[a[o+9]]+"-"+n[a[o+10]]+n[a[o+11]]+n[a[o+12]]+n[a[o+13]]+n[a[o+14]]+n[a[o+15]]).toLowerCase()}e.unsafeStringify=r;function i(a,o=0){const u=r(a,o);if(!(0,t.default)(u))throw TypeError("Stringified UUID is invalid");return u}e.default=i}}),Zm=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/rng.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t,n=new Uint8Array(16);function r(){if(!t){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(n)}e.default=r}}),c_=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.updateV1State=void 0;var t=Zm(),n=la(),r={};function i(u,p,h){var g,f,_,w;let C;const R=(g=u==null?void 0:u._v6)!=null?g:!1;if(u){const S=Object.keys(u);S.length===1&&S[0]==="_v6"&&(u=void 0)}if(u)C=o((w=(_=u.random)!=null?_:(f=u.rng)==null?void 0:f.call(u))!=null?w:(0,t.default)(),u.msecs,u.nsecs,u.clockseq,u.node,p,h);else{const S=Date.now(),b=(0,t.default)();a(r,S,b),C=o(b,r.msecs,r.nsecs,R?void 0:r.clockseq,R?void 0:r.node,p,h)}return p??(0,n.unsafeStringify)(C)}function a(u,p,h){var g,f;return(g=u.msecs)!=null||(u.msecs=-1/0),(f=u.nsecs)!=null||(u.nsecs=0),p===u.msecs?(u.nsecs++,u.nsecs>=1e4&&(u.node=void 0,u.nsecs=0)):p>u.msecs?u.nsecs=0:p<u.msecs&&(u.node=void 0),u.node||(u.node=h.slice(10,16),u.node[0]|=1,u.clockseq=(h[8]<<8|h[9])&16383),u.msecs=p,u}e.updateV1State=a;function o(u,p,h,g,f,_,w=0){if(u.length<16)throw new Error("Random bytes length must be >= 16");if(!_)_=new Uint8Array(16),w=0;else if(w<0||w+16>_.length)throw new RangeError(`UUID byte range ${w}:${w+15} is out of buffer bounds`);p??(p=Date.now()),h??(h=0),g??(g=(u[8]<<8|u[9])&16383),f??(f=u.slice(10,16)),p+=122192928e5;const C=((p&268435455)*1e4+h)%4294967296;_[w++]=C>>>24&255,_[w++]=C>>>16&255,_[w++]=C>>>8&255,_[w++]=C&255;const R=p/4294967296*1e4&268435455;_[w++]=R>>>8&255,_[w++]=R&255,_[w++]=R>>>24&15|16,_[w++]=R>>>16&255,_[w++]=g>>>8|128,_[w++]=g&255;for(let S=0;S<6;++S)_[w++]=f[S];return _}e.default=i}}),l_=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v1ToV6.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=rh(),n=la();function r(a){const o=typeof a=="string"?(0,t.default)(a):a,u=i(o);return typeof a=="string"?(0,n.unsafeStringify)(u):u}e.default=r;function i(a){return Uint8Array.of((a[6]&15)<<4|a[7]>>4&15,(a[7]&15)<<4|(a[4]&240)>>4,(a[4]&15)<<4|(a[5]&240)>>4,(a[5]&15)<<4|(a[0]&240)>>4,(a[0]&15)<<4|(a[1]&240)>>4,(a[1]&15)<<4|(a[2]&240)>>4,96|a[2]&15,a[3],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}}}),H3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/md5.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});function t(w){const C=a(w),R=i(C,w.length*8);return n(R)}function n(w){const C=new Uint8Array(w.length*4);for(let R=0;R<w.length*4;R++)C[R]=w[R>>2]>>>R%4*8&255;return C}function r(w){return(w+64>>>9<<4)+14+1}function i(w,C){const R=new Uint32Array(r(C)).fill(0);R.set(w),R[C>>5]|=128<<C%32,R[R.length-1]=C,w=R;let S=1732584193,b=-271733879,x=-1732584194,E=271733878;for(let M=0;M<w.length;M+=16){const Z=S,$=b,z=x,q=E;S=h(S,b,x,E,w[M],7,-680876936),E=h(E,S,b,x,w[M+1],12,-389564586),x=h(x,E,S,b,w[M+2],17,606105819),b=h(b,x,E,S,w[M+3],22,-1044525330),S=h(S,b,x,E,w[M+4],7,-176418897),E=h(E,S,b,x,w[M+5],12,1200080426),x=h(x,E,S,b,w[M+6],17,-1473231341),b=h(b,x,E,S,w[M+7],22,-45705983),S=h(S,b,x,E,w[M+8],7,1770035416),E=h(E,S,b,x,w[M+9],12,-1958414417),x=h(x,E,S,b,w[M+10],17,-42063),b=h(b,x,E,S,w[M+11],22,-1990404162),S=h(S,b,x,E,w[M+12],7,1804603682),E=h(E,S,b,x,w[M+13],12,-40341101),x=h(x,E,S,b,w[M+14],17,-1502002290),b=h(b,x,E,S,w[M+15],22,1236535329),S=g(S,b,x,E,w[M+1],5,-165796510),E=g(E,S,b,x,w[M+6],9,-1069501632),x=g(x,E,S,b,w[M+11],14,643717713),b=g(b,x,E,S,w[M],20,-373897302),S=g(S,b,x,E,w[M+5],5,-701558691),E=g(E,S,b,x,w[M+10],9,38016083),x=g(x,E,S,b,w[M+15],14,-660478335),b=g(b,x,E,S,w[M+4],20,-405537848),S=g(S,b,x,E,w[M+9],5,568446438),E=g(E,S,b,x,w[M+14],9,-1019803690),x=g(x,E,S,b,w[M+3],14,-187363961),b=g(b,x,E,S,w[M+8],20,1163531501),S=g(S,b,x,E,w[M+13],5,-1444681467),E=g(E,S,b,x,w[M+2],9,-51403784),x=g(x,E,S,b,w[M+7],14,1735328473),b=g(b,x,E,S,w[M+12],20,-1926607734),S=f(S,b,x,E,w[M+5],4,-378558),E=f(E,S,b,x,w[M+8],11,-2022574463),x=f(x,E,S,b,w[M+11],16,1839030562),b=f(b,x,E,S,w[M+14],23,-35309556),S=f(S,b,x,E,w[M+1],4,-1530992060),E=f(E,S,b,x,w[M+4],11,1272893353),x=f(x,E,S,b,w[M+7],16,-155497632),b=f(b,x,E,S,w[M+10],23,-1094730640),S=f(S,b,x,E,w[M+13],4,681279174),E=f(E,S,b,x,w[M],11,-358537222),x=f(x,E,S,b,w[M+3],16,-722521979),b=f(b,x,E,S,w[M+6],23,76029189),S=f(S,b,x,E,w[M+9],4,-640364487),E=f(E,S,b,x,w[M+12],11,-421815835),x=f(x,E,S,b,w[M+15],16,530742520),b=f(b,x,E,S,w[M+2],23,-995338651),S=_(S,b,x,E,w[M],6,-198630844),E=_(E,S,b,x,w[M+7],10,1126891415),x=_(x,E,S,b,w[M+14],15,-1416354905),b=_(b,x,E,S,w[M+5],21,-57434055),S=_(S,b,x,E,w[M+12],6,1700485571),E=_(E,S,b,x,w[M+3],10,-1894986606),x=_(x,E,S,b,w[M+10],15,-1051523),b=_(b,x,E,S,w[M+1],21,-2054922799),S=_(S,b,x,E,w[M+8],6,1873313359),E=_(E,S,b,x,w[M+15],10,-30611744),x=_(x,E,S,b,w[M+6],15,-1560198380),b=_(b,x,E,S,w[M+13],21,1309151649),S=_(S,b,x,E,w[M+4],6,-145523070),E=_(E,S,b,x,w[M+11],10,-1120210379),x=_(x,E,S,b,w[M+2],15,718787259),b=_(b,x,E,S,w[M+9],21,-343485551),S=o(S,Z),b=o(b,$),x=o(x,z),E=o(E,q)}return Uint32Array.of(S,b,x,E)}function a(w){if(w.length===0)return new Uint32Array;const C=new Uint32Array(r(w.length*8)).fill(0);for(let R=0;R<w.length;R++)C[R>>2]|=(w[R]&255)<<R%4*8;return C}function o(w,C){const R=(w&65535)+(C&65535);return(w>>16)+(C>>16)+(R>>16)<<16|R&65535}function u(w,C){return w<<C|w>>>32-C}function p(w,C,R,S,b,x){return o(u(o(o(C,w),o(S,x)),b),R)}function h(w,C,R,S,b,x,E){return p(C&R|~C&S,w,C,b,x,E)}function g(w,C,R,S,b,x,E){return p(C&S|R&~S,w,C,b,x,E)}function f(w,C,R,S,b,x,E){return p(C^R^S,w,C,b,x,E)}function _(w,C,R,S,b,x,E){return p(R^(C|~S),w,C,b,x,E)}e.default=t}}),gd=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v35.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=e.stringToBytes=void 0;var t=rh(),n=la();function r(a){a=unescape(encodeURIComponent(a));const o=new Uint8Array(a.length);for(let u=0;u<a.length;++u)o[u]=a.charCodeAt(u);return o}e.stringToBytes=r,e.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",e.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function i(a,o,u,p,h,g){const f=typeof u=="string"?r(u):u,_=typeof p=="string"?(0,t.default)(p):p;if(typeof p=="string"&&(p=(0,t.default)(p)),(p==null?void 0:p.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let w=new Uint8Array(16+f.length);if(w.set(_),w.set(f,_.length),w=o(w),w[6]=w[6]&15|a,w[8]=w[8]&63|128,h){g=g||0;for(let C=0;C<16;++C)h[g+C]=w[C];return h}return(0,n.unsafeStringify)(w)}e.default=i}}),V3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v3.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;var t=H3(),n=gd(),r=gd();Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return r.URL}});function i(a,o,u,p){return(0,n.default)(48,t.default,a,o,u,p)}i.DNS=n.DNS,i.URL=n.URL,e.default=i}}),q3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/native.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);e.default={randomUUID:t}}}),z3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v4.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=q3(),n=Zm(),r=la();function i(a,o,u){var p,h,g;if(t.default.randomUUID&&!o&&!a)return t.default.randomUUID();a=a||{};const f=(g=(h=a.random)!=null?h:(p=a.rng)==null?void 0:p.call(a))!=null?g:(0,n.default)();if(f.length<16)throw new Error("Random bytes length must be >= 16");if(f[6]=f[6]&15|64,f[8]=f[8]&63|128,o){if(u=u||0,u<0||u+16>o.length)throw new RangeError(`UUID byte range ${u}:${u+15} is out of buffer bounds`);for(let _=0;_<16;++_)o[u+_]=f[_];return o}return(0,r.unsafeStringify)(f)}e.default=i}}),K3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/sha1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});function t(i,a,o,u){switch(i){case 0:return a&o^~a&u;case 1:return a^o^u;case 2:return a&o^a&u^o&u;case 3:return a^o^u}}function n(i,a){return i<<a|i>>>32-a}function r(i){const a=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520],u=new Uint8Array(i.length+1);u.set(i),u[i.length]=128,i=u;const p=i.length/4+2,h=Math.ceil(p/16),g=new Array(h);for(let f=0;f<h;++f){const _=new Uint32Array(16);for(let w=0;w<16;++w)_[w]=i[f*64+w*4]<<24|i[f*64+w*4+1]<<16|i[f*64+w*4+2]<<8|i[f*64+w*4+3];g[f]=_}g[h-1][14]=(i.length-1)*8/Math.pow(2,32),g[h-1][14]=Math.floor(g[h-1][14]),g[h-1][15]=(i.length-1)*8&4294967295;for(let f=0;f<h;++f){const _=new Uint32Array(80);for(let x=0;x<16;++x)_[x]=g[f][x];for(let x=16;x<80;++x)_[x]=n(_[x-3]^_[x-8]^_[x-14]^_[x-16],1);let w=o[0],C=o[1],R=o[2],S=o[3],b=o[4];for(let x=0;x<80;++x){const E=Math.floor(x/20),M=n(w,5)+t(E,C,R,S)+b+a[E]+_[x]>>>0;b=S,S=R,R=n(C,30)>>>0,C=w,w=M}o[0]=o[0]+w>>>0,o[1]=o[1]+C>>>0,o[2]=o[2]+R>>>0,o[3]=o[3]+S>>>0,o[4]=o[4]+b>>>0}return Uint8Array.of(o[0]>>24,o[0]>>16,o[0]>>8,o[0],o[1]>>24,o[1]>>16,o[1]>>8,o[1],o[2]>>24,o[2]>>16,o[2]>>8,o[2],o[3]>>24,o[3]>>16,o[3]>>8,o[3],o[4]>>24,o[4]>>16,o[4]>>8,o[4])}e.default=r}}),$3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v5.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;var t=K3(),n=gd(),r=gd();Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return r.URL}});function i(a,o,u,p){return(0,n.default)(80,t.default,a,o,u,p)}i.DNS=n.DNS,i.URL=n.URL,e.default=i}}),W3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v6.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=la(),n=c_(),r=l_();function i(a,o,u){a??(a={}),u??(u=0);let p=(0,n.default)(Se(ie({},a),{_v6:!0}),new Uint8Array(16));if(p=(0,r.default)(p),o){for(let h=0;h<16;h++)o[u+h]=p[h];return o}return(0,t.unsafeStringify)(p)}e.default=i}}),G3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v6ToV1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=rh(),n=la();function r(a){const o=typeof a=="string"?(0,t.default)(a):a,u=i(o);return typeof a=="string"?(0,n.unsafeStringify)(u):u}e.default=r;function i(a){return Uint8Array.of((a[3]&15)<<4|a[4]>>4&15,(a[4]&15)<<4|(a[5]&240)>>4,(a[5]&15)<<4|a[6]&15,a[7],(a[1]&15)<<4|(a[2]&240)>>4,(a[2]&15)<<4|(a[3]&240)>>4,16|(a[0]&240)>>4,(a[0]&15)<<4|(a[1]&240)>>4,a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}}}),J3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v7.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.updateV7State=void 0;var t=Zm(),n=la(),r={};function i(u,p,h){var g,f,_;let w;if(u)w=o((_=(f=u.random)!=null?f:(g=u.rng)==null?void 0:g.call(u))!=null?_:(0,t.default)(),u.msecs,u.seq,p,h);else{const C=Date.now(),R=(0,t.default)();a(r,C,R),w=o(R,r.msecs,r.seq,p,h)}return p??(0,n.unsafeStringify)(w)}function a(u,p,h){var g,f;return(g=u.msecs)!=null||(u.msecs=-1/0),(f=u.seq)!=null||(u.seq=0),p>u.msecs?(u.seq=h[6]<<23|h[7]<<16|h[8]<<8|h[9],u.msecs=p):(u.seq=u.seq+1|0,u.seq===0&&u.msecs++),u}e.updateV7State=a;function o(u,p,h,g,f=0){if(u.length<16)throw new Error("Random bytes length must be >= 16");if(!g)g=new Uint8Array(16),f=0;else if(f<0||f+16>g.length)throw new RangeError(`UUID byte range ${f}:${f+15} is out of buffer bounds`);return p??(p=Date.now()),h??(h=u[6]*127<<24|u[7]<<16|u[8]<<8|u[9]),g[f++]=p/1099511627776&255,g[f++]=p/4294967296&255,g[f++]=p/16777216&255,g[f++]=p/65536&255,g[f++]=p/256&255,g[f++]=p&255,g[f++]=112|h>>>28&15,g[f++]=h>>>20&255,g[f++]=128|h>>>14&63,g[f++]=h>>>6&255,g[f++]=h<<2&255|u[10]&3,g[f++]=u[11],g[f++]=u[12],g[f++]=u[13],g[f++]=u[14],g[f++]=u[15],g}e.default=i}}),Z3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/version.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=nh();function n(r){if(!(0,t.default)(r))throw TypeError("Invalid UUID");return parseInt(r.slice(14,15),16)}e.default=n}}),X3=ke({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.validate=e.v7=e.v6ToV1=e.v6=e.v5=e.v4=e.v3=e.v1ToV6=e.v1=e.stringify=e.parse=e.NIL=e.MAX=void 0;var t=j3();Object.defineProperty(e,"MAX",{enumerable:!0,get:function(){return t.default}});var n=B3();Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return n.default}});var r=rh();Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return r.default}});var i=la();Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return i.default}});var a=c_();Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return a.default}});var o=l_();Object.defineProperty(e,"v1ToV6",{enumerable:!0,get:function(){return o.default}});var u=V3();Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return u.default}});var p=z3();Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return p.default}});var h=$3();Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return h.default}});var g=W3();Object.defineProperty(e,"v6",{enumerable:!0,get:function(){return g.default}});var f=G3();Object.defineProperty(e,"v6ToV1",{enumerable:!0,get:function(){return f.default}});var _=J3();Object.defineProperty(e,"v7",{enumerable:!0,get:function(){return _.default}});var w=nh();Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return w.default}});var C=Z3();Object.defineProperty(e,"version",{enumerable:!0,get:function(){return C.default}})}}),Q3=ke({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/FakeEventTarget.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeEventTarget=void 0;var t=class{constructor(){me(this,"listeners",{})}addEventListener(n,r,i={}){var a,o;r&&((o=(a=this.listeners)[n])!=null||(a[n]=[]),this.listeners[n].push({callback:r,once:i.once===!0}))}removeEventListener(n,r){this.listeners[n]&&(this.listeners[n]=this.listeners[n].filter(i=>i.callback!==r))}dispatchEvent(n){if(!n||typeof n.type!="string")throw new Error("invalid event object");const r=this.listeners[n.type];if(!r)return!0;for(const i of[...r]){try{i.callback.call(this,n)}catch(a){setTimeout(()=>{throw a},0)}i.once&&this.removeEventListener(n.type,i.callback)}return!n.defaultPrevented}};e.FakeEventTarget=t}}),Y3=ke({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.clone=t;function t(n){if(n!==void 0)return Number.isNaN(n)?NaN:typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n))}}}),ex=ke({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeMediaStreamTrack=void 0;var t=X3(),n=Q3(),r=Y3(),i,a,o,u,p,h,g,f,_,w,C,R,S,b,x,E,M=class u_ extends n.FakeEventTarget{constructor({kind:z,id:q,label:Q,contentHint:K,enabled:ee,muted:ae,readyState:le,capabilities:ne,constraints:Re,settings:ve,data:_e}){super(),dr(this,i),dr(this,a),dr(this,o),dr(this,u),dr(this,p),dr(this,h),dr(this,g),dr(this,f),dr(this,_),dr(this,w),dr(this,C),dr(this,R,null),dr(this,S,null),dr(this,b,null),dr(this,x,null),dr(this,E,null),hn(this,i,q??(0,t.v4)()),hn(this,a,z),hn(this,o,Q??""),hn(this,g,K??""),hn(this,p,ee??!0),hn(this,h,ae??!1),hn(this,u,le??"live"),hn(this,f,ne??{}),hn(this,_,Re??{}),hn(this,w,ve??{}),hn(this,C,_e??{})}get id(){return Et(this,i)}get kind(){return Et(this,a)}get label(){return Et(this,o)}get contentHint(){return Et(this,g)}set contentHint(z){hn(this,g,z)}get enabled(){return Et(this,p)}set enabled(z){const q=Et(this,p)!==z;hn(this,p,z),q&&this.dispatchEvent(new Event("enabledchange"))}get muted(){return Et(this,h)}get readyState(){return Et(this,u)}get data(){return Et(this,C)}set data(z){hn(this,C,z)}get onmute(){return Et(this,R)}set onmute(z){Et(this,R)&&this.removeEventListener("mute",Et(this,R)),hn(this,R,z),z&&this.addEventListener("mute",z)}get onunmute(){return Et(this,S)}set onunmute(z){Et(this,S)&&this.removeEventListener("unmute",Et(this,S)),hn(this,S,z),z&&this.addEventListener("unmute",z)}get onended(){return Et(this,b)}set onended(z){Et(this,b)&&this.removeEventListener("ended",Et(this,b)),hn(this,b,z),z&&this.addEventListener("ended",z)}get onenabledchange(){return Et(this,x)}set onenabledchange(z){Et(this,x)&&this.removeEventListener("enabledchange",Et(this,x)),hn(this,x,z),z&&this.addEventListener("enabledchange",z)}get onstopped(){return Et(this,E)}set onstopped(z){Et(this,E)&&this.removeEventListener("stopped",Et(this,E)),hn(this,E,z),z&&this.addEventListener("stopped",z)}addEventListener(z,q,Q){super.addEventListener(z,q,Q)}removeEventListener(z,q){super.removeEventListener(z,q)}stop(){Et(this,u)!=="ended"&&(hn(this,u,"ended"),this.dispatchEvent(new Event("stopped")))}clone({id:z,data:q}={}){return new u_({id:z??(0,t.v4)(),kind:Et(this,a),label:Et(this,o),contentHint:Et(this,g),enabled:Et(this,p),muted:Et(this,h),readyState:Et(this,u),capabilities:(0,r.clone)(Et(this,f)),constraints:(0,r.clone)(Et(this,_)),settings:(0,r.clone)(Et(this,w)),data:q??(0,r.clone)(Et(this,C))})}getCapabilities(){return Et(this,f)}getConstraints(){return Et(this,_)}applyConstraints(){return H(this,arguments,function*(z={}){return hn(this,_,z),Promise.resolve()})}getSettings(){return Et(this,w)}remoteStop(){Et(this,u)!=="ended"&&(hn(this,u,"ended"),this.dispatchEvent(new Event("stopped")),this.dispatchEvent(new Event("ended")))}remoteMute(){Et(this,h)||(hn(this,h,!0),this.dispatchEvent(new Event("mute")))}remoteUnmute(){Et(this,h)&&(hn(this,h,!1),this.dispatchEvent(new Event("unmute")))}};i=new WeakMap,a=new WeakMap,o=new WeakMap,u=new WeakMap,p=new WeakMap,h=new WeakMap,g=new WeakMap,f=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,R=new WeakMap,S=new WeakMap,b=new WeakMap,x=new WeakMap,E=new WeakMap;var Z=M;e.FakeMediaStreamTrack=Z}}),tx=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/FakeHandler.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeHandler=void 0;var t=ex(),n=ti(),r=Wr(),i=Vo(),a=Es(),o=Mi(),u=new r.Logger("FakeHandler"),p="FakeHandler",h=class Mu extends n.EnhancedEventEmitter{constructor({getSendExtendedRtpCapabilities:_},w){super(),me(this,"_closed",!1),me(this,"_fakeParameters"),me(this,"_getSendExtendedRtpCapabilities"),me(this,"_cname",`CNAME-${i.generateRandomNumber()}`),me(this,"_transportReady",!1),me(this,"_nextLocalId",1),me(this,"_tracks",new Map),me(this,"_nextSctpStreamId",0),u.debug("constructor()"),this._getSendExtendedRtpCapabilities=_,this._fakeParameters=w}static createFactory(_){return{name:p,factory:w=>new Mu(w,_),getNativeRtpCapabilities:()=>H(null,null,function*(){return u.debug("getNativeRtpCapabilities()"),Mu.getLocalRtpCapabilities(_)}),getNativeSctpCapabilities:()=>H(null,null,function*(){return u.debug("getNativeSctpCapabilities()"),_.generateNativeSctpCapabilities()})}}static getLocalRtpCapabilities(_){return _.generateNativeRtpCapabilities()}get name(){return p}close(){u.debug("close()"),!this._closed&&(this._closed=!0,super.close())}setIceGatheringState(_){this.emit("@icegatheringstatechange",_)}setConnectionState(_){this.emit("@connectionstatechange",_)}updateIceServers(_){return H(this,null,function*(){this.assertNotClosed(),u.debug("updateIceServers()")})}restartIce(_){return H(this,null,function*(){this.assertNotClosed(),u.debug("restartIce()")})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),new Map})}send(_){return H(this,arguments,function*({track:w,encodings:C,codecOptions:R,codec:S}){this.assertNotClosed(),u.debug("send() [kind:%s, track.id:%s]",w.kind,w.id),this._transportReady||(yield this.setupTransport({localDtlsRole:"server"}));const b=Mu.getLocalRtpCapabilities(this._fakeParameters),x=this._getSendExtendedRtpCapabilities(b),E=a.getSendingRtpParameters(w.kind,x);E.codecs=a.reduceCodecs(E.codecs,S);const M=E.codecs.some($=>/.+\/rtx$/i.test($.mimeType));E.mid=`mid-${i.generateRandomNumber()}`,C||(C=[{}]);for(const $ of C)$.ssrc=i.generateRandomNumber(),M&&($.rtx={ssrc:i.generateRandomNumber()});E.encodings=C,E.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const Z=this._nextLocalId++;return this._tracks.set(Z,w),{localId:String(Z),rtpParameters:E}})}stopSending(_){return H(this,null,function*(){if(u.debug("stopSending() [localId:%s]",_),!this._closed){if(!this._tracks.has(Number(_)))throw new Error("local track not found");this._tracks.delete(Number(_))}})}pauseSending(_){return H(this,null,function*(){this.assertNotClosed()})}resumeSending(_){return H(this,null,function*(){this.assertNotClosed()})}replaceTrack(_,w){return H(this,null,function*(){this.assertNotClosed(),w?u.debug("replaceTrack() [localId:%s, track.id:%s]",_,w.id):u.debug("replaceTrack() [localId:%s, no track]",_),this._tracks.delete(Number(_)),this._tracks.set(Number(_),w)})}setMaxSpatialLayer(_,w){return H(this,null,function*(){this.assertNotClosed(),u.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",_,w)})}setRtpEncodingParameters(_,w){return H(this,null,function*(){this.assertNotClosed(),u.debug("setRtpEncodingParameters() [localId:%s, params:%o]",_,w)})}getSenderStats(_){return H(this,null,function*(){return this.assertNotClosed(),new Map})}sendDataChannel(_){return H(this,arguments,function*({ordered:w,maxPacketLifeTime:C,maxRetransmits:R,label:S,protocol:b}){this.assertNotClosed(),this._transportReady||(yield this.setupTransport({localDtlsRole:"server"})),u.debug("sendDataChannel()");const x=new g({id:this._nextSctpStreamId++,ordered:w,maxPacketLifeTime:C,maxRetransmits:R,label:S,protocol:b}),E={streamId:this._nextSctpStreamId,ordered:w,maxPacketLifeTime:C,maxRetransmits:R};return{dataChannel:x,sctpStreamParameters:E}})}receive(_){return H(this,null,function*(){this.assertNotClosed();const w=[];for(const C of _){const{trackId:R,kind:S}=C;this._transportReady||(yield this.setupTransport({localDtlsRole:"client"})),u.debug("receive() [trackId:%s, kind:%s]",R,S);const b=this._nextLocalId++,x=new t.FakeMediaStreamTrack({kind:S});this._tracks.set(b,x),w.push({localId:String(b),track:x})}return w})}stopReceiving(_){return H(this,null,function*(){if(!this._closed)for(const w of _)u.debug("stopReceiving() [localId:%s]",w),this._tracks.delete(Number(w))})}pauseReceiving(_){return H(this,null,function*(){this.assertNotClosed()})}resumeReceiving(_){return H(this,null,function*(){this.assertNotClosed()})}getReceiverStats(_){return H(this,null,function*(){return this.assertNotClosed(),new Map})}receiveDataChannel(_){return H(this,arguments,function*({sctpStreamParameters:w,label:C,protocol:R}){return this.assertNotClosed(),this._transportReady||(yield this.setupTransport({localDtlsRole:"client"})),u.debug("receiveDataChannel()"),{dataChannel:new g({id:w.streamId,ordered:w.ordered,maxPacketLifeTime:w.maxPacketLifeTime,maxRetransmits:w.maxRetransmits,label:C,protocol:R})}})}setupTransport(_){return H(this,arguments,function*({localDtlsRole:w,localSdpObject:C}){const R=i.clone(this._fakeParameters.generateLocalDtlsParameters());w&&(R.role=w),this.emit("@connectionstatechange","connecting"),yield new Promise((S,b)=>this.emit("@connect",{dtlsParameters:R},S,b)),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new o.InvalidStateError("method called in a closed handler")}};e.FakeHandler=h;var g=class extends EventTarget{constructor({id:f,ordered:_=!0,maxPacketLifeTime:w=null,maxRetransmits:C=null,label:R="",protocol:S=""}){super(),me(this,"_id"),me(this,"_negotiated",!0),me(this,"_ordered"),me(this,"_maxPacketLifeTime"),me(this,"_maxRetransmits"),me(this,"_label"),me(this,"_protocol"),me(this,"_readyState","connecting"),me(this,"_bufferedAmount",0),me(this,"_bufferedAmountLowThreshold",0),me(this,"_binaryType","arraybuffer"),me(this,"_onopen",null),me(this,"_onclosing",null),me(this,"_onclose",null),me(this,"_onmessage",null),me(this,"_onbufferedamountlow",null),me(this,"_onerror",null),u.debug(`constructor() [id:${f}, ordered:${_}, maxPacketLifeTime:${w}, maxRetransmits:${C}, label:${R}, protocol:${S}`),this._id=f,this._ordered=_,this._maxPacketLifeTime=w,this._maxRetransmits=C,this._label=R,this._protocol=S}get id(){return this._id}get negotiated(){return this._negotiated}get ordered(){return this._ordered}get maxPacketLifeTime(){return this._maxPacketLifeTime}get maxRetransmits(){return this._maxRetransmits}get label(){return this._label}get protocol(){return this._protocol}get readyState(){return this._readyState}get bufferedAmount(){return this._bufferedAmount}get bufferedAmountLowThreshold(){return this._bufferedAmountLowThreshold}set bufferedAmountLowThreshold(f){this._bufferedAmountLowThreshold=f}get binaryType(){return this._binaryType}set binaryType(f){this._binaryType=f}get onopen(){return this._onopen}set onopen(f){this._onopen&&this.removeEventListener("open",this._onopen),this._onopen=f,f&&this.addEventListener("open",f)}get onclosing(){return this._onclosing}set onclosing(f){this._onclosing&&this.removeEventListener("closing",this._onclosing),this._onclosing=f,f&&this.addEventListener("closing",f)}get onclose(){return this._onclose}set onclose(f){this._onclose&&this.removeEventListener("close",this._onclose),this._onclose=f,f&&this.addEventListener("close",f)}get onmessage(){return this._onmessage}set onmessage(f){this._onmessage&&this.removeEventListener("message",this._onmessage),this._onmessage=f,f&&this.addEventListener("message",f)}get onbufferedamountlow(){return this._onbufferedamountlow}set onbufferedamountlow(f){this._onbufferedamountlow&&this.removeEventListener("bufferedamountlow",this._onbufferedamountlow),this._onbufferedamountlow=f,f&&this.addEventListener("bufferedamountlow",f)}get onerror(){return this._onerror}set onerror(f){this._onerror&&this.removeEventListener("error",this._onerror),this._onerror=f,f&&this.addEventListener("error",f)}addEventListener(f,_,w){super.addEventListener(f,_,w)}removeEventListener(f,_,w){super.removeEventListener(f,_,w)}close(){["closing","closed"].includes(this._readyState)||(this._readyState="closed")}send(f){if(this._readyState!=="open")throw new o.InvalidStateError("not open")}}}}),nx=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/test/fakeParameters.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.generateRouterRtpCapabilities=r,e.generateNativeRtpCapabilities=i,e.generateNativeSctpCapabilities=a,e.generateLocalDtlsParameters=o,e.generateTransportRemoteParameters=u,e.generateProducerRemoteParameters=p,e.generateConsumerRemoteParameters=h,e.generateDataProducerRemoteParameters=g,e.generateDataConsumerRemoteParameters=f;var t=Vo();function n(){return String(t.generateRandomNumber())}function r(){return t.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}},{mimeType:"video/H264",kind:"video",preferredPayloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:105,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"profile-id":0,"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:106,clockRate:9e4,rtcpFeedback:[],parameters:{apt:105}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id",preferredId:2,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id",preferredId:3,preferredEncrypt:!1,direction:"recvonly"},{kind:"audio",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:11,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:12,preferredEncrypt:!1,direction:"sendrecv"}]})}function i(){return t.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:111,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{minptime:10,useinbandfec:1}},{mimeType:"audio/ISAC",kind:"audio",preferredPayloadType:103,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/CN",kind:"audio",preferredPayloadType:106,clockRate:32e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/foo",kind:"audio",preferredPayloadType:107,clockRate:9e4,channels:4,rtcpFeedback:[{type:"foo-qwe-qwe"}],parameters:{foo:"lalala"}},{mimeType:"video/BAZCODEC",kind:"video",preferredPayloadType:100,clockRate:9e4,rtcpFeedback:[{type:"foo"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[],parameters:{apt:100}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:96,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:97,clockRate:9e4,rtcpFeedback:[],parameters:{apt:96}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:98,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{"profile-id":0}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:99,clockRate:9e4,rtcpFeedback:[],parameters:{apt:98}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:2},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:3},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:4},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",preferredId:6},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",preferredId:7},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing",preferredId:8},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10}]})}function a(){return t.deepFreeze({numStreams:{OS:2048,MIS:2048}})}function o(){return t.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"82:5A:68:3D:36:C3:0A:DE:AF:E7:32:43:D2:88:83:57:AC:2D:65:E5:80:C4:B6:FB:AF:1A:A0:21:9F:6D:0C:AD"}],role:"auto"})}function u(){return{id:n(),iceParameters:t.deepFreeze({iceLite:!0,password:"yku5ej8nvfaor28lvtrabcx0wkrpkztz",usernameFragment:"h3hk1iz6qqlnqlne"}),iceCandidates:t.deepFreeze([{foundation:"udpcandidate",address:"9.9.9.9",ip:"9.9.9.9",port:40533,priority:1078862079,protocol:"udp",type:"host",tcpType:"passive"},{foundation:"udpcandidate",address:"9.9.9.9",ip:"9:9:9:9:9:9",port:41333,priority:1078862089,protocol:"udp",type:"host",tcpType:"passive"}]),dtlsParameters:t.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"A9:F4:E0:D2:74:D3:0F:D9:CA:A5:2F:9F:7F:47:FA:F0:C4:72:DD:73:49:D0:3B:14:90:20:51:30:1B:90:8E:71"},{algorithm:"sha-384",value:"03:D9:0B:87:13:98:F6:6D:BC:FC:92:2E:39:D4:E1:97:32:61:30:56:84:70:81:6E:D1:82:97:EA:D9:C1:21:0F:6B:C5:E7:7F:E1:97:0C:17:97:6E:CF:B3:EF:2E:74:B0"},{algorithm:"sha-512",value:"84:27:A4:28:A4:73:AF:43:02:2A:44:68:FF:2F:29:5C:3B:11:9A:60:F4:A8:F0:F5:AC:A0:E3:49:3E:B1:34:53:A9:85:CE:51:9B:ED:87:5E:B8:F4:8E:3D:FA:20:51:B8:96:EE:DA:56:DC:2F:5C:62:79:15:23:E0:21:82:2B:2C"}],role:"auto"}),sctpParameters:t.deepFreeze({port:5e3,OS:2048,MIS:2048,maxMessageSize:2e6})}}function p(){return t.deepFreeze({id:n()})}function h({id:_,codecMimeType:w}={}){switch(w){case"audio/opus":return{id:_??n(),producerId:n(),kind:"audio",rtpParameters:t.deepFreeze({codecs:[{mimeType:"audio/opus",payloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}}],encodings:[{ssrc:46687003}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",id:10}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"audio/ISAC":return{id:_??n(),producerId:n(),kind:"audio",rtpParameters:t.deepFreeze({codecs:[{mimeType:"audio/ISAC",payloadType:111,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}}],encodings:[{ssrc:46687004}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/VP8":return{id:_??n(),producerId:n(),kind:"video",rtpParameters:t.deepFreeze({codecs:[{mimeType:"video/VP8",payloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",payloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}}],encodings:[{ssrc:99991111,rtx:{ssrc:99991112}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/H264":return{id:_??n(),producerId:n(),kind:"video",rtpParameters:t.deepFreeze({codecs:[{mimeType:"video/H264",payloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",payloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}}],encodings:[{ssrc:99991113,rtx:{ssrc:99991114}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};default:throw new TypeError(`unknown codecMimeType '${w}'`)}}function g(){return t.deepFreeze({id:n()})}function f({id:_}={}){return{id:_??n(),dataProducerId:n(),sctpStreamParameters:t.deepFreeze({streamId:666,maxPacketLifeTime:5e3,maxRetransmits:void 0})}}}}),rx=ke({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.testFakeParameters=e.FakeHandler=e.enhancedEvents=e.ortc=e.parseScalabilityMode=e.detectDeviceAsync=e.detectDevice=e.Device=e.version=e.types=void 0;var t=eh();e.debug=t.default,e.types=_3(),e.version="3.15.2";var n=L3();Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return n.Device}}),Object.defineProperty(e,"detectDevice",{enumerable:!0,get:function(){return n.detectDevice}}),Object.defineProperty(e,"detectDeviceAsync",{enumerable:!0,get:function(){return n.detectDeviceAsync}});var r=qo();Object.defineProperty(e,"parseScalabilityMode",{enumerable:!0,get:function(){return r.parse}}),e.ortc=Es(),e.enhancedEvents=ti();var i=tx();Object.defineProperty(e,"FakeHandler",{enumerable:!0,get:function(){return i.FakeHandler}}),e.testFakeParameters=nx()}});Y();Y();Y();Y();Y();Y();Y();var Mv=["disable","error","warn","info","debug"],$a=class js{constructor(t){this.debug=(...n)=>(this._log("debug",...n),Date.now()),this.info=(...n)=>(this._log("info",...n),Date.now()),this.warn=(...n)=>{this._log("warn",...n)},this.error=(...n)=>{this._log("error",...n)},this.elapsed=(n,...r)=>{const i=Date.now()-n;this._log("info",`elapsed ms:${i}`,...r)},this.prefix=t}_log(t,...n){const r=Mv.indexOf(t);if(Mv.indexOf(js.level)>=r){const a=new Date,o=js.formatter.formatToParts(a),u=_=>{var w;return(w=o.find(C=>C.type===_))==null?void 0:w.value},p=String(a.getMilliseconds()).padStart(3,"0"),h=`${u("year")}-${u("month")}-${u("day")}T${u("hour")}:${u("minute")}:${u("second")}.${p}+09:00`;n=[this.prefix,...n].map(_=>{if(_ instanceof Error)return _.toJSON?_.toJSON():{name:_.name,message:_.message,stack:_.stack};if(typeof _=="object")try{return JSON.parse(JSON.stringify(_))}catch{return"json error"}return _});let f=[h,t,...n];switch(js.format==="string"&&(f=[h+" "+t+" "+JSON.stringify(n)]),t){case"debug":console.debug(...f);break;case"info":console.info(...f);break;case"warn":console.warn(...f);break;case"error":console.error(...f);break}js.onLog({id:js.id,timestamp:h,level:t,message:n}),js._onLogForAnalytics({id:js.id,timestamp:h,level:t,message:n,prefix:this.prefix})}}createBlock(t){return{warn:(...n)=>{this.warn(ie({},t),...n)},debug:(...n)=>{this.debug(ie({},t),...n)},info:(...n)=>{this.info(ie({},t),...n)},error:(...n)=>{this.error(ie({},t),...n)}}}};$a.level="error";$a.format="object";$a.onLog=()=>{};$a._onLogForAnalytics=()=>{};$a.id=Math.random().toString().slice(2,7);$a.formatter=new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});var Ze=$a,ix=new Ze("packages/common/src/error.ts"),Er=class extends Error{constructor(e,t=!0){if(super(e.info.detail),this.id=Math.random().toString().slice(2,10),Object.assign(this,e),this.name=this.info.name,t){const n=["SkyWayError",`name:${this.info.name}, detail:${this.info.detail}, solution:${this.info.solution}`];this.path&&n.push(this.path),this.error&&n.push(this.error),this.payload&&n.push(this.payload),n.push(this.id),ix.warn(...n)}}toJSON(){return{id:this.id,info:this.info,path:this.path,payload:this.payload,error:this.error,stack:this.stack}}};Y();var sx=new Ze("packages/common/src/event.ts"),Ye=class{constructor(e=()=>{}){this._onSetListener=e,this._stack=[],this._eventIndex=0,this.emit=t=>{for(const n of this._stack)try{n.execute(t)}catch(r){sx.error("task throws error",r)}},this.removeAllListeners=()=>{this._stack=[]},this.pipe=t=>this.add(n=>t.emit(n)),this.add=t=>{const n=this._eventIndex;this._stack.push({execute:t,id:n}),this._eventIndex++;const r=()=>{this._stack=this._stack.filter(a=>a.id!==n&&a)},i=a=>{a.push(r)};return this._onSetListener(),{removeListener:r,disposer:i}},this.once=t=>{const n=this.add(r=>{n.removeListener(),t(r)});return n},this.asPromise=t=>new Promise((n,r)=>{const i=t&&setTimeout(()=>{r(new Lv("Event asPromise timeout : "+t))},t);this.once(a=>{i&&clearTimeout(i),n(a)})}),this.watch=(t,n)=>new Promise((r,i)=>{const a=n&&setTimeout(()=>{i(new Lv("Event watch timeout : "+n))},n),{removeListener:o}=this.add(u=>{t(u)&&(a&&clearTimeout(a),o(),r(u))})})}get length(){return this._stack.length}},es=class{constructor(){this.events=[]}make(){const e=new Ye;return this.events.push(e),e}dispose(){this.events.forEach(e=>e.removeAllListeners()),this.events=[]}},ni=class{constructor(){this._disposer=[]}push(e){this._disposer.push(e)}dispose(){this._disposer.forEach(e=>e()),this._disposer=[]}},Lv=class extends Error{toJSON(){return{name:this.name,message:this.message,stack:this.stack}}};Y();Y();Y();Y();Y();function d_(e,t){return function(){return e.apply(t,arguments)}}var{toString:ax}=Object.prototype,{getPrototypeOf:Xm}=Object,{iterator:ih,toStringTag:h_}=Symbol,sh=(e=>t=>{const n=ax.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Li=e=>(e=e.toLowerCase(),t=>sh(t)===e),ah=e=>t=>typeof t===e,{isArray:zo}=Array,nl=ah("undefined");function ox(e){return e!==null&&!nl(e)&&e.constructor!==null&&!nl(e.constructor)&&zr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}var p_=Li("ArrayBuffer");function cx(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&p_(e.buffer),t}var lx=ah("string"),zr=ah("function"),f_=ah("number"),oh=e=>e!==null&&typeof e=="object",ux=e=>e===!0||e===!1,Lu=e=>{if(sh(e)!=="object")return!1;const t=Xm(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(h_ in e)&&!(ih in e)},dx=Li("Date"),hx=Li("File"),px=Li("Blob"),fx=Li("FileList"),mx=e=>oh(e)&&zr(e.pipe),gx=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||zr(e.append)&&((t=sh(e))==="formdata"||t==="object"&&zr(e.toString)&&e.toString()==="[object FormData]"))},vx=Li("URLSearchParams"),[yx,_x,bx,Sx]=["ReadableStream","Request","Response","Headers"].map(Li),wx=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pl(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),zo(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const a=n?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let u;for(r=0;r<o;r++)u=a[r],t.call(null,e[u],u,e)}}function m_(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}var Ta=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,g_=e=>!nl(e)&&e!==Ta;function Af(){const{caseless:e}=g_(this)&&this||{},t={},n=(r,i)=>{const a=e&&m_(t,i)||i;Lu(t[a])&&Lu(r)?t[a]=Af(t[a],r):Lu(r)?t[a]=Af({},r):zo(r)?t[a]=r.slice():t[a]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Pl(arguments[r],n);return t}var xx=(e,t,n,{allOwnKeys:r}={})=>(Pl(t,(i,a)=>{n&&zr(i)?e[a]=d_(i,n):e[a]=i},{allOwnKeys:r}),e),Cx=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Ex=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Px=(e,t,n,r)=>{let i,a,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)o=i[a],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&Xm(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kx=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},Tx=e=>{if(!e)return null;if(zo(e))return e;let t=e.length;if(!f_(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Rx=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Xm(Uint8Array)),Ax=(e,t)=>{const r=(e&&e[ih]).call(e);let i;for(;(i=r.next())&&!i.done;){const a=i.value;t.call(e,a[0],a[1])}},Ix=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Fx=Li("HTMLFormElement"),Dx=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),jv=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Nx=Li("RegExp"),v_=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Pl(n,(i,a)=>{let o;(o=t(i,a,e))!==!1&&(r[a]=o||i)}),Object.defineProperties(e,r)},Ox=e=>{v_(e,(t,n)=>{if(zr(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(zr(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Mx=(e,t)=>{const n={},r=i=>{i.forEach(a=>{n[a]=!0})};return zo(e)?r(e):r(String(e).split(t)),n},Lx=()=>{},jx=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Bx(e){return!!(e&&zr(e.append)&&e[h_]==="FormData"&&e[ih])}var Ux=e=>{const t=new Array(10),n=(r,i)=>{if(oh(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const a=zo(r)?[]:{};return Pl(r,(o,u)=>{const p=n(o,i+1);!nl(p)&&(a[u]=p)}),t[i]=void 0,a}}return r};return n(e,0)},Hx=Li("AsyncFunction"),Vx=e=>e&&(oh(e)||zr(e))&&zr(e.then)&&zr(e.catch),y_=((e,t)=>e?setImmediate:t?((n,r)=>(Ta.addEventListener("message",({source:i,data:a})=>{i===Ta&&a===n&&r.length&&r.shift()()},!1),i=>{r.push(i),Ta.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",zr(Ta.postMessage)),qx=typeof queueMicrotask<"u"?queueMicrotask.bind(Ta):typeof Co<"u"&&Co.nextTick||y_,zx=e=>e!=null&&zr(e[ih]),Ae={isArray:zo,isArrayBuffer:p_,isBuffer:ox,isFormData:gx,isArrayBufferView:cx,isString:lx,isNumber:f_,isBoolean:ux,isObject:oh,isPlainObject:Lu,isReadableStream:yx,isRequest:_x,isResponse:bx,isHeaders:Sx,isUndefined:nl,isDate:dx,isFile:hx,isBlob:px,isRegExp:Nx,isFunction:zr,isStream:mx,isURLSearchParams:vx,isTypedArray:Rx,isFileList:fx,forEach:Pl,merge:Af,extend:xx,trim:wx,stripBOM:Cx,inherits:Ex,toFlatObject:Px,kindOf:sh,kindOfTest:Li,endsWith:kx,toArray:Tx,forEachEntry:Ax,matchAll:Ix,isHTMLForm:Fx,hasOwnProperty:jv,hasOwnProp:jv,reduceDescriptors:v_,freezeMethods:Ox,toObjectSet:Mx,toCamelCase:Dx,noop:Lx,toFiniteNumber:jx,findKey:m_,global:Ta,isContextDefined:g_,isSpecCompliantForm:Bx,toJSONObject:Ux,isAsyncFn:Hx,isThenable:Vx,setImmediate:y_,asap:qx,isIterable:zx};Y();Y();Y();Y();Y();function Do(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Ae.inherits(Do,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ae.toJSONObject(this.config),code:this.code,status:this.status}}});var __=Do.prototype,b_={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{b_[e]={value:e}});Object.defineProperties(Do,b_);Object.defineProperty(__,"isAxiosError",{value:!0});Do.from=(e,t,n,r,i,a)=>{const o=Object.create(__);return Ae.toFlatObject(e,o,function(p){return p!==Error.prototype},u=>u!=="isAxiosError"),Do.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};var Mt=Do;Y();var Kx=null;function If(e){return Ae.isPlainObject(e)||Ae.isArray(e)}function S_(e){return Ae.endsWith(e,"[]")?e.slice(0,-2):e}function Bv(e,t,n){return e?e.concat(t).map(function(i,a){return i=S_(i),!n&&a?"["+i+"]":i}).join(n?".":""):t}function $x(e){return Ae.isArray(e)&&!e.some(If)}var Wx=Ae.toFlatObject(Ae,{},null,function(t){return/^is[A-Z]/.test(t)});function Gx(e,t,n){if(!Ae.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Ae.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(R,S){return!Ae.isUndefined(S[R])});const r=n.metaTokens,i=n.visitor||g,a=n.dots,o=n.indexes,p=(n.Blob||typeof Blob<"u"&&Blob)&&Ae.isSpecCompliantForm(t);if(!Ae.isFunction(i))throw new TypeError("visitor must be a function");function h(C){if(C===null)return"";if(Ae.isDate(C))return C.toISOString();if(Ae.isBoolean(C))return C.toString();if(!p&&Ae.isBlob(C))throw new Mt("Blob is not supported. Use a Buffer instead.");return Ae.isArrayBuffer(C)||Ae.isTypedArray(C)?p&&typeof Blob=="function"?new Blob([C]):Buffer.from(C):C}function g(C,R,S){let b=C;if(C&&!S&&typeof C=="object"){if(Ae.endsWith(R,"{}"))R=r?R:R.slice(0,-2),C=JSON.stringify(C);else if(Ae.isArray(C)&&$x(C)||(Ae.isFileList(C)||Ae.endsWith(R,"[]"))&&(b=Ae.toArray(C)))return R=S_(R),b.forEach(function(E,M){!(Ae.isUndefined(E)||E===null)&&t.append(o===!0?Bv([R],M,a):o===null?R:R+"[]",h(E))}),!1}return If(C)?!0:(t.append(Bv(S,R,a),h(C)),!1)}const f=[],_=Object.assign(Wx,{defaultVisitor:g,convertValue:h,isVisitable:If});function w(C,R){if(!Ae.isUndefined(C)){if(f.indexOf(C)!==-1)throw Error("Circular reference detected in "+R.join("."));f.push(C),Ae.forEach(C,function(b,x){(!(Ae.isUndefined(b)||b===null)&&i.call(t,b,Ae.isString(x)?x.trim():x,R,_))===!0&&w(b,R?R.concat(x):[x])}),f.pop()}}if(!Ae.isObject(e))throw new TypeError("data must be an object");return w(e),t}var ch=Gx;function Uv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function w_(e,t){this._pairs=[],e&&ch(e,this,t)}var x_=w_.prototype;x_.append=function(t,n){this._pairs.push([t,n])};x_.toString=function(t){const n=t?function(r){return t.call(this,r,Uv)}:Uv;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};var C_=w_;function Jx(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function E_(e,t,n){if(!t)return e;const r=n&&n.encode||Jx;Ae.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let a;if(i?a=i(t,n):a=Ae.isURLSearchParams(t)?t.toString():new C_(t,n).toString(r),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}Y();var Zx=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ae.forEach(this.handlers,function(n){n!==null&&e(n)})}},Hv=Zx;Y();Y();Y();Y();var P_={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};Y();Y();Y();Y();var Xx=typeof URLSearchParams<"u"?URLSearchParams:C_;Y();var Qx=typeof FormData<"u"?FormData:null;Y();var Yx=typeof Blob<"u"?Blob:null,eC={isBrowser:!0,classes:{URLSearchParams:Xx,FormData:Qx,Blob:Yx},protocols:["http","https","file","blob","url","data"]},k_={};By(k_,{hasBrowserEnv:()=>Qm,hasStandardBrowserEnv:()=>tC,hasStandardBrowserWebWorkerEnv:()=>nC,navigator:()=>Ff,origin:()=>rC});Y();var Qm=typeof window<"u"&&typeof document<"u",Ff=typeof navigator=="object"&&navigator||void 0,tC=Qm&&(!Ff||["ReactNative","NativeScript","NS"].indexOf(Ff.product)<0),nC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",rC=Qm&&window.location.href||"http://localhost",fr=ie(ie({},k_),eC);function iC(e,t){return ch(e,new fr.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,a){return fr.isNode&&Ae.isBuffer(n)?(this.append(r,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}Y();function sC(e){return Ae.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function aC(e){const t={},n=Object.keys(e);let r;const i=n.length;let a;for(r=0;r<i;r++)a=n[r],t[a]=e[a];return t}function oC(e){function t(n,r,i,a){let o=n[a++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),p=a>=n.length;return o=!o&&Ae.isArray(i)?i.length:o,p?(Ae.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!Ae.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],a)&&Ae.isArray(i[o])&&(i[o]=aC(i[o])),!u)}if(Ae.isFormData(e)&&Ae.isFunction(e.entries)){const n={};return Ae.forEachEntry(e,(r,i)=>{t(sC(r),i,n,0)}),n}return null}var T_=oC;function cC(e,t,n){if(Ae.isString(e))try{return(t||JSON.parse)(e),Ae.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}var Ym={transitional:P_,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,a=Ae.isObject(t);if(a&&Ae.isHTMLForm(t)&&(t=new FormData(t)),Ae.isFormData(t))return i?JSON.stringify(T_(t)):t;if(Ae.isArrayBuffer(t)||Ae.isBuffer(t)||Ae.isStream(t)||Ae.isFile(t)||Ae.isBlob(t)||Ae.isReadableStream(t))return t;if(Ae.isArrayBufferView(t))return t.buffer;if(Ae.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return iC(t,this.formSerializer).toString();if((u=Ae.isFileList(t))||r.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return ch(u?{"files[]":t}:t,p&&new p,this.formSerializer)}}return a||i?(n.setContentType("application/json",!1),cC(t)):t}],transformResponse:[function(t){const n=this.transitional||Ym.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(Ae.isResponse(t)||Ae.isReadableStream(t))return t;if(t&&Ae.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Mt.from(u,Mt.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:fr.classes.FormData,Blob:fr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ae.forEach(["delete","get","head","post","put","patch"],e=>{Ym.headers[e]={}});var eg=Ym;Y();Y();var lC=Ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),uC=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&lC[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Vv=Symbol("internals");function mc(e){return e&&String(e).trim().toLowerCase()}function ju(e){return e===!1||e==null?e:Ae.isArray(e)?e.map(ju):String(e)}function dC(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}var hC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function vp(e,t,n,r,i){if(Ae.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!Ae.isString(t)){if(Ae.isString(r))return t.indexOf(r)!==-1;if(Ae.isRegExp(r))return r.test(t)}}function pC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function fC(e,t){const n=Ae.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,a,o){return this[r].call(this,t,i,a,o)},configurable:!0})})}var lh=class{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(o,u,p){const h=mc(u);if(!h)throw new Error("header name must be a non-empty string");const g=Ae.findKey(r,h);(!g||r[g]===void 0||p===!0||p===void 0&&r[g]!==!1)&&(r[g||u]=ju(o))}const a=(o,u)=>Ae.forEach(o,(p,h)=>i(p,h,u));if(Ae.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(Ae.isString(e)&&(e=e.trim())&&!hC(e))a(uC(e),t);else if(Ae.isObject(e)&&Ae.isIterable(e)){let o={},u,p;for(const h of e){if(!Ae.isArray(h))throw TypeError("Object iterator must return a key-value pair");o[p=h[0]]=(u=o[p])?Ae.isArray(u)?[...u,h[1]]:[u,h[1]]:h[1]}a(o,t)}else e!=null&&i(t,e,n);return this}get(e,t){if(e=mc(e),e){const n=Ae.findKey(this,e);if(n){const r=this[n];if(!t)return r;if(t===!0)return dC(r);if(Ae.isFunction(t))return t.call(this,r,n);if(Ae.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=mc(e),e){const n=Ae.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||vp(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let r=!1;function i(a){if(a=mc(a),a){const o=Ae.findKey(n,a);o&&(!t||vp(n,n[o],o,t))&&(delete n[o],r=!0)}}return Ae.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];(!e||vp(this,this[i],i,e,!0))&&(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return Ae.forEach(this,(r,i)=>{const a=Ae.findKey(n,i);if(a){t[a]=ju(r),delete t[i];return}const o=e?pC(i):String(i).trim();o!==i&&delete t[i],t[o]=ju(r),n[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Ae.forEach(this,(n,r)=>{n!=null&&n!==!1&&(t[r]=e&&Ae.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(r=>n.set(r)),n}static accessor(e){const n=(this[Vv]=this[Vv]={accessors:{}}).accessors,r=this.prototype;function i(a){const o=mc(a);n[o]||(fC(r,a),n[o]=!0)}return Ae.isArray(e)?e.forEach(i):i(e),this}};lh.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ae.reduceDescriptors(lh.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});Ae.freezeMethods(lh);var Ii=lh;function yp(e,t){const n=this||eg,r=t||n,i=Ii.from(r.headers);let a=r.data;return Ae.forEach(e,function(u){a=u.call(n,a,i.normalize(),t?t.status:void 0)}),i.normalize(),a}Y();function R_(e){return!!(e&&e.__CANCEL__)}Y();function A_(e,t,n){Mt.call(this,e??"canceled",Mt.ERR_CANCELED,t,n),this.name="CanceledError"}Ae.inherits(A_,Mt,{__CANCEL__:!0});var kl=A_;Y();Y();Y();function I_(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Mt("Request failed with status code "+n.status,[Mt.ERR_BAD_REQUEST,Mt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}Y();function mC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}Y();Y();function gC(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,a=0,o;return t=t!==void 0?t:1e3,function(p){const h=Date.now(),g=r[a];o||(o=h),n[i]=p,r[i]=h;let f=a,_=0;for(;f!==i;)_+=n[f++],f=f%e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),h-o<t)return;const w=g&&h-g;return w?Math.round(_*1e3/w):void 0}}var vC=gC;Y();function yC(e,t){let n=0,r=1e3/t,i,a;const o=(h,g=Date.now())=>{n=g,i=null,a&&(clearTimeout(a),a=null),e.apply(null,h)};return[(...h)=>{const g=Date.now(),f=g-n;f>=r?o(h,g):(i=h,a||(a=setTimeout(()=>{a=null,o(i)},r-f)))},()=>i&&o(i)]}var _C=yC,vd=(e,t,n=3)=>{let r=0;const i=vC(50,250);return _C(a=>{const o=a.loaded,u=a.lengthComputable?a.total:void 0,p=o-r,h=i(p),g=o<=u;r=o;const f={loaded:o,total:u,progress:u?o/u:void 0,bytes:p,rate:h||void 0,estimated:h&&u&&g?(u-o)/h:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(f)},n)},qv=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},zv=e=>(...t)=>Ae.asap(()=>e(...t));Y();Y();var bC=fr.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,fr.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(fr.origin),fr.navigator&&/(msie|trident)/i.test(fr.navigator.userAgent)):()=>!0;Y();var SC=fr.hasStandardBrowserEnv?{write(e,t,n,r,i,a){const o=[e+"="+encodeURIComponent(t)];Ae.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Ae.isString(r)&&o.push("path="+r),Ae.isString(i)&&o.push("domain="+i),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};Y();Y();function wC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}Y();function xC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function F_(e,t,n){let r=!wC(t);return e&&(r||n==!1)?xC(e,t):t}Y();var Kv=e=>e instanceof Ii?ie({},e):e;function Ha(e,t){t=t||{};const n={};function r(h,g,f,_){return Ae.isPlainObject(h)&&Ae.isPlainObject(g)?Ae.merge.call({caseless:_},h,g):Ae.isPlainObject(g)?Ae.merge({},g):Ae.isArray(g)?g.slice():g}function i(h,g,f,_){if(Ae.isUndefined(g)){if(!Ae.isUndefined(h))return r(void 0,h,f,_)}else return r(h,g,f,_)}function a(h,g){if(!Ae.isUndefined(g))return r(void 0,g)}function o(h,g){if(Ae.isUndefined(g)){if(!Ae.isUndefined(h))return r(void 0,h)}else return r(void 0,g)}function u(h,g,f){if(f in t)return r(h,g);if(f in e)return r(void 0,h)}const p={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(h,g,f)=>i(Kv(h),Kv(g),f,!0)};return Ae.forEach(Object.keys(Object.assign({},e,t)),function(g){const f=p[g]||i,_=f(e[g],t[g],g);Ae.isUndefined(_)&&f!==u||(n[g]=_)}),n}var D_=e=>{const t=Ha({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:u}=t;t.headers=o=Ii.from(o),t.url=E_(F_(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let p;if(Ae.isFormData(n)){if(fr.hasStandardBrowserEnv||fr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((p=o.getContentType())!==!1){const[h,...g]=p?p.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...g].join("; "))}}if(fr.hasStandardBrowserEnv&&(r&&Ae.isFunction(r)&&(r=r(t)),r||r!==!1&&bC(t.url))){const h=i&&a&&SC.read(a);h&&o.set(i,h)}return t},CC=typeof XMLHttpRequest<"u",EC=CC&&function(e){return new Promise(function(n,r){const i=D_(e);let a=i.data;const o=Ii.from(i.headers).normalize();let{responseType:u,onUploadProgress:p,onDownloadProgress:h}=i,g,f,_,w,C;function R(){w&&w(),C&&C(),i.cancelToken&&i.cancelToken.unsubscribe(g),i.signal&&i.signal.removeEventListener("abort",g)}let S=new XMLHttpRequest;S.open(i.method.toUpperCase(),i.url,!0),S.timeout=i.timeout;function b(){if(!S)return;const E=Ii.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),Z={data:!u||u==="text"||u==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:E,config:e,request:S};I_(function(z){n(z),R()},function(z){r(z),R()},Z),S=null}"onloadend"in S?S.onloadend=b:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(b)},S.onabort=function(){S&&(r(new Mt("Request aborted",Mt.ECONNABORTED,e,S)),S=null)},S.onerror=function(){r(new Mt("Network Error",Mt.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let M=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const Z=i.transitional||P_;i.timeoutErrorMessage&&(M=i.timeoutErrorMessage),r(new Mt(M,Z.clarifyTimeoutError?Mt.ETIMEDOUT:Mt.ECONNABORTED,e,S)),S=null},a===void 0&&o.setContentType(null),"setRequestHeader"in S&&Ae.forEach(o.toJSON(),function(M,Z){S.setRequestHeader(Z,M)}),Ae.isUndefined(i.withCredentials)||(S.withCredentials=!!i.withCredentials),u&&u!=="json"&&(S.responseType=i.responseType),h&&([_,C]=vd(h,!0),S.addEventListener("progress",_)),p&&S.upload&&([f,w]=vd(p),S.upload.addEventListener("progress",f),S.upload.addEventListener("loadend",w)),(i.cancelToken||i.signal)&&(g=E=>{S&&(r(!E||E.type?new kl(null,e,S):E),S.abort(),S=null)},i.cancelToken&&i.cancelToken.subscribe(g),i.signal&&(i.signal.aborted?g():i.signal.addEventListener("abort",g)));const x=mC(i.url);if(x&&fr.protocols.indexOf(x)===-1){r(new Mt("Unsupported protocol "+x+":",Mt.ERR_BAD_REQUEST,e));return}S.send(a||null)})};Y();Y();var PC=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const a=function(h){if(!i){i=!0,u();const g=h instanceof Error?h:this.reason;r.abort(g instanceof Mt?g:new kl(g instanceof Error?g.message:g))}};let o=t&&setTimeout(()=>{o=null,a(new Mt(`timeout ${t} of ms exceeded`,Mt.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(a):h.removeEventListener("abort",a)}),e=null)};e.forEach(h=>h.addEventListener("abort",a));const{signal:p}=r;return p.unsubscribe=()=>Ae.asap(u),p}},kC=PC;Y();var TC=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},RC=function(e,t){return Hy(this,null,function*(){try{for(var n=Yw(AC(e)),r,i,a;r=!(i=yield new Fo(n.next())).done;r=!1){const o=i.value;yield*Vy(TC(o,t))}}catch(o){a=[o]}finally{try{r&&(i=n.return)&&(yield new Fo(i.call(n)))}finally{if(a)throw a[0]}}})},AC=function(e){return Hy(this,null,function*(){if(e[Symbol.asyncIterator]){yield*Vy(e);return}const t=e.getReader();try{for(;;){const{done:n,value:r}=yield new Fo(t.read());if(n)break;yield r}}finally{yield new Fo(t.cancel())}})},$v=(e,t,n,r)=>{const i=RC(e,t);let a=0,o,u=p=>{o||(o=!0,r&&r(p))};return new ReadableStream({pull(p){return H(this,null,function*(){try{const{done:h,value:g}=yield i.next();if(h){u(),p.close();return}let f=g.byteLength;if(n){let _=a+=f;n(_)}p.enqueue(new Uint8Array(g))}catch(h){throw u(h),h}})},cancel(p){return u(p),i.return()}},{highWaterMark:2})},uh=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",N_=uh&&typeof ReadableStream=="function",IC=uh&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):e=>H(null,null,function*(){return new Uint8Array(yield new Response(e).arrayBuffer())})),O_=(e,...t)=>{try{return!!e(...t)}catch{return!1}},FC=N_&&O_(()=>{let e=!1;const t=new Request(fr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Wv=64*1024,Df=N_&&O_(()=>Ae.isReadableStream(new Response("").body)),yd={stream:Df&&(e=>e.body)};uh&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!yd[t]&&(yd[t]=Ae.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Mt(`Response type '${t}' is not supported`,Mt.ERR_NOT_SUPPORT,r)})})})(new Response);var DC=e=>H(null,null,function*(){if(e==null)return 0;if(Ae.isBlob(e))return e.size;if(Ae.isSpecCompliantForm(e))return(yield new Request(fr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Ae.isArrayBufferView(e)||Ae.isArrayBuffer(e))return e.byteLength;if(Ae.isURLSearchParams(e)&&(e=e+""),Ae.isString(e))return(yield IC(e)).byteLength}),NC=(e,t)=>H(null,null,function*(){const n=Ae.toFiniteNumber(e.getContentLength());return n??DC(t)}),OC=uh&&(e=>H(null,null,function*(){let{url:t,method:n,data:r,signal:i,cancelToken:a,timeout:o,onDownloadProgress:u,onUploadProgress:p,responseType:h,headers:g,withCredentials:f="same-origin",fetchOptions:_}=D_(e);h=h?(h+"").toLowerCase():"text";let w=kC([i,a&&a.toAbortSignal()],o),C;const R=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let S;try{if(p&&FC&&n!=="get"&&n!=="head"&&(S=yield NC(g,r))!==0){let Z=new Request(t,{method:"POST",body:r,duplex:"half"}),$;if(Ae.isFormData(r)&&($=Z.headers.get("content-type"))&&g.setContentType($),Z.body){const[z,q]=qv(S,vd(zv(p)));r=$v(Z.body,Wv,z,q)}}Ae.isString(f)||(f=f?"include":"omit");const b="credentials"in Request.prototype;C=new Request(t,Se(ie({},_),{signal:w,method:n.toUpperCase(),headers:g.normalize().toJSON(),body:r,duplex:"half",credentials:b?f:void 0}));let x=yield fetch(C,_);const E=Df&&(h==="stream"||h==="response");if(Df&&(u||E&&R)){const Z={};["status","statusText","headers"].forEach(Q=>{Z[Q]=x[Q]});const $=Ae.toFiniteNumber(x.headers.get("content-length")),[z,q]=u&&qv($,vd(zv(u),!0))||[];x=new Response($v(x.body,Wv,z,()=>{q&&q(),R&&R()}),Z)}h=h||"text";let M=yield yd[Ae.findKey(yd,h)||"text"](x,e);return!E&&R&&R(),yield new Promise((Z,$)=>{I_(Z,$,{data:M,headers:Ii.from(x.headers),status:x.status,statusText:x.statusText,config:e,request:C})})}catch(b){throw R&&R(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new Mt("Network Error",Mt.ERR_NETWORK,e,C),{cause:b.cause||b}):Mt.from(b,b&&b.code,e,C)}})),Nf={http:Kx,xhr:EC,fetch:OC};Ae.forEach(Nf,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});var Gv=e=>`- ${e}`,MC=e=>Ae.isFunction(e)||e===null||e===!1,M_={getAdapter:e=>{e=Ae.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let a=0;a<t;a++){n=e[a];let o;if(r=n,!MC(n)&&(r=Nf[(o=String(n)).toLowerCase()],r===void 0))throw new Mt(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+a]=r}if(!r){const a=Object.entries(i).map(([u,p])=>`adapter ${u} `+(p===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(Gv).join(`
`):" "+Gv(a[0]):"as no adapter specified";throw new Mt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Nf};function _p(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new kl(null,e)}function Jv(e){return _p(e),e.headers=Ii.from(e.headers),e.data=yp.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),M_.getAdapter(e.adapter||eg.adapter)(e).then(function(r){return _p(e),r.data=yp.call(e,e.transformResponse,r),r.headers=Ii.from(r.headers),r},function(r){return R_(r)||(_p(e),r&&r.response&&(r.response.data=yp.call(e,e.transformResponse,r.response),r.response.headers=Ii.from(r.response.headers))),Promise.reject(r)})}Y();Y();var L_="1.10.0",dh={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{dh[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});var Zv={};dh.transitional=function(t,n,r){function i(a,o){return"[Axios v"+L_+"] Transitional option '"+a+"'"+o+(r?". "+r:"")}return(a,o,u)=>{if(t===!1)throw new Mt(i(o," has been removed"+(n?" in "+n:"")),Mt.ERR_DEPRECATED);return n&&!Zv[o]&&(Zv[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,o,u):!0}};dh.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function LC(e,t,n){if(typeof e!="object")throw new Mt("options must be an object",Mt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const a=r[i],o=t[a];if(o){const u=e[a],p=u===void 0||o(u,a,e);if(p!==!0)throw new Mt("option "+a+" must be "+p,Mt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Mt("Unknown option "+a,Mt.ERR_BAD_OPTION)}}var Bu={assertOptions:LC,validators:dh},$i=Bu.validators,_d=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Hv,response:new Hv}}request(e,t){return H(this,null,function*(){try{return yield this._request(e,t)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}})}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ha(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;n!==void 0&&Bu.assertOptions(n,{silentJSONParsing:$i.transitional($i.boolean),forcedJSONParsing:$i.transitional($i.boolean),clarifyTimeoutError:$i.transitional($i.boolean)},!1),r!=null&&(Ae.isFunction(r)?t.paramsSerializer={serialize:r}:Bu.assertOptions(r,{encode:$i.function,serialize:$i.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Bu.assertOptions(t,{baseUrl:$i.spelling("baseURL"),withXsrfToken:$i.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&Ae.merge(i.common,i[t.method]);i&&Ae.forEach(["delete","get","head","post","put","patch","common"],w=>{delete i[w]}),t.headers=Ii.concat(a,i);const o=[];let u=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(t)===!1||(u=u&&C.synchronous,o.unshift(C.fulfilled,C.rejected))});const p=[];this.interceptors.response.forEach(function(C){p.push(C.fulfilled,C.rejected)});let h,g=0,f;if(!u){const w=[Jv.bind(this),void 0];for(w.unshift.apply(w,o),w.push.apply(w,p),f=w.length,h=Promise.resolve(t);g<f;)h=h.then(w[g++],w[g++]);return h}f=o.length;let _=t;for(g=0;g<f;){const w=o[g++],C=o[g++];try{_=w(_)}catch(R){C.call(this,R);break}}try{h=Jv.call(this,_)}catch(w){return Promise.reject(w)}for(g=0,f=p.length;g<f;)h=h.then(p[g++],p[g++]);return h}getUri(e){e=Ha(this.defaults,e);const t=F_(e.baseURL,e.url,e.allowAbsoluteUrls);return E_(t,e.params,e.paramsSerializer)}};Ae.forEach(["delete","get","head","options"],function(t){_d.prototype[t]=function(n,r){return this.request(Ha(r||{},{method:t,url:n,data:(r||{}).data}))}});Ae.forEach(["post","put","patch"],function(t){function n(r){return function(a,o,u){return this.request(Ha(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}_d.prototype[t]=n(),_d.prototype[t+"Form"]=n(!0)});var Uu=_d;Y();var jC=class j_{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const r=this;this.promise.then(i=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](i);r._listeners=null}),this.promise.then=i=>{let a;const o=new Promise(u=>{r.subscribe(u),a=u}).then(i);return o.cancel=function(){r.unsubscribe(a)},o},t(function(a,o,u){r.reason||(r.reason=new kl(a,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new j_(function(i){t=i}),cancel:t}}},BC=jC;Y();function UC(e){return function(n){return e.apply(null,n)}}Y();function HC(e){return Ae.isObject(e)&&e.isAxiosError===!0}Y();var Of={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Of).forEach(([e,t])=>{Of[t]=e});var VC=Of;function B_(e){const t=new Uu(e),n=d_(Uu.prototype.request,t);return Ae.extend(n,Uu.prototype,t,{allOwnKeys:!0}),Ae.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return B_(Ha(e,i))},n}var Ln=B_(eg);Ln.Axios=Uu;Ln.CanceledError=kl;Ln.CancelToken=BC;Ln.isCancel=R_;Ln.VERSION=L_;Ln.toFormData=ch;Ln.AxiosError=Mt;Ln.Cancel=Ln.CanceledError;Ln.all=function(t){return Promise.all(t)};Ln.spread=UC;Ln.isAxiosError=HC;Ln.mergeConfig=Ha;Ln.AxiosHeaders=Ii;Ln.formToJSON=e=>T_(Ae.isHTMLForm(e)?new FormData(e):e);Ln.getAdapter=M_.getAdapter;Ln.HttpStatusCode=VC;Ln.default=Ln;var Ya=Ln,{Axios:Zk,AxiosError:Xk,CanceledError:Qk,isCancel:Yk,CancelToken:eT,VERSION:tT,all:nT,Cancel:rT,isAxiosError:iT,spread:sT,toFormData:aT,AxiosHeaders:oT,HttpStatusCode:cT,formToJSON:lT,getAdapter:uT,mergeConfig:dT}=Ya,_i=new Ze("packages/common/src/http.ts"),tg=class{constructor(e){this.api=Ya.create({baseURL:e})}get(e,t){return H(this,null,function*(){const n=yield this.api.get(e,t).catch(r=>r);if(Ya.isAxiosError(n)){const r=Se(ie({},n.response),{message:n.message});if(t!=null&&t.retry){if(yield t.retry(r))return _i.warn("retry get",{url:e}),this.get(e,t);throw _i.warn("retry get failed",{url:e}),r}throw _i.warn("response error",{error:r}),r}else return n.data})}post(e,t,n){return H(this,null,function*(){var r,i,a;const o=yield this.api.post(e,t,n).catch(u=>u);if(Ya.isAxiosError(o)){const u={data:(r=o.response)==null?void 0:r.data,status:(i=o.response)==null?void 0:i.status,statusText:(a=o.response)==null?void 0:a.statusText,message:o.message};if(_i.warn("error received",u),n!=null&&n.retry){const p=yield n.retry(u);if(p)return _i.warn("retry post",e,{data:t,error:u,needRetry:p}),this.post(e,t,n);throw u}throw u}else return o.data})}put(e,t,n){return H(this,null,function*(){const r=yield this.api.put(e,t,n).catch(i=>i);if(Ya.isAxiosError(r)){const i=Se(ie({},r.response),{message:r.message});if(n!=null&&n.retry){if(yield n.retry(i))return _i.warn("retry put",{url:e,data:t}),this.put(e,t,n);throw _i.warn("retry put failed",{url:e,data:t}),i}throw _i.warn("response error",{error:i}),i}else return r.data})}delete(e,t){return H(this,null,function*(){const n=yield this.api.delete(e,t).catch(r=>r);if(Ya.isAxiosError(n)){const r=Se(ie({},n.response),{message:n.message});if(t!=null&&t.retry){if(yield t.retry(r))return _i.warn("retry delete",{url:e}),this.delete(e,t);throw _i.warn("retry delete failed",{url:e}),r}throw _i.warn("response error",{error:r}),r}else return n.data})}};Y();var qC=new Ze("packages/common/src/promise.ts"),ua=class{constructor(){this.id=Math.random().toString().slice(2),this.queue=[],this.running=!1,this.push=e=>new Promise((t,n)=>{this.queue.push({promise:e,done:t,failed:n}),this.running||this.run().catch(r=>{qC.error("push",r)})})}run(){return H(this,null,function*(){const e=this.queue.shift();if(e){this.running=!0;try{const t=yield e.promise();e.done(t)}catch(t){e.failed(t)}yield this.run()}else this.running=!1})}};Y();var ki=class{constructor(e={}){this.count=0,this.times=8,this.interval=100,this.jitter=0,Object.assign(this,e)}wait(){return H(this,null,function*(){if(this.exceeded)return!1;const e=this.timeout;return this.count++,yield new Promise(t=>setTimeout(t,e)),!0})}get timeout(){return Ss(this.count,2)*this.interval+Ss(this.count,2)*this.jitter*Math.random()}get exceeded(){return this.count>=this.times}reset(){this.count=0}},zC=e=>JSON.parse(JSON.stringify(e));Y();var qe={internal:{name:"internal",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},missingProperty:{name:"missingProperty",detail:"",solution:""},notFound:{name:"notFound",detail:"",solution:""},invalidParameter:{name:"invalidParameter",detail:"",solution:""},invalidArgumentValue:{name:"invalidArgumentValue",detail:"",solution:""},invalidContentType:{name:"invalidContentType",detail:"contentType",solution:"ContentType"},localPersonNotJoinedChannel:{name:"localPersonNotJoinedChannel",detail:"PersonChannel The person who tried to operate is not in the channel, so the operation is not possible",solution:"ChannelPerson Please check as you may be operating a person which is not in the channel"},alreadyLocalPersonExist:{name:"alreadyLocalPersonExist",detail:"ChannelLocalPersonChannelLocalPersonJoin",solution:"LocalPersonChannel"},alreadySameNameMemberExist:{name:"alreadySameNameMemberExist",detail:"ChannelNameMember",solution:"Name"},alreadyPublishedStream:{name:"alreadyPublishedStream",detail:"PublishStreamPublish You cannot re-publish a stream that has already been published",solution:"StreamPublishPublicationUnpublishStreamPublish Unpublish the publication that published that stream, or create another new stream and publish it"},alreadySubscribedPublication:{name:"alreadySubscribedPublication",detail:"SubscribePublicationSubscribe",solution:""},invalidTrackKind:{name:"invalidTrackKind",detail:"StreamMediaStreamTrack",solution:"StreamMediaStreamTrack"},cantMoveSameIdChannel:{name:"cantMoveSameIdChannel",detail:"moveChannelidChannel",solution:"Channel"},alreadyChannelClosed:{name:"alreadyChannelClosed",detail:"ChannelClose",solution:""},disabledDataStream:{name:"disabledDataStream",detail:"PublicationDisableDataStream",solution:"PublicationEnable"},publicationNotExist:{name:"publicationNotExist",detail:"channelPublication",solution:"publicationId"},subscriptionNotExist:{name:"subscriptionNotExist",detail:"channelSubscription",solution:"subscriptionId"},unknownMemberType:{name:"unknownMemberType",detail:"MemberSubtype",solution:"MemberSubtype(SfuBot)SkyWayContext"},streamNotExistInSubscription:{name:"streamNotExistInSubscription",detail:"SubscriptionStreamRemoteMemberSubscriptionStream",solution:"Subscription"},streamNotExistInPublication:{name:"streamNotExistInPublication",detail:"PublicationStreamRemoteMemberPublicationStream",solution:"Publication"},dataStreamNotSupportEncoding:{name:"dataStreamNotSupportEncoding",detail:"dataStreamEncode",solution:""},correspondingEncodeNotExistForId:{name:"correspondingEncodeNotExistForId",detail:"IDEncode",solution:"EncodingID"},updateIceParamsFailed:{name:"updateIceParamsFailed",detail:"iceParams",solution:""},invalidElement:{name:"invalidElement",detail:"HTML Element",solution:"Element"},connectRtcApiFailed:{name:"connectRtcApiFailed",detail:"RtcAPI",solution:"Token"},rtcApiFatalError:{name:"rtcApiFatalError",detail:"RtcAPI",solution:""},invalidExpireTokenValue:{name:"invalidExpireTokenValue",detail:"tokenExpire",solution:""},invalidRemindExpireTokenValue:{name:"invalidRemindExpireTokenValue",detail:"tokenExpire",solution:""},invalidTokenAppId:{name:"invalidTokenAppId",detail:"tokenappId",solution:"appIdToken"},mediaDevicesNotFound:{name:"mediaDevicesNotFound",detail:"navigator.mediaDevices",solution:"https,localhost,127.0.0.1"},canNotUseReplaceStream:{name:"canNotUseReplaceStream",detail:"remotePublicationreplaceStream",solution:"PublicationLocal"},canNotEnableRemotePublication:{name:"canNotEnableRemotePublication",detail:"remotePublicationenable",solution:"PublicationLocal"}};Y();Y();Y();var KC=$r(e4());$r(Oi());var $C=$r(qy()),WC=new Ze("packages/core/src/util.ts");function No(e){const t=[];return e.forEach(n=>{t.push(n)}),t}function kt(e){return H(this,arguments,function*({operationName:t,channel:n}){const r={operationName:t,appId:n.appId,channelId:n.id};if(n.localPerson){const i=n.localPerson,a=yield Promise.all(i.publications.map(u=>H(null,null,function*(){var p,h,g;const f={id:u.id,contentType:u.contentType,state:u.state,stats:{},connectionStats:{}};if(u.stream)for(const{memberId:_,stats:w}of yield u.stream._getStatsAll()){const C=w.find(R=>R.type.includes("local-candidate"));f.stats[_]={transportType:(p=C==null?void 0:C.protocol)!=null?p:"none",relayProtocol:(h=C==null?void 0:C.relayProtocol)!=null?h:"none",callType:(g=u.subscriptions.find(R=>R.subscriber.id===_))==null?void 0:g.subscriber.subtype,outbound:w.find(R=>R.type.includes("outbound-rtp")),localCandidate:C}}if(u.stream)for(const{memberId:_,connectionState:w}of u.stream._getConnectionStateAll())f.connectionStats[_]=w;return f})));r.publishing=a;const o=yield Promise.all(i.subscriptions.map(u=>H(null,null,function*(){const p={id:u.id,contentType:u.contentType,stats:{}};if(p.callType=u.publication.publisher.subtype,u.stream){const h=yield u.stream.getStats();p.stats=h.find(f=>f.type.includes("inbound-rtp"));const g=h.find(f=>f.type.includes("local-candidate"));p.transportType=g==null?void 0:g.protocol,p.relayProtocol=g==null?void 0:g.relayProtocol}return u.stream&&(p.connectionState=u.stream.getConnectionState()),p})));r.subscribing=o}return r})}function On({member:e,detail:t,channel:n,operationName:r,payload:i}){const a={operationName:r,payload:i,detail:t};return e&&(a.appId=e.channel.appId,a.channelId=e.channel.id,a.memberId=e.id),n&&(a.appId=n.appId,a.channelId=n.id),a}function Oe({operationName:e,context:t,info:n,error:r,path:i,payload:a,channel:o}){const u={operationName:e,payload:a};return o&&(u.appId=o.appId,u.channelId=o.id,o.localPerson&&(u.memberId=o.localPerson.id)),t&&(u.info=t.info,u.plugins=t.plugins.map(p=>p.subtype)),new Er({error:r,info:n,payload:u,path:i})}var Xv=e=>H(null,[e],function*({stream:t,remoteMember:n,end:r,interval:i,timeout:a}){return new Promise((o,u)=>H(null,null,function*(){i??(i=100),a??(a=1e4);for(let p=0;;p+=i){if(p>=a){u(Oe({operationName:"Peer.waitForStats",info:Se(ie({},qe.timeout),{detail:"waitForStats timeout"}),path:WC.prefix}));break}const h=yield t._getStats(n);if(r(h)){o(h);break}yield new Promise(g=>setTimeout(g,i))}}))}),GC=(e,t)=>{var n,r;return U_((r=(n=e.find(i=>i.payload===t))==null?void 0:n.config)!=null?r:"")},U_=e=>e.split(";").reduce((n,r)=>{const[i,a]=r.split("=");return i&&(n[i]=isNaN(Number(a))?a:Number(a)),n},{}),H_=({isNotBrowser:e}={})=>{if(e)return e;const t=KC.default.getParser(window.navigator.userAgent),n=t.getOSName(),r=t.getOSVersion(),i=t.getBrowserName(),a=t.getBrowserVersion();return{browserName:i,browserVersion:a,osName:n,osVersion:r}};function Qv(){var e,t,n,r,i,a,o,u;if(typeof navigator=="object"&&navigator.product==="ReactNative")return typeof RTCPeerConnection>"u"?void 0:typeof RTCRtpTransceiver<"u"?"ReactNativeUnifiedPlan":"ReactNative";if(typeof navigator=="object"&&typeof navigator.userAgent=="string"){const p=navigator.userAgent,h=new $C.UAParser(p),g=h.getBrowser(),f=(t=(e=g.name)==null?void 0:e.toLowerCase())!=null?t:"",_=parseInt((n=g.major)!=null?n:"0"),C=(i=(r=h.getEngine().name)==null?void 0:r.toLowerCase())!=null?i:"",R=h.getOS(),S=(o=(a=R.name)==null?void 0:a.toLowerCase())!=null?o:"",b=parseFloat((u=R.version)!=null?u:"0"),x=S==="ios",E=["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(f),M=["firefox","mobile firefox","mobile focus"].includes(f),Z=["safari","mobile safari"].includes(f),$=["edge"].includes(f);if((E||$)&&!x&&_>=111)return"Chrome111";if(E&&!x&&_>=74||$&&!x&&_>=88)return"Chrome74";if(E&&!x&&_>=70)return"Chrome70";if(E&&!x&&_>=67)return"Chrome67";if(E&&!x&&_>=55)return"Chrome55";if(M&&!x&&_>=60)return"Firefox60";if(M&&x&&b>=14.3)return"Safari12";if(Z&&_>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(Z&&_>=11)return"Safari11";if($&&!x&&_>=11&&_<=18)return"Edge11";if(C==="webkit"&&x&&b>=14.3&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(C==="blink"){const z=p.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(z){const q=Number(z[1]);return q>=111?"Chrome111":q>=74?"Chrome74":q>=70?"Chrome70":q>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else return}else return}var bp=new Ze("packages/core/src/member/index.ts"),hh=class{constructor(e){this._state="joined",this._events=new es,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.channel=e.channel,this.id=e.id,this.name=e.name,this._metadata=e.metadata,this.context=e.context}get metadata(){return this._metadata}get state(){return this._state}get publications(){return this.channel.publications.filter(e=>e.publisher.id===this.id)}get subscriptions(){return this.channel.subscriptions.filter(e=>e.subscriber.id===this.id)}toJSON(){return{id:this.id,name:this.name,type:this.type,subtype:this.subtype,metadata:this.metadata}}_left(){this._state="left",this.onLeft.emit(),this._events.dispose()}_metadataUpdated(e){this._metadata=e,this.onMetadataUpdated.emit(e)}updateMetadata(e){return H(this,null,function*(){yield this.channel._updateMemberMetadata(this.id,e)})}leave(){return H(this,null,function*(){const e=bp.info("[start] leave",yield kt({operationName:"localPerson.leave",channel:this.channel}));if(this.state==="left")throw Oe({operationName:"localPerson.leave",info:qe.localPersonNotJoinedChannel,path:bp.prefix,context:this.context,channel:this.channel});yield this.channel.leave(this),bp.elapsed(e,"[end] leave")})}};Y();Y();var hu=new Ze("packages/core/src/plugin/internal/unknown/connection.ts"),JC=class{constructor(e,t){this.localPerson=e,this.remoteMember=t,this.type="unknown",this.onDisconnect=new Ye,this.onClose=new Ye,this.closed=!1}close(){this.closed=!0,this.onClose.emit()}startPublishing(e){return H(this,null,function*(){hu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{publication:e})})}stopPublishing(e){return H(this,null,function*(){hu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{publication:e})})}startSubscribing(e){return H(this,null,function*(){hu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{subscription:e})})}stopSubscribing(e){return H(this,null,function*(){hu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{subscription:e})})}},V_=class extends hh{constructor(e){super(e),this.type="bot",this.side="remote",this._connections={},this.plugin=e.plugin,this.subtype=e.subtype}_getConnection(e){return this._connections[e]}_getOrCreateConnection(e){var t;return(t=this._getConnection(e.id))!=null?t:this._createConnection(e,this)}_createConnection(e,t){return new JC(e,t)}_dispose(){}};Y();Y();Y();Y();Y();Y();var q_=new Ze("packages/core/src/media/stream/base.ts");function z_(e,t){var n;if(((n=e??{})==null?void 0:n.srcObject)===void 0)throw Oe({operationName:"attachElement",info:qe.invalidElement,payload:{element:e},path:q_.prefix});if(e.srcObject){const r=e.srcObject,i=r.getTracks().find(o=>o.readyState==="ended");i&&r.removeTrack(i);const a=r.getTracks().find(o=>o.kind===t.kind);a&&r.removeTrack(a),r.addTrack(t)}else e.srcObject=new MediaStream([t])}function K_(e,t){var n;if(((n=e??{})==null?void 0:n.srcObject)===void 0)throw Oe({operationName:"attachElement",info:qe.invalidElement,payload:{element:e},path:q_.prefix});const r=e.srcObject;r.getTracks().length>0&&r.removeTrack(t),r.getTracks().length===0&&(e.srcObject=null)}Y();Y();Y();Y();var pu,ZC=new Uint8Array(16);function XC(){if(!pu&&(pu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pu(ZC)}Y();Y();Y();var QC=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function YC(e){return typeof e=="string"&&QC.test(e)}var eE=YC,Qn=[];for(let e=0;e<256;++e)Qn.push((e+256).toString(16).slice(1));function tE(e,t=0){return Qn[e[t+0]]+Qn[e[t+1]]+Qn[e[t+2]]+Qn[e[t+3]]+"-"+Qn[e[t+4]]+Qn[e[t+5]]+"-"+Qn[e[t+6]]+Qn[e[t+7]]+"-"+Qn[e[t+8]]+Qn[e[t+9]]+"-"+Qn[e[t+10]]+Qn[e[t+11]]+Qn[e[t+12]]+Qn[e[t+13]]+Qn[e[t+14]]+Qn[e[t+15]]}Y();Y();var nE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Yv={randomUUID:nE};function rE(e,t,n){if(Yv.randomUUID&&!t&&!e)return Yv.randomUUID();e=e||{};const r=e.random||(e.rng||XC)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return tE(r)}var ji=rE;Y();var iE=$r(r4());Y();function Mf(e){this.message=e}Mf.prototype=new Error,Mf.prototype.name="InvalidCharacterError";var e1=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new Mf("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,a=0,o="";r=t.charAt(a++);~r&&(n=i%4?64*n+r:r,i++%4)?o+=String.fromCharCode(255&n>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o};function sE(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(n){return decodeURIComponent(e1(n).replace(/(.)/g,function(r,i){var a=i.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}(t)}catch{return e1(t)}}function bd(e){this.message=e}function aE(e,t){if(typeof e!="string")throw new bd("Invalid token specified");var n=(t=t||{}).header===!0?0:1;try{return JSON.parse(sE(e.split(".")[n]))}catch(r){throw new bd("Invalid token specified: "+r.message)}}bd.prototype=new Error,bd.prototype.name="InvalidTokenError";var oE=aE;Y();Y();var Ke={};By(Ke,{BRAND:()=>DE,DIRTY:()=>fo,EMPTY_PATH:()=>dE,INVALID:()=>dt,NEVER:()=>g5,OK:()=>Rr,ParseStatus:()=>Kr,Schema:()=>At,ZodAny:()=>Lo,ZodArray:()=>qa,ZodBigInt:()=>sl,ZodBoolean:()=>al,ZodBranded:()=>ng,ZodCatch:()=>gl,ZodDate:()=>ol,ZodDefault:()=>ml,ZodDiscriminatedUnion:()=>Y_,ZodEffects:()=>Ni,ZodEnum:()=>Tl,ZodError:()=>Fi,ZodFirstPartyTypeKind:()=>ft,ZodFunction:()=>rb,ZodIntersection:()=>dl,ZodIssueCode:()=>Ue,ZodLazy:()=>hl,ZodLiteral:()=>pl,ZodMap:()=>Ed,ZodNaN:()=>kd,ZodNativeEnum:()=>fl,ZodNever:()=>ws,ZodNull:()=>ll,ZodNullable:()=>ia,ZodNumber:()=>il,ZodObject:()=>mi,ZodOptional:()=>Qi,ZodParsedType:()=>Qe,ZodPipeline:()=>rg,ZodPromise:()=>jo,ZodReadonly:()=>vl,ZodRecord:()=>nb,ZodSchema:()=>At,ZodSet:()=>Pd,ZodString:()=>Mo,ZodSymbol:()=>xd,ZodTransformer:()=>Ni,ZodTuple:()=>ra,ZodType:()=>At,ZodUndefined:()=>cl,ZodUnion:()=>ul,ZodUnknown:()=>Na,ZodVoid:()=>Cd,addIssueToContext:()=>We,any:()=>VE,array:()=>$E,bigint:()=>LE,boolean:()=>lb,coerce:()=>m5,custom:()=>ab,date:()=>jE,datetimeRegex:()=>X_,defaultErrorMap:()=>Oo,discriminatedUnion:()=>ZE,effect:()=>r1,enum:()=>s5,function:()=>n5,getErrorMap:()=>Sd,getParsedType:()=>ps,instanceof:()=>OE,intersection:()=>XE,isAborted:()=>jf,isAsync:()=>rl,isDirty:()=>Bf,isValid:()=>Va,late:()=>NE,lazy:()=>r5,literal:()=>i5,makeIssue:()=>wd,map:()=>e5,nan:()=>ME,nativeEnum:()=>a5,never:()=>zE,null:()=>HE,nullable:()=>l5,number:()=>cb,object:()=>WE,objectUtil:()=>Lf,oboolean:()=>f5,onumber:()=>p5,optional:()=>c5,ostring:()=>h5,pipeline:()=>d5,preprocess:()=>u5,promise:()=>o5,quotelessJson:()=>cE,record:()=>YE,set:()=>t5,setErrorMap:()=>uE,strictObject:()=>GE,string:()=>ob,symbol:()=>BE,transformer:()=>r1,tuple:()=>QE,undefined:()=>UE,union:()=>JE,unknown:()=>qE,util:()=>qt,void:()=>KE});Y();Y();Y();Y();Y();var qt;(function(e){e.assertEqual=i=>{};function t(i){}e.assertIs=t;function n(i){throw new Error}e.assertNever=n,e.arrayToEnum=i=>{const a={};for(const o of i)a[o]=o;return a},e.getValidEnumValues=i=>{const a=e.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),o={};for(const u of a)o[u]=i[u];return e.objectValues(o)},e.objectValues=i=>e.objectKeys(i).map(function(a){return i[a]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&a.push(o);return a},e.find=(i,a)=>{for(const o of i)if(a(o))return o},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,a=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(qt||(qt={}));var Lf;(function(e){e.mergeShapes=(t,n)=>ie(ie({},t),n)})(Lf||(Lf={}));var Qe=qt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ps=e=>{switch(typeof e){case"undefined":return Qe.undefined;case"string":return Qe.string;case"number":return Number.isNaN(e)?Qe.nan:Qe.number;case"boolean":return Qe.boolean;case"function":return Qe.function;case"bigint":return Qe.bigint;case"symbol":return Qe.symbol;case"object":return Array.isArray(e)?Qe.array:e===null?Qe.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Qe.promise:typeof Map<"u"&&e instanceof Map?Qe.map:typeof Set<"u"&&e instanceof Set?Qe.set:typeof Date<"u"&&e instanceof Date?Qe.date:Qe.object;default:return Qe.unknown}},Ue=qt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),cE=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),Fi=class $_ extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},r={_errors:[]},i=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let u=r,p=0;for(;p<o.path.length;){const h=o.path[p];p===o.path.length-1?(u[h]=u[h]||{_errors:[]},u[h]._errors.push(n(o))):u[h]=u[h]||{_errors:[]},u=u[h],p++}}};return i(this),r}static assert(t){if(!(t instanceof $_))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,qt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):r.push(t(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}};Fi.create=e=>new Fi(e);var lE=(e,t)=>{let n;switch(e.code){case Ue.invalid_type:e.received===Qe.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Ue.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,qt.jsonStringifyReplacer)}`;break;case Ue.unrecognized_keys:n=`Unrecognized key(s) in object: ${qt.joinValues(e.keys,", ")}`;break;case Ue.invalid_union:n="Invalid input";break;case Ue.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${qt.joinValues(e.options)}`;break;case Ue.invalid_enum_value:n=`Invalid enum value. Expected ${qt.joinValues(e.options)}, received '${e.received}'`;break;case Ue.invalid_arguments:n="Invalid function arguments";break;case Ue.invalid_return_type:n="Invalid function return type";break;case Ue.invalid_date:n="Invalid date";break;case Ue.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:qt.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Ue.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Ue.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Ue.custom:n="Invalid input";break;case Ue.invalid_intersection_types:n="Intersection results could not be merged";break;case Ue.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Ue.not_finite:n="Number must be finite";break;default:n=t.defaultError,qt.assertNever(e)}return{message:n}},Oo=lE,W_=Oo;function uE(e){W_=e}function Sd(){return W_}Y();var wd=e=>{const{data:t,path:n,errorMaps:r,issueData:i}=e,a=[...n,...i.path||[]],o=Se(ie({},i),{path:a});if(i.message!==void 0)return Se(ie({},i),{path:a,message:i.message});let u="";const p=r.filter(h=>!!h).slice().reverse();for(const h of p)u=h(o,{data:t,defaultError:u}).message;return Se(ie({},i),{path:a,message:u})},dE=[];function We(e,t){const n=Sd(),r=wd({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Oo?void 0:Oo].filter(i=>!!i)});e.common.issues.push(r)}var Kr=class G_{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const i of n){if(i.status==="aborted")return dt;i.status==="dirty"&&t.dirty(),r.push(i.value)}return{status:t.value,value:r}}static mergeObjectAsync(t,n){return H(this,null,function*(){const r=[];for(const i of n){const a=yield i.key,o=yield i.value;r.push({key:a,value:o})}return G_.mergeObjectSync(t,r)})}static mergeObjectSync(t,n){const r={};for(const i of n){const{key:a,value:o}=i;if(a.status==="aborted"||o.status==="aborted")return dt;a.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[a.value]=o.value)}return{status:t.value,value:r}}},dt=Object.freeze({status:"aborted"}),fo=e=>({status:"dirty",value:e}),Rr=e=>({status:"valid",value:e}),jf=e=>e.status==="aborted",Bf=e=>e.status==="dirty",Va=e=>e.status==="valid",rl=e=>typeof Promise<"u"&&e instanceof Promise;Y();Y();Y();var at;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(at||(at={}));var Yi=class{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},t1=(e,t)=>{if(Va(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Fi(e.common.issues);return this._error=n,this._error}}};function xt(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(o,u)=>{var p,h;const{message:g}=e;return o.code==="invalid_enum_value"?{message:g??u.defaultError}:typeof u.data>"u"?{message:(p=g??r)!=null?p:u.defaultError}:o.code!=="invalid_type"?{message:u.defaultError}:{message:(h=g??n)!=null?h:u.defaultError}},description:i}}var At=class{get description(){return this._def.description}_getType(e){return ps(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ps(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Kr,ctx:{common:e.parent.common,data:e.data,parsedType:ps(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(rl(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:(n=t==null?void 0:t.async)!=null?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ps(e)},i=this._parseSync({data:e,path:r.path,parent:r});return t1(r,i)}"~validate"(e){var t,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ps(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:r});return Va(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(n=(t=i==null?void 0:i.message)==null?void 0:t.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Va(i)?{value:i.value}:{issues:r.common.issues})}parseAsync(e,t){return H(this,null,function*(){const n=yield this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error})}safeParseAsync(e,t){return H(this,null,function*(){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ps(e)},r=this._parse({data:e,path:n.path,parent:n}),i=yield rl(r)?r:Promise.resolve(r);return t1(n,i)})}refine(e,t){const n=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,i)=>{const a=e(r),o=()=>i.addIssue(ie({code:Ue.custom},n(r)));return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new Ni({schema:this,typeName:ft.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Qi.create(this,this._def)}nullable(){return ia.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return qa.create(this)}promise(){return jo.create(this,this._def)}or(e){return ul.create([this,e],this._def)}and(e){return dl.create(this,e,this._def)}transform(e){return new Ni(Se(ie({},xt(this._def)),{schema:this,typeName:ft.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){const t=typeof e=="function"?e:()=>e;return new ml(Se(ie({},xt(this._def)),{innerType:this,defaultValue:t,typeName:ft.ZodDefault}))}brand(){return new ng(ie({typeName:ft.ZodBranded,type:this},xt(this._def)))}catch(e){const t=typeof e=="function"?e:()=>e;return new gl(Se(ie({},xt(this._def)),{innerType:this,catchValue:t,typeName:ft.ZodCatch}))}describe(e){const t=this.constructor;return new t(Se(ie({},this._def),{description:e}))}pipe(e){return rg.create(this,e)}readonly(){return vl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},hE=/^c[^\s-]{8,}$/i,pE=/^[0-9a-z]+$/,fE=/^[0-9A-HJKMNP-TV-Z]{26}$/i,mE=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,gE=/^[a-z0-9_-]{21}$/i,vE=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,yE=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,_E=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,bE="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Sp,SE=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,wE=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,xE=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,CE=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,EE=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,PE=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,J_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",kE=new RegExp(`^${J_}$`);function Z_(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function TE(e){return new RegExp(`^${Z_(e)}$`)}function X_(e){let t=`${J_}T${Z_(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function RE(e,t){return!!((t==="v4"||!t)&&SE.test(e)||(t==="v6"||!t)&&xE.test(e))}function AE(e,t){if(!vE.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||t&&i.alg!==t)}catch{return!1}}function IE(e,t){return!!((t==="v4"||!t)&&wE.test(e)||(t==="v6"||!t)&&CE.test(e))}var Mo=class Tc extends At{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Qe.string){const a=this._getOrReturnCtx(t);return We(a,{code:Ue.invalid_type,expected:Qe.string,received:a.parsedType}),dt}const r=new Kr;let i;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=t.data.length>a.value,u=t.data.length<a.value;(o||u)&&(i=this._getOrReturnCtx(t,i),o?We(i,{code:Ue.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&We(i,{code:Ue.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")_E.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"email",code:Ue.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Sp||(Sp=new RegExp(bE,"u")),Sp.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"emoji",code:Ue.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")mE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"uuid",code:Ue.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")gE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"nanoid",code:Ue.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")hE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"cuid",code:Ue.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")pE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"cuid2",code:Ue.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")fE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"ulid",code:Ue.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),We(i,{validation:"url",code:Ue.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"regex",code:Ue.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?X_(a).test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?kE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?TE(a).test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?yE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"duration",code:Ue.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?RE(t.data,a.version)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"ip",code:Ue.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?AE(t.data,a.alg)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"jwt",code:Ue.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?IE(t.data,a.version)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"cidr",code:Ue.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?EE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"base64",code:Ue.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?PE.test(t.data)||(i=this._getOrReturnCtx(t,i),We(i,{validation:"base64url",code:Ue.invalid_string,message:a.message}),r.dirty()):qt.assertNever(a);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(i=>t.test(i),ie({validation:n,code:Ue.invalid_string},at.errToObj(r)))}_addCheck(t){return new Tc(Se(ie({},this._def),{checks:[...this._def.checks,t]}))}email(t){return this._addCheck(ie({kind:"email"},at.errToObj(t)))}url(t){return this._addCheck(ie({kind:"url"},at.errToObj(t)))}emoji(t){return this._addCheck(ie({kind:"emoji"},at.errToObj(t)))}uuid(t){return this._addCheck(ie({kind:"uuid"},at.errToObj(t)))}nanoid(t){return this._addCheck(ie({kind:"nanoid"},at.errToObj(t)))}cuid(t){return this._addCheck(ie({kind:"cuid"},at.errToObj(t)))}cuid2(t){return this._addCheck(ie({kind:"cuid2"},at.errToObj(t)))}ulid(t){return this._addCheck(ie({kind:"ulid"},at.errToObj(t)))}base64(t){return this._addCheck(ie({kind:"base64"},at.errToObj(t)))}base64url(t){return this._addCheck(ie({kind:"base64url"},at.errToObj(t)))}jwt(t){return this._addCheck(ie({kind:"jwt"},at.errToObj(t)))}ip(t){return this._addCheck(ie({kind:"ip"},at.errToObj(t)))}cidr(t){return this._addCheck(ie({kind:"cidr"},at.errToObj(t)))}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck(ie({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!=null?n:!1,local:(r=t==null?void 0:t.local)!=null?r:!1},at.errToObj(t==null?void 0:t.message)))}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck(ie({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision},at.errToObj(t==null?void 0:t.message)))}duration(t){return this._addCheck(ie({kind:"duration"},at.errToObj(t)))}regex(t,n){return this._addCheck(ie({kind:"regex",regex:t},at.errToObj(n)))}includes(t,n){return this._addCheck(ie({kind:"includes",value:t,position:n==null?void 0:n.position},at.errToObj(n==null?void 0:n.message)))}startsWith(t,n){return this._addCheck(ie({kind:"startsWith",value:t},at.errToObj(n)))}endsWith(t,n){return this._addCheck(ie({kind:"endsWith",value:t},at.errToObj(n)))}min(t,n){return this._addCheck(ie({kind:"min",value:t},at.errToObj(n)))}max(t,n){return this._addCheck(ie({kind:"max",value:t},at.errToObj(n)))}length(t,n){return this._addCheck(ie({kind:"length",value:t},at.errToObj(n)))}nonempty(t){return this.min(1,at.errToObj(t))}trim(){return new Tc(Se(ie({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new Tc(Se(ie({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new Tc(Se(ie({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}};Mo.create=e=>{var t;return new Mo(ie({checks:[],typeName:ft.ZodString,coerce:(t=e==null?void 0:e.coerce)!=null?t:!1},xt(e)))};function FE(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r,a=Number.parseInt(e.toFixed(i).replace(".","")),o=Number.parseInt(t.toFixed(i).replace(".",""));return a%o/Ss(10,i)}var il=class Uf extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Qe.number){const a=this._getOrReturnCtx(t);return We(a,{code:Ue.invalid_type,expected:Qe.number,received:a.parsedType}),dt}let r;const i=new Kr;for(const a of this._def.checks)a.kind==="int"?qt.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),We(r,{code:Ue.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),We(r,{code:Ue.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),We(r,{code:Ue.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?FE(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),We(r,{code:Ue.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),We(r,{code:Ue.not_finite,message:a.message}),i.dirty()):qt.assertNever(a);return{status:i.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,at.toString(n))}gt(t,n){return this.setLimit("min",t,!1,at.toString(n))}lte(t,n){return this.setLimit("max",t,!0,at.toString(n))}lt(t,n){return this.setLimit("max",t,!1,at.toString(n))}setLimit(t,n,r,i){return new Uf(Se(ie({},this._def),{checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:at.toString(i)}]}))}_addCheck(t){return new Uf(Se(ie({},this._def),{checks:[...this._def.checks,t]}))}int(t){return this._addCheck({kind:"int",message:at.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:at.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:at.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:at.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:at.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:at.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:at.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:at.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:at.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&qt.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}};il.create=e=>new il(ie({checks:[],typeName:ft.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1},xt(e)));var sl=class Hf extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Qe.bigint)return this._getInvalidInput(t);let r;const i=new Kr;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),We(r,{code:Ue.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),We(r,{code:Ue.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),We(r,{code:Ue.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):qt.assertNever(a);return{status:i.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return We(n,{code:Ue.invalid_type,expected:Qe.bigint,received:n.parsedType}),dt}gte(t,n){return this.setLimit("min",t,!0,at.toString(n))}gt(t,n){return this.setLimit("min",t,!1,at.toString(n))}lte(t,n){return this.setLimit("max",t,!0,at.toString(n))}lt(t,n){return this.setLimit("max",t,!1,at.toString(n))}setLimit(t,n,r,i){return new Hf(Se(ie({},this._def),{checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:at.toString(i)}]}))}_addCheck(t){return new Hf(Se(ie({},this._def),{checks:[...this._def.checks,t]}))}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:at.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:at.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:at.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:at.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:at.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}};sl.create=e=>{var t;return new sl(ie({checks:[],typeName:ft.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!=null?t:!1},xt(e)))};var al=class extends At{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Qe.boolean){const n=this._getOrReturnCtx(e);return We(n,{code:Ue.invalid_type,expected:Qe.boolean,received:n.parsedType}),dt}return Rr(e.data)}};al.create=e=>new al(ie({typeName:ft.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1},xt(e)));var ol=class Q_ extends At{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Qe.date){const a=this._getOrReturnCtx(t);return We(a,{code:Ue.invalid_type,expected:Qe.date,received:a.parsedType}),dt}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return We(a,{code:Ue.invalid_date}),dt}const r=new Kr;let i;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(i=this._getOrReturnCtx(t,i),We(i,{code:Ue.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):qt.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Q_(Se(ie({},this._def),{checks:[...this._def.checks,t]}))}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:at.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:at.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}};ol.create=e=>new ol(ie({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:ft.ZodDate},xt(e)));var xd=class extends At{_parse(e){if(this._getType(e)!==Qe.symbol){const n=this._getOrReturnCtx(e);return We(n,{code:Ue.invalid_type,expected:Qe.symbol,received:n.parsedType}),dt}return Rr(e.data)}};xd.create=e=>new xd(ie({typeName:ft.ZodSymbol},xt(e)));var cl=class extends At{_parse(e){if(this._getType(e)!==Qe.undefined){const n=this._getOrReturnCtx(e);return We(n,{code:Ue.invalid_type,expected:Qe.undefined,received:n.parsedType}),dt}return Rr(e.data)}};cl.create=e=>new cl(ie({typeName:ft.ZodUndefined},xt(e)));var ll=class extends At{_parse(e){if(this._getType(e)!==Qe.null){const n=this._getOrReturnCtx(e);return We(n,{code:Ue.invalid_type,expected:Qe.null,received:n.parsedType}),dt}return Rr(e.data)}};ll.create=e=>new ll(ie({typeName:ft.ZodNull},xt(e)));var Lo=class extends At{constructor(){super(...arguments),this._any=!0}_parse(e){return Rr(e.data)}};Lo.create=e=>new Lo(ie({typeName:ft.ZodAny},xt(e)));var Na=class extends At{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Rr(e.data)}};Na.create=e=>new Na(ie({typeName:ft.ZodUnknown},xt(e)));var ws=class extends At{_parse(e){const t=this._getOrReturnCtx(e);return We(t,{code:Ue.invalid_type,expected:Qe.never,received:t.parsedType}),dt}};ws.create=e=>new ws(ie({typeName:ft.ZodNever},xt(e)));var Cd=class extends At{_parse(e){if(this._getType(e)!==Qe.undefined){const n=this._getOrReturnCtx(e);return We(n,{code:Ue.invalid_type,expected:Qe.void,received:n.parsedType}),dt}return Rr(e.data)}};Cd.create=e=>new Cd(ie({typeName:ft.ZodVoid},xt(e)));var qa=class Hu extends At{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),i=this._def;if(n.parsedType!==Qe.array)return We(n,{code:Ue.invalid_type,expected:Qe.array,received:n.parsedType}),dt;if(i.exactLength!==null){const o=n.data.length>i.exactLength.value,u=n.data.length<i.exactLength.value;(o||u)&&(We(n,{code:o?Ue.too_big:Ue.too_small,minimum:u?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(We(n,{code:Ue.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(We(n,{code:Ue.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,u)=>i.type._parseAsync(new Yi(n,o,n.path,u)))).then(o=>Kr.mergeArray(r,o));const a=[...n.data].map((o,u)=>i.type._parseSync(new Yi(n,o,n.path,u)));return Kr.mergeArray(r,a)}get element(){return this._def.type}min(t,n){return new Hu(Se(ie({},this._def),{minLength:{value:t,message:at.toString(n)}}))}max(t,n){return new Hu(Se(ie({},this._def),{maxLength:{value:t,message:at.toString(n)}}))}length(t,n){return new Hu(Se(ie({},this._def),{exactLength:{value:t,message:at.toString(n)}}))}nonempty(t){return this.min(1,t)}};qa.create=(e,t)=>new qa(ie({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ft.ZodArray},xt(t)));function eo(e){if(e instanceof mi){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Qi.create(eo(r))}return new mi(Se(ie({},e._def),{shape:()=>t}))}else return e instanceof qa?new qa(Se(ie({},e._def),{type:eo(e.element)})):e instanceof Qi?Qi.create(eo(e.unwrap())):e instanceof ia?ia.create(eo(e.unwrap())):e instanceof ra?ra.create(e.items.map(t=>eo(t))):e}var mi=class wi extends At{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=qt.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==Qe.object){const h=this._getOrReturnCtx(t);return We(h,{code:Ue.invalid_type,expected:Qe.object,received:h.parsedType}),dt}const{status:r,ctx:i}=this._processInputParams(t),{shape:a,keys:o}=this._getCached(),u=[];if(!(this._def.catchall instanceof ws&&this._def.unknownKeys==="strip"))for(const h in i.data)o.includes(h)||u.push(h);const p=[];for(const h of o){const g=a[h],f=i.data[h];p.push({key:{status:"valid",value:h},value:g._parse(new Yi(i,f,i.path,h)),alwaysSet:h in i.data})}if(this._def.catchall instanceof ws){const h=this._def.unknownKeys;if(h==="passthrough")for(const g of u)p.push({key:{status:"valid",value:g},value:{status:"valid",value:i.data[g]}});else if(h==="strict")u.length>0&&(We(i,{code:Ue.unrecognized_keys,keys:u}),r.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const g of u){const f=i.data[g];p.push({key:{status:"valid",value:g},value:h._parse(new Yi(i,f,i.path,g)),alwaysSet:g in i.data})}}return i.common.async?Promise.resolve().then(()=>H(this,null,function*(){const h=[];for(const g of p){const f=yield g.key,_=yield g.value;h.push({key:f,value:_,alwaysSet:g.alwaysSet})}return h})).then(h=>Kr.mergeObjectSync(r,h)):Kr.mergeObjectSync(r,p)}get shape(){return this._def.shape()}strict(t){return at.errToObj,new wi(ie(Se(ie({},this._def),{unknownKeys:"strict"}),t!==void 0?{errorMap:(n,r)=>{var i,a,o,u;const p=(o=(a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)!=null?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(u=at.errToObj(t).message)!=null?u:p}:{message:p}}}:{}))}strip(){return new wi(Se(ie({},this._def),{unknownKeys:"strip"}))}passthrough(){return new wi(Se(ie({},this._def),{unknownKeys:"passthrough"}))}extend(t){return new wi(Se(ie({},this._def),{shape:()=>ie(ie({},this._def.shape()),t)}))}merge(t){return new wi({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>ie(ie({},this._def.shape()),t._def.shape()),typeName:ft.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new wi(Se(ie({},this._def),{catchall:t}))}pick(t){const n={};for(const r of qt.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new wi(Se(ie({},this._def),{shape:()=>n}))}omit(t){const n={};for(const r of qt.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new wi(Se(ie({},this._def),{shape:()=>n}))}deepPartial(){return eo(this)}partial(t){const n={};for(const r of qt.objectKeys(this.shape)){const i=this.shape[r];t&&!t[r]?n[r]=i:n[r]=i.optional()}return new wi(Se(ie({},this._def),{shape:()=>n}))}required(t){const n={};for(const r of qt.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Qi;)a=a._def.innerType;n[r]=a}return new wi(Se(ie({},this._def),{shape:()=>n}))}keyof(){return ib(qt.objectKeys(this.shape))}};mi.create=(e,t)=>new mi(ie({shape:()=>e,unknownKeys:"strip",catchall:ws.create(),typeName:ft.ZodObject},xt(t)));mi.strictCreate=(e,t)=>new mi(ie({shape:()=>e,unknownKeys:"strict",catchall:ws.create(),typeName:ft.ZodObject},xt(t)));mi.lazycreate=(e,t)=>new mi(ie({shape:e,unknownKeys:"strip",catchall:ws.create(),typeName:ft.ZodObject},xt(t)));var ul=class extends At{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function r(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Fi(o.ctx.common.issues));return We(t,{code:Ue.invalid_union,unionErrors:a}),dt}if(t.common.async)return Promise.all(n.map(i=>H(this,null,function*(){const a=Se(ie({},t),{common:Se(ie({},t.common),{issues:[]}),parent:null});return{result:yield i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}}))).then(r);{let i;const a=[];for(const u of n){const p=Se(ie({},t),{common:Se(ie({},t.common),{issues:[]}),parent:null}),h=u._parseSync({data:t.data,path:t.path,parent:p});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:p}),p.common.issues.length&&a.push(p.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(u=>new Fi(u));return We(t,{code:Ue.invalid_union,unionErrors:o}),dt}}get options(){return this._def.options}};ul.create=(e,t)=>new ul(ie({options:e,typeName:ft.ZodUnion},xt(t)));var us=e=>e instanceof hl?us(e.schema):e instanceof Ni?us(e.innerType()):e instanceof pl?[e.value]:e instanceof Tl?e.options:e instanceof fl?qt.objectValues(e.enum):e instanceof ml?us(e._def.innerType):e instanceof cl?[void 0]:e instanceof ll?[null]:e instanceof Qi?[void 0,...us(e.unwrap())]:e instanceof ia?[null,...us(e.unwrap())]:e instanceof ng||e instanceof vl?us(e.unwrap()):e instanceof gl?us(e._def.innerType):[],Y_=class eb extends At{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Qe.object)return We(n,{code:Ue.invalid_type,expected:Qe.object,received:n.parsedType}),dt;const r=this.discriminator,i=n.data[r],a=this.optionsMap.get(i);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):(We(n,{code:Ue.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),dt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const i=new Map;for(const a of n){const o=us(a.shape[t]);if(!o.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const u of o){if(i.has(u))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(u)}`);i.set(u,a)}}return new eb(ie({typeName:ft.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:i},xt(r)))}};function Vf(e,t){const n=ps(e),r=ps(t);if(e===t)return{valid:!0,data:e};if(n===Qe.object&&r===Qe.object){const i=qt.objectKeys(t),a=qt.objectKeys(e).filter(u=>i.indexOf(u)!==-1),o=ie(ie({},e),t);for(const u of a){const p=Vf(e[u],t[u]);if(!p.valid)return{valid:!1};o[u]=p.data}return{valid:!0,data:o}}else if(n===Qe.array&&r===Qe.array){if(e.length!==t.length)return{valid:!1};const i=[];for(let a=0;a<e.length;a++){const o=e[a],u=t[a],p=Vf(o,u);if(!p.valid)return{valid:!1};i.push(p.data)}return{valid:!0,data:i}}else return n===Qe.date&&r===Qe.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var dl=class extends At{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(i,a)=>{if(jf(i)||jf(a))return dt;const o=Vf(i.value,a.value);return o.valid?((Bf(i)||Bf(a))&&t.dirty(),{status:t.value,value:o.data}):(We(n,{code:Ue.invalid_intersection_types}),dt)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,a])=>r(i,a)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};dl.create=(e,t,n)=>new dl(ie({left:e,right:t,typeName:ft.ZodIntersection},xt(n)));var ra=class tb extends At{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Qe.array)return We(r,{code:Ue.invalid_type,expected:Qe.array,received:r.parsedType}),dt;if(r.data.length<this._def.items.length)return We(r,{code:Ue.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),dt;!this._def.rest&&r.data.length>this._def.items.length&&(We(r,{code:Ue.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((o,u)=>{const p=this._def.items[u]||this._def.rest;return p?p._parse(new Yi(r,o,r.path,u)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>Kr.mergeArray(n,o)):Kr.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new tb(Se(ie({},this._def),{rest:t}))}};ra.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ra(ie({items:e,typeName:ft.ZodTuple,rest:null},xt(t)))};var nb=class qf extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Qe.object)return We(r,{code:Ue.invalid_type,expected:Qe.object,received:r.parsedType}),dt;const i=[],a=this._def.keyType,o=this._def.valueType;for(const u in r.data)i.push({key:a._parse(new Yi(r,u,r.path,u)),value:o._parse(new Yi(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?Kr.mergeObjectAsync(n,i):Kr.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof At?new qf(ie({keyType:t,valueType:n,typeName:ft.ZodRecord},xt(r))):new qf(ie({keyType:Mo.create(),valueType:t,typeName:ft.ZodRecord},xt(n)))}},Ed=class extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Qe.map)return We(n,{code:Ue.invalid_type,expected:Qe.map,received:n.parsedType}),dt;const r=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map(([o,u],p)=>({key:r._parse(new Yi(n,o,n.path,[p,"key"])),value:i._parse(new Yi(n,u,n.path,[p,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(()=>H(this,null,function*(){for(const u of a){const p=yield u.key,h=yield u.value;if(p.status==="aborted"||h.status==="aborted")return dt;(p.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(p.value,h.value)}return{status:t.value,value:o}}))}else{const o=new Map;for(const u of a){const p=u.key,h=u.value;if(p.status==="aborted"||h.status==="aborted")return dt;(p.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(p.value,h.value)}return{status:t.value,value:o}}}};Ed.create=(e,t,n)=>new Ed(ie({valueType:t,keyType:e,typeName:ft.ZodMap},xt(n)));var Pd=class zf extends At{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Qe.set)return We(r,{code:Ue.invalid_type,expected:Qe.set,received:r.parsedType}),dt;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(We(r,{code:Ue.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(We(r,{code:Ue.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const a=this._def.valueType;function o(p){const h=new Set;for(const g of p){if(g.status==="aborted")return dt;g.status==="dirty"&&n.dirty(),h.add(g.value)}return{status:n.value,value:h}}const u=[...r.data.values()].map((p,h)=>a._parse(new Yi(r,p,r.path,h)));return r.common.async?Promise.all(u).then(p=>o(p)):o(u)}min(t,n){return new zf(Se(ie({},this._def),{minSize:{value:t,message:at.toString(n)}}))}max(t,n){return new zf(Se(ie({},this._def),{maxSize:{value:t,message:at.toString(n)}}))}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}};Pd.create=(e,t)=>new Pd(ie({valueType:e,minSize:null,maxSize:null,typeName:ft.ZodSet},xt(t)));var rb=class Vu extends At{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Qe.function)return We(n,{code:Ue.invalid_type,expected:Qe.function,received:n.parsedType}),dt;function r(u,p){return wd({data:u,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Sd(),Oo].filter(h=>!!h),issueData:{code:Ue.invalid_arguments,argumentsError:p}})}function i(u,p){return wd({data:u,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Sd(),Oo].filter(h=>!!h),issueData:{code:Ue.invalid_return_type,returnTypeError:p}})}const a={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof jo){const u=this;return Rr(function(...p){return H(this,null,function*(){const h=new Fi([]),g=yield u._def.args.parseAsync(p,a).catch(w=>{throw h.addIssue(r(p,w)),h}),f=yield Reflect.apply(o,this,g);return yield u._def.returns._def.type.parseAsync(f,a).catch(w=>{throw h.addIssue(i(f,w)),h})})})}else{const u=this;return Rr(function(...p){const h=u._def.args.safeParse(p,a);if(!h.success)throw new Fi([r(p,h.error)]);const g=Reflect.apply(o,this,h.data),f=u._def.returns.safeParse(g,a);if(!f.success)throw new Fi([i(g,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Vu(Se(ie({},this._def),{args:ra.create(t).rest(Na.create())}))}returns(t){return new Vu(Se(ie({},this._def),{returns:t}))}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new Vu(ie({args:t||ra.create([]).rest(Na.create()),returns:n||Na.create(),typeName:ft.ZodFunction},xt(r)))}},hl=class extends At{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};hl.create=(e,t)=>new hl(ie({getter:e,typeName:ft.ZodLazy},xt(t)));var pl=class extends At{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return We(t,{received:t.data,code:Ue.invalid_literal,expected:this._def.value}),dt}return{status:"valid",value:e.data}}get value(){return this._def.value}};pl.create=(e,t)=>new pl(ie({value:e,typeName:ft.ZodLiteral},xt(t)));function ib(e,t){return new Tl(ie({values:e,typeName:ft.ZodEnum},xt(t)))}var Tl=class Kf extends At{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return We(n,{expected:qt.joinValues(r),received:n.parsedType,code:Ue.invalid_type}),dt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return We(n,{received:n.data,code:Ue.invalid_enum_value,options:r}),dt}return Rr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Kf.create(t,ie(ie({},this._def),n))}exclude(t,n=this._def){return Kf.create(this.options.filter(r=>!t.includes(r)),ie(ie({},this._def),n))}};Tl.create=ib;var fl=class extends At{_parse(e){const t=qt.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==Qe.string&&n.parsedType!==Qe.number){const r=qt.objectValues(t);return We(n,{expected:qt.joinValues(r),received:n.parsedType,code:Ue.invalid_type}),dt}if(this._cache||(this._cache=new Set(qt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=qt.objectValues(t);return We(n,{received:n.data,code:Ue.invalid_enum_value,options:r}),dt}return Rr(e.data)}get enum(){return this._def.values}};fl.create=(e,t)=>new fl(ie({values:e,typeName:ft.ZodNativeEnum},xt(t)));var jo=class extends At{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Qe.promise&&t.common.async===!1)return We(t,{code:Ue.invalid_type,expected:Qe.promise,received:t.parsedType}),dt;const n=t.parsedType===Qe.promise?t.data:Promise.resolve(t.data);return Rr(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};jo.create=(e,t)=>new jo(ie({type:e,typeName:ft.ZodPromise},xt(t)));var Ni=class extends At{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ft.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:a=>{We(n,a),a.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),r.type==="preprocess"){const a=r.transform(n.data,i);if(n.common.async)return Promise.resolve(a).then(o=>H(this,null,function*(){if(t.value==="aborted")return dt;const u=yield this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?dt:u.status==="dirty"||t.value==="dirty"?fo(u.value):u}));{if(t.value==="aborted")return dt;const o=this._def.schema._parseSync({data:a,path:n.path,parent:n});return o.status==="aborted"?dt:o.status==="dirty"||t.value==="dirty"?fo(o.value):o}}if(r.type==="refinement"){const a=o=>{const u=r.refinement(o,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?dt:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?dt:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(r.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Va(a))return dt;const o=r.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Va(a)?Promise.resolve(r.transform(a.value,i)).then(o=>({status:t.value,value:o})):dt);qt.assertNever(r)}};Ni.create=(e,t,n)=>new Ni(ie({schema:e,typeName:ft.ZodEffects,effect:t},xt(n)));Ni.createWithPreprocess=(e,t,n)=>new Ni(ie({schema:t,effect:{type:"preprocess",transform:e},typeName:ft.ZodEffects},xt(n)));var Qi=class extends At{_parse(e){return this._getType(e)===Qe.undefined?Rr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Qi.create=(e,t)=>new Qi(ie({innerType:e,typeName:ft.ZodOptional},xt(t)));var ia=class extends At{_parse(e){return this._getType(e)===Qe.null?Rr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ia.create=(e,t)=>new ia(ie({innerType:e,typeName:ft.ZodNullable},xt(t)));var ml=class extends At{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===Qe.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};ml.create=(e,t)=>new ml(ie({innerType:e,typeName:ft.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default},xt(t)));var gl=class extends At{_parse(e){const{ctx:t}=this._processInputParams(e),n=Se(ie({},t),{common:Se(ie({},t.common),{issues:[]})}),r=this._def.innerType._parse({data:n.data,path:n.path,parent:ie({},n)});return rl(r)?r.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Fi(n.common.issues)},input:n.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Fi(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};gl.create=(e,t)=>new gl(ie({innerType:e,typeName:ft.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch},xt(t)));var kd=class extends At{_parse(e){if(this._getType(e)!==Qe.nan){const n=this._getOrReturnCtx(e);return We(n,{code:Ue.invalid_type,expected:Qe.nan,received:n.parsedType}),dt}return{status:"valid",value:e.data}}};kd.create=e=>new kd(ie({typeName:ft.ZodNaN},xt(e)));var DE=Symbol("zod_brand"),ng=class extends At{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},rg=class sb extends At{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return H(this,null,function*(){const a=yield this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?dt:a.status==="dirty"?(n.dirty(),fo(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})});{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?dt:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(t,n){return new sb({in:t,out:n,typeName:ft.ZodPipeline})}},vl=class extends At{_parse(e){const t=this._def.innerType._parse(e),n=r=>(Va(r)&&(r.value=Object.freeze(r.value)),r);return rl(t)?t.then(r=>n(r)):n(t)}unwrap(){return this._def.innerType}};vl.create=(e,t)=>new vl(ie({innerType:e,typeName:ft.ZodReadonly},xt(t)));function n1(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function ab(e,t={},n){return e?Lo.create().superRefine((r,i)=>{var a,o;const u=e(r);if(u instanceof Promise)return u.then(p=>{var h,g;if(!p){const f=n1(t,r),_=(g=(h=f.fatal)!=null?h:n)!=null?g:!0;i.addIssue(Se(ie({code:"custom"},f),{fatal:_}))}});if(!u){const p=n1(t,r),h=(o=(a=p.fatal)!=null?a:n)!=null?o:!0;i.addIssue(Se(ie({code:"custom"},p),{fatal:h}))}}):Lo.create()}var NE={object:mi.lazycreate},ft;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(ft||(ft={}));var OE=(e,t={message:`Input not instance of ${e.name}`})=>ab(n=>n instanceof e,t),ob=Mo.create,cb=il.create,ME=kd.create,LE=sl.create,lb=al.create,jE=ol.create,BE=xd.create,UE=cl.create,HE=ll.create,VE=Lo.create,qE=Na.create,zE=ws.create,KE=Cd.create,$E=qa.create,WE=mi.create,GE=mi.strictCreate,JE=ul.create,ZE=Y_.create,XE=dl.create,QE=ra.create,YE=nb.create,e5=Ed.create,t5=Pd.create,n5=rb.create,r5=hl.create,i5=pl.create,s5=Tl.create,a5=fl.create,o5=jo.create,r1=Ni.create,c5=Qi.create,l5=ia.create,u5=Ni.createWithPreprocess,d5=rg.create,h5=()=>ob().optional(),p5=()=>cb().optional(),f5=()=>lb().optional(),m5={string:e=>Mo.create(Se(ie({},e),{coerce:!0})),number:e=>il.create(Se(ie({},e),{coerce:!0})),boolean:e=>al.create(Se(ie({},e),{coerce:!0})),bigint:e=>sl.create(Se(ie({},e),{coerce:!0})),date:e=>ol.create(Se(ie({},e),{coerce:!0}))},g5=dt,gc=new Ze("packages/token/src/encoder.ts"),yl=class ub{constructor(t){let n;try{n=V5.parse(t)}catch(r){throw r instanceof Ke.ZodError?new Er({path:gc.prefix,info:vc.invalidParameter,error:new Error("Received invalid token. Please check your SkyWayAuthToken.")}):new Er({path:gc.prefix,info:vc.invalidParameter,error:new Error("Received invalid token. Please check your SkyWayAuthToken.")})}Object.assign(this,n)}static Decode(t){try{const n=oE(t),r=new ub(n);return r.tokenString=t,r}catch(n){throw new Er({path:gc.prefix,info:vc.invalidParameter,error:n})}}encode(t){const n={jti:this.jti,iat:this.iat,exp:this.exp,scope:this.scope,version:this.version};return this.tokenString=iE.default.KJUR.jws.JWS.sign("HS256",JSON.stringify({alg:"HS256",typ:"JWT"}),JSON.stringify(n),t),this.tokenString}toJSON(){return{jti:this.jti,iat:this.iat,exp:this.exp,scope:this.scope,encoded:this.tokenString,version:this.version}}getAppId(){switch(this.version){case void 0:case 1:case 2:return this.scope.app.id;case 3:return this.scope.appId;default:throw new Er({path:gc.prefix,info:vc.invalidParameter,error:new Error(`invalid token version: version ${this.version} is not supported.`)})}}getAnalyticsEnabled(){var t,n,r;switch(this.version){case void 0:case 1:case 2:return(t=this.scope.app.analytics)!=null?t:!1;case 3:return(r=(n=this.scope.analytics)==null?void 0:n.enabled)!=null?r:!0;default:throw new Er({path:gc.prefix,info:vc.invalidParameter,error:new Error(`invalid token version: version ${this.version} is not supported.`)})}}};Y();var v5=["create","write","delete"],y5=Ke.object({actions:Ke.array(Ke.enum(v5).refine(e=>typeof e=="string"))}).passthrough(),_5=["create","write","delete"],b5=Ke.object({actions:Ke.array(Ke.enum(_5).refine(e=>typeof e=="string")),forwardings:Ke.array(y5)}).passthrough();Y();var S5=["write","create","delete","updateMetadata","enable","disable"],w5=Ke.object({actions:Ke.array(Ke.enum(S5).refine(e=>typeof e=="string"))}).passthrough(),x5=["write","create","delete"],C5=Ke.object({actions:Ke.array(Ke.enum(x5).refine(e=>typeof e=="string"))}).passthrough(),E5=["write","create","delete","updateMetadata","signal"],P5=Ke.object({id:Ke.string().optional(),name:Ke.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),k5=Ke.intersection(P5,Ke.object({actions:Ke.array(Ke.enum(E5).refine(e=>typeof e=="string")),publication:w5.optional(),subscription:C5.optional()}).passthrough()),T5=["write","read","create","delete","updateMetadata"],R5=Ke.object({id:Ke.string().optional(),name:Ke.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),A5=Ke.intersection(R5,Ke.object({actions:Ke.array(Ke.enum(T5).refine(e=>typeof e=="string")),members:Ke.array(k5),sfuBots:Ke.array(b5).optional()}).passthrough()),I5=["listChannels","read","write"],F5=Ke.object({id:Ke.string(),analytics:Ke.boolean().optional(),actions:Ke.array(Ke.enum(I5).refine(e=>typeof e=="string")).optional(),channels:Ke.array(A5).optional(),turn:Ke.boolean().optional()}).passthrough();Y();var D5=["publish","subscribe","updateMetadata"],N5=Ke.object({id:Ke.string().optional(),name:Ke.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),O5=Ke.intersection(N5,Ke.object({methods:Ke.array(Ke.enum(D5).refine(e=>typeof e=="string"))}).passthrough()),M5=["create","close","updateMetadata"],L5=Ke.object({id:Ke.string().optional(),name:Ke.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),j5=Ke.intersection(L5,Ke.object({methods:Ke.array(Ke.enum(M5).refine(e=>typeof e=="string")),member:O5.optional(),sfu:Ke.object({enabled:Ke.boolean().optional(),maxSubscribersLimit:Ke.number().optional()}).optional()}).passthrough()),B5=Ke.object({appId:Ke.string(),analytics:Ke.object({enabled:Ke.boolean().optional()}).optional(),noiseCancelling:Ke.object({enabled:Ke.boolean().optional()}).optional(),turn:Ke.object({enabled:Ke.boolean().optional()}).optional(),rooms:Ke.array(j5)}).passthrough();Y();var db=Ke.object({jti:Ke.string().uuid(),iat:Ke.number().nonnegative(),exp:Ke.number().nonnegative()}),U5=Ke.intersection(db,Ke.object({scope:Ke.object({app:F5}),version:Ke.union([Ke.literal(1),Ke.literal(2),Ke.literal(void 0)]).optional()})),H5=Ke.intersection(db,Ke.object({scope:B5,version:Ke.literal(3)})),V5=Ke.union([U5,H5]);Y();var vc={invalidParameter:{name:"invalidParameter",detail:"failed to decode token",solution:"Use the correct token according to the specification"}};Y();var i1=()=>Math.floor(Date.now()/1e3),Ko=ji,hb=class{constructor(e){this.contentType=e,this.side="local",this.onConnectionStateChanged=new Ye,this._onConnectionStateChanged=new Ye,this.id=Ko(),this._label="",this.published=!1,this._getTransportCallbacks={},this._getStatsCallbacks={},this._connectionState={},this._onConnectionStateChanged.pipe(this.onConnectionStateChanged)}_setLabel(e){this._label=e}_unpublished(){this.published=!1,this._getTransportCallbacks={},this._getStatsCallbacks={}}_getTransport(e){var t,n;const r=typeof e=="string"?e:e.id;return(n=(t=this._getTransportCallbacks)[r])==null?void 0:n.call(t)}_setConnectionState(e,t){this._connectionState[e.id]!==t&&(this._connectionState[e.id]=t,this._onConnectionStateChanged.emit({remoteMember:e,state:t}))}getStats(e){return this._getStats(e)}_getStats(e){var t,n,r;const i=typeof e=="string"?e:e.id;return(r=(n=(t=this._getStatsCallbacks)[i])==null?void 0:n.call(t))!=null?r:[]}_getStatsAll(){return Promise.all(Object.entries(this._getStatsCallbacks).map(e=>H(this,[e],function*([t,n]){return{memberId:t,stats:yield n().catch(()=>[])}})))}getRTCPeerConnection(e){return this._getRTCPeerConnection(e)}_getRTCPeerConnection(e){var t;return(t=this._getTransport(e))==null?void 0:t.rtcPeerConnection}getConnectionState(e){return this._getConnectionState(e)}_getConnectionState(e){var t;const n=typeof e=="string"?e:e.id;return(t=this._connectionState[n])!=null?t:"new"}_getConnectionStateAll(){return Object.keys(this._getTransportCallbacks).map(e=>({memberId:e,connectionState:this._getConnectionState(e)}))}toJSON(){return{label:this._label,contentType:this.contentType,id:this.id,side:this.side}}},q5=new Ze("packages/core/src/media/stream/local/media.ts"),ig=class extends hb{constructor(e,t,n={}){super(t),this.onTrackUpdated=new Ye,this.onDestroyed=new Ye,this._disposer=new ni,this._trackConstraints={},this._replacingTrack=!1,this._onReplacingTrackDone=new Ye,this._onEnableChanged=new Ye,this._track=e,this._listenTrackEvent(),this._options=n,this._trackConstraints=ie({},n)}get trackConstraints(){return this._trackConstraints}toJSON(){const e=super.toJSON();return Se(ie({},e),{trackConstraints:this.trackConstraints,isEnabled:this.isEnabled,_options:this._options})}get track(){return this._track}attach(e){this._element=e,z_(e,this._track)}detach(){this._element&&(K_(this._element,this._track),this._element=void 0)}_disable(e){this._options.stopTrackWhenDisabled?(this._trackConstraints=ie(ie({},this.trackConstraints),this.track.getConstraints()),this.track.stop()):this._oldTrack=this.track;const t=e==="video"?fb:z5;t.enabled=!1,this._onEnableChanged.emit(t),this._updateTrack(t)}_updateTrack(e){this._track=e,this._element&&this.attach(this._element),this.onTrackUpdated.emit(e),this._listenTrackEvent()}_listenTrackEvent(){const e=()=>{q5.info("onDestroyed",this.toJSON()),this.onDestroyed.emit()};this._track.addEventListener("ended",e),this._disposer.push(()=>this._track.removeEventListener("ended",e))}release(){this._disposer.dispose(),this._track.stop()}},pb=new RTCPeerConnection,z5=pb.addTransceiver("audio").receiver.track,fb=pb.addTransceiver("video").receiver.track,wp=new Ze("packages/core/src/media/stream/local/audio.ts"),xp=class extends ig{constructor(e,t={}){if(super(e,"audio",t),this.contentType="audio",this._isEnabled=!0,this._promiseQueue=new ua,e.kind!=="audio")throw Oe({operationName:"LocalAudioStream.constructor",path:wp.prefix,info:qe.invalidTrackKind,payload:{track:e}})}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){if(this._isEnabled===!0&&e===!1)this._isEnabled=e,this._disable("audio"),wp.debug("stopped");else if(this._isEnabled===!1&&e===!0){if(this._isEnabled=e,this._options.stopTrackWhenDisabled){const t=this._options.isDisplayMedia===!0?yield this.enableDisplay():yield this.enableMic();this._updateTrack(t),this._onEnableChanged.emit(t)}else this._oldTrack&&(this._updateTrack(this._oldTrack),this._onEnableChanged.emit(this._oldTrack));wp.debug("resumed")}}))})}get isEnabled(){return this._isEnabled}enableMic(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getUserMedia({audio:this.trackConstraints})).getAudioTracks();return e})}enableDisplay(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getDisplayMedia({audio:this.trackConstraints})).getAudioTracks();return e})}};Y();var K5=new Ze("packages/core/src/media/stream/local/customVideo.ts"),$5=class extends ig{constructor(e={}){super(fb,"video",e),this.contentType="video",this._isEnabled=!0,this._promiseQueue=new ua,this._stream=null}setStream(e){return H(this,null,function*(){if(this._stream)throw new Error("ProcessedStream is already exists");this._stream=e,this._updateTrack(e.track)})}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){var t;yield(t=this._stream)==null?void 0:t.setEnabled(e)}))})}updateTrack(e){return H(this,null,function*(){this._updateTrack(e),this._onEnableChanged.emit(e)})}get isEnabled(){return this._isEnabled}release(){var e;(e=this._stream)==null||e.dispose().catch(()=>{K5.error("release failed")})}};Y();var fu=new Ze("packages/core/src/media/stream/local/video.ts"),Cp=class extends ig{constructor(e,t={}){if(super(e,"video",t),this.contentType="video",this._isEnabled=!0,this._promiseQueue=new ua,e.kind!=="video")throw Oe({operationName:"LocalVideoStream.constructor",path:fu.prefix,info:qe.invalidTrackKind,payload:{track:e}});fu.debug("LocalVideoStream spawned",this.toJSON())}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){if(this._isEnabled===!0&&e===!1)this._isEnabled=e,this._disable("video"),fu.debug("stopped",this.toJSON());else if(this._isEnabled===!1&&e===!0){if(this._isEnabled=e,this._options.stopTrackWhenDisabled){const t=this._options.isDisplayMedia===!0?yield this.enableDisplay():yield this.enableCamera();this._updateTrack(t),this._onEnableChanged.emit(t)}else this._oldTrack&&(this._updateTrack(this._oldTrack),this._onEnableChanged.emit(this._oldTrack));fu.debug("resumed",this.toJSON())}}))})}get isEnabled(){return this._isEnabled}enableCamera(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getUserMedia({video:this.trackConstraints})).getVideoTracks();return e})}enableDisplay(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getDisplayMedia({video:this.trackConstraints})).getVideoTracks();return e})}},W5=new Ze("packages/core/src/media/stream/local/data.ts"),sg=class extends hb{constructor(e={}){super("data"),this.options=e,this.contentType="data",this._onWriteData=new Ye,this._isEnabled=!0,this._setLabel("LocalDataStream")}get isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}write(e){if(!this._isEnabled)throw Oe({operationName:"LocalDataStream.write",path:W5.prefix,info:qe.disabledDataStream});!ArrayBuffer.isView(e)&&typeof e!="string"&&(e=$f+JSON.stringify(e)),this._onWriteData.emit(e)}},$f="skyway_object:";Y();function G5(e,{publisherId:t,stream:n,origin:r,metadata:i,codecCapabilities:a,encodings:o,contentType:u,id:p,isEnabled:h}){const g=e._getPublication(p);if(g)return g;u=u.toLowerCase();const f=r?e._getPublication(r):void 0;return f&&o.length===0&&(o=f.encodings),new mb({id:p,channel:e,publisher:e._getMember(t),contentType:u,metadata:i,origin:f,stream:n,codecCapabilities:a??[],encodings:o,isEnabled:h})}var bn=new Ze("packages/core/src/publication/index.ts"),mb=class{constructor(e){this._codecCapabilities=[],this._encodings=[],this._state="enabled",this._events=new es,this.onCanceled=this._events.make(),this.onSubscribed=this._events.make(),this.onUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onEnabled=this._events.make(),this.onDisabled=this._events.make(),this.onStateChanged=this._events.make(),this.onConnectionStateChanged=new Ye,this._onEncodingsChanged=this._events.make(),this._onReplaceStream=this._events.make(),this._onEnabled=this._events.make(),this.streamEventDisposer=new ni,this.cancel=()=>new Promise((i,a)=>{let o=!1;this._channel._unpublish(this.id).catch(u=>{o=!0,a(u)}),this._setStream(void 0),this.onCanceled.asPromise(this._context.config.rtcApi.timeout).then(()=>i()).catch(u=>{o||a(u)})}),this.updateMetadata=i=>new Promise((a,o)=>H(this,null,function*(){const u=bn.info("[start] updateMetadata",yield kt({operationName:"Publication.updateMetadata",channel:this._channel}),this);let p=!1;this._channel._updatePublicationMetadata(this.id,i).catch(h=>{p=!0,o(h)}),this.onMetadataUpdated.watch(h=>h.metadata===i,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){a(),bn.elapsed(u,"[end] updateMetadata",yield kt({operationName:"Publication.updateMetadata",channel:this._channel}),this)})).catch(h=>{if(!p)throw Oe({operationName:"PublicationImpl.updateMetadata",info:Se(ie({},qe.timeout),{detail:"publication onMetadataUpdated"}),path:bn.prefix,context:this._context,channel:this._channel,error:h})})})),this.disable=()=>new Promise((i,a)=>H(this,null,function*(){if(this.state==="disabled"){i();return}const o=bn.info("[start] disable",yield kt({operationName:"Publication.disable",channel:this._channel}),this);yield this._disableStream();let u=!1;this._channel._disablePublication(this.id).catch(p=>{u=!0,a(p)}),this.onDisabled.asPromise(this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){i(),bn.elapsed(o,"[end] disable",yield kt({operationName:"Publication.disable",channel:this._channel}),this)})).catch(p=>{u||a(p)})})),this.enable=()=>new Promise((i,a)=>H(this,null,function*(){if(this.stream==null){a(Oe({operationName:"Publication.enable",context:this._context,info:qe.canNotEnableRemotePublication,path:bn.prefix}));return}if(this.state==="enabled"){i();return}const o=bn.info("[start] enable",yield kt({operationName:"Publication.enable",channel:this._channel}),this);let u=!1;this._channel._enablePublication(this.id).catch(p=>{u=!0,a(p)}),this._onEnabled.asPromise(this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){yield this._enableStream(),this.onEnabled.emit(),this.onStateChanged.emit(),bn.elapsed(o,"[end] enable",yield kt({operationName:"Publication.enable",channel:this._channel}),this),i()})).catch(p=>{u||a(p)})}));var t,n,r;this.id=e.id,this._channel=e.channel,this._context=this._channel._context,this.publisher=e.publisher,this.contentType=e.contentType,this._metadata=e.metadata,this.origin=e.origin,this.setCodecCapabilities((t=e.codecCapabilities)!=null?t:[]),this.setEncodings(Wf((n=e.encodings)!=null?n:[])),this._state=e.isEnabled?"enabled":"disabled",e.stream&&this._setStream(e.stream),this._analytics=(r=this._channel.localPerson)==null?void 0:r._analytics,bn.debug("publication spawned",this.toJSON())}get codecCapabilities(){return this._codecCapabilities}setCodecCapabilities(e){this._codecCapabilities=e}get encodings(){return this._encodings}setEncodings(e){this._encodings=e}get stream(){return this._stream}_setStream(e){this._stream=e,e?e._onConnectionStateChanged.add(t=>{bn.debug("onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit(t)}).disposer(this.streamEventDisposer):this.streamEventDisposer.dispose()}get metadata(){return this._metadata}get state(){return this._state}get deviceName(){if(!(this.stream instanceof sg))return this.stream.track.label}get subscriptions(){return this._channel.subscriptions.filter(e=>e.publication.id===this.id)}_updateMetadata(e){this._metadata=e,this.onMetadataUpdated.emit({metadata:e})}_disable(){return H(this,null,function*(){yield this._disableStream(),this.onDisabled.emit(),this.onStateChanged.emit()})}_enable(){this.stream?this._onEnabled.emit():(this._state="enabled",this.onEnabled.emit(),this.onStateChanged.emit())}_unpublished(){this._state="canceled",this.stream&&this.stream._unpublished(),this.onCanceled.emit(),this.onStateChanged.emit(),this._dispose()}_subscribed(e){this.onSubscribed.emit({subscription:e}),this.onSubscriptionListChanged.emit()}_unsubscribed(e){this.onUnsubscribed.emit({subscription:e}),this.onSubscriptionListChanged.emit()}updateEncodings(e){bn.info("updateEncodings",{encodings:e},this),this.setEncodings(Wf(gb(e))),this._onEncodingsChanged.emit(e),this._analytics&&!this._analytics.isClosed()&&this._analytics.client.sendPublicationUpdateEncodingsReport({publicationId:this.id,encodings:this.encodings,updatedAt:Date.now()})}_disableStream(){return H(this,null,function*(){this.state!=="disabled"&&(this._state="disabled",this.stream&&(this.stream.contentType==="data"?this.stream.setIsEnabled(!1):yield this.stream.setEnabled(!1).catch(e=>{bn.warn(On({channel:this._channel,operationName:"Publication._disableStream",payload:e,detail:"setEnabled failed"}))}),kt({operationName:"Publication._disableStream",channel:this._channel}).then(e=>bn.info("publication _disableStream",e,{publication:this})).catch(()=>{})))})}_enableStream(){return H(this,null,function*(){this.state!=="enabled"&&(this._state="enabled",this.stream&&(kt({operationName:"Publication._enableStream",channel:this._channel}).then(e=>bn.info("publication _enableStream",e,{publication:this})).catch(()=>{}),this.stream.contentType==="data"?this.stream.setIsEnabled(!0):yield this.stream.setEnabled(!0).catch(e=>{bn.warn(On({channel:this._channel,operationName:"Publication._disableStream",payload:e,detail:"setEnabled failed"}))})))})}replaceStream(e,t={}){var n;if(bn.info("replaceStream",{stream:e,options:t},this),!this.stream)throw Oe({operationName:"PublicationImpl.replaceStream",context:this._context,info:qe.canNotUseReplaceStream,path:bn.prefix});if(e.contentType!==this.contentType)throw Oe({operationName:"PublicationImpl.replaceStream",context:this._context,info:qe.invalidContentType,path:bn.prefix});((n=t.releaseOldStream)==null||n)&&this.stream.release(),kt({operationName:"PublicationImpl.replaceStream",channel:this._channel}).then(i=>bn.debug(i,{old:this.stream,new:e})).catch(i=>i),e.setEnabled(this.stream.isEnabled).catch(i=>{bn.error("replaceStream stream.setEnabled",i,this.toJSON())});const r=this._stream;this._setStream(e),this._onReplaceStream.emit({newStream:e,oldStream:r}),this._analytics&&!this._analytics.isClosed()&&this._analytics.client.sendMediaDeviceReport({publicationId:this.id,mediaDeviceName:this.deviceName,mediaDeviceTrigger:"replaceStream",updatedAt:Date.now()})}getStats(e){if(!this.stream)throw Oe({operationName:"PublicationImpl.getStats",context:this._context,info:qe.streamNotExistInSubscription,path:bn.prefix});return this.stream._getStats(e)}getRTCPeerConnection(e){if(!this.stream)throw Oe({operationName:"PublicationImpl.getRTCPeerConnection",context:this._context,info:qe.streamNotExistInSubscription,path:bn.prefix});return this.stream._getRTCPeerConnection(e)}getConnectionState(e){if(!this.stream)throw Oe({operationName:"PublicationImpl.getConnectionState",context:this._context,info:qe.streamNotExistInSubscription,path:bn.prefix});return this.stream._getConnectionState(e)}toJSON(){var e;return{id:this.id,channelId:this._channel.id,publisherId:this.publisher.id,origin:(e=this.origin)==null?void 0:e.id,contentType:this.contentType,metadata:this.metadata,codecCapabilities:this.codecCapabilities,encodings:this.encodings,state:this.state,stream:this.stream}}_dispose(){this._events.dispose()}},Wf=e=>e.map((t,n)=>{var r;return Se(ie({},t),{id:(r=t.id)!=null?r:n.toString()})}),gb=e=>{const[t]=e;return t.maxBitrate?e.sort((n,r)=>n.maxBitrate-r.maxBitrate):t.scaleResolutionDownBy?e.sort((n,r)=>r.scaleResolutionDownBy-n.scaleResolutionDownBy):t.maxFramerate?e.sort((n,r)=>n.maxFramerate-r.maxFramerate):e};Y();function J5(e){return e==null?!1:e.side==="remote"}Y();Y();var s1=new Ze("packages/core/src/dataPlane/agent/publishing.ts"),Z5=class{constructor(e){this._localPerson=e,this.context=this._localPerson.context}startPublishing(e){return H(this,null,function*(){if(this.context.config.internal.disableDPlane){yield new Promise(i=>setTimeout(i,500));return}const t=e.publication,n=e.subscriber;t.stream||(yield this._localPerson.onStreamPublished.watch(i=>i.publication.id===t.id,this.context.config.rtcApi.timeout).catch(i=>{throw Oe({operationName:"PublishingAgent.startPublishing",context:this.context,channel:this._localPerson.channel,info:Se(ie({},qe.timeout),{detail:"PublishingAgent onStreamPublished"}),path:s1.prefix,payload:{publication:t},error:i})}));const r=n._getOrCreateConnection(this._localPerson);r.startPublishing&&(yield r.startPublishing(t,e.id))})}stopPublishing(e,t){return H(this,null,function*(){const n=t._getConnection(this._localPerson.id);n!=null&&n.stopPublishing&&n.stopPublishing(e).catch(r=>{s1.error("stopPublishing failed",r)})})}};Y();var X5=class{constructor(e){this._localPerson=e,this._disposers={},this._context=this._localPerson.context}startSubscribing(e){return H(this,null,function*(){if(this._context.config.internal.disableDPlane){yield new Promise(r=>setTimeout(r,500));return}const n=e.publication.publisher._getOrCreateConnection(this._localPerson);if(n.startSubscribing){yield n.startSubscribing(e);const{removeListener:r}=e._onChangeEncoding.add(()=>H(this,null,function*(){var i;yield(i=n.changePreferredEncoding)==null?void 0:i.call(n,e)}));this._disposers[e.id]=r}})}stopSubscribing(e){return H(this,null,function*(){var t,n;const i=e.publication.publisher._getConnection(this._localPerson.id);i!=null&&i.stopSubscribing&&(yield i.stopSubscribing(e),(n=(t=this._disposers)[e.id])==null||n.call(t))})}};Y();var a1=class{constructor(e){this._impl=e,this._events=new es,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberStateChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onFatalError=this._events.make(),this.apply(e)}get keepaliveIntervalSec(){return this._impl.keepaliveIntervalSec}get keepaliveIntervalGapSec(){return this._impl.keepaliveIntervalGapSec}get disableSignaling(){return this._impl.disableSignaling}get disableAnalytics(){return this._impl.disableAnalytics}get type(){return this._impl.type}get subtype(){return this._impl.subtype}get side(){return this._impl.side}get id(){return this._impl.id}get name(){return this._impl.name}get channel(){return this._impl.channel}get metadata(){return this._impl.metadata}get state(){return this._impl.state}get publications(){return this._impl.publications}get subscriptions(){return this._impl.subscriptions}apply(e){this._impl=e,e.onLeft.pipe(this.onLeft),e.onMetadataUpdated.pipe(this.onMetadataUpdated),e.onStreamPublished.pipe(this.onStreamPublished),e.onStreamUnpublished.pipe(this.onStreamUnpublished),e.onPublicationListChanged.pipe(this.onPublicationListChanged),e.onPublicationSubscribed.pipe(this.onPublicationSubscribed),e.onPublicationUnsubscribed.pipe(this.onPublicationUnsubscribed),e.onSubscriptionListChanged.pipe(this.onSubscriptionListChanged),e.onFatalError.pipe(this.onFatalError)}subscribe(e,t){return this._impl.subscribe(e,t)}unsubscribe(e){return this._impl.unsubscribe(e)}publish(e,t={}){return this._impl.publish(e,t)}unpublish(e){return this._impl.unpublish(e)}updateMetadata(e){return this._impl.updateMetadata(e)}leave(){return H(this,null,function*(){yield this._impl.leave()})}dispose(){this._impl.dispose()}};Y();Y();var Q5=24*60*60;Y();var o1=new Ze("packages/core/src/external/ice.ts"),Y5=class{constructor(e){this.args=e,this.domain=this.args.domain,this.version=this.args.version,this.secure=this.args.secure,this.memberId=this.args.memberId,this.channelId=this.args.channelId,this.ttl=this.args.ttl,this.context=this.args.context,this._stunServers=[],this._turnServers=[],this._endpoint=`http${this.secure?"s":""}://${this.domain}/v${this.version}`,this.http=new tg(this._endpoint)}updateIceParams(){return H(this,null,function*(){const e={memberId:this.memberId,channelId:this.channelId,ttl:this.ttl};o1.debug("[start] fetch iceParams");const t=new ki({times:6,interval:500,jitter:100}),{turn:n,stun:r}=yield this.http.post("/ice-params",e,{headers:{authorization:`Bearer ${this.context.authTokenString}`},retry:()=>t.wait()});n&&(this._turnServers=[{credential:n.credential,urls:`turn:${n.domain}:${n.port}?transport=tcp`,username:n.username},{credential:n.credential,urls:`turn:${n.domain}:${n.port}?transport=udp`,username:n.username},{credential:n.credential,urls:`turns:${n.domain}:${n.port}?transport=tcp`,username:n.username}]),this._stunServers=[{urls:`stun:${r.domain}:${r.port}`}],o1.debug("[end] fetch iceParams",{turn:n,stun:r})})}get iceServers(){let e=[...this._stunServers];const t=this._turnServers.filter(n=>{const r=n.urls;switch(this.context.config.rtcConfig.turnProtocol){case"all":return!0;case"udp":return r.endsWith("udp");case"tcp":return!r.startsWith("turns")&&r.endsWith("tcp");case"tls":return r.startsWith("turns")}});return this.context.config.rtcConfig.turnPolicy!=="disable"&&(e=[...e,...t]),e}};Y();Y();Y();Y();var e6=20480,mu=class{constructor(e,t={}){if(this.event=e,this.payload=t,this.eventId=ji(),this.data=JSON.stringify({event:this.event,eventId:this.eventId,payload:this.payload}),this.data.length>e6)throw new Error("payload size exceeds the upper limit")}};Y();var t6=["rateLimitExceeded","targetNotFound","payloadLengthExceeded","invalidPayload","unknown","parameterError","permissionError"];function c1(e){return!(!e||typeof e!="object"||!vb(e.src)||!e.data||typeof e.data!="object")}function n6(e){return!(!e||typeof e!="object"||typeof e.eventId!="string"||typeof e.ok!="boolean"||typeof e.reason<"u"&&(typeof e.reason!="string"||!t6.includes(e.reason)))}function vb(e){return!(e===void 0||Array.isArray(e)||typeof e!="object"||typeof e.id!="string"||typeof e.name<"u"&&typeof e.name!="string")}Y();var l1=$r($m());Y();var Ra=class{constructor(){this._listeners=new Map,this._listenerIndex=0,this.emit=e=>{this._listeners.forEach(t=>t(e))},this.removeAllListeners=()=>{this._listeners.clear()},this.addListener=e=>{const t=this._listenerIndex;return this._listeners.set(t,e),this._listenerIndex++,{removeListener:()=>{this._listeners.delete(t)}}},this.addOneTimeListener=e=>{const t=this.addListener(n=>{t.removeListener(),e(n)});return t},this.asPromise=e=>new Promise((t,n)=>{let r=()=>{};const i=e&&setTimeout(()=>{n("Event asPromise timeout"),r()},e);r=this.addOneTimeListener(o=>{i&&clearTimeout(i),t(o)}).removeListener})}};Y();var r6="1.0.4",i6=["open","sendRequestSignalingMessage","sendResponseSignalingMessage","acknowledge"],s6=e=>(Ss(2,e)+Math.random())*1e3,a6=class{constructor({channelId:e,channelName:t,memberId:n,memberName:r,sessionEndpoint:i,token:a,logger:o}){this._isOpen=!1,this._isDestroyed=!1,this._reconnectCount=0,this.connectionState="closed",this.onConnectionStateChanged=new Ra,this.onOpened=new Ra,this.onEventReceived=new Ra,this.onConnectionFailed=new Ra,this._sessionEndpoint=i,this._channelId=e,this._channelName=t,this._memberId=n,this._memberName=r,this._token=a,this._logger=o,this._connect()}_setConnectionState(e){this._logger.debug(`connectionState changed : ${e}`),this.connectionState=e,this.onConnectionStateChanged.emit(e)}_connect(){let e;try{const t=`SkyWayAuthToken!${this._token}`,n={channelId:this._channelId,channelName:this._channelName,memberId:this._memberId,memberName:this._memberName,platform:"javascript",version:r6},r=Object.entries(n).filter(([a,o])=>o!==void 0).map(a=>a.join("=")).join("&"),i=`${this._sessionEndpoint}?${r}`;e=new l1.default(i,t),this._logger.debug(`Connecting to signaling-server: ${this._sessionEndpoint}`),e.onerror=a=>{this._logger.error("WebSocket error occurred",a.error),e.close(4202)}}catch(t){const n=t instanceof Error?t:new Error;this._logger.error("Failed to create WebSocket instance",n),this.reconnect();return}e.onopen=()=>{this._logger.debug("Connected to signaling-server")},e.onclose=t=>{const n="Close event fired: "+JSON.stringify({code:t.code,reason:t.reason,type:t.type});if(4100<=t.code&&t.code<=4199?this._logger.error(n,new Error):this._logger.debug(n),t.code!==1e3&&!(4e3<=t.code&&t.code<=4199)){this.reconnect();return}t.code!==4e3&&(this._logger.debug("Closed the connection to signaling-server"),this.onConnectionFailed.emit(),this.destroy())},e.onmessage=t=>{this._messageHandler(t.data)},this._ws=e}updateAuthToken(e){this._token=e}reconnect(){if(this._ws!==void 0&&this._ws.close(4e3),this._ws=void 0,this._isOpen=!1,this._reconnectCount>=8)this.onConnectionFailed.emit(),this.destroy(),this._logger.error("Failed to reconnect for eight times",new Error);else{this._setConnectionState("reconnecting");const e=s6(this._reconnectCount);this._reconnectTimer=setTimeout(()=>{this._connect(),this._reconnectCount++,this._logger.debug(`Try to reconnect: count = ${this._reconnectCount}`)},e)}}destroy(){this._isDestroyed=!0,this._setConnectionState("closed"),this.onConnectionStateChanged.removeAllListeners(),this.onOpened.removeAllListeners(),this.onEventReceived.removeAllListeners(),this.onConnectionFailed.removeAllListeners(),this._reconnectTimer&&clearTimeout(this._reconnectTimer),this._ws!==void 0&&this._ws.close(1e3)}send(e){return new Promise((t,n)=>{const r=()=>{this.onOpened.addOneTimeListener(()=>{this.send(e).then(()=>{t()}).catch(i=>{n(i)})}),this.onConnectionFailed.addOneTimeListener(()=>{n(new Error("Connection failed"))})};if(this._isDestroyed){n(new Error("The socket is already destroyed"));return}if(this._ws===void 0||!this._isOpen){this._logger.debug("Retry send the client event when connected because WebSocket is undefined or isOpen = false"),r();return}this._logger.debug(`Send the event: ${e.data}`),this._ws.send(e.data,i=>{if(i){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==l1.default.OPEN){this._logger.debug("Retry send the client event when connected because WebSocket.send failed"),r();return}n(i)}else t()})})}_messageHandler(e){if(typeof e!="string"){this._logger.error("Received invalid message: not string",new Error);return}let t;try{t=JSON.parse(e)}catch(n){const r=n instanceof Error?n:new Error;this._logger.error("Received invalid message: parse error",r);return}if(!o6(t)){this._logger.error(`Received invalid message: ${t}`,new Error);return}t.event==="open"?(this._logger.debug("Received a open event"),this._isOpen=!0,this._setConnectionState("connected"),this._reconnectCount!==0&&(this._reconnectCount=0,this._logger.debug("Succeeded to reconnect")),this.onOpened.emit()):(this._logger.debug(`Received the event: ${t.event}, payload: ${JSON.stringify(t.payload)}`),this.onEventReceived.emit(t))}};function o6(e){return!(!e||typeof e!="object"||typeof e.event!="string"||!i6.includes(e.event)||typeof e.eventId!="string"||e.payload&&typeof e.payload!="object")}var u1="signaling.skyway.ntt.com",c6="v1",l6=class{constructor({token:e,channelId:t,channelName:n,memberId:r,memberName:i},a){this.onConnectionStateChanged=new Ra,this.onConnectionFailed=new Ra,this.onRequested=new Ra,this._connectivityCheckTimers=new Map,this._responseCallbacks=new Map,this._acknowledgeCallbacks=new Map,this._token=e,this._channelId=t,this._channelName=n,this._memberId=r,this._memberName=i;const o={connectivityCheckIntervalSec:30,signalingServerDomain:u1,secure:!0,logger:{debug:u=>{console.debug(u)},error:u=>{console.error(u)}}};this._options=Object.assign({},o,a??{}),this._logger=this._options.logger,this._logger.debug(`Created instance with the options: ${this._options}`)}get connectionState(){var e,t;return(t=(e=this._socket)==null?void 0:e.connectionState)!=null?t:"closed"}connect(){return H(this,null,function*(){const e=this._options.secure?"wss":"ws",t=this._options.signalingServerDomain||u1;this._socket=new a6({sessionEndpoint:`${e}://${t}/${c6}/ws`,channelId:this._channelId,channelName:this._channelName,memberId:this._memberId,memberName:this._memberName,token:this._token,logger:this._logger}),this._socket.onEventReceived.addListener(n=>{try{this._eventReceivedHandler(n)}catch(r){this._logger.error("in _eventReceivedHandler",r)}}),this._socket.onConnectionFailed.addListener(()=>{this.onConnectionFailed.emit()}),this._socket.onConnectionStateChanged.addListener(n=>{this.onConnectionStateChanged.emit(n)}),yield this._socket.onOpened.asPromise(15*1e3),this._startConnectivityCheck()})}disconnect(){var e;this._stopConnectivityCheck(),(e=this._socket)==null||e.destroy(),this._socket=void 0,this._responseCallbacks.clear(),this._acknowledgeCallbacks.clear()}_startConnectivityCheck(){if(this._connectivityCheckInterval){this._logger.debug("connectivity check timer is already set");return}this._connectivityCheckInterval=setInterval(()=>{var e;const t=new mu("checkConnectivity");(e=this._socket)==null||e.send(t).catch(()=>{this._acknowledgeCallbacks.delete(t.eventId)}),this._connectivityCheckTimers.set(t.eventId,setTimeout(()=>{var n;this._acknowledgeCallbacks.delete(t.eventId),(n=this._socket)==null||n.reconnect(),this._logger.debug("connectivity check timer is expired")},5*1e3)),this._setAcknowledgeCallback(t.eventId,n=>{var r;const i=this._connectivityCheckTimers.get(t.eventId);i&&(clearTimeout(i),this._connectivityCheckTimers.delete(t.eventId)),n.ok||((r=this._socket)==null||r.reconnect(),this._logger.debug("connectivity check response from server was not ok"))})},this._options.connectivityCheckIntervalSec*1e3),this._logger.debug("Started connectivity check timer")}_stopConnectivityCheck(){if(!this._connectivityCheckInterval){this._logger.debug("connectivity check timer is not set");return}clearInterval(this._connectivityCheckInterval),this._connectivityCheckInterval=void 0,this._logger.debug("Stopped connectivity check timer");for(const[e,t]of this._connectivityCheckTimers)clearTimeout(t);this._connectivityCheckTimers.clear()}request(e,t,n=10){return u6(e),d1(t),new Promise((r,i)=>{if(this._socket===void 0){i(new Error("websocket is not connected"));return}const a={dst:e,data:t},o=new mu("sendRequestSignalingMessage",a),u=setTimeout(()=>{this._acknowledgeCallbacks.delete(o.eventId),i(new Error("request timeout"))},n*1e3);this._setResponseCallback(o.eventId,p=>{clearTimeout(u),r(p)}),this._setAcknowledgeCallback(o.eventId,p=>{p.ok||(clearTimeout(u),i(p))}),this._socket.send(o).catch(p=>{this._acknowledgeCallbacks.delete(o.eventId),clearTimeout(u),i(p)})})}_response(e,t,n,r){return new Promise((i,a)=>{if(d1(n),this._socket===void 0){a(new Error("websocket is not connected"));return}const o={dst:e,requestEventId:t,data:n},u=new mu("sendResponseSignalingMessage",o),p=setTimeout(()=>{this._acknowledgeCallbacks.delete(u.eventId),a(new Error("response timeout"))},r*1e3);this._setAcknowledgeCallback(u.eventId,h=>{clearTimeout(p),h.ok?i():a(h)}),this._socket.send(u).catch(h=>{this._acknowledgeCallbacks.delete(u.eventId),clearTimeout(p),a(h)})})}updateSkyWayAuthToken(e,t=10){return new Promise((n,r)=>{if(this._socket===void 0){r(new Error("websocket is not connected"));return}const i={token:e},a=new mu("updateSkyWayAuthToken",i),o=setTimeout(()=>{this._acknowledgeCallbacks.delete(a.eventId),r(new Error("updateSkyWayAuthToken timeout"))},t*1e3);this._setAcknowledgeCallback(a.eventId,u=>{if(clearTimeout(o),u.ok){if(this._socket===void 0){r(new Error("websocket is not connected"));return}this._socket.updateAuthToken(e),n()}else r(u)}),this._socket.send(a).catch(u=>{this._acknowledgeCallbacks.delete(a.eventId),clearTimeout(o),r(u)})})}_eventReceivedHandler(e){switch(e.event){case"acknowledge":this._acknowledgeHandler(e.payload);break;case"sendRequestSignalingMessage":this._eventMessageRequestHandler(e.payload);break;case"sendResponseSignalingMessage":this._eventMessageResponseHandler(e.payload);break;case"open":break;default:e.event,this._logger.debug(`Unknown event: ${e.event}`)}}_acknowledgeHandler(e){if(!n6(e))throw new Error("Invalid payload");const{eventId:t}=e;if(!this._acknowledgeCallbacks.has(t))throw new Error(`acknowledge event has unknown eventId: ${t}`);const n=this._acknowledgeCallbacks.get(t);n&&(this._acknowledgeCallbacks.delete(t),n(e))}_eventMessageRequestHandler(e){if(!c1(e))throw new Error("Invalid payload");if(!e.requestEventId)throw new Error("Invalid payload");const t=e.src,n=e.requestEventId,r=(i,a=10)=>H(this,null,function*(){yield this._response(t,n,i,a)});this.onRequested.emit({data:e.data,reply:r,requestEventId:e.requestEventId,src:e.src})}_eventMessageResponseHandler(e){if(!c1(e))throw new Error("Invalid payload");if(!e.requestEventId||!this._responseCallbacks.has(e.requestEventId))throw new Error(`received response has unknown eventId: ${e.requestEventId}`);const t=this._responseCallbacks.get(e.requestEventId);t&&(this._responseCallbacks.delete(e.requestEventId),t(e.data))}_setResponseCallback(e,t){this._responseCallbacks.set(e,t)}_setAcknowledgeCallback(e,t){this._acknowledgeCallbacks.set(e,t)}};function d1(e){if(!e||typeof e!="object")throw new Error("the type of data must be object")}function u6(e){if(!vb(e))throw new Error("the type of target must be {id: string, name: string}");if(!eE(e.id))throw new Error("the type of target.id must be uuid format")}Y();var ci=new Ze("packages/core/src/external/signaling.ts");function d6(e,t,n){return H(this,null,function*(){const{signalingService:r}=e.config,i=new l6({token:e.authTokenString,channelId:t.id,channelName:t.name,memberId:n.id,memberName:n.name},{logger:{error:o=>H(null,null,function*(){ci.error("SignalingClient error",Oe({operationName:"SignalingClient.logger",context:e,info:Se(ie({},qe.internal),{detail:"signalingClient error"}),error:o,path:ci.prefix,channel:t}))}),debug:o=>{}},signalingServerDomain:r.domain,secure:r.secure}),a=new h6(i,e);return yield a.connect(),a})}var h6=class{constructor(e,t){this._client=e,this.context=t,this.onConnectionFailed=new Ye,this.onConnectionStateChanged=new Ye,this.onMessage=new Ye,this.closed=!1,this._chunkedMessageBuffer={},this._backoffUpdateSkyWayAuthToken=new ki({times:8,interval:100,jitter:100}),this._disposer=new ni,this._listen(),t._onTokenUpdated.add(n=>H(this,null,function*(){yield this._updateSkyWayAuthToken(n)})).disposer(this._disposer)}updateClient(e){this._client=e,this._listen()}_listen(){this._client.onConnectionFailed.addOneTimeListener(()=>{this.onConnectionFailed.emit({})}),this._client.onConnectionStateChanged.addListener(e=>{ci.debug("signalingClient onConnectionStateChanged",e),this.onConnectionStateChanged.emit(e)}),this._client.onRequested.addListener(e=>H(this,[e],function*({data:t,src:n,reply:r}){var i;const a=t,{chunk:o,length:u,offset:p,id:h,type:g}=a;if(g===Ep){if(u===0)this.onMessage.emit({src:n,data:JSON.parse(o)});else if(this._chunkedMessageBuffer[h]=[...(i=this._chunkedMessageBuffer[h])!=null?i:[],a.chunk],u===p){const f=this._chunkedMessageBuffer[h].join("");delete this._chunkedMessageBuffer[h],this.onMessage.emit({src:n,data:JSON.parse(f)})}yield r({}).catch(f=>{this.closed||ci.warn("failed to reply",On({operationName:"SignalingSession.reply",detail:"SignalingClient failed to reply"}),f)})}}))}_updateSkyWayAuthToken(e){return H(this,null,function*(){if(this._backoffUpdateSkyWayAuthToken.exceeded){ci.error("[failed] updateSkyWayAuthToken");return}yield this._backoffUpdateSkyWayAuthToken.wait(),ci.debug("[start] updateSkyWayAuthToken",{count:this._backoffUpdateSkyWayAuthToken.count});const t=yield this._client.updateSkyWayAuthToken(e).catch(n=>n);if(t){ci.warn("[retry] updateSkyWayAuthToken",On({operationName:"SignalingSession._updateSkyWayAuthToken",detail:"[retry] updateSkyWayAuthToken"}),t),yield this._updateSkyWayAuthToken(e);return}ci.debug("[end] updateSkyWayAuthToken"),this._backoffUpdateSkyWayAuthToken.reset()})}get connectionState(){return this._client.connectionState}connect(){return H(this,null,function*(){ci.debug("[start] connect signalingService"),yield this._client.connect().catch(e=>{throw Oe({operationName:"signalingSession.connect",path:ci.prefix,info:Se(ie({},qe.internal),{detail:"signalingClient failed to connect Server"}),context:this.context,error:e})}),ci.debug("[end] connect signalingService")})}close(){this.closed=!0,this._disposer.dispose(),this._client.disconnect()}send(e,t,n=1e4){return H(this,null,function*(){var r;try{const i=JSON.stringify(t),a=Ko();if(i.length>20480){const o=(r=i.match(/.{1,20480}/g))!=null?r:[];let u=0;for(const p of o){const h={type:Ep,length:o.length-1,offset:u++,chunk:p,id:a};yield this._client.request(e,h,n/1e3)}}else{const o={type:Ep,length:0,offset:0,chunk:i,id:a};yield this._client.request(e,o,n/1e3)}}catch(i){if(this.closed||e.state!=="joined")return;throw Oe({operationName:"SignalingSession.send",context:this.context,info:Se(ie({},qe.internal),{detail:"signalingClient"}),error:i,path:ci.prefix,payload:{target:e,data:t}})}})}},Ep="signalingMessage",h1=new Ze("packages/core/src/member/person/local/factory.ts");function p6(e,t,n){return H(this,arguments,function*(r,i,a,{keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p,disableSignaling:h}={}){var g;h1.debug("createLocalPerson",{channel:i,memberDto:a,keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p});const{iceParamServer:f}=r.config,_=h===!0?void 0:yield d6(r,i,a),w=new Y5(Se(ie({},f),{memberId:a.id,channelId:i.id,ttl:Q5,context:r}));yield w.updateIceParams().catch(R=>{throw Oe({operationName:"createLocalPerson",context:r,channel:i,info:Se(ie({},qe.internal),{detail:"updateIceParams failed"}),path:h1.prefix,error:R})});const C=yield f6.Create({iceManager:w,channel:i,signaling:_,analytics:r.analyticsSession,metadata:a.metadata,name:a.name,id:a.id,keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p,context:r});for(const R of r.plugins)yield(g=R._whenCreateLocalPerson)==null?void 0:g.call(R,C),C._onDisposed.once(()=>H(null,null,function*(){var S;yield(S=R._whenDisposeLocalPerson)==null?void 0:S.call(R,C)}));return C})}var vt=new Ze("packages/core/src/member/localPerson/index.ts"),f6=class yb extends hh{constructor(t){super(t),this.args=t,this.type="person",this.subtype="person",this.side="local",this.keepaliveIntervalSec=this.args.keepaliveIntervalSec,this.keepaliveIntervalGapSec=this.args.keepaliveIntervalGapSec,this.preventAutoLeaveOnBeforeUnload=this.args.preventAutoLeaveOnBeforeUnload,this.disableSignaling=this.args.disableSignaling,this.disableAnalytics=this.args.disableAnalytics,this.config=this.context.config,this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onFatalError=this._events.make(),this._onStreamSubscribeFailed=this._events.make(),this._onDisposed=this._events.make(),this._disposer=new ni,this._subscribing={},this._requestQueue=new ua,this.iceManager=this.args.iceManager,this._disposed=!1,this._publishingAgent=new Z5(this),this._subscribingAgent=new X5(this),this._signaling=t.signaling,this._analytics=t.analytics,this._listenChannelEvent(),this._listenBeforeUnload()}static Create(...t){return H(this,null,function*(){const n=new yb(...t);return yield n._setupTtlTimer(),n._analytics&&n._analytics.client.sendJoinReport({memberId:n.id}),n})}_listenChannelEvent(){this.channel.onPublicationSubscribed.add(t=>H(this,[t],function*({subscription:n}){yield this._handleOnPublicationSubscribe(n).catch(r=>vt.error("_handleOnStreamSubscribe",r))})).disposer(this._disposer),this.channel.onPublicationUnsubscribed.add(t=>H(this,[t],function*({subscription:n}){yield this._handleOnPublicationUnsubscribe(n).catch(r=>vt.error("_handleOnStreamUnsubscribe",r))})).disposer(this._disposer),this.channel._onDisposed.once(()=>{this.dispose()}),this.onLeft.once(()=>{this.dispose()})}_setupTtlTimer(){return H(this,null,function*(){const{keepaliveIntervalSec:t,keepaliveIntervalGapSec:n}=this;if(t==null||(vt.debug("_setupTtlTimer",this.toJSON(),{keepaliveIntervalSec:t,keepaliveIntervalGapSec:n}),t===-1))return;const r=()=>H(this,null,function*(){if(this._disposed)return;const i=yield this.context._api.getServerUnixtimeInSec();this.ttlSec=Math.floor(i+t+(n??0));try{yield this.channel._updateMemberTtl(this.id,this.ttlSec),vt.debug("updateTtl",this.toJSON(),{now:i,ttlSec:this.ttlSec,keepaliveIntervalSec:t??0,keepaliveIntervalGapSec:n??0,diff:this.ttlSec-i})}catch(a){if(this._disposed)return;throw a}});yield r(),this.ttlInterval=setInterval(()=>H(this,null,function*(){yield r().catch(i=>{this._disposed||(this.onFatalError.emit(Oe({operationName:"localPerson._setupTtlTimer",path:vt.prefix,info:Se(ie({},qe.internal),{detail:"updateMemberTtl failed"}),channel:this.channel,context:this.context,error:i})),this.dispose())})}),t*1e3)})}_listenBeforeUnload(){if(window&&!this.preventAutoLeaveOnBeforeUnload){const t=()=>H(this,null,function*(){window.removeEventListener("beforeunload",t),this.state==="joined"&&(vt.debug("leave by beforeunload",this.toJSON()),yield this.leave())});window.addEventListener("beforeunload",t)}}_handleOnPublicationSubscribe(t){return H(this,null,function*(){var n;if(t.subscriber.id===this.id)try{const r=vt.info("[start] startSubscribing",yield kt({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t}),i=(n=this._subscribing[t.publication.id])==null?void 0:n.options;i&&(t.preferredEncoding=i.preferredEncodingId),yield this._subscribingAgent.startSubscribing(t),this.onPublicationSubscribed.emit({subscription:t,stream:t.stream}),this.onSubscriptionListChanged.emit(),vt.elapsed(r,"[end] startSubscribing",yield kt({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t})}catch(r){throw this._onStreamSubscribeFailed.emit({error:r,subscription:t}),r}if(t.publication.publisher.id===this.id){if(t.subscriber.id===this.id)throw Oe({operationName:"localPerson._handleOnStreamSubscribe",path:vt.prefix,info:Se(ie({},qe.internal),{detail:"can not subscribe own Publication"}),channel:this.channel,context:this.context});const r=vt.info("[start] startPublishing",yield kt({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t});yield this._publishingAgent.startPublishing(t).catch(i=>{throw vt.error("[failed] startPublishing",i,{subscription:t}),i}),vt.elapsed(r,"[end] startPublishing",yield kt({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t})}})}_handleOnPublicationUnsubscribe(t){return H(this,null,function*(){if(t.publication.publisher.id===this.id){const n=vt.info("[start] stopPublishing",yield kt({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t});yield this._publishingAgent.stopPublishing(t.publication,t.subscriber).catch(r=>{throw vt.error("[failed] stopPublishing",r,{subscription:t}),r}),vt.elapsed(n,"[end] stopPublishing",yield kt({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t})}if(t.subscriber.id===this.id){const n=vt.info("[start] stopSubscribing",yield kt({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t});yield this._subscribingAgent.stopSubscribing(t).catch(r=>{throw vt.error("[failed] stopSubscribing",{subscription:t},r),r}),this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit(),vt.elapsed(n,"[end] stopSubscribing",yield kt({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t})}})}publish(t){return H(this,arguments,function*(n,r={}){var i,a,o,u;const p=vt.info("[start] publish",yield kt({operationName:"localPerson.publish",channel:this.channel}),{options:r});if(this.state!=="joined")throw Oe({operationName:"localPerson.publish",info:qe.localPersonNotJoinedChannel,path:vt.prefix,channel:this.channel,context:this.context});if(n.published)throw Oe({operationName:"localPerson.publish",channel:this.channel,context:this.context,info:qe.alreadyPublishedStream,path:vt.prefix});n.published=!0,r.codecCapabilities&&(r.codecCapabilities=r.codecCapabilities.filter(_=>_!=null));const h={metadata:r.metadata,publisher:this.id,channel:this.channel.id,contentType:n.contentType,codecCapabilities:(i=r.codecCapabilities)!=null?i:[],isEnabled:r.isEnabled};n.contentType==="video"&&h.codecCapabilities.length===0&&(h.codecCapabilities=[{mimeType:"video/vp8"}]),r.encodings&&r.encodings.length>0&&(h.encodings=Wf(gb(r.encodings)));const g=yield this._requestQueue.push(()=>this.channel._publish(h).catch(_=>{throw Oe({operationName:"localPerson.publish",context:this.context,channel:this.channel,info:_.info,path:vt.prefix,error:_})}));n.contentType==="data"?n.setIsEnabled(g.isEnabled):yield n.setEnabled(g.isEnabled);const f=this.channel._addPublication(g);if(f._setStream(n),(a=h.codecCapabilities)!=null&&a.length&&f.setCodecCapabilities(h.codecCapabilities),(o=h.encodings)!=null&&o.length&&f.setEncodings(h.encodings),yield this._handleOnStreamPublish(f),vt.elapsed(p,"[end] publish",yield kt({operationName:"localPerson.publish",channel:this.channel}),{publication:f}),["video","audio"].includes(f.contentType)&&this._analytics&&!this._analytics.isClosed()){this._analytics.client.sendMediaDeviceReport({publicationId:f.id,mediaDeviceName:f.deviceName,mediaDeviceTrigger:"publish",updatedAt:Date.now()});const _=(u=h.encodings)!=null?u:[];this._analytics.client.sendPublicationUpdateEncodingsReport({publicationId:f.id,encodings:_,updatedAt:Date.now()})}return f})}_handleOnStreamPublish(t){return H(this,null,function*(){vt.info("onStreamPublished",yield kt({operationName:"onStreamPublished",channel:this.channel})),this.onStreamPublished.emit({publication:t}),this.onPublicationListChanged.emit()})}unpublish(t){return H(this,null,function*(){const n=vt.info("[start] unpublish",yield kt({operationName:"localPerson.unpublish",channel:this.channel})),r=typeof t=="string"?t:t.id;if(this.state!=="joined")throw Oe({operationName:"localPerson.unpublish",info:qe.localPersonNotJoinedChannel,path:vt.prefix,context:this.context,channel:this.channel});const i=this.channel._getPublication(r);if(!i)throw Oe({operationName:"localPerson.unpublish",info:qe.publicationNotExist,path:vt.prefix,context:this.context,channel:this.channel,payload:{publicationId:r}});i.stream&&i.stream._unpublished(),yield this._requestQueue.push(()=>this.channel._unpublish(r)),i.subscriptions.map(a=>a.subscriber).forEach(a=>{J5(a)&&this._publishingAgent.stopPublishing(i,a).catch(o=>{vt.error("[failed] stopPublishing",o,{publication:i})})}),yield this._handleOnStreamUnpublished(i),vt.elapsed(n,"[end] unpublish",yield kt({operationName:"localPerson.unpublish",channel:this.channel}),{publication:i})})}_handleOnStreamUnpublished(t){return H(this,null,function*(){vt.info("onStreamUnpublished",yield kt({operationName:"onStreamUnpublished",channel:this.channel})),this.onStreamUnpublished.emit({publication:t}),this.onPublicationListChanged.emit()})}subscribe(t){return H(this,arguments,function*(n,r={}){const i=vt.info("[start] subscribe",yield kt({operationName:"localPerson.subscribe",channel:this.channel}),{target:n}),a=typeof n=="string"?n:n.id;if(this.state!=="joined")throw Oe({operationName:"localPerson.subscribe",info:qe.localPersonNotJoinedChannel,path:vt.prefix,context:this.context,channel:this.channel,payload:{target:n}});const o=this.channel._getPublication(a);if(o==null)throw Oe({operationName:"localPerson.subscribe",info:qe.publicationNotExist,path:vt.prefix,context:this.context,channel:this.channel,payload:o});this._validatePublicationForSubscribe(o),this._subscribing[o.id]={options:r,processing:!0};const u=this._subscribing[o.id];try{const p=yield this._requestQueue.push(()=>this.channel._subscribe(this.id,a));vt.elapsed(i,"[elapsed] subscribe / subscriptionDto received",{subscriptionDto:p});const h=this.channel._addSubscription(p);return h.stream||(yield Promise.race([new Promise((g,f)=>{this.onPublicationSubscribed.watch(({subscription:_})=>_.publication.id===a,this.context.config.rtcApi.timeout).then(g).catch(_=>H(this,null,function*(){u.processing&&f(Oe({operationName:"localPerson.subscribe",info:Se(ie({},qe.timeout),{detail:"failed to subscribe publication. maybe publisher already left room"}),path:vt.prefix,context:this.context,channel:this.channel,payload:{subscription:h,publication:o},error:_}))}))}),new Promise((g,f)=>{this.channel.onMemberLeft.watch(_=>_.member.id===o.publisher.id,this.context.config.rtcApi.timeout+1e3).then(()=>{u.processing&&f(Oe({operationName:"localPerson.subscribe",info:Se(ie({},qe.internal),{detail:"failed to subscribe publication. publisher already left room"}),path:vt.prefix,context:this.context,channel:this.channel,payload:{subscription:h,publication:o}}))}).catch(g)}),new Promise((g,f)=>{this._onStreamSubscribeFailed.watch(_=>_.subscription.publication.id===o.id,this.context.config.rtcApi.timeout+1e3).then(_=>{var w,C;if(u.processing){const R=(C=(w=_==null?void 0:_.error)==null?void 0:w.info)!=null?C:Se(ie({},qe.internal),{detail:"subscribe _onStreamSubscribeFailed"});f(Oe({operationName:"localPerson.subscribe",info:R,path:vt.prefix,context:this.context,channel:this.channel,error:_.error,payload:{subscription:h,publication:o}}))}}).catch(g)})])),u.processing=!1,vt.elapsed(i,"[end] subscribe",yield kt({operationName:"localPerson.subscribe",channel:this.channel}),{subscription:h,publication:o}),{subscription:h,stream:h.stream}}catch(p){throw u.processing=!1,vt.warn("[failed] subscribe",p,{publication:o}),p}})}_validatePublicationForSubscribe(t){if(t.publisher.id===this.id)throw Oe({operationName:"localPerson._validatePublicationForSubscribe",info:qe.publicationNotExist,path:vt.prefix,context:this.context,channel:this.channel,payload:{publication:t}});if(t.publisher instanceof V_)throw Oe({operationName:"localPerson._validatePublicationForSubscribe",info:qe.unknownMemberType,path:vt.prefix,context:this.context,channel:this.channel,payload:{publication:t}});if(this.subscriptions.find(n=>n.publication.id===t.id))throw Oe({operationName:"localPerson._validatePublicationForSubscribe",info:qe.alreadySubscribedPublication,path:vt.prefix,context:this.context,channel:this.channel,payload:{publication:t}})}unsubscribe(t){return H(this,null,function*(){const n=vt.info("[start] unsubscribe",yield kt({operationName:"localPerson.unsubscribe",channel:this.channel})),r=typeof t=="string"?t:t.id;if(this.state!=="joined")throw Oe({operationName:"localPerson.unsubscribe",info:qe.localPersonNotJoinedChannel,path:vt.prefix,context:this.context,channel:this.channel});const i=this.subscriptions.find(a=>a.id===r);if(!i)throw Oe({operationName:"localPerson.unsubscribe",info:qe.subscriptionNotExist,path:vt.prefix,context:this.context,channel:this.channel,payload:{subscriptionId:r}});delete this._subscribing[i.publication.id],yield this._requestQueue.push(()=>this.channel._unsubscribe(r)),vt.elapsed(n,"[end] unsubscribe",yield kt({operationName:"localPerson.unsubscribe",channel:this.channel}),{subscription:i})})}_getConnections(){return this.channel.members.map(r=>r._getConnection(this.id)).filter(r=>(r==null?void 0:r.closed)===!1)}dispose(){this._disposed||(this._disposed=!0,vt.debug("disposed",this.toJSON()),clearInterval(this.ttlInterval),this._signaling&&this._signaling.close(),this._analytics&&this._analytics.close(),this._getConnections().forEach(t=>t.close({reason:"localPerson disposed"})),this._onDisposed.emit(),this._events.dispose(),this._disposer.dispose())}};Y();Y();var Wi=new Ze("packages/core/src/subscription/index.ts"),m6=class{constructor(e){this._disposer=new ni,this._state="enabled",this.onCanceled=new Ye,this.onStreamAttached=new Ye,this.onConnectionStateChanged=new Ye,this._onChangeEncoding=new Ye,this.cancel=()=>new Promise((t,n)=>{let r=!1;this._channel._unsubscribe(this.id).catch(i=>{r=!0,n(i)}),this.onCanceled.asPromise(this._context.config.rtcApi.timeout).then(()=>t()).catch(i=>{r||n(i)})}),this._channel=e.channel,this._context=this._channel._context,this.id=e.id,this.contentType=e.contentType,this.subscriber=e.subscriber,this.publication=e.publication,Wi.debug("subscription spawned",this.toJSON()),this._handlePublicationEnabled()}get state(){return this._state}_handlePublicationEnabled(){this.publication.onDisabled.add(()=>{this.stream&&(Wi.debug("disabled",this),this.stream.setIsEnabled(!1))}).disposer(this._disposer),this.publication.onEnabled.add(()=>{this.stream&&(Wi.debug("enabled",this),this.stream.setIsEnabled(!0))}).disposer(this._disposer),this.stream&&this.stream.setIsEnabled(this.publication.state==="enabled")}_setStream(e){this._stream=e,this.onStreamAttached.emit(),e._onConnectionStateChanged.add(t=>{Wi.debug("onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit(t)})}get stream(){return this._stream}toJSON(){return{id:this.id,contentType:this.contentType,subscriber:this.subscriber,publication:this.publication,channelId:this._channel.id,state:this.state,stream:this.stream}}_canceled(){this._state="canceled",this.onCanceled.emit(),this._disposer.dispose()}changePreferredEncoding(e){if(!this.stream)throw Oe({operationName:"SubscriptionImpl.changePreferredEncoding",info:qe.streamNotExistInSubscription,path:Wi.prefix,context:this._context,channel:this._channel});if(this.stream.contentType==="data")throw Oe({operationName:"SubscriptionImpl.changePreferredEncoding",info:qe.dataStreamNotSupportEncoding,path:Wi.prefix,context:this._context,channel:this._channel});if(!this.publication.encodings.map(t=>t.id).includes(e))throw Oe({operationName:"SubscriptionImpl.changePreferredEncoding",info:qe.correspondingEncodeNotExistForId,path:Wi.prefix,context:this._context,channel:this._channel});this.preferredEncoding=e,this._onChangeEncoding.emit()}getStats(){if(!this.stream)throw Oe({operationName:"SubscriptionImpl.getStats",info:qe.streamNotExistInSubscription,path:Wi.prefix,context:this._context,channel:this._channel});return this.stream._getStats()}getRTCPeerConnection(){if(!this.stream)throw Oe({operationName:"SubscriptionImpl.getRTCPeerConnection",info:qe.streamNotExistInSubscription,path:Wi.prefix,context:this._context,channel:this._channel});return this.stream._getRTCPeerConnection()}getConnectionState(){if(!this.stream)throw Oe({operationName:"SubscriptionImpl.getConnectionState",info:qe.streamNotExistInSubscription,path:Wi.prefix,context:this._context,channel:this._channel});return this.stream._getConnectionState()}};function g6(e,{subscriberId:t,publicationId:n,id:r}){const i=e._getSubscription(r);if(i)return i;const o=e._getPublication(n).contentType;return new m6({channel:e,id:r,subscriber:e._getMember(t),publication:e._getPublication(n),contentType:o})}var tn=new Ze("packages/core/src/channel/index.ts"),Pp=class{constructor(e,t){this._context=e,this._channelImpl=t,this.id=this._channelImpl.id,this.name=this._channelImpl.name,this.appId=this._context.appId,this.disposed=!1,this.config=this._context.config,this._state="opened",this._api=this._context._api,this._members={},this._getMember=n=>this._members[n],this._publications={},this._getPublication=n=>this._publications[n],this._subscriptions={},this._getSubscription=n=>this._subscriptions[n],this._events=new es,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this._onDisposed=this._events.make(),this.leave=n=>H(this,null,function*(){return this._channelImpl.leave(this.id,n.id)}),this.updateMetadata=n=>this._channelImpl.updateChannelMetadata(n),this.close=()=>new Promise((n,r)=>H(this,null,function*(){if(this.state==="closed"){r(Oe({operationName:"SkyWayChannelImpl.close",path:tn.prefix,info:qe.alreadyChannelClosed,channel:this,context:this._context,payload:this.toJSON()}));return}const i=tn.info("[start] close channel",yield kt({operationName:"SkyWayChannelImpl.close",channel:this}));try{yield this._channelImpl.close().catch(a=>{throw Oe({operationName:"SkyWayChannelImpl.close",context:this._context,info:Se(ie({},qe.internal),{detail:"_api.deleteChannel failed"}),error:a,path:tn.prefix,channel:this})}),this._state!=="closed"&&(yield this.onClosed.asPromise(this._context.config.rtcApi.timeout).catch(a=>{throw Oe({operationName:"SkyWayChannelImpl.close",context:this._context,info:Se(ie({},qe.timeout),{detail:"channel.onClosed"}),error:a,path:tn.prefix,channel:this})}))}catch(a){tn.error(a.message,a),r(a)}tn.elapsed(i,"[end] close channel",yield kt({operationName:"SkyWayChannelImpl.close",channel:this})),n()})),this._updateMemberTtl=(n,r)=>this._channelImpl.updateMemberTtl(n,r),this._updateMemberMetadata=(n,r)=>this._channelImpl.updateMemberMetadata(n,r),this._publish=n=>this._channelImpl.publish(n),this._unpublish=n=>H(this,null,function*(){return this._channelImpl.unpublish(n)}),this._subscribe=(n,r)=>{const i=this._getPublication(r),a=this._getMember(n);if(a==null)throw Oe({operationName:"SkyWayChannelImpl._subscribe",path:tn.prefix,info:Se(ie({},qe.internal),{detail:"subscriber not found"}),channel:this,context:this._context,payload:{subscriberId:n,publicationId:r}});return this._channelImpl.subscribe({publication:i.toJSON(),subscriber:a.toJSON()})},this._unsubscribe=n=>H(this,null,function*(){if(!this._getSubscription(n))throw Oe({operationName:"SkyWayChannelImpl._unsubscribe",path:tn.prefix,info:Se(ie({},qe.internal),{detail:"can't unsubscribe not exist subscription"}),channel:this,context:this._context,payload:{subscriptionId:n}});yield this._channelImpl.unsubscribe(n)}),this._updatePublicationMetadata=(n,r)=>this._channelImpl.updatePublicationMetadata(n,r),this._disablePublication=n=>this._channelImpl.disablePublication(n),this._enablePublication=n=>this._channelImpl.enablePublication(n),this._setupPropertiesFromChannel(),this._setupListenChannelEvent(),e._onDisposed.once(()=>{this.dispose()}),tn.debug("channel spawned",this.toJSON())}_addMember(e){const t=this._getMember(e.id);if(t)return t;const n=this._context._createRemoteMember(this,e);return this._members[n.id]=n,n}_removeMember(e){delete this._members[e]}_addPublication(e){const t=this._getPublication(e.id);if(t)return t;const n=G5(this,e);return this._publications[e.id]=n,n}_removePublication(e){delete this._publications[e]}_addSubscription(e){const t=this._getSubscription(e.id);if(t)return t;const n=g6(this,e);return this._subscriptions[e.id]=n,n}_removeSubscription(e){delete this._subscriptions[e]}get localPerson(){return this._localPerson}get members(){return Object.values(this._members)}get bots(){return this.members.filter(e=>e.type==="bot")}get publications(){return Object.values(this._publications)}get subscriptions(){return Object.values(this._subscriptions)}get metadata(){return this._channelImpl.metadata}get state(){return this._state}toJSON(){return{id:this.id,name:this.name,appId:this.appId,metadata:this.metadata,members:this.members,publications:this.publications,subscriptions:this.subscriptions}}_setupPropertiesFromChannel(){this._channelImpl.members.forEach(e=>{this._addMember(e)}),this._channelImpl.publications.forEach(e=>{this._addPublication(e)}),this._channelImpl.subscriptions.forEach(e=>{this._addSubscription(e)})}_setupListenChannelEvent(){this._channelImpl.onClosed.add(()=>this._handleOnChannelClose()),this._channelImpl.onMetadataUpdated.add(({channel:e})=>this._handleOnChannelMetadataUpdate(e.metadata)),this._channelImpl.onMemberJoined.add(({member:e})=>{this._handleOnMemberJoin(e)}),this._channelImpl.onMemberLeft.add(({member:e})=>{this._handleOnMemberLeft(e)}),this._channelImpl.onMemberListChanged.pipe(this.onMemberListChanged),this._channelImpl.onMemberMetadataUpdated.add(({member:e})=>{this._handleOnMemberMetadataUpdate(e,e.metadata)}),this._channelImpl.onStreamPublished.add(({publication:e})=>{this._handleOnStreamPublish(e)}),this._channelImpl.onStreamUnpublished.add(({publication:e})=>{this._handleOnStreamUnpublish(e)}),this._channelImpl.onPublicationListChanged.pipe(this.onPublicationListChanged),this._channelImpl.onPublicationMetadataUpdated.add(({publication:e})=>{this._handleOnPublicationMetadataUpdate(e,e.metadata)}),this._channelImpl.onPublicationEnabled.add(e=>H(this,[e],function*({publication:t}){return yield this._handleOnPublicationEnabled(t)})),this._channelImpl.onPublicationDisabled.add(e=>H(this,[e],function*({publication:t}){return yield this._handleOnPublicationDisabled(t)})),this._channelImpl.onPublicationSubscribed.add(({subscription:e})=>{this._handleOnStreamSubscribe(e)}),this._channelImpl.onPublicationUnsubscribed.add(({subscription:e})=>{this._handleOnStreamUnsubscribe(e)}),this._channelImpl.onSubscriptionListChanged.pipe(this.onSubscriptionListChanged)}_handleOnChannelClose(){this._state="closed",this.onClosed.emit({}),this.dispose()}_handleOnChannelMetadataUpdate(e){this.onMetadataUpdated.emit({metadata:e})}_handleOnMemberJoin(e){const t=this._addMember(e);this.onMemberJoined.emit({member:t})}_handleOnMemberLeft(e){var t;const n=this._getMember(e.id);this._removeMember(n.id),n._left(),((t=this.localPerson)==null?void 0:t.id)===e.id&&(this.localPerson._left(),this._localPerson=void 0),this.onMemberLeft.emit({member:n})}_handleOnMemberMetadataUpdate(e,t){var n;const r=this._getMember(e.id);r._metadataUpdated(t),((n=this.localPerson)==null?void 0:n.id)===e.id&&this.localPerson._metadataUpdated(t),this.onMemberMetadataUpdated.emit({member:r,metadata:t})}_handleOnStreamPublish(e){const t=this._addPublication(e);this.onStreamPublished.emit({publication:t})}_handleOnStreamUnpublish(e){const t=this._getPublication(e.id);this._removePublication(t.id),t._unpublished(),this.onStreamUnpublished.emit({publication:t})}_handleOnPublicationMetadataUpdate(e,t){const n=this._getPublication(e.id);n._updateMetadata(t),this.onPublicationMetadataUpdated.emit({publication:n,metadata:t})}_handleOnPublicationEnabled(e){return H(this,null,function*(){const t=this._getPublication(e.id);t._enable(),this.onPublicationEnabled.emit({publication:t})})}_handleOnPublicationDisabled(e){return H(this,null,function*(){const t=this._getPublication(e.id);yield t._disable(),this.onPublicationDisabled.emit({publication:t})})}_handleOnStreamSubscribe(e){const t=this._addSubscription(e);this._getPublication(t.publication.id)._subscribed(t),this.onPublicationSubscribed.emit({subscription:t})}_handleOnStreamUnsubscribe(e){const t=this._getSubscription(e.id);this._removeSubscription(t.id),t._canceled(),this._getPublication(t.publication.id)._unsubscribed(t),this.onPublicationUnsubscribed.emit({subscription:t})}join(){return H(this,arguments,function*(e={}){var t,n,r;const i=tn.info("[start] join",yield kt({operationName:"SkyWayChannelImpl.join",channel:this}));if(this._localPerson)throw Oe({operationName:"SkyWayChannelImpl.join",path:tn.prefix,info:qe.alreadyLocalPersonExist,channel:this,context:this._context});if(e.name!=null&&this.members.find(g=>g.name===e.name))throw Oe({operationName:"SkyWayChannelImpl.join",path:tn.prefix,info:qe.alreadySameNameMemberExist,channel:this,context:this._context,payload:e});(t=e.keepaliveIntervalSec)!=null||(e.keepaliveIntervalSec=this.config.member.keepaliveIntervalSec),(n=e.keepaliveIntervalGapSec)!=null||(e.keepaliveIntervalGapSec=this.config.member.keepaliveIntervalGapSec),(r=e.preventAutoLeaveOnBeforeUnload)!=null||(e.preventAutoLeaveOnBeforeUnload=this.config.member.preventAutoLeaveOnBeforeUnload);const a=Se(ie({},e),{type:"person",subtype:"person"});e.keepaliveIntervalSec!==null&&(a.ttlSec=(yield this._context._api.getServerUnixtimeInSec())+e.keepaliveIntervalSec);const o=yield this._channelImpl.joinChannel(a).catch(h=>{throw tn.error("[failed] join",h),h});tn.elapsed(i,"[elapsed] join / channelImpl.joinChannel",{member:o});const u=yield this._createLocalPerson(o,e),p=new a1(u);return tn.elapsed(i,"[end] join",{person:u}),p})}moveChannel(e){return H(this,null,function*(){if(this._localPerson)throw Oe({operationName:"SkyWayChannelImpl.moveChannel",path:tn.prefix,info:qe.alreadyLocalPersonExist,channel:this,context:this._context});if(!(e instanceof a1))throw Oe({operationName:"SkyWayChannelImpl.moveChannel",path:tn.prefix,info:qe.invalidArgumentValue,channel:this,context:this._context});const t=e.channel;if(this.id===t.id)throw Oe({operationName:"SkyWayChannelImpl.moveChannel",path:tn.prefix,info:qe.cantMoveSameIdChannel,channel:this,context:this._context});yield t.leave(e);const n={name:e.name,type:e.type,subtype:e.subtype,metadata:e.metadata};e.keepaliveIntervalSec!=null&&(n.ttlSec=(yield this._context._api.getServerUnixtimeInSec())+e.keepaliveIntervalSec);const r=yield this._channelImpl.joinChannel(n),i=yield this._createLocalPerson(r,{keepaliveIntervalSec:e.keepaliveIntervalSec,keepaliveIntervalGapSec:e.keepaliveIntervalGapSec,disableSignaling:e.disableSignaling,disableAnalytics:e.disableAnalytics});e.apply(i)})}_createLocalPerson(e,t){return H(this,null,function*(){const n=yield p6(this._context,this,e,t);return this._localPerson=n,n})}dispose(){this.disposed||(this.disposed=!0,tn.debug("disposed",this.toJSON()),this._channelImpl.dispose(),this._onDisposed.emit(),this._events.dispose())}},ag=class{static Create(e){return H(this,arguments,function*(t,n={}){const r=tn.info("[start] createChannel",{operationName:"SkyWayChannel.Create"}),i=yield t._api.createChannel(n).catch(o=>{throw tn.error("[failed] createChannel",o),o}),a=new Pp(t,i);return tn.elapsed(r,"[end] createChannel"),a})}static Find(e,t){return H(this,null,function*(){const n=tn.info("[start] findChannel",{operationName:"SkyWayChannel.Find"}),r=yield e._api.findChannel(t).catch(a=>{throw tn.error("[failed] findChannel",a),a}),i=new Pp(e,r);return tn.elapsed(n,"[end] findChannel"),i})}static FindOrCreate(e,t){return H(this,null,function*(){const n=tn.info("[start] findOrCreateChannel",{operationName:"SkyWayChannel.FindOrCreate"}),r=yield e._api.findOrCreateChannel(t).catch(a=>{throw tn.error("[failed] findOrCreateChannel",a),a}),i=new Pp(e,r);return tn.elapsed(n,"[end] findOrCreateChannel"),i})}constructor(){}};Y();Y();var v6=$r(zy()),y6=class{constructor(e={}){this.rtcApi={domain:"rtc-api.skyway.ntt.com",timeout:3e4,secure:!0,eventSubscribeTimeout:5e3},this.iceParamServer={domain:"ice-params.skyway.ntt.com",version:1,secure:!0},this.signalingService={domain:"signaling.skyway.ntt.com",secure:!0},this.analyticsService={domain:"analytics-logging.skyway.ntt.com",secure:!0},this.rtcConfig={timeout:3e4,turnPolicy:"enable",turnProtocol:"all",encodedInsertableStreams:!1,iceDisconnectBufferTimeout:5e3},this.token={updateReminderSec:30},this.log={level:"error",format:"string"},this.internal={disableDPlane:!1},this.member={keepaliveIntervalGapSec:30,keepaliveIntervalSec:30,preventAutoLeaveOnBeforeUnload:!1},Object.assign(this,(0,v6.default)(this,e))}};Y();Y();Y();Y();Y();Y();var _6="rtc-api.skyway.ntt.com",va=2e4,b6=8;Y();var hr={timeout:{name:"timeout",detail:"",solution:""},internalError:{name:"internalError",detail:"",solution:""},invalidParameter:{name:"invalidParameter",detail:"",solution:""},connectionDisconnected:{name:"connectionDisconnected",detail:"",solution:""},websocketConnectionFailure:{name:"connectionFailure",detail:"",solution:""},rpcResponseError:{name:"rpcResponseError",detail:"",solution:"",error:{}},onClosedWhileRequesting:{name:"onClosedWhileRequesting",detail:"request",solution:""},failedToConnectRtcAPI:{name:"failedToConnectRtcAPI",detail:"rtc-api server",solution:"Token"},failedToUpdateMemberTTL:{name:"failedToUpdateMemberTTL",detail:"updateMemberTTL",solution:""}};Y();var S6=$r($m());Y();function jr({operationName:e,info:t,error:n,path:r,payload:i,channelId:a,appId:o,memberId:u}){return new Er({error:n,info:t,payload:{payload:i,operationName:e,channelId:a,appId:o,memberId:u},path:r})}function Ci({appId:e,detail:t,channelId:n,operationName:r,payload:i,memberId:a}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n,memberId:a}}var Nn=new Ze("packages/rtc-rpc-api-client/src/rpc.ts"),w6=4291,x6=class{constructor(){this._id=ji(),this.closed=!1,this.negotiated=!1,this._reconnecting=!1,this._pendingRequests=[],this._events=new es,this._onMessage=this._events.make(),this.onNotify=this._events.make(),this.onFatalError=this._events.make(),this.onDisconnected=this._events.make(),this.onClosed=this._events.make(),this._send=e=>new Promise((t,n)=>H(this,null,function*(){if(yield new Promise(r=>setTimeout(r,0)),this._ws.readyState!==this._ws.OPEN){n(jr({operationName:"RPC._send",info:Se(ie({},hr.internalError),{detail:"wrong state"}),path:Nn.prefix,payload:{request:e,wsReadyState:p1[this._ws.readyState]}}));return}this._ws.send(JSON.stringify(e),r=>{if(r)throw n(jr({operationName:"RPC._send",info:Se(ie({},hr.internalError),{detail:"failed to send rpc message"}),path:Nn.prefix,error:r}))}),t()}))}set reconnecting(e){this._reconnecting=e}get reconnecting(){return this._reconnecting}connect(e){return H(this,arguments,function*({domain:t,token:n,secure:r}){const i=n;this._ws=new S6.default(`${r?"wss":"ws"}://${t}/ws`,i),this._ws.onmessage=o=>{this._onMessage.emit(JSON.parse(o.data))},this._ws.onclose=o=>H(this,null,function*(){Nn.debug("websocket closed",{id:this._id,code:o.code,reason:o.reason}),o.code===w6?this.close():this.onDisconnected.emit()}),this._onMessage.add(o=>{C6(o)&&this.onNotify.emit(o)});const a=yield new Promise((o,u)=>{const p=setTimeout(()=>{u(jr({operationName:"RPC.connect",info:Se(ie({},hr.timeout),{detail:"ws.open"}),path:Nn.prefix}))},5e3);this._ws.onerror=h=>{u(jr({operationName:"RPC.connect",info:hr.websocketConnectionFailure,path:Nn.prefix,error:h}))},this._ws.onopen=()=>{clearTimeout(p),o()}}).catch(o=>o);if(a)throw a;this.negotiated=!0})}close(){this.closed||(this.closed=!0,Nn.debug("closed"),this._ws.close(),this.onClosed.emit(),this._events.dispose())}resolvePendingRequests(){Nn.debug("resolve pendingRequests",[...this._pendingRequests]),this._pendingRequests.forEach(e=>H(this,null,function*(){yield this._send(e)})),this._pendingRequests=[]}request(e,t){return H(this,null,function*(){if(this.closed)throw jr({operationName:"RPC.request",info:Se(ie({},hr.internalError),{detail:"rpc closed"}),path:Nn.prefix,payload:{method:e,params:t,id:this._id}});let n=!1;try{const r=kp(e,t),i=()=>H(this,null,function*(){return yield this._onMessage.watch(u=>u.id===r.id,va).catch(()=>{if(!n)throw jr({operationName:"RPC.request",info:Se(ie({},hr.timeout),{detail:"rpc request timeout"}),path:Nn.prefix,payload:{rpcTimeout:va,method:e,params:t,wsReadyState:p1[this._ws.readyState],id:this._id}})})}),a=()=>H(this,null,function*(){Nn.warn("[start] reconnecting. pending request",Ci({operationName:"RPC.request",detail:"[start] reconnecting. pending request",payload:{request:r,id:this._id}})),this._pendingRequests.push(r);const u=yield Promise.race([i(),this.onFatalError.asPromise(va+100).then(p=>{throw n||Nn.error("[failed] reconnecting. pending request",jr({operationName:"RPC.request",info:Se(ie({},hr.internalError),{detail:"onFatalError while request"}),path:Nn.prefix}),p),p})]);return n=!0,Nn.warn("[end] reconnecting. pending request",Ci({operationName:"RPC.request",detail:"[end] reconnecting. pending request",payload:{request:r,id:this._id}})),u});let o;if(this._reconnecting?o=yield a():(this._send(r).catch(u=>{Nn.error("send error",u)}),o=yield Promise.race([i(),H(this,null,function*(){if(yield this.onDisconnected.asPromise(va+100),n)return{};try{const u=yield a();return Nn.warn(Ci({operationName:"request.pendingRequest",detail:"success to handle disconnected"})),u}catch(u){throw jr({operationName:"RPC.request",info:hr.connectionDisconnected,path:Nn.prefix,error:u})}}),this.onFatalError.asPromise(va+100).then(u=>{if(n)return{};throw jr({operationName:"RPC.request",info:Se(ie({},hr.internalError),{detail:"onFatalError while requesting"}),path:Nn.prefix,error:u})}),this.onClosed.asPromise(va+100).then(()=>{if(n)return{};throw jr({operationName:"RPC.request",info:hr.onClosedWhileRequesting,path:Nn.prefix,payload:{method:e,params:t}})})]),n=!0),o.error)throw Nn.warn("[failed] request ",{message:o,method:e,params:t}),jr({operationName:"RPC.request",info:Se(ie({},hr.rpcResponseError),{detail:e,error:o.error}),payload:{message:o,method:e,params:t},path:Nn.prefix});return o.result}catch(r){throw n=!0,r}})}notify(e,t){return H(this,null,function*(){const n=kp(e,t,!0);yield this._send(n)})}batch(e){return H(this,null,function*(){const t=e.map(({method:r,params:i})=>kp(r,i));return this._send(t).catch(r=>{throw r}),yield Promise.all(t.map(r=>H(this,[r],function*({id:i}){return yield this._onMessage.watch(o=>o.id===i,va)})))})}},kp=(e,t,n)=>{if(n)return{jsonrpc:"2.0",method:e,params:t};const r=ji();return{jsonrpc:"2.0",method:e,params:t,id:r}},C6=e=>{const t=e;return!!(t.method&&t.id==null)},p1=["CONNECTING","OPEN","CLOSING","CLOSED"],Rn=new Ze("packages/rtc-rpc-api-client/src/client.ts"),f1,m1,E6=class{constructor(e){this.config=e,this.closed=!1,this._domain=(f1=this.config.domain)!=null?f1:_6,this._secure=(m1=this.config.secure)!=null?m1:!0,this._token=this.config.token,this._rpc=new x6,this._subscribingChannelEvents=new Set,this._subscribingChannelVersions={},this._httpClient=new tg(`http${this.config.secure?"s":""}://${this.config.domain}`),this._reconnectCount=0,this._reconnectLimit=b6,this._events=new es,this.onEvent=this._events.make(),this.onFatalError=this._events.make(),this.onClose=this._events.make(),this.onReconnected=this._events.make();var t,n,r,i;Ze.level=(n=(t=e.log)==null?void 0:t.level)!=null?n:Ze.level,Ze.format=(i=(r=e.log)==null?void 0:r.format)!=null?i:Ze.format,Rn.debug("RtcRpcApiClient spawned",e),this._rpc.onNotify.add(a=>{if(a.method==="channelEventNotification"){const o=a.params;this._subscribingChannelVersions[o.data.channel.id]=o.data.channel.version,this.onEvent.emit({channelId:o.data.channel.id,event:o})}}),this._rpc.onDisconnected.add(()=>H(this,null,function*(){this._rpc.negotiated&&!this._rpc.closed&&!this._rpc.reconnecting&&(yield this._reconnect())})),this._rpc.onFatalError.once(a=>{Rn.error("fatal error",a),this.onFatalError.emit(a),this.close()})}get token(){return this._token}_reconnect(){return H(this,null,function*(){if(this._reconnectCount>=this._reconnectLimit){this._rpc.onFatalError.emit(jr({operationName:"RtcRpcApiClient._reconnect",info:{name:"failed to reconnect",detail:"_reconnectLimit exceeded",solution:""},path:Rn.prefix})),this.close();return}this._rpc.reconnecting=!0,Rn.warn("[start] reconnect",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect start",payload:{reconnectCount:this._reconnectCount,limit:this._reconnectLimit}})),this._reconnectCount++;const e=Ss(this._reconnectCount,2)*100+Ss(this._reconnectCount,2)*100*Math.random();yield new Promise(t=>setTimeout(t,e));try{yield this.connect().catch(t=>{throw Rn.warn("[failed] reconnect rtc api",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"connect rpc failed",payload:{reconnectCount:this._reconnectCount}}),t),t}),this._rpc.reconnecting=!1,this._reconnectCount=0,this._rpc.resolvePendingRequests(),yield Promise.all([...this._subscribingChannelEvents].map(t=>H(this,null,function*(){const[n,r]=t.split(":"),i=this._subscribingChannelVersions[r];yield this.subscribeChannelEvents({appId:n,channelId:r,offset:i})}))).catch(t=>{throw Rn.warn("subscribeChannelEvents failed",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"subscribeChannelEvents failed",payload:{reconnectCount:this._reconnectCount}}),t),t}),Rn.warn("[end] reconnect",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect finished",payload:{reconnectCount:this._reconnectCount}})),this.onReconnected.emit()}catch(t){Rn.warn("[failed] reconnect",Ci({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect failed",payload:{reconnectCount:this._reconnectCount}}),t),yield this._reconnect()}})}updateToken(e){return H(this,null,function*(){Rn.debug("token update",{token:e}),this._token=e,yield this._updateAuthToken()})}close(){this.closed||(this.closed=!0,Rn.debug("closed"),this._rpc.close(),this.onClose.emit(),this._events.dispose())}health(){return H(this,null,function*(){return yield this._httpClient.get("/health")})}connect(){return H(this,null,function*(){Rn.debug("connect to rtc api rpc",this._domain),yield this._rpc.connect({domain:this._domain,token:this.token,secure:this._secure}).catch(e=>{throw jr({operationName:"RtcRpcApiClient.connect",info:hr.failedToConnectRtcAPI,error:e,path:Rn.prefix})})})}_channelSubscribed(e,t){this._subscribingChannelEvents.add(e+":"+t),Rn.debug("_channelSubscribed",{appId:e,channelId:t,_subscribingChannelEvents:[...this._subscribingChannelEvents]})}_isSubscribingChannel(e,t){return this._subscribingChannelEvents.has(e+":"+t)}createChannel(e){return H(this,arguments,function*({name:t,metadata:n,appId:r}){const{channel:i}=yield this._rpc.request("createChannel",{name:t,metadata:n,appId:r,authToken:this.token});return this._channelSubscribed(r,i.id),i})}findOrCreateChannel(e){return H(this,arguments,function*({name:t,metadata:n,appId:r}){const{channel:i}=yield this._rpc.request("findOrCreateChannel",{name:t,metadata:n,appId:r,authToken:this.token});return this._channelSubscribed(r,i.id),i})}getChannel(e){return H(this,arguments,function*({appId:t,id:n}){const r=yield this._rpc.request("getChannel",{id:n,appId:t,authToken:this.token});return this._isSubscribingChannel(t,n)||(this._channelSubscribed(t,n),yield this.subscribeChannelEvents({appId:t,channelId:n,offset:r.channel.version})),r.channel})}getChannelByName(e){return H(this,arguments,function*({name:t,appId:n}){const r=yield this._rpc.request("getChannelByName",{name:t,appId:n,authToken:this.token}),i=r.channel.id;return this._isSubscribingChannel(n,i)||(this._channelSubscribed(n,i),yield this.subscribeChannelEvents({appId:n,channelId:i,offset:r.channel.version})),r.channel})}deleteChannel(e){return H(this,arguments,function*({id:t,appId:n}){yield this._rpc.request("deleteChannel",{id:t,appId:n,authToken:this.token})})}updateChannelMetadata(e){return H(this,arguments,function*({id:t,metadata:n,appId:r}){yield this._rpc.request("updateChannelMetadata",{id:t,metadata:n,appId:r,authToken:this.token})})}addMember(e){return H(this,arguments,function*({channelId:t,name:n,metadata:r,subscribeChannelEvents:i,appId:a,ttlSec:o,subtype:u,type:p}){return yield this._rpc.request("addMember",{channelId:t,name:n,metadata:r,subscribeChannelEvents:i,appId:a,ttlSec:o&&parseInt(o.toString()),authToken:this.token,subtype:u,type:p})})}updateMemberTtl(e){return H(this,arguments,function*(t,n=new ki({times:8})){const{appId:r,channelId:i,memberId:a,ttlSec:o}=t;try{yield this._rpc.request("updateMemberTtl",{appId:r,channelId:i,memberId:a,ttlSec:o&&parseInt(o.toString()),authToken:this.token})}catch(u){if(!n.exceeded)Rn.warn("retry updateMemberTtl",Ci({operationName:"RtcRpcApiClient.updateMemberTtl",detail:"retry updateMemberTtl",appId:r,channelId:i,memberId:a,payload:{backoff:n.count}}),u),yield n.wait(),yield this.updateMemberTtl(t,n);else throw new Er({path:Rn.prefix,info:hr.failedToUpdateMemberTTL,error:u})}})}updateMemberMetadata(e){return H(this,arguments,function*({channelId:t,memberId:n,metadata:r,appId:i}){yield this._rpc.request("updateMemberMetadata",{channelId:t,memberId:n,metadata:r,appId:i,authToken:this.token})})}leaveChannel(e){return H(this,arguments,function*({channelId:t,id:n,appId:r}){yield this._rpc.request("removeMember",{channelId:t,id:n,appId:r,authToken:this.token})})}publishStream(e){return H(this,arguments,function*({appId:t,channelId:n,publisherId:r,contentType:i,metadata:a,origin:o,codecCapabilities:u,encodings:p,isEnabled:h}){return{publicationId:(yield this._rpc.request("publishStream",{channelId:n,publisherId:r,contentType:i[0].toUpperCase()+i.slice(1),metadata:a,origin:o,codecCapabilities:u,encodings:p==null?void 0:p.map(f=>({id:f.id})),isEnabled:h,appId:t,authToken:this.token})).id}})}disablePublication(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("disablePublication",{channelId:t,appId:r,publicationId:n,authToken:this.token})})}enablePublication(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("enablePublication",{channelId:t,appId:r,publicationId:n,authToken:this.token})})}updatePublicationMetadata(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r,metadata:i}){yield this._rpc.request("updatePublicationMetadata",{channelId:t,publicationId:n,metadata:i,appId:r,authToken:this.token})})}unpublishStream(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("unpublishStream",{channelId:t,publicationId:n,appId:r,authToken:this.token})})}subscribeStream(e){return H(this,arguments,function*({channelId:t,subscriberId:n,publicationId:r,appId:i}){return{subscriptionId:(yield this._rpc.request("subscribeStream",{channelId:t,subscriberId:n,publicationId:r,appId:i,authToken:this.token})).id}})}unsubscribeStream(e){return H(this,arguments,function*({channelId:t,subscriptionId:n,appId:r}){yield this._rpc.request("unsubscribeStream",{channelId:t,subscriptionId:n,appId:r,authToken:this.token})})}getServerUnixtime(e){return H(this,arguments,function*(t,n=new ki({times:8})){const{appId:r}=t;try{return(yield this._rpc.request("getServerUnixtime",{appId:r,authToken:this.token})).unixtime}catch(i){if(n.exceeded)throw i;return Rn.warn(Ci({operationName:"RtcRpcApiClient.getServerUnixtime",detail:"retry getServerUnixtime",appId:r,payload:{backoff:n.count}}),i),yield n.wait(),this.getServerUnixtime(t,n)}})}_updateAuthToken(){return H(this,null,function*(){yield this._rpc.request("updateAuthToken",{authToken:this.token})})}subscribeChannelEvents(e){return H(this,arguments,function*({appId:t,channelId:n,offset:r}){try{Rn.debug("[start] subscribeChannelEvents",{offset:r}),yield this._rpc.request("subscribeChannelEvents",{appId:t,authToken:this.token,channelId:n,offset:r}),Rn.debug("[end] subscribeChannelEvents",{offset:r})}catch(i){if(i instanceof Er&&i.info.name===hr.connectionDisconnected.name)Rn.warn("reconnect happened while subscribeChannelEvents. retry",Ci({operationName:"RtcRpcApiClient.subscribeChannelEvents",detail:"reconnect happened while subscribeChannelEvents. retry",appId:t,channelId:n,payload:{offset:r}}),i),yield this.subscribeChannelEvents({appId:t,channelId:n,offset:r});else throw Rn.error("[failed] subscribeChannelEvents",jr({operationName:"RtcRpcApiClient.subscribeChannelEvents",info:Se(ie({},hr.internalError),{detail:"subscribeChannelEvents failed"}),path:Rn.prefix,error:i,payload:{offset:r},appId:t,channelId:n})),i}})}};Y();Y();var P6=$r(zy()),k6=class{constructor(e={}){this.rtcApi={domain:"rtc-api.skyway.ntt.com",timeout:3e4,secure:!0,eventSubscribeTimeout:5e3},this.log={level:"error",format:"object"},Object.assign(this,(0,P6.default)(this,e))}};Y();Y();var nt=Se(ie({},hr),{invalidParameter:{name:"invalidParameter",detail:"",solution:""},notFound:{name:"notFound",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internalError:{name:"internalError",detail:"",solution:""},invalidRequestParameter:{name:"invalidRequestParameter",detail:"",solution:"API"},insufficientPermissions:{name:"insufficientPermissions",detail:"token Token permissions are insufficient",solution:"Token Add the necessary permissions to the Token"},publicationNestedTooMuch:{name:"publicationNestedTooMuch",detail:"originPublicationPublicationorigin It is not possible to specify the origin of a publication for which Origin has been set",solution:" There is no solution because it is a specification limitation"},channelNotFound:{name:"channelNotFound",detail:"channel The channel you tried to reference does not exist.",solution:"channelIdchannelName Make sure that the Channel id and channel name are correct."},memberNotFound:{name:"memberNotFound",detail:"Member The member you tried to reference does not exist.",solution:"memberIdmemberName Make sure that the member id and member name is correct."},publicationNotFound:{name:"publicationNotFound",detail:"Publication The Publication you tried to reference does not exist.",solution:"publicationId Make sure that the publication id is correct."},subscriptionNotFound:{name:"subscriptionNotFound",detail:"Subscription The Subscription you tried to reference does not exist.",solution:"subscriptionId Make sure that the subscription id is correct."},operationConflicted:{name:"operationConflicted",detail:" The channel with the given name has already been created by a conflicting request up to now",solution:"channel"},channelNameDuplicated:{name:"channelNameDuplicated",detail:"Channel A channel with that name already exists",solution:"channel"},memberNameDuplicated:{name:"memberNameDuplicated",detail:"Member A member with that name already exists",solution:"member"},subscriptionAlreadyExists:{name:"subscriptionAlreadyExists",detail:"PublicationSubscribe",solution:"publicationId"},rateLimitExceeded:{name:"rateLimitExceeded",detail:"",solution:""},projectUsageLimitExceeded:{name:"projectUsageLimitExceeded",detail:"",solution:""},invalidAuthToken:{name:"invalidAuthToken",detail:"AuthToken",solution:"AuthToken"},authTokenExpired:{name:"authTokenExpired",detail:"AuthToken",solution:"ExpAuthToken"},serverBusy:{name:"serverBusy",detail:"",solution:""}});Y();function g1({appId:e,detail:t,channelId:n,operationName:r,payload:i}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n}}function rt({operationName:e,info:t,error:n,path:r,channelId:i,appId:a,payload:o}){return new Er({error:n,info:t,payload:{payload:o,operationName:e,channelId:i,appId:a},path:r})}var yt=new Ze("packages/rtc-api-client/src/infrastructure/api.ts"),T6=class{constructor(e){this._client=e,this.closed=!1,this.onClose=new Ye,this.onFatalError=new Ye,this._token=yl.Decode(this._client.token),e.onClose.once(()=>{this.close()}),e.onFatalError.add(t=>{this.onFatalError.emit(t)})}connect(){return H(this,null,function*(){yield this._client.connect()})}updateAuthToken(e){return H(this,null,function*(){this._token=yl.Decode(e),yield this._client.updateToken(e).catch(t=>{var n,r,i,a,o;const{info:u}=t;if(((r=(n=u==null?void 0:u.error)==null?void 0:n.data)==null?void 0:r.code)===429001)throw rt({operationName:"RtcApiImpl.updateAuthToken",path:yt.prefix,info:nt.projectUsageLimitExceeded,error:t});const p=this._commonError("RtcApiImpl.updateAuthToken",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,t);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 401:throw rt({operationName:"RtcApiImpl.updateAuthToken",path:yt.prefix,info:nt.invalidAuthToken,error:t});default:throw rt({operationName:"RtcApiImpl.updateAuthToken",path:yt.prefix,info:nt.internalError,error:t})}})})}close(){this.closed||(this.closed=!0,yt.debug("closed"),this._client.close(),this.onClose.emit(),this.onClose.removeAllListeners())}_commonError(e,t,n){switch(t){case-32602:return rt({operationName:e,info:nt.invalidRequestParameter,path:yt.prefix,error:n});case-32603:return rt({operationName:e,info:nt.internalError,path:yt.prefix,error:n});case 403:case 4030:return rt({operationName:e,info:nt.insufficientPermissions,path:yt.prefix,error:n});case 429:return rt({operationName:e,info:nt.rateLimitExceeded,path:yt.prefix,error:n})}}createChannel(e,t){return H(this,null,function*(){const{id:n}=yield this._client.createChannel({appId:e,name:t.name,metadata:t.metadata}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.createChannel",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw rt({operationName:"RtcApiImpl.createChannel",path:yt.prefix,info:nt.channelNotFound,error:i});case 409:throw rt({operationName:"RtcApiImpl.createChannel",path:yt.prefix,info:nt.channelNameDuplicated,error:i});default:throw rt({operationName:"RtcApiImpl.createChannel",path:yt.prefix,info:nt.internalError,error:i})}});return yield this.getChannel(e,{id:n})})}getChannel(e,t){return H(this,arguments,function*(n,{name:r,id:i}){if(i)return yield this._client.getChannel({appId:n,id:i}).catch(a=>{var o,u,p;const{info:h}=a,g=this._commonError("RtcApiImpl.getChannel",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(g)throw g;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw rt({operationName:"RtcApiImpl.getChannel",path:yt.prefix,info:nt.channelNotFound,error:a});default:throw rt({operationName:"RtcApiImpl.getChannel",path:yt.prefix,info:nt.internalError,error:a})}});if(r)return yield this._client.getChannelByName({appId:n,name:r}).catch(a=>{var o,u,p;const{info:h}=a,g=this._commonError("RtcApiImpl.getChannel",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(g)throw g;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw rt({operationName:"getChannel",path:yt.prefix,info:nt.channelNotFound,error:a});default:throw rt({operationName:"getChannel",path:yt.prefix,info:nt.internalError,error:a})}});throw rt({operationName:"RtcApiImpl.createChannel",path:yt.prefix,info:nt.invalidRequestParameter})})}findOrCreateChannel(e,t){return H(this,null,function*(){return this._client.findOrCreateChannel(Se(ie({},t),{appId:e})).catch(n=>{var r,i,a,o;const{info:u}=n,p=this._commonError("RtcApiImpl.findOrCreateChannel",(i=(r=u==null?void 0:u.error)==null?void 0:r.code)!=null?i:-1,n);if(p)throw p;if(t.name&&((a=u==null?void 0:u.error)==null?void 0:a.code)===409)return this.getChannel(e,{name:t.name});switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw rt({operationName:"RtcApiImpl.findOrCreateChannel",path:yt.prefix,info:nt.channelNotFound,error:n});case 409:throw rt({operationName:"RtcApiImpl.findOrCreateChannel",path:yt.prefix,info:nt.channelNameDuplicated,error:n});default:throw rt({operationName:"RtcApiImpl.findOrCreateChannel",path:yt.prefix,info:nt.internalError,error:n})}})})}deleteChannel(e,t){return H(this,null,function*(){yield this._client.deleteChannel({appId:e,id:t}).catch(n=>{var r,i,a;const{info:o}=n,u=this._commonError("RtcApiImpl.deleteChannel",(i=(r=o==null?void 0:o.error)==null?void 0:r.code)!=null?i:-1,n);if(u)throw u;switch((a=o==null?void 0:o.error)==null?void 0:a.code){case 404:throw rt({operationName:"RtcApiImpl.deleteChannel",path:yt.prefix,info:nt.channelNotFound,error:n});default:throw rt({operationName:"RtcApiImpl.deleteChannel",path:yt.prefix,info:nt.internalError,error:n})}})})}updateChannelMetadata(e,t,n){return H(this,null,function*(){yield this._client.updateChannelMetadata({appId:e,id:t,metadata:n}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.updateChannelMetadata",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw rt({operationName:"RtcApiImpl.updateChannelMetadata",path:yt.prefix,info:nt.channelNotFound,error:r});default:throw rt({operationName:"RtcApiImpl.updateChannelMetadata",path:yt.prefix,info:nt.internalError,error:r})}})})}join(e,t,n){return H(this,null,function*(){const{memberId:r}=yield this._client.addMember({appId:e,channelId:t,name:n.name,metadata:n.metadata,ttlSec:n.ttlSec,type:n.type,subtype:n.subtype}).catch(a=>{var o,u,p;const{info:h}=a,g=this._commonError("RtcApiImpl.addMember",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(g)throw g;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw rt({operationName:"RtcApiImpl.addMember",path:yt.prefix,info:nt.channelNotFound,error:a});case 409:throw rt({operationName:"RtcApiImpl.addMember",path:yt.prefix,info:nt.memberNameDuplicated,error:a});default:throw rt({operationName:"RtcApiImpl.addMember",path:yt.prefix,info:nt.internalError,error:a})}});return{id:r,name:n.name,type:n.type,subtype:n.subtype,metadata:n.metadata}})}updateMemberTtl(e,t,n,r){return H(this,null,function*(){yield this._client.updateMemberTtl({appId:e,channelId:t,memberId:n,ttlSec:r}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updateMemberTtl",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw rt({operationName:"RtcApiImpl.updateMemberTtl",path:yt.prefix,info:nt.memberNotFound,error:i});default:throw rt({operationName:"RtcApiImpl.updateMemberTtl",path:yt.prefix,info:nt.internalError,error:i})}})})}getServerUnixtime(e){return H(this,null,function*(){return yield this._client.getServerUnixtime({appId:e}).catch(t=>{var n,r;const{info:i}=t,a=this._commonError("RtcApiImpl.getServerUnixtime",(r=(n=i==null?void 0:i.error)==null?void 0:n.code)!=null?r:-1,t);throw a||rt({operationName:"RtcApiImpl.getServerUnixtime",path:yt.prefix,info:nt.internalError,error:t})})})}updateMemberMetadata(e,t,n,r){return H(this,null,function*(){yield this._client.updateMemberMetadata({appId:e,channelId:t,memberId:n,metadata:r}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updateMemberMetadata",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw rt({operationName:"RtcApiImpl.updateMemberMetadata",path:yt.prefix,info:nt.memberNotFound,error:i});default:throw rt({operationName:"RtcApiImpl.updateMemberMetadata",path:yt.prefix,info:nt.internalError,error:i})}})})}leave(e,t,n){return H(this,null,function*(){yield this._client.leaveChannel({channelId:t,id:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.leaveChannel",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw rt({operationName:"RtcApiImpl.leaveChannel",path:yt.prefix,info:nt.memberNotFound,error:r});default:throw rt({operationName:"RtcApiImpl.leaveChannel",path:yt.prefix,info:nt.internalError,error:r})}})})}publish(e,t){return H(this,null,function*(){const{publicationId:n}=yield this._client.publishStream({channelId:t.channel,publisherId:t.publisher,contentType:t.contentType,metadata:t.metadata,origin:t.origin,codecCapabilities:t.codecCapabilities,encodings:t.encodings,isEnabled:t.isEnabled,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.publish",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){default:throw rt({operationName:"RtcApiImpl.publish",path:yt.prefix,info:nt.internalError,error:r})}});return n})}updatePublicationMetadata(e,t,n,r){return H(this,null,function*(){yield this._client.updatePublicationMetadata({channelId:t,publicationId:n,metadata:r,appId:e}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updatePublicationMetadata",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw rt({operationName:"RtcApiImpl.updatePublicationMetadata",path:yt.prefix,info:nt.publicationNotFound,error:i});default:throw rt({operationName:"RtcApiImpl.updatePublicationMetadata",path:yt.prefix,info:nt.internalError,error:i})}})})}disablePublication(e,t,n){return H(this,null,function*(){yield this._client.disablePublication({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.disablePublication",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw rt({operationName:"RtcApiImpl.disablePublication",path:yt.prefix,info:nt.publicationNotFound,error:r});default:throw rt({operationName:"RtcApiImpl.disablePublication",path:yt.prefix,info:nt.internalError,error:r})}})})}enablePublication(e,t,n){return H(this,null,function*(){yield this._client.enablePublication({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.enablePublication",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw rt({operationName:"RtcApiImpl.enablePublication",path:yt.prefix,info:nt.publicationNotFound,error:r});default:throw rt({operationName:"RtcApiImpl.enablePublication",path:yt.prefix,info:nt.internalError,error:r})}})})}unpublish(e,t,n){return H(this,null,function*(){yield this._client.unpublishStream({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.unpublishStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw rt({operationName:"RtcApiImpl.unpublishStream",path:yt.prefix,info:nt.publicationNotFound,error:r});default:throw rt({operationName:"RtcApiImpl.unpublishStream",path:yt.prefix,info:nt.internalError,error:r})}})})}subscribe(e,t){return H(this,null,function*(){const{subscriptionId:n}=yield this._client.subscribeStream({channelId:t.channel.id,subscriberId:t.subscriber.id,publicationId:t.publication.id,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.subscribeStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw rt({operationName:"RtcApiImpl.subscribeStream",path:yt.prefix,info:nt.publicationNotFound,error:r});case 409:throw rt({operationName:"RtcApiImpl.subscribeStream",path:yt.prefix,info:nt.subscriptionAlreadyExists,error:r});default:throw rt({operationName:"RtcApiImpl.subscribeStream",path:yt.prefix,info:nt.internalError,error:r})}});return n})}unsubscribe(e,t,n){return H(this,null,function*(){yield this._client.unsubscribeStream({appId:e,channelId:t,subscriptionId:n}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.unsubscribeStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw rt({operationName:"RtcApiImpl.unsubscribeStream",path:yt.prefix,info:nt.publicationNotFound,error:r});default:throw rt({operationName:"RtcApiImpl.unsubscribeStream",path:yt.prefix,info:nt.internalError,error:r})}})})}};Y();var xa=new Ze("packages/rtc-api-client/src/infrastructure/eventObserver.ts"),R6=class{constructor(e,t,n,r){this.onEvent=new Ye,this._disposer=[];const i=new A6(n.version,a=>H(null,null,function*(){yield t.subscribeChannelEvents({appId:e,channelId:n.id,offset:a}),yield new Promise(o=>setTimeout(o,r.eventSubscribeTimeout)),i.packetLostHappened&&xa.error(rt({operationName:"EventObserverImpl.eventJitterBuffer",info:Se(ie({},nt.internalError),{detail:"failed to resolve event lost"}),channelId:n.id,appId:e,path:xa.prefix}))}));this._disposer=[t.onEvent.add(a=>H(this,[a],function*({channelId:o,event:u}){o===n.id&&i.push({event:u,version:u.data.channel.version})})).removeListener,i.onEvent.add(a=>{this.onEvent.emit(a)}).removeListener]}dispose(){this._disposer.forEach(e=>e()),this.onEvent.removeAllListeners()}},A6=class{constructor(e,t,n=1e3){this.presentVersion=e,this.onPacketLost=t,this.packetLifetime=n,this.onEvent=new Ye,this.eventBuffer={},this.packetLostHappened=!1}get expectNextVersion(){return this.presentVersion+1}push(e){const t=e.version;if(t<this.expectNextVersion){xa.debug("duplicate event",Se(ie({},e),{presentVersion:this.presentVersion}));return}if(t>this.expectNextVersion){xa.debug("maybe miss order event received",Se(ie({},e),{presentVersion:this.presentVersion})),this.eventBuffer[t]=e,this.handlePacketLifetime();return}this.packetLostHappened&&(xa.warn("event packetLost resolved",g1({operationName:"EventJitterBuffer.push",detail:"event packetLost resolved",payload:{eventFrame:e}})),this.packetLostHappened=!1),this.eventBuffer[t]=e,this.resolveEvents()}handlePacketLifetime(){const[e]=Object.keys(this.eventBuffer).sort().map(t=>this.eventBuffer[Number(t)]);this.packetLifeTimer==null&&e&&(xa.debug("set event packetLost timer",Se(ie({},e),{presentVersion:this.presentVersion})),this.packetLifeTimer=setTimeout(()=>H(this,null,function*(){if(this.presentVersion<e.version){if(xa.warn("event packetLost",g1({operationName:"EventJitterBuffer.handlePacketLifetime",detail:"eventPacket lost",payload:{oldestBufferedEvent:e,eventBufferLength:Object.keys(this.eventBuffer).length,presentVersion:this.presentVersion}})),this.packetLostHappened)return;this.packetLostHappened=!0,yield this.onPacketLost(this.expectNextVersion)}this.packetLifeTimer=void 0,this.handlePacketLifetime()}),this.packetLifetime))}resolveEvents(){const e=[];for(let t=this.expectNextVersion;;t++){const n=this.eventBuffer[t];if(n)e.push(n),delete this.eventBuffer[t];else break}e.length>0&&(this.presentVersion=e.slice(-1)[0].version,e.forEach(t=>{this.onEvent.emit(t.event)}))}},bi=new Ze("packages/rtc-api-client/src/client.ts"),I6=class _b{constructor(t,n,r,i){this.appId=t,this.config=n,this.apiClient=r,this._eventObserverFactory=i,this.closed=!1,this.onFatalError=new Ye,this.apiClient.onFatalError.pipe(this.onFatalError)}static Create(t){return H(this,null,function*(){const n=new k6(t);n.log&&(Ze.level=n.log.level,Ze.format=n.log.format),bi.debug("RtcApiClient spawned",n);const r=new E6(Se(ie({},n.rtcApi),{token:t.token,log:n.log})),i=new T6(r);yield i.connect();const a=(o,u)=>new R6(o,r,u,n.rtcApi);return new _b(t.appId,n,i,a)})}updateAuthToken(t){return H(this,null,function*(){yield this.apiClient.updateAuthToken(t)})}getServerUnixtimeInMs(){return H(this,null,function*(){return this.apiClient.getServerUnixtime(this.appId)})}getServerUnixtimeInSec(){return H(this,null,function*(){return Math.floor((yield this.getServerUnixtimeInMs())/1e3)})}createChannel(){return H(this,arguments,function*(t={}){bi.debug("[start] apiClient.createChannel",{init:t});const n=yield this.apiClient.createChannel(this.appId,t).catch(i=>{throw bi.debug("[failed] apiClient.createChannel",{init:t,e:i}),i});return bi.debug("[end] apiClient.createChannel",{init:t,channelDto:n}),Tp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config)})}findChannel(t){return H(this,null,function*(){bi.debug("[start] apiClient.getChannel",{query:t});const n=yield this.apiClient.getChannel(this.appId,t).catch(i=>{throw bi.debug("[failed] apiClient.getChannel",{query:t,e:i}),i}),r=Tp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config);return bi.debug("[end] apiClient.getChannel",{channelId:r.id}),r})}findOrCreateChannel(t){return H(this,null,function*(){bi.debug("[start] apiClient.findOrCreateChannel",{query:t});const n=yield this.apiClient.findOrCreateChannel(this.appId,t).catch(i=>{throw bi.debug("[failed] apiClient.findOrCreateChannel",{query:t,e:i}),i});return bi.debug("[end] apiClient.findOrCreateChannel",{query:t}),Tp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config)})}deleteChannel(t){return this.apiClient.deleteChannel(this.appId,t)}close(){this.closed||(this.closed=!0,bi.debug("closed",{appid:this.appId}),this.apiClient.close())}};Y();Y();var F6={};Y();var Gt=new Ze("packages/rtc-api-client/src/domain/channel.ts"),D6=class{constructor(e,{id:t,name:n,members:r,metadata:i,publications:a,subscriptions:o,version:u},p,h,g){this.appId=e,this.eventObserver=p,this.apiClient=h,this.config=g,this.disposed=!1,this._events=new es,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.updateChannelMetadata=f=>new Promise((_,w)=>{let C=!1;this.apiClient.updateChannelMetadata(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onMetadataUpdated.watch(R=>R.channel.metadata===f).then(()=>_()).catch(R=>{C||w(rt({operationName:"ChannelImpl.updateChannelMetadata",info:Se(ie({},nt.timeout),{detail:"onMetadataUpdated"}),path:Gt.prefix,error:R,appId:this.appId,channelId:this.id}))})}),this.leave=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.leave(this.appId,f,_).catch(S=>{R=!0,C(S)}),this.onMemberLeft.watch(S=>S.member.id===_,this.config.rtcApi.timeout).then(()=>w()).catch(S=>{R||C(rt({operationName:"ChannelImpl.leave",info:Se(ie({},nt.timeout),{detail:"onMemberLeft"}),path:Gt.prefix,error:S,appId:this.appId,channelId:this.id}))})}),this.updateMemberMetadata=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.updateMemberMetadata(this.appId,this.id,f,_).catch(S=>{R=!0,C(S)}),this.onMemberMetadataUpdated.watch(S=>S.member.id===f&&S.member.metadata===_).then(()=>w()).catch(S=>{R||C(rt({operationName:"ChannelImpl.updateMemberMetadata",info:Se(ie({},nt.timeout),{detail:"onMemberMetadataUpdated"}),path:Gt.prefix,error:S,appId:this.appId,channelId:this.id}))})}),this.unpublish=f=>new Promise((_,w)=>{let C=!1;this.apiClient.unpublish(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onStreamUnpublished.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(rt({operationName:"ChannelImpl.unpublish",info:Se(ie({},nt.timeout),{detail:"onStreamUnpublished"}),path:Gt.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.updatePublicationMetadata=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.updatePublicationMetadata(this.appId,this.id,f,_).catch(S=>{R=!0,C(S)}),this.onPublicationMetadataUpdated.watch(S=>S.publication.id===f&&S.publication.metadata===_).then(()=>w()).catch(S=>{R||C(rt({operationName:"ChannelImpl.updatePublicationMetadata",info:Se(ie({},nt.timeout),{detail:"onPublicationMetadataUpdated"}),path:Gt.prefix,error:S,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.disablePublication=f=>new Promise((_,w)=>{let C=!1;this.apiClient.disablePublication(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationDisabled.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(rt({operationName:"ChannelImpl.disablePublication",info:Se(ie({},nt.timeout),{detail:"onPublicationDisabled"}),path:Gt.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.enablePublication=f=>new Promise((_,w)=>{let C=!1;this.apiClient.enablePublication(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationEnabled.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(rt({operationName:"ChannelImpl.enablePublication",info:Se(ie({},nt.timeout),{detail:"onPublicationEnabled"}),path:Gt.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.unsubscribe=f=>new Promise((_,w)=>{let C=!1;this.apiClient.unsubscribe(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationUnsubscribed.watch(R=>R.subscription.id===f).then(()=>_()).catch(R=>{C||w(rt({operationName:"ChannelImpl.unsubscribe",info:Se(ie({},nt.timeout),{detail:"onPublicationUnsubscribed"}),path:Gt.prefix,error:R,payload:{subscriptionId:f},appId:this.appId,channelId:this.id}))})}),this.id=t,this.name=n,this.metadata=i,this.members=r,this.publications=a,this.subscriptions=o,this.version=u,p.onEvent.add(f=>{Gt.debug("received event: ",f),this.version=f.data.channel.version;try{switch(f.type){case"ChannelDeleted":this._channelClosed();break;case"ChannelMetadataUpdated":this._channelMetadataUpdated(f.data);break;case"MemberAdded":this._memberJoined(f.data);break;case"MemberRemoved":this._memberLeft(f.data);break;case"MemberMetadataUpdated":this._memberMetadataUpdated(f.data);break;case"StreamPublished":this._streamPublished(f.data);break;case"StreamUnpublished":this._streamUnpublished(f.data);break;case"PublicationMetadataUpdated":this._publicationMetadataUpdated(f.data);break;case"PublicationDisabled":this._publicationDisabled(f.data);break;case"PublicationEnabled":this._publicationEnabled(f.data);break;case"StreamSubscribed":this._streamSubscribed(f.data);break;case"StreamUnsubscribed":this._streamUnsubscribed(f.data);break}}catch(_){Gt.error(_)}}),h.onClose.once(()=>{this.dispose()})}getMember(e){return this.members.find(t=>t.id===e)}addMember(e){const t=this.getMember(e.id);return t||(this.members.push(e),e)}deleteMember(e){this.members=this.members.filter(t=>t.id!==e)}getPublication(e){return this.publications.find(t=>t.id===e)}addPublication(e){var t,n;const r=this.getPublication(e.id);if(r)return r;const i=Se(ie({},e),{channelId:this.id,codecCapabilities:(t=e.codecCapabilities)!=null?t:[],encodings:(n=e.encodings)!=null?n:[]});return this.publications.push(i),i}deletePublication(e){this.publications=this.publications.filter(t=>t.id!==e)}getSubscription(e){return this.subscriptions.find(t=>t.id===e)}addSubscription(e){const t=this.getSubscription(e.id);if(t)return t;const n=this.getPublication(e.publicationId),r=Se(ie({},e),{channelId:this.id,publisherId:n.publisherId,contentType:n.contentType});return this.subscriptions.push(r),r}deleteSubscription(e){this.subscriptions=this.subscriptions.filter(t=>t.id!==e)}_channelClosed(){this.onClosed.emit({})}_channelMetadataUpdated(e){this.metadata=e.channel.metadata,this.onMetadataUpdated.emit(e)}_memberJoined(e){this.addMember(e.member),this.onMemberJoined.emit(e),this.onMemberListChanged.emit({})}_memberLeft(e){const t=this.getMember(e.member.id);if(!t)throw rt({operationName:"ChannelImpl._memberLeft",info:nt.memberNotFound,path:Gt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deleteMember(t.id),this.onMemberLeft.emit({member:t}),this.onMemberListChanged.emit({})}_memberMetadataUpdated(e){const t=this.getMember(e.member.id);if(!t)throw rt({operationName:"ChannelImpl._memberMetadataUpdated",info:nt.memberNotFound,path:Gt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.metadata=e.member.metadata,this.onMemberMetadataUpdated.emit(e)}_streamPublished(e){const t=this.addPublication(e.publication),n=Se(ie({},e),{publication:t});this.onStreamPublished.emit(n),this.onPublicationListChanged.emit({})}_streamUnpublished(e){const t=this.getPublication(e.publication.id);if(!t)throw rt({operationName:"ChannelImpl._streamUnpublished",info:nt.publicationNotFound,path:Gt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deletePublication(t.id);const n=Se(ie({},e),{publication:t});this.onStreamUnpublished.emit(n),this.onPublicationListChanged.emit({})}_publicationMetadataUpdated(e){const t=this.getPublication(e.publication.id);if(!t)throw rt({operationName:"ChannelImpl._publicationMetadataUpdated",info:nt.publicationNotFound,path:Gt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.metadata=e.publication.metadata;const n=Se(ie({},e),{publication:t});this.onPublicationMetadataUpdated.emit(n)}_publicationDisabled(e){const t=this.getPublication(e.publication.id);if(!t)throw rt({operationName:"ChannelImpl._publicationDisabled",info:nt.publicationNotFound,path:Gt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.isEnabled=e.publication.isEnabled;const n={publication:t};this.onPublicationDisabled.emit(n)}_publicationEnabled(e){const t=this.getPublication(e.publication.id);if(!t)throw rt({operationName:"ChannelImpl._publicationEnabled",info:nt.publicationNotFound,path:Gt.prefix,payload:{event:F6},appId:this.appId,channelId:this.id});t.isEnabled=e.publication.isEnabled;const n={publication:t};this.onPublicationEnabled.emit(n)}_streamSubscribed(e){const t=this.addSubscription(e.subscription),n=Se(ie({},e),{subscription:t});this.onPublicationSubscribed.emit(n),this.onSubscriptionListChanged.emit({})}_streamUnsubscribed(e){const t=this.getSubscription(e.subscription.id);if(!t)throw rt({operationName:"ChannelImpl._streamUnsubscribed",info:nt.subscriptionNotFound,path:Gt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deleteSubscription(t.id);const n=Se(ie({},e),{subscription:t});this.onPublicationUnsubscribed.emit(n),this.onSubscriptionListChanged.emit({})}joinChannel(e){return H(this,null,function*(){var t;e.type&&(e.type=e.type[0].toUpperCase()+e.type.slice(1)),e.subtype&&(e.subtype=e.subtype[0].toUpperCase()+e.subtype.slice(1)),Gt.debug("[start] joinChannel",{memberInit:e});const n=yield this.apiClient.join(this.appId,this.id,ie({},e)),r=(t=this.getMember(n.id))!=null?t:(yield this.onMemberJoined.watch(i=>i.member.id===n.id,this.config.rtcApi.timeout).catch(i=>{throw rt({operationName:"ChannelImpl.joinChannel",info:Se(ie({},nt.timeout),{detail:"onMemberJoined"}),path:Gt.prefix,error:i,appId:this.appId,channelId:this.id})})).member;return Gt.debug("[end] joinChannel",{member:r}),r})}updateMemberTtl(e,t){return this.apiClient.updateMemberTtl(this.appId,this.id,e,t)}publish(e){return H(this,null,function*(){var t,n,r;const i=Gt.debug("[start] apiClient.publish",{init:e}),a=this.id,o=yield this.apiClient.publish(this.appId,Se(ie({},e),{channel:a})),u={id:o,channelId:a,publisherId:e.publisher,origin:e.origin,contentType:e.contentType,metadata:e.metadata,codecCapabilities:(t=e.codecCapabilities)!=null?t:[],encodings:(n=e.encodings)!=null?n:[],isEnabled:(r=e.isEnabled)!=null?r:!0};Gt.elapsed(i,"[ongoing] apiClient.publish",{publicationDto:u});const p=this.getPublication(o);if(p)return p;const{publication:h}=yield this.onStreamPublished.watch(g=>g.publication.id===o,this.config.rtcApi.timeout).catch(g=>{throw rt({operationName:"ChannelImpl.publish",info:Se(ie({},nt.timeout),{detail:"onStreamPublished"}),path:Gt.prefix,error:g,payload:{publicationDto:u},appId:this.appId,channelId:this.id})});return Gt.elapsed(i,"[end] apiClient.publish",{publicationDto:u}),h})}subscribe(e){return H(this,null,function*(){const t=Gt.debug("[start] apiClient.subscribe",{init:e}),n=yield this.apiClient.subscribe(this.appId,Se(ie({},e),{channel:this})),r={id:n,publicationId:e.publication.id,channelId:this.id,publisherId:e.publication.publisherId,subscriberId:e.subscriber.id,contentType:e.publication.contentType};Gt.elapsed(t,"[ongoing] apiClient.subscribe",{subscriptionDto:r});const i=this.getSubscription(n);if(i)return Gt.elapsed(t,"[end] apiClient.subscribe",{subscriptionDto:r}),i;const{subscription:a}=yield this.onPublicationSubscribed.watch(o=>o.subscription.id===n,this.config.rtcApi.timeout).catch(o=>{throw Gt.elapsed(t,"[fail] apiClient.subscribe",o),rt({operationName:"ChannelImpl.subscribe",info:Se(ie({},nt.timeout),{detail:"onPublicationSubscribed"}),path:Gt.prefix,error:o,payload:{subscriptionDto:r}})});return Gt.elapsed(t,"[end] apiClient.subscribe",{subscriptionDto:r}),a})}close(){return this.apiClient.deleteChannel(this.appId,this.id)}dispose(){this.disposed||(this.disposed=!0,Gt.debug("disposed",{id:this.id}),this.eventObserver.dispose(),this._events.dispose())}};function Tp(e,t,n,r,i){return new D6(e,r,t,n,i)}Y();Y();Y();Y();var Ds=class{constructor(e,t){this.id=ji(),this.type=e,this.payload=t}toJSON(){return{id:this.id,type:this.type,payload:this.payload}}};Y();function N6(e){return!(typeof e!="object"||e===null||Array.isArray(e))}function O6(e){if(!e||typeof e!="object"||!e.statsRequest||typeof e.statsRequest!="object"||!e.statsRequest.intervalSec||typeof e.statsRequest.intervalSec!="number"||!e.statsRequest.types||!Array.isArray(e.statsRequest.types))return!1;for(const t of e.statsRequest.types){if(!t.type||typeof t.type!="string"||!t.properties||!N6(t.properties))return!1;for(const n of Object.keys(t.properties))if(!("normalization"in t.properties[n])||typeof t.properties[n].normalization!="boolean"||!t.properties[n].outputKey||typeof t.properties[n].outputKey!="string")return!1}return!0}var M6=["invalidPayload","unexpected"];function v1(e){return!(!e||typeof e!="object"||typeof e.eventId!="string"||typeof e.ok!="boolean"||typeof e.reason<"u"&&(typeof e.reason!="string"||!M6.includes(e.reason)))}Y();var Rp=$r($m());Y();var zs=class{constructor(){this._listeners=new Map,this._listenerIndex=0,this.emit=e=>{this._listeners.forEach(t=>t(e))},this.removeAllListeners=()=>{this._listeners.clear()},this.addListener=e=>{const t=this._listenerIndex;return this._listeners.set(t,e),this._listenerIndex++,{removeListener:()=>{this._listeners.delete(t)}}},this.addOneTimeListener=e=>{const t=this.addListener(n=>{t.removeListener(),e(n)});return t},this.asPromise=e=>new Promise((t,n)=>{let r=()=>{};const i=e&&setTimeout(()=>{n("Event asPromise timeout"),r()},e);r=this.addOneTimeListener(o=>{i&&clearTimeout(i),t(o)}).removeListener})}},L6=["Open","Acknowledge"],j6=e=>(Ss(2,e)+Math.random())*1e3,B6=class{constructor({sessionEndpoint:e,token:t,logger:n,sdkVersion:r,contextId:i}){this._isOpen=!1,this._isClosed=!1,this._reconnectCount=0,this.connectionState="connecting",this.onConnectionStateChanged=new zs,this.onOpened=new zs,this.onTokenExpired=new zs,this.onEventReceived=new zs,this.onConnectionFailed=new zs,this._resendClientEvents=[],this._sessionEndpoint=e,this._token=t,this._logger=n,this._sdkVersion=r,this._contextId=i,this._connect()}_setConnectionState(e){this.connectionState!==e&&(this._logger.debug(`connectionState changed : ${e}`),this.connectionState=e,this.onConnectionStateChanged.emit(e))}_connect(){let e;try{const t=`SkyWayAuthToken!${this._token}`,n={sdkPlatform:"js",sdkVersion:this._sdkVersion,contextId:this._contextId},r=Object.entries(n).filter(([a,o])=>o!==void 0).map(a=>a.join("=")).join("&"),i=`${this._sessionEndpoint}?${r}`;e=new Rp.default(i,t),this._logger.debug(`Connecting to analytics-logging-server: ${this._sessionEndpoint}`),e.onerror=a=>{this._logger.error("WebSocket error occurred",a.error),e.close(4202)}}catch(t){const n=t instanceof Error?t:new Error;this._logger.error("Failed to create WebSocket instance",n),this.reconnect();return}e.onopen=()=>{this._logger.debug("Connected to analytics-logging-server")},e.onclose=t=>{const n="Close event fired: "+JSON.stringify({code:t.code,reason:t.reason,type:t.type});if(4100<=t.code&&t.code<=4199||t.code===1009?this._logger.error(n,new Error):this._logger.debug(n),t.code!==1e3&&t.code!==1009&&!(4e3<=t.code&&t.code<=4199)){t.code===4200?this.onTokenExpired.emit():this.reconnect();return}this._logger.debug("Closed the connection to analytics-logging-server"),this.onConnectionFailed.emit({code:t.code,reason:t.reason}),this.close()},e.onmessage=t=>{this._messageHandler(t.data)},this._ws=e}updateAuthToken(e){this._token=e}reconnect(){if(this._ws!==void 0&&this._ws.close(4e3),this._ws=void 0,this._isOpen=!1,this._reconnectCount>=5)this.onConnectionFailed.emit({}),this.close(),this._logger.error("Failed to reconnect for five times",new Error);else{this._setConnectionState("reconnecting");const e=j6(this._reconnectCount);this._reconnectTimer=setTimeout(()=>{this._connect(),this._reconnectCount++,this._logger.debug(`Try to reconnect: count = ${this._reconnectCount}`)},e)}}close(){this._isClosed=!0,this.destroy()}destroy(){this._setConnectionState("closed"),this.onConnectionStateChanged.removeAllListeners(),this.onOpened.removeAllListeners(),this.onEventReceived.removeAllListeners(),this.onConnectionFailed.removeAllListeners(),this._reconnectTimer&&clearTimeout(this._reconnectTimer),this._ws!==void 0&&this._ws.close(1e3)}send(e){return H(this,null,function*(){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==Rp.default.OPEN){this._logger.debug("Try to reconnect because connection is lost"),this.resendAfterReconnect(e);return}const t=JSON.stringify(e.toJSON());this._ws.send(t,n=>{if(n){this._logger.debug(`Try to reconnect because failed to send: ${n.message}`),this.resendAfterReconnect(e);return}})})}resendAfterReconnect(e){this._resendClientEvents.some(n=>n.id===e.id)||this._resendClientEvents.push(e),this.connectionState!=="reconnecting"&&this.reconnect()}pushResendClientEventsQueue(e){this._resendClientEvents.push(e)}isClosed(){return this._isClosed}_messageHandler(e){if(typeof e!="string"){this._logger.error("Received invalid message: not string",new Error);return}let t;try{t=JSON.parse(e)}catch(n){const r=n instanceof Error?n:new Error;this._logger.error("Received invalid message: parse error",r);return}if(!U6(t)){this._logger.error(`Received invalid message: ${JSON.stringify(t)}`,new Error);return}if(t.type==="Open"){if(!O6(t.payload)){this._logger.error(`Received invalid message: ${JSON.stringify(t.payload)}`,new Error);return}if(this._logger.debug("Received a open event"),this._isOpen=!0,this._setConnectionState("connected"),this._reconnectCount!==0&&(this._reconnectCount=0,this._logger.debug("Succeeded to reconnect")),this._resendClientEvents.length>0){for(const n of this._resendClientEvents){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==Rp.default.OPEN){this._logger.error(`Failed to resend event because connection lost after reconnect: ${n}`,new Error);continue}const r=JSON.stringify(n.toJSON());this._ws.send(r,i=>{if(i){this._logger.error(`Failed to resend event: ${n}`,i);return}this._logger.debug(`Succeed to resend ClientEvent: ${n}`)})}this._logger.debug("Process of resending ClientEvents is completed"),this._resendClientEvents=[]}this.onOpened.emit(t.payload)}else this._logger.debug(`Received the event: ${t.type}, payload: ${JSON.stringify(t.payload)}`),this.onEventReceived.emit(t)}};function U6(e){return!(!e||typeof e!="object"||typeof e.type!="string"||!L6.includes(e.type)||typeof e.id!="string"||e.payload&&typeof e.payload!="object")}Y();var H6=class{constructor(e={}){this.count=0,this.times=8,this.interval=100,this.jitter=0,Object.assign(this,e)}wait(){return H(this,null,function*(){if(this.exceeded)return!1;const e=this.timeout;return this.count++,yield new Promise(t=>setTimeout(t,e)),!0})}get timeout(){return Ss(this.count,2)*this.interval+Ss(this.count,2)*this.jitter*Math.random()}get exceeded(){return this.count>=this.times}reset(){this.count=0}stop(){this.count=this.times}},y1="analytics-logging.skyway.ntt.com",V6="v2",q6=5,bb=class Sb{constructor({token:t,sdkVersion:n,contextId:r},i){this.onConnectionStateChanged=new zs,this.onConnectionFailed=new zs,this.onAnalyticsNotEnabledError=new zs,this._isClosed=!1,this._responseCallbacks=new Map,this._acknowledgeCallbacks=new Map,this._mediaDeviceVersion=new Map,this._encodingsVersion=new Map,this._preferredEncodingVersion=new Map,this._previousSubscriptionStats=new Map,this._statsRequest={intervalSec:5,types:[]},this._pendingSdkLogs=[],this._token=t,this._newToken=void 0,this._sdkVersion=n,this._contextId=r;const a={analyticsLoggingServerDomain:y1,secure:!0,logger:{debug:(o,...u)=>{console.debug(o,...u)},warn:(o,...u)=>{console.warn(o,...u)},error:o=>{console.error(o)}}};this._options=Object.assign({},a,i??{}),this._logger=this._options.logger,this._logger.debug(`Created instance with the options: ${this._options}`),this._sdkLogTimer=setInterval(()=>{if(this._pendingSdkLogs.length>0){const o=this._pendingSdkLogs.splice(0,this._pendingSdkLogs.length);this.sendSdkLogReport(o).catch(u=>{this._logger.warn("sendSdkLogReport (interval) failed",u)})}},5*1e3)}get connectionState(){var t,n;return(n=(t=this._socket)==null?void 0:t.connectionState)!=null?n:"closed"}connect(){return H(this,null,function*(){const t=this._options.secure?"wss":"ws",n=this._options.analyticsLoggingServerDomain||y1;this._socket=new B6({sessionEndpoint:`${t}://${n}/${V6}/client/ws`,contextId:this._contextId,token:this._token,logger:this._logger,sdkVersion:this._sdkVersion}),this._socket.onEventReceived.addListener(i=>{try{this._eventReceivedHandler(i)}catch(a){this._logger.error("in _eventReceivedHandler",a)}}),this._socket.onConnectionFailed.addListener(i=>{i.code===4e3&&this.onAnalyticsNotEnabledError.emit(i),this.onConnectionFailed.emit(),this.dispose()}),this._socket.onConnectionStateChanged.addListener(i=>{var a;i==="closed"&&!this.isClosed()&&((a=this._socket)!=null&&a.isClosed())&&(this._isClosed=!0,this.dispose()),this.onConnectionStateChanged.emit(i)}),this._socket.onTokenExpired.addListener(()=>{this._reconnectWithNewSkyWayAuthToken()});const r=yield this._socket.onOpened.asPromise();if(r!==void 0){this._statsRequest=r.statsRequest;return}else{this._logger.error("First time connection payload is undefined",new Error),this.onConnectionFailed.emit();return}})}bufferOrSendSdkLog(t){const n=t.level==="warn"||t.level==="error";if(this._pendingSdkLogs.push(t),n||this._pendingSdkLogs.length>=Sb.MAX_PENDING_SDK_LOGS){const r=[...this._pendingSdkLogs];this._pendingSdkLogs.length=0,this.sendSdkLogReport(r).catch(i=>{this._logger.warn("sendSdkLogReport failed",i)})}}dispose(){clearInterval(this._sdkLogTimer),this._disconnect(),this._cleanupAnalyticsClientMaps()}setNewSkyWayAuthToken(t){this._socket!==void 0&&(this._newToken=t,this._logger.debug("setNewSkyWayAuthToken is success"))}cleanupOnUnpublished(t){this._mediaDeviceVersion.delete(t),this._encodingsVersion.delete(t)}cleanupOnUnsubscribed(t){this._preferredEncodingVersion.delete(t),this._previousSubscriptionStats.delete(t)}_disconnect(){var t;(t=this._socket)==null||t.destroy(),this._socket=void 0,this._responseCallbacks.clear(),this._acknowledgeCallbacks.clear()}sendMediaDeviceReport(t){return H(this,null,function*(){let n=this._mediaDeviceVersion.get(t.publicationId);n===void 0?n=0:n++,this._mediaDeviceVersion.set(t.publicationId,n);const r={publicationId:t.publicationId,mediaDeviceName:t.mediaDeviceName,mediaDeviceVersion:n,mediaDeviceTrigger:t.mediaDeviceTrigger,updatedAt:t.updatedAt},i=new Ds("MediaDeviceReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendMediaDeviceReport is failed",a)})})}sendSdkLogReport(t){return H(this,null,function*(){if(t.length===0)return;const n=t.map(i=>({timestamp:i.timestamp,level:i.level,message:Array.isArray(i.message)?i.message.map(a=>typeof a=="string"?a:JSON.stringify(a)).join(","):String(i.message)})),r=new Ds("SdkLog",{sdkLogs:n,contextId:this._contextId});yield this._sendClientEvent(r).catch(i=>{this._logger.warn("_sendClientEvent in sendSdkLogReport is failed",i)})})}sendBindingRtcPeerConnectionToSubscription(t){return H(this,null,function*(){const n=new Ds("BindingRtcPeerConnectionToSubscription",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendBindingRtcPeerConnectionToSubscription is failed",r)})})}filterStatsReport(t){const n=Array.from(t.values()).find(o=>o.type==="transport"&&o.dtlsState==="connected"),r=[];if(n){const o=Array.from(t.values()).find(u=>u.type==="candidate-pair"&&u.nominated&&u.id===(n==null?void 0:n.selectedCandidatePairId));o&&r.push(o.id,o.localCandidateId,o.remoteCandidateId,o.transportId)}else{const o=Array.from(t.values()).find(u=>u.type==="candidate-pair"&&u.nominated&&u.selected);o&&r.push(o.id,o.localCandidateId,o.remoteCandidateId,o.transportId)}const i=new Map,a=["candidate-pair","local-candidate","remote-candidate","transport"];for(const[o,u]of t.entries())a.includes(u.type)?r.includes(u.id)&&i.set(o,u):i.set(o,u);return i}bundleStatsReportByStatsType(t){const n={};for(const r of t.values())n[r.type]=r;return n}sendSubscriptionStatsReport(t,n){return H(this,null,function*(){var r;const i=this._previousSubscriptionStats.get(n.subscriptionId);if(this._previousSubscriptionStats.set(n.subscriptionId,{stats:t,createdAt:n.createdAt}),i===void 0)return;const a=this.filterStatsReport(i.stats),o=this.bundleStatsReportByStatsType(a),u=i.createdAt,p=(n.createdAt-u)/1e3;if(p<=0)throw new Error("duration must be greater than 0. also sendSubscriptionStatsReport was duplicated.");const h=this.filterStatsReport(t),g=this.bundleStatsReportByStatsType(h),f={};for(const{type:C,properties:R}of this._statsRequest.types)for(const[S,{normalization:b,outputKey:x,contentType:E}]of Object.entries(R)){if(!E.includes(n.contentType))continue;const M=g[C];if(!(M===void 0||M[S]===void 0))if(b){const Z=(r=o[C])==null?void 0:r[S];if(Z===void 0){this._logger.warn(`${C} in previous statsReport is undefined`);continue}const $=(Number(M[S])-Number(Z))/p;f[C]=Se(ie({},f[C]),{[x]:String($)})}else f[C]=Se(ie({},f[C]),{[x]:String(M[S])})}const _={subscriptionId:n.subscriptionId,stats:f,role:n.role,createdAt:n.createdAt},w=new Ds("SubscriptionStatsReport",_);yield this._sendClientEvent(w).catch(C=>{this._logger.warn("_sendClientEvent in sendSubscriptionStatsReport is failed",C)})})}sendRtcPeerConnectionEventReport(t){return H(this,null,function*(){const n=new Ds("RtcPeerConnectionEventReport",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendRtcPeerConnectionEventReport is failed",r)})})}sendPublicationUpdateEncodingsReport(t){return H(this,null,function*(){let n=this._encodingsVersion.get(t.publicationId);n===void 0?n=0:n++,this._encodingsVersion.set(t.publicationId,n);const r={publicationId:t.publicationId,encodings:t.encodings,encodingsVersion:n,updatedAt:t.updatedAt},i=new Ds("PublicationUpdateEncodingsReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendPublicationUpdateEncodingsReport is failed",a)})})}sendSubscriptionUpdatePreferredEncodingReport(t){return H(this,null,function*(){let n=this._preferredEncodingVersion.get(t.subscriptionId);n===void 0?n=0:n++,this._preferredEncodingVersion.set(t.subscriptionId,n);const r={subscriptionId:t.subscriptionId,preferredEncodingIndex:t.preferredEncodingIndex,preferredEncodingVersion:n,updatedAt:t.updatedAt},i=new Ds("SubscriptionUpdatePreferredEncodingReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendSubscriptionUpdatePreferredEncodingReport is failed",a)})})}sendJoinReport(t){return H(this,null,function*(){const n=new Ds("JoinReport",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendJoinReport is failed",r)})})}_sendClientEvent(t){return H(this,null,function*(){return new Promise((n,r)=>H(this,null,function*(){if(this._socket===void 0||this._socket.connectionState==="closed"){r(new Error("websocket is not connected"));return}if(this._socket.connectionState==="connecting"){this._socket.pushResendClientEventsQueue(t),this._setAcknowledgeCallback(t.id,a=>H(this,null,function*(){a.ok?(this._acknowledgeCallbacks.delete(t.id),n()):(this._acknowledgeCallbacks.delete(t.id),r(a))})),this._logger.debug(`pushResendClientEventsQueue and setAcknowledgeCallback. clientEvent.id: ${t.id}`),r(new Error("websocket is connecting now"));return}const i=new H6({times:6,interval:500,jitter:100});for(;!i.exceeded;){const a=setTimeout(()=>H(this,null,function*(){if(this._socket===void 0){this._acknowledgeCallbacks.delete(t.id),r(new Error("Socket closed when trying to resend"));return}else this._socket.resendAfterReconnect(t);r(new Error("Timeout to send data"))}),q6*1e3);this._logger.debug(`send clientEvent, ${JSON.stringify(t)}`),this._socket.send(t).catch(u=>{this._acknowledgeCallbacks.delete(t.id),clearTimeout(a),r(u)});const o=yield this._waitForAcknowledge(t.id).catch(u=>u);if(clearTimeout(a),v1(o))if(o.reason==="unexpected")yield i.wait();else{r(o);return}else{n();return}}r(new Error("unexpected has occurred at server"))}))})}_waitForAcknowledge(t){return H(this,null,function*(){return new Promise((n,r)=>{this._setAcknowledgeCallback(t,i=>H(this,null,function*(){i.ok?(this._acknowledgeCallbacks.delete(t),n()):(this._acknowledgeCallbacks.delete(t),r(i))}))})})}_reconnectWithNewSkyWayAuthToken(){return H(this,null,function*(){this._disconnect(),this._newToken!==void 0?(this._token=this._newToken,this._newToken=void 0,yield this.connect()):this._logger.warn("new token is not set. so not reconnect.")})}_eventReceivedHandler(t){switch(t.type){case"Acknowledge":this._acknowledgeHandler(t.payload);break;case"Open":break;default:t.type,this._logger.warn(`Unknown event: ${t.type}`)}}_acknowledgeHandler(t){if(!v1(t))throw new Error("Invalid payload");const{eventId:n}=t;if(!this._acknowledgeCallbacks.has(n))throw new Error(`acknowledge event has unknown eventId: ${n}`);const r=this._acknowledgeCallbacks.get(n);r&&(this._acknowledgeCallbacks.delete(n),r(t))}_setAcknowledgeCallback(t,n){this._acknowledgeCallbacks.set(t,n)}_cleanupAnalyticsClientMaps(){this._mediaDeviceVersion.clear(),this._encodingsVersion.clear(),this._preferredEncodingVersion.clear(),this._previousSubscriptionStats.clear()}getIntervalSec(){return this._statsRequest.intervalSec}isConnectionEstablished(){return!(!this._socket||this._socket.connectionState==="connecting"||this._socket.connectionState==="closed")}isClosed(){return this._isClosed}};bb.MAX_PENDING_SDK_LOGS=50;var z6=bb;Y();var wb="packages/core/src/external/analytics.ts",Jr=new Ze(wb);function K6(e){return H(this,null,function*(){const{analyticsService:t}=e.config,n=new z6({token:e.authTokenString,sdkVersion:Jf.version,contextId:Jf.id},{logger:{error:(i,a)=>H(null,null,function*(){Jr.error(`AnalyticsClient error: ${i}`,Oe({operationName:"AnalyticsClient.logger",context:e,info:Se(ie({},qe.internal),{detail:"AnalyticsClient error"}),error:a,path:Jr.prefix}))}),debug:(i,...a)=>{Jr.debug("[analytics]:",i,...a)},warn:(i,...a)=>{Jr.warn("[analytics]:",i,...a)}},analyticsLoggingServerDomain:t.domain,secure:t.secure}),r=new $6(n,e);return Ze._onLogForAnalytics=i=>{i.prefix!==wb&&n.bufferOrSendSdkLog(i)},r.connectWithTimeout().catch(i=>{r.close(),Jr.error(`AnalyticsClient error: ${i.message}`,Oe({operationName:"AnalyticsClient.logger",context:e,info:Se(ie({},qe.internal),{detail:"AnalyticsClient error"}),error:i,path:Jr.prefix})),r.onConnectionFailed.emit({})}),r})}var $6=class{constructor(e,t){this.client=e,this.context=t,this.onConnectionFailed=new Ye,this.onConnectionStateChanged=new Ye,this.onMessage=new Ye,this._isClosed=!1,this._listen(),t._onTokenUpdated.add(n=>{this.client.setNewSkyWayAuthToken(n)})}_listen(){this.client.onConnectionFailed.addOneTimeListener(()=>{this.onConnectionFailed.emit({})}),this.client.onConnectionStateChanged.addListener(e=>{e==="closed"&&!this.isClosed()&&this.client.isClosed()&&this.close(),this.onConnectionStateChanged.emit(e)})}get connectionState(){return this.client.connectionState}_connect(){return H(this,null,function*(){Jr.debug("[start] connect analyticsService"),yield this.client.connect().then(()=>{Jr.debug("[end] connect analyticsService")}).catch(e=>{this.close(),Jr.debug("[end] failed connect analyticsService: also unreachable to server"),Jr.error(`AnalyticsClient error: ${e.message}`,Oe({operationName:"AnalyticsClient.logger",info:Se(ie({},qe.internal),{detail:"AnalyticsClient error"}),error:e,path:Jr.prefix})),this.onConnectionFailed.emit({})})})}connectWithTimeout(){return H(this,null,function*(){let e;const t=new Promise((r,i)=>{e=setTimeout(()=>{Jr.debug("[end] failed connect analyticsService: no initial response from the server"),i(new Error("failed connect analyticsService"))},3e4)}),n=new Promise((r,i)=>{this.client.onAnalyticsNotEnabledError.addOneTimeListener(a=>{Jr.warn(`[end] failed connect analyticsService: ${a.reason}`),r()})});return Promise.race([this._connect(),t,n]).finally(()=>{clearTimeout(e)})})}close(){this._isClosed=!0,this.onConnectionFailed.removeAllListeners(),this.onConnectionStateChanged.removeAllListeners(),this.onMessage.removeAllListeners()}isClosed(){return this._isClosed}};Y();Y();var og=class{constructor(){this._onContextAttached=new Ye}_attachContext(e){this._context=e,this._onContextAttached.emit(e)}};Y();var W6=new Ze("packages/core/src/plugin/internal/person/connection/messageBuffer.ts"),G6=class{constructor(e){this.signaling=e,this._indicateMessageBuffer={},this._excludeConnectionIndicateBuffering=new Set,this._disposer=new ni,this.signaling.onMessage.add(t=>{const n=t.src.id+t.src.name;this._excludeConnectionIndicateBuffering.has(n)||(this._indicateMessageBuffer[n]||(this._indicateMessageBuffer[n]=[]),this._indicateMessageBuffer[n].push(t))}).disposer(this._disposer)}resolveMessagingBuffer({id:e,name:t}){const n=e+t,r=this._indicateMessageBuffer[n];(r==null?void 0:r.length)>0&&(W6.debug("resolveMessagingBuffer",{length:r.length}),r.forEach(i=>{this.signaling.onMessage.emit(i)}),delete this._indicateMessageBuffer[n]),this._excludeConnectionIndicateBuffering.add(n)}close(){this._disposer.dispose(),this._indicateMessageBuffer={},this._excludeConnectionIndicateBuffering=new Set}};Y();Y();Y();var yc=$r(Oi());Y();Y();Y();Y();var xb=class{constructor(e,t){this.id=e,this.contentType=t,this.side="remote",this.onConnectionStateChanged=new Ye,this._onConnectionStateChanged=new Ye,this._connectionState="new",this._getTransport=()=>{},this.getStats=()=>this._getStats(),this._getStats=()=>H(null,null,function*(){return[]}),this._onConnectionStateChanged.pipe(this.onConnectionStateChanged)}_setConnectionState(e){this._connectionState!==e&&(this._connectionState=e,this._onConnectionStateChanged.emit(e))}getRTCPeerConnection(){return this._getRTCPeerConnection()}_getRTCPeerConnection(){var e;return(e=this._getTransport())==null?void 0:e.rtcPeerConnection}getConnectionState(){return this._getConnectionState()}_getConnectionState(){return this._connectionState}toJSON(){return{contentType:this.contentType,id:this.id,codec:this.codec,side:this.side}}},Cb=class extends xb{constructor(e,t,n){super(e,t),this.id=e,this.contentType=t,this.track=n}get isEnabled(){return this.track.enabled}setIsEnabled(e){this.track.enabled=e}attach(e){this._element=e,z_(e,this.track)}detach(){this._element&&(K_(this._element,this.track),this._element=void 0)}},J6=class extends Cb{constructor(e,t){super(e,"audio",t),this.track=t,this.contentType="audio"}};Y();var Z6=class extends xb{constructor(e,t){super(e,"data"),this._datachannel=t,this._isEnabled=!0,this.contentType="data",this.onData=new Ye,t.onmessage=({data:n})=>{this.isEnabled&&(typeof n=="string"&&n.includes($f)&&(n=JSON.parse(n.slice($f.length))),this.onData.emit(n))}}get isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}};Y();var X6=class extends Cb{constructor(e,t){super(e,"video",t),this.track=t,this.contentType="video"}},Q6=new Ze("packages/core/src/media/stream/remote/factory.ts"),Gf=(e,t,n)=>{if(t instanceof RTCDataChannel){const r=new Z6(e,t);return r.codec=n,r}else if(t.kind==="audio"){const r=new J6(e,t);return r.codec=n,r}else if(t.kind==="video"){const r=new X6(e,t);return r.codec=n,r}throw Oe({operationName:"createRemoteStream",path:Q6.prefix,info:Se(ie({},qe.invalidArgumentValue),{detail:"invalid stream type"})})};Y();var Y6=new Ze("packages/core/src/plugin/internal/person/util.ts"),jc=(e,t)=>H(null,null,function*(){const n=Y6.createBlock({label:"setEncodingParams"}),r=e.getParameters();n.debug("getParameters",{params:r,newEncodings:t}),r.encodings==null&&(r.encodings=[]),r.encodings=t.map((i,a)=>ie(ie({},r.encodings[a]||{}),i)),yield e.setParameters(r)}),Eb=()=>Qv()==="Safari12"||Qv()==="Safari11";function eP(e){switch(e){case"closed":case"disconnected":case"failed":return"disconnected";case"connected":return"connected";case"connecting":return"connecting";case"new":return"new";case"reconnecting":return"reconnecting"}}var tP=e=>{const t=[];return e.forEach(n=>{t.push(JSON.parse(JSON.stringify(n)))}),t};Y();var Pb=class kb{constructor(t,n){this.publicationId=t,this.streamId=n}static fromLabel(t){const{p:n,s:r}=JSON.parse(t);return new kb(n,r)}toLabel(){return JSON.stringify({p:this.publicationId,s:this.streamId})}};Y();var Si=new Ze("packages/core/src/plugin/internal/person/connection/peer.ts"),Tb=class{constructor(e,t,n,r,i,a,o){this._context=e,this._iceManager=t,this.signaling=n,this.analytics=r,this.localPerson=i,this.endpoint=a,this.role=o,this._pendingCandidates=[],this.pc=new RTCPeerConnection(Se(ie({},this._context.config.rtcConfig),{iceTransportPolicy:this._context.config.rtcConfig.turnPolicy==="turnOnly"?"relay":void 0,iceServers:this._iceManager.iceServers})),this.onSignalingStateChanged=new Ye,this.onPeerConnectionStateChanged=new Ye,this.onDisconnect=new Ye,this.connected=!1,this.disconnected=!1,this.rtcPeerConnectionId=Ko(),this._onICECandidate=h=>H(this,null,function*(){if(h.candidate==null||h.candidate===""||this.pc.connectionState==="closed")return;const g={kind:"iceCandidateMessage",payload:{candidate:h.candidate,role:this.role}};Si.debug("[start] send candidate",{message:g,localPerson:this.localPerson}),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceCandidate",data:{candidate:JSON.stringify(h.candidate)},createdAt:Date.now()});try{yield this.signaling.send(this.endpoint,g),Si.debug("[end] send candidate",{message:g,localPerson:this.localPerson})}catch(f){Si.warn("[failed] send candidate",On({operationName:"Peer._onICECandidate",channel:this.localPerson.channel,detail:"[failed] send candidate",payload:{message:g}}),f)}}),this._onICECandidateError=h=>H(this,null,function*(){this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceCandidateError",data:{event:JSON.stringify(h)},createdAt:Date.now()})}),this._onIceGatheringStateChange=h=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const g=this.pc.iceGatheringState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceGatheringStateChange",data:{event:g},createdAt:Date.now()})}}),this._onConnectionStateChange=()=>H(this,null,function*(){const h=this.pc.connectionState;switch(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"connectionStateChange",data:{connectionState:h},createdAt:Date.now()}),h){case"connected":this.connected=!0,this._pendingCandidates=[];break}this.onPeerConnectionStateChanged.emit(this.pc.connectionState)}),this._onIceConnectionStateChange=()=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const h=this.pc.iceConnectionState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceConnectionStateChange",data:{iceConnectionState:h},createdAt:Date.now()})}}),this._onSignalingStateChange=()=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const h=this.pc.signalingState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"signalingStateChange",data:{signalingState:h},createdAt:Date.now()})}}),this.waitForSignalingState=(h,g=1e4)=>H(this,null,function*(){this.pc.signalingState!==h&&(yield this.onSignalingStateChanged.watch(()=>this.pc.signalingState===h,g).catch(f=>{throw Oe({operationName:"Peer.waitForSignalingState",info:Se(ie({},qe.timeout),{detail:"waitForSignalingState timeout"}),path:Si.prefix,context:this._context,channel:this.localPerson.channel,error:f})}))}),this.waitForConnectionState=(h,g=1e4)=>H(this,null,function*(){h!==this.pc.connectionState&&(yield this.onPeerConnectionStateChanged.watch(()=>h===this.pc.connectionState,g).catch(f=>{throw Oe({operationName:"Peer.waitForConnectionState",info:Se(ie({},qe.timeout),{detail:"waitForConnectionState timeout"}),path:Si.prefix,context:this._context,channel:this.localPerson.channel,error:f})}))}),this.waitForStats=h=>H(this,[h],function*({track:g,cb:f,interval:_,timeout:w,logging:C}){_??(_=100),w??(w=1e4);for(let R=0;;R+=_){if(R>=w)throw Oe({operationName:"Peer.waitForStats",info:Se(ie({},qe.timeout),{detail:"waitForStats timeout"}),path:Si.prefix,context:this._context,channel:this.localPerson.channel});const S=yield this.pc.getStats(g),b=tP(S);if(C&&Si.debug("Peer.waitForStats",b),f(b))break;yield new Promise(x=>setTimeout(x,_))}});var u;Si.debug("peerConfig",this.pc.getConfiguration()),this.setPeerConnectionListener();const p=(u=this.pc)==null?void 0:u.peerIdentity;p&&p.catch(h=>{Si.debug("firefox peerIdentity",h)})}setPeerConnectionListener(){this.pc.onicecandidate=this._onICECandidate,this.pc.onicecandidateerror=this._onICECandidateError,this.pc.onicegatheringstatechange=this._onIceGatheringStateChange,this.pc.onconnectionstatechange=this._onConnectionStateChange,this.pc.oniceconnectionstatechange=this._onIceConnectionStateChange,this.pc.onsignalingstatechange=()=>{this._onSignalingStateChange(),this.onSignalingStateChanged.emit(this.pc.signalingState)}}unSetPeerConnectionListener(){this.pc.onicecandidate=null,this.pc.onicecandidateerror=null,this.pc.onicegatheringstatechange=null,this.pc.onconnectionstatechange=null,this.pc.oniceconnectionstatechange=null,this.pc.onsignalingstatechange=null}handleCandidate(e){return H(this,null,function*(){this._pendingCandidates.push(e),this.pc.remoteDescription&&(yield this.resolveCandidates())})}resolveCandidates(){return H(this,null,function*(){const e=[...this._pendingCandidates];this._pendingCandidates=[],Si.debug("addIceCandidates",e),yield Promise.all(e.map(t=>{this.pc.signalingState!=="closed"&&this.pc.addIceCandidate(t).catch(n=>{Si.warn("[failed] add ice candidate",On({operationName:"Peer.resolveCandidates",channel:this.localPerson.channel,detail:"[failed] send candidate",payload:{endpointId:this.endpoint.id}}),n)})}))})}},Ns=new Ze("packages/core/src/plugin/internal/person/connection/receiver.ts"),nP=class extends Tb{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a,"receiver"),this.id=ji(),this.onConnectionStateChanged=new Ye,this.onStreamAdded=new Ye,this.onError=new Ye,this._connectionState="new",this._publicationInfo={},this.streams={},this._subscriptions={},this._promiseQueue=new ua,this._disposer=new ni,this._log=Ns.createBlock({localPersonId:this.localPerson.id,id:this.id}),this._log.debug("spawned"),this.signaling.onMessage.add(o=>H(this,[o],function*({src:u,data:p}){if(!(u.id===a.id&&u.name===a.name))return;const h=p;switch(h.kind){case"senderProduceMessage":this._promiseQueue.push(()=>this._handleSenderProduce(h.payload)).catch(g=>this._log.error("handle senderProduceMessage failed",g,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"senderUnproduceMessage":this._promiseQueue.push(()=>this._handleSenderUnproduce(h.payload)).catch(g=>this._log.error("handle handleSenderUnproduce",g,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"senderRestartIceMessage":this._promiseQueue.push(()=>this._handleSenderRestartIce(h.payload)).catch(g=>this._log.error("_handleSenderRestartIce",g,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"iceCandidateMessage":{const{role:g,candidate:f}=h.payload;g==="sender"&&(yield this.handleCandidate(f))}break}})).disposer(this._disposer),this.pc.ontrack=o=>H(this,[o],function*({track:u,transceiver:p}){if(!p.mid)throw Oe({operationName:"Receiver.pc.ontrack",info:Se(ie({},qe.missingProperty),{detail:"mid missing"}),path:Ns.prefix,context:this._context,channel:this.localPerson.channel});const h=Object.values(this._publicationInfo).find(w=>{var C;return w.mid===((C=p.mid)==null?void 0:C.toString())});if(!h){const w=Oe({operationName:"Receiver.pc.ontrack",info:Se(ie({},qe.notFound),{detail:"publicationInfo not found"}),path:Ns.prefix,context:this._context,channel:i.channel,payload:{endpointId:this.endpoint.id,publicationInfo:this._publicationInfo,mid:p.mid}});this.onError.emit(w),this._log.error(w);return}const g=yc.parse(this.pc.remoteDescription.sdp),f=this._getCodecFromSdp(g,p,u.kind),_=Gf(h.streamId,u,f);_.codec=f,this._setupTransportAccessForStream(_),this.streams[h.publicationId]=_,this._log.debug("MediaStreamTrack added",h,u,f),this.onStreamAdded.emit({publicationId:h.publicationId,stream:_})}),this.pc.ondatachannel=o=>H(this,[o],function*({channel:u}){const{publicationId:p,streamId:h}=Pb.fromLabel(u.label),g={mimeType:"datachannel"},f=Gf(h,u,g);this._setupTransportAccessForStream(f),this.streams[p]=f,this._log.debug("DataChannel added",p,u,g),this.onStreamAdded.emit({publicationId:p,stream:f})}),this.onPeerConnectionStateChanged.add(o=>{switch(o){case"connecting":case"connected":this._setConnectionState(o);break;case"failed":case"closed":this._setConnectionState("disconnected");break}}).disposer(this._disposer)}_setConnectionState(e){this._connectionState!==e&&(this._log.debug("onConnectionStateChanged",this.id,this._connectionState,e),this._connectionState=e,this.onConnectionStateChanged.emit(e))}_setupTransportAccessForStream(e){e._getTransport=()=>({rtcPeerConnection:this.pc,connectionState:eP(this.pc.connectionState)}),e._getStats=()=>H(this,null,function*(){if(e.contentType==="data"){const r=yield this.pc.getStats();return No(r)}const t=yield this.pc.getStats(e.track);return No(t)}),this._disposer.push(()=>{e._getTransport=()=>{}}),this.onConnectionStateChanged.add(t=>{e._setConnectionState(t),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"skywayConnectionStateChange",data:{skywayConnectionState:t},createdAt:Date.now()})}).disposer(this._disposer)}_getCodecFromSdp(e,t,n){var r;const i=e.media.find(f=>{var _,w;return((_=f.mid)==null?void 0:_.toString())===((w=t.mid)==null?void 0:w.toString())});if(!i)throw Oe({operationName:"Receiver._getCodecFromSdp",info:Se(ie({},qe.notFound),{detail:"m-line not exist"}),path:Ns.prefix,context:this._context,channel:this.localPerson.channel});const a=(r=i.payloads)==null?void 0:r.toString().split(" ")[0],o=i.rtp.find(f=>f.payload.toString()===a),u=`${n}/${o.codec}`.toLowerCase();let p={};const h=i.fmtp.find(f=>f.payload.toString()===a);return h!=null&&h.config&&(p=U_(h.config)),{mimeType:u,parameters:p}}get hasMedia(){const e=Object.values(this.streams).length;return this._log.debug("hasMedia",{count:e}),e>0}close(){this._log.debug("closed"),this.unSetPeerConnectionListener(),this.pc.close(),this._setConnectionState("disconnected"),this._disposer.dispose()}add(e){this._subscriptions[e.id]=e}remove(e){const t=this._subscriptions[e];if(!t)return;delete this._subscriptions[t.id];const n=t.publication.id;this.streams[n]&&delete this.streams[n]}_validateRemoteOffer(e){const t=yc.parse(e);this._log.debug("_validateRemoteOffer",{sdpObject:t});for(const n of t.media){if(n.direction==="inactive")continue;if(!Object.values(this._publicationInfo).find(i=>{var a;return((a=n.mid)==null?void 0:a.toString())===i.mid})){const i=Oe({operationName:"Receiver._validateRemoteOffer",info:Se(ie({},qe.notFound),{detail:"mismatch between sdp and state"}),path:Ns.prefix,context:this._context,channel:this.localPerson.channel,payload:{sdpMedia:t.media,sdpMediaLine:n,info:this._publicationInfo}});throw this.onError.emit(i),i}}}get isWrongSignalingState(){return this.pc.signalingState==="have-local-offer"&&this.pc.remoteDescription||this.pc.signalingState==="have-remote-offer"}_handleSenderProduce(e){return H(this,arguments,function*({sdp:t,publicationId:n,info:r}){if(this.pc.signalingState!=="closed"){if(this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("_handleSenderProduce wait for be stable",On({operationName:"Receiver._handleSenderProduce",channel:this.localPerson.channel,detail:"_handleSenderProduce wait for be stable",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderProduce({sdp:t,publicationId:n,info:r});return}throw Oe({operationName:"Receiver._handleSenderProduce",context:this._context,channel:this.localPerson.channel,info:Se(ie({},qe.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Ns.prefix})}this._log.debug("_handleSenderProduce",{info:r,publicationId:n,publicationInfo:Object.values(this._publicationInfo)}),this._publicationInfo[r.publicationId]=r,this._validateRemoteOffer(t.sdp),yield this.sendAnswer(t),yield this.resolveCandidates()}})}_handleSenderUnproduce(e){return H(this,arguments,function*({sdp:t,publicationId:n}){if(this.pc.signalingState==="closed"){this._log.warn("signalingState closed",On({channel:this.localPerson.channel,detail:"signalingState closed",operationName:"Receiver._handleSenderUnproduce"}));return}if(this._log.debug("<handleSenderUnproduce> start",{sdp:t,publicationId:n}),this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("signalingState is not stable",On({channel:this.localPerson.channel,detail:"signalingState is not stable",operationName:"Receiver._handleSenderUnproduce",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderUnproduce({sdp:t,publicationId:n});return}throw Oe({operationName:"Receiver._handleSenderProduce",context:this._context,channel:this.localPerson.channel,info:Se(ie({},qe.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Ns.prefix})}delete this._publicationInfo[n],yield this.sendAnswer(t),yield this.resolveCandidates(),this._log.debug("<handleSenderUnproduce> end",{publicationId:n})})}_handleSenderRestartIce(e){return H(this,arguments,function*({sdp:t}){if(this.pc.signalingState!=="closed"){if(this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("signalingState is not stable",On({channel:this.localPerson.channel,detail:"signalingState is not stable",operationName:"Receiver._handleSenderRestartIce",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderRestartIce({sdp:t});return}throw Oe({operationName:"Receiver._handleSenderRestartIce",context:this._context,channel:this.localPerson.channel,info:Se(ie({},qe.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Ns.prefix})}this._setConnectionState("reconnecting"),yield this.sendAnswer(t),yield this.resolveCandidates(),this.pc.connectionState==="connected"&&this._setConnectionState("connected")}})}sendAnswer(e){return H(this,null,function*(){this._log.debug("[receiver] start: sendAnswer"),yield this.pc.setRemoteDescription(e);const t=yield this.pc.createAnswer();this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"answer",data:{answer:JSON.stringify(t)},createdAt:Date.now()});const n=yc.parse(this.pc.remoteDescription.sdp),r=yc.parse(t.sdp);n.media.forEach((o,u)=>{const p=r.media[u];p.fmtp=zC(p.fmtp).map(h=>{const g=o.fmtp.find(f=>f.payload===h.payload);return g||h})});const i=yc.write(r);yield this.pc.setLocalDescription({type:"answer",sdp:i});const a={kind:"receiverAnswerMessage",payload:{sdp:this.pc.localDescription}};yield this.signaling.send(this.endpoint,a).catch(o=>this._log.error("failed to send answer",o,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id})),this._log.debug("[receiver] end: sendAnswer")})}get subscriptions(){return this._subscriptions}};Y();var rP=$r(t_()),_1=$r(Oi()),xr=new Ze("packages/core/src/plugin/internal/person/connection/sender.ts"),iP=class extends Tb{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a,"sender"),this.id=ji(),this.onConnectionStateChanged=new Ye,this.publications={},this.transceivers={},this.datachannels={},this._pendingPublications=[],this._isNegotiating=!1,this.promiseQueue=new ua,this._disposer=new ni,this._ms=new MediaStream,this._backoffIceRestarted=new ki({times:8,interval:100,jitter:100}),this._connectionState="new",this._log=xr.createBlock({localPersonId:this.localPerson.id,id:this.id}),this._unsubscribeStreamEnableChange={},this._cleanupStreamCallbacks={},this.restartIce=()=>H(this,null,function*(){if(this._backoffIceRestarted.exceeded){this._log.error(Oe({operationName:"Sender.restartIce",context:this._context,channel:this.localPerson.channel,info:Se(ie({},qe.internal),{detail:"restartIce limit exceeded"}),path:xr.prefix})),this._setConnectionState("disconnected");return}this._log.warn("[start] restartIce",On({operationName:"Sender.restartIce",detail:"start restartIce",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}));const o=()=>{if(this.endpoint.state==="left")return this._log.warn("endpointMemberLeft",On({operationName:"restartIce",detail:"endpointMemberLeft",channel:this.localPerson.channel,payload:{endpointId:this.endpoint.id}})),this._setConnectionState("disconnected"),!0;if(this.pc.connectionState==="connected")return this._log.warn("[end] restartIce",On({operationName:"restartIce",detail:"reconnected",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}})),this._backoffIceRestarted.reset(),this._setConnectionState("connected"),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"restartIce",data:void 0,createdAt:Date.now()}),!0};if(this._setConnectionState("reconnecting"),yield this._backoffIceRestarted.wait(),o())return;let u=yield this._iceManager.updateIceParams().catch(g=>g);if(u){this._log.warn("[failed] restartIce",On({operationName:"restartIce",detail:"update IceParams failed",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}),u),yield this.restartIce();return}if(this.pc.setConfiguration&&(this.pc.setConfiguration(Se(ie({},this.pc.getConfiguration()),{iceServers:this._iceManager.iceServers})),this._log.debug("<restartIce> setConfiguration",{iceServers:this._iceManager.iceServers})),o())return;if(this.signaling.connectionState!=="connected"){if(this._log.warn("<restartIce> reconnect signaling service",On({operationName:"restartIce",detail:"reconnect signaling service",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}})),u=yield this.signaling.onConnectionStateChanged.watch(g=>g==="connected",1e4).catch(g=>g).then(()=>{}),u instanceof Er){yield this.restartIce();return}if(o())return}const p=yield this.pc.createOffer({iceRestart:!0});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(p)},createdAt:Date.now()}),yield this.pc.setLocalDescription(p);const h={kind:"senderRestartIceMessage",payload:{sdp:this.pc.localDescription}};if(u=yield this.signaling.send(this.endpoint,h,1e4).catch(g=>g),u){this._log.warn("<restartIce> [failed]",On({operationName:"restartIce",detail:"timeout send signaling message",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}),u),yield this.restartIce();return}u=yield this.waitForConnectionState("connected",this._context.config.rtcConfig.iceDisconnectBufferTimeout).catch(g=>g),!(!u&&o())&&(yield this.restartIce())}),this._log.debug("spawned"),this.signaling.onMessage.add(o=>H(this,[o],function*({src:u,data:p}){if(!(u.id===a.id&&u.name===a.name))return;const h=p;switch(h.kind){case"receiverAnswerMessage":this.promiseQueue.push(()=>this._handleReceiverAnswer(h.payload)).catch(g=>this._log.error("handle receiverAnswerMessage",{localPersonId:this.localPerson.id,endpointId:this.endpoint.id,err:g}));break;case"iceCandidateMessage":{const{role:g,candidate:f}=h.payload;g==="receiver"&&(yield this.handleCandidate(f))}break}})).disposer(this._disposer),this.onPeerConnectionStateChanged.add(o=>H(this,null,function*(){try{switch(xr.debug("onPeerConnectionStateChanged",{state:o}),o){case"disconnected":case"failed":(yield this.waitForConnectionState("connected",e.config.rtcConfig.iceDisconnectBufferTimeout).catch(p=>p))&&this._connectionState!=="reconnecting"&&(yield this.restartIce());break;case"connecting":case"connected":this._setConnectionState(o);break;case"closed":this._setConnectionState("disconnected");break}}catch(u){xr.error("onPeerConnectionStateChanged",u,this.id)}})).disposer(this._disposer)}_setConnectionState(e){this._connectionState!==e&&(this._log.debug("onConnectionStateChanged",this.id,this._connectionState,e),this._connectionState=e,this.onConnectionStateChanged.emit(e))}get hasMedia(){const e=Object.keys(this.publications).length;return this._log.debug("hasMedia",{count:e}),e>0}_getMid(e,t){if(e.contentType==="data"){const n=t.media.find(r=>r.type==="application");if((n==null?void 0:n.mid)==null)throw Oe({operationName:"Sender._getMid",info:Se(ie({},qe.missingProperty),{detail:"datachannel mid undefined"}),path:xr.prefix,context:this._context,channel:this.localPerson.channel});return n.mid.toString()}else{const r=this.transceivers[e.id].mid;if(r==null)throw Oe({operationName:"Sender._getMid",info:Se(ie({},qe.missingProperty),{detail:"media mid undefined"}),path:xr.prefix,context:this._context,channel:this.localPerson.channel});return r.toString()}}_listenStreamEnableChange(e,t){this._unsubscribeStreamEnableChange[t]&&this._unsubscribeStreamEnableChange[t]();const{removeListener:n}=e._onEnableChanged.add(r=>H(this,null,function*(){yield this._replaceTrack(t,r).catch(i=>{xr.warn(On({member:this.localPerson,detail:"_replaceTrack failed",operationName:"Sender._listenStreamEnableChange",payload:i}))})}));this._unsubscribeStreamEnableChange[t]=n}add(e){return H(this,null,function*(){var t,n;if(this._isNegotiating||this.pc.signalingState!=="stable"){this._pendingPublications.push(e),this._log.debug("<add> isNegotiating",{publication:e,isNegotiating:this._isNegotiating,signalingState:this.pc.signalingState,pendingPublications:this._pendingPublications.length});return}this._isNegotiating=!0,this._log.debug("<add> add publication",{publication:e}),this.publications[e.id]=e;const r=e.stream;if(!r)throw Oe({operationName:"Sender.add",info:Se(ie({},qe.missingProperty),{detail:"<add> stream not found"}),path:xr.prefix,context:this._context,channel:this.localPerson.channel});if(this._cleanupStreamCallbacks[r.id]=this._setupTransportAccessForStream(r),r.contentType==="data"){const p=this.pc.createDataChannel(new Pb(e.id,r.id).toLabel(),r.options);r._onWriteData.add(h=>{p.readyState==="open"&&p.send(h)}).disposer(this._disposer),this.datachannels[e.id]=p}else{e._onReplaceStream.add(h=>H(this,[h],function*({newStream:g,oldStream:f}){g._replacingTrack=!0,this._listenStreamEnableChange(g,e.id),this._cleanupStreamCallbacks[f.id]&&this._cleanupStreamCallbacks[f.id](),this._cleanupStreamCallbacks[g.id]=this._setupTransportAccessForStream(g),yield this._replaceTrack(e.id,g.track),g._replacingTrack=!1,g._onReplacingTrackDone.emit()})).disposer(this._disposer),this._listenStreamEnableChange(r,e.id);const p=this.pc.addTransceiver(r.track,{direction:"sendonly",streams:[this._ms]});e._onEncodingsChanged.add(h=>H(this,null,function*(){yield jc(p.sender,h).catch(g=>{this._log.error("_onEncodingsChanged failed",g)})})).disposer(this._disposer),this.transceivers[e.id]=p}const i=yield this.pc.createOffer().catch(p=>{throw Oe({operationName:"Sender.add",info:Se(ie({},qe.internal),{detail:"can't create offer"}),path:xr.prefix,context:this._context,channel:this.localPerson.channel,error:p})});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(i)},createdAt:Date.now()}),yield this.pc.setLocalDescription(i);const a=_1.parse(this.pc.localDescription.sdp);this._log.debug("<add> create offer base",a);const o=this._getMid(e,a);if(e.contentType!=="data"){sP((t=e.codecCapabilities)!=null?t:[],o,a);const p=_1.write(a);if(yield this.pc.setLocalDescription({type:"offer",sdp:p}),this._log.debug("<add> create offer",this.pc.localDescription),((n=e.encodings)==null?void 0:n.length)>0)if(Eb())this._safariSetupEncoding(e);else{const h=this.transceivers[e.id];yield jc(h.sender,[e.encodings[0]])}}const u={kind:"senderProduceMessage",payload:{sdp:this.pc.localDescription,publicationId:e.id,info:{publicationId:e.id,streamId:r.id,mid:o}}};this._log.debug("[start] send message",u),yield this.signaling.send(this.endpoint,u).catch(p=>{throw this._log.error("[failed] send message :",p,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}),p}),this._log.debug("[end] send message",u)})}_setupTransportAccessForStream(e){e._getTransportCallbacks[this.endpoint.id]=()=>({rtcPeerConnection:this.pc,connectionState:this._connectionState}),e._getStatsCallbacks[this.endpoint.id]=()=>H(this,null,function*(){if(e.contentType==="data"){const i=yield this.pc.getStats();return No(i)}e._replacingTrack&&(yield e._onReplacingTrackDone.asPromise(200));const n=yield this.pc.getStats(e.track);return No(n)});const t=()=>{delete e._getTransportCallbacks[this.endpoint.id],delete e._getStatsCallbacks[this.endpoint.id]};return this._disposer.push(()=>{t()}),this.onConnectionStateChanged.add(n=>{e._setConnectionState(this.endpoint,n),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"skywayConnectionStateChange",data:{skywayConnectionState:n},createdAt:Date.now()})}).disposer(this._disposer),t}remove(e){return H(this,null,function*(){const t=this.publications[e];if(!t){this._log.warn("<remove> publication not found",On({operationName:"Sender.remove",detail:"publication already removed",channel:this.localPerson.channel,payload:{publicationId:e}}));return}if(delete this.publications[e],this._isNegotiating||this.pc.signalingState!=="stable"){this._pendingPublications.push(e),this._log.debug("<remove> isNegotiating",{publicationId:e,_isNegotiating:this._isNegotiating,signalingState:this.pc.signalingState});return}this._isNegotiating=!0,this._log.debug("<remove> [start]",{publicationId:e});const n=t.stream;if(!n)throw Oe({operationName:"Sender.remove",info:Se(ie({},qe.missingProperty),{detail:"<remove> publication not have stream"}),path:xr.prefix,context:this._context,channel:this.localPerson.channel,payload:{publication:t}});n.contentType==="data"?(this.datachannels[e].close(),delete this.datachannels[e]):(this.transceivers[e].stop(),delete this.transceivers[e]);const r=yield this.pc.createOffer().catch(a=>{throw Oe({operationName:"Sender.remove",info:Se(ie({},qe.internal),{detail:"<remove> can't create offer"}),path:xr.prefix,context:this._context,channel:this.localPerson.channel,error:a})});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(r)},createdAt:Date.now()}),yield this.pc.setLocalDescription(r);const i={kind:"senderUnproduceMessage",payload:{sdp:this.pc.localDescription,publicationId:e}};this._log.debug("<remove> send message",{message:i}),yield this.signaling.send(this.endpoint,i).catch(a=>{throw this._log.error("<remove> in remote error :",a,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}),a}),this._log.debug("<remove> [end]",{publicationId:e})})}_replaceTrack(e,t){return H(this,null,function*(){const n=this.transceivers[e];if(!n){this._log.warn("can't replace track, transceiver not found",On({operationName:"Sender._replaceTrack",detail:"transceiver already removed",channel:this.localPerson.channel,payload:{publicationId:e}}));return}yield n.sender.replaceTrack(t).catch(r=>{throw Oe({operationName:"Sender._replaceTrack",context:this._context,info:qe.internal,error:r,path:xr.prefix,channel:this.localPerson.channel})})})}_handleReceiverAnswer(e){return H(this,arguments,function*({sdp:t}){this.pc.signalingState!=="closed"&&(this._log.debug("<handleReceiverAnswer> [start]"),yield this.pc.setRemoteDescription(new RTCSessionDescription(t)).catch(n=>{const r=Oe({operationName:"Sender._handleReceiverAnswer",context:this._context,info:Se(ie({},qe.internal),{detail:"failed to setRemoteDescription"}),path:xr.prefix,payload:{sdp:t},channel:this.localPerson.channel,error:n});throw this._log.error(r),r}),this._log.debug("<handleReceiverAnswer> sRD"),yield this.resolveCandidates(),this._log.debug("<handleReceiverAnswer> resolveCandidates"),yield this.waitForSignalingState("stable"),this._log.debug("<handleReceiverAnswer> waitForSignalingState"),this._isNegotiating=!1,yield this._resolvePendingSender(),this._log.debug("<handleReceiverAnswer> _resolvePendingSender",this._pendingPublications.length),this._log.debug("<handleReceiverAnswer> [end]"))})}_safariSetupEncoding(e){const t=this.transceivers[e.id],n=e.stream;this.waitForStats({track:n.track,cb:r=>{const i=r.find(a=>a.id.includes("RTCOutboundRTP")||a.type.includes("outbound-rtp"));return(i==null?void 0:i.keyFramesEncoded)>0},interval:10,timeout:this._context.config.rtcConfig.timeout}).then(()=>{xr.debug("safari wait for stats resolved, setEncodingParams"),jc(t.sender,[e.encodings[0]]).catch(r=>{this._log.error("setEncodingParams failed",r)})}).catch(r=>{this._log.error("waitForStats",r)})}_resolvePendingSender(){return H(this,null,function*(){const e=this._pendingPublications.shift();e&&(this._log.debug("resolve pending sender",{publication:e}),typeof e=="string"?yield this.remove(e):yield this.add(e))})}close(){this._log.debug("closed"),this.unSetPeerConnectionListener(),Object.values(this._unsubscribeStreamEnableChange).forEach(e=>e()),this.pc.close(),this._setConnectionState("disconnected"),this._disposer.dispose()}};function sP(e,t,n){var r,i;const a=n.media.find(h=>{var g;return((g=h.mid)==null?void 0:g.toString())===t});if(!a)throw Oe({operationName:"applyCodecCapabilities",info:Se(ie({},qe.notFound),{detail:"media not found"}),path:xr.prefix});e.forEach(h=>{var g;if(h.parameters)for(const[f,_]of Object.entries((g=h.parameters)!=null?g:{})){if(_===!1||!h.parameters[f])return;f==="usedtx"&&_&&(h.parameters[f]=1)}});const o=(h,g,f)=>{var _;const w=g.map(S=>Se(ie({},S),{parameters:GC(f,S.payload)})),C=b1(h.mimeType);return C&&(_=w.find(S=>{var b,x;return S.codec.toLowerCase()!==C.toLowerCase()?!1:Object.keys((b=h.parameters)!=null?b:{}).length===0||aP(h.mimeType)==="audio"?!0:(0,rP.default)(S.parameters,(x=h.parameters)!=null?x:{})}))!=null?_:void 0},u=e.map(h=>o(h,a.rtp,a.fmtp)).filter(h=>h!=null),p=[...u,...a.rtp.filter(h=>!u.find(g=>g.payload===h.payload))];for(const h of a.fmtp){const g=h.payload,f=p.find(C=>C.payload===g);if(f){const C=e.find(R=>o(R,[f],a.fmtp));C&&C.parameters&&Object.keys(C.parameters).length>0&&(h.config="",Object.entries(C.parameters).forEach(([R,S])=>{S===!1||h.config.includes(R)||(h.config.length>0?h.config+=`;${R}=${S}`:h.config=`${R}=${S}`)}))}const _=p.find(C=>C.codec.toLowerCase()==="opus"),w=(i=(r=e.find(C=>b1(C.mimeType).toLowerCase()==="opus"))==null?void 0:r.parameters)==null?void 0:i.usedtx;_&&w!==!1&&h.payload===_.payload&&!h.config.includes("usedtx")&&(h.config.length>0?h.config+=";usedtx=1":h.config="usedtx=1")}a.payloads=p.map(h=>h.payload.toString()).join(" ")}var b1=e=>e.split("/")[1],aP=e=>e.split("/")[0],gu=new Ze("packages/core/src/plugin/internal/person/connection/index.ts"),oP=class{constructor(e,t,n,r,i,a,o){this._iceManager=e,this._signaling=t,this._analytics=n,this._context=r,this.channelId=i,this.localPerson=a,this.remoteMember=o,this.id=ji(),this.type="p2p",this.onDisconnect=new Ye,this.onClose=new Ye,this.closed=!1,this.disconnected=!1,this._log=gu.createBlock({id:this.id,localPersonId:this.localPerson.id}),this._pubsubQueue=new ua,this.sendSubscriptionStatsReportTimers=new Map,this._waitingSendSubscriptionStatsReportsFromPublish=new Map,this._waitingSendSubscriptionStatsReportsFromSubscribe=[],this.sender=new iP(this._context,this._iceManager,this._signaling,this._analytics,this.localPerson,this.remoteMember),this.receiver=new nP(this._context,this._iceManager,this._signaling,this._analytics,this.localPerson,this.remoteMember),this.sender.onDisconnect.once(()=>{this.disconnected=!0,this.onDisconnect.emit()}),this.receiver.onDisconnect.once(()=>{this.disconnected=!0,this.onDisconnect.emit()}),this._analytics&&this._analytics.onConnectionStateChanged.add(u=>{if(u==="connected"){if(this._waitingSendSubscriptionStatsReportsFromPublish.size>0){for(const[p,h]of this._waitingSendSubscriptionStatsReportsFromPublish){const g=this.sender.publications[h];g&&this.startSendSubscriptionStatsReportTimer(g,p)}this._waitingSendSubscriptionStatsReportsFromPublish.clear()}if(this._waitingSendSubscriptionStatsReportsFromSubscribe.length>0){for(const p of this._waitingSendSubscriptionStatsReportsFromSubscribe){const h=this.receiver.subscriptions[p];h&&this.startSendSubscriptionStatsReportTimer(h,p)}this._waitingSendSubscriptionStatsReportsFromSubscribe=[]}}})}startPublishing(e,t){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("startPublishing",{publication:e}),yield this.sender.add(e)})),this._analytics&&!this._analytics.isClosed()&&(this._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:t,role:"sender",rtcPeerConnectionId:this.sender.rtcPeerConnectionId}),this._analytics.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer(e,t):this._waitingSendSubscriptionStatsReportsFromPublish.set(t,e.id))})}stopPublishing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("<stopPublishing> start",{publication:e}),this.sender.remove(e.id).then(()=>{this._log.debug("<stopPublishing> removed",{publication:e})}).catch(n=>{this._log.error("<stopPublishing> remove failed",n,{publication:e})}),this._closeIfNeeded(),this._log.debug("<stopPublishing> end",{publication:e})}));const t=this.sendSubscriptionStatsReportTimers.get(e.id);t&&(clearInterval(t),this.sendSubscriptionStatsReportTimers.delete(e.id))})}startSubscribing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("startSubscribing",{subscription:e}),this.receiver.add(e);const t=e.publication.id;let n=this.receiver.streams[t];n||(yield this.receiver.onStreamAdded.watch(r=>r.publicationId===t,this._context.config.rtcConfig.timeout).catch(()=>{throw Oe({operationName:"P2PConnection.startSubscribing",info:Se(ie({},qe.timeout),{detail:"onStreamAdded"}),path:gu.prefix,context:this._context,channel:this.localPerson.channel,payload:{subscription:e}})}),n=this.receiver.streams[t]),n.setIsEnabled(e.publication.state==="enabled"),e.codec=n.codec,e._setStream(n),this._analytics&&!this._analytics.isClosed()&&(this._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:e.id,role:"receiver",rtcPeerConnectionId:this.receiver.rtcPeerConnectionId}),this._analytics.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer(e,e.id):this._waitingSendSubscriptionStatsReportsFromSubscribe.push(e.id))}))})}stopSubscribing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("stopSubscribing",{subscription:e}),this.receiver.remove(e.id),this._closeIfNeeded()}));const t=this.sendSubscriptionStatsReportTimers.get(e.id);t&&(clearInterval(t),this.sendSubscriptionStatsReportTimers.delete(e.id))})}_closeIfNeeded(){this.sender.hasMedia||this.receiver.hasMedia||this.close({reason:"no media"})}getStats(e){return H(this,null,function*(){const t=e.stream;if(!t)throw Oe({operationName:"P2PConnection.getStats",info:Se(ie({},qe.invalidArgumentValue),{detail:"Subscription or Publication must has stream"}),path:gu.prefix,context:this._context,channel:this.localPerson.channel});return t.side==="local"?t.contentType==="data"?this.sender.pc.getStats():this.sender.pc.getStats(t.track):t.contentType==="data"?this.receiver.pc.getStats():this.receiver.pc.getStats(t.track)})}close({reason:e}={}){if(!this.closed){this.closed=!0,this._log.debug("closed",{endpointId:this.remoteMember.id,reason:e,sender:this.sender.id,receiver:this.receiver.id,id:this.id}),this.sender.close(),this.receiver.close();for(const t of this.sendSubscriptionStatsReportTimers.values())clearInterval(t);this.sendSubscriptionStatsReportTimers.clear(),this._waitingSendSubscriptionStatsReportsFromPublish.clear(),this._waitingSendSubscriptionStatsReportsFromSubscribe=[],this.onClose.emit()}}startSendSubscriptionStatsReportTimer(e,t){if(this._analytics){const n=e instanceof mb?"sender":"receiver",r=this._analytics.client.getIntervalSec();this.sendSubscriptionStatsReportTimers.set(e.id,setInterval(()=>H(this,null,function*(){if(!this._analytics)throw Oe({operationName:"P2PConnection.sendSubscriptionStatsReportTimer",info:Se(ie({},qe.missingProperty),{detail:"AnalyticsSession not exist"}),path:gu.prefix,context:this._context,channel:this.localPerson.channel});if(this._analytics.isClosed()){const a=this.sendSubscriptionStatsReportTimers.get(e.id);a&&(clearInterval(a),this.sendSubscriptionStatsReportTimers.delete(e.id));return}const i=yield this.getStats(e);i&&this._analytics.client.sendSubscriptionStatsReport(i,{subscriptionId:t,role:n,contentType:e.contentType,createdAt:Date.now()})}),r*1e3))}}},_c=new Ze("packages/core/src/plugin/internal/person/member.ts"),qu=class extends hh{constructor(e){super(e),this.args=e,this.type="person",this.subtype="person",this.side="remote",this._connections={},this._context=this.args.channel._context,this._disposer=new ni,this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.subscribe=t=>new Promise((n,r)=>{let i=!1;this.channel._subscribe(this.id,t).catch(a=>{i=!0,r(a)}),this.onPublicationSubscribed.watch(({subscription:a})=>a.publication.id===t,this._context.config.rtcApi.timeout).then(({subscription:a})=>{n({subscription:a})}).catch(()=>{i||r(Oe({operationName:"RemotePersonImpl.subscribe",info:Se(ie({},qe.timeout),{detail:"onPublicationSubscribed"}),path:_c.prefix,context:this._context,channel:this.channel}))})}),this.plugin=e.plugin,this.channel.onPublicationUnsubscribed.add(({subscription:t})=>{t.subscriber.id===this.id&&(this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this.channel.onPublicationSubscribed.add(({subscription:t})=>{t.subscriber.id===this.id&&(this.onPublicationSubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this.channel.onStreamPublished.add(({publication:t})=>{t.publisher.id===this.id&&this.onPublicationListChanged.emit()}).disposer(this._disposer),this.channel.onStreamUnpublished.add(({publication:t})=>{t.publisher.id===this.id&&this.onPublicationListChanged.emit()}).disposer(this._disposer),this.onLeft.once(()=>{_c.debug("RemotePerson left: ",this.toJSON()),Object.values(this._connections).forEach(t=>{t.close({reason:"remote person left"})}),this._connections={}})}_getConnection(e){return this._connections[e]}_getOrCreateConnection(e){var t;return(t=this._getConnection(e.id))!=null?t:this._createConnection(this.channel,e,this)}_createConnection(e,t,n){if(t.side!=="local")throw Oe({operationName:"RemotePersonImpl._createConnection",info:Se(ie({},qe.invalidArgumentValue),{detail:"wrong localPerson type"}),path:_c.prefix,context:this._context,channel:this.channel});if(!t._signaling)throw Oe({operationName:"RemotePersonImpl._createConnection",info:Se(ie({},qe.missingProperty),{detail:"signalingSession not exist"}),path:_c.prefix,context:this._context,channel:this.channel});const r=new oP(t.iceManager,t._signaling,t._analytics,this._context,e.id,t,n);return this.plugin._messageBuffers[t.id].resolveMessagingBuffer(n),r.onClose.once(()=>{_c.debug("connection closed",this.toJSON(),{connectionId:r.id}),delete this._connections[t.id]}),this._connections[t.id]=r,r}unsubscribe(e){return H(this,null,function*(){yield this.channel._unsubscribe(e)})}_dispose(){this._disposer.dispose()}},cP=class extends og{constructor(){super(...arguments),this.subtype="person",this._messageBuffers={},this._whenCreateLocalPerson=e=>H(this,null,function*(){e._signaling&&(this._messageBuffers[e.id]=new G6(e._signaling))}),this._whenDisposeLocalPerson=e=>H(this,null,function*(){const t=this._messageBuffers[e.id];t&&(t.close(),delete this._messageBuffers[e.id])}),this._createRemoteMember=(e,t)=>new qu(Se(ie({},this._context),{context:this._context,channel:e,metadata:t.metadata,id:t.id,name:t.name,plugin:this}))}},lP=e=>{const t=new cP;return e.registerPlugin(t),t};Y();var uP=class extends og{constructor(){super(...arguments),this.subtype="unknown",this._createRemoteMember=(e,t)=>new V_(Se(ie({},this._context),{context:this._context,channel:e,metadata:t.metadata,id:t.id,name:t.name,plugin:this,subtype:t.subtype}))}};Y();var dP="1.15.0",Lr=new Ze("packages/core/src/context.ts"),cg=class Rb{constructor(t,n,r,i){this.config=n,this.authToken=r,this.info=i,this.disposed=!1,this.plugins=[],this._unknownPlugin=new uP,this._reminderSec=this.config.token.updateReminderSec,this._events=new es,this.onTokenUpdateReminder=this._events.make(),this.onTokenExpired=this._events.make(),this.onFatalError=this._events.make(),this._onTokenUpdated=this._events.make(),this._onDisposed=this._events.make(),this._authTokenString=r.tokenString,this.appId=this.authToken.getAppId(),lP(this),this._api=t,this._api.onFatalError.once(a=>{Lr.error("onFatalError",{appId:this.appId,error:a}),this.onFatalError.emit(Oe({operationName:"SkyWayContext._api.onFatalError",context:this,info:qe.rtcApiFatalError,error:a,path:Lr.prefix})),this.dispose()})}static Create(t){return H(this,arguments,function*(n,r={}){const i=new y6(r);Ze.level=i.log.level,Ze.format=i.log.format;const a=yl.Decode(n),{osName:o,osVersion:u,browserName:p,browserVersion:h}=H_(),g={sdkName:"core",sdkVersion:this.version,osName:o,osVersion:u,browserName:p,browserVersion:h},f={rapi:i.rtcApi.domain,signaling:i.signalingService.domain,ice:i.iceParamServer.domain};Lr.info("core sdk spawned",{operationName:"SkyWayContext.Create",runtime:g,endpoint:f,config:i,token:a});try{const _=a.getAppId(),w=yield I6.Create({appId:_,token:n,log:i.log,rtcApi:i.rtcApi}),C=new Rb(w,i,a,{endpoint:f,runtime:g});return yield C._setTokenExpireTimer(),a.getAnalyticsEnabled()&&(C.analyticsSession=yield K6(C)),C}catch(_){throw Oe({operationName:"SkyWayContext.Create",info:qe.connectRtcApiFailed,error:_,path:Lr.prefix})}})}get authTokenString(){return this._authTokenString}_setTokenExpireTimer(){return H(this,null,function*(){const t=yield this._api.getServerUnixtimeInSec(),n=this.authToken.exp-t;if(n<0)throw Oe({operationName:"SkyWayContext._setTokenExpireTimer",context:this,info:qe.invalidExpireTokenValue,path:Lr.prefix,payload:{exp:this.authToken.exp,now:t}});this.tokenUpdateReminderTimer&&clearTimeout(this.tokenUpdateReminderTimer);const r=n-this._reminderSec;if(r<0)throw Oe({operationName:"SkyWayContext._setTokenExpireTimer",context:this,info:qe.invalidRemindExpireTokenValue,path:Lr.prefix,payload:{expiresInSec:n,reminderSec:this._reminderSec}});Lr.debug("_setTokenExpireTimer",{expiresInSec:n,tokenExpireReminderTimeSec:r}),this.tokenUpdateReminderTimer=setTimeout(()=>{Lr.debug("tokenUpdateReminder",{appid:this.appId}),this.onTokenUpdateReminder.emit()},r*1e3),this.tokenExpiredTimer&&clearTimeout(this.tokenExpiredTimer),this.tokenExpiredTimer=setTimeout(()=>{Lr.debug("tokenExpired",{appid:this.appId}),this.onTokenExpired.emit()},n*1e3)})}updateAuthToken(t){return H(this,null,function*(){const n=yl.Decode(t),r=n.getAppId();if(Lr.info({operationName:"SkyWayContext.updateAuthToken"},{oldToken:this.authToken,newToken:n}),r!==this.appId)throw Oe({operationName:"SkyWayContext.updateAuthToken",context:this,info:qe.invalidTokenAppId,path:Lr.prefix,payload:{invalid:r,expect:this.appId}});this._authTokenString=t,this.authToken=n,this._onTokenUpdated.emit(t),yield this._setTokenExpireTimer(),yield this._api.updateAuthToken(t).catch(i=>{var a;throw Lr.warn("[failed] SkyWayContext.updateAuthToken",{detail:i}),i instanceof Er&&((a=i.info)==null?void 0:a.name)==="projectUsageLimitExceeded"&&(this.dispose(),clearTimeout(this.tokenExpiredTimer)),i})})}registerPlugin(t){this.plugins.find(n=>n.subtype===t.subtype)||(t._attachContext(this),this.plugins.push(t))}_createRemoteMember(t,n){const r=t._getMember(n.id);if(r)return r;Lr.debug("createRemoteMember",{memberDto:n}),n.type=n.type.toLowerCase(),n.subtype=n.subtype.toLowerCase();let i=this.plugins.find(o=>o.subtype===n.subtype);return i||(i=this._unknownPlugin),i._createRemoteMember(t,n)}dispose(){this.disposed||(this.disposed=!0,Lr.debug("disposed",{appid:this.appId}),clearTimeout(this.tokenUpdateReminderTimer),this._onDisposed.emit(),this._events.dispose(),this._api.close(),Ze._onLogForAnalytics=()=>{})}};cg.version=dP;cg.id=ji();var Jf=cg;Y();Y();var Ap=new Ze("packages/core/src/media/factory.ts"),hP=class{constructor(){if(this.onDeviceChange=new Ye,this._devices=[],!(navigator!=null&&navigator.mediaDevices))throw Oe({operationName:"StreamFactory.constructor",info:qe.mediaDevicesNotFound,path:Ap.prefix});navigator.mediaDevices.addEventListener("devicechange",()=>H(this,null,function*(){const e=yield this._enumerateDevicesArray(),t=[];this._devices.forEach(r=>{e.map(i=>i.id).includes(r.id)||t.push(r)});const n=[];e.map(r=>r.id).forEach(r=>{this._devices.map(i=>i.id).includes(r)||n.push(e.find(i=>i.id===r))}),Ap.debug("device changed",{added:n,removed:t}),t.forEach(r=>{this.onDeviceChange.emit({state:"removed",device:r})}),n.forEach(r=>{this.onDeviceChange.emit({state:"added",device:r})}),this._devices=e}))}_enumerateDevicesArray(){return H(this,null,function*(){return(yield navigator.mediaDevices.enumerateDevices()).map(t=>new pP(t)).filter(t=>t.id.length>0)})}_enumerateDevicesWithAuth(){return H(this,arguments,function*({video:e,audio:t}={audio:!0,video:!0}){let n=[];return(e||t)&&(n=(yield navigator.mediaDevices.getUserMedia({video:e,audio:t})).getTracks()),this._devices=yield this._enumerateDevicesArray(),n.forEach(r=>r.stop()),this._devices})}enumerateDevices(){return H(this,null,function*(){return yield this._enumerateDevicesWithAuth()})}enumerateInputVideoDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({video:!0})).filter(t=>t.kind==="videoinput")})}enumerateInputAudioDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({audio:!0})).filter(t=>t.kind==="audioinput")})}enumerateOutputAudioDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({audio:!0})).filter(t=>t.kind==="audiooutput")})}createCameraVideoStream(){return H(this,arguments,function*(e={}){var t;e.stopTrackWhenDisabled=(t=e.stopTrackWhenDisabled)!=null?t:!0;const[n]=(yield navigator.mediaDevices.getUserMedia({video:e})).getTracks(),r=new Cp(n,e);return r._setLabel("camera"),r})}createMicrophoneAudioStream(){return H(this,arguments,function*(e={}){var t;e.stopTrackWhenDisabled=(t=e.stopTrackWhenDisabled)!=null?t:!0;const[n]=(yield navigator.mediaDevices.getUserMedia({audio:e})).getTracks(),r=new xp(n,e);return r._setLabel("microphone"),r})}createDisplayStreams(){return H(this,arguments,function*(e={}){var t,n,r;const i=(t=e.video)!=null?t:{};(n=i.stopTrackWhenDisabled)!=null||(i.stopTrackWhenDisabled=!0);let a=e.audio;a&&(a=typeof a=="boolean"?{}:a,(r=a.stopTrackWhenDisabled)!=null||(a.stopTrackWhenDisabled=!0)),e={audio:a,video:i};const o=yield navigator.mediaDevices.getDisplayMedia(e),[u]=o.getVideoTracks(),[p]=o.getAudioTracks();e.audio&&!p&&Ap.warn(On({operationName:"StreamFactory.createDisplayStreams",detail:"This client does not support device audio capture"}));const h=new Cp(u,Se(ie({},i),{isDisplayMedia:!0}));h._setLabel("displayVideo");const g=p?new xp(p,Se(ie({},a),{isDisplayMedia:!0})):void 0;return g&&g._setLabel("displayAudio"),{video:h,audio:g}})}createDataStream(){return H(this,arguments,function*(e={}){return new sg(e)})}createMicrophoneAudioAndCameraStream(){return H(this,arguments,function*({audio:e,video:t}={}){var n,r;const i=yield navigator.mediaDevices.getUserMedia({audio:e??!0,video:t??!0}),[a]=i.getAudioTracks(),[o]=i.getVideoTracks();e=e??{},e.stopTrackWhenDisabled=(n=e.stopTrackWhenDisabled)!=null?n:!0;const u=new xp(a,e);u._setLabel("microphone"),t=t??{},t.stopTrackWhenDisabled=(r=t.stopTrackWhenDisabled)!=null?r:!0;const p=new Cp(o,t);return p._setLabel("camera"),{audio:u,video:p}})}createCustomVideoStream(e){return H(this,arguments,function*(t,n={}){var r,i;n.stopTrackWhenDisabled=(r=n.stopTrackWhenDisabled)!=null?r:!0;const a=new $5(n),o=yield t.createProcessedStream({constraints:(i=n.constraints)!=null?i:{},stopTrackWhenDisabled:n.stopTrackWhenDisabled,onUpdateTrack:u=>a.updateTrack(u)});return yield a.setStream(o),a})}},S1=new hP,pP=class{constructor(e){this.id=e.deviceId,this.label=e.label,this.kind=e.kind}};Y();Y();Y();Y();Y();Y();Y();Y();Y();Y();var Ab={domain:"sfu.skyway.ntt.com",secure:!0,version:4};Y();var Bs={invalidParameter:{name:"invalidParameter",detail:"",solution:""},invalidRequestParameter:{name:"invalidRequestParameter",detail:"",solution:""},notFound:{name:"notFound",detail:"",solution:""},maxSubscriberExceededError:{name:"maxSubscribersExceededError",detail:"forwardingmaxSubscribersmaxSubscribersSubscribe",solution:"maxSubscribers"},quotaExceededError:{name:"quotaExceededError",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},insufficientPermissions:{name:"insufficientPermissions",detail:"token",solution:"token"},backendError:{name:"backendError:",detail:"",solution:""},notAllowedConsumeError:{name:"notAllowedConsumeError",detail:"ForwardingConsume",solution:"Forwardingmember"}};Y();function ya({operationName:e,info:t,error:n,path:r,payload:i}){return new Er({error:n,info:t,payload:{payload:i,operationName:e},path:r})}function bc({appId:e,detail:t,channelId:n,operationName:r,payload:i,memberId:a,botId:o}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n,memberId:a,botId:o}}var Sr=new Ze("packages/sfu-api-client/src/api.ts"),fP=class{constructor(e,t){this._token=e,this._headers={authorization:`Bearer ${this._token}`},this.options=ie(ie({},Ab),t),this.endpoint=`http${this.options.secure?"s":""}://${this.options.domain}/v${this.options.version}`,this.http=new tg(this.endpoint),Ze.level=this.options.log.level,Ze.format=this.options.log.format,Sr.debug("SfuRestApiClient spawned",{endpoint:this.endpoint})}updateToken(e){this._token=e}_commonErrorHandler(e,t){switch(e==null?void 0:e.status){case 401:return ya({operationName:t,info:Bs.invalidRequestParameter,path:Sr.prefix,payload:e});case 403:return ya({operationName:t,info:Bs.insufficientPermissions,path:Sr.prefix,payload:e});case 404:return ya({operationName:t,info:Bs.notFound,path:Sr.prefix,payload:e});case 429:return ya({operationName:t,info:Bs.quotaExceededError,path:Sr.prefix,payload:e});default:return ya({operationName:t,info:Bs.backendError,path:Sr.prefix,payload:e})}}createBot(e){return H(this,arguments,function*({appId:t,channelId:n}){return(yield this.http.post("/bots",{appId:t,channelId:n},{headers:{authorization:`Bearer ${this._token}`}}).catch(i=>{throw this._commonErrorHandler(i,"SfuRestApiClient.createBot")})).id})}deleteBot(e){return H(this,arguments,function*({botId:t}){yield this.http.delete(`/bots/${t}`,{headers:{authorization:`Bearer ${this._token}`}}).catch(n=>{throw this._commonErrorHandler(n,"SfuRestApiClient.deleteBot")})})}startForwarding(e){return H(this,arguments,function*({botId:t,publicationId:n,maxSubscribers:r,contentType:i,publisherId:a}){const o=new ki,u={publicationId:n,maxSubscribers:r,contentType:i[0].toUpperCase()+i.slice(1),publisherId:a},p=yield this.http.post(`/bots/${t}/forwardings`,u,{headers:{authorization:`Bearer ${this._token}`},retry:h=>H(this,null,function*(){return[400,403,429].includes(h.status)?!1:yield o.wait()})}).catch(h=>{throw this._commonErrorHandler(h,"SfuRestApiClient.startForwarding")});return o.count>0&&Sr.warn("success to retry startForwarding",bc({operationName:"SfuRestApiClient.startForwarding",detail:"success to retry startForwarding",botId:t,memberId:a,payload:{publicationId:n,count:o.count}})),p})}createProducer(e){return H(this,arguments,function*({botId:t,forwardingId:n,transportId:r,producerOptions:i}){const a=new ki,o=yield this.http.put(`/bots/${t}/forwardings/${n}/transports/producers`,{transportId:r,producerOptions:i},{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield a.wait()})}).catch(u=>{throw this._commonErrorHandler(u,"SfuRestApiClient.createProducer")});return a.count>0&&Sr.warn("success to retry createProducer",bc({operationName:"SfuRestApiClient.createProducer",detail:"success to retry createProducer",botId:t,payload:{forwardingId:n,transportId:r,count:a.count}})),o})}createConsumer(e){return H(this,arguments,function*({botId:t,forwardingId:n,rtpCapabilities:r,subscriptionId:i,subscriberId:a,spatialLayer:o,originPublicationId:u}){const p=new ki({times:5,interval:100}),h={rtpCapabilities:r,subscriptionId:i,subscriberId:a,spatialLayer:o,originPublicationId:u},g=yield this.http.post(`/bots/${t}/forwardings/${n}/transports/consumers`,h,{retry:f=>H(this,null,function*(){return[400,403,429].includes(f.status)?!1:yield p.wait()}),headers:{authorization:`Bearer ${this._token}`}}).catch(f=>{throw f.status===429?ya({operationName:"SfuRestApiClient.createConsumer",info:Bs.maxSubscriberExceededError,path:Sr.prefix,payload:f}):f.status===403?ya({operationName:"SfuRestApiClient.createConsumer",info:Bs.notAllowedConsumeError,path:Sr.prefix,payload:f}):this._commonErrorHandler(f,"SfuRestApiClient.createConsumer")});return p.count>0&&Sr.warn("success to retry createConsumer",bc({operationName:"SfuRestApiClient.createConsumer",detail:"success to retry createConsumer",botId:t,payload:{forwardingId:n,count:p.count}})),Sr.debug("response of createConsumer",g),g})}connect(e){return H(this,arguments,function*({transportId:t,dtlsParameters:n}){const r=new ki,i={transportId:t,dtlsParameters:n},a=yield this.http.put("/transports/connections",i,{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield r.wait()})}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.connect")});return r.count>0&&Sr.warn("success to retry connect",bc({operationName:"SfuRestApiClient.connect",detail:"success to retry connect",payload:{transportId:t,count:r.count}})),a})}changeConsumerLayer(e){return H(this,arguments,function*({transportId:t,consumerId:n,spatialLayer:r,publicationId:i}){return yield this.http.put(`transports/consumers/${n}/layers`,{transportId:t,spatialLayer:r,publicationId:i},{headers:{authorization:`Bearer ${this._token}`}}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.changeConsumerLayer")})})}stopForwarding({botId:e,forwardingId:t}){let n=!1;return{promise:this.http.delete(`/bots/${e}/forwardings/${t}`,{headers:{authorization:`Bearer ${this._token}`}}).catch(i=>{throw this._commonErrorHandler(i,"SfuRestApiClient.stopForwarding")}).then(i=>{n=i}),fulfilled:n}}iceRestart(e){return H(this,arguments,function*({transportId:t}){return(yield this.http.put("/transports/connections/ice",{transportId:t},{headers:this._headers}).catch(r=>{throw this._commonErrorHandler(r,"SfuRestApiClient.iceRestart")})).iceParameters})}getRtpCapabilities(e){return H(this,arguments,function*({botId:t,forwardingId:n,originPublicationId:r}){const i=new ki,a=yield this.http.get(`/bots/${t}/forwardings/${n}/transports/rtp-capabilities?originPublicationId=${r}`,{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield i.wait()})}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.getRtpCapabilities")});return i.count>0&&Sr.warn("getCapabilities to retry connect",bc({operationName:"SfuRestApiClient.getRtpCapabilities",detail:"getCapabilities to retry connect",botId:t,payload:{forwardingId:n,count:i.count}})),a.rtpCapabilities})}confirmSubscription(e){return H(this,arguments,function*({forwardingId:t,subscriptionId:n,identifierKey:r}){const i={forwardingId:t,subscriptionId:n,identifierKey:r},a=yield this.http.post("/confirm-subscription",i,{headers:{authorization:`Bearer ${this._token}`}}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.confirmSubscription")});return Sr.debug("response of confirmSubscription",a),a})}},Xt=Se(ie({},Bs),{invalidParameter:{name:"invalidParameter",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internal:{name:"internal",detail:"",solution:""},sfuBotNotInChannel:{name:"sfuBotNotInChannel",detail:"SfuBotChannel",solution:"SfuBot"},remotePublisherId:{name:"remotePublisherId",detail:"publisherremotePublicationForwarding",solution:"PublicationLocalPublish"},dataStreamNotSupported:{name:"dataStreamNotSupported",detail:"dataStreamSFU",solution:""},streamNotExistInPublication:{name:"streamNotExistInPublication",detail:"PublicationStreamRemoteMemberPublicationStream",solution:"Publication"},invalidPreferredEncoding:{name:"invalidPreferredEncoding",detail:"preferredEncoding",solution:""},invalidEncodings:{name:"invalidEncodings",detail:"",solution:"PublicationForwarding"},receiverNotFound:{name:"receiverNotFound",detail:"SFURemoteMemberSubscription",solution:"SFUsubscriptionLocalPersonSubscribeSubscription"},consumerNotFound:{name:"consumerNotFound",detail:"SFULocalPersonUnsubscribeSubscription",solution:"Subscription"},forwardingNotFound:{name:"forwardingNotFound",detail:"Forwarding",solution:"Forwarding"},netWorkError:{name:"netWorkError",detail:"",solution:""},confirmSubscriptionFailed:{name:"confirmSubscriptionFailed",detail:"Forwardingconsume",solution:""}});Y();function Zf(e,t){let n=0;for(;n<t.length&&t[n].id!==e;n++);return n}function Ca({channel:e,detail:t,operationName:n,payload:r,bot:i}){var a;const o={operationName:n,payload:r,detail:t};return e&&(o.appId=e.appId,o.channelId=e.id,e.localPerson&&(o.memberId=e.localPerson.id)),i&&(o.botId=i.id,o.appId=i.channel.appId,o.channelId=i.channel.id,o.memberId=(a=i.channel.localPerson)==null?void 0:a.id),o}Y();var si=new Ze("packages/sfu-bot/src/connection/receiver.ts"),mP=class{constructor(e,t,n,r,i,a,o){this.subscription=e,this._api=t,this._transportRepository=n,this._localPerson=r,this._bot=i,this._iceManager=a,this._context=o,this._disposer=new ni,this.sendSubscriptionStatsReportTimer=null,this._waitingSendSubscriptionStatsReports=[];const u=this._localPerson._analytics;u&&u.onConnectionStateChanged.add(p=>{if(p==="connected"&&this._waitingSendSubscriptionStatsReports.length>0){for(const h of this._waitingSendSubscriptionStatsReports)this.consumer&&this.consumer.id===h&&this.startSendSubscriptionStatsReportTimer();this._waitingSendSubscriptionStatsReports=[]}})}toJSON(){return{transport:this.transport,subscription:this.subscription}}consume(){return H(this,null,function*(){var e,t;let n=this._transportRepository.rtpCapabilities;n||(si.debug("[start] getCapabilities"),n=yield this._api.getRtpCapabilities({botId:this._bot.id,forwardingId:this.subscription.publication.id,originPublicationId:this.subscription.publication.origin.id}),si.debug("[end] getCapabilities"),yield this._transportRepository.loadDevice(n).catch(w=>{throw Oe({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:Se(ie({},Xt.internal),{detail:"sfu loadDevice failed"}),path:si.prefix,error:w})}));const r=this.subscription.preferredEncoding?Zf(this.subscription.preferredEncoding,(t=(e=this.subscription.publication.origin)==null?void 0:e.encodings)!=null?t:[]):void 0;si.debug("[start] createConsumer",{subscription:this.subscription});const{consumerOptions:i,transportOptions:a,transportId:o,producerId:u}=yield this._api.createConsumer({botId:this._bot.id,forwardingId:this.subscription.publication.id,rtpCapabilities:n,subscriptionId:this.subscription.id,subscriberId:this.subscription.subscriber.id,spatialLayer:r,originPublicationId:this.subscription.publication.origin.id});a&&this._transportRepository.createTransport(this._localPerson.id,this._bot,a,"recv",this._iceManager,this._localPerson._analytics),this.transport=this._transportRepository.getTransport(this._localPerson.id,o),this.transport||(si.warn("transport is under race condition",{transportId:o}),yield this._transportRepository.onTransportCreated.watch(w=>w===o,this._bot.options.endpointTimeout).catch(w=>{throw Oe({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:Se(ie({},Xt.timeout),{detail:"receiver sfuTransport not found"}),path:si.prefix,error:w,payload:{transportOptions:a,transportId:o,producerId:u,consumerOptions:i,subscription:this.subscription}})}),this.transport=this._transportRepository.getTransport(this._localPerson.id,o)),this._localPerson._analytics&&!this._localPerson._analytics.isClosed()&&this._localPerson._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:this.subscription.id,role:"receiver",rtcPeerConnectionId:this.transport.id}),si.debug("[end] createConsumer"),si.debug("[start] consume",{consumerOptions:i,subscription:this.subscription});const p=yield this.transport.msTransport.consume(Se(ie({},i),{producerId:u})).catch(w=>{throw Oe({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:Se(ie({},Xt.internal),{detail:"consume failed, maybe subscribing unsupported codec"}),path:si.prefix,error:w})});this.consumer=p,si.debug("[end] consume",{subscription:this.subscription});const[h]=p.rtpParameters.codecs,g=Gf(Ko(),p.track,h),f={mimeType:h.mimeType,parameters:h.parameters};this._setupTransportAccessForStream(g,p);const _=this._localPerson._analytics;return _&&!_.isClosed()&&(_.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer():this._waitingSendSubscriptionStatsReports.push(p.id)),{stream:g,codec:f}})}_setupTransportAccessForStream(e,t){const n=this.transport,r=this.pc;e._getTransport=()=>({rtcPeerConnection:r,connectionState:n.connectionState,info:this}),e._getStats=()=>H(this,null,function*(){const i=yield t.getStats();let a=No(i);return a=a.map(o=>(o.sfuTransportId=n.id,o)),a}),this._disposer.push(()=>{e._getTransport=()=>{}}),n.onConnectionStateChanged.add(i=>{si.debug("transport connection state changed",n.id,i),e._setConnectionState(i)})}unconsume(){if(!this.consumer){si.debug("unconsume failed, consumer not exist",{subscription:this.subscription});return}this.consumer.close(),this.consumer=void 0,this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer)}close(){this._disposer.dispose()}get pc(){var e;return(e=this.transport)==null?void 0:e.pc}startSendSubscriptionStatsReportTimer(){const e=this._localPerson._analytics;if(e){const t=e.client.getIntervalSec();this.sendSubscriptionStatsReportTimer=setInterval(()=>H(this,null,function*(){if(!e||e.isClosed()){this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer);return}if(this.consumer){const n=yield this.consumer.getStats();n&&e.client.sendSubscriptionStatsReport(n,{subscriptionId:this.subscription.id,role:"receiver",contentType:this.subscription.contentType,createdAt:Date.now()})}}),t*1e3)}}};Y();var w1=$r(t_());Y();var vu=new Ze("packages/sfu-bot/src/connection/sender.ts"),gP=class{constructor(e){this.props=e,this.state="started",this.configure=this.props.configure,this.originPublication=this.props.originPublication,this.relayingPublication=this.props.relayingPublication,this._identifierKey=this.props.identifierKey,this._api=this.props.api,this._context=this.props.context,this.onStopped=new Ye,this.relayingPublication.onSubscribed.add(t=>H(this,null,function*(){yield this.confirmSubscription(t.subscription).catch(n=>n)})),this.relayingPublication.subscriptions.forEach(t=>H(this,null,function*(){yield this.confirmSubscription(t).catch(n=>n)}))}get id(){return this.relayingPublication.id}_stop(){this.state="stopped",this.onStopped.emit()}toJSON(){return{id:this.id,configure:this.configure,originPublication:this.originPublication,relayingPublication:this.relayingPublication}}confirmSubscription(e){return H(this,null,function*(){vu.debug("[start] Forwarding confirmSubscription");const{message:t}=yield this._api.confirmSubscription({forwardingId:this.id,subscriptionId:e.id,identifierKey:this._identifierKey}).catch(n=>{throw vu.error("Forwarding confirmSubscription failed:",n),Oe({operationName:"Forwarding.confirmSubscription",context:this._context,info:Xt.confirmSubscriptionFailed,path:vu.prefix,payload:n})});vu.debug("[end] Forwarding confirmSubscription",{message:t})})}},ln=new Ze("packages/sfu-bot/src/connection/sender.ts"),vP=class{constructor(e,t,n,r,i,a,o,u){this.publication=e,this.channel=t,this._api=n,this._transportRepository=r,this._localPerson=i,this._bot=a,this._iceManager=o,this._context=u,this._disposer=new ni,this._connectionState="new",this.onConnectionStateChanged=new Ye,this.closed=!1,this.sendSubscriptionStatsReportTimer=null,this._waitingSendSubscriptionStatsReports=[];const p=this._localPerson._analytics;p&&p.onConnectionStateChanged.add(h=>{if(h==="connected"&&this._waitingSendSubscriptionStatsReports.length>0){for(const g of this._waitingSendSubscriptionStatsReports)this._producer&&this._producer.id===g&&this.startSendSubscriptionStatsReportTimer();this._waitingSendSubscriptionStatsReports=[]}})}_setConnectionState(e){this._connectionState!==e&&(ln.debug("_setConnectionState",{state:e,forwardingId:this.forwardingId}),this._connectionState=e,this.onConnectionStateChanged.emit(e))}toJSON(){return{forwarding:this.forwarding,broadcasterTransport:this._broadcasterTransport,_connectionState:this._connectionState}}startForwarding(e){return H(this,null,function*(){if(this.publication.contentType==="data")throw Oe({operationName:"Sender.startForwarding",context:this._context,info:Xt.dataStreamNotSupported,path:ln.prefix,channel:this.channel});const t=this.publication.stream;if(!t)throw Oe({operationName:"Sender.startForwarding",context:this._context,info:Xt.streamNotExistInPublication,path:ln.prefix,channel:this.channel});this.onConnectionStateChanged.add(w=>{var C;ln.debug("transport connection state changed",(C=this._broadcasterTransport)==null?void 0:C.id,w),t._setConnectionState(this._bot,w)}).disposer(this._disposer),ln.debug("[start] Sender startForwarding",{botId:this._bot.id,publicationId:this.publication.id,contentType:this.publication.contentType,maxSubscribers:e.maxSubscribers});const{forwardingId:n,broadcasterTransportId:r,broadcasterTransportOptions:i,rtpCapabilities:a,identifierKey:o}=yield this._api.startForwarding({botId:this._bot.id,publicationId:this.publication.id,contentType:this.publication.contentType,maxSubscribers:e.maxSubscribers,publisherId:this.publication.publisher.id});if(this.forwardingId=n,i&&(ln.debug("sender create new transport",{broadcasterTransportOptions:i}),yield this._transportRepository.loadDevice(a),this._broadcasterTransport=this._transportRepository.createTransport(this._localPerson.id,this._bot,i,"send",this._iceManager,this._localPerson._analytics)),this._broadcasterTransport=this._transportRepository.getTransport(this._localPerson.id,r),!this._broadcasterTransport)throw Oe({operationName:"Sender.startForwarding",context:this._context,info:Se(ie({},Xt.internal),{detail:"_broadcasterTransport not found"}),path:ln.prefix,channel:this.channel,payload:{broadcasterTransportOptions:i}});this._broadcasterTransport.onConnectionStateChanged.add(w=>{this._setConnectionState(w)}).disposer(this._disposer),this._setConnectionState(this._broadcasterTransport.connectionState);const u=yield this._produce(t,this._broadcasterTransport);this._cleanupStreamCallbacks=this._setupTransportAccessForStream(t,this._broadcasterTransport,u);const p=this._localPerson._analytics;p&&!p.isClosed()&&(p.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer():this._waitingSendSubscriptionStatsReports.push(u.id)),ln.debug("[end] Sender startForwarding",{forwardingId:n});let h=this.channel._getPublication(n);h||(h=(yield this.channel.onStreamPublished.watch(w=>w.publication.id===n,this._context.config.rtcApi.timeout).catch(()=>{throw Oe({operationName:"Sender.startForwarding",context:this._context,info:Se(ie({},Xt.timeout),{detail:"SfuBotMember onStreamPublished"}),path:ln.prefix,channel:this.channel,payload:{forwardingId:n}})})).publication);const g=new gP({configure:e,originPublication:this.publication,relayingPublication:h,api:this._api,context:this._context,identifierKey:o});this.forwarding=g;const f=this.channel.subscriptions.find(w=>w.publication.id===this.publication.id),[_]=u.rtpParameters.codecs;return f.codec=_,this._localPerson._analytics&&this._localPerson._analytics.client.connectionState!=="closed"&&this._localPerson._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:f.id,role:"sender",rtcPeerConnectionId:this._broadcasterTransport.id}),Eb()&&Xv({stream:t,remoteMember:this._bot.id,end:w=>{const C=w.find(R=>R.id.includes("RTCOutboundRTP")||R.type.includes("outbound-rtp"));return(C==null?void 0:C.keyFramesEncoded)>0},interval:10}).then(()=>H(this,null,function*(){const w=this.publication.encodings;(w==null?void 0:w.length)>0&&(yield jc(u.rtpSender,w).catch(C=>{ln.error("_onEncodingsChanged failed",C,this)}))})).catch(w=>{ln.error("setEncodingParams waitForLocalStats failed",w,this)}),Xv({stream:t,remoteMember:this._bot.id,end:w=>!!w.find(C=>C.type.includes("local-candidate"))}).then(()=>H(this,null,function*(){const w=yield kt({operationName:"startForwarding/waitForLocalStats",channel:this.channel});ln.debug(w,"forwarding connection connected",{broadcasterTransportId:r})})).catch(()=>{}),g})}_listenStreamEnableChange(e){this._unsubscribeStreamEnableChange&&this._unsubscribeStreamEnableChange();const{removeListener:t}=e._onEnableChanged.add(n=>H(this,null,function*(){yield this._replaceTrack(n).catch(r=>{ln.warn(Ca({detail:"replaceTrack failed",operationName:"Sender._listenStreamEnableChange",bot:this._bot,payload:r}))})}));this._unsubscribeStreamEnableChange=t}_produce(e,t){return H(this,null,function*(){var n,r,i,a,o,u,p,h;this.publication._onReplaceStream.add(b=>H(this,[b],function*({newStream:x}){if(!this._broadcasterTransport)throw Oe({operationName:"Sender._produce",context:this._context,info:Se(ie({},Xt.internal),{detail:"_broadcasterTransport not found"}),path:ln.prefix,channel:this.channel});this._listenStreamEnableChange(x),this._cleanupStreamCallbacks&&this._cleanupStreamCallbacks(),this._cleanupStreamCallbacks=this._setupTransportAccessForStream(x,this._broadcasterTransport,S),yield this._replaceTrack(x.track)})).disposer(this._disposer),this._listenStreamEnableChange(e);const g=Ko(),f={track:e.track,stopTracks:!1,appData:{transactionId:g},disableTrackOnPause:!1},_=this.publication.encodings;_&&(f.encodings=_),this.publication._onEncodingsChanged.add(b=>H(this,null,function*(){yield jc(S.rtpSender,b).catch(x=>{ln.error("_onEncodingsChanged failed",x,this)})})).disposer(this._disposer);const w=this.publication.codecCapabilities,C=(r=(n=this._transportRepository.rtpCapabilities)==null?void 0:n.codecs)!=null?r:[];ln.debug("select codec",{codecCapabilities:w,deviceCodecs:C});const[R]=w.map(b=>b.mimeType.toLowerCase().includes("video")?C.find(M=>{var Z;return!(M.mimeType.toLowerCase()!==b.mimeType.toLowerCase()||Object.keys((Z=b.parameters)!=null?Z:{}).length>0&&!(0,w1.default)(b.parameters,M.parameters))}):C.find(E=>E.mimeType.toLowerCase()===b.mimeType.toLowerCase()));if(ln.debug("selected codec",{codec:R}),R){const[b,x]=R.mimeType.split("/");f.codec=Se(ie({},R),{mimeType:`${b}/${x.toUpperCase()}`}),e.contentType==="video"&&this._fixVideoCodecWithParametersOrder(R)}else w.length>0&&ln.warn("preferred codec not supported",Ca({channel:this.channel,detail:"preferred codec not supported",operationName:"Sender._produce",bot:this._bot,payload:{codecCapabilities:w,deviceCodecs:C}}));e.contentType==="audio"&&(((a=(i=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:i.parameters)==null?void 0:a.usedtx)!==!1&&(f.codecOptions=Se(ie({},f.codecOptions),{opusDtx:!0})),(u=(o=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:o.parameters)!=null&&u.stereo&&(f.codecOptions=Se(ie({},f.codecOptions),{opusStereo:!0})),(h=(p=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:p.parameters)!=null&&h.useinbandfec&&(f.codecOptions=Se(ie({},f.codecOptions),{opusFec:!0}))),t.onProduce.watch(b=>{var x;return((x=b.producerOptions.appData)==null?void 0:x.transactionId)===g},this._context.config.rtcConfig.timeout).then(b=>H(this,null,function*(){try{const{producerId:x}=yield this._api.createProducer({botId:this._bot.id,transportId:t.id,forwardingId:this.forwardingId,producerOptions:b.producerOptions});b.callback({id:x})}catch(x){b.errback(x)}})).catch(b=>{ln.error("onProduce failed",b,this)}),ln.debug("[start] msTransport.produce",this);const S=yield t.msTransport.produce(f).catch(b=>{throw Oe({operationName:"Sender._produce",context:this._context,info:Se(ie({},Xt.internal),{detail:"msTransport.produce failed"}),path:ln.prefix,channel:this.channel,error:b})});return ln.debug("[end] msTransport.produce",this),this._producer=S,S})}_fixVideoCodecWithParametersOrder(e){const t=this._broadcasterTransport.msTransport._handler,n=i=>i.mimeType===e.mimeType?e.parameters&&Object.keys(e.parameters).length>0?!!(0,w1.default)(i.parameters,e.parameters):!0:!1,r=(i,a)=>{for(const o of Object.keys(i))o!=="payloadType"&&(i[o]=a[o])};if(t._sendingRtpParametersByKind){const i=t._sendingRtpParametersByKind.video,a=i.codecs.find(n);if(i&&a){const o=JSON.parse(JSON.stringify(i)),[u]=i.codecs,p=JSON.parse(JSON.stringify(u));r(u,a),r(a,p),ln.debug("sort _sendingRtpParametersByKind",{origin:o,new:i.codecs})}}if(t._sendingRemoteRtpParametersByKind){const i=t._sendingRemoteRtpParametersByKind.video,a=i.codecs.find(n);if(i&&a){const o=JSON.parse(JSON.stringify(i)),[u]=i.codecs,p=JSON.parse(JSON.stringify(u));r(u,a),r(a,p),ln.debug("sort _sendingRemoteRtpParametersByKind",{origin:o,new:i.codecs})}}}_setupTransportAccessForStream(e,t,n){e._getTransportCallbacks[this._bot.id]=()=>({rtcPeerConnection:t.pc,connectionState:t.connectionState,info:this}),e._getStatsCallbacks[this._bot.id]=()=>H(this,null,function*(){if(n.closed)return delete e._getStatsCallbacks[this._bot.id],[];const i=yield n.getStats();let a=No(i);return a=a.map(o=>(o.sfuTransportId=t.id,o)),a});const r=()=>{delete e._getTransportCallbacks[this._bot.id],delete e._getStatsCallbacks[this._bot.id]};return this._disposer.push(()=>{r()}),r}unproduce(){this._producer&&(this._producer.close(),this._producer=void 0,this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer))}_replaceTrack(e){return H(this,null,function*(){var t,n;yield(n=(t=this._producer)==null?void 0:t.replaceTrack)==null?void 0:n.call(t,{track:e}).catch(r=>{throw Oe({operationName:"Sender._replaceTrack",context:this._context,info:Xt.internal,error:r,path:ln.prefix,channel:this.channel})})})}close(){this.closed=!0,this._unsubscribeStreamEnableChange&&this._unsubscribeStreamEnableChange(),this._setConnectionState("disconnected"),this._disposer.dispose()}get pc(){var e;return(e=this._broadcasterTransport)==null?void 0:e.pc}startSendSubscriptionStatsReportTimer(){const e=this._localPerson._analytics,t=this._bot.subscriptions.find(n=>n.publication.id===this.publication.id);if(t&&e){const n=e.client.getIntervalSec();this.sendSubscriptionStatsReportTimer=setInterval(()=>H(this,null,function*(){if(!e||e.isClosed()){this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer);return}if(this._producer){const r=yield this._producer.getStats();r&&e.client.sendSubscriptionStatsReport(r,{subscriptionId:t.id,role:"sender",contentType:this.publication.contentType,createdAt:Date.now()})}}),n*1e3)}}},ai=new Ze("packages/sfu-bot/src/connection/index.ts"),yP=class{constructor(e,t,n,r,i,a){this._api=e,this.channel=t,this.localPerson=n,this.remoteMember=r,this._transportRepository=i,this._context=a,this.type="sfu",this.onDisconnect=new Ye,this.onClose=new Ye,this.closed=!1,this._receivers={},this._senders={}}addSender(e){const t=new vP(e,this.channel,this._api,this._transportRepository,this.localPerson,this.remoteMember,this.localPerson.iceManager,this._context);return this._senders[e.id]=t,t}removeSender(e){ai.debug("removeSender",e);const t=this._senders[e];t&&t.unproduce()}startSubscribing(e){return H(this,null,function*(){var t;const n=new mP(e,this._api,this._transportRepository,this.localPerson,this.remoteMember,this.localPerson.iceManager,this._context);this._receivers[e.id]=n;const r=ai.debug("[start] _startSubscribing consume"),{stream:i,codec:a}=yield n.consume().catch(o=>{throw ai.error("[failed] _startSubscribing consume",Oe({operationName:"SFUConnection.startSubscribing",context:this._context,channel:this.channel,info:Se(ie({},Xt.internal),{detail:"failed to receiver.consume"}),error:o,path:ai.prefix,payload:{subscription:e.toJSON()}})),o});if(ai.elapsed(r,"[end] _startSubscribing consume"),i.setIsEnabled(e.publication.state==="enabled"),e.codec=a,e._setStream(i),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const o=e.preferredEncoding,u=(t=e.publication.origin)==null?void 0:t.encodings;if(!o||!u||u.length===0)return;const p=Zf(o,u);this.localPerson._analytics.client.sendSubscriptionUpdatePreferredEncodingReport({subscriptionId:e.id,preferredEncodingIndex:p,updatedAt:Date.now()})}})}stopSubscribing(e){return H(this,null,function*(){const t=this._receivers[e.id];t&&t.unconsume()})}stopPublishing(e){return H(this,null,function*(){this.removeSender(e.id)})}close({reason:e}={}){this.closed||(ai.debug("close sfu connection",{remote:this.remoteMember,local:this.localPerson,reason:e}),this.closed=!0,Object.values(this._senders).forEach(t=>{t.close()}),Object.values(this._receivers).forEach(t=>{t.close()}),this._senders={},this._receivers={},this.onClose.emit())}_getReceiver(e){return this._receivers[e]}changePreferredEncoding(e){return H(this,null,function*(){var t;const n=e.preferredEncoding,r=(t=e.publication.origin)==null?void 0:t.encodings;if(ai.debug("changePreferredEncoding",{preferredEncoding:n,encodings:r,subscription:e}),!n)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Xt.invalidPreferredEncoding,path:ai.prefix,payload:{subscription:e}});if(!r||r.length===0)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Xt.invalidEncodings,path:ai.prefix,payload:{subscription:e}});const i=Zf(n,r),a=this._getReceiver(e.id);if(!a)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Xt.receiverNotFound,path:ai.prefix,payload:{subscription:e}});const o=a.transport;if(!o)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Se(ie({},Xt.internal),{detail:"transport not found"}),path:ai.prefix,payload:{subscription:e}});const u=a.consumer;if(!u)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Xt.consumerNotFound,path:ai.prefix,payload:{subscription:e}});yield this._api.changeConsumerLayer({transportId:o.id,consumerId:u.id,publicationId:e.publication.id,spatialLayer:i}),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendSubscriptionUpdatePreferredEncodingReport({subscriptionId:e.id,preferredEncodingIndex:i,updatedAt:Date.now()})})}};Y();Y();var _P=10,wr=new Ze("packages/sfu-bot/src/member.ts"),Ib=class Fb extends hh{constructor(t){super(t),this.side="remote",this.subtype=Fb.subtype,this.type="bot",this._connections={},this.onForwardingStarted=new Ye,this.onForwardingStopped=new Ye,this.onForwardingListChanged=new Ye,this._startForwardQueue=new ua,this._forwardings={},this.stopForwarding=n=>new Promise((r,i)=>H(this,null,function*(){const a=wr.info("[start] stopForwarding",yield kt({operationName:"SfuBotMember.stopForwarding",channel:this.channel}));if(this.state!=="joined"){i(Oe({operationName:"SfuBotMember.stopForwarding",context:this._context,info:Xt.sfuBotNotInChannel,path:wr.prefix,channel:this.channel,payload:{status:this.state}}));return}const o=typeof n=="string"?n:n.id,u=this._forwardings[o];if(!u){i(Oe({operationName:"SfuBotMember.stopForwarding",context:this._context,info:Xt.forwardingNotFound,path:wr.prefix,channel:this.channel,payload:{forwardingId:o,_forwardings:Object.keys(this._forwardings)}}));return}delete this._forwardings[u.id];const{promise:p,fulfilled:h}=this._api.stopForwarding({botId:this.id,forwardingId:o});let g=!1;p.catch(f=>{g=!0,i(f)}),this.onForwardingStopped.watch(f=>f.forwarding.id===o,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){wr.elapsed(a,"[end] stopForwarding",yield kt({operationName:"SfuBotMember.stopForwarding",channel:this.channel})),r()})).catch(f=>{g||i(Oe({operationName:"SfuBotMember.stopForwarding",context:this._context,info:Se(ie({},Xt.timeout),{detail:"onForwardingStopped"}),path:wr.prefix,channel:this.channel,payload:{fulfilled:h},error:f}))})})),this._api=t.api,this._context=t.context,this._transportRepository=t.transportRepository,this.options=t.options,this.onLeft.once(()=>{wr.debug("SfuBotMember left: ",{id:this.id}),Object.values(this._connections).forEach(n=>{n.close({reason:"sfu bot left"})}),this._connections={}})}get forwardings(){return Object.values(this._forwardings)}_getConnection(t){return this._connections[t]}_getOrCreateConnection(t){var n;return(n=this._getConnection(t.id))!=null?n:this._createConnection(this.channel,t,this)}_createConnection(t,n,r){const i=new yP(r._api,t,n,r,this._transportRepository,this._context);return i.onClose.once(()=>{delete this._connections[n.id]}),this._connections[n.id]=i,i}startForwarding(t){return H(this,arguments,function*(n,r={}){const i=wr.info("[start] startForwarding",yield kt({operationName:"SfuBotMember.startForwarding",channel:this.channel})),a=yield this._startForwardQueue.push(()=>this._startForwarding(n,r));return wr.elapsed(i,"[end] startForwarding",yield kt({operationName:"SfuBotMember.startForwarding",channel:this.channel})),a})}_startForwarding(t,n){return H(this,null,function*(){if(n.maxSubscribers==null&&(n.maxSubscribers=_P),this.state!=="joined")throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:Xt.sfuBotNotInChannel,path:wr.prefix,payload:{status:this.state}});if(!this.channel._getPublication(t.id))throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:qe.publicationNotExist,path:wr.prefix});const r=this.channel.localPerson;if(!r)throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:qe.localPersonNotJoinedChannel,path:wr.prefix});if(r.id!==t.publisher.id)throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,info:Xt.remotePublisherId,path:wr.prefix,channel:this.channel});const i=wr.debug("[start] SfuBotMember startForwarding",{publication:t.toJSON(),configure:n}),u=yield this._getOrCreateConnection(r).addSender(t).startForwarding(n).catch(p=>{throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,info:Se(ie({},Xt.internal),{detail:"[failed] SfuBotMember startForwarding"}),path:wr.prefix,channel:this.channel,error:p,payload:{publication:t.toJSON()}})});return this._forwardings[u.id]=u,this.listenStopForwardEvent(u),this.onForwardingStarted.emit({forwarding:u}),this.onForwardingListChanged.emit(),wr.elapsed(i,"[end] SfuBotMember startForwarding",{forwarding:u.toJSON()}),u})}listenStopForwardEvent(t){const{removeListener:n}=this.channel.onStreamUnpublished.add(r=>{if(r.publication.id===t.id){n(),t._stop();const i=t.originPublication,a=this._getConnection(i.publisher.id);a&&a.removeSender(i.id),this.onForwardingStopped.emit({forwarding:t}),this.onForwardingListChanged.emit()}})}_dispose(){}};Ib.subtype="sfu";var Oa=Ib;Y();var bP=Se(ie({},Ab),{endpointTimeout:3e4,ackTimeout:1e4,disableRestartIce:!1});Y();Y();var x1=$r(rx());Y();var Xn=new Ze("packages/sfu-bot/src/connection/transport/transport.ts"),SP=class{constructor(e,t,n,r,i,a){this.msTransport=e,this._bot=t,this._iceManager=n,this._sfuApi=r,this._context=i,this._analyticsSession=a,this._backoffIceRestart=new ki({times:8,interval:100,jitter:100}),this._connectionState="new",this.onProduce=new Ye,this.onProduceData=new Ye,this.onMediasoupConnectionStateChanged=new Ye,this.onConnectionStateChanged=new Ye,this.restartIce=()=>H(this,null,function*(){if(this._backoffIceRestart.exceeded){Xn.error("_iceRestartedCount exceeded",Oe({operationName:"SfuTransport.restartIce",context:this._context,info:Xt.netWorkError,path:Xn.prefix})),this._setConnectionState("disconnected");return}Xn.warn("[start] restartIce",Ca({bot:this._bot,detail:"start restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}}));const g=()=>{if(this._bot.state==="left")return Xn.debug("bot already left",this),this._setConnectionState("disconnected"),Xn.warn("[end] restartIce",Ca({bot:this._bot,detail:"end restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}})),!0;if(this.msTransport.connectionState==="connected")return this._backoffIceRestart.reset(),this._setConnectionState("connected"),Xn.warn("[end] restartIce",Ca({bot:this._bot,detail:"end restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}})),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"restartIce",data:void 0,createdAt:Date.now()}),!0};if(this._setConnectionState("reconnecting"),yield this._backoffIceRestart.wait(),g())return;let f=yield this._iceManager.updateIceParams().catch(w=>w);if(f){Xn.warn("updateIceParams failed",Ca({operationName:"SfuTransport.restartIce",detail:"updateIceParams failed",bot:this._bot,payload:{transport:this}}),f),yield this.restartIce();return}if(yield this.msTransport.updateIceServers({iceServers:this._iceManager.iceServers}),g())return;const _=yield this._mediasoupRestartIce();if(f=yield this._waitForMsConnectionState("connected",this._context.config.rtcConfig.iceDisconnectBufferTimeout).catch(w=>w),!f&&g())return _;yield this.restartIce()}),this._waitForMsConnectionState=(g,f=1e4)=>H(this,null,function*(){g!==this.msTransport.connectionState&&(yield this.onMediasoupConnectionStateChanged.watch(()=>g===this.msTransport.connectionState,f).catch(_=>{throw Oe({operationName:"SfuTransport._waitForMsConnectionState",context:this._context,info:Se(ie({},Xt.timeout),{detail:"waitForConnectionState timeout"}),error:_,path:Xn.prefix})}))}),this._onConnect=g=>(f,_,w)=>H(this,[f,_,w],function*({dtlsParameters:C},R,S){try{Xn.debug("[start] transport connect",{transportId:g}),yield this._sfuApi.connect({transportId:g,dtlsParameters:C}),Xn.debug("[end] transport connect",{transportId:g}),R()}catch(b){Xn.error("[failed] transport connect",{error:b,transportId:g}),S(b)}});var o,u,p;const h=i.plugins.find(g=>g.subtype===ph.subtype);this._options=h.options,Xn.debug("peerConfig",(p=(u=(o=this.pc)==null?void 0:o.getConfiguration)==null?void 0:u.call(o))!=null?p:{}),e.on("connect",(g,f,_)=>this._onConnect(e.id)(g,f,_)),e.on("connectionstatechange",g=>{this.onMediasoupConnectionStateChanged.emit(g),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"connectionStateChange",data:{connectionState:g},createdAt:Date.now()})}),e.on("produce",(g,f,_)=>{this.onProduce.emit({producerOptions:g,callback:f,errback:_})}),e.on("producedata",(g,f,_)=>{this.onProduceData.emit({producerOptions:g,callback:f,errback:_})}),this.onMediasoupConnectionStateChanged.add(g=>H(this,null,function*(){switch(kt({operationName:"onMediasoupConnectionStateChanged",channel:this._bot.channel}).then(f=>{Xn.debug(f,{state:g,transportId:this.id,bot:t})}).catch(()=>{}),g){case"disconnected":case"failed":{if(this._connectionState==="reconnecting")return;(yield this._waitForMsConnectionState("connected",i.config.rtcConfig.iceDisconnectBufferTimeout).catch(_=>_))&&this._connectionState!=="reconnecting"&&t.options.disableRestartIce!==!0&&(yield this.restartIce())}break;case"connecting":case"connected":this._setConnectionState(g);break;case"closed":this._setConnectionState("disconnected");break}Xn.debug("onMediasoupConnectionStateChanged",this)}))}get pc(){var e,t,n;return(n=(t=(e=this.msTransport)==null?void 0:e._handler)==null?void 0:t._pc)!=null?n:{}}get id(){return this.msTransport.id}get connectionState(){return this._connectionState}toJSON(){return{id:this.id,direction:this.msTransport.direction,connectionState:this._connectionState}}close(){var e;Xn.debug("close",this.id),(e=this.pc)!=null&&e.peerIdentity&&this.pc.peerIdentity.catch(()=>{}),this.msTransport.close(),this._setConnectionState("disconnected")}_setConnectionState(e){this._connectionState!==e&&(Xn.debug("onConnectionStateChanged",this._connectionState,e,this),this._connectionState=e,this.onConnectionStateChanged.emit(e),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"skywayConnectionStateChange",data:{skywayConnectionState:e},createdAt:Date.now()}))}_mediasoupRestartIce(){return H(this,null,function*(){const e=yield this._sfuApi.iceRestart({transportId:this.id}).catch(t=>t);if(e instanceof Error){Xn.warn("iceRestart failed",Ca({operationName:"SfuTransport._mediasoupRestartIce",detail:"iceRestart failed",bot:this._bot,payload:{transport:this}}),e),yield this.restartIce();return}return yield this.msTransport.restartIce({iceParameters:e}),e})}},Ip=new Ze("packages/sfu-bot/src/connection/transport/transportRepository.ts"),wP=class{constructor(e,t){this._context=e,this._api=t,this.onTransportCreated=new Ye,this._transports={},this.getTransport=(i,a)=>this._transports[i+a];const{browserName:n,browserVersion:r}=H_();Ip.debug("runtime info",{browserName:n,browserVersion:r}),n==="Safari"&&r==null?this._device=new x1.Device({handlerName:"Safari12"}):this._device=new x1.Device}get rtpCapabilities(){if(this._device.loaded)return this._device.rtpCapabilities}loadDevice(e){return H(this,null,function*(){this._device.loaded||(yield this._device.load({routerRtpCapabilities:e}).catch(t=>{throw Oe({operationName:"TransportRepository.loadDevice",context:this._context,info:Se(ie({},Xt.internal),{detail:"loadDevice failed"}),path:Ip.prefix,payload:{rtpCapabilities:e},error:t})}),Ip.debug("device loaded",{routerRtpCapabilities:e,rtpCapabilities:this._device.rtpCapabilities}))})}createTransport(e,t,n,r,i,a){const u=(r==="send"?h=>this._device.createSendTransport(h):h=>this._device.createRecvTransport(h))(Se(ie({},n),{iceServers:i.iceServers,iceTransportPolicy:this._context.config.rtcConfig.turnPolicy==="turnOnly"?"relay":void 0,additionalSettings:this._context.config.rtcConfig})),p=new SP(u,t,i,this._api,this._context,a);return this._transports[e+u.id]=p,this.onTransportCreated.emit(u.id),p}deleteTransports(e){Object.entries(ie({},this._transports)).forEach(([t,n])=>{t.includes(e)&&(n.close(),delete this._transports[t])})}};Y();var xP="1.14.2",_a=new Ze("packages/sfu-bot/src/plugin.ts"),Db=class Nb extends og{constructor(t={}){super(),this.subtype=Nb.subtype,this._createRemoteMember=(n,r)=>new Oa(Se(ie({},this._context),{channel:n,id:r.id,name:r.name,metadata:r.metadata,plugin:this,api:this._api,context:this._context,transportRepository:this._transportRepository,options:this.options})),this.createBot=n=>H(this,null,function*(){var r;const i=_a.info("[start] createBot",yield kt({operationName:"SfuBotPlugin.createBot",channel:n})),a=this._context.authToken.getAppId(),o=yield this._api.createBot({appId:a,channelId:n.id}),u=(r=n._getMember(o))!=null?r:(yield n.onMemberJoined.watch(p=>p.member.id===o,this._context.config.rtcApi.timeout).catch(p=>{throw Oe({operationName:"SfuBotPlugin.createBot",info:Se(ie({},Xt.timeout),{detail:"onMemberJoined"}),path:_a.prefix,error:p,context:this._context})})).member;return _a.elapsed(i,"[end] createBot",yield kt({operationName:"SfuBotPlugin.createBot",channel:n})),u}),this.deleteBot=(n,r)=>H(this,null,function*(){return new Promise((i,a)=>H(this,null,function*(){const o=_a.info("[start] deleteBot",yield kt({operationName:"SfuBotPlugin.deleteBot",channel:n}));let u=!1;this._api.deleteBot({botId:r}).catch(p=>{u=!0,a(p)}),n.onMemberLeft.watch(p=>p.member.id===r,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){_a.elapsed(o,"[end] deleteBot",yield kt({operationName:"SfuBotPlugin.deleteBot",channel:n})),i()})).catch(p=>{u||a(Oe({operationName:"SfuBotPlugin.deleteBot",info:Se(ie({},Xt.timeout),{detail:"onMemberLeft"}),path:_a.prefix,channel:n,error:p,context:this._context}))})}))}),this.options=ie(ie({},bP),t),this._onContextAttached.once(n=>{Ze.level=n.config.log.level,Ze.format=n.config.log.format,_a.info("SfuBotPlugin spawned",{operationName:"SfuBotPlugin.constructor",endpoint:{sfu:this.options.domain},options:this.options,sdkName:"sfu-bot",sdkVersion:xP}),this._api=new fP(n.authTokenString,Se(ie({},this.options),{log:n.config.log})),this._transportRepository=new wP(n,this._api),n._onTokenUpdated.add(r=>{this._api.updateToken(r)})}),this._whenDisposeLocalPerson=n=>H(this,null,function*(){this._transportRepository.deleteTransports(n.id)})}};Db.subtype=Oa.subtype;var ph=Db,CP={invalidParameter:{name:"invalidParameter",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internal:{name:"internal",detail:"",solution:""},notImplemented:{name:"notImplemented",detail:"RoomType",solution:"RoomType"},roomNotOpened:{name:"roomNotOpened",detail:"RoomOpen",solution:"Room"},subscribeOtherMemberType:{name:"subscribeOtherMemberType",detail:"RemoteMemberSubscribe/UnsubscribeMemberTypePerson",solution:"RemoteMember"},sfuRoomNotSupportDataStream:{name:"sfuRoomNotSupportDataStream",detail:"SFURoomDataStream",solution:""},publicationNotHasOrigin:{name:"publicationNotHasOrigin",detail:"SfuRoomPublicationOrigin",solution:"SfuRoomP2PRoomID"},notFound:{name:"notFound",detail:"",solution:""}},kr=ie(ie(ie({},qe),Xt),CP);Y();var Ob=class{constructor(e,t){this.member=e,this.room=t,this.onLeft=new Ye;const{removeListener:n}=t.onMemberLeft.add(r=>{r.member.id===this.member.id&&(n(),this.onLeft.emit())});this.onMetadataUpdated=e.onMetadataUpdated}get id(){return this.member.id}get name(){return this.member.name}get roomId(){return this.room.id}get roomName(){return this.room.name}get roomType(){return this.room.type}get state(){return this.member.state}get metadata(){return this.member.metadata}get _member(){return this.member}get publications(){return this.room.publications.filter(e=>e.publisher.id===this.id)}get subscriptions(){return this.member.subscriptions.map(e=>this.room._getSubscription(e.id))}updateMetadata(e){return this.member.updateMetadata(e)}leave(){return this.member.leave()}toJSON(){return{id:this.id,name:this.name,metadata:this.metadata}}};Y();var Mb=class extends Ob{constructor(e,t){super(e,t),this.side="local",this._local=this._member,this.onStreamPublished=new Ye,this.onStreamUnpublished=new Ye,this.onPublicationListChanged=new Ye,this.onPublicationSubscribed=new Ye,this.onPublicationUnsubscribed=new Ye,this.onSubscriptionListChanged=new Ye,this.onFatalError=new Ye,this._context=this.room._context,this._local.onPublicationSubscribed.add(n=>H(this,null,function*(){const r=t._addSubscription(n.subscription);this.onPublicationSubscribed.emit({subscription:r,stream:n.stream})})),this._local.onFatalError.pipe(this.onFatalError),this._listenRoomEvent(),this.onStreamPublished.add(()=>this.onPublicationListChanged.emit()),this.onStreamUnpublished.add(()=>this.onPublicationListChanged.emit()),this.onPublicationSubscribed.add(()=>this.onSubscriptionListChanged.emit()),this.onPublicationUnsubscribed.add(()=>this.onSubscriptionListChanged.emit())}get subscriptions(){return this.member.subscriptions.map(e=>this.room._getSubscription(e.id)).filter(e=>e.stream)}_listenRoomEvent(){this.room.onPublicationUnsubscribed.add(e=>{e.subscription.subscriber._member.id===this._local.id&&this.onPublicationUnsubscribed.emit(e)})}};Y();Y();function Pr({operationName:e,context:t,info:n,error:r,path:i,payload:a,room:o}){const u={operationName:e,payload:a};return o&&(u.appId=o._channel.appId,u.roomId=o.id,o.localRoomMember&&(u.memberId=o.localRoomMember.id)),t&&(u.info=t.info,u.plugins=t.plugins.map(p=>p.subtype)),new Er({error:r,info:n,payload:u,path:i})}var Sc=new Ze("packages/room/src/member/local/p2p.ts"),EP=class extends Mb{constructor(e,t){super(e,t)}publish(e){return H(this,arguments,function*(t,n={}){const r=yield this._local.publish(t,n),i=this.room._addPublication(r);return this.onStreamPublished.emit({publication:i}),i})}unpublish(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unpublish(t).catch(r=>{Sc.error("unpublish",r,{target:e},this.toJSON())});const{publication:n}=yield this.room.onStreamUnpublished.watch(r=>r.publication.id===t,this._context.config.rtcApi.timeout).catch(r=>{throw Pr({operationName:"LocalP2PRoomMemberImpl.unpublish",context:this._context,room:this.room,info:Se(ie({},kr.timeout),{detail:"onStreamUnpublished"}),path:Sc.prefix,error:r})});this.onStreamUnpublished.emit({publication:n})})}subscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id,{subscription:n,stream:r}=yield this._local.subscribe(t);return{subscription:this.room._addSubscription(n),stream:r}})}unsubscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unsubscribe(t).catch(n=>{Sc.error("unsubscribe",n,{target:e},this.toJSON())}),yield this.room.onPublicationUnsubscribed.watch(n=>n.subscription.id===t,this._context.config.rtcApi.timeout).catch(n=>{throw Pr({operationName:"LocalP2PRoomMemberImpl.unsubscribe",context:this._context,room:this.room,info:Se(ie({},kr.timeout),{detail:"onPublicationUnsubscribed"}),path:Sc.prefix,error:n})})})}_updateRoom(e){Sc.debug("_updateRoom",{memberId:this.id}),this.room=e,this._listenRoomEvent()}};Y();Y();var PP=10,Os=new Ze("packages/room/src/member/local/sfu.ts"),kP=class extends Mb{constructor(e,t){super(e,t)}publish(e){return H(this,arguments,function*(t,n={}){var r;if(t instanceof sg)throw Pr({operationName:"LocalSFURoomMemberImpl.publish",context:this._context,room:this.room,info:kr.sfuRoomNotSupportDataStream,path:Os.prefix});n.maxSubscribers=(r=n.maxSubscribers)!=null?r:PP;const i=yield this._local.publish(t,n),a=this.room._channel.members.find(h=>h.subtype===Oa.subtype);if(!a)throw Pr({operationName:"LocalSFURoomMemberImpl.publish",context:this._context,room:this.room,info:Xt.sfuBotNotInChannel,path:Os.prefix});const u=(yield a.startForwarding(i,{maxSubscribers:n.maxSubscribers})).relayingPublication,p=this.room._addPublication(u);return this.onStreamPublished.emit({publication:p}),p})}unpublish(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id,n=this.room._getPublication(t),r=n._publication.origin;if(!r)throw Pr({operationName:"LocalSFURoomMemberImpl.unpublish",context:this._context,room:this.room,info:kr.publicationNotHasOrigin,path:Os.prefix});this._local.unpublish(r.id).catch(i=>{Os.error("unpublish error",i,{target:e},this.toJSON())}),yield this.room.onStreamUnpublished.watch(i=>i.publication.id===t,this._context.config.rtcApi.timeout).catch(i=>{throw Pr({operationName:"LocalSFURoomMemberImpl.unpublish",context:this._context,room:this.room,info:Se(ie({},kr.timeout),{detail:"onStreamUnpublished"}),path:Os.prefix,error:i})}),this.onStreamUnpublished.emit({publication:n})})}subscribe(e,t){return H(this,null,function*(){const n=typeof e=="string"?e:e.id,{subscription:r,stream:i}=yield this._local.subscribe(n,t);return{subscription:this.room._addSubscription(r),stream:i}})}unsubscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unsubscribe(t).catch(n=>{Os.error("unsubscribe error",n,{target:e},this.toJSON())}),yield this.room.onPublicationUnsubscribed.watch(n=>n.subscription.id===t,this._context.config.rtcApi.timeout).catch(n=>{throw Pr({operationName:"LocalSFURoomMemberImpl.unsubscribe",context:this._context,room:this.room,info:Se(ie({},kr.timeout),{detail:"onPublicationUnsubscribed"}),path:Os.prefix,error:n})})})}_updateRoom(e){Os.debug("_updateRoom",{memberId:this.id}),this.room=e,this._listenRoomEvent()}};Y();var C1=new Ze("packages/room/src/member/remote/base.ts"),Td=class extends Ob{constructor(e,t){super(e,t),this.side="remote",this.onPublicationSubscribed=new Ye,this.onPublicationUnsubscribed=new Ye,this.onSubscriptionListChanged=new Ye,this.onPublicationListChanged=new Ye,this._disposer=new ni,this.subscribe=n=>new Promise((r,i)=>{if(!(this.member instanceof qu)){i(Pr({operationName:"RemoteRoomMemberImpl.subscribe",context:this.room._context,room:this.room,info:kr.subscribeOtherMemberType,path:C1.prefix}));return}let a=!1;this.member.subscribe(n).catch(o=>{a=!0,i(o)}),this.onPublicationSubscribed.watch(o=>o.subscription.publication.id===n).then(o=>r(o)).catch(o=>{a||i(o)})}),this.unsubscribe=n=>new Promise((r,i)=>{if(!(this.member instanceof qu)){i(Pr({operationName:"RemoteRoomMemberImpl.unsubscribe",context:this.room._context,room:this.room,info:kr.subscribeOtherMemberType,path:C1.prefix}));return}let a=!1;this.member.unsubscribe(n).catch(o=>{a=!0,i(o)}),this.onPublicationUnsubscribed.watch(o=>o.subscription.id===n).then(()=>r()).catch(o=>{a||i(o)})}),t.onPublicationSubscribed.add(n=>{n.subscription.subscriber._member.id===e.id&&(this.onPublicationSubscribed.emit(n),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),t.onPublicationUnsubscribed.add(n=>{n.subscription.subscriber._member.id===e.id&&(this.onPublicationUnsubscribed.emit(n),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),e instanceof qu&&e.onPublicationListChanged.pipe(this.onPublicationListChanged).disposer(this._disposer)}_dispose(){this._disposer.dispose()}};Y();var zu="packages/room/src/publication/index.ts",E1=new Ze(zu),TP=class{constructor(e,t){this._publication=e,this._room=t,this._disposer=new ni,this._events=new es,this.onCanceled=this._events.make(),this.onSubscribed=this._events.make(),this.onUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onEnabled=this._events.make(),this.onDisabled=this._events.make(),this.onStateChanged=this._events.make(),this.onConnectionStateChanged=new Ye,this.enable=()=>new Promise((r,i)=>{if(this.state==="enabled"){r();return}this._origin?Promise.all([this._origin.enable(),this._publication.onEnabled.asPromise()]).then(()=>r()).catch(i):this._publication.enable().then(r).catch(i)}),this.disable=()=>new Promise((r,i)=>{if(this.state==="disabled"){r();return}this._origin?Promise.all([this._origin.disable(),this._publication.onDisabled.asPromise()]).then(()=>r()).catch(i):this._publication.disable().then(r).catch(i)}),this.replaceStream=(r,i={})=>{this._preferredPublication.replaceStream(r,i)};var n;this.id=e.id,this.contentType=e.contentType,this._origin=e.origin;{const r=(n=this._origin)!=null?n:this._publication;this.publisher=this._room._getMember(r.publisher.id)}this._setEvents()}_setEvents(){var e;this._room.onStreamUnpublished.add(t=>{t.publication.id===this.id&&this._dispose()}),this._room.onPublicationSubscribed.add(t=>{t.subscription.publication.id===this.id&&(this.onSubscribed.emit({subscription:t.subscription}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this._room.onPublicationUnsubscribed.add(t=>{t.subscription.publication.id===this.id&&(this.onUnsubscribed.emit({subscription:t.subscription}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this._publication.onEnabled.pipe(this.onEnabled),this._publication.onDisabled.pipe(this.onDisabled),this._publication.onStateChanged.pipe(this.onStateChanged),((e=this._origin)!=null?e:this._publication).onMetadataUpdated.pipe(this.onMetadataUpdated),this._origin?this._origin.onConnectionStateChanged.add(t=>{E1.debug("this._origin.onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit({state:t.state})}):this._publication.onConnectionStateChanged.add(t=>{E1.debug("this._publication.onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit({state:t.state,remoteMember:this._room._getMember(t.remoteMember.id)})})}get subscriptions(){return this._publication.subscriptions.map(e=>this._room._getSubscription(e.id))}get _preferredPublication(){var e;return(e=this._origin)!=null?e:this._publication}get codecCapabilities(){return this._preferredPublication.codecCapabilities}get encodings(){return this._preferredPublication.encodings}get stream(){return this._preferredPublication.stream}get state(){return this._preferredPublication.state}get metadata(){return this._preferredPublication.metadata}cancel(){return H(this,null,function*(){yield Promise.all([this._preferredPublication.cancel(),this.onCanceled.asPromise()])})}updateMetadata(e){return H(this,null,function*(){yield this._preferredPublication.updateMetadata(e)})}updateEncodings(e){this._preferredPublication.updateEncodings(e)}_dispose(){this.onCanceled.emit(),this._events.dispose(),this._disposer.dispose()}getStats(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Oa.subtype))==null?void 0:t.subscriber;if(!n)throw Pr({operationName:"RoomPublicationImpl.getStats",room:this._room,path:zu,info:Se(ie({},kr.notFound),{detail:"bot not found"})});return this._origin.getStats(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getStats(n)}}getRTCPeerConnection(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Oa.subtype))==null?void 0:t.subscriber;if(!n)throw Pr({operationName:"RoomPublicationImpl.getRTCPeerConnection",room:this._room,path:zu,info:Se(ie({},kr.notFound),{detail:"bot not found"})});return this._origin.getRTCPeerConnection(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getRTCPeerConnection(n)}}getConnectionState(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Oa.subtype))==null?void 0:t.subscriber;if(!n)throw Pr({operationName:"RoomPublicationImpl.getConnectionState",room:this._room,path:zu,info:Se(ie({},kr.notFound),{detail:"bot not found"})});return this._origin.getConnectionState(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getConnectionState(n)}}toJSON(){return{id:this.id,contentType:this.contentType,metadata:this.metadata,publisher:this.publisher,subscriptions:this.subscriptions,codecCapabilities:this.codecCapabilities,encodings:this.encodings,state:this.state}}};Y();Y();var RP="1.15.1";Y();Y();Y();var Fp=new Ze("packages/room/src/subscription/index.ts"),AP=class{constructor(e,t){this._subscription=e,this._room=t,this._context=this._room._context,this.onStreamAttached=new Ye,this.onCanceled=new Ye,this.onConnectionStateChanged=new Ye,this.id=e.id,this.contentType=e.contentType,this.publication=this._room._getPublication(e.publication.id),this.subscriber=this._room._getMember(e.subscriber.id),e.onStreamAttached.pipe(this.onStreamAttached),e.onCanceled.pipe(this.onCanceled),e.onConnectionStateChanged.add(n=>{Fp.debug("_subscription.onConnectionStateChanged",this.id,n),this.onConnectionStateChanged.emit(n)})}get stream(){return this._subscription.stream}get state(){return this._subscription.state}get codec(){return this._subscription.codec}get preferredEncoding(){return this._subscription.preferredEncoding}changePreferredEncoding(e){this._subscription.changePreferredEncoding(e)}cancel(){return H(this,null,function*(){this._subscription.cancel().catch(e=>{Fp.error("subscription.cancel",e,this.toJSON())}),yield this._room.onPublicationUnsubscribed.watch(e=>e.subscription.id===this.id,this._context.config.rtcApi.timeout).catch(e=>{throw Pr({operationName:"RoomSubscriptionImpl.cancel",context:this._context,room:this._room,info:Se(ie({},kr.timeout),{detail:"onPublicationUnsubscribed"}),error:e,path:Fp.prefix})})})}toJSON(){return{id:this.id,contentType:this.contentType,publication:this.publication,codec:this.codec}}getStats(){return this._subscription.getStats()}getRTCPeerConnection(){return this._subscription.getRTCPeerConnection()}getConnectionState(){return this._subscription.getConnectionState()}},P1=new Ze("packages/room/src/room/base.ts"),Lb=class{constructor(e,t){this._channel=t,this._members={},this._publications={},this._subscriptions={},this._context=this._channel._context,this._events=new es,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.type=e,this._channel.onClosed.pipe(this.onClosed),this._channel.onMetadataUpdated.pipe(this.onMetadataUpdated),this._channel.onMemberMetadataUpdated.add(n=>{this._handleOnMemberMetadataUpdate(n)})}_getMember(e){return this._members[e]}_getPublication(e){return this._publications[e]}_addPublication(e){const t=this._publications[e.id];if(t)return t;const n=new TP(e,this);return this._publications[e.id]=n,n}_getSubscription(e){return this._subscriptions[e]}_addSubscription(e){const t=this._subscriptions[e.id];if(t)return t;const n=new AP(e,this);return this._subscriptions[e.id]=n,n}get id(){return this._channel.id}get name(){return this._channel.name}get metadata(){return this._channel.metadata}get state(){return this._channel.state}get disposed(){return this._channel.disposed}_handleOnMemberMetadataUpdate(e){const t=this._getMember(e.member.id);this.onMemberMetadataUpdated.emit({member:t,metadata:e.metadata})}get members(){return Object.values(this._members)}get publications(){return Object.values(this._publications)}get subscriptions(){return Object.values(this._subscriptions)}joinChannel(){return H(this,arguments,function*(e={}){var t;if(this.state!=="opened")throw Pr({operationName:"RoomImpl.joinChannel",context:this._context,room:this,info:kr.roomNotOpened,path:P1.prefix});e.name=(t=e.name)!=null?t:ji();const n=yield this._channel.join(e);return this._getMember(n.id)||(yield this.onMemberJoined.watch(r=>r.member._member.id===n.id,this._context.config.rtcApi.timeout).catch(r=>{throw Pr({operationName:"RoomImpl.joinChannel",context:this._context,room:this,info:Se(ie({},kr.timeout),{detail:"RoomImpl onMemberJoined"}),path:P1.prefix,error:r})})),n})}leave(e){return H(this,null,function*(){yield this._channel.leave(e._member)})}moveRoom(e){return H(this,null,function*(){return yield this._channel.moveChannel(e._local),e._updateRoom(this),e})}updateMetadata(e){return this._channel.updateMetadata(e)}close(){return H(this,null,function*(){yield this._channel.close()})}dispose(){return H(this,null,function*(){return this._channel.dispose()})}toJSON(){return{type:this.type,id:this.id,name:this.name,metadata:this.metadata,members:this.members,publications:this.publications,subscriptions:this.subscriptions}}},IP=new Ze("packages/room/src/room/p2p.ts"),FP=class extends Lb{constructor(e){super("p2p",e),this.setChannelState(),this.setChannelListener()}setChannelState(){this._channel.members.forEach(e=>{const t=new Td(e,this);this._members[e.id]=t}),this._channel.publications.forEach(e=>{this._addPublication(e)}),this._channel.subscriptions.forEach(e=>{this._addSubscription(e)})}setChannelListener(){this._channel.onMemberJoined.add(e=>this._handleOnMemberJoin(e.member)),this._channel.onMemberLeft.add(e=>this._handleOnMemberLeft(e.member)),this._channel.onStreamPublished.add(e=>this._handleOnStreamPublish(e.publication)),this._channel.onStreamUnpublished.add(e=>this._handleOnStreamUnpublish(e.publication)),this._channel.onPublicationMetadataUpdated.add(e=>{this._handleOnPublicationMetadataUpdate(e.publication)}),this._channel.onPublicationEnabled.add(e=>{this._handleOnPublicationEnabled(e.publication)}),this._channel.onPublicationDisabled.add(e=>{this._handleOnPublicationDisabled(e.publication)}),this._channel.onPublicationSubscribed.add(e=>this._handleOnStreamSubscribe(e.subscription)),this._channel.onPublicationUnsubscribed.add(e=>this._handleOnStreamUnsubscribe(e.subscription))}_handleOnMemberJoin(e){if(this._getMember(e.id))return;const t=new Td(e,this);this._members[e.id]=t,this.onMemberJoined.emit({member:t}),this.onMemberListChanged.emit({})}_handleOnMemberLeft(e){const t=this._getMember(e.id);delete this._members[e.id],t._dispose(),this.onMemberLeft.emit({member:t}),this.onMemberListChanged.emit({})}_handleOnStreamPublish(e){if(this._getPublication(e.id))return;const t=this._addPublication(e);this.onStreamPublished.emit({publication:t}),this.onPublicationListChanged.emit({})}_handleOnStreamUnpublish(e){const t=this._getPublication(e.id);delete this._publications[e.id],this.onStreamUnpublished.emit({publication:t}),this.onPublicationListChanged.emit({})}_handleOnPublicationMetadataUpdate(e){const t=this._getPublication(e.id);this.onPublicationMetadataUpdated.emit({publication:t,metadata:t.metadata})}_handleOnPublicationEnabled(e){const t=this._getPublication(e.id);this.onPublicationEnabled.emit({publication:t})}_handleOnPublicationDisabled(e){const t=this._getPublication(e.id);this.onPublicationDisabled.emit({publication:t})}_handleOnStreamSubscribe(e){if(this._getSubscription(e.id))return;const t=this._addSubscription(e);this.onPublicationSubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit({})}_handleOnStreamUnsubscribe(e){const t=this._getSubscription(e.id);delete this._subscriptions[e.id],this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit({})}join(){return H(this,arguments,function*(e={}){const t=yield this.joinChannel(e),n=new EP(t,this);return IP.debug("member joined",e),this.localRoomMember=n,n.onLeft.once(()=>{this.localRoomMember=void 0}),n})}};Y();var DP=new Ze("packages/room/src/room/sfu.ts"),NP=class jb extends Lb{constructor(t,n){super("sfu",t),this._plugin=n,this.setChannelState(),this.setChannelListener()}static Create(t,n){return H(this,null,function*(){const r=t.plugins.find(o=>o.subtype==="sfu");return n.members.find(o=>o.subtype===Oa.subtype)||(yield r.createBot(n)),new jb(n,r)})}setChannelState(){this._channel.members.forEach(t=>{if(t.type==="bot")return;const n=new Td(t,this);this._members[t.id]=n}),this._channel.publications.forEach(t=>{t.origin&&this._addPublication(t)}),this._channel.subscriptions.forEach(t=>{t.subscriber.type!=="bot"&&this._addSubscription(t)})}setChannelListener(){this._channel.onMemberJoined.add(t=>this._handleOnMemberJoin(t.member)),this._channel.onMemberLeft.add(t=>this._handleOnMemberLeft(t.member)),this._channel.onStreamPublished.add(t=>{this._handleOnStreamPublish(t.publication)}),this._channel.onStreamUnpublished.add(t=>this._handleOnStreamUnpublish(t.publication)),this._channel.onPublicationMetadataUpdated.add(t=>{this._handleOnPublicationMetadataUpdate(t.publication)}),this._channel.onPublicationEnabled.add(t=>{this._handleOnPublicationEnabled(t.publication)}),this._channel.onPublicationDisabled.add(t=>{this._handleOnPublicationDisabled(t.publication)}),this._channel.onPublicationSubscribed.add(t=>{this._handleOnStreamSubscribe(t.subscription)}),this._channel.onPublicationUnsubscribed.add(t=>this._handleOnStreamUnsubscribe(t.subscription))}_handleOnMemberJoin(t){if(t.type==="bot")return;const n=new Td(t,this);this._members[t.id]=n,this.onMemberJoined.emit({member:n}),this.onMemberListChanged.emit({})}_handleOnMemberLeft(t){const n=this._getMember(t.id);n&&(delete this._members[t.id],n._dispose(),this.onMemberLeft.emit({member:n}),this.onMemberListChanged.emit({}))}_handleOnStreamPublish(t){var n;if(!((n=t.origin)!=null&&n.id))return;const r=this._addPublication(t);this.onStreamPublished.emit({publication:r}),this.onPublicationListChanged.emit({})}_handleOnStreamUnpublish(t){var n;if(!((n=t.origin)!=null&&n.id))return;const r=this._getPublication(t.id);delete this._publications[t.id],this.onStreamUnpublished.emit({publication:r}),this.onPublicationListChanged.emit({})}_getRelayedPublication(t){return this.publications.find(r=>{var i;return((i=r._publication.origin)==null?void 0:i.id)===t})}_handleOnPublicationMetadataUpdate(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationMetadataUpdated.emit({publication:n,metadata:n.metadata})}_handleOnPublicationEnabled(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationEnabled.emit({publication:n})}_handleOnPublicationDisabled(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationDisabled.emit({publication:n})}_handleOnStreamSubscribe(t){if(t.subscriber.type==="bot")return;const n=this._addSubscription(t);this.onPublicationSubscribed.emit({subscription:n}),this.onSubscriptionListChanged.emit({})}_handleOnStreamUnsubscribe(t){if(t.subscriber.type==="bot")return;const n=this._getSubscription(t.id);delete this._subscriptions[t.id],this.onPublicationUnsubscribed.emit({subscription:n}),this.onSubscriptionListChanged.emit({})}join(){return H(this,arguments,function*(t={}){const n=yield this.joinChannel(Se(ie({},t),{disableSignaling:!0})),r=new kP(n,this);return this.localRoomMember=r,r.onLeft.once(()=>{this.localRoomMember=void 0}),DP.debug("member joined",t),r})}},Bb=new Ze("packages/room/src/room/index.ts"),sa=class{constructor(){}};sa.Create=(e,t)=>H(null,null,function*(){var n,r;Bb.info("room created",{operationName:"SkyWayRoom._Factory",sdkName:"room",sdkVersion:RP,init:t});const i=new ph((n=t==null?void 0:t.options)==null?void 0:n.sfu);e.registerPlugin(i);const a=yield ag.Create(e,{name:(r=t.name)!=null?r:ji(),metadata:t.metadata});return yield sa._Factory(e,t.type,a)});sa.Find=(e,t,n,r)=>H(null,null,function*(){const i=new ph(r==null?void 0:r.sfu);e.registerPlugin(i);const a=yield ag.Find(e,t);return yield sa._Factory(e,n,a)});sa.FindOrCreate=(e,t)=>H(null,null,function*(){var n;const r=new ph((n=t==null?void 0:t.options)==null?void 0:n.sfu);e.registerPlugin(r);const i=yield ag.FindOrCreate(e,ie({},t));return yield sa._Factory(e,t.type,i)});sa._Factory=(e,t,n)=>H(null,null,function*(){switch(t){case"p2p":return new FP(n);case"sfu":return yield NP.Create(e,n);default:throw Oe({operationName:"SkyWayRoom._Factory",context:e,channel:n,info:kr.notImplemented,path:Bb.prefix})}});var OP=sa;Y();/*! Bundled license information:

jsrsasign/lib/jsrsasign.js:
  (*! CryptoJS v3.1.2 core-fix.js
   * code.google.com/p/crypto-js
   * (c) 2009-2013 by Jeff Mott. All rights reserved.
   * code.google.com/p/crypto-js/wiki/License
   * THIS IS FIX of 'core.js' to fix Hmac issue.
   * https://code.google.com/p/crypto-js/issues/detail?id=84
   * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
   *)
  (*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
   *)
  (*! (c) Tom Wu, Kenji Urushima | http://www-cs-students.stanford.edu/~tjw/jsbn/
   *)
  (*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
   *)
  (*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
   *)
*/var wt=Id();const Ub=Qf(wt),MP=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Hb=e=>Array.isArray(e)&&e.every(t=>typeof t=="object"&&!(t instanceof Array)),LP=e=>Array.isArray(e)&&e.every(t=>Array.isArray(t)),jP=e=>Array.from(e.map(t=>Object.keys(t)).reduce((t,n)=>new Set([...t,...n]),[])),BP=(e,t)=>{t=t||jP(e);let n=t,r=t;Hb(t)&&(n=t.map(a=>a.label),r=t.map(a=>a.key));const i=e.map(a=>r.map(o=>UP(o,a)));return[n,...i]},UP=(e,t)=>{const n=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(r,i,a,o){const u=r[i];if(u==null)o.splice(1);else return u},t);return n===void 0?e in t?t[e]:"":n},HP=e=>typeof e>"u"||e===null?"":e,Vb=(e,t=",",n='"')=>e.filter(r=>r).map(r=>r.map(i=>HP(i)).map(i=>`${n}${i}${n}`).join(t)).join(`
`),VP=(e,t,n,r)=>Vb(t?[t,...e]:e,n,r),qP=(e,t,n,r)=>Vb(BP(e,t),n,r),zP=(e,t,n,r)=>t?`${t.join(n)}
${e}`:e.replace(/"/g,'""'),qb=(e,t,n,r)=>{if(Hb(e))return qP(e,t,n,r);if(LP(e))return VP(e,t,n,r);if(typeof e=="string")return zP(e,t,n);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},zb=(e,t,n,r,i)=>{const a=qb(e,n,r,i),o=MP()?"application/csv":"text/csv",u=new Blob([t?"\uFEFF":"",a],{type:o}),p=`data:${o};charset=utf-8,${t?"\uFEFF":""}${a}`,h=window.URL||window.webkitURL;return typeof h.createObjectURL>"u"?p:h.createObjectURL(u)};var Kb={exports:{}},KP="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$P=KP,WP=$P;function $b(){}function Wb(){}Wb.resetWarningCache=$b;var GP=function(){function e(r,i,a,o,u,p){if(p!==WP){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Wb,resetWarningCache:$b};return n.PropTypes=n,n};Kb.exports=GP();var oi=Kb.exports;const Gb={data:oi.oneOfType([oi.string,oi.array,oi.func]).isRequired,headers:oi.array,target:oi.string,separator:oi.string,filename:oi.string,uFEFF:oi.bool,onClick:oi.func,asyncOnClick:oi.bool,enclosingCharacter:oi.string},Jb={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},JP={target:"_blank"};class k1 extends Ub.Component{constructor(t){super(t),this.state={}}buildURI(){return zb(...arguments)}componentDidMount(){const{data:t,headers:n,separator:r,enclosingCharacter:i,uFEFF:a,target:o,specs:u,replace:p}=this.props;this.state.page=window.open(this.buildURI(t,a,n,r,i),o,u,p)}getWindow(){return this.state.page}render(){return null}}ac(k1,"defaultProps",Object.assign(Jb,JP)),ac(k1,"propTypes",Gb);var Zb={exports:{}},fh={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZP=Id(),XP=Symbol.for("react.element"),QP=Symbol.for("react.fragment"),YP=Object.prototype.hasOwnProperty,ek=ZP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tk={key:!0,ref:!0,__self:!0,__source:!0};function Xb(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)YP.call(t,r)&&!tk.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:XP,type:e,key:a,ref:o,props:i,_owner:ek.current}}fh.Fragment=QP;fh.jsx=Xb;fh.jsxs=Xb;Zb.exports=fh;var Qb=Zb.exports;const Dt=Qb.jsx,wc=Qb.jsxs;var bu;let nk=(bu=class extends Ub.Component{constructor(t){super(t),this.buildURI=this.buildURI.bind(this)}buildURI(){return zb(...arguments)}handleLegacy(t,n=!1){if(window.navigator.msSaveOrOpenBlob){t.preventDefault();const{data:r,headers:i,separator:a,filename:o,enclosingCharacter:u,uFEFF:p}=this.props,h=n&&typeof r=="function"?r():r;let g=new Blob([p?"\uFEFF":"",qb(h,i,a,u)]);return window.navigator.msSaveBlob(g,o),!1}}handleAsyncClick(t){const n=r=>{if(r===!1){t.preventDefault();return}this.handleLegacy(t,!0)};this.props.onClick(t,n)}handleSyncClick(t){if(this.props.onClick(t)===!1){t.preventDefault();return}this.handleLegacy(t)}handleClick(){return t=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(t):this.handleSyncClick(t);this.handleLegacy(t)}}render(){const{data:t,headers:n,separator:r,filename:i,uFEFF:a,children:o,onClick:u,asyncOnClick:p,enclosingCharacter:h,...g}=this.props,_=typeof window>"u"?"":this.buildURI(t,a,n,r,h);return Dt("a",{download:i,...g,ref:w=>this.link=w,target:"_self",href:_,onClick:this.handleClick(),children:o})}},ac(bu,"defaultProps",Jb),ac(bu,"propTypes",Gb),bu);const rk=nk;function T1(e,t,n,r,i,a,o){try{var u=e[a](o),p=u.value}catch(h){n(h);return}u.done?t(p):Promise.resolve(p).then(r,i)}function Aa(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(p){T1(a,r,i,o,u,"next",p)}function u(p){T1(a,r,i,o,u,"throw",p)}o(void 0)})}}var ik="Expected a function",R1=NaN,sk="[object Symbol]",ak=/^\s+|\s+$/g,ok=/^[-+]0x[0-9a-f]+$/i,ck=/^0b[01]+$/i,lk=/^0o[0-7]+$/i,uk=parseInt,dk=typeof Ti=="object"&&Ti&&Ti.Object===Object&&Ti,hk=typeof self=="object"&&self&&self.Object===Object&&self,pk=dk||hk||Function("return this")(),fk=Object.prototype,mk=fk.toString,gk=Math.max,vk=Math.min,Dp=function(){return pk.Date.now()};function yk(e,t,n){var r,i,a,o,u,p,h=0,g=!1,f=!1,_=!0;if(typeof e!="function")throw new TypeError(ik);t=A1(t)||0,Xf(n)&&(g=!!n.leading,f="maxWait"in n,a=f?gk(A1(n.maxWait)||0,t):a,_="trailing"in n?!!n.trailing:_);function w($){var z=r,q=i;return r=i=void 0,h=$,o=e.apply(q,z),o}function C($){return h=$,u=setTimeout(b,t),g?w($):o}function R($){var z=$-p,q=$-h,Q=t-z;return f?vk(Q,a-q):Q}function S($){var z=$-p,q=$-h;return p===void 0||z>=t||z<0||f&&q>=a}function b(){var $=Dp();if(S($))return x($);u=setTimeout(b,R($))}function x($){return u=void 0,_&&r?w($):(r=i=void 0,o)}function E(){u!==void 0&&clearTimeout(u),h=0,r=p=i=u=void 0}function M(){return u===void 0?o:x(Dp())}function Z(){var $=Dp(),z=S($);if(r=arguments,i=this,p=$,z){if(u===void 0)return C(p);if(f)return u=setTimeout(b,t),w(p)}return u===void 0&&(u=setTimeout(b,t)),o}return Z.cancel=E,Z.flush=M,Z}function Xf(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function _k(e){return!!e&&typeof e=="object"}function bk(e){return typeof e=="symbol"||_k(e)&&mk.call(e)==sk}function A1(e){if(typeof e=="number")return e;if(bk(e))return R1;if(Xf(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Xf(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(ak,"");var n=ck.test(e);return n||lk.test(e)?uk(e.slice(2),n?2:8):ok.test(e)?R1:+e}var Sk=yk;const wk=Qf(Sk),mo=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),xk=e=>e===mo;var Rd=()=>/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"");const Ad=(...e)=>e.map(t=>t.trim()).join(" ").trim(),Ck=/\s*\((.*?)\)\s*/g,Ek=/(\(\?:[^)]+\))\?/g,Pk=/(\(\?)?:\w+/g,kk=/\*/g,Tk=/[-{}[\]+?.,\\^$|#]/g,Rk=e=>e instanceof RegExp?new RegExp(e.source,"i"):(e=e.replace(Tk,"\\$&").replace(Ck,"(?:$1)?").replace(Pk,(t,n)=>n?t:"([^\\s]+)").replace(kk,"(.*?)").replace(Ek,"\\s*$1?\\s*"),new RegExp("^"+e+"$","i")),Ak=(e,t)=>{if(e=e.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!e.length&&!t.length)return 1;if(!e.length||!t.length)return 0;if(e===t)return 1;if(e.length===1&&t.length===1||e.length<2||t.length<2)return 0;const n=new Map;for(let i=0;i<e.length-1;i++){const a=e.substring(i,i+2),o=n.has(a)?n.get(a)+1:1;n.set(a,o)}let r=0;for(let i=0;i<t.length-1;i++){const a=t.substring(i,i+2),o=n.has(a)?n.get(a):0;o>0&&(n.set(a,o-1),r++)}return 2*r/(e.length+t.length-2)},Yb=()=>typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0);class Np{setSpeechRecognition(t){const n=!!t&&(xk(t)||Yb());n&&(this.disableRecognition(),this.recognition=new t,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(n)}subscribe(t,n){this.subscribers[t]=n}unsubscribe(t){delete this.subscribers[t]}emitListeningChange(t){this.listening=t,Object.keys(this.subscribers).forEach(n=>{const{onListeningChange:r}=this.subscribers[n];r(t)})}emitMicrophoneAvailabilityChange(t){this.isMicrophoneAvailable=t,Object.keys(this.subscribers).forEach(n=>{const{onMicrophoneAvailabilityChange:r}=this.subscribers[n];r(t)})}emitTranscriptChange(t,n){Object.keys(this.subscribers).forEach(r=>{const{onTranscriptChange:i}=this.subscribers[r];i(t,n)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(t=>{const{onClearTranscript:n}=this.subscribers[t];n()})}emitBrowserSupportsSpeechRecognitionChange(t){Object.keys(this.subscribers).forEach(n=>{const{onBrowserSupportsSpeechRecognitionChange:r,onBrowserSupportsContinuousListeningChange:i}=this.subscribers[n];r(t),i(t)})}disconnect(t){if(this.recognition&&this.listening)switch(t){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(t){t&&t.error&&t.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:t,resultIndex:n}){const r=n===void 0?t.length-1:n;this.interimTranscript="",this.finalTranscript="";for(let a=r;a<t.length;++a)t[a].isFinal&&(!Rd()||t[a][0].confidence>0)?this.updateFinalTranscript(t[a][0].transcript):this.interimTranscript=Ad(this.interimTranscript,t[a][0].transcript);let i=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(i=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,i||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(t){this.finalTranscript=Ad(this.finalTranscript,t)}resetTranscript(){this.disconnect("RESET")}startListening(){return Aa(function*({continuous:t=!1,language:n}={}){if(!this.recognition)return;const r=t!==this.recognition.continuous,i=n&&n!==this.recognition.lang;if((r||i)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=r?t:this.recognition.continuous,this.recognition.lang=i?n:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(a){a instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return Aa(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}stopListening(){return Aa(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}getRecognition(){return this.recognition}start(){return Aa(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(t){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(t),Rd()&&(this.updateFinalTranscript=wk(this.updateFinalTranscript,250,{leading:!0}))}}const e2="CLEAR_TRANSCRIPT",t2="APPEND_TRANSCRIPT",Ik=()=>({type:e2}),Fk=(e,t)=>({type:t2,payload:{interimTranscript:e,finalTranscript:t}}),Dk=(e,t)=>{switch(t.type){case e2:return{interimTranscript:"",finalTranscript:""};case t2:return{interimTranscript:t.payload.interimTranscript,finalTranscript:Ad(e.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};let go=!!mo,Ku=go&&!Rd(),as;const Nk=({transcribing:e=!0,clearTranscriptOnListen:t=!0,commands:n=[]}={})=>{const[r]=wt.useState(Ia.getRecognitionManager()),[i,a]=wt.useState(go),[o,u]=wt.useState(Ku),[{interimTranscript:p,finalTranscript:h},g]=wt.useReducer(Dk,{interimTranscript:r.interimTranscript,finalTranscript:""}),[f,_]=wt.useState(r.listening),[w,C]=wt.useState(r.isMicrophoneAvailable),R=wt.useRef(n);R.current=n;const S=()=>{g(Ik())},b=wt.useCallback(()=>{r.resetTranscript(),S()},[r]),x=(q,Q,K)=>{const ae=(typeof q=="object"?q.toString():q).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),le=Ak(ae,Q);return le>=K?{command:q,commandWithoutSpecials:ae,howSimilar:le,isFuzzyMatch:!0}:null},E=(q,Q)=>{const ee=Rk(q).exec(Q);return ee?{command:q,parameters:ee.slice(1)}:null},M=wt.useCallback((q,Q)=>{R.current.forEach(({command:K,callback:ee,matchInterim:ae=!1,isFuzzyMatch:le=!1,fuzzyMatchingThreshold:ne=.8,bestMatchOnly:Re=!1})=>{const ve=!Q&&ae?q.trim():Q.trim(),we=(Array.isArray(K)?K:[K]).map(Ee=>le?x(Ee,ve,ne):E(Ee,ve)).filter(Ee=>Ee);if(le&&Re&&we.length>=2){we.sort((Ce,je)=>je.howSimilar-Ce.howSimilar);const{command:Ee,commandWithoutSpecials:fe,howSimilar:ce}=we[0];ee(fe,ve,ce,{command:Ee,resetTranscript:b})}else we.forEach(Ee=>{if(Ee.isFuzzyMatch){const{command:fe,commandWithoutSpecials:ce,howSimilar:Ce}=Ee;ee(ce,ve,Ce,{command:fe,resetTranscript:b})}else{const{command:fe,parameters:ce}=Ee;ee(...ce,{command:fe,resetTranscript:b})}})})},[b]),Z=wt.useCallback((q,Q)=>{e&&g(Fk(q,Q)),M(q,Q)},[M,e]),$=wt.useCallback(()=>{t&&S()},[t]);return wt.useEffect(()=>{const q=Ia.counter;Ia.counter+=1;const Q={onListeningChange:_,onMicrophoneAvailabilityChange:C,onTranscriptChange:Z,onClearTranscript:$,onBrowserSupportsSpeechRecognitionChange:a,onBrowserSupportsContinuousListeningChange:u};return r.subscribe(q,Q),()=>{r.unsubscribe(q)}},[e,t,r,Z,$]),{transcript:Ad(h,p),interimTranscript:p,finalTranscript:h,listening:f,isMicrophoneAvailable:w,resetTranscript:b,browserSupportsSpeechRecognition:i,browserSupportsContinuousListening:o}},Ia={counter:0,applyPolyfill:e=>{as?as.setSpeechRecognition(e):as=new Np(e);const t=!!e&&Yb();go=t,Ku=t},removePolyfill:()=>{as?as.setSpeechRecognition(mo):as=new Np(mo),go=!!mo,Ku=go&&!Rd()},getRecognitionManager:()=>(as||(as=new Np(mo)),as),getRecognition:()=>Ia.getRecognitionManager().getRecognition(),startListening:({continuous:e,language:t}={})=>Aa(function*(){yield Ia.getRecognitionManager().startListening({continuous:e,language:t})})(),stopListening:()=>Aa(function*(){yield Ia.getRecognitionManager().stopListening()})(),abortListening:()=>Aa(function*(){yield Ia.getRecognitionManager().abortListening()})(),browserSupportsSpeechRecognition:()=>go,browserSupportsContinuousListening:()=>Ku};var n2={exports:{}};(function(e,t){(function(r,i){e.exports=i(Id())})(Ti,function(n){return function(r){var i={};function a(o){if(i[o])return i[o].exports;var u=i[o]={i:o,l:!1,exports:{}};return r[o].call(u.exports,u,u.exports,a),u.l=!0,u.exports}return a.m=r,a.c=i,a.d=function(o,u,p){a.o(o,u)||Object.defineProperty(o,u,{enumerable:!0,get:p})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,u){if(u&1&&(o=a(o)),u&8||u&4&&typeof o=="object"&&o&&o.__esModule)return o;var p=Object.create(null);if(a.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:o}),u&2&&typeof o!="string")for(var h in o)a.d(p,h,(function(g){return o[g]}).bind(null,h));return p},a.n=function(o){var u=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(u,"a",u),u},a.o=function(o,u){return Object.prototype.hasOwnProperty.call(o,u)},a.p="",a(a.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,i,a){a.r(i);var o=a("react"),u=function(){var _=function(w,C){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,S){R.__proto__=S}||function(R,S){for(var b in S)S.hasOwnProperty(b)&&(R[b]=S[b])},_(w,C)};return function(w,C){_(w,C);function R(){this.constructor=w}w.prototype=C===null?Object.create(C):(R.prototype=C.prototype,new R)}}(),p=function(){return p=Object.assign||function(_){for(var w,C=1,R=arguments.length;C<R;C++){w=arguments[C];for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(_[S]=w[S])}return _},p.apply(this,arguments)},h=function(_,w){var C={};for(var R in _)Object.prototype.hasOwnProperty.call(_,R)&&w.indexOf(R)<0&&(C[R]=_[R]);if(_!=null&&typeof Object.getOwnPropertySymbols=="function")for(var S=0,R=Object.getOwnPropertySymbols(_);S<R.length;S++)w.indexOf(R[S])<0&&Object.prototype.propertyIsEnumerable.call(_,R[S])&&(C[R[S]]=_[R[S]]);return C};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(w){var C=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return C?new Promise(function(R,S){C.call(navigator,w,R,S)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function g(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var f=function(_){u(w,_);function w(C){var R=_.call(this,C)||this;return R.canvas=null,R.ctx=null,R.requestUserMediaId=0,R.unmounted=!1,R.state={hasUserMedia:!1},R}return w.prototype.componentDidMount=function(){var C=this,R=C.state,S=C.props;if(this.unmounted=!1,!g()){S.onUserMediaError("getUserMedia not supported");return}R.hasUserMedia||this.requestUserMedia(),S.children&&typeof S.children!="function"&&console.warn("children must be a function")},w.prototype.componentDidUpdate=function(C){var R=this.props;if(!g()){R.onUserMediaError("getUserMedia not supported");return}var S=JSON.stringify(C.audioConstraints)!==JSON.stringify(R.audioConstraints),b=JSON.stringify(C.videoConstraints)!==JSON.stringify(R.videoConstraints),x=C.minScreenshotWidth!==R.minScreenshotWidth,E=C.minScreenshotHeight!==R.minScreenshotHeight;(b||x||E)&&(this.canvas=null,this.ctx=null),(S||b)&&(this.stopAndCleanup(),this.requestUserMedia())},w.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},w.stopMediaStream=function(C){C&&(C.getVideoTracks&&C.getAudioTracks?(C.getVideoTracks().map(function(R){C.removeTrack(R),R.stop()}),C.getAudioTracks().map(function(R){C.removeTrack(R),R.stop()})):C.stop())},w.prototype.stopAndCleanup=function(){var C=this.state;C.hasUserMedia&&(w.stopMediaStream(this.stream),C.src&&window.URL.revokeObjectURL(C.src))},w.prototype.getScreenshot=function(C){var R=this,S=R.state,b=R.props;if(!S.hasUserMedia)return null;var x=this.getCanvas(C);return x&&x.toDataURL(b.screenshotFormat,b.screenshotQuality)},w.prototype.getCanvas=function(C){var R=this,S=R.state,b=R.props;if(!this.video||!S.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var x=this.video.videoWidth,E=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var M=x/E;x=b.minScreenshotWidth||this.video.clientWidth,E=x/M,b.minScreenshotHeight&&E<b.minScreenshotHeight&&(E=b.minScreenshotHeight,x=E*M)}this.canvas=document.createElement("canvas"),this.canvas.width=(C==null?void 0:C.width)||x,this.canvas.height=(C==null?void 0:C.height)||E,this.ctx=this.canvas.getContext("2d")}var Z=this,$=Z.ctx,z=Z.canvas;return $&&z&&(z.width=(C==null?void 0:C.width)||z.width,z.height=(C==null?void 0:C.height)||z.height,b.mirrored&&($.translate(z.width,0),$.scale(-1,1)),$.imageSmoothingEnabled=b.imageSmoothing,$.drawImage(this.video,0,0,(C==null?void 0:C.width)||z.width,(C==null?void 0:C.height)||z.height),b.mirrored&&($.scale(-1,1),$.translate(-z.width,0))),z},w.prototype.requestUserMedia=function(){var C=this,R=this.props,S=function(E,M){var Z={video:typeof M<"u"?M:!0};R.audio&&(Z.audio=typeof E<"u"?E:!0),C.requestUserMediaId++;var $=C.requestUserMediaId;navigator.mediaDevices.getUserMedia(Z).then(function(z){C.unmounted||$!==C.requestUserMediaId?w.stopMediaStream(z):C.handleUserMedia(null,z)}).catch(function(z){C.handleUserMedia(z)})};if("mediaDevices"in navigator)S(R.audioConstraints,R.videoConstraints);else{var b=function(E){return{optional:[{sourceId:E}]}},x=function(E){var M=E.deviceId;return typeof M=="string"?M:Array.isArray(M)&&M.length>0?M[0]:typeof M=="object"&&M.ideal?M.ideal:null};MediaStreamTrack.getSources(function(E){var M=null,Z=null;E.forEach(function(q){q.kind==="audio"?M=q.id:q.kind==="video"&&(Z=q.id)});var $=x(R.audioConstraints);$&&(M=$);var z=x(R.videoConstraints);z&&(Z=z),S(b(M),b(Z))})}},w.prototype.handleUserMedia=function(C,R){var S=this.props;if(C||!R){this.setState({hasUserMedia:!1}),S.onUserMediaError(C);return}this.stream=R;try{this.video&&(this.video.srcObject=R),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(R)})}S.onUserMedia(R)},w.prototype.render=function(){var C=this,R=this,S=R.state,b=R.props,x=b.audio;b.forceScreenshotSourceSize;var E=b.disablePictureInPicture;b.onUserMedia,b.onUserMediaError,b.screenshotFormat,b.screenshotQuality,b.minScreenshotWidth,b.minScreenshotHeight,b.audioConstraints,b.videoConstraints,b.imageSmoothing;var M=b.mirrored,Z=b.style,$=Z===void 0?{}:Z,z=b.children,q=h(b,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),Q=M?p(p({},$),{transform:($.transform||"")+" scaleX(-1)"}):$,K={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",p({autoPlay:!0,disablePictureInPicture:E,src:S.src,muted:!x,playsInline:!0,ref:function(ee){C.video=ee},style:Q},q)),z&&z(K))},w.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},w}(o.Component);i.default=f},react:function(r,i){r.exports=n}}).default})})(n2);var Ok=n2.exports;const Mk=Qf(Ok),Lk="78d4247e-9c81-45c4-a3ad-cad69d3fa502",jk="q30eIW0sHi102yMNovcPpJm31EX/AbcjpsZnjHbOmoI=",Bk=new yl({jti:Ko(),iat:i1(),exp:i1()+60*60*24,scope:{app:{id:Lk,turn:!0,actions:["read"],channels:[{id:"*",name:"*",actions:["write"],members:[{id:"*",name:"*",actions:["write"],publication:{actions:["write"]},subscription:{actions:["write"]}}],sfuBots:[{actions:["write"],forwardings:[{actions:["write"]}]}]}]}}}),Uk=Bk.encode(jk),Hk={log:{level:"debug"}},Vk={},yu={WIDTH_MAX:window.innerWidth,HEIGHT_MAX:window.innerHeight},qk=window.scrollX,I1=20,zk=({subscription:e,windowInfo:t,participantNum:n,participantAllNums:r})=>{const i=wt.useRef(null);wt.useEffect(()=>{i!=null&&i.current&&e.stream&&(i.current.srcObject=new MediaStream([e.stream.track]))},[i==null?void 0:i.current,e.stream]);const a=wt.useMemo(()=>(console.log("Window Info:"+t),t?(console.log("participantAllNums = "+r),{position:"absolute",width:(t==null?void 0:t.width)-I1,height:t.height-I1,top:`${0+yu.HEIGHT_MAX*(n%2===1?n/(1+Math.floor((r-1)/2))/2:(n-1)/(1+Math.floor((r-1)/2))/2)-t.height/2+t.topDiff}px`,left:`${window.screenLeft+qk+(r%2===1&&n===r?yu.WIDTH_MAX/2:n%2===1?yu.WIDTH_MAX/4:yu.WIDTH_MAX*3/4)-t.width/2+t.leftDiff+0}px`,border:`10px solid rgba(${t==null?void 0:t.borderRed}, ${t==null?void 0:t.borderGreen}, ${t==null?void 0:t.borderBlue}, ${t.borderAlpha})`}):{}),[t]);return Dt("div",{children:Dt("video",{muted:!0,autoPlay:!0,playsInline:!0,ref:i,onClick:async()=>{e.preferredEncoding==="high"?e.changePreferredEncoding("low"):e.preferredEncoding==="low"&&e.changePreferredEncoding("high")},style:a})})},Pt={MOVING_AVERAGE_FRAME:10,WIDTH_MAX:window.innerWidth,WIDTH_MIN:window.innerWidth*.8,HEIGHT_MAX:window.innerHeight,HEIGHT_MIN:window.innerHeight*.8,DISTANCE_RATE_MOVE:1e4,DEFAULT_TOP_DIFF:0,DEFAULT_LEFT_DIFF:0,BORDER_ALPHA_MIN:0,BORDER_ALPHA_MAX:1,BORDER_ALPHA_MIN_THRESHOLD:.015,BORDER_COLORS:{GREEN:{r:83,g:253,b:49,a:0}}},F1=(Pt.WIDTH_MAX+Pt.WIDTH_MIN)/2,Kk=(Pt.HEIGHT_MAX+Pt.HEIGHT_MIN)/2,ba=Pt.BORDER_COLORS.GREEN,$k=window.scrollX,Sn={averageValue:(e,t=0,n=e.length-1)=>{let r=0;for(let i=t;i<n+1;i++)r+=e[i];return r/(n-t+1)},inner:(e,t)=>e[0]*t[0]+e[1]*t[1],norm:e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),getParticipantDirection:e=>e<0||e>360?"Error":e<22.5||e>=337.5?"Left":e>=22.5&&e<67.5?"LeftDown":e>=67.5&&e<112.5?"Down":e>=112.5&&e<157.5?"RightDown":e>=157.5&&e<202.5?"Right":e>=202.5&&e<247.5?"RightUp":e>=247.5&&e<292.5?"Up":e>=292.5&&e<337.5?"LeftUp":"Error"};let xc=1,Ms=1,Ls="Baseline",D1=0,_u=0;const os=[],cs=[],ls=[],N1=!1,Op=Pt.BORDER_ALPHA_MIN,O1=20,Wk=()=>{var Ee;const[e,t]=wt.useState(""),[n,r]=wt.useState(),[i,a]=wt.useState(),[o,u]=wt.useState(),[p,h]=wt.useState([]),[g,f]=wt.useState({ID:-1,topDiff:Pt.DEFAULT_TOP_DIFF,leftDiff:Pt.DEFAULT_LEFT_DIFF,width:300,height:300,borderRed:ba.r,borderGreen:ba.g,borderBlue:ba.b,borderAlpha:ba.a,borderAlphaValueBasedVoice:Op,widthInCaseOfChange:0,heightInCaseOfChange:0,theta:0,isSpeaking:!1,transcript:"",gazeStatus:""}),[_,w]=wt.useState(new Map),[C,R]=wt.useState(new Map);Nk();const[S,b]=wt.useState([]),[x,E]=wt.useState(0),[M,Z]=wt.useState(!1),[$,z]=wt.useState([]),q=wt.useRef(null),Q=wt.useRef(null),K=wt.useRef(null),ee=wt.useRef(),ae=wt.useRef(null),le=wt.useMemo(()=>({position:"absolute",top:`${0+Pt.HEIGHT_MAX/(1+Math.floor(_u/2))/2-g.height/2+g.topDiff}px`,left:`${window.screenLeft+$k+(p.length===0?Pt.WIDTH_MAX/2:Pt.WIDTH_MAX/4)-g.width/2+g.leftDiff+0}px`,width:g.width-O1,height:g.height-O1,border:`10px solid rgba(${g.borderRed}, ${g.borderGreen}, ${g.borderBlue}, ${g.borderAlpha})`}),[g]),ne=wt.useCallback((fe,ce,Ce,je,$e,et,it,ze)=>{let Ge=0,Le=0,Je=0,Tt=0,Ir=0,nr=0,Bi=0,fn=0,rr=0,gr="";const In=Pt.DISTANCE_RATE_MOVE*Sn.norm(ce)*Math.sin(Ce),ir=Pt.DISTANCE_RATE_MOVE*Sn.norm(ce)*Math.cos(Ce-Math.PI);let $n;const an=ze===0?Pt.WIDTH_MAX:Pt.WIDTH_MAX/2,vr=ze===0?Pt.WIDTH_MIN:Pt.WIDTH_MIN/2,mn=ze===0?F1:F1/2,sr=Pt.HEIGHT_MAX/(1+Math.floor(ze/2)),yr=Pt.HEIGHT_MIN/(1+Math.floor(ze/2)),ht=Kk/(1+Math.floor(ze/2));console.log("videoSubscriptionsLength = "+ze),150*Sn.norm(ce)<=1?(Ge=1,Le=1):(Ge=1/(150*Sn.norm(ce)),Le=1/(150*Sn.norm(ce))),Je=an*Ge,Tt=sr*Ge,Ir=Pt.BORDER_ALPHA_MAX*Le,Je<vr&&(Je=vr),Tt<yr&&(Tt=yr),Ir<Pt.BORDER_ALPHA_MIN_THRESHOLD&&(Ir=Pt.BORDER_ALPHA_MIN),nr=Je,Bi=Tt,os.push(Je),cs.push(Tt),ls.push(Ir),os.length<Pt.MOVING_AVERAGE_FRAME?Je=Sn.averageValue(os,0,os.length-1):(os.length>Pt.MOVING_AVERAGE_FRAME+3&&os.shift(),Je=Sn.averageValue(os,os.length-Pt.MOVING_AVERAGE_FRAME,os.length-1)),cs.length<Pt.MOVING_AVERAGE_FRAME?Tt=Sn.averageValue(cs,0,cs.length-1):(cs.length>Pt.MOVING_AVERAGE_FRAME+3&&cs.shift(),Tt=Sn.averageValue(cs,cs.length-Pt.MOVING_AVERAGE_FRAME,cs.length-1)),ls.length<Pt.MOVING_AVERAGE_FRAME?Ir=Sn.averageValue(ls,0,ls.length-1):(ls.length>Pt.MOVING_AVERAGE_FRAME+3&&ls.shift(),Ir=Sn.averageValue(ls,ls.length-Pt.MOVING_AVERAGE_FRAME,ls.length-1)),Je>an-(an-vr)*.1?fn=an:fn=vr,Tt>sr-(sr-yr)*.1?rr=sr:rr=yr,nr>an-(an-vr)*.1&&(gr="mutual gaze"),nr<vr+(an-vr)*.1&&(gr="gaze aversion");const _t={ID:xc,borderRed:ba.r,borderGreen:ba.g,borderBlue:ba.b,borderAlphaValueBasedVoice:$e,widthInCaseOfChange:nr,heightInCaseOfChange:Bi,theta:je,isSpeaking:et,transcript:it,gazeStatus:gr};switch(fe){case 1:$n={..._t,topDiff:Pt.DEFAULT_TOP_DIFF,leftDiff:Pt.DEFAULT_LEFT_DIFF,width:mn,height:ht,borderAlpha:$e};break;case 2:$n={..._t,topDiff:Pt.DEFAULT_TOP_DIFF,leftDiff:Pt.DEFAULT_LEFT_DIFF,width:mn,height:ht,borderAlpha:Ir};break;case 3:$n={..._t,topDiff:Pt.DEFAULT_TOP_DIFF,leftDiff:Pt.DEFAULT_LEFT_DIFF,width:Je,height:Tt,borderAlpha:$e};break;case 4:$n={..._t,topDiff:Pt.DEFAULT_TOP_DIFF,leftDiff:Pt.DEFAULT_LEFT_DIFF,width:fn,height:rr,borderAlpha:$e};break;case 5:$n={..._t,topDiff:In,leftDiff:ir,width:mn,height:ht,borderAlpha:$e};break;case 6:$n={..._t,topDiff:In,leftDiff:ir,width:Je,height:Tt,borderAlpha:$e};break;default:$n={..._t,topDiff:Pt.DEFAULT_TOP_DIFF,leftDiff:Pt.DEFAULT_LEFT_DIFF,width:mn,height:ht,borderAlpha:$e}}return $n},[]),Re=wt.useCallback(fe=>{if(fe.multiFaceLandmarks.length>0){ee.current=fe;const ce=[],Ce=[],je=[];if(fe.multiFaceLandmarks&&fe.multiFaceLandmarks[0])for(let Le=0;Le<fe.multiFaceLandmarks[0].length;Le++)fe.multiFaceLandmarks[0][Le].x<0?ce.push(0):fe.multiFaceLandmarks[0][Le].x>1?ce.push(1):ce.push(fe.multiFaceLandmarks[0][Le].x),fe.multiFaceLandmarks[0][Le].y<0?Ce.push(0):fe.multiFaceLandmarks[0][Le].y>1?Ce.push(1):Ce.push(fe.multiFaceLandmarks[0][Le].y),Le===1&&(fe.multiFaceLandmarks[0][Le].x<0?je.push(0):fe.multiFaceLandmarks[0][Le].x>1?je.push(1):je.push(fe.multiFaceLandmarks[0][Le].x),fe.multiFaceLandmarks[0][Le].y<0?je.push(0):fe.multiFaceLandmarks[0][Le].y>1?je.push(1):je.push(fe.multiFaceLandmarks[0][Le].y));const $e=[Sn.averageValue(ce),Sn.averageValue(Ce)],et=[1,0],it=[je[0]-$e[0],je[1]-$e[1]];let ze=Math.acos(Sn.inner(et,it)/(Sn.norm(et)*Sn.norm(it))),Ge=ze*(180/Math.PI);it[1]<0&&(ze=-ze,Ge=360-Ge),f(()=>ne(Ms,it,ze,Ge,Op,N1,"",_u))}},[]);wt.useCallback(fe=>{if(fe.faceLandmarks.length>0){const ce=[],Ce=[],je=[];if(fe.faceLandmarks&&fe.faceLandmarks[0])for(let Le=0;Le<fe.faceLandmarks[0].length;Le++)fe.faceLandmarks[0][Le].x<0?ce.push(0):fe.faceLandmarks[0][Le].x>1?ce.push(1):ce.push(fe.faceLandmarks[0][Le].x),fe.faceLandmarks[0][Le].y<0?Ce.push(0):fe.faceLandmarks[0][Le].y>1?Ce.push(1):Ce.push(fe.faceLandmarks[0][Le].y),Le===1&&(fe.faceLandmarks[0][Le].x<0?je.push(0):fe.faceLandmarks[0][Le].x>1?je.push(1):je.push(fe.faceLandmarks[0][Le].x),fe.faceLandmarks[0][Le].y<0?je.push(0):fe.faceLandmarks[0][Le].y>1?je.push(1):je.push(fe.faceLandmarks[0][Le].y));const $e=[Sn.averageValue(ce),Sn.averageValue(Ce)],et=[1,0],it=[je[0]-$e[0],je[1]-$e[1]];let ze=Math.acos(Sn.inner(et,it)/(Sn.norm(et)*Sn.norm(it))),Ge=ze*(180/Math.PI);it[1]<0&&(ze=-ze,Ge=360-Ge),f(()=>ne(Ms,it,ze,Ge,Op,N1,"",_u))}},[]);const ve=wt.useCallback(()=>{b([{ID:-1,condition:Ms,startTime:0,endTime:0,theta:0,direction:"",windowWidth:0,windowHeight:0,statusGaze:""}]),E(0),D1=performance.now(),Z(!0)},[]),_e=wt.useCallback(()=>{var fe;Z(!1),(fe=ae==null?void 0:ae.current)==null||fe.link.click()},[]),we=async()=>{var it,ze,Ge;const fe=await Jf.Create(Uk,Hk),ce=await OP.FindOrCreate(fe,{name:e,type:"p2p",options:Vk}),Ce=await ce.join();r(Ce),navigator.mediaDevices.getUserMedia({video:{frameRate:15}}).then(Le=>{console.log(Le)}).catch(console.error);const je=(await navigator.mediaDevices.enumerateDevices()).filter(Le=>Le.label.includes("USB Camera"));console.log(je),z(je);const $e=await S1.createMicrophoneAudioAndCameraStream({video:{frameRate:15}});$e.video.attach(q.current);const et=await S1.createDataStream();a($e),u(et),await((it=q.current)==null?void 0:it.play()),await Ce.publish($e.audio,{maxSubscribers:50}),await Ce.publish($e.video,{maxSubscribers:50,encodings:[{scaleResolutionDownBy:4,id:"low",maxBitrate:8e4},{scaleResolutionDownBy:1,id:"high",maxBitrate:4e5}]}),et!==void 0&&(console.log("published data stream"),await Ce.publish(et)),Ce.onPublicationSubscribed.add(Le=>{if(Le.stream.contentType==="audio"){const Je=K?K.current:null,Tt=document.createElement("audio");Tt.srcObject=new MediaStream([Le.stream.track]),Tt.play(),Je==null||Je.appendChild(Tt),Le.subscription.onCanceled.once(()=>{Je==null||Je.removeChild(Tt)})}}),Ce.onPublicationUnsubscribed.add(Le=>{R(Je=>{const Tt=new Map(Je);return Tt.delete(Le.subscription.id),Tt})}),Ce.onSubscriptionListChanged.add(()=>{const Le=Ce.subscriptions.filter(Je=>Je.contentType==="video");h(Le),console.log("subscriptions.length",Le.length),_u=Le.length}),ce.onStreamPublished.add(async Le=>{if(Le.publication.publisher.id!==Ce.id)try{const{stream:Je}=await Ce.subscribe(Le.publication);Je.contentType==="data"&&R(Tt=>new Map(Tt).set(Le.publication.publisher.id,Je))}catch(Je){console.log("Failed to subscribe to data stream:",Je),Je instanceof Er&&Je.name==="internal"&&console.log("Publisher already left the room, ignoring subscription.")}}),(ze=document.getElementById("active-after-conference"))==null||ze.classList.remove("non-active"),(Ge=document.getElementById("active-before-conference"))==null||Ge.classList.add("non-active"),await Promise.all(ce.publications.filter(Le=>Le.publisher.id!==Ce.id).map(async Le=>{try{const{stream:Je}=await Ce.subscribe(Le);Je.contentType==="data"&&R(Tt=>new Map(Tt).set(Le.publisher.id,Je))}catch(Je){console.error("Failed to subscribe:",Je)}}))};return wt.useEffect(()=>{C.forEach((fe,ce)=>{fe.onData.add(Ce=>{console.log("Receiving Data from",ce,":",Ce),w(je=>{const $e=new Map(je);return $e.set(ce,Ce),$e})})})},[C]),wt.useEffect(()=>{o&&(console.log("Sending Data:",g),o.write(g))},[o,g]),wt.useEffect(()=>{var ce;const fe=new zw({locateFile:Ce=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${Ce}`});return fe.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),fe.onResults(Re),q.current&&((ce=Q.current)!=null&&ce.video)&&new qw(Q.current.video,{onFrame:async()=>{await fe.send({image:Q.current.video})}}).start(),()=>{fe.close()}},[Re]),wt.useEffect(()=>{if(o&&C&&M){const fe=(performance.now()-D1)/1e3,ce={ID:xc,condition:Ms,startTime:x,endTime:fe,theta:g.theta,direction:Sn.getParticipantDirection(g.theta),windowWidth:g.widthInCaseOfChange,windowHeight:g.heightInCaseOfChange,statusGaze:g.gazeStatus};b(Ce=>[...Ce,ce]),p.map(Ce=>{const je=_.get(Ce.publication.publisher.id),$e={ID:je?je.ID:-1,condition:Ms,startTime:x,endTime:fe,theta:je?je.theta:0,direction:Sn.getParticipantDirection(je?je.theta:0),windowWidth:je?je.widthInCaseOfChange:0,windowHeight:je?je.heightInCaseOfChange:0,statusGaze:je?je.gazeStatus:""};b(et=>[...et,$e])}),E(fe)}},[M,x,g,C]),wc("div",{children:[Dt("div",{id:"active-before-conference",children:wc("p",{children:["Your ID:",wc("select",{id:"ID",onChange:fe=>{xc=Number(fe.target.value)},children:[Dt("option",{value:"1",children:"1"}),Dt("option",{value:"2",children:"2"}),Dt("option",{value:"3",children:"3"}),Dt("option",{value:"4",children:"4"}),Dt("option",{value:"5",children:"5"}),Dt("option",{value:"6",children:"6"}),Dt("option",{value:"7",children:"7"}),Dt("option",{value:"8",children:"8"}),Dt("option",{value:"9",children:"9"}),Dt("option",{value:"10",children:"10"}),Dt("option",{value:"11",children:"11"}),Dt("option",{value:"12",children:"12"}),Dt("option",{value:"13",children:"13"}),Dt("option",{value:"14",children:"14"}),Dt("option",{value:"15",children:"15"}),Dt("option",{value:"16",children:"16"}),Dt("option",{value:"17",children:"17"}),Dt("option",{value:"18",children:"18"}),Dt("option",{value:"19",children:"19"}),Dt("option",{value:"20",children:"20"})]})," condition=",wc("select",{id:"condition",onChange:fe=>{switch(Ms=Number(fe.target.value),Ms){case 1:Ls="Baseline";break;case 2:Ls="FrameChange";break;case 3:Ls="SizeChange";break;case 4:Ls="SizeChange_Discrete";break;case 5:Ls="PositionChange";break;case 6:Ls="PositionAndSizeChange";break;default:Ls="";break}},children:[Dt("option",{value:"1",children:"Baseline"}),Dt("option",{value:"2",children:"FrameChange"}),Dt("option",{value:"3",children:"SizeChange"})]})," room name:"," ",Dt("input",{type:"text",value:e,onChange:fe=>{t(fe.target.value)}}),"",Dt("button",{onClick:we,children:"join"})]})}),wc("div",{id:"active-after-conference",className:"non-active",children:["ID: ",xc,"  condition: ",Ls,"  room name: ",e,"",Dt("button",{onClick:ve,disabled:M,children:"Measurement Start"}),"",Dt("button",{onClick:_e,disabled:!M,children:"Measurement End"})]}),Dt("video",{id:"local-video",ref:q,muted:!0,playsInline:!0,style:le}),Dt(Mk,{id:"local-video-webcam",ref:Q,videoConstraints:{deviceId:(Ee=$==null?void 0:$[0])==null?void 0:Ee.deviceId},muted:!0,playsInline:!0,style:le}),Dt("div",{style:{display:"flex",flexWrap:"wrap"},children:p.map(fe=>Dt(zk,{subscription:fe,windowInfo:_.get(fe.publication.publisher.id),participantNum:p.indexOf(fe)+2,participantAllNums:p.length+1},fe.id))}),Dt("div",{ref:K}),Dt(rk,{data:S,filename:`C${Ms}_ID${xc}_headDirectionResults.csv`,ref:ae})]})},Gk=Ly(document.getElementById("root"));Gk.render(Dt(Wk,{}));
