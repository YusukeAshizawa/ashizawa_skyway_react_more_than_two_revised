var R2=Object.defineProperty;var A2=(e,t,n)=>t in e?R2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ac=(e,t,n)=>A2(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var Ei=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var A1={exports:{}},Wr={},qh={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cg;function I2(){if(Cg)return It;Cg=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),f=Symbol.iterator;function _(le){return le===null||typeof le!="object"?null:(le=f&&le[f]||le["@@iterator"],typeof le=="function"?le:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,R={};function S(le,Re,We){this.props=le,this.context=Re,this.refs=R,this.updater=We||w}S.prototype.isReactComponent={},S.prototype.setState=function(le,Re){if(typeof le!="object"&&typeof le!="function"&&le!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,le,Re,"setState")},S.prototype.forceUpdate=function(le){this.updater.enqueueForceUpdate(this,le,"forceUpdate")};function b(){}b.prototype=S.prototype;function x(le,Re,We){this.props=le,this.context=Re,this.refs=R,this.updater=We||w}var E=x.prototype=new b;E.constructor=x,C(E,S.prototype),E.isPureReactComponent=!0;var M=Array.isArray,Z=Object.prototype.hasOwnProperty,$={current:null},z={key:!0,ref:!0,__self:!0,__source:!0};function q(le,Re,We){var Xe,Ke={},Le=null,qe=null;if(Re!=null)for(Xe in Re.ref!==void 0&&(qe=Re.ref),Re.key!==void 0&&(Le=""+Re.key),Re)Z.call(Re,Xe)&&!z.hasOwnProperty(Xe)&&(Ke[Xe]=Re[Xe]);var rt=arguments.length-2;if(rt===1)Ke.children=We;else if(1<rt){for(var ot=Array(rt),wt=0;wt<rt;wt++)ot[wt]=arguments[wt+2];Ke.children=ot}if(le&&le.defaultProps)for(Xe in rt=le.defaultProps,rt)Ke[Xe]===void 0&&(Ke[Xe]=rt[Xe]);return{$$typeof:e,type:le,key:Le,ref:qe,props:Ke,_owner:$.current}}function X(le,Re){return{$$typeof:e,type:le.type,key:Re,ref:le.ref,props:le.props,_owner:le._owner}}function K(le){return typeof le=="object"&&le!==null&&le.$$typeof===e}function ee(le){var Re={"=":"=0",":":"=2"};return"$"+le.replace(/[=:]/g,function(We){return Re[We]})}var oe=/\/+/g;function ce(le,Re){return typeof le=="object"&&le!==null&&le.key!=null?ee(""+le.key):Re.toString(36)}function ne(le,Re,We,Xe,Ke){var Le=typeof le;(Le==="undefined"||Le==="boolean")&&(le=null);var qe=!1;if(le===null)qe=!0;else switch(Le){case"string":case"number":qe=!0;break;case"object":switch(le.$$typeof){case e:case t:qe=!0}}if(qe)return qe=le,Ke=Ke(qe),le=Xe===""?"."+ce(qe,0):Xe,M(Ke)?(We="",le!=null&&(We=le.replace(oe,"$&/")+"/"),ne(Ke,Re,We,"",function(wt){return wt})):Ke!=null&&(K(Ke)&&(Ke=X(Ke,We+(!Ke.key||qe&&qe.key===Ke.key?"":(""+Ke.key).replace(oe,"$&/")+"/")+le)),Re.push(Ke)),1;if(qe=0,Xe=Xe===""?".":Xe+":",M(le))for(var rt=0;rt<le.length;rt++){Le=le[rt];var ot=Xe+ce(Le,rt);qe+=ne(Le,Re,We,ot,Ke)}else if(ot=_(le),typeof ot=="function")for(le=ot.call(le),rt=0;!(Le=le.next()).done;)Le=Le.value,ot=Xe+ce(Le,rt++),qe+=ne(Le,Re,We,ot,Ke);else if(Le==="object")throw Re=String(le),Error("Objects are not valid as a React child (found: "+(Re==="[object Object]"?"object with keys {"+Object.keys(le).join(", ")+"}":Re)+"). If you meant to render a collection of children, use an array instead.");return qe}function Te(le,Re,We){if(le==null)return le;var Xe=[],Ke=0;return ne(le,Xe,"","",function(Le){return Re.call(We,Le,Ke++)}),Xe}function ye(le){if(le._status===-1){var Re=le._result;Re=Re(),Re.then(function(We){(le._status===0||le._status===-1)&&(le._status=1,le._result=We)},function(We){(le._status===0||le._status===-1)&&(le._status=2,le._result=We)}),le._status===-1&&(le._status=0,le._result=Re)}if(le._status===1)return le._result.default;throw le._result}var ue={current:null},me={transition:null},_e={ReactCurrentDispatcher:ue,ReactCurrentBatchConfig:me,ReactCurrentOwner:$};function ke(){throw Error("act(...) is not supported in production builds of React.")}return It.Children={map:Te,forEach:function(le,Re,We){Te(le,function(){Re.apply(this,arguments)},We)},count:function(le){var Re=0;return Te(le,function(){Re++}),Re},toArray:function(le){return Te(le,function(Re){return Re})||[]},only:function(le){if(!K(le))throw Error("React.Children.only expected to receive a single React element child.");return le}},It.Component=S,It.Fragment=n,It.Profiler=i,It.PureComponent=x,It.StrictMode=r,It.Suspense=p,It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_e,It.act=ke,It.cloneElement=function(le,Re,We){if(le==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+le+".");var Xe=C({},le.props),Ke=le.key,Le=le.ref,qe=le._owner;if(Re!=null){if(Re.ref!==void 0&&(Le=Re.ref,qe=$.current),Re.key!==void 0&&(Ke=""+Re.key),le.type&&le.type.defaultProps)var rt=le.type.defaultProps;for(ot in Re)Z.call(Re,ot)&&!z.hasOwnProperty(ot)&&(Xe[ot]=Re[ot]===void 0&&rt!==void 0?rt[ot]:Re[ot])}var ot=arguments.length-2;if(ot===1)Xe.children=We;else if(1<ot){rt=Array(ot);for(var wt=0;wt<ot;wt++)rt[wt]=arguments[wt+2];Xe.children=rt}return{$$typeof:e,type:le.type,key:Ke,ref:Le,props:Xe,_owner:qe}},It.createContext=function(le){return le={$$typeof:o,_currentValue:le,_currentValue2:le,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},le.Provider={$$typeof:a,_context:le},le.Consumer=le},It.createElement=q,It.createFactory=function(le){var Re=q.bind(null,le);return Re.type=le,Re},It.createRef=function(){return{current:null}},It.forwardRef=function(le){return{$$typeof:u,render:le}},It.isValidElement=K,It.lazy=function(le){return{$$typeof:v,_payload:{_status:-1,_result:le},_init:ye}},It.memo=function(le,Re){return{$$typeof:h,type:le,compare:Re===void 0?null:Re}},It.startTransition=function(le){var Re=me.transition;me.transition={};try{le()}finally{me.transition=Re}},It.unstable_act=ke,It.useCallback=function(le,Re){return ue.current.useCallback(le,Re)},It.useContext=function(le){return ue.current.useContext(le)},It.useDebugValue=function(){},It.useDeferredValue=function(le){return ue.current.useDeferredValue(le)},It.useEffect=function(le,Re){return ue.current.useEffect(le,Re)},It.useId=function(){return ue.current.useId()},It.useImperativeHandle=function(le,Re,We){return ue.current.useImperativeHandle(le,Re,We)},It.useInsertionEffect=function(le,Re){return ue.current.useInsertionEffect(le,Re)},It.useLayoutEffect=function(le,Re){return ue.current.useLayoutEffect(le,Re)},It.useMemo=function(le,Re){return ue.current.useMemo(le,Re)},It.useReducer=function(le,Re,We){return ue.current.useReducer(le,Re,We)},It.useRef=function(le){return ue.current.useRef(le)},It.useState=function(le){return ue.current.useState(le)},It.useSyncExternalStore=function(le,Re,We){return ue.current.useSyncExternalStore(le,Re,We)},It.useTransition=function(){return ue.current.useTransition()},It.version="18.3.1",It}var Eg;function Rd(){return Eg||(Eg=1,qh.exports=I2()),qh.exports}var I1={exports:{}},F1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(me,_e){var ke=me.length;me.push(_e);e:for(;0<ke;){var le=ke-1>>>1,Re=me[le];if(0<i(Re,_e))me[le]=_e,me[ke]=Re,ke=le;else break e}}function n(me){return me.length===0?null:me[0]}function r(me){if(me.length===0)return null;var _e=me[0],ke=me.pop();if(ke!==_e){me[0]=ke;e:for(var le=0,Re=me.length,We=Re>>>1;le<We;){var Xe=2*(le+1)-1,Ke=me[Xe],Le=Xe+1,qe=me[Le];if(0>i(Ke,ke))Le<Re&&0>i(qe,Ke)?(me[le]=qe,me[Le]=ke,le=Le):(me[le]=Ke,me[Xe]=ke,le=Xe);else if(Le<Re&&0>i(qe,ke))me[le]=qe,me[Le]=ke,le=Le;else break e}}return _e}function i(me,_e){var ke=me.sortIndex-_e.sortIndex;return ke!==0?ke:me.id-_e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var p=[],h=[],v=1,f=null,_=3,w=!1,C=!1,R=!1,S=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(me){for(var _e=n(h);_e!==null;){if(_e.callback===null)r(h);else if(_e.startTime<=me)r(h),_e.sortIndex=_e.expirationTime,t(p,_e);else break;_e=n(h)}}function M(me){if(R=!1,E(me),!C)if(n(p)!==null)C=!0,ye(Z);else{var _e=n(h);_e!==null&&ue(M,_e.startTime-me)}}function Z(me,_e){C=!1,R&&(R=!1,b(q),q=-1),w=!0;var ke=_;try{for(E(_e),f=n(p);f!==null&&(!(f.expirationTime>_e)||me&&!ee());){var le=f.callback;if(typeof le=="function"){f.callback=null,_=f.priorityLevel;var Re=le(f.expirationTime<=_e);_e=e.unstable_now(),typeof Re=="function"?f.callback=Re:f===n(p)&&r(p),E(_e)}else r(p);f=n(p)}if(f!==null)var We=!0;else{var Xe=n(h);Xe!==null&&ue(M,Xe.startTime-_e),We=!1}return We}finally{f=null,_=ke,w=!1}}var $=!1,z=null,q=-1,X=5,K=-1;function ee(){return!(e.unstable_now()-K<X)}function oe(){if(z!==null){var me=e.unstable_now();K=me;var _e=!0;try{_e=z(!0,me)}finally{_e?ce():($=!1,z=null)}}else $=!1}var ce;if(typeof x=="function")ce=function(){x(oe)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,Te=ne.port2;ne.port1.onmessage=oe,ce=function(){Te.postMessage(null)}}else ce=function(){S(oe,0)};function ye(me){z=me,$||($=!0,ce())}function ue(me,_e){q=S(function(){me(e.unstable_now())},_e)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(me){me.callback=null},e.unstable_continueExecution=function(){C||w||(C=!0,ye(Z))},e.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<me?Math.floor(1e3/me):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return n(p)},e.unstable_next=function(me){switch(_){case 1:case 2:case 3:var _e=3;break;default:_e=_}var ke=_;_=_e;try{return me()}finally{_=ke}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(me,_e){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var ke=_;_=me;try{return _e()}finally{_=ke}},e.unstable_scheduleCallback=function(me,_e,ke){var le=e.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?le+ke:le):ke=le,me){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=ke+Re,me={id:v++,callback:_e,priorityLevel:me,startTime:ke,expirationTime:Re,sortIndex:-1},ke>le?(me.sortIndex=ke,t(h,me),n(p)===null&&me===n(h)&&(R?(b(q),q=-1):R=!0,ue(M,ke-le))):(me.sortIndex=Re,t(p,me),C||w||(C=!0,ye(Z))),me},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(me){var _e=_;return function(){var ke=_;_=_e;try{return me.apply(this,arguments)}finally{_=ke}}}})(F1);I1.exports=F1;var F2=I1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D2=Rd(),$r=F2;function Ue(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var D1=new Set,Bc={};function qa(e,t){Eo(e,t),Eo(e+"Capture",t)}function Eo(e,t){for(Bc[e]=t,e=0;e<t.length;e++)D1.add(t[e])}var ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dp=Object.prototype.hasOwnProperty,N2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Pg={},kg={};function O2(e){return Dp.call(kg,e)?!0:Dp.call(Pg,e)?!1:N2.test(e)?kg[e]=!0:(Pg[e]=!0,!1)}function M2(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function L2(e,t,n,r){if(t===null||typeof t>"u"||M2(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Cr(e,t,n,r,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){er[e]=new Cr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];er[t]=new Cr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){er[e]=new Cr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){er[e]=new Cr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){er[e]=new Cr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){er[e]=new Cr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){er[e]=new Cr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){er[e]=new Cr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){er[e]=new Cr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zf=/[\-:]([a-z])/g;function Qf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zf,Qf);er[t]=new Cr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zf,Qf);er[t]=new Cr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zf,Qf);er[t]=new Cr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){er[e]=new Cr(e,1,!1,e.toLowerCase(),null,!1,!1)});er.xlinkHref=new Cr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){er[e]=new Cr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Xf(e,t,n,r){var i=er.hasOwnProperty(t)?er[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(L2(t,n,i,r)&&(n=null),r||i===null?O2(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Ss=D2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zl=Symbol.for("react.element"),to=Symbol.for("react.portal"),no=Symbol.for("react.fragment"),Yf=Symbol.for("react.strict_mode"),Np=Symbol.for("react.profiler"),N1=Symbol.for("react.provider"),O1=Symbol.for("react.context"),em=Symbol.for("react.forward_ref"),Op=Symbol.for("react.suspense"),Mp=Symbol.for("react.suspense_list"),tm=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),M1=Symbol.for("react.offscreen"),Tg=Symbol.iterator;function oc(e){return e===null||typeof e!="object"?null:(e=Tg&&e[Tg]||e["@@iterator"],typeof e=="function"?e:null)}var _n=Object.assign,zh;function Cc(e){if(zh===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);zh=t&&t[1]||""}return`
`+zh+e}var Kh=!1;function $h(e,t){if(!e||Kh)return"";Kh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),a=r.stack.split(`
`),o=i.length-1,u=a.length-1;1<=o&&0<=u&&i[o]!==a[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==a[u]){if(o!==1||u!==1)do if(o--,u--,0>u||i[o]!==a[u]){var p=`
`+i[o].replace(" at new "," at ");return e.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",e.displayName)),p}while(1<=o&&0<=u);break}}}finally{Kh=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Cc(e):""}function j2(e){switch(e.tag){case 5:return Cc(e.type);case 16:return Cc("Lazy");case 13:return Cc("Suspense");case 19:return Cc("SuspenseList");case 0:case 2:case 15:return e=$h(e.type,!1),e;case 11:return e=$h(e.type.render,!1),e;case 1:return e=$h(e.type,!0),e;default:return""}}function Lp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case no:return"Fragment";case to:return"Portal";case Np:return"Profiler";case Yf:return"StrictMode";case Op:return"Suspense";case Mp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case O1:return(e.displayName||"Context")+".Consumer";case N1:return(e._context.displayName||"Context")+".Provider";case em:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case tm:return t=e.displayName||null,t!==null?t:Lp(e.type)||"Memo";case js:t=e._payload,e=e._init;try{return Lp(e(t))}catch{}}return null}function B2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lp(t);case 8:return t===Yf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ys(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function L1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function U2(e){var t=L1(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ql(e){e._valueTracker||(e._valueTracker=U2(e))}function j1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=L1(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function zu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function jp(e,t){var n=t.checked;return _n({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Rg(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ys(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function B1(e,t){t=t.checked,t!=null&&Xf(e,"checked",t,!1)}function Bp(e,t){B1(e,t);var n=Ys(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Up(e,t.type,n):t.hasOwnProperty("defaultValue")&&Up(e,t.type,Ys(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ag(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Up(e,t,n){(t!=="number"||zu(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ec=Array.isArray;function vo(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ys(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Hp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ue(91));return _n({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ig(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Ue(92));if(Ec(n)){if(1<n.length)throw Error(Ue(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ys(n)}}function U1(e,t){var n=Ys(t.value),r=Ys(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Fg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function H1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?H1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Xl,V1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Xl=Xl||document.createElement("div"),Xl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Xl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Uc(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Rc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},H2=["Webkit","ms","Moz","O"];Object.keys(Rc).forEach(function(e){H2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rc[t]=Rc[e]})});function q1(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Rc.hasOwnProperty(e)&&Rc[e]?(""+t).trim():t+"px"}function z1(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=q1(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var V2=_n({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qp(e,t){if(t){if(V2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ue(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ue(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ue(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ue(62))}}function zp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kp=null;function nm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $p=null,yo=null,_o=null;function Dg(e){if(e=Sl(e)){if(typeof $p!="function")throw Error(Ue(280));var t=e.stateNode;t&&(t=Nd(t),$p(e.stateNode,e.type,t))}}function K1(e){yo?_o?_o.push(e):_o=[e]:yo=e}function $1(){if(yo){var e=yo,t=_o;if(_o=yo=null,Dg(e),t)for(e=0;e<t.length;e++)Dg(t[e])}}function W1(e,t){return e(t)}function G1(){}var Wh=!1;function J1(e,t,n){if(Wh)return e(t,n);Wh=!0;try{return W1(e,t,n)}finally{Wh=!1,(yo!==null||_o!==null)&&(G1(),$1())}}function Hc(e,t){var n=e.stateNode;if(n===null)return null;var r=Nd(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Ue(231,t,typeof n));return n}var Wp=!1;if(ms)try{var cc={};Object.defineProperty(cc,"passive",{get:function(){Wp=!0}}),window.addEventListener("test",cc,cc),window.removeEventListener("test",cc,cc)}catch{Wp=!1}function q2(e,t,n,r,i,a,o,u,p){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(v){this.onError(v)}}var Ac=!1,Ku=null,$u=!1,Gp=null,z2={onError:function(e){Ac=!0,Ku=e}};function K2(e,t,n,r,i,a,o,u,p){Ac=!1,Ku=null,q2.apply(z2,arguments)}function $2(e,t,n,r,i,a,o,u,p){if(K2.apply(this,arguments),Ac){if(Ac){var h=Ku;Ac=!1,Ku=null}else throw Error(Ue(198));$u||($u=!0,Gp=h)}}function za(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Z1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ng(e){if(za(e)!==e)throw Error(Ue(188))}function W2(e){var t=e.alternate;if(!t){if(t=za(e),t===null)throw Error(Ue(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Ng(i),e;if(a===r)return Ng(i),t;a=a.sibling}throw Error(Ue(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=a;break}if(u===r){o=!0,r=i,n=a;break}u=u.sibling}if(!o){for(u=a.child;u;){if(u===n){o=!0,n=a,r=i;break}if(u===r){o=!0,r=a,n=i;break}u=u.sibling}if(!o)throw Error(Ue(189))}}if(n.alternate!==r)throw Error(Ue(190))}if(n.tag!==3)throw Error(Ue(188));return n.stateNode.current===n?e:t}function Q1(e){return e=W2(e),e!==null?X1(e):null}function X1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=X1(e);if(t!==null)return t;e=e.sibling}return null}var Y1=$r.unstable_scheduleCallback,Og=$r.unstable_cancelCallback,G2=$r.unstable_shouldYield,J2=$r.unstable_requestPaint,En=$r.unstable_now,Z2=$r.unstable_getCurrentPriorityLevel,rm=$r.unstable_ImmediatePriority,e0=$r.unstable_UserBlockingPriority,Wu=$r.unstable_NormalPriority,Q2=$r.unstable_LowPriority,t0=$r.unstable_IdlePriority,Ad=null,Wi=null;function X2(e){if(Wi&&typeof Wi.onCommitFiberRoot=="function")try{Wi.onCommitFiberRoot(Ad,e,void 0,(e.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:tS,Y2=Math.log,eS=Math.LN2;function tS(e){return e>>>=0,e===0?32:31-(Y2(e)/eS|0)|0}var Yl=64,eu=4194304;function Pc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Gu(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=n&268435455;if(o!==0){var u=o&~i;u!==0?r=Pc(u):(a&=o,a!==0&&(r=Pc(a)))}else o=n&~i,o!==0?r=Pc(o):a!==0&&(r=Pc(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Pi(t),i=1<<n,r|=e[n],t&=~i;return r}function nS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rS(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Pi(a),u=1<<o,p=i[o];p===-1?(!(u&n)||u&r)&&(i[o]=nS(u,t)):p<=t&&(e.expiredLanes|=u),a&=~u}}function Jp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function n0(){var e=Yl;return Yl<<=1,!(Yl&4194240)&&(Yl=64),e}function Gh(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function _l(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pi(t),e[t]=n}function iS(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Pi(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function im(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Pi(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Xt=0;function r0(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var i0,sm,s0,a0,o0,Zp=!1,tu=[],Ks=null,$s=null,Ws=null,Vc=new Map,qc=new Map,Us=[],sS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mg(e,t){switch(e){case"focusin":case"focusout":Ks=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Ws=null;break;case"pointerover":case"pointerout":Vc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qc.delete(t.pointerId)}}function lc(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Sl(t),t!==null&&sm(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function aS(e,t,n,r,i){switch(t){case"focusin":return Ks=lc(Ks,e,t,n,r,i),!0;case"dragenter":return $s=lc($s,e,t,n,r,i),!0;case"mouseover":return Ws=lc(Ws,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Vc.set(a,lc(Vc.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,qc.set(a,lc(qc.get(a)||null,e,t,n,r,i)),!0}return!1}function c0(e){var t=Ca(e.target);if(t!==null){var n=za(t);if(n!==null){if(t=n.tag,t===13){if(t=Z1(n),t!==null){e.blockedOn=t,o0(e.priority,function(){s0(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _u(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qp(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Kp=r,n.target.dispatchEvent(r),Kp=null}else return t=Sl(n),t!==null&&sm(t),e.blockedOn=n,!1;t.shift()}return!0}function Lg(e,t,n){_u(e)&&n.delete(t)}function oS(){Zp=!1,Ks!==null&&_u(Ks)&&(Ks=null),$s!==null&&_u($s)&&($s=null),Ws!==null&&_u(Ws)&&(Ws=null),Vc.forEach(Lg),qc.forEach(Lg)}function uc(e,t){e.blockedOn===t&&(e.blockedOn=null,Zp||(Zp=!0,$r.unstable_scheduleCallback($r.unstable_NormalPriority,oS)))}function zc(e){function t(i){return uc(i,e)}if(0<tu.length){uc(tu[0],e);for(var n=1;n<tu.length;n++){var r=tu[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ks!==null&&uc(Ks,e),$s!==null&&uc($s,e),Ws!==null&&uc(Ws,e),Vc.forEach(t),qc.forEach(t),n=0;n<Us.length;n++)r=Us[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Us.length&&(n=Us[0],n.blockedOn===null);)c0(n),n.blockedOn===null&&Us.shift()}var bo=Ss.ReactCurrentBatchConfig,Ju=!0;function cS(e,t,n,r){var i=Xt,a=bo.transition;bo.transition=null;try{Xt=1,am(e,t,n,r)}finally{Xt=i,bo.transition=a}}function lS(e,t,n,r){var i=Xt,a=bo.transition;bo.transition=null;try{Xt=4,am(e,t,n,r)}finally{Xt=i,bo.transition=a}}function am(e,t,n,r){if(Ju){var i=Qp(e,t,n,r);if(i===null)ip(e,t,r,Zu,n),Mg(e,r);else if(aS(i,e,t,n,r))r.stopPropagation();else if(Mg(e,r),t&4&&-1<sS.indexOf(e)){for(;i!==null;){var a=Sl(i);if(a!==null&&i0(a),a=Qp(e,t,n,r),a===null&&ip(e,t,r,Zu,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else ip(e,t,r,null,n)}}var Zu=null;function Qp(e,t,n,r){if(Zu=null,e=nm(r),e=Ca(e),e!==null)if(t=za(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Z1(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zu=e,null}function l0(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z2()){case rm:return 1;case e0:return 4;case Wu:case Q2:return 16;case t0:return 536870912;default:return 16}default:return 16}}var qs=null,om=null,bu=null;function u0(){if(bu)return bu;var e,t=om,n=t.length,r,i="value"in qs?qs.value:qs.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return bu=i.slice(e,1<r?1-r:void 0)}function Su(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function nu(){return!0}function jg(){return!1}function Gr(e){function t(n,r,i,a,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(a):a[u]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?nu:jg,this.isPropagationStopped=jg,this}return _n(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=nu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=nu)},persist:function(){},isPersistent:nu}),t}var Bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cm=Gr(Bo),bl=_n({},Bo,{view:0,detail:0}),uS=Gr(bl),Jh,Zh,dc,Id=_n({},bl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dc&&(dc&&e.type==="mousemove"?(Jh=e.screenX-dc.screenX,Zh=e.screenY-dc.screenY):Zh=Jh=0,dc=e),Jh)},movementY:function(e){return"movementY"in e?e.movementY:Zh}}),Bg=Gr(Id),dS=_n({},Id,{dataTransfer:0}),hS=Gr(dS),pS=_n({},bl,{relatedTarget:0}),Qh=Gr(pS),fS=_n({},Bo,{animationName:0,elapsedTime:0,pseudoElement:0}),mS=Gr(fS),gS=_n({},Bo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vS=Gr(gS),yS=_n({},Bo,{data:0}),Ug=Gr(yS),_S={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=SS[e])?!!t[e]:!1}function lm(){return wS}var xS=_n({},bl,{key:function(e){if(e.key){var t=_S[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Su(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?bS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lm,charCode:function(e){return e.type==="keypress"?Su(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Su(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),CS=Gr(xS),ES=_n({},Id,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hg=Gr(ES),PS=_n({},bl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lm}),kS=Gr(PS),TS=_n({},Bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),RS=Gr(TS),AS=_n({},Id,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),IS=Gr(AS),FS=[9,13,27,32],um=ms&&"CompositionEvent"in window,Ic=null;ms&&"documentMode"in document&&(Ic=document.documentMode);var DS=ms&&"TextEvent"in window&&!Ic,d0=ms&&(!um||Ic&&8<Ic&&11>=Ic),Vg=" ",qg=!1;function h0(e,t){switch(e){case"keyup":return FS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function p0(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ro=!1;function NS(e,t){switch(e){case"compositionend":return p0(t);case"keypress":return t.which!==32?null:(qg=!0,Vg);case"textInput":return e=t.data,e===Vg&&qg?null:e;default:return null}}function OS(e,t){if(ro)return e==="compositionend"||!um&&h0(e,t)?(e=u0(),bu=om=qs=null,ro=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return d0&&t.locale!=="ko"?null:t.data;default:return null}}var MS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!MS[e.type]:t==="textarea"}function f0(e,t,n,r){K1(r),t=Qu(t,"onChange"),0<t.length&&(n=new cm("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Fc=null,Kc=null;function LS(e){E0(e,0)}function Fd(e){var t=ao(e);if(j1(t))return e}function jS(e,t){if(e==="change")return t}var m0=!1;if(ms){var Xh;if(ms){var Yh="oninput"in document;if(!Yh){var Kg=document.createElement("div");Kg.setAttribute("oninput","return;"),Yh=typeof Kg.oninput=="function"}Xh=Yh}else Xh=!1;m0=Xh&&(!document.documentMode||9<document.documentMode)}function $g(){Fc&&(Fc.detachEvent("onpropertychange",g0),Kc=Fc=null)}function g0(e){if(e.propertyName==="value"&&Fd(Kc)){var t=[];f0(t,Kc,e,nm(e)),J1(LS,t)}}function BS(e,t,n){e==="focusin"?($g(),Fc=t,Kc=n,Fc.attachEvent("onpropertychange",g0)):e==="focusout"&&$g()}function US(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Fd(Kc)}function HS(e,t){if(e==="click")return Fd(t)}function VS(e,t){if(e==="input"||e==="change")return Fd(t)}function qS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ai=typeof Object.is=="function"?Object.is:qS;function $c(e,t){if(Ai(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Dp.call(t,i)||!Ai(e[i],t[i]))return!1}return!0}function Wg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Gg(e,t){var n=Wg(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Wg(n)}}function v0(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?v0(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function y0(){for(var e=window,t=zu();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=zu(e.document)}return t}function dm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function zS(e){var t=y0(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&v0(n.ownerDocument.documentElement,n)){if(r!==null&&dm(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Gg(n,a);var o=Gg(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var KS=ms&&"documentMode"in document&&11>=document.documentMode,io=null,Xp=null,Dc=null,Yp=!1;function Jg(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yp||io==null||io!==zu(r)||(r=io,"selectionStart"in r&&dm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Dc&&$c(Dc,r)||(Dc=r,r=Qu(Xp,"onSelect"),0<r.length&&(t=new cm("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=io)))}function ru(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var so={animationend:ru("Animation","AnimationEnd"),animationiteration:ru("Animation","AnimationIteration"),animationstart:ru("Animation","AnimationStart"),transitionend:ru("Transition","TransitionEnd")},ep={},_0={};ms&&(_0=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function Dd(e){if(ep[e])return ep[e];if(!so[e])return e;var t=so[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in _0)return ep[e]=t[n];return e}var b0=Dd("animationend"),S0=Dd("animationiteration"),w0=Dd("animationstart"),x0=Dd("transitionend"),C0=new Map,Zg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ia(e,t){C0.set(e,t),qa(t,[e])}for(var tp=0;tp<Zg.length;tp++){var np=Zg[tp],$S=np.toLowerCase(),WS=np[0].toUpperCase()+np.slice(1);ia($S,"on"+WS)}ia(b0,"onAnimationEnd");ia(S0,"onAnimationIteration");ia(w0,"onAnimationStart");ia("dblclick","onDoubleClick");ia("focusin","onFocus");ia("focusout","onBlur");ia(x0,"onTransitionEnd");Eo("onMouseEnter",["mouseout","mouseover"]);Eo("onMouseLeave",["mouseout","mouseover"]);Eo("onPointerEnter",["pointerout","pointerover"]);Eo("onPointerLeave",["pointerout","pointerover"]);qa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qa("onBeforeInput",["compositionend","keypress","textInput","paste"]);qa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GS=new Set("cancel close invalid load scroll toggle".split(" ").concat(kc));function Qg(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,$2(r,t,void 0,e),e.currentTarget=null}function E0(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],p=u.instance,h=u.currentTarget;if(u=u.listener,p!==a&&i.isPropagationStopped())break e;Qg(i,u,h),a=p}else for(o=0;o<r.length;o++){if(u=r[o],p=u.instance,h=u.currentTarget,u=u.listener,p!==a&&i.isPropagationStopped())break e;Qg(i,u,h),a=p}}}if($u)throw e=Gp,$u=!1,Gp=null,e}function cn(e,t){var n=t[sf];n===void 0&&(n=t[sf]=new Set);var r=e+"__bubble";n.has(r)||(P0(t,e,2,!1),n.add(r))}function rp(e,t,n){var r=0;t&&(r|=4),P0(n,e,r,t)}var iu="_reactListening"+Math.random().toString(36).slice(2);function Wc(e){if(!e[iu]){e[iu]=!0,D1.forEach(function(n){n!=="selectionchange"&&(GS.has(n)||rp(n,!1,e),rp(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[iu]||(t[iu]=!0,rp("selectionchange",!1,t))}}function P0(e,t,n,r){switch(l0(t)){case 1:var i=cS;break;case 4:i=lS;break;default:i=am}n=i.bind(null,t,n,e),i=void 0,!Wp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function ip(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var p=o.tag;if((p===3||p===4)&&(p=o.stateNode.containerInfo,p===i||p.nodeType===8&&p.parentNode===i))return;o=o.return}for(;u!==null;){if(o=Ca(u),o===null)return;if(p=o.tag,p===5||p===6){r=a=o;continue e}u=u.parentNode}}r=r.return}J1(function(){var h=a,v=nm(n),f=[];e:{var _=C0.get(e);if(_!==void 0){var w=cm,C=e;switch(e){case"keypress":if(Su(n)===0)break e;case"keydown":case"keyup":w=CS;break;case"focusin":C="focus",w=Qh;break;case"focusout":C="blur",w=Qh;break;case"beforeblur":case"afterblur":w=Qh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Bg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=hS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=kS;break;case b0:case S0:case w0:w=mS;break;case x0:w=RS;break;case"scroll":w=uS;break;case"wheel":w=IS;break;case"copy":case"cut":case"paste":w=vS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Hg}var R=(t&4)!==0,S=!R&&e==="scroll",b=R?_!==null?_+"Capture":null:_;R=[];for(var x=h,E;x!==null;){E=x;var M=E.stateNode;if(E.tag===5&&M!==null&&(E=M,b!==null&&(M=Hc(x,b),M!=null&&R.push(Gc(x,M,E)))),S)break;x=x.return}0<R.length&&(_=new w(_,C,null,n,v),f.push({event:_,listeners:R}))}}if(!(t&7)){e:{if(_=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",_&&n!==Kp&&(C=n.relatedTarget||n.fromElement)&&(Ca(C)||C[gs]))break e;if((w||_)&&(_=v.window===v?v:(_=v.ownerDocument)?_.defaultView||_.parentWindow:window,w?(C=n.relatedTarget||n.toElement,w=h,C=C?Ca(C):null,C!==null&&(S=za(C),C!==S||C.tag!==5&&C.tag!==6)&&(C=null)):(w=null,C=h),w!==C)){if(R=Bg,M="onMouseLeave",b="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(R=Hg,M="onPointerLeave",b="onPointerEnter",x="pointer"),S=w==null?_:ao(w),E=C==null?_:ao(C),_=new R(M,x+"leave",w,n,v),_.target=S,_.relatedTarget=E,M=null,Ca(v)===h&&(R=new R(b,x+"enter",C,n,v),R.target=E,R.relatedTarget=S,M=R),S=M,w&&C)t:{for(R=w,b=C,x=0,E=R;E;E=Qa(E))x++;for(E=0,M=b;M;M=Qa(M))E++;for(;0<x-E;)R=Qa(R),x--;for(;0<E-x;)b=Qa(b),E--;for(;x--;){if(R===b||b!==null&&R===b.alternate)break t;R=Qa(R),b=Qa(b)}R=null}else R=null;w!==null&&Xg(f,_,w,R,!1),C!==null&&S!==null&&Xg(f,S,C,R,!0)}}e:{if(_=h?ao(h):window,w=_.nodeName&&_.nodeName.toLowerCase(),w==="select"||w==="input"&&_.type==="file")var Z=jS;else if(zg(_))if(m0)Z=VS;else{Z=US;var $=BS}else(w=_.nodeName)&&w.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(Z=HS);if(Z&&(Z=Z(e,h))){f0(f,Z,n,v);break e}$&&$(e,_,h),e==="focusout"&&($=_._wrapperState)&&$.controlled&&_.type==="number"&&Up(_,"number",_.value)}switch($=h?ao(h):window,e){case"focusin":(zg($)||$.contentEditable==="true")&&(io=$,Xp=h,Dc=null);break;case"focusout":Dc=Xp=io=null;break;case"mousedown":Yp=!0;break;case"contextmenu":case"mouseup":case"dragend":Yp=!1,Jg(f,n,v);break;case"selectionchange":if(KS)break;case"keydown":case"keyup":Jg(f,n,v)}var z;if(um)e:{switch(e){case"compositionstart":var q="onCompositionStart";break e;case"compositionend":q="onCompositionEnd";break e;case"compositionupdate":q="onCompositionUpdate";break e}q=void 0}else ro?h0(e,n)&&(q="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(q="onCompositionStart");q&&(d0&&n.locale!=="ko"&&(ro||q!=="onCompositionStart"?q==="onCompositionEnd"&&ro&&(z=u0()):(qs=v,om="value"in qs?qs.value:qs.textContent,ro=!0)),$=Qu(h,q),0<$.length&&(q=new Ug(q,e,null,n,v),f.push({event:q,listeners:$}),z?q.data=z:(z=p0(n),z!==null&&(q.data=z)))),(z=DS?NS(e,n):OS(e,n))&&(h=Qu(h,"onBeforeInput"),0<h.length&&(v=new Ug("onBeforeInput","beforeinput",null,n,v),f.push({event:v,listeners:h}),v.data=z))}E0(f,t)})}function Gc(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qu(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Hc(e,n),a!=null&&r.unshift(Gc(e,a,i)),a=Hc(e,t),a!=null&&r.push(Gc(e,a,i))),e=e.return}return r}function Qa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Xg(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var u=n,p=u.alternate,h=u.stateNode;if(p!==null&&p===r)break;u.tag===5&&h!==null&&(u=h,i?(p=Hc(n,a),p!=null&&o.unshift(Gc(n,p,u))):i||(p=Hc(n,a),p!=null&&o.push(Gc(n,p,u)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var JS=/\r\n?/g,ZS=/\u0000|\uFFFD/g;function Yg(e){return(typeof e=="string"?e:""+e).replace(JS,`
`).replace(ZS,"")}function su(e,t,n){if(t=Yg(t),Yg(e)!==t&&n)throw Error(Ue(425))}function Xu(){}var ef=null,tf=null;function nf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var rf=typeof setTimeout=="function"?setTimeout:void 0,QS=typeof clearTimeout=="function"?clearTimeout:void 0,ev=typeof Promise=="function"?Promise:void 0,XS=typeof queueMicrotask=="function"?queueMicrotask:typeof ev<"u"?function(e){return ev.resolve(null).then(e).catch(YS)}:rf;function YS(e){setTimeout(function(){throw e})}function sp(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),zc(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);zc(t)}function Gs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function tv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Uo=Math.random().toString(36).slice(2),$i="__reactFiber$"+Uo,Jc="__reactProps$"+Uo,gs="__reactContainer$"+Uo,sf="__reactEvents$"+Uo,ew="__reactListeners$"+Uo,tw="__reactHandles$"+Uo;function Ca(e){var t=e[$i];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gs]||n[$i]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=tv(e);e!==null;){if(n=e[$i])return n;e=tv(e)}return t}e=n,n=e.parentNode}return null}function Sl(e){return e=e[$i]||e[gs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ao(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ue(33))}function Nd(e){return e[Jc]||null}var af=[],oo=-1;function sa(e){return{current:e}}function ln(e){0>oo||(e.current=af[oo],af[oo]=null,oo--)}function rn(e,t){oo++,af[oo]=e.current,e.current=t}var ea={},ur=sa(ea),Nr=sa(!1),Oa=ea;function Po(e,t){var n=e.type.contextTypes;if(!n)return ea;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Or(e){return e=e.childContextTypes,e!=null}function Yu(){ln(Nr),ln(ur)}function nv(e,t,n){if(ur.current!==ea)throw Error(Ue(168));rn(ur,t),rn(Nr,n)}function k0(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(Ue(108,B2(e)||"Unknown",i));return _n({},n,r)}function ed(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ea,Oa=ur.current,rn(ur,e),rn(Nr,Nr.current),!0}function rv(e,t,n){var r=e.stateNode;if(!r)throw Error(Ue(169));n?(e=k0(e,t,Oa),r.__reactInternalMemoizedMergedChildContext=e,ln(Nr),ln(ur),rn(ur,e)):ln(Nr),rn(Nr,n)}var us=null,Od=!1,ap=!1;function T0(e){us===null?us=[e]:us.push(e)}function nw(e){Od=!0,T0(e)}function aa(){if(!ap&&us!==null){ap=!0;var e=0,t=Xt;try{var n=us;for(Xt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}us=null,Od=!1}catch(i){throw us!==null&&(us=us.slice(e+1)),Y1(rm,aa),i}finally{Xt=t,ap=!1}}return null}var co=[],lo=0,td=null,nd=0,ii=[],si=0,Ma=null,hs=1,ps="";function ba(e,t){co[lo++]=nd,co[lo++]=td,td=e,nd=t}function R0(e,t,n){ii[si++]=hs,ii[si++]=ps,ii[si++]=Ma,Ma=e;var r=hs;e=ps;var i=32-Pi(r)-1;r&=~(1<<i),n+=1;var a=32-Pi(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,hs=1<<32-Pi(t)+i|n<<i|r,ps=a+e}else hs=1<<a|n<<i|r,ps=e}function hm(e){e.return!==null&&(ba(e,1),R0(e,1,0))}function pm(e){for(;e===td;)td=co[--lo],co[lo]=null,nd=co[--lo],co[lo]=null;for(;e===Ma;)Ma=ii[--si],ii[si]=null,ps=ii[--si],ii[si]=null,hs=ii[--si],ii[si]=null}var Kr=null,zr=null,dn=!1,xi=null;function A0(e,t){var n=ai(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function iv(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Kr=e,zr=Gs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Kr=e,zr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ma!==null?{id:hs,overflow:ps}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=ai(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Kr=e,zr=null,!0):!1;default:return!1}}function of(e){return(e.mode&1)!==0&&(e.flags&128)===0}function cf(e){if(dn){var t=zr;if(t){var n=t;if(!iv(e,t)){if(of(e))throw Error(Ue(418));t=Gs(n.nextSibling);var r=Kr;t&&iv(e,t)?A0(r,n):(e.flags=e.flags&-4097|2,dn=!1,Kr=e)}}else{if(of(e))throw Error(Ue(418));e.flags=e.flags&-4097|2,dn=!1,Kr=e}}}function sv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Kr=e}function au(e){if(e!==Kr)return!1;if(!dn)return sv(e),dn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!nf(e.type,e.memoizedProps)),t&&(t=zr)){if(of(e))throw I0(),Error(Ue(418));for(;t;)A0(e,t),t=Gs(t.nextSibling)}if(sv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ue(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){zr=Gs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}zr=null}}else zr=Kr?Gs(e.stateNode.nextSibling):null;return!0}function I0(){for(var e=zr;e;)e=Gs(e.nextSibling)}function ko(){zr=Kr=null,dn=!1}function fm(e){xi===null?xi=[e]:xi.push(e)}var rw=Ss.ReactCurrentBatchConfig;function hc(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ue(309));var r=n.stateNode}if(!r)throw Error(Ue(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var u=i.refs;o===null?delete u[a]:u[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(Ue(284));if(!n._owner)throw Error(Ue(290,e))}return e}function ou(e,t){throw e=Object.prototype.toString.call(t),Error(Ue(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function av(e){var t=e._init;return t(e._payload)}function F0(e){function t(b,x){if(e){var E=b.deletions;E===null?(b.deletions=[x],b.flags|=16):E.push(x)}}function n(b,x){if(!e)return null;for(;x!==null;)t(b,x),x=x.sibling;return null}function r(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function i(b,x){return b=Xs(b,x),b.index=0,b.sibling=null,b}function a(b,x,E){return b.index=E,e?(E=b.alternate,E!==null?(E=E.index,E<x?(b.flags|=2,x):E):(b.flags|=2,x)):(b.flags|=1048576,x)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function u(b,x,E,M){return x===null||x.tag!==6?(x=pp(E,b.mode,M),x.return=b,x):(x=i(x,E),x.return=b,x)}function p(b,x,E,M){var Z=E.type;return Z===no?v(b,x,E.props.children,M,E.key):x!==null&&(x.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===js&&av(Z)===x.type)?(M=i(x,E.props),M.ref=hc(b,x,E),M.return=b,M):(M=Tu(E.type,E.key,E.props,null,b.mode,M),M.ref=hc(b,x,E),M.return=b,M)}function h(b,x,E,M){return x===null||x.tag!==4||x.stateNode.containerInfo!==E.containerInfo||x.stateNode.implementation!==E.implementation?(x=fp(E,b.mode,M),x.return=b,x):(x=i(x,E.children||[]),x.return=b,x)}function v(b,x,E,M,Z){return x===null||x.tag!==7?(x=Fa(E,b.mode,M,Z),x.return=b,x):(x=i(x,E),x.return=b,x)}function f(b,x,E){if(typeof x=="string"&&x!==""||typeof x=="number")return x=pp(""+x,b.mode,E),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Zl:return E=Tu(x.type,x.key,x.props,null,b.mode,E),E.ref=hc(b,null,x),E.return=b,E;case to:return x=fp(x,b.mode,E),x.return=b,x;case js:var M=x._init;return f(b,M(x._payload),E)}if(Ec(x)||oc(x))return x=Fa(x,b.mode,E,null),x.return=b,x;ou(b,x)}return null}function _(b,x,E,M){var Z=x!==null?x.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return Z!==null?null:u(b,x,""+E,M);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Zl:return E.key===Z?p(b,x,E,M):null;case to:return E.key===Z?h(b,x,E,M):null;case js:return Z=E._init,_(b,x,Z(E._payload),M)}if(Ec(E)||oc(E))return Z!==null?null:v(b,x,E,M,null);ou(b,E)}return null}function w(b,x,E,M,Z){if(typeof M=="string"&&M!==""||typeof M=="number")return b=b.get(E)||null,u(x,b,""+M,Z);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Zl:return b=b.get(M.key===null?E:M.key)||null,p(x,b,M,Z);case to:return b=b.get(M.key===null?E:M.key)||null,h(x,b,M,Z);case js:var $=M._init;return w(b,x,E,$(M._payload),Z)}if(Ec(M)||oc(M))return b=b.get(E)||null,v(x,b,M,Z,null);ou(x,M)}return null}function C(b,x,E,M){for(var Z=null,$=null,z=x,q=x=0,X=null;z!==null&&q<E.length;q++){z.index>q?(X=z,z=null):X=z.sibling;var K=_(b,z,E[q],M);if(K===null){z===null&&(z=X);break}e&&z&&K.alternate===null&&t(b,z),x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K,z=X}if(q===E.length)return n(b,z),dn&&ba(b,q),Z;if(z===null){for(;q<E.length;q++)z=f(b,E[q],M),z!==null&&(x=a(z,x,q),$===null?Z=z:$.sibling=z,$=z);return dn&&ba(b,q),Z}for(z=r(b,z);q<E.length;q++)X=w(z,b,q,E[q],M),X!==null&&(e&&X.alternate!==null&&z.delete(X.key===null?q:X.key),x=a(X,x,q),$===null?Z=X:$.sibling=X,$=X);return e&&z.forEach(function(ee){return t(b,ee)}),dn&&ba(b,q),Z}function R(b,x,E,M){var Z=oc(E);if(typeof Z!="function")throw Error(Ue(150));if(E=Z.call(E),E==null)throw Error(Ue(151));for(var $=Z=null,z=x,q=x=0,X=null,K=E.next();z!==null&&!K.done;q++,K=E.next()){z.index>q?(X=z,z=null):X=z.sibling;var ee=_(b,z,K.value,M);if(ee===null){z===null&&(z=X);break}e&&z&&ee.alternate===null&&t(b,z),x=a(ee,x,q),$===null?Z=ee:$.sibling=ee,$=ee,z=X}if(K.done)return n(b,z),dn&&ba(b,q),Z;if(z===null){for(;!K.done;q++,K=E.next())K=f(b,K.value,M),K!==null&&(x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K);return dn&&ba(b,q),Z}for(z=r(b,z);!K.done;q++,K=E.next())K=w(z,b,q,K.value,M),K!==null&&(e&&K.alternate!==null&&z.delete(K.key===null?q:K.key),x=a(K,x,q),$===null?Z=K:$.sibling=K,$=K);return e&&z.forEach(function(oe){return t(b,oe)}),dn&&ba(b,q),Z}function S(b,x,E,M){if(typeof E=="object"&&E!==null&&E.type===no&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Zl:e:{for(var Z=E.key,$=x;$!==null;){if($.key===Z){if(Z=E.type,Z===no){if($.tag===7){n(b,$.sibling),x=i($,E.props.children),x.return=b,b=x;break e}}else if($.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===js&&av(Z)===$.type){n(b,$.sibling),x=i($,E.props),x.ref=hc(b,$,E),x.return=b,b=x;break e}n(b,$);break}else t(b,$);$=$.sibling}E.type===no?(x=Fa(E.props.children,b.mode,M,E.key),x.return=b,b=x):(M=Tu(E.type,E.key,E.props,null,b.mode,M),M.ref=hc(b,x,E),M.return=b,b=M)}return o(b);case to:e:{for($=E.key;x!==null;){if(x.key===$)if(x.tag===4&&x.stateNode.containerInfo===E.containerInfo&&x.stateNode.implementation===E.implementation){n(b,x.sibling),x=i(x,E.children||[]),x.return=b,b=x;break e}else{n(b,x);break}else t(b,x);x=x.sibling}x=fp(E,b.mode,M),x.return=b,b=x}return o(b);case js:return $=E._init,S(b,x,$(E._payload),M)}if(Ec(E))return C(b,x,E,M);if(oc(E))return R(b,x,E,M);ou(b,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,x!==null&&x.tag===6?(n(b,x.sibling),x=i(x,E),x.return=b,b=x):(n(b,x),x=pp(E,b.mode,M),x.return=b,b=x),o(b)):n(b,x)}return S}var To=F0(!0),D0=F0(!1),rd=sa(null),id=null,uo=null,mm=null;function gm(){mm=uo=id=null}function vm(e){var t=rd.current;ln(rd),e._currentValue=t}function lf(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function So(e,t){id=e,mm=uo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dr=!0),e.firstContext=null)}function ci(e){var t=e._currentValue;if(mm!==e)if(e={context:e,memoizedValue:t,next:null},uo===null){if(id===null)throw Error(Ue(308));uo=e,id.dependencies={lanes:0,firstContext:e}}else uo=uo.next=e;return t}var Ea=null;function ym(e){Ea===null?Ea=[e]:Ea.push(e)}function N0(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,ym(t)):(n.next=i.next,i.next=n),t.interleaved=n,vs(e,r)}function vs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Bs=!1;function _m(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function O0(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Js(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,qt&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,vs(e,n)}return i=r.interleaved,i===null?(t.next=t,ym(r)):(t.next=i.next,i.next=t),r.interleaved=t,vs(e,n)}function wu(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,im(e,n)}}function ov(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function sd(e,t,n,r){var i=e.updateQueue;Bs=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var p=u,h=p.next;p.next=null,o===null?a=h:o.next=h,o=p;var v=e.alternate;v!==null&&(v=v.updateQueue,u=v.lastBaseUpdate,u!==o&&(u===null?v.firstBaseUpdate=h:u.next=h,v.lastBaseUpdate=p))}if(a!==null){var f=i.baseState;o=0,v=h=p=null,u=a;do{var _=u.lane,w=u.eventTime;if((r&_)===_){v!==null&&(v=v.next={eventTime:w,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var C=e,R=u;switch(_=t,w=n,R.tag){case 1:if(C=R.payload,typeof C=="function"){f=C.call(w,f,_);break e}f=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=R.payload,_=typeof C=="function"?C.call(w,f,_):C,_==null)break e;f=_n({},f,_);break e;case 2:Bs=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,_=i.effects,_===null?i.effects=[u]:_.push(u))}else w={eventTime:w,lane:_,tag:u.tag,payload:u.payload,callback:u.callback,next:null},v===null?(h=v=w,p=f):v=v.next=w,o|=_;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;_=u,u=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(!0);if(v===null&&(p=f),i.baseState=p,i.firstBaseUpdate=h,i.lastBaseUpdate=v,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);ja|=o,e.lanes=o,e.memoizedState=f}}function cv(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Ue(191,i));i.call(r)}}}var wl={},Gi=sa(wl),Zc=sa(wl),Qc=sa(wl);function Pa(e){if(e===wl)throw Error(Ue(174));return e}function bm(e,t){switch(rn(Qc,t),rn(Zc,e),rn(Gi,wl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vp(t,e)}ln(Gi),rn(Gi,t)}function Ro(){ln(Gi),ln(Zc),ln(Qc)}function M0(e){Pa(Qc.current);var t=Pa(Gi.current),n=Vp(t,e.type);t!==n&&(rn(Zc,e),rn(Gi,n))}function Sm(e){Zc.current===e&&(ln(Gi),ln(Zc))}var vn=sa(0);function ad(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var op=[];function wm(){for(var e=0;e<op.length;e++)op[e]._workInProgressVersionPrimary=null;op.length=0}var xu=Ss.ReactCurrentDispatcher,cp=Ss.ReactCurrentBatchConfig,La=0,yn=null,Mn=null,Vn=null,od=!1,Nc=!1,Xc=0,iw=0;function ir(){throw Error(Ue(321))}function xm(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ai(e[n],t[n]))return!1;return!0}function Cm(e,t,n,r,i,a){if(La=a,yn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,xu.current=e===null||e.memoizedState===null?cw:lw,e=n(r,i),Nc){a=0;do{if(Nc=!1,Xc=0,25<=a)throw Error(Ue(301));a+=1,Vn=Mn=null,t.updateQueue=null,xu.current=uw,e=n(r,i)}while(Nc)}if(xu.current=cd,t=Mn!==null&&Mn.next!==null,La=0,Vn=Mn=yn=null,od=!1,t)throw Error(Ue(300));return e}function Em(){var e=Xc!==0;return Xc=0,e}function Ki(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?yn.memoizedState=Vn=e:Vn=Vn.next=e,Vn}function li(){if(Mn===null){var e=yn.alternate;e=e!==null?e.memoizedState:null}else e=Mn.next;var t=Vn===null?yn.memoizedState:Vn.next;if(t!==null)Vn=t,Mn=e;else{if(e===null)throw Error(Ue(310));Mn=e,e={memoizedState:Mn.memoizedState,baseState:Mn.baseState,baseQueue:Mn.baseQueue,queue:Mn.queue,next:null},Vn===null?yn.memoizedState=Vn=e:Vn=Vn.next=e}return Vn}function Yc(e,t){return typeof t=="function"?t(e):t}function lp(e){var t=li(),n=t.queue;if(n===null)throw Error(Ue(311));n.lastRenderedReducer=e;var r=Mn,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var u=o=null,p=null,h=a;do{var v=h.lane;if((La&v)===v)p!==null&&(p=p.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var f={lane:v,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};p===null?(u=p=f,o=r):p=p.next=f,yn.lanes|=v,ja|=v}h=h.next}while(h!==null&&h!==a);p===null?o=r:p.next=u,Ai(r,t.memoizedState)||(Dr=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=p,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,yn.lanes|=a,ja|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function up(e){var t=li(),n=t.queue;if(n===null)throw Error(Ue(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Ai(a,t.memoizedState)||(Dr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function L0(){}function j0(e,t){var n=yn,r=li(),i=t(),a=!Ai(r.memoizedState,i);if(a&&(r.memoizedState=i,Dr=!0),r=r.queue,Pm(H0.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Vn!==null&&Vn.memoizedState.tag&1){if(n.flags|=2048,el(9,U0.bind(null,n,r,i,t),void 0,null),qn===null)throw Error(Ue(349));La&30||B0(n,t,i)}return i}function B0(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=yn.updateQueue,t===null?(t={lastEffect:null,stores:null},yn.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function U0(e,t,n,r){t.value=n,t.getSnapshot=r,V0(t)&&q0(e)}function H0(e,t,n){return n(function(){V0(t)&&q0(e)})}function V0(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ai(e,n)}catch{return!0}}function q0(e){var t=vs(e,1);t!==null&&ki(t,e,1,-1)}function lv(e){var t=Ki();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yc,lastRenderedState:e},t.queue=e,e=e.dispatch=ow.bind(null,yn,e),[t.memoizedState,e]}function el(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=yn.updateQueue,t===null?(t={lastEffect:null,stores:null},yn.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function z0(){return li().memoizedState}function Cu(e,t,n,r){var i=Ki();yn.flags|=e,i.memoizedState=el(1|t,n,void 0,r===void 0?null:r)}function Md(e,t,n,r){var i=li();r=r===void 0?null:r;var a=void 0;if(Mn!==null){var o=Mn.memoizedState;if(a=o.destroy,r!==null&&xm(r,o.deps)){i.memoizedState=el(t,n,a,r);return}}yn.flags|=e,i.memoizedState=el(1|t,n,a,r)}function uv(e,t){return Cu(8390656,8,e,t)}function Pm(e,t){return Md(2048,8,e,t)}function K0(e,t){return Md(4,2,e,t)}function $0(e,t){return Md(4,4,e,t)}function W0(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function G0(e,t,n){return n=n!=null?n.concat([e]):null,Md(4,4,W0.bind(null,t,e),n)}function km(){}function J0(e,t){var n=li();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&xm(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Z0(e,t){var n=li();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&xm(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Q0(e,t,n){return La&21?(Ai(n,t)||(n=n0(),yn.lanes|=n,ja|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dr=!0),e.memoizedState=n)}function sw(e,t){var n=Xt;Xt=n!==0&&4>n?n:4,e(!0);var r=cp.transition;cp.transition={};try{e(!1),t()}finally{Xt=n,cp.transition=r}}function X0(){return li().memoizedState}function aw(e,t,n){var r=Qs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Y0(e))ey(t,n);else if(n=N0(e,t,n,r),n!==null){var i=wr();ki(n,e,r,i),ty(n,t,r)}}function ow(e,t,n){var r=Qs(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Y0(e))ey(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,u=a(o,n);if(i.hasEagerState=!0,i.eagerState=u,Ai(u,o)){var p=t.interleaved;p===null?(i.next=i,ym(t)):(i.next=p.next,p.next=i),t.interleaved=i;return}}catch{}finally{}n=N0(e,t,i,r),n!==null&&(i=wr(),ki(n,e,r,i),ty(n,t,r))}}function Y0(e){var t=e.alternate;return e===yn||t!==null&&t===yn}function ey(e,t){Nc=od=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ty(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,im(e,n)}}var cd={readContext:ci,useCallback:ir,useContext:ir,useEffect:ir,useImperativeHandle:ir,useInsertionEffect:ir,useLayoutEffect:ir,useMemo:ir,useReducer:ir,useRef:ir,useState:ir,useDebugValue:ir,useDeferredValue:ir,useTransition:ir,useMutableSource:ir,useSyncExternalStore:ir,useId:ir,unstable_isNewReconciler:!1},cw={readContext:ci,useCallback:function(e,t){return Ki().memoizedState=[e,t===void 0?null:t],e},useContext:ci,useEffect:uv,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Cu(4194308,4,W0.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Cu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Cu(4,2,e,t)},useMemo:function(e,t){var n=Ki();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ki();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=aw.bind(null,yn,e),[r.memoizedState,e]},useRef:function(e){var t=Ki();return e={current:e},t.memoizedState=e},useState:lv,useDebugValue:km,useDeferredValue:function(e){return Ki().memoizedState=e},useTransition:function(){var e=lv(!1),t=e[0];return e=sw.bind(null,e[1]),Ki().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=yn,i=Ki();if(dn){if(n===void 0)throw Error(Ue(407));n=n()}else{if(n=t(),qn===null)throw Error(Ue(349));La&30||B0(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,uv(H0.bind(null,r,a,e),[e]),r.flags|=2048,el(9,U0.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Ki(),t=qn.identifierPrefix;if(dn){var n=ps,r=hs;n=(r&~(1<<32-Pi(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Xc++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=iw++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},lw={readContext:ci,useCallback:J0,useContext:ci,useEffect:Pm,useImperativeHandle:G0,useInsertionEffect:K0,useLayoutEffect:$0,useMemo:Z0,useReducer:lp,useRef:z0,useState:function(){return lp(Yc)},useDebugValue:km,useDeferredValue:function(e){var t=li();return Q0(t,Mn.memoizedState,e)},useTransition:function(){var e=lp(Yc)[0],t=li().memoizedState;return[e,t]},useMutableSource:L0,useSyncExternalStore:j0,useId:X0,unstable_isNewReconciler:!1},uw={readContext:ci,useCallback:J0,useContext:ci,useEffect:Pm,useImperativeHandle:G0,useInsertionEffect:K0,useLayoutEffect:$0,useMemo:Z0,useReducer:up,useRef:z0,useState:function(){return up(Yc)},useDebugValue:km,useDeferredValue:function(e){var t=li();return Mn===null?t.memoizedState=e:Q0(t,Mn.memoizedState,e)},useTransition:function(){var e=up(Yc)[0],t=li().memoizedState;return[e,t]},useMutableSource:L0,useSyncExternalStore:j0,useId:X0,unstable_isNewReconciler:!1};function bi(e,t){if(e&&e.defaultProps){t=_n({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function uf(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:_n({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ld={isMounted:function(e){return(e=e._reactInternals)?za(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=wr(),i=Qs(e),a=fs(r,i);a.payload=t,n!=null&&(a.callback=n),t=Js(e,a,i),t!==null&&(ki(t,e,i,r),wu(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=wr(),i=Qs(e),a=fs(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Js(e,a,i),t!==null&&(ki(t,e,i,r),wu(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=wr(),r=Qs(e),i=fs(n,r);i.tag=2,t!=null&&(i.callback=t),t=Js(e,i,r),t!==null&&(ki(t,e,r,n),wu(t,e,r))}};function dv(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!$c(n,r)||!$c(i,a):!0}function ny(e,t,n){var r=!1,i=ea,a=t.contextType;return typeof a=="object"&&a!==null?a=ci(a):(i=Or(t)?Oa:ur.current,r=t.contextTypes,a=(r=r!=null)?Po(e,i):ea),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ld,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function hv(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ld.enqueueReplaceState(t,t.state,null)}function df(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},_m(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=ci(a):(a=Or(t)?Oa:ur.current,i.context=Po(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(uf(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Ld.enqueueReplaceState(i,i.state,null),sd(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Ao(e,t){try{var n="",r=t;do n+=j2(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function dp(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function hf(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var dw=typeof WeakMap=="function"?WeakMap:Map;function ry(e,t,n){n=fs(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ud||(ud=!0,wf=r),hf(e,t)},n}function iy(e,t,n){n=fs(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){hf(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){hf(e,t),typeof r!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function pv(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new dw;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Ew.bind(null,e,t,n),t.then(e,e))}function fv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function mv(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=fs(-1,1),t.tag=2,Js(n,t,1))),n.lanes|=1),e)}var hw=Ss.ReactCurrentOwner,Dr=!1;function yr(e,t,n,r){t.child=e===null?D0(t,null,n,r):To(t,e.child,n,r)}function gv(e,t,n,r,i){n=n.render;var a=t.ref;return So(t,i),r=Cm(e,t,n,r,a,i),n=Em(),e!==null&&!Dr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ys(e,t,i)):(dn&&n&&hm(t),t.flags|=1,yr(e,t,r,i),t.child)}function vv(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!Om(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,sy(e,t,a,r,i)):(e=Tu(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:$c,n(o,r)&&e.ref===t.ref)return ys(e,t,i)}return t.flags|=1,e=Xs(a,r),e.ref=t.ref,e.return=t,t.child=e}function sy(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if($c(a,r)&&e.ref===t.ref)if(Dr=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(Dr=!0);else return t.lanes=e.lanes,ys(e,t,i)}return pf(e,t,n,r,i)}function ay(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},rn(po,Vr),Vr|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,rn(po,Vr),Vr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,rn(po,Vr),Vr|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,rn(po,Vr),Vr|=r;return yr(e,t,i,n),t.child}function oy(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function pf(e,t,n,r,i){var a=Or(n)?Oa:ur.current;return a=Po(t,a),So(t,i),n=Cm(e,t,n,r,a,i),r=Em(),e!==null&&!Dr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ys(e,t,i)):(dn&&r&&hm(t),t.flags|=1,yr(e,t,n,i),t.child)}function yv(e,t,n,r,i){if(Or(n)){var a=!0;ed(t)}else a=!1;if(So(t,i),t.stateNode===null)Eu(e,t),ny(t,n,r),df(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,u=t.memoizedProps;o.props=u;var p=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=ci(h):(h=Or(n)?Oa:ur.current,h=Po(t,h));var v=n.getDerivedStateFromProps,f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||p!==h)&&hv(t,o,r,h),Bs=!1;var _=t.memoizedState;o.state=_,sd(t,r,o,i),p=t.memoizedState,u!==r||_!==p||Nr.current||Bs?(typeof v=="function"&&(uf(t,n,v,r),p=t.memoizedState),(u=Bs||dv(t,n,u,r,_,p,h))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=h,r=u):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,O0(e,t),u=t.memoizedProps,h=t.type===t.elementType?u:bi(t.type,u),o.props=h,f=t.pendingProps,_=o.context,p=n.contextType,typeof p=="object"&&p!==null?p=ci(p):(p=Or(n)?Oa:ur.current,p=Po(t,p));var w=n.getDerivedStateFromProps;(v=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==f||_!==p)&&hv(t,o,r,p),Bs=!1,_=t.memoizedState,o.state=_,sd(t,r,o,i);var C=t.memoizedState;u!==f||_!==C||Nr.current||Bs?(typeof w=="function"&&(uf(t,n,w,r),C=t.memoizedState),(h=Bs||dv(t,n,h,r,_,C,p)||!1)?(v||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,C,p),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,C,p)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=C),o.props=r,o.state=C,o.context=p,r=h):(typeof o.componentDidUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),r=!1)}return ff(e,t,n,r,a,i)}function ff(e,t,n,r,i,a){oy(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&rv(t,n,!1),ys(e,t,a);r=t.stateNode,hw.current=t;var u=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=To(t,e.child,null,a),t.child=To(t,null,u,a)):yr(e,t,u,a),t.memoizedState=r.state,i&&rv(t,n,!0),t.child}function cy(e){var t=e.stateNode;t.pendingContext?nv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&nv(e,t.context,!1),bm(e,t.containerInfo)}function _v(e,t,n,r,i){return ko(),fm(i),t.flags|=256,yr(e,t,n,r),t.child}var mf={dehydrated:null,treeContext:null,retryLane:0};function gf(e){return{baseLanes:e,cachePool:null,transitions:null}}function ly(e,t,n){var r=t.pendingProps,i=vn.current,a=!1,o=(t.flags&128)!==0,u;if((u=o)||(u=e!==null&&e.memoizedState===null?!1:(i&2)!==0),u?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),rn(vn,i&1),e===null)return cf(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,a?(r=t.mode,a=t.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Ud(o,r,0,null),e=Fa(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=gf(n),t.memoizedState=mf,e):Tm(t,o));if(i=e.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return pw(e,t,o,r,u,i,n);if(a){a=r.fallback,o=t.mode,i=e.child,u=i.sibling;var p={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=p,t.deletions=null):(r=Xs(i,p),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?a=Xs(u,a):(a=Fa(a,o,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,o=e.child.memoizedState,o=o===null?gf(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~n,t.memoizedState=mf,r}return a=e.child,e=a.sibling,r=Xs(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Tm(e,t){return t=Ud({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function cu(e,t,n,r){return r!==null&&fm(r),To(t,e.child,null,n),e=Tm(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function pw(e,t,n,r,i,a,o){if(n)return t.flags&256?(t.flags&=-257,r=dp(Error(Ue(422))),cu(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Ud({mode:"visible",children:r.children},i,0,null),a=Fa(a,i,o,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&To(t,e.child,null,o),t.child.memoizedState=gf(o),t.memoizedState=mf,a);if(!(t.mode&1))return cu(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,a=Error(Ue(419)),r=dp(a,r,void 0),cu(e,t,o,r)}if(u=(o&e.childLanes)!==0,Dr||u){if(r=qn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,vs(e,i),ki(r,e,i,-1))}return Nm(),r=dp(Error(Ue(421))),cu(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=Pw.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,zr=Gs(i.nextSibling),Kr=t,dn=!0,xi=null,e!==null&&(ii[si++]=hs,ii[si++]=ps,ii[si++]=Ma,hs=e.id,ps=e.overflow,Ma=t),t=Tm(t,r.children),t.flags|=4096,t)}function bv(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),lf(e.return,t,n)}function hp(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function uy(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(yr(e,t,r.children,n),r=vn.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bv(e,n,t);else if(e.tag===19)bv(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(rn(vn,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&ad(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),hp(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&ad(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}hp(t,!0,n,null,a);break;case"together":hp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Eu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ys(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ja|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ue(153));if(t.child!==null){for(e=t.child,n=Xs(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Xs(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function fw(e,t,n){switch(t.tag){case 3:cy(t),ko();break;case 5:M0(t);break;case 1:Or(t.type)&&ed(t);break;case 4:bm(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;rn(rd,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(rn(vn,vn.current&1),t.flags|=128,null):n&t.child.childLanes?ly(e,t,n):(rn(vn,vn.current&1),e=ys(e,t,n),e!==null?e.sibling:null);rn(vn,vn.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return uy(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rn(vn,vn.current),r)break;return null;case 22:case 23:return t.lanes=0,ay(e,t,n)}return ys(e,t,n)}var dy,vf,hy,py;dy=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};vf=function(){};hy=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Pa(Gi.current);var a=null;switch(n){case"input":i=jp(e,i),r=jp(e,r),a=[];break;case"select":i=_n({},i,{value:void 0}),r=_n({},r,{value:void 0}),a=[];break;case"textarea":i=Hp(e,i),r=Hp(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Xu)}qp(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var u=i[h];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Bc.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in r){var p=r[h];if(u=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&p!==u&&(p!=null||u!=null))if(h==="style")if(u){for(o in u)!u.hasOwnProperty(o)||p&&p.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in p)p.hasOwnProperty(o)&&u[o]!==p[o]&&(n||(n={}),n[o]=p[o])}else n||(a||(a=[]),a.push(h,n)),n=p;else h==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,u=u?u.__html:void 0,p!=null&&u!==p&&(a=a||[]).push(h,p)):h==="children"?typeof p!="string"&&typeof p!="number"||(a=a||[]).push(h,""+p):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Bc.hasOwnProperty(h)?(p!=null&&h==="onScroll"&&cn("scroll",e),a||u===p||(a=[])):(a=a||[]).push(h,p))}n&&(a=a||[]).push("style",n);var h=a;(t.updateQueue=h)&&(t.flags|=4)}};py=function(e,t,n,r){n!==r&&(t.flags|=4)};function pc(e,t){if(!dn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function sr(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function mw(e,t,n){var r=t.pendingProps;switch(pm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sr(t),null;case 1:return Or(t.type)&&Yu(),sr(t),null;case 3:return r=t.stateNode,Ro(),ln(Nr),ln(ur),wm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(au(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,xi!==null&&(Ef(xi),xi=null))),vf(e,t),sr(t),null;case 5:Sm(t);var i=Pa(Qc.current);if(n=t.type,e!==null&&t.stateNode!=null)hy(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Ue(166));return sr(t),null}if(e=Pa(Gi.current),au(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[$i]=t,r[Jc]=a,e=(t.mode&1)!==0,n){case"dialog":cn("cancel",r),cn("close",r);break;case"iframe":case"object":case"embed":cn("load",r);break;case"video":case"audio":for(i=0;i<kc.length;i++)cn(kc[i],r);break;case"source":cn("error",r);break;case"img":case"image":case"link":cn("error",r),cn("load",r);break;case"details":cn("toggle",r);break;case"input":Rg(r,a),cn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},cn("invalid",r);break;case"textarea":Ig(r,a),cn("invalid",r)}qp(n,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="children"?typeof u=="string"?r.textContent!==u&&(a.suppressHydrationWarning!==!0&&su(r.textContent,u,e),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(a.suppressHydrationWarning!==!0&&su(r.textContent,u,e),i=["children",""+u]):Bc.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&cn("scroll",r)}switch(n){case"input":Ql(r),Ag(r,a,!0);break;case"textarea":Ql(r),Fg(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Xu)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=H1(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[$i]=t,e[Jc]=r,dy(e,t,!1,!1),t.stateNode=e;e:{switch(o=zp(n,r),n){case"dialog":cn("cancel",e),cn("close",e),i=r;break;case"iframe":case"object":case"embed":cn("load",e),i=r;break;case"video":case"audio":for(i=0;i<kc.length;i++)cn(kc[i],e);i=r;break;case"source":cn("error",e),i=r;break;case"img":case"image":case"link":cn("error",e),cn("load",e),i=r;break;case"details":cn("toggle",e),i=r;break;case"input":Rg(e,r),i=jp(e,r),cn("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=_n({},r,{value:void 0}),cn("invalid",e);break;case"textarea":Ig(e,r),i=Hp(e,r),cn("invalid",e);break;default:i=r}qp(n,i),u=i;for(a in u)if(u.hasOwnProperty(a)){var p=u[a];a==="style"?z1(e,p):a==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&V1(e,p)):a==="children"?typeof p=="string"?(n!=="textarea"||p!=="")&&Uc(e,p):typeof p=="number"&&Uc(e,""+p):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Bc.hasOwnProperty(a)?p!=null&&a==="onScroll"&&cn("scroll",e):p!=null&&Xf(e,a,p,o))}switch(n){case"input":Ql(e),Ag(e,r,!1);break;case"textarea":Ql(e),Fg(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ys(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?vo(e,!!r.multiple,a,!1):r.defaultValue!=null&&vo(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Xu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return sr(t),null;case 6:if(e&&t.stateNode!=null)py(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Ue(166));if(n=Pa(Qc.current),Pa(Gi.current),au(t)){if(r=t.stateNode,n=t.memoizedProps,r[$i]=t,(a=r.nodeValue!==n)&&(e=Kr,e!==null))switch(e.tag){case 3:su(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&su(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$i]=t,t.stateNode=r}return sr(t),null;case 13:if(ln(vn),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(dn&&zr!==null&&t.mode&1&&!(t.flags&128))I0(),ko(),t.flags|=98560,a=!1;else if(a=au(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(Ue(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ue(317));a[$i]=t}else ko(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;sr(t),a=!1}else xi!==null&&(Ef(xi),xi=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||vn.current&1?Ln===0&&(Ln=3):Nm())),t.updateQueue!==null&&(t.flags|=4),sr(t),null);case 4:return Ro(),vf(e,t),e===null&&Wc(t.stateNode.containerInfo),sr(t),null;case 10:return vm(t.type._context),sr(t),null;case 17:return Or(t.type)&&Yu(),sr(t),null;case 19:if(ln(vn),a=t.memoizedState,a===null)return sr(t),null;if(r=(t.flags&128)!==0,o=a.rendering,o===null)if(r)pc(a,!1);else{if(Ln!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=ad(e),o!==null){for(t.flags|=128,pc(a,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return rn(vn,vn.current&1|2),t.child}e=e.sibling}a.tail!==null&&En()>Io&&(t.flags|=128,r=!0,pc(a,!1),t.lanes=4194304)}else{if(!r)if(e=ad(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),pc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!dn)return sr(t),null}else 2*En()-a.renderingStartTime>Io&&n!==1073741824&&(t.flags|=128,r=!0,pc(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(n=a.last,n!==null?n.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=En(),t.sibling=null,n=vn.current,rn(vn,r?n&1|2:n&1),t):(sr(t),null);case 22:case 23:return Dm(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Vr&1073741824&&(sr(t),t.subtreeFlags&6&&(t.flags|=8192)):sr(t),null;case 24:return null;case 25:return null}throw Error(Ue(156,t.tag))}function gw(e,t){switch(pm(t),t.tag){case 1:return Or(t.type)&&Yu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ro(),ln(Nr),ln(ur),wm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Sm(t),null;case 13:if(ln(vn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ue(340));ko()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ln(vn),null;case 4:return Ro(),null;case 10:return vm(t.type._context),null;case 22:case 23:return Dm(),null;case 24:return null;default:return null}}var lu=!1,cr=!1,vw=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function ho(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){wn(e,t,r)}else n.current=null}function yf(e,t,n){try{n()}catch(r){wn(e,t,r)}}var Sv=!1;function yw(e,t){if(ef=Ju,e=y0(),dm(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,u=-1,p=-1,h=0,v=0,f=e,_=null;t:for(;;){for(var w;f!==n||i!==0&&f.nodeType!==3||(u=o+i),f!==a||r!==0&&f.nodeType!==3||(p=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(w=f.firstChild)!==null;)_=f,f=w;for(;;){if(f===e)break t;if(_===n&&++h===i&&(u=o),_===a&&++v===r&&(p=o),(w=f.nextSibling)!==null)break;f=_,_=f.parentNode}f=w}n=u===-1||p===-1?null:{start:u,end:p}}else n=null}n=n||{start:0,end:0}}else n=null;for(tf={focusedElem:e,selectionRange:n},Ju=!1,Ye=t;Ye!==null;)if(t=Ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ye=e;else for(;Ye!==null;){t=Ye;try{var C=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var R=C.memoizedProps,S=C.memoizedState,b=t.stateNode,x=b.getSnapshotBeforeUpdate(t.elementType===t.type?R:bi(t.type,R),S);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var E=t.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ue(163))}}catch(M){wn(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,Ye=e;break}Ye=t.return}return C=Sv,Sv=!1,C}function Oc(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&yf(t,n,a)}i=i.next}while(i!==r)}}function jd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function _f(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function fy(e){var t=e.alternate;t!==null&&(e.alternate=null,fy(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$i],delete t[Jc],delete t[sf],delete t[ew],delete t[tw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function my(e){return e.tag===5||e.tag===3||e.tag===4}function wv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||my(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Xu));else if(r!==4&&(e=e.child,e!==null))for(bf(e,t,n),e=e.sibling;e!==null;)bf(e,t,n),e=e.sibling}function Sf(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Sf(e,t,n),e=e.sibling;e!==null;)Sf(e,t,n),e=e.sibling}var Xn=null,wi=!1;function Is(e,t,n){for(n=n.child;n!==null;)gy(e,t,n),n=n.sibling}function gy(e,t,n){if(Wi&&typeof Wi.onCommitFiberUnmount=="function")try{Wi.onCommitFiberUnmount(Ad,n)}catch{}switch(n.tag){case 5:cr||ho(n,t);case 6:var r=Xn,i=wi;Xn=null,Is(e,t,n),Xn=r,wi=i,Xn!==null&&(wi?(e=Xn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Xn.removeChild(n.stateNode));break;case 18:Xn!==null&&(wi?(e=Xn,n=n.stateNode,e.nodeType===8?sp(e.parentNode,n):e.nodeType===1&&sp(e,n),zc(e)):sp(Xn,n.stateNode));break;case 4:r=Xn,i=wi,Xn=n.stateNode.containerInfo,wi=!0,Is(e,t,n),Xn=r,wi=i;break;case 0:case 11:case 14:case 15:if(!cr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&yf(n,t,o),i=i.next}while(i!==r)}Is(e,t,n);break;case 1:if(!cr&&(ho(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){wn(n,t,u)}Is(e,t,n);break;case 21:Is(e,t,n);break;case 22:n.mode&1?(cr=(r=cr)||n.memoizedState!==null,Is(e,t,n),cr=r):Is(e,t,n);break;default:Is(e,t,n)}}function xv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new vw),t.forEach(function(r){var i=kw.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function mi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,u=o;e:for(;u!==null;){switch(u.tag){case 5:Xn=u.stateNode,wi=!1;break e;case 3:Xn=u.stateNode.containerInfo,wi=!0;break e;case 4:Xn=u.stateNode.containerInfo,wi=!0;break e}u=u.return}if(Xn===null)throw Error(Ue(160));gy(a,o,i),Xn=null,wi=!1;var p=i.alternate;p!==null&&(p.return=null),i.return=null}catch(h){wn(i,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vy(t,e),t=t.sibling}function vy(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mi(t,e),Vi(e),r&4){try{Oc(3,e,e.return),jd(3,e)}catch(R){wn(e,e.return,R)}try{Oc(5,e,e.return)}catch(R){wn(e,e.return,R)}}break;case 1:mi(t,e),Vi(e),r&512&&n!==null&&ho(n,n.return);break;case 5:if(mi(t,e),Vi(e),r&512&&n!==null&&ho(n,n.return),e.flags&32){var i=e.stateNode;try{Uc(i,"")}catch(R){wn(e,e.return,R)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=n!==null?n.memoizedProps:a,u=e.type,p=e.updateQueue;if(e.updateQueue=null,p!==null)try{u==="input"&&a.type==="radio"&&a.name!=null&&B1(i,a),zp(u,o);var h=zp(u,a);for(o=0;o<p.length;o+=2){var v=p[o],f=p[o+1];v==="style"?z1(i,f):v==="dangerouslySetInnerHTML"?V1(i,f):v==="children"?Uc(i,f):Xf(i,v,f,h)}switch(u){case"input":Bp(i,a);break;case"textarea":U1(i,a);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var w=a.value;w!=null?vo(i,!!a.multiple,w,!1):_!==!!a.multiple&&(a.defaultValue!=null?vo(i,!!a.multiple,a.defaultValue,!0):vo(i,!!a.multiple,a.multiple?[]:"",!1))}i[Jc]=a}catch(R){wn(e,e.return,R)}}break;case 6:if(mi(t,e),Vi(e),r&4){if(e.stateNode===null)throw Error(Ue(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(R){wn(e,e.return,R)}}break;case 3:if(mi(t,e),Vi(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{zc(t.containerInfo)}catch(R){wn(e,e.return,R)}break;case 4:mi(t,e),Vi(e);break;case 13:mi(t,e),Vi(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Im=En())),r&4&&xv(e);break;case 22:if(v=n!==null&&n.memoizedState!==null,e.mode&1?(cr=(h=cr)||v,mi(t,e),cr=h):mi(t,e),Vi(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!v&&e.mode&1)for(Ye=e,v=e.child;v!==null;){for(f=Ye=v;Ye!==null;){switch(_=Ye,w=_.child,_.tag){case 0:case 11:case 14:case 15:Oc(4,_,_.return);break;case 1:ho(_,_.return);var C=_.stateNode;if(typeof C.componentWillUnmount=="function"){r=_,n=_.return;try{t=r,C.props=t.memoizedProps,C.state=t.memoizedState,C.componentWillUnmount()}catch(R){wn(r,n,R)}}break;case 5:ho(_,_.return);break;case 22:if(_.memoizedState!==null){Ev(f);continue}}w!==null?(w.return=_,Ye=w):Ev(f)}v=v.sibling}e:for(v=null,f=e;;){if(f.tag===5){if(v===null){v=f;try{i=f.stateNode,h?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(u=f.stateNode,p=f.memoizedProps.style,o=p!=null&&p.hasOwnProperty("display")?p.display:null,u.style.display=q1("display",o))}catch(R){wn(e,e.return,R)}}}else if(f.tag===6){if(v===null)try{f.stateNode.nodeValue=h?"":f.memoizedProps}catch(R){wn(e,e.return,R)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;v===f&&(v=null),f=f.return}v===f&&(v=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:mi(t,e),Vi(e),r&4&&xv(e);break;case 21:break;default:mi(t,e),Vi(e)}}function Vi(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(my(n)){var r=n;break e}n=n.return}throw Error(Ue(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Uc(i,""),r.flags&=-33);var a=wv(e);Sf(e,a,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=wv(e);bf(e,u,o);break;default:throw Error(Ue(161))}}catch(p){wn(e,e.return,p)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function _w(e,t,n){Ye=e,yy(e)}function yy(e,t,n){for(var r=(e.mode&1)!==0;Ye!==null;){var i=Ye,a=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||lu;if(!o){var u=i.alternate,p=u!==null&&u.memoizedState!==null||cr;u=lu;var h=cr;if(lu=o,(cr=p)&&!h)for(Ye=i;Ye!==null;)o=Ye,p=o.child,o.tag===22&&o.memoizedState!==null?Pv(i):p!==null?(p.return=o,Ye=p):Pv(i);for(;a!==null;)Ye=a,yy(a),a=a.sibling;Ye=i,lu=u,cr=h}Cv(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Ye=a):Cv(e)}}function Cv(e){for(;Ye!==null;){var t=Ye;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:cr||jd(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!cr)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:bi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&cv(t,a,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}cv(t,o,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var p=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&n.focus();break;case"img":p.src&&(n.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var v=h.memoizedState;if(v!==null){var f=v.dehydrated;f!==null&&zc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ue(163))}cr||t.flags&512&&_f(t)}catch(_){wn(t,t.return,_)}}if(t===e){Ye=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ye=n;break}Ye=t.return}}function Ev(e){for(;Ye!==null;){var t=Ye;if(t===e){Ye=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ye=n;break}Ye=t.return}}function Pv(e){for(;Ye!==null;){var t=Ye;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{jd(4,t)}catch(p){wn(t,n,p)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(p){wn(t,i,p)}}var a=t.return;try{_f(t)}catch(p){wn(t,a,p)}break;case 5:var o=t.return;try{_f(t)}catch(p){wn(t,o,p)}}}catch(p){wn(t,t.return,p)}if(t===e){Ye=null;break}var u=t.sibling;if(u!==null){u.return=t.return,Ye=u;break}Ye=t.return}}var bw=Math.ceil,ld=Ss.ReactCurrentDispatcher,Rm=Ss.ReactCurrentOwner,oi=Ss.ReactCurrentBatchConfig,qt=0,qn=null,Fn=null,Yn=0,Vr=0,po=sa(0),Ln=0,tl=null,ja=0,Bd=0,Am=0,Mc=null,Fr=null,Im=0,Io=1/0,ls=null,ud=!1,wf=null,Zs=null,uu=!1,zs=null,dd=0,Lc=0,xf=null,Pu=-1,ku=0;function wr(){return qt&6?En():Pu!==-1?Pu:Pu=En()}function Qs(e){return e.mode&1?qt&2&&Yn!==0?Yn&-Yn:rw.transition!==null?(ku===0&&(ku=n0()),ku):(e=Xt,e!==0||(e=window.event,e=e===void 0?16:l0(e.type)),e):1}function ki(e,t,n,r){if(50<Lc)throw Lc=0,xf=null,Error(Ue(185));_l(e,n,r),(!(qt&2)||e!==qn)&&(e===qn&&(!(qt&2)&&(Bd|=n),Ln===4&&Hs(e,Yn)),Mr(e,r),n===1&&qt===0&&!(t.mode&1)&&(Io=En()+500,Od&&aa()))}function Mr(e,t){var n=e.callbackNode;rS(e,t);var r=Gu(e,e===qn?Yn:0);if(r===0)n!==null&&Og(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Og(n),t===1)e.tag===0?nw(kv.bind(null,e)):T0(kv.bind(null,e)),XS(function(){!(qt&6)&&aa()}),n=null;else{switch(r0(r)){case 1:n=rm;break;case 4:n=e0;break;case 16:n=Wu;break;case 536870912:n=t0;break;default:n=Wu}n=Py(n,_y.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function _y(e,t){if(Pu=-1,ku=0,qt&6)throw Error(Ue(327));var n=e.callbackNode;if(wo()&&e.callbackNode!==n)return null;var r=Gu(e,e===qn?Yn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=hd(e,r);else{t=r;var i=qt;qt|=2;var a=Sy();(qn!==e||Yn!==t)&&(ls=null,Io=En()+500,Ia(e,t));do try{xw();break}catch(u){by(e,u)}while(!0);gm(),ld.current=a,qt=i,Fn!==null?t=0:(qn=null,Yn=0,t=Ln)}if(t!==0){if(t===2&&(i=Jp(e),i!==0&&(r=i,t=Cf(e,i))),t===1)throw n=tl,Ia(e,0),Hs(e,r),Mr(e,En()),n;if(t===6)Hs(e,r);else{if(i=e.current.alternate,!(r&30)&&!Sw(i)&&(t=hd(e,r),t===2&&(a=Jp(e),a!==0&&(r=a,t=Cf(e,a))),t===1))throw n=tl,Ia(e,0),Hs(e,r),Mr(e,En()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(Ue(345));case 2:Sa(e,Fr,ls);break;case 3:if(Hs(e,r),(r&130023424)===r&&(t=Im+500-En(),10<t)){if(Gu(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){wr(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=rf(Sa.bind(null,e,Fr,ls),t);break}Sa(e,Fr,ls);break;case 4:if(Hs(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Pi(r);a=1<<o,o=t[o],o>i&&(i=o),r&=~a}if(r=i,r=En()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*bw(r/1960))-r,10<r){e.timeoutHandle=rf(Sa.bind(null,e,Fr,ls),r);break}Sa(e,Fr,ls);break;case 5:Sa(e,Fr,ls);break;default:throw Error(Ue(329))}}}return Mr(e,En()),e.callbackNode===n?_y.bind(null,e):null}function Cf(e,t){var n=Mc;return e.current.memoizedState.isDehydrated&&(Ia(e,t).flags|=256),e=hd(e,t),e!==2&&(t=Fr,Fr=n,t!==null&&Ef(t)),e}function Ef(e){Fr===null?Fr=e:Fr.push.apply(Fr,e)}function Sw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Ai(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hs(e,t){for(t&=~Am,t&=~Bd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Pi(t),r=1<<n;e[n]=-1,t&=~r}}function kv(e){if(qt&6)throw Error(Ue(327));wo();var t=Gu(e,0);if(!(t&1))return Mr(e,En()),null;var n=hd(e,t);if(e.tag!==0&&n===2){var r=Jp(e);r!==0&&(t=r,n=Cf(e,r))}if(n===1)throw n=tl,Ia(e,0),Hs(e,t),Mr(e,En()),n;if(n===6)throw Error(Ue(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sa(e,Fr,ls),Mr(e,En()),null}function Fm(e,t){var n=qt;qt|=1;try{return e(t)}finally{qt=n,qt===0&&(Io=En()+500,Od&&aa())}}function Ba(e){zs!==null&&zs.tag===0&&!(qt&6)&&wo();var t=qt;qt|=1;var n=oi.transition,r=Xt;try{if(oi.transition=null,Xt=1,e)return e()}finally{Xt=r,oi.transition=n,qt=t,!(qt&6)&&aa()}}function Dm(){Vr=po.current,ln(po)}function Ia(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,QS(n)),Fn!==null)for(n=Fn.return;n!==null;){var r=n;switch(pm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Yu();break;case 3:Ro(),ln(Nr),ln(ur),wm();break;case 5:Sm(r);break;case 4:Ro();break;case 13:ln(vn);break;case 19:ln(vn);break;case 10:vm(r.type._context);break;case 22:case 23:Dm()}n=n.return}if(qn=e,Fn=e=Xs(e.current,null),Yn=Vr=t,Ln=0,tl=null,Am=Bd=ja=0,Fr=Mc=null,Ea!==null){for(t=0;t<Ea.length;t++)if(n=Ea[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var o=a.next;a.next=i,r.next=o}n.pending=r}Ea=null}return e}function by(e,t){do{var n=Fn;try{if(gm(),xu.current=cd,od){for(var r=yn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}od=!1}if(La=0,Vn=Mn=yn=null,Nc=!1,Xc=0,Rm.current=null,n===null||n.return===null){Ln=1,tl=t,Fn=null;break}e:{var a=e,o=n.return,u=n,p=t;if(t=Yn,u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var h=p,v=u,f=v.tag;if(!(v.mode&1)&&(f===0||f===11||f===15)){var _=v.alternate;_?(v.updateQueue=_.updateQueue,v.memoizedState=_.memoizedState,v.lanes=_.lanes):(v.updateQueue=null,v.memoizedState=null)}var w=fv(o);if(w!==null){w.flags&=-257,mv(w,o,u,a,t),w.mode&1&&pv(a,h,t),t=w,p=h;var C=t.updateQueue;if(C===null){var R=new Set;R.add(p),t.updateQueue=R}else C.add(p);break e}else{if(!(t&1)){pv(a,h,t),Nm();break e}p=Error(Ue(426))}}else if(dn&&u.mode&1){var S=fv(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),mv(S,o,u,a,t),fm(Ao(p,u));break e}}a=p=Ao(p,u),Ln!==4&&(Ln=2),Mc===null?Mc=[a]:Mc.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var b=ry(a,p,t);ov(a,b);break e;case 1:u=p;var x=a.type,E=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Zs===null||!Zs.has(E)))){a.flags|=65536,t&=-t,a.lanes|=t;var M=iy(a,u,t);ov(a,M);break e}}a=a.return}while(a!==null)}xy(n)}catch(Z){t=Z,Fn===n&&n!==null&&(Fn=n=n.return);continue}break}while(!0)}function Sy(){var e=ld.current;return ld.current=cd,e===null?cd:e}function Nm(){(Ln===0||Ln===3||Ln===2)&&(Ln=4),qn===null||!(ja&268435455)&&!(Bd&268435455)||Hs(qn,Yn)}function hd(e,t){var n=qt;qt|=2;var r=Sy();(qn!==e||Yn!==t)&&(ls=null,Ia(e,t));do try{ww();break}catch(i){by(e,i)}while(!0);if(gm(),qt=n,ld.current=r,Fn!==null)throw Error(Ue(261));return qn=null,Yn=0,Ln}function ww(){for(;Fn!==null;)wy(Fn)}function xw(){for(;Fn!==null&&!G2();)wy(Fn)}function wy(e){var t=Ey(e.alternate,e,Vr);e.memoizedProps=e.pendingProps,t===null?xy(e):Fn=t,Rm.current=null}function xy(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=gw(n,t),n!==null){n.flags&=32767,Fn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ln=6,Fn=null;return}}else if(n=mw(n,t,Vr),n!==null){Fn=n;return}if(t=t.sibling,t!==null){Fn=t;return}Fn=t=e}while(t!==null);Ln===0&&(Ln=5)}function Sa(e,t,n){var r=Xt,i=oi.transition;try{oi.transition=null,Xt=1,Cw(e,t,n,r)}finally{oi.transition=i,Xt=r}return null}function Cw(e,t,n,r){do wo();while(zs!==null);if(qt&6)throw Error(Ue(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Ue(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(iS(e,a),e===qn&&(Fn=qn=null,Yn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||uu||(uu=!0,Py(Wu,function(){return wo(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=oi.transition,oi.transition=null;var o=Xt;Xt=1;var u=qt;qt|=4,Rm.current=null,yw(e,n),vy(n,e),zS(tf),Ju=!!ef,tf=ef=null,e.current=n,_w(n),J2(),qt=u,Xt=o,oi.transition=a}else e.current=n;if(uu&&(uu=!1,zs=e,dd=i),a=e.pendingLanes,a===0&&(Zs=null),X2(n.stateNode),Mr(e,En()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ud)throw ud=!1,e=wf,wf=null,e;return dd&1&&e.tag!==0&&wo(),a=e.pendingLanes,a&1?e===xf?Lc++:(Lc=0,xf=e):Lc=0,aa(),null}function wo(){if(zs!==null){var e=r0(dd),t=oi.transition,n=Xt;try{if(oi.transition=null,Xt=16>e?16:e,zs===null)var r=!1;else{if(e=zs,zs=null,dd=0,qt&6)throw Error(Ue(331));var i=qt;for(qt|=4,Ye=e.current;Ye!==null;){var a=Ye,o=a.child;if(Ye.flags&16){var u=a.deletions;if(u!==null){for(var p=0;p<u.length;p++){var h=u[p];for(Ye=h;Ye!==null;){var v=Ye;switch(v.tag){case 0:case 11:case 15:Oc(8,v,a)}var f=v.child;if(f!==null)f.return=v,Ye=f;else for(;Ye!==null;){v=Ye;var _=v.sibling,w=v.return;if(fy(v),v===h){Ye=null;break}if(_!==null){_.return=w,Ye=_;break}Ye=w}}}var C=a.alternate;if(C!==null){var R=C.child;if(R!==null){C.child=null;do{var S=R.sibling;R.sibling=null,R=S}while(R!==null)}}Ye=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Ye=o;else e:for(;Ye!==null;){if(a=Ye,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Oc(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,Ye=b;break e}Ye=a.return}}var x=e.current;for(Ye=x;Ye!==null;){o=Ye;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,Ye=E;else e:for(o=x;Ye!==null;){if(u=Ye,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:jd(9,u)}}catch(Z){wn(u,u.return,Z)}if(u===o){Ye=null;break e}var M=u.sibling;if(M!==null){M.return=u.return,Ye=M;break e}Ye=u.return}}if(qt=i,aa(),Wi&&typeof Wi.onPostCommitFiberRoot=="function")try{Wi.onPostCommitFiberRoot(Ad,e)}catch{}r=!0}return r}finally{Xt=n,oi.transition=t}}return!1}function Tv(e,t,n){t=Ao(n,t),t=ry(e,t,1),e=Js(e,t,1),t=wr(),e!==null&&(_l(e,1,t),Mr(e,t))}function wn(e,t,n){if(e.tag===3)Tv(e,e,n);else for(;t!==null;){if(t.tag===3){Tv(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Zs===null||!Zs.has(r))){e=Ao(n,e),e=iy(t,e,1),t=Js(t,e,1),e=wr(),t!==null&&(_l(t,1,e),Mr(t,e));break}}t=t.return}}function Ew(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=wr(),e.pingedLanes|=e.suspendedLanes&n,qn===e&&(Yn&n)===n&&(Ln===4||Ln===3&&(Yn&130023424)===Yn&&500>En()-Im?Ia(e,0):Am|=n),Mr(e,t)}function Cy(e,t){t===0&&(e.mode&1?(t=eu,eu<<=1,!(eu&130023424)&&(eu=4194304)):t=1);var n=wr();e=vs(e,t),e!==null&&(_l(e,t,n),Mr(e,n))}function Pw(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Cy(e,n)}function kw(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Ue(314))}r!==null&&r.delete(t),Cy(e,n)}var Ey;Ey=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nr.current)Dr=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Dr=!1,fw(e,t,n);Dr=!!(e.flags&131072)}else Dr=!1,dn&&t.flags&1048576&&R0(t,nd,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Eu(e,t),e=t.pendingProps;var i=Po(t,ur.current);So(t,n),i=Cm(null,t,r,e,i,n);var a=Em();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Or(r)?(a=!0,ed(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_m(t),i.updater=Ld,t.stateNode=i,i._reactInternals=t,df(t,r,e,n),t=ff(null,t,r,!0,a,n)):(t.tag=0,dn&&a&&hm(t),yr(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Eu(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Rw(r),e=bi(r,e),i){case 0:t=pf(null,t,r,e,n);break e;case 1:t=yv(null,t,r,e,n);break e;case 11:t=gv(null,t,r,e,n);break e;case 14:t=vv(null,t,r,bi(r.type,e),n);break e}throw Error(Ue(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bi(r,i),pf(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bi(r,i),yv(e,t,r,i,n);case 3:e:{if(cy(t),e===null)throw Error(Ue(387));r=t.pendingProps,a=t.memoizedState,i=a.element,O0(e,t),sd(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Ao(Error(Ue(423)),t),t=_v(e,t,r,n,i);break e}else if(r!==i){i=Ao(Error(Ue(424)),t),t=_v(e,t,r,n,i);break e}else for(zr=Gs(t.stateNode.containerInfo.firstChild),Kr=t,dn=!0,xi=null,n=D0(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ko(),r===i){t=ys(e,t,n);break e}yr(e,t,r,n)}t=t.child}return t;case 5:return M0(t),e===null&&cf(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,nf(r,i)?o=null:a!==null&&nf(r,a)&&(t.flags|=32),oy(e,t),yr(e,t,o,n),t.child;case 6:return e===null&&cf(t),null;case 13:return ly(e,t,n);case 4:return bm(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=To(t,null,r,n):yr(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bi(r,i),gv(e,t,r,i,n);case 7:return yr(e,t,t.pendingProps,n),t.child;case 8:return yr(e,t,t.pendingProps.children,n),t.child;case 12:return yr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,rn(rd,r._currentValue),r._currentValue=o,a!==null)if(Ai(a.value,o)){if(a.children===i.children&&!Nr.current){t=ys(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var u=a.dependencies;if(u!==null){o=a.child;for(var p=u.firstContext;p!==null;){if(p.context===r){if(a.tag===1){p=fs(-1,n&-n),p.tag=2;var h=a.updateQueue;if(h!==null){h=h.shared;var v=h.pending;v===null?p.next=p:(p.next=v.next,v.next=p),h.pending=p}}a.lanes|=n,p=a.alternate,p!==null&&(p.lanes|=n),lf(a.return,n,t),u.lanes|=n;break}p=p.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Ue(341));o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),lf(o,n,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}yr(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,So(t,n),i=ci(i),r=r(i),t.flags|=1,yr(e,t,r,n),t.child;case 14:return r=t.type,i=bi(r,t.pendingProps),i=bi(r.type,i),vv(e,t,r,i,n);case 15:return sy(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:bi(r,i),Eu(e,t),t.tag=1,Or(r)?(e=!0,ed(t)):e=!1,So(t,n),ny(t,r,i),df(t,r,i,n),ff(null,t,r,!0,e,n);case 19:return uy(e,t,n);case 22:return ay(e,t,n)}throw Error(Ue(156,t.tag))};function Py(e,t){return Y1(e,t)}function Tw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ai(e,t,n,r){return new Tw(e,t,n,r)}function Om(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Rw(e){if(typeof e=="function")return Om(e)?1:0;if(e!=null){if(e=e.$$typeof,e===em)return 11;if(e===tm)return 14}return 2}function Xs(e,t){var n=e.alternate;return n===null?(n=ai(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Tu(e,t,n,r,i,a){var o=2;if(r=e,typeof e=="function")Om(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case no:return Fa(n.children,i,a,t);case Yf:o=8,i|=8;break;case Np:return e=ai(12,n,t,i|2),e.elementType=Np,e.lanes=a,e;case Op:return e=ai(13,n,t,i),e.elementType=Op,e.lanes=a,e;case Mp:return e=ai(19,n,t,i),e.elementType=Mp,e.lanes=a,e;case M1:return Ud(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case N1:o=10;break e;case O1:o=9;break e;case em:o=11;break e;case tm:o=14;break e;case js:o=16,r=null;break e}throw Error(Ue(130,e==null?e:typeof e,""))}return t=ai(o,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function Fa(e,t,n,r){return e=ai(7,e,r,t),e.lanes=n,e}function Ud(e,t,n,r){return e=ai(22,e,r,t),e.elementType=M1,e.lanes=n,e.stateNode={isHidden:!1},e}function pp(e,t,n){return e=ai(6,e,null,t),e.lanes=n,e}function fp(e,t,n){return t=ai(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Aw(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gh(0),this.expirationTimes=Gh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Mm(e,t,n,r,i,a,o,u,p){return e=new Aw(e,t,n,u,p),t===1?(t=1,a===!0&&(t|=8)):t=0,a=ai(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_m(a),e}function Iw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:to,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ky(e){if(!e)return ea;e=e._reactInternals;e:{if(za(e)!==e||e.tag!==1)throw Error(Ue(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ue(171))}if(e.tag===1){var n=e.type;if(Or(n))return k0(e,n,t)}return t}function Ty(e,t,n,r,i,a,o,u,p){return e=Mm(n,r,!0,e,i,a,o,u,p),e.context=ky(null),n=e.current,r=wr(),i=Qs(n),a=fs(r,i),a.callback=t??null,Js(n,a,i),e.current.lanes=i,_l(e,i,r),Mr(e,r),e}function Hd(e,t,n,r){var i=t.current,a=wr(),o=Qs(i);return n=ky(n),t.context===null?t.context=n:t.pendingContext=n,t=fs(a,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Js(i,t,o),e!==null&&(ki(e,i,o,a),wu(e,i,o)),o}function pd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Rv(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Lm(e,t){Rv(e,t),(e=e.alternate)&&Rv(e,t)}function Fw(){return null}var Ry=typeof reportError=="function"?reportError:function(e){console.error(e)};function jm(e){this._internalRoot=e}Vd.prototype.render=jm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ue(409));Hd(e,t,null,null)};Vd.prototype.unmount=jm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ba(function(){Hd(null,e,null,null)}),t[gs]=null}};function Vd(e){this._internalRoot=e}Vd.prototype.unstable_scheduleHydration=function(e){if(e){var t=a0();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Us.length&&t!==0&&t<Us[n].priority;n++);Us.splice(n,0,e),n===0&&c0(e)}};function Bm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function qd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Av(){}function Dw(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var h=pd(o);a.call(h)}}var o=Ty(t,r,e,0,null,!1,!1,"",Av);return e._reactRootContainer=o,e[gs]=o.current,Wc(e.nodeType===8?e.parentNode:e),Ba(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var h=pd(p);u.call(h)}}var p=Mm(e,0,!1,null,null,!1,!1,"",Av);return e._reactRootContainer=p,e[gs]=p.current,Wc(e.nodeType===8?e.parentNode:e),Ba(function(){Hd(t,p,n,r)}),p}function zd(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var u=i;i=function(){var p=pd(o);u.call(p)}}Hd(t,o,e,i)}else o=Dw(n,t,e,i,r);return pd(o)}i0=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Pc(t.pendingLanes);n!==0&&(im(t,n|1),Mr(t,En()),!(qt&6)&&(Io=En()+500,aa()))}break;case 13:Ba(function(){var r=vs(e,1);if(r!==null){var i=wr();ki(r,e,1,i)}}),Lm(e,1)}};sm=function(e){if(e.tag===13){var t=vs(e,134217728);if(t!==null){var n=wr();ki(t,e,134217728,n)}Lm(e,134217728)}};s0=function(e){if(e.tag===13){var t=Qs(e),n=vs(e,t);if(n!==null){var r=wr();ki(n,e,t,r)}Lm(e,t)}};a0=function(){return Xt};o0=function(e,t){var n=Xt;try{return Xt=e,t()}finally{Xt=n}};$p=function(e,t,n){switch(t){case"input":if(Bp(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Nd(r);if(!i)throw Error(Ue(90));j1(r),Bp(r,i)}}}break;case"textarea":U1(e,n);break;case"select":t=n.value,t!=null&&vo(e,!!n.multiple,t,!1)}};W1=Fm;G1=Ba;var Nw={usingClientEntryPoint:!1,Events:[Sl,ao,Nd,K1,$1,Fm]},fc={findFiberByHostInstance:Ca,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ow={bundleType:fc.bundleType,version:fc.version,rendererPackageName:fc.rendererPackageName,rendererConfig:fc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Q1(e),e===null?null:e.stateNode},findFiberByHostInstance:fc.findFiberByHostInstance||Fw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!du.isDisabled&&du.supportsFiber)try{Ad=du.inject(Ow),Wi=du}catch{}}Wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nw;Wr.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bm(t))throw Error(Ue(200));return Iw(e,t,null,n)};Wr.createRoot=function(e,t){if(!Bm(e))throw Error(Ue(299));var n=!1,r="",i=Ry;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Mm(e,1,!1,null,null,n,!1,r,i),e[gs]=t.current,Wc(e.nodeType===8?e.parentNode:e),new jm(t)};Wr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ue(188)):(e=Object.keys(e).join(","),Error(Ue(268,e)));return e=Q1(t),e=e===null?null:e.stateNode,e};Wr.flushSync=function(e){return Ba(e)};Wr.hydrate=function(e,t,n){if(!qd(t))throw Error(Ue(200));return zd(null,e,t,!0,n)};Wr.hydrateRoot=function(e,t,n){if(!Bm(e))throw Error(Ue(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",o=Ry;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Ty(t,null,e,1,n??null,i,!1,a,o),e[gs]=t.current,Wc(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Vd(t)};Wr.render=function(e,t,n){if(!qd(t))throw Error(Ue(200));return zd(null,e,t,!1,n)};Wr.unmountComponentAtNode=function(e){if(!qd(e))throw Error(Ue(40));return e._reactRootContainer?(Ba(function(){zd(null,null,e,!1,function(){e._reactRootContainer=null,e[gs]=null})}),!0):!1};Wr.unstable_batchedUpdates=Fm;Wr.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!qd(n))throw Error(Ue(200));if(e==null||e._reactInternals===void 0)throw Error(Ue(38));return zd(e,t,n,!1,r)};Wr.version="18.3.1-next-f1338f8080-20240426";function Ay(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ay)}catch(e){console.error(e)}}Ay(),A1.exports=Wr;var Mw=A1.exports,Iy,Iv=Mw;Iy=Iv.createRoot,Iv.hydrateRoot;var Lw={};(function(){function e(K){var ee=0;return function(){return ee<K.length?{done:!1,value:K[ee++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(K,ee,oe){return K==Array.prototype||K==Object.prototype||(K[ee]=oe.value),K};function n(K){K=[typeof globalThis=="object"&&globalThis,K,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ei=="object"&&Ei];for(var ee=0;ee<K.length;++ee){var oe=K[ee];if(oe&&oe.Math==Math)return oe}throw Error("Cannot find global object")}var r=n(this);function i(K,ee){if(ee)e:{var oe=r;K=K.split(".");for(var ce=0;ce<K.length-1;ce++){var ne=K[ce];if(!(ne in oe))break e;oe=oe[ne]}K=K[K.length-1],ce=oe[K],ee=ee(ce),ee!=ce&&ee!=null&&t(oe,K,{configurable:!0,writable:!0,value:ee})}}i("Symbol",function(K){function ee(Te){if(this instanceof ee)throw new TypeError("Symbol is not a constructor");return new oe(ce+(Te||"")+"_"+ne++,Te)}function oe(Te,ye){this.g=Te,t(this,"description",{configurable:!0,writable:!0,value:ye})}if(K)return K;oe.prototype.toString=function(){return this.g};var ce="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ne=0;return ee}),i("Symbol.iterator",function(K){if(K)return K;K=Symbol("Symbol.iterator");for(var ee="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),oe=0;oe<ee.length;oe++){var ce=r[ee[oe]];typeof ce=="function"&&typeof ce.prototype[K]!="function"&&t(ce.prototype,K,{configurable:!0,writable:!0,value:function(){return a(e(this))}})}return K});function a(K){return K={next:K},K[Symbol.iterator]=function(){return this},K}function o(K){var ee=typeof Symbol<"u"&&Symbol.iterator&&K[Symbol.iterator];return ee?ee.call(K):{next:e(K)}}function u(){this.i=!1,this.g=null,this.o=void 0,this.j=1,this.m=0,this.h=null}function p(K){if(K.i)throw new TypeError("Generator is already running");K.i=!0}u.prototype.l=function(K){this.o=K};function h(K,ee){K.h={F:ee,G:!0},K.j=K.m}u.prototype.return=function(K){this.h={return:K},this.j=this.m};function v(K){this.g=new u,this.h=K}function f(K,ee){p(K.g);var oe=K.g.g;return oe?_(K,"return"in oe?oe.return:function(ce){return{value:ce,done:!0}},ee,K.g.return):(K.g.return(ee),w(K))}function _(K,ee,oe,ce){try{var ne=ee.call(K.g.g,oe);if(!(ne instanceof Object))throw new TypeError("Iterator result "+ne+" is not an object");if(!ne.done)return K.g.i=!1,ne;var Te=ne.value}catch(ye){return K.g.g=null,h(K.g,ye),w(K)}return K.g.g=null,ce.call(K.g,Te),w(K)}function w(K){for(;K.g.j;)try{var ee=K.h(K.g);if(ee)return K.g.i=!1,{value:ee.value,done:!1}}catch(oe){K.g.o=void 0,h(K.g,oe)}if(K.g.i=!1,K.g.h){if(ee=K.g.h,K.g.h=null,ee.G)throw ee.F;return{value:ee.return,done:!0}}return{value:void 0,done:!0}}function C(K){this.next=function(ee){return p(K.g),K.g.g?ee=_(K,K.g.g.next,ee,K.g.l):(K.g.l(ee),ee=w(K)),ee},this.throw=function(ee){return p(K.g),K.g.g?ee=_(K,K.g.g.throw,ee,K.g.l):(h(K.g,ee),ee=w(K)),ee},this.return=function(ee){return f(K,ee)},this[Symbol.iterator]=function(){return this}}function R(K){function ee(ce){return K.next(ce)}function oe(ce){return K.throw(ce)}return new Promise(function(ce,ne){function Te(ye){ye.done?ce(ye.value):Promise.resolve(ye.value).then(ee,oe).then(Te,ne)}Te(K.next())})}i("Promise",function(K){function ee(ye){this.h=0,this.i=void 0,this.g=[],this.o=!1;var ue=this.j();try{ye(ue.resolve,ue.reject)}catch(me){ue.reject(me)}}function oe(){this.g=null}function ce(ye){return ye instanceof ee?ye:new ee(function(ue){ue(ye)})}if(K)return K;oe.prototype.h=function(ye){if(this.g==null){this.g=[];var ue=this;this.i(function(){ue.l()})}this.g.push(ye)};var ne=r.setTimeout;oe.prototype.i=function(ye){ne(ye,0)},oe.prototype.l=function(){for(;this.g&&this.g.length;){var ye=this.g;this.g=[];for(var ue=0;ue<ye.length;++ue){var me=ye[ue];ye[ue]=null;try{me()}catch(_e){this.j(_e)}}}this.g=null},oe.prototype.j=function(ye){this.i(function(){throw ye})},ee.prototype.j=function(){function ye(_e){return function(ke){me||(me=!0,_e.call(ue,ke))}}var ue=this,me=!1;return{resolve:ye(this.A),reject:ye(this.l)}},ee.prototype.A=function(ye){if(ye===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(ye instanceof ee)this.C(ye);else{e:switch(typeof ye){case"object":var ue=ye!=null;break e;case"function":ue=!0;break e;default:ue=!1}ue?this.v(ye):this.m(ye)}},ee.prototype.v=function(ye){var ue=void 0;try{ue=ye.then}catch(me){this.l(me);return}typeof ue=="function"?this.D(ue,ye):this.m(ye)},ee.prototype.l=function(ye){this.u(2,ye)},ee.prototype.m=function(ye){this.u(1,ye)},ee.prototype.u=function(ye,ue){if(this.h!=0)throw Error("Cannot settle("+ye+", "+ue+"): Promise already settled in state"+this.h);this.h=ye,this.i=ue,this.h===2&&this.B(),this.H()},ee.prototype.B=function(){var ye=this;ne(function(){if(ye.I()){var ue=r.console;typeof ue<"u"&&ue.error(ye.i)}},1)},ee.prototype.I=function(){if(this.o)return!1;var ye=r.CustomEvent,ue=r.Event,me=r.dispatchEvent;return typeof me>"u"?!0:(typeof ye=="function"?ye=new ye("unhandledrejection",{cancelable:!0}):typeof ue=="function"?ye=new ue("unhandledrejection",{cancelable:!0}):(ye=r.document.createEvent("CustomEvent"),ye.initCustomEvent("unhandledrejection",!1,!0,ye)),ye.promise=this,ye.reason=this.i,me(ye))},ee.prototype.H=function(){if(this.g!=null){for(var ye=0;ye<this.g.length;++ye)Te.h(this.g[ye]);this.g=null}};var Te=new oe;return ee.prototype.C=function(ye){var ue=this.j();ye.s(ue.resolve,ue.reject)},ee.prototype.D=function(ye,ue){var me=this.j();try{ye.call(ue,me.resolve,me.reject)}catch(_e){me.reject(_e)}},ee.prototype.then=function(ye,ue){function me(Re,We){return typeof Re=="function"?function(Xe){try{_e(Re(Xe))}catch(Ke){ke(Ke)}}:We}var _e,ke,le=new ee(function(Re,We){_e=Re,ke=We});return this.s(me(ye,_e),me(ue,ke)),le},ee.prototype.catch=function(ye){return this.then(void 0,ye)},ee.prototype.s=function(ye,ue){function me(){switch(_e.h){case 1:ye(_e.i);break;case 2:ue(_e.i);break;default:throw Error("Unexpected state: "+_e.h)}}var _e=this;this.g==null?Te.h(me):this.g.push(me),this.o=!0},ee.resolve=ce,ee.reject=function(ye){return new ee(function(ue,me){me(ye)})},ee.race=function(ye){return new ee(function(ue,me){for(var _e=o(ye),ke=_e.next();!ke.done;ke=_e.next())ce(ke.value).s(ue,me)})},ee.all=function(ye){var ue=o(ye),me=ue.next();return me.done?ce([]):new ee(function(_e,ke){function le(Xe){return function(Ke){Re[Xe]=Ke,We--,We==0&&_e(Re)}}var Re=[],We=0;do Re.push(void 0),We++,ce(me.value).s(le(Re.length-1),ke),me=ue.next();while(!me.done)})},ee});var S=typeof Object.assign=="function"?Object.assign:function(K,ee){for(var oe=1;oe<arguments.length;oe++){var ce=arguments[oe];if(ce)for(var ne in ce)Object.prototype.hasOwnProperty.call(ce,ne)&&(K[ne]=ce[ne])}return K};i("Object.assign",function(K){return K||S});var b=this||self,x={facingMode:"user",width:640,height:480};function E(K,ee){this.video=K,this.i=0,this.h=Object.assign(Object.assign({},x),ee)}E.prototype.stop=function(){var K=this,ee,oe,ce,ne;return R(new C(new v(function(Te){if(K.g){for(ee=K.g.getTracks(),oe=o(ee),ce=oe.next();!ce.done;ce=oe.next())ne=ce.value,ne.stop();K.g=void 0}Te.j=0})))},E.prototype.start=function(){var K=this,ee;return R(new C(new v(function(oe){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||alert("No navigator.mediaDevices.getUserMedia exists."),ee=K.h,oe.return(navigator.mediaDevices.getUserMedia({video:{facingMode:ee.facingMode,width:ee.width,height:ee.height}}).then(function(ce){Z(K,ce)}).catch(function(ce){var ne="Failed to acquire camera feed: "+ce;throw console.error(ne),alert(ne),ce}))})))};function M(K){window.requestAnimationFrame(function(){$(K)})}function Z(K,ee){K.g=ee,K.video.srcObject=ee,K.video.onloadedmetadata=function(){K.video.play(),M(K)}}function $(K){var ee=null;K.video.paused||K.video.currentTime===K.i||(K.i=K.video.currentTime,ee=K.h.onFrame()),ee?ee.then(function(){M(K)}):M(K)}var z=["Camera"],q=b;z[0]in q||typeof q.execScript>"u"||q.execScript("var "+z[0]);for(var X;z.length&&(X=z.shift());)z.length||E===void 0?q[X]&&q[X]!==Object.prototype[X]?q=q[X]:q=q[X]={}:q[X]=E}).call(Ei);var jw={};(function(){var e;function t(I){var B=0;return function(){return B<I.length?{done:!1,value:I[B++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(I,B,V){return I==Array.prototype||I==Object.prototype||(I[B]=V.value),I};function r(I){I=[typeof globalThis=="object"&&globalThis,I,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ei=="object"&&Ei];for(var B=0;B<I.length;++B){var V=I[B];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")}var i=r(this);function a(I,B){if(B)e:{var V=i;I=I.split(".");for(var ae=0;ae<I.length-1;ae++){var Se=I[ae];if(!(Se in V))break e;V=V[Se]}I=I[I.length-1],ae=V[I],B=B(ae),B!=ae&&B!=null&&n(V,I,{configurable:!0,writable:!0,value:B})}}a("Symbol",function(I){function B(xe){if(this instanceof B)throw new TypeError("Symbol is not a constructor");return new V(ae+(xe||"")+"_"+Se++,xe)}function V(xe,Pe){this.g=xe,n(this,"description",{configurable:!0,writable:!0,value:Pe})}if(I)return I;V.prototype.toString=function(){return this.g};var ae="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Se=0;return B}),a("Symbol.iterator",function(I){if(I)return I;I=Symbol("Symbol.iterator");for(var B="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),V=0;V<B.length;V++){var ae=i[B[V]];typeof ae=="function"&&typeof ae.prototype[I]!="function"&&n(ae.prototype,I,{configurable:!0,writable:!0,value:function(){return o(t(this))}})}return I});function o(I){return I={next:I},I[Symbol.iterator]=function(){return this},I}function u(I){var B=typeof Symbol<"u"&&Symbol.iterator&&I[Symbol.iterator];return B?B.call(I):{next:t(I)}}function p(I){if(!(I instanceof Array)){I=u(I);for(var B,V=[];!(B=I.next()).done;)V.push(B.value);I=V}return I}var h=typeof Object.create=="function"?Object.create:function(I){function B(){}return B.prototype=I,new B},v;if(typeof Object.setPrototypeOf=="function")v=Object.setPrototypeOf;else{var f;e:{var _={a:!0},w={};try{w.__proto__=_,f=w.a;break e}catch{}f=!1}v=f?function(I,B){if(I.__proto__=B,I.__proto__!==B)throw new TypeError(I+" is not extensible");return I}:null}var C=v;function R(I,B){if(I.prototype=h(B.prototype),I.prototype.constructor=I,C)C(I,B);else for(var V in B)if(V!="prototype")if(Object.defineProperties){var ae=Object.getOwnPropertyDescriptor(B,V);ae&&Object.defineProperty(I,V,ae)}else I[V]=B[V];I.ea=B.prototype}function S(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function b(I){if(I.l)throw new TypeError("Generator is already running");I.l=!0}S.prototype.o=function(I){this.h=I};function x(I,B){I.j={U:B,V:!0},I.g=I.m||I.s}S.prototype.return=function(I){this.j={return:I},this.g=this.s};function E(I,B,V){return I.g=V,{value:B}}function M(I){this.g=new S,this.h=I}function Z(I,B){b(I.g);var V=I.g.i;return V?$(I,"return"in V?V.return:function(ae){return{value:ae,done:!0}},B,I.g.return):(I.g.return(B),z(I))}function $(I,B,V,ae){try{var Se=B.call(I.g.i,V);if(!(Se instanceof Object))throw new TypeError("Iterator result "+Se+" is not an object");if(!Se.done)return I.g.l=!1,Se;var xe=Se.value}catch(Pe){return I.g.i=null,x(I.g,Pe),z(I)}return I.g.i=null,ae.call(I.g,xe),z(I)}function z(I){for(;I.g.g;)try{var B=I.h(I.g);if(B)return I.g.l=!1,{value:B.value,done:!1}}catch(V){I.g.h=void 0,x(I.g,V)}if(I.g.l=!1,I.g.j){if(B=I.g.j,I.g.j=null,B.V)throw B.U;return{value:B.return,done:!0}}return{value:void 0,done:!0}}function q(I){this.next=function(B){return b(I.g),I.g.i?B=$(I,I.g.i.next,B,I.g.o):(I.g.o(B),B=z(I)),B},this.throw=function(B){return b(I.g),I.g.i?B=$(I,I.g.i.throw,B,I.g.o):(x(I.g,B),B=z(I)),B},this.return=function(B){return Z(I,B)},this[Symbol.iterator]=function(){return this}}function X(I,B){return B=new q(new M(B)),C&&I.prototype&&C(B,I.prototype),B}function K(I,B){I instanceof String&&(I+="");var V=0,ae=!1,Se={next:function(){if(!ae&&V<I.length){var xe=V++;return{value:B(xe,I[xe]),done:!1}}return ae=!0,{done:!0,value:void 0}}};return Se[Symbol.iterator]=function(){return Se},Se}var ee=typeof Object.assign=="function"?Object.assign:function(I,B){for(var V=1;V<arguments.length;V++){var ae=arguments[V];if(ae)for(var Se in ae)Object.prototype.hasOwnProperty.call(ae,Se)&&(I[Se]=ae[Se])}return I};a("Object.assign",function(I){return I||ee}),a("Promise",function(I){function B(Pe){this.h=0,this.i=void 0,this.g=[],this.o=!1;var De=this.j();try{Pe(De.resolve,De.reject)}catch(He){De.reject(He)}}function V(){this.g=null}function ae(Pe){return Pe instanceof B?Pe:new B(function(De){De(Pe)})}if(I)return I;V.prototype.h=function(Pe){if(this.g==null){this.g=[];var De=this;this.i(function(){De.l()})}this.g.push(Pe)};var Se=i.setTimeout;V.prototype.i=function(Pe){Se(Pe,0)},V.prototype.l=function(){for(;this.g&&this.g.length;){var Pe=this.g;this.g=[];for(var De=0;De<Pe.length;++De){var He=Pe[De];Pe[De]=null;try{He()}catch(Je){this.j(Je)}}}this.g=null},V.prototype.j=function(Pe){this.i(function(){throw Pe})},B.prototype.j=function(){function Pe(Je){return function(pt){He||(He=!0,Je.call(De,pt))}}var De=this,He=!1;return{resolve:Pe(this.C),reject:Pe(this.l)}},B.prototype.C=function(Pe){if(Pe===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(Pe instanceof B)this.F(Pe);else{e:switch(typeof Pe){case"object":var De=Pe!=null;break e;case"function":De=!0;break e;default:De=!1}De?this.u(Pe):this.m(Pe)}},B.prototype.u=function(Pe){var De=void 0;try{De=Pe.then}catch(He){this.l(He);return}typeof De=="function"?this.G(De,Pe):this.m(Pe)},B.prototype.l=function(Pe){this.s(2,Pe)},B.prototype.m=function(Pe){this.s(1,Pe)},B.prototype.s=function(Pe,De){if(this.h!=0)throw Error("Cannot settle("+Pe+", "+De+"): Promise already settled in state"+this.h);this.h=Pe,this.i=De,this.h===2&&this.D(),this.A()},B.prototype.D=function(){var Pe=this;Se(function(){if(Pe.B()){var De=i.console;typeof De<"u"&&De.error(Pe.i)}},1)},B.prototype.B=function(){if(this.o)return!1;var Pe=i.CustomEvent,De=i.Event,He=i.dispatchEvent;return typeof He>"u"?!0:(typeof Pe=="function"?Pe=new Pe("unhandledrejection",{cancelable:!0}):typeof De=="function"?Pe=new De("unhandledrejection",{cancelable:!0}):(Pe=i.document.createEvent("CustomEvent"),Pe.initCustomEvent("unhandledrejection",!1,!0,Pe)),Pe.promise=this,Pe.reason=this.i,He(Pe))},B.prototype.A=function(){if(this.g!=null){for(var Pe=0;Pe<this.g.length;++Pe)xe.h(this.g[Pe]);this.g=null}};var xe=new V;return B.prototype.F=function(Pe){var De=this.j();Pe.J(De.resolve,De.reject)},B.prototype.G=function(Pe,De){var He=this.j();try{Pe.call(De,He.resolve,He.reject)}catch(Je){He.reject(Je)}},B.prototype.then=function(Pe,De){function He(st,vt){return typeof st=="function"?function(nt){try{Je(st(nt))}catch(ft){pt(ft)}}:vt}var Je,pt,zt=new B(function(st,vt){Je=st,pt=vt});return this.J(He(Pe,Je),He(De,pt)),zt},B.prototype.catch=function(Pe){return this.then(void 0,Pe)},B.prototype.J=function(Pe,De){function He(){switch(Je.h){case 1:Pe(Je.i);break;case 2:De(Je.i);break;default:throw Error("Unexpected state: "+Je.h)}}var Je=this;this.g==null?xe.h(He):this.g.push(He),this.o=!0},B.resolve=ae,B.reject=function(Pe){return new B(function(De,He){He(Pe)})},B.race=function(Pe){return new B(function(De,He){for(var Je=u(Pe),pt=Je.next();!pt.done;pt=Je.next())ae(pt.value).J(De,He)})},B.all=function(Pe){var De=u(Pe),He=De.next();return He.done?ae([]):new B(function(Je,pt){function zt(nt){return function(ft){st[nt]=ft,vt--,vt==0&&Je(st)}}var st=[],vt=0;do st.push(void 0),vt++,ae(He.value).J(zt(st.length-1),pt),He=De.next();while(!He.done)})},B}),a("Object.is",function(I){return I||function(B,V){return B===V?B!==0||1/B===1/V:B!==B&&V!==V}}),a("Array.prototype.includes",function(I){return I||function(B,V){var ae=this;ae instanceof String&&(ae=String(ae));var Se=ae.length;for(V=V||0,0>V&&(V=Math.max(V+Se,0));V<Se;V++){var xe=ae[V];if(xe===B||Object.is(xe,B))return!0}return!1}}),a("String.prototype.includes",function(I){return I||function(B,V){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(B instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(B,V||0)!==-1}}),a("Array.prototype.keys",function(I){return I||function(){return K(this,function(B){return B})}});var oe=this||self;function ce(I,B){I=I.split(".");var V=oe;I[0]in V||typeof V.execScript>"u"||V.execScript("var "+I[0]);for(var ae;I.length&&(ae=I.shift());)I.length||B===void 0?V[ae]&&V[ae]!==Object.prototype[ae]?V=V[ae]:V=V[ae]={}:V[ae]=B}function ne(I,B){return B=String.fromCharCode.apply(null,B),I==null?B:I+B}var Te,ye=typeof TextDecoder<"u",ue,me=typeof TextEncoder<"u";function _e(I){if(me)I=(ue||(ue=new TextEncoder)).encode(I);else{var B=void 0;B=B===void 0?!1:B;for(var V=0,ae=new Uint8Array(3*I.length),Se=0;Se<I.length;Se++){var xe=I.charCodeAt(Se);if(128>xe)ae[V++]=xe;else{if(2048>xe)ae[V++]=xe>>6|192;else{if(55296<=xe&&57343>=xe){if(56319>=xe&&Se<I.length){var Pe=I.charCodeAt(++Se);if(56320<=Pe&&57343>=Pe){xe=1024*(xe-55296)+Pe-56320+65536,ae[V++]=xe>>18|240,ae[V++]=xe>>12&63|128,ae[V++]=xe>>6&63|128,ae[V++]=xe&63|128;continue}else Se--}if(B)throw Error("Found an unpaired surrogate");xe=65533}ae[V++]=xe>>12|224,ae[V++]=xe>>6&63|128}ae[V++]=xe&63|128}}I=ae.subarray(0,V)}return I}var ke={},le=null;function Re(I,B){B===void 0&&(B=0),Ke(),B=ke[B];for(var V=Array(Math.floor(I.length/3)),ae=B[64]||"",Se=0,xe=0;Se<I.length-2;Se+=3){var Pe=I[Se],De=I[Se+1],He=I[Se+2],Je=B[Pe>>2];Pe=B[(Pe&3)<<4|De>>4],De=B[(De&15)<<2|He>>6],He=B[He&63],V[xe++]=Je+Pe+De+He}switch(Je=0,He=ae,I.length-Se){case 2:Je=I[Se+1],He=B[(Je&15)<<2]||ae;case 1:I=I[Se],V[xe]=B[I>>2]+B[(I&3)<<4|Je>>4]+He+ae}return V.join("")}function We(I){var B=I.length,V=3*B/4;V%3?V=Math.floor(V):"=.".indexOf(I[B-1])!=-1&&(V="=.".indexOf(I[B-2])!=-1?V-2:V-1);var ae=new Uint8Array(V),Se=0;return Xe(I,function(xe){ae[Se++]=xe}),ae.subarray(0,Se)}function Xe(I,B){function V(He){for(;ae<I.length;){var Je=I.charAt(ae++),pt=le[Je];if(pt!=null)return pt;if(!/^[\s\xa0]*$/.test(Je))throw Error("Unknown base64 encoding at char: "+Je)}return He}Ke();for(var ae=0;;){var Se=V(-1),xe=V(0),Pe=V(64),De=V(64);if(De===64&&Se===-1)break;B(Se<<2|xe>>4),Pe!=64&&(B(xe<<4&240|Pe>>2),De!=64&&B(Pe<<6&192|De))}}function Ke(){if(!le){le={};for(var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),B=["+/=","+/","-_=","-_.","-_"],V=0;5>V;V++){var ae=I.concat(B[V].split(""));ke[V]=ae;for(var Se=0;Se<ae.length;Se++){var xe=ae[Se];le[xe]===void 0&&(le[xe]=Se)}}}}var Le=typeof Uint8Array.prototype.slice=="function",qe;function rt(I,B,V){return B===V?qe||(qe=new Uint8Array(0)):Le?I.slice(B,V):new Uint8Array(I.subarray(B,V))}var ot=0,wt=0;function Pn(I,B){B=B===void 0?{}:B,B=B.v===void 0?!1:B.v,this.h=null,this.g=this.j=this.l=0,this.m=!1,this.v=B,I&&Xi(this,I)}function Xi(I,B){B=B.constructor===Uint8Array?B:B.constructor===ArrayBuffer?new Uint8Array(B):B.constructor===Array?new Uint8Array(B):B.constructor===String?We(B):B instanceof Uint8Array?new Uint8Array(B.buffer,B.byteOffset,B.byteLength):new Uint8Array(0),I.h=B,I.l=0,I.j=I.h.length,I.g=I.l}Pn.prototype.reset=function(){this.g=this.l};function kn(I){for(var B=128,V=0,ae=0,Se=0;4>Se&&128<=B;Se++)B=I.h[I.g++],V|=(B&127)<<7*Se;if(128<=B&&(B=I.h[I.g++],V|=(B&127)<<28,ae|=(B&127)>>4),128<=B)for(Se=0;5>Se&&128<=B;Se++)B=I.h[I.g++],ae|=(B&127)<<7*Se+3;if(128>B)return I=V>>>0,B=ae>>>0,(ae=B&2147483648)&&(I=~I+1>>>0,B=~B>>>0,I==0&&(B=B+1>>>0)),I=4294967296*B+(I>>>0),ae?-I:I;I.m=!0}Pn.prototype.i=function(){var I=this.h,B=I[this.g],V=B&127;return 128>B?(this.g+=1,V):(B=I[this.g+1],V|=(B&127)<<7,128>B?(this.g+=2,V):(B=I[this.g+2],V|=(B&127)<<14,128>B?(this.g+=3,V):(B=I[this.g+3],V|=(B&127)<<21,128>B?(this.g+=4,V):(B=I[this.g+4],V|=(B&15)<<28,128>B?(this.g+=5,V>>>0):(this.g+=5,128<=I[this.g++]&&128<=I[this.g++]&&128<=I[this.g++]&&128<=I[this.g++]&&this.g++,V)))))},Pn.prototype.o=function(){var I=this.h[this.g],B=this.h[this.g+1],V=this.h[this.g+2],ae=this.h[this.g+3];return this.g+=4,V=(I<<0|B<<8|V<<16|ae<<24)>>>0,I=2*(V>>31)+1,B=V>>>23&255,V&=8388607,B==255?V?NaN:1/0*I:B==0?I*Math.pow(2,-149)*V:I*Math.pow(2,B-150)*(V+Math.pow(2,23))};var dr=[];function Nn(){this.g=new Uint8Array(64),this.h=0}Nn.prototype.push=function(I){if(!(this.h+1<this.g.length)){var B=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(B)}this.g[this.h++]=I},Nn.prototype.length=function(){return this.h},Nn.prototype.end=function(){var I=this.g,B=this.h;return this.h=0,rt(I,0,B)};function Qr(I,B){for(;127<B;)I.push(B&127|128),B>>>=7;I.push(B)}function di(I){var B={},V=B.N===void 0?!1:B.N;this.o={v:B.v===void 0?!1:B.v},this.N=V,B=this.o,dr.length?(V=dr.pop(),B&&(V.v=B.v),I&&Xi(V,I),I=V):I=new Pn(I,B),this.g=I,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}di.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};function zn(I){var B=I.g;if((B=B.g==B.j)||(B=I.j)||(B=I.g,B=B.m||0>B.g||B.g>B.j),B)return!1;I.m=I.g.g,B=I.g.i();var V=B&7;return V!=0&&V!=5&&V!=1&&V!=2&&V!=3&&V!=4?(I.j=!0,!1):(I.i=B,I.l=B>>>3,I.h=V,!0)}function Hr(I){switch(I.h){case 0:if(I.h!=0)Hr(I);else{for(I=I.g;I.h[I.g]&128;)I.g++;I.g++}break;case 1:I.h!=1?Hr(I):(I=I.g,I.g+=8);break;case 2:if(I.h!=2)Hr(I);else{var B=I.g.i();I=I.g,I.g+=B}break;case 5:I.h!=5?Hr(I):(I=I.g,I.g+=4);break;case 3:B=I.l;do{if(!zn(I)){I.j=!0;break}if(I.h==4){I.l!=B&&(I.j=!0);break}Hr(I)}while(!0);break;default:I.j=!0}}function Cs(I,B,V){var ae=I.g.j,Se=I.g.i(),xe=I.g.g+Se;if(I.g.j=xe,V(B,I),V=xe-I.g.g,V!==0)throw Error("Message parsing ended unexpectedly. Expected to read "+Se+" bytes, instead read "+(Se-V)+" bytes, either the data ended unexpectedly or the message misreported its own length");return I.g.g=xe,I.g.j=ae,B}function Kn(I){return I.g.o()}function la(I){var B=I.g.i();I=I.g;var V=I.g;I.g+=B,I=I.h;var ae;if(ye)(ae=Te)||(ae=Te=new TextDecoder("utf-8",{fatal:!1})),ae=ae.decode(I.subarray(V,V+B));else{B=V+B;for(var Se=[],xe=null,Pe,De,He;V<B;)Pe=I[V++],128>Pe?Se.push(Pe):224>Pe?V>=B?Se.push(65533):(De=I[V++],194>Pe||(De&192)!==128?(V--,Se.push(65533)):Se.push((Pe&31)<<6|De&63)):240>Pe?V>=B-1?Se.push(65533):(De=I[V++],(De&192)!==128||Pe===224&&160>De||Pe===237&&160<=De||((ae=I[V++])&192)!==128?(V--,Se.push(65533)):Se.push((Pe&15)<<12|(De&63)<<6|ae&63)):244>=Pe?V>=B-2?Se.push(65533):(De=I[V++],(De&192)!==128||(Pe<<28)+(De-144)>>30||((ae=I[V++])&192)!==128||((He=I[V++])&192)!==128?(V--,Se.push(65533)):(Pe=(Pe&7)<<18|(De&63)<<12|(ae&63)<<6|He&63,Pe-=65536,Se.push((Pe>>10&1023)+55296,(Pe&1023)+56320))):Se.push(65533),8192<=Se.length&&(xe=ne(xe,Se),Se.length=0);ae=ne(xe,Se)}return ae}function jn(I,B,V){var ae=I.g.i();for(ae=I.g.g+ae;I.g.g<ae;)V.push(B.call(I.g))}function hi(I,B){I.h==2?jn(I,Pn.prototype.o,B):B.push(Kn(I))}function Mi(){this.h=[],this.i=0,this.g=new Nn}function _t(I,B){B.length!==0&&(I.h.push(B),I.i+=B.length)}function Ft(I){var B=I.i+I.g.length();if(B===0)return new Uint8Array(0);B=new Uint8Array(B);for(var V=I.h,ae=V.length,Se=0,xe=0;xe<ae;xe++){var Pe=V[xe];Pe.length!==0&&(B.set(Pe,Se),Se+=Pe.length)}return V=I.g,ae=V.h,ae!==0&&(B.set(V.g.subarray(0,ae),Se),V.h=0),I.h=[B],B}function at(I,B,V){if(V!=null){Qr(I.g,8*B+5),I=I.g;var ae=V;ae=(V=0>ae?1:0)?-ae:ae,ae===0?0<1/ae?ot=wt=0:(wt=0,ot=2147483648):isNaN(ae)?(wt=0,ot=2147483647):34028234663852886e22<ae?(wt=0,ot=(V<<31|2139095040)>>>0):11754943508222875e-54>ae?(ae=Math.round(ae/Math.pow(2,-149)),wt=0,ot=(V<<31|ae)>>>0):(B=Math.floor(Math.log(ae)/Math.LN2),ae*=Math.pow(2,-B),ae=Math.round(8388608*ae),16777216<=ae&&++B,wt=0,ot=(V<<31|B+127<<23|ae&8388607)>>>0),V=ot,I.push(V>>>0&255),I.push(V>>>8&255),I.push(V>>>16&255),I.push(V>>>24&255)}}var Kt=typeof Uint8Array=="function";function Er(I,B,V){if(I!=null)return typeof I=="object"?Kt&&I instanceof Uint8Array?V(I):hr(I,B,V):B(I)}function hr(I,B,V){if(Array.isArray(I)){for(var ae=Array(I.length),Se=0;Se<I.length;Se++)ae[Se]=Er(I[Se],B,V);return Array.isArray(I)&&I.W&&Bn(ae),ae}ae={};for(Se in I)ae[Se]=Er(I[Se],B,V);return ae}function Ht(I){return typeof I=="number"?isFinite(I)?I:String(I):I}var dt={W:{value:!0,configurable:!0}};function Bn(I){return Array.isArray(I)&&!Object.isFrozen(I)&&Object.defineProperties(I,dt),I}var Es;function hn(I,B,V){var ae=Es;Es=null,I||(I=ae),ae=this.constructor.ca,I||(I=ae?[ae]:[]),this.j=ae?0:-1,this.m=this.g=null,this.h=I;e:{if(ae=this.h.length,I=ae-1,ae&&(ae=this.h[I],!(ae===null||typeof ae!="object"||Array.isArray(ae)||Kt&&ae instanceof Uint8Array))){this.l=I-this.j,this.i=ae;break e}B!==void 0&&-1<B?(this.l=Math.max(B,I+1-this.j),this.i=null):this.l=Number.MAX_VALUE}if(V)for(B=0;B<V.length;B++)I=V[B],I<this.l?(I+=this.j,(ae=this.h[I])?Bn(ae):this.h[I]=$a):(Rl(this),(ae=this.i[I])?Bn(ae):this.i[I]=$a)}var $a=Object.freeze(Bn([]));function Rl(I){var B=I.l+I.j;I.h[B]||(I.i=I.h[B]={})}function nn(I,B,V){return B===-1?null:V!==void 0&&V||B>=I.l?I.i?I.i[B]:void 0:I.h[B+I.j]}function Ps(I,B){var V=V===void 0?!1:V,ae=nn(I,B,V);return ae==null&&(ae=$a),ae===$a&&(ae=Bn([]),Rt(I,B,ae,V)),ae}function Al(I){var B=Ps(I,3);if(I.m||(I.m={}),!I.m[3]){for(var V=0;V<B.length;V++)B[V]=+B[V];I.m[3]=!0}return B}function Li(I,B,V){return I=nn(I,B),I??V}function Xr(I,B,V){return I=nn(I,B),I=I==null?I:+I,I??(V===void 0?0:V)}function Rt(I,B,V,ae){ae!==void 0&&ae||B>=I.l?(Rl(I),I.i[B]=V):I.h[B+I.j]=V}function Il(I,B,V){if(V===-1)return null;if(I.g||(I.g={}),!I.g[V]){var ae=nn(I,V,!1);ae&&(I.g[V]=new B(ae))}return I.g[V]}function Wa(I,B){I.g||(I.g={});var V=I.g[1];if(!V){var ae=Ps(I,1);V=[];for(var Se=0;Se<ae.length;Se++)V[Se]=new B(ae[Se]);I.g[1]=V}return V}function Fl(I,B,V){var ae=ae===void 0?!1:ae;I.g||(I.g={});var Se=V&&Yi(V);I.g[B]=V,Rt(I,B,Se,ae)}function Dl(I,B,V,ae){var Se=Wa(I,V);B=B||new V,I=Ps(I,1),ae!=null?(Se.splice(ae,0,B),I.splice(ae,0,Yi(B))):(Se.push(B),I.push(Yi(B)))}hn.prototype.toJSON=function(){var I=Yi(this);return hr(I,Ht,Re)};function Yi(I,B){if(I.g)for(var V in I.g){var ae=I.g[V];if(Array.isArray(ae))for(var Se=0;Se<ae.length;Se++)ae[Se]&&Yi(ae[Se]);else ae&&Yi(ae)}return I.h}hn.prototype.toString=function(){return Yi(this).toString()};function $o(I,B){if(I=I.o){_t(B,B.g.end());for(var V=0;V<I.length;V++)_t(B,I[V])}}function ji(I,B){if(B.h==4)return!1;var V=B.m;return Hr(B),B.N||(B=rt(B.g.h,V,B.g.g),(V=I.o)?V.push(B):I.o=[B]),!0}function es(I){hn.call(this,I,-1,fh)}R(es,hn),es.prototype.getRows=function(){return nn(this,1)},es.prototype.getCols=function(){return nn(this,2)},es.prototype.getPackedDataList=function(){return Al(this)},es.prototype.getLayout=function(){return Li(this,4,0)};function ph(I,B){for(;zn(B);)switch(B.i){case 8:var V=B.g.i();Rt(I,1,V);break;case 16:V=B.g.i(),Rt(I,2,V);break;case 29:case 26:hi(B,I.getPackedDataList());break;case 32:V=kn(B.g),Rt(I,4,V);break;default:if(!ji(I,B))return I}return I}var fh=[3];function $n(I,B){var V=void 0;return new(V||(V=Promise))(function(ae,Se){function xe(He){try{De(B.next(He))}catch(Je){Se(Je)}}function Pe(He){try{De(B.throw(He))}catch(Je){Se(Je)}}function De(He){He.done?ae(He.value):new V(function(Je){Je(He.value)}).then(xe,Pe)}De((B=B.apply(I,void 0)).next())})}function ua(I){hn.call(this,I)}R(ua,hn);function mh(I,B){for(;zn(B);)switch(B.i){case 8:var V=B.g.i();Rt(I,1,V);break;case 21:V=Kn(B),Rt(I,2,V);break;case 26:V=la(B),Rt(I,3,V);break;case 34:V=la(B),Rt(I,4,V);break;default:if(!ji(I,B))return I}return I}function Wo(I){hn.call(this,I,-1,gh)}R(Wo,hn),Wo.prototype.addClassification=function(I,B){return Dl(this,I,ua,B),this};var gh=[1];function ks(I){hn.call(this,I)}R(ks,hn);function vh(I,B){for(;zn(B);)switch(B.i){case 13:var V=Kn(B);Rt(I,1,V);break;case 21:V=Kn(B),Rt(I,2,V);break;case 29:V=Kn(B),Rt(I,3,V);break;case 37:V=Kn(B),Rt(I,4,V);break;case 45:V=Kn(B),Rt(I,5,V);break;default:if(!ji(I,B))return I}return I}function Nl(I){hn.call(this,I,-1,yh)}R(Nl,hn);function Ol(I){e:{var B=new Nl;for(I=new di(I);zn(I);)switch(I.i){case 10:var V=Cs(I,new ks,vh);Dl(B,V,ks,void 0);break;default:if(!ji(B,I))break e}}return B}var yh=[1];function Go(I){hn.call(this,I)}R(Go,hn);function ts(I){hn.call(this,I,-1,da)}R(ts,hn),ts.prototype.getVertexType=function(){return Li(this,1,0)},ts.prototype.getPrimitiveType=function(){return Li(this,2,0)},ts.prototype.getVertexBufferList=function(){return Al(this)},ts.prototype.getIndexBufferList=function(){return Ps(this,4)};function _h(I,B){for(;zn(B);)switch(B.i){case 8:var V=kn(B.g);Rt(I,1,V);break;case 16:V=kn(B.g),Rt(I,2,V);break;case 29:case 26:hi(B,I.getVertexBufferList());break;case 32:case 34:V=B;var ae=I.getIndexBufferList();V.h==2?jn(V,Pn.prototype.i,ae):ae.push(V.g.i());break;default:if(!ji(I,B))return I}return I}var da=[3,4];function ha(I){hn.call(this,I)}R(ha,hn),ha.prototype.getMesh=function(){return Il(this,ts,1)},ha.prototype.getPoseTransformMatrix=function(){return Il(this,es,2)};function bh(I){e:{var B=new ha;for(I=new di(I);zn(I);)switch(I.i){case 10:var V=Cs(I,new ts,_h);Fl(B,1,V);break;case 18:V=Cs(I,new es,ph),Fl(B,2,V);break;default:if(!ji(B,I))break e}}return B}function Ml(I,B,V){if(V=I.createShader(V===0?I.VERTEX_SHADER:I.FRAGMENT_SHADER),I.shaderSource(V,B),I.compileShader(V),!I.getShaderParameter(V,I.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+I.getShaderInfoLog(V));return V}function Sh(I){return Wa(I,ua).map(function(B){return{index:Li(B,1,0),Y:Xr(B,2),label:nn(B,3)!=null?Li(B,3,""):void 0,displayName:nn(B,4)!=null?Li(B,4,""):void 0}})}function Ll(I){return{x:Xr(I,1),y:Xr(I,2),z:Xr(I,3),visibility:nn(I,4)!=null?Xr(I,4):void 0}}function Jo(I,B){this.h=I,this.g=B,this.l=0}function ns(I,B,V){return wh(I,B),typeof I.g.canvas.transferToImageBitmap=="function"?Promise.resolve(I.g.canvas.transferToImageBitmap()):V?Promise.resolve(I.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(I.g.canvas):(I.i===void 0&&(I.i=document.createElement("canvas")),new Promise(function(ae){I.i.height=I.g.canvas.height,I.i.width=I.g.canvas.width,I.i.getContext("2d",{}).drawImage(I.g.canvas,0,0,I.g.canvas.width,I.g.canvas.height),ae(I.i)}))}function wh(I,B){var V=I.g;if(I.m===void 0){var ae=Ml(V,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),Se=Ml(V,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),xe=V.createProgram();if(V.attachShader(xe,ae),V.attachShader(xe,Se),V.linkProgram(xe),!V.getProgramParameter(xe,V.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+V.getProgramInfoLog(xe));ae=I.m=xe,V.useProgram(ae),Se=V.getUniformLocation(ae,"sampler0"),I.j={I:V.getAttribLocation(ae,"aVertex"),H:V.getAttribLocation(ae,"aTex"),da:Se},I.s=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,I.s),V.enableVertexAttribArray(I.j.I),V.vertexAttribPointer(I.j.I,2,V.FLOAT,!1,0,0),V.bufferData(V.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null),I.o=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,I.o),V.enableVertexAttribArray(I.j.H),V.vertexAttribPointer(I.j.H,2,V.FLOAT,!1,0,0),V.bufferData(V.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null),V.uniform1i(Se,0)}ae=I.j,V.useProgram(I.m),V.canvas.width=B.width,V.canvas.height=B.height,V.viewport(0,0,B.width,B.height),V.activeTexture(V.TEXTURE0),I.h.bindTexture2d(B.glName),V.enableVertexAttribArray(ae.I),V.bindBuffer(V.ARRAY_BUFFER,I.s),V.vertexAttribPointer(ae.I,2,V.FLOAT,!1,0,0),V.enableVertexAttribArray(ae.H),V.bindBuffer(V.ARRAY_BUFFER,I.o),V.vertexAttribPointer(ae.H,2,V.FLOAT,!1,0,0),V.bindFramebuffer(V.DRAW_FRAMEBUFFER?V.DRAW_FRAMEBUFFER:V.FRAMEBUFFER,null),V.clearColor(0,0,0,0),V.clear(V.COLOR_BUFFER_BIT),V.colorMask(!0,!0,!0,!0),V.drawArrays(V.TRIANGLE_FAN,0,4),V.disableVertexAttribArray(ae.I),V.disableVertexAttribArray(ae.H),V.bindBuffer(V.ARRAY_BUFFER,null),I.h.bindTexture2d(0)}function xh(I){this.g=I}var Ch=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Eh(I,B){return B+I}function jl(I,B){window[I]=B}function Ph(I){var B=document.createElement("script");return B.setAttribute("src",I),B.setAttribute("crossorigin","anonymous"),new Promise(function(V){B.addEventListener("load",function(){V()},!1),B.addEventListener("error",function(){V()},!1),document.body.appendChild(B)})}function kh(){return $n(this,function I(){return X(I,function(B){switch(B.g){case 1:return B.m=2,E(B,WebAssembly.instantiate(Ch),4);case 4:B.g=3,B.m=0;break;case 2:return B.m=0,B.j=null,B.return(!1);case 3:return B.return(!0)}})})}function Zo(I){if(this.g=I,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=I&&I.locateFile||Eh,typeof window=="object")var B=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")B=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.S=B,I.options){B=u(Object.keys(I.options));for(var V=B.next();!V.done;V=B.next()){V=V.value;var ae=I.options[V].default;ae!==void 0&&(this.j[V]=typeof ae=="function"?ae():ae)}}}e=Zo.prototype,e.close=function(){return this.i&&this.i.delete(),Promise.resolve()};function Th(I,B){return I.g.files===void 0?[]:typeof I.g.files=="function"?I.g.files(B):I.g.files}function Wn(I){return $n(I,function B(){var V=this,ae,Se,xe,Pe,De,He,Je,pt,zt,st,vt;return X(B,function(nt){switch(nt.g){case 1:return ae=V,V.R?(Se=Th(V,V.j),E(nt,kh(),2)):nt.return();case 2:if(xe=nt.h,typeof window=="object")return jl("createMediapipeSolutionsWasm",{locateFile:V.locateFile}),jl("createMediapipeSolutionsPackedAssets",{locateFile:V.locateFile}),He=Se.filter(function(ft){return ft.data!==void 0}),Je=Se.filter(function(ft){return ft.data===void 0}),pt=Promise.all(He.map(function(ft){var xt=Qo(ae,ft.url);if(ft.path!==void 0){var Dt=ft.path;xt=xt.then(function(Tn){return ae.overrideFile(Dt,Tn),Promise.resolve(Tn)})}return xt})),zt=Promise.all(Je.map(function(ft){return ft.simd===void 0||ft.simd&&xe||!ft.simd&&!xe?Ph(ae.locateFile(ft.url,ae.S)):Promise.resolve()})).then(function(){return $n(ae,function ft(){var xt,Dt,Tn=this;return X(ft,function(Gt){if(Gt.g==1)return xt=window.createMediapipeSolutionsWasm,Dt=window.createMediapipeSolutionsPackedAssets,E(Gt,xt(Dt),2);Tn.h=Gt.h,Gt.g=0})})}),st=function(){return $n(ae,function ft(){var xt=this;return X(ft,function(Dt){return xt.g.graph&&xt.g.graph.url?Dt=E(Dt,Qo(xt,xt.g.graph.url),0):(Dt.g=0,Dt=void 0),Dt})})}(),E(nt,Promise.all([zt,pt,st]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return Pe=Se.filter(function(ft){return ft.simd===void 0||ft.simd&&xe||!ft.simd&&!xe}).map(function(ft){return ae.locateFile(ft.url,ae.S)}),importScripts.apply(null,p(Pe)),E(nt,createMediapipeSolutionsWasm(Module),6);case 6:V.h=nt.h,V.l=new OffscreenCanvas(1,1),V.h.canvas=V.l,De=V.h.GL.createContext(V.l,{antialias:!1,alpha:!1,ba:typeof WebGL2RenderingContext<"u"?2:1}),V.h.GL.makeContextCurrent(De),nt.g=4;break;case 7:if(V.l=document.createElement("canvas"),vt=V.l.getContext("webgl2",{}),!vt&&(vt=V.l.getContext("webgl",{}),!vt))return alert("Failed to create WebGL canvas context when passing video frame."),nt.return();V.D=vt,V.h.canvas=V.l,V.h.createContext(V.l,!0,!0,{});case 4:V.i=new V.h.SolutionWasm,V.R=!1,nt.g=0}})})}function Rh(I){return $n(I,function B(){var V=this,ae,Se,xe,Pe,De,He,Je,pt;return X(B,function(zt){if(zt.g==1){if(V.g.graph&&V.g.graph.url&&V.P===V.g.graph.url)return zt.return();if(V.o=!0,!V.g.graph||!V.g.graph.url){zt.g=2;return}return V.P=V.g.graph.url,E(zt,Qo(V,V.g.graph.url),3)}for(zt.g!=2&&(ae=zt.h,V.i.loadGraph(ae)),Se=u(Object.keys(V.B)),xe=Se.next();!xe.done;xe=Se.next())Pe=xe.value,V.i.overrideFile(Pe,V.B[Pe]);if(V.B={},V.g.listeners)for(De=u(V.g.listeners),He=De.next();!He.done;He=De.next())Je=He.value,Fh(V,Je);pt=V.j,V.j={},V.setOptions(pt),zt.g=0})})}e.reset=function(){return $n(this,function I(){var B=this;return X(I,function(V){B.i&&(B.i.reset(),B.m={},B.s={}),V.g=0})})},e.setOptions=function(I,B){var V=this;if(B=B||this.g.options){for(var ae=[],Se=[],xe={},Pe=u(Object.keys(I)),De=Pe.next();!De.done;xe={K:xe.K,L:xe.L},De=Pe.next()){var He=De.value;He in this.j&&this.j[He]===I[He]||(this.j[He]=I[He],De=B[He],De!==void 0&&(De.onChange&&(xe.K=De.onChange,xe.L=I[He],ae.push(function(Je){return function(){return $n(V,function pt(){var zt,st=this;return X(pt,function(vt){if(vt.g==1)return E(vt,Je.K(Je.L),2);zt=vt.h,zt===!0&&(st.o=!0),vt.g=0})})}}(xe))),De.graphOptionXref&&(He={valueNumber:De.type===1?I[He]:0,valueBoolean:De.type===0?I[He]:!1,valueString:De.type===2?I[He]:""},De=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),De.graphOptionXref),He),Se.push(De))))}(ae.length!==0||Se.length!==0)&&(this.o=!0,this.A=(this.A===void 0?[]:this.A).concat(Se),this.u=(this.u===void 0?[]:this.u).concat(ae))}};function Ah(I){return $n(I,function B(){var V=this,ae,Se,xe,Pe,De,He,Je;return X(B,function(pt){switch(pt.g){case 1:if(!V.o)return pt.return();if(!V.u){pt.g=2;break}ae=u(V.u),Se=ae.next();case 3:if(Se.done){pt.g=5;break}return xe=Se.value,E(pt,xe(),4);case 4:Se=ae.next(),pt.g=3;break;case 5:V.u=void 0;case 2:if(V.A){for(Pe=new V.h.GraphOptionChangeRequestList,De=u(V.A),He=De.next();!He.done;He=De.next())Je=He.value,Pe.push_back(Je);V.i.changeOptions(Pe),Pe.delete(),V.A=void 0}V.o=!1,pt.g=0}})})}e.initialize=function(){return $n(this,function I(){var B=this;return X(I,function(V){return V.g==1?E(V,Wn(B),2):V.g!=3?E(V,Rh(B),3):E(V,Ah(B),0)})})};function Qo(I,B){return $n(I,function V(){var ae=this,Se,xe;return X(V,function(Pe){return B in ae.F?Pe.return(ae.F[B]):(Se=ae.locateFile(B,""),xe=fetch(Se).then(function(De){return De.arrayBuffer()}),ae.F[B]=xe,Pe.return(xe))})})}e.overrideFile=function(I,B){this.i?this.i.overrideFile(I,B):this.B[I]=B},e.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},e.send=function(I,B){return $n(this,function V(){var ae=this,Se,xe,Pe,De,He,Je,pt,zt,st;return X(V,function(vt){switch(vt.g){case 1:return ae.g.inputs?(Se=1e3*(B??performance.now()),E(vt,ae.C,2)):vt.return();case 2:return E(vt,ae.initialize(),3);case 3:for(xe=new ae.h.PacketDataList,Pe=u(Object.keys(I)),De=Pe.next();!De.done;De=Pe.next())if(He=De.value,Je=ae.g.inputs[He]){e:{var nt=ae,ft=I[He];switch(Je.type){case"video":var xt=nt.m[Je.stream];if(xt||(xt=new Jo(nt.h,nt.D),nt.m[Je.stream]=xt),nt=xt,nt.l===0&&(nt.l=nt.h.createTexture()),typeof HTMLVideoElement<"u"&&ft instanceof HTMLVideoElement){var Dt=ft.videoWidth;xt=ft.videoHeight}else typeof HTMLImageElement<"u"&&ft instanceof HTMLImageElement?(Dt=ft.naturalWidth,xt=ft.naturalHeight):(Dt=ft.width,xt=ft.height);xt={glName:nt.l,width:Dt,height:xt},Dt=nt.g,Dt.canvas.width=xt.width,Dt.canvas.height=xt.height,Dt.activeTexture(Dt.TEXTURE0),nt.h.bindTexture2d(nt.l),Dt.texImage2D(Dt.TEXTURE_2D,0,Dt.RGBA,Dt.RGBA,Dt.UNSIGNED_BYTE,ft),nt.h.bindTexture2d(0),nt=xt;break e;case"detections":for(xt=nt.m[Je.stream],xt||(xt=new xh(nt.h),nt.m[Je.stream]=xt),nt=xt,nt.data||(nt.data=new nt.g.DetectionListData),nt.data.reset(ft.length),xt=0;xt<ft.length;++xt){Dt=ft[xt];var Tn=nt.data,Gt=Tn.setBoundingBox,Gn=xt,ct=Dt.T,bt=new Go;Rt(bt,1,ct.Z),Rt(bt,2,ct.$),Rt(bt,3,ct.height),Rt(bt,4,ct.width),Rt(bt,5,ct.rotation),Rt(bt,6,ct.X);var Mt=ct=new Mi;at(Mt,1,nn(bt,1)),at(Mt,2,nn(bt,2)),at(Mt,3,nn(bt,3)),at(Mt,4,nn(bt,4)),at(Mt,5,nn(bt,5));var Bt=nn(bt,6);if(Bt!=null&&Bt!=null){Qr(Mt.g,48);var kt=Mt.g,Lt=Bt;Bt=0>Lt,Lt=Math.abs(Lt);var Ut=Lt>>>0;for(Lt=Math.floor((Lt-Ut)/4294967296),Lt>>>=0,Bt&&(Lt=~Lt>>>0,Ut=(~Ut>>>0)+1,4294967295<Ut&&(Ut=0,Lt++,4294967295<Lt&&(Lt=0))),ot=Ut,wt=Lt,Bt=ot,Ut=wt;0<Ut||127<Bt;)kt.push(Bt&127|128),Bt=(Bt>>>7|Ut<<25)>>>0,Ut>>>=7;kt.push(Bt)}if($o(bt,Mt),ct=Ft(ct),Gt.call(Tn,Gn,ct),Dt.O)for(Tn=0;Tn<Dt.O.length;++Tn)bt=Dt.O[Tn],Mt=!!bt.visibility,Gt=nt.data,Gn=Gt.addNormalizedLandmark,ct=xt,bt=Object.assign(Object.assign({},bt),{visibility:Mt?bt.visibility:0}),Mt=new ks,Rt(Mt,1,bt.x),Rt(Mt,2,bt.y),Rt(Mt,3,bt.z),bt.visibility&&Rt(Mt,4,bt.visibility),kt=bt=new Mi,at(kt,1,nn(Mt,1)),at(kt,2,nn(Mt,2)),at(kt,3,nn(Mt,3)),at(kt,4,nn(Mt,4)),at(kt,5,nn(Mt,5)),$o(Mt,kt),bt=Ft(bt),Gn.call(Gt,ct,bt);if(Dt.M)for(Tn=0;Tn<Dt.M.length;++Tn){if(Gt=nt.data,Gn=Gt.addClassification,ct=xt,bt=Dt.M[Tn],Mt=new ua,Rt(Mt,2,bt.Y),bt.index&&Rt(Mt,1,bt.index),bt.label&&Rt(Mt,3,bt.label),bt.displayName&&Rt(Mt,4,bt.displayName),kt=bt=new Mi,Ut=nn(Mt,1),Ut!=null&&Ut!=null)if(Qr(kt.g,8),Bt=kt.g,0<=Ut)Qr(Bt,Ut);else{for(Lt=0;9>Lt;Lt++)Bt.push(Ut&127|128),Ut>>=7;Bt.push(1)}at(kt,2,nn(Mt,2)),Bt=nn(Mt,3),Bt!=null&&(Bt=_e(Bt),Qr(kt.g,26),Qr(kt.g,Bt.length),_t(kt,kt.g.end()),_t(kt,Bt)),Bt=nn(Mt,4),Bt!=null&&(Bt=_e(Bt),Qr(kt.g,34),Qr(kt.g,Bt.length),_t(kt,kt.g.end()),_t(kt,Bt)),$o(Mt,kt),bt=Ft(bt),Gn.call(Gt,ct,bt)}}nt=nt.data;break e;default:nt={}}}switch(pt=nt,zt=Je.stream,Je.type){case"video":xe.pushTexture2d(Object.assign(Object.assign({},pt),{stream:zt,timestamp:Se}));break;case"detections":st=pt,st.stream=zt,st.timestamp=Se,xe.pushDetectionList(st);break;default:throw Error("Unknown input config type: '"+Je.type+"'")}}return ae.i.send(xe),E(vt,ae.C,4);case 4:xe.delete(),vt.g=0}})})};function Xo(I,B,V){return $n(I,function ae(){var Se,xe,Pe,De,He,Je,pt=this,zt,st,vt,nt,ft,xt,Dt,Tn;return X(ae,function(Gt){switch(Gt.g){case 1:if(!V)return Gt.return(B);for(Se={},xe=0,Pe=u(Object.keys(V)),De=Pe.next();!De.done;De=Pe.next())He=De.value,Je=V[He],typeof Je!="string"&&Je.type==="texture"&&B[Je.stream]!==void 0&&++xe;1<xe&&(pt.G=!1),zt=u(Object.keys(V)),De=zt.next();case 2:if(De.done){Gt.g=4;break}if(st=De.value,vt=V[st],typeof vt=="string")return Dt=Se,Tn=st,E(Gt,Ih(pt,st,B[vt]),14);if(nt=B[vt.stream],vt.type==="detection_list"){if(nt){for(var Gn=nt.getRectList(),ct=nt.getLandmarksList(),bt=nt.getClassificationsList(),Mt=[],Bt=0;Bt<Gn.size();++Bt){var kt=Gn.get(Bt);e:{var Lt=new Go;for(kt=new di(kt);zn(kt);)switch(kt.i){case 13:var Ut=Kn(kt);Rt(Lt,1,Ut);break;case 21:Ut=Kn(kt),Rt(Lt,2,Ut);break;case 29:Ut=Kn(kt),Rt(Lt,3,Ut);break;case 37:Ut=Kn(kt),Rt(Lt,4,Ut);break;case 45:Ut=Kn(kt),Rt(Lt,5,Ut);break;case 48:Ut=kn(kt.g),Rt(Lt,6,Ut);break;default:if(!ji(Lt,kt))break e}}Lt={Z:Xr(Lt,1),$:Xr(Lt,2),height:Xr(Lt,3),width:Xr(Lt,4),rotation:Xr(Lt,5,0),X:Li(Lt,6,0)},kt=Wa(Ol(ct.get(Bt)),ks).map(Ll);var Ts=bt.get(Bt);e:for(Ut=new Wo,Ts=new di(Ts);zn(Ts);)switch(Ts.i){case 10:Ut.addClassification(Cs(Ts,new ua,mh));break;default:if(!ji(Ut,Ts))break e}Lt={T:Lt,O:kt,M:Sh(Ut)},Mt.push(Lt)}Gn=Mt}else Gn=[];Se[st]=Gn,Gt.g=7;break}if(vt.type==="proto_list"){if(nt){for(Gn=Array(nt.size()),ct=0;ct<nt.size();ct++)Gn[ct]=nt.get(ct);nt.delete()}else Gn=[];Se[st]=Gn,Gt.g=7;break}if(nt===void 0){Gt.g=3;break}if(vt.type==="float_list"){Se[st]=nt,Gt.g=7;break}if(vt.type==="proto"){Se[st]=nt,Gt.g=7;break}if(vt.type!=="texture")throw Error("Unknown output config type: '"+vt.type+"'");return ft=pt.s[st],ft||(ft=new Jo(pt.h,pt.D),pt.s[st]=ft),E(Gt,ns(ft,nt,pt.G),13);case 13:xt=Gt.h,Se[st]=xt;case 7:vt.transform&&Se[st]&&(Se[st]=vt.transform(Se[st])),Gt.g=3;break;case 14:Dt[Tn]=Gt.h;case 3:De=zt.next(),Gt.g=2;break;case 4:return Gt.return(Se)}})})}function Ih(I,B,V){return $n(I,function ae(){var Se=this,xe;return X(ae,function(Pe){return typeof V=="number"||V instanceof Uint8Array||V instanceof Se.h.Uint8BlobList?Pe.return(V):V instanceof Se.h.Texture2dDataOut?(xe=Se.s[B],xe||(xe=new Jo(Se.h,Se.D),Se.s[B]=xe),Pe.return(ns(xe,V,Se.G))):Pe.return(void 0)})})}function Fh(I,B){for(var V=B.name||"$",ae=[].concat(p(B.wants)),Se=new I.h.StringList,xe=u(B.wants),Pe=xe.next();!Pe.done;Pe=xe.next())Se.push_back(Pe.value);xe=I.h.PacketListener.implement({onResults:function(De){for(var He={},Je=0;Je<B.wants.length;++Je)He[ae[Je]]=De.get(Je);var pt=I.listeners[V];pt&&(I.C=Xo(I,He,B.outs).then(function(zt){zt=pt(zt);for(var st=0;st<B.wants.length;++st){var vt=He[ae[st]];typeof vt=="object"&&vt.hasOwnProperty&&vt.hasOwnProperty("delete")&&vt.delete()}zt&&(I.C=zt)}))}}),I.i.attachMultiListener(Se,xe),Se.delete()}e.onResults=function(I,B){this.listeners[B||"$"]=I},ce("Solution",Zo),ce("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"});function Dh(I){I=bh(I);var B=I.getMesh();if(!B)return I;var V=new Float32Array(B.getVertexBufferList());B.getVertexBufferList=function(){return V};var ae=new Uint32Array(B.getIndexBufferList());return B.getIndexBufferList=function(){return ae},I}var Yo={files:[{url:"face_mesh_solution_packed_assets_loader.js"},{simd:!0,url:"face_mesh_solution_simd_wasm_bin.js"},{simd:!1,url:"face_mesh_solution_wasm_bin.js"}],graph:{url:"face_mesh.binarypb"},listeners:[{wants:["multi_face_geometry","image_transformed","multi_face_landmarks"],outs:{image:"image_transformed",multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:function(I){return I.map(Dh)}},multiFaceLandmarks:{type:"proto_list",stream:"multi_face_landmarks",transform:function(I){return I.map(function(B){return Wa(Ol(B),ks).map(Ll)})}}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumFaces:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorNumFaces",fieldName:"int_value"}},refineLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facelandmarkfrontgpu__facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"facelandmarkfrontgpu__facelandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}},pa=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],tr=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],xn=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Bl=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Ga=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Pr=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],ec=[].concat(p(pa),p(tr),p(xn),p(Bl),p(Ga),p(Pr));function Ja(I){I=I||{},I=Object.assign(Object.assign({},Yo),I),this.g=new Zo(I)}e=Ja.prototype,e.close=function(){return this.g.close(),Promise.resolve()},e.onResults=function(I){this.g.onResults(I)},e.initialize=function(){return $n(this,function I(){var B=this;return X(I,function(V){return E(V,B.g.initialize(),0)})})},e.reset=function(){this.g.reset()},e.send=function(I){return $n(this,function B(){var V=this;return X(B,function(ae){return E(ae,V.g.send(I),0)})})},e.setOptions=function(I){this.g.setOptions(I)},ce("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),ce("FaceMesh",Ja),ce("FACEMESH_LIPS",pa),ce("FACEMESH_LEFT_EYE",tr),ce("FACEMESH_LEFT_EYEBROW",xn),ce("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),ce("FACEMESH_RIGHT_EYE",Bl),ce("FACEMESH_RIGHT_EYEBROW",Ga),ce("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),ce("FACEMESH_FACE_OVAL",Pr),ce("FACEMESH_CONTOURS",ec),ce("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),ce("matrixDataToMatrix",function(I){for(var B=I.getCols(),V=I.getRows(),ae=I.getPackedDataList(),Se=[],xe=0;xe<V;xe++)Se.push(Array(B));for(xe=0;xe<V;xe++)for(var Pe=0;Pe<B;Pe++){var De=I.getLayout()===1?xe*B+Pe:Pe*V+xe;Se[xe][Pe]=ae[De]}return Se}),ce("VERSION","0.4.1633559619")}).call(Ei);var Bw=Object.create,Kd=Object.defineProperty,Uw=Object.defineProperties,Hw=Object.getOwnPropertyDescriptor,Vw=Object.getOwnPropertyDescriptors,Um=Object.getOwnPropertyNames,Fv=Object.getOwnPropertySymbols,qw=Object.getPrototypeOf,Fy=Object.prototype.hasOwnProperty,zw=Object.prototype.propertyIsEnumerable,xo=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),Hm=e=>{throw TypeError(e)},_s=Math.pow,Pf=(e,t,n)=>t in e?Kd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ie=(e,t)=>{for(var n in t||(t={}))Fy.call(t,n)&&Pf(e,n,t[n]);if(Fv)for(var n of Fv(t))zw.call(t,n)&&Pf(e,n,t[n]);return e},we=(e,t)=>Uw(e,Vw(t)),Kw=(e,t)=>function(){return e&&(t=(0,e[Um(e)[0]])(e=0)),t},Ee=(e,t)=>function(){return t||(0,e[Um(e)[0]])((t={exports:{}}).exports,t),t.exports},Dy=(e,t)=>{for(var n in t)Kd(e,n,{get:t[n],enumerable:!0})},$w=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Um(t))!Fy.call(e,i)&&i!==n&&Kd(e,i,{get:()=>t[i],enumerable:!(r=Hw(t,i))||r.enumerable});return e},Br=(e,t,n)=>(n=e!=null?Bw(qw(e)):{},$w(!e||!e.__esModule?Kd(n,"default",{value:e,enumerable:!0}):n,e)),ge=(e,t,n)=>Pf(e,typeof t!="symbol"?t+"":t,n),Ny=(e,t,n)=>t.has(e)||Hm("Cannot "+n),Ct=(e,t,n)=>(Ny(e,t,"read from private field"),n?n.call(e):t.get(e)),ar=(e,t,n)=>t.has(e)?Hm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),un=(e,t,n,r)=>(Ny(e,t,"write to private field"),t.set(e,n),n),H=(e,t,n)=>new Promise((r,i)=>{var a=p=>{try{u(n.next(p))}catch(h){i(h)}},o=p=>{try{u(n.throw(p))}catch(h){i(h)}},u=p=>p.done?r(p.value):Promise.resolve(p.value).then(a,o);u((n=n.apply(e,t)).next())}),Fo=function(e,t){this[0]=e,this[1]=t},Oy=(e,t,n)=>{var r=(o,u,p,h)=>{try{var v=n[o](u),f=(u=v.value)instanceof Fo,_=v.done;Promise.resolve(f?u[0]:u).then(w=>f?r(o==="return"?o:"next",u[1]?{done:w.done,value:w.value}:w,p,h):p({value:w,done:_})).catch(w=>r("throw",w,p,h))}catch(w){h(w)}},i=o=>a[o]=u=>new Promise((p,h)=>r(o,u,p,h)),a={};return n=n.apply(e,t),a[xo("asyncIterator")]=()=>a,i("next"),i("throw"),i("return"),a},My=e=>{var t=e[xo("asyncIterator")],n=!1,r,i={};return t==null?(t=e[xo("iterator")](),r=a=>i[a]=o=>t[a](o)):(t=t.call(e),r=a=>i[a]=o=>{if(n){if(n=!1,a==="throw")throw o;return o}return n=!0,{done:!1,value:new Fo(new Promise(u=>{var p=t[a](o);p instanceof Object||Hm("Object expected"),u(p)}),1)}}),i[xo("iterator")]=()=>i,r("next"),"throw"in t?r("throw"):i.throw=a=>{throw a},"return"in t&&r("return"),i},Ww=(e,t,n)=>(t=e[xo("asyncIterator")])?t.call(e):(e=e[xo("iterator")](),t={},n=(r,i)=>(i=e[r])&&(t[r]=a=>new Promise((o,u,p)=>(a=i.call(e,a),p=a.done,Promise.resolve(a.value).then(h=>o({value:h,done:p}),u)))),n("next"),n("return"),t),Co,Y=Kw({"shims/process.js"(){Co=void 0}}),Gw=Ee({"../../node_modules/.pnpm/bowser@2.11.0/node_modules/bowser/es5.js"(e,t){Y(),function(n,r){typeof e=="object"&&typeof t=="object"?t.exports=r():typeof define=="function"&&define.amd?define([],r):typeof e=="object"?e.bowser=r():n.bowser=r()}(e,function(){return function(n){var r={};function i(a){if(r[a])return r[a].exports;var o=r[a]={i:a,l:!1,exports:{}};return n[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(a,o,u){i.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:u})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,o){if(1&o&&(a=i(a)),8&o||4&o&&typeof a=="object"&&a&&a.__esModule)return a;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:a}),2&o&&typeof a!="string")for(var p in a)i.d(u,p,(function(h){return a[h]}).bind(null,p));return u},i.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(o,"a",o),o},i.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},i.p="",i(i.s=90)}({17:function(n,r,i){r.__esModule=!0,r.default=void 0;var a=i(18),o=function(){function u(){}return u.getFirstMatch=function(p,h){var v=h.match(p);return v&&v.length>0&&v[1]||""},u.getSecondMatch=function(p,h){var v=h.match(p);return v&&v.length>1&&v[2]||""},u.matchAndReturnConst=function(p,h,v){if(p.test(h))return v},u.getWindowsVersionName=function(p){switch(p){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},u.getMacOSVersionName=function(p){var h=p.split(".").splice(0,2).map(function(v){return parseInt(v,10)||0});if(h.push(0),h[0]===10)switch(h[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},u.getAndroidVersionName=function(p){var h=p.split(".").splice(0,2).map(function(v){return parseInt(v,10)||0});if(h.push(0),!(h[0]===1&&h[1]<5))return h[0]===1&&h[1]<6?"Cupcake":h[0]===1&&h[1]>=6?"Donut":h[0]===2&&h[1]<2?"Eclair":h[0]===2&&h[1]===2?"Froyo":h[0]===2&&h[1]>2?"Gingerbread":h[0]===3?"Honeycomb":h[0]===4&&h[1]<1?"Ice Cream Sandwich":h[0]===4&&h[1]<4?"Jelly Bean":h[0]===4&&h[1]>=4?"KitKat":h[0]===5?"Lollipop":h[0]===6?"Marshmallow":h[0]===7?"Nougat":h[0]===8?"Oreo":h[0]===9?"Pie":void 0},u.getVersionPrecision=function(p){return p.split(".").length},u.compareVersions=function(p,h,v){v===void 0&&(v=!1);var f=u.getVersionPrecision(p),_=u.getVersionPrecision(h),w=Math.max(f,_),C=0,R=u.map([p,h],function(S){var b=w-u.getVersionPrecision(S),x=S+new Array(b+1).join(".0");return u.map(x.split("."),function(E){return new Array(20-E.length).join("0")+E}).reverse()});for(v&&(C=w-Math.min(f,_)),w-=1;w>=C;){if(R[0][w]>R[1][w])return 1;if(R[0][w]===R[1][w]){if(w===C)return 0;w-=1}else if(R[0][w]<R[1][w])return-1}},u.map=function(p,h){var v,f=[];if(Array.prototype.map)return Array.prototype.map.call(p,h);for(v=0;v<p.length;v+=1)f.push(h(p[v]));return f},u.find=function(p,h){var v,f;if(Array.prototype.find)return Array.prototype.find.call(p,h);for(v=0,f=p.length;v<f;v+=1){var _=p[v];if(h(_,v))return _}},u.assign=function(p){for(var h,v,f=p,_=arguments.length,w=new Array(_>1?_-1:0),C=1;C<_;C++)w[C-1]=arguments[C];if(Object.assign)return Object.assign.apply(Object,[p].concat(w));var R=function(){var S=w[h];typeof S=="object"&&S!==null&&Object.keys(S).forEach(function(b){f[b]=S[b]})};for(h=0,v=w.length;h<v;h+=1)R();return p},u.getBrowserAlias=function(p){return a.BROWSER_ALIASES_MAP[p]},u.getBrowserTypeByAlias=function(p){return a.BROWSER_MAP[p]||""},u}();r.default=o,n.exports=r.default},18:function(n,r,i){r.__esModule=!0,r.ENGINE_MAP=r.OS_MAP=r.PLATFORMS_MAP=r.BROWSER_MAP=r.BROWSER_ALIASES_MAP=void 0,r.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},r.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},r.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},r.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},r.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(91))&&a.__esModule?a:{default:a},u=i(18);function p(v,f){for(var _=0;_<f.length;_++){var w=f[_];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}var h=function(){function v(){}var f,_,w;return v.getParser=function(C,R){if(R===void 0&&(R=!1),typeof C!="string")throw new Error("UserAgent should be a string");return new o.default(C,R)},v.parse=function(C){return new o.default(C).getResult()},f=v,w=[{key:"BROWSER_MAP",get:function(){return u.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return u.ENGINE_MAP}},{key:"OS_MAP",get:function(){return u.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return u.PLATFORMS_MAP}}],(_=null)&&p(f.prototype,_),w&&p(f,w),v}();r.default=h,n.exports=r.default},91:function(n,r,i){r.__esModule=!0,r.default=void 0;var a=v(i(92)),o=v(i(93)),u=v(i(94)),p=v(i(95)),h=v(i(17));function v(_){return _&&_.__esModule?_:{default:_}}var f=function(){function _(C,R){if(R===void 0&&(R=!1),C==null||C==="")throw new Error("UserAgent parameter can't be empty");this._ua=C,this.parsedResult={},R!==!0&&this.parse()}var w=_.prototype;return w.getUA=function(){return this._ua},w.test=function(C){return C.test(this._ua)},w.parseBrowser=function(){var C=this;this.parsedResult.browser={};var R=h.default.find(a.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.browser=R.describe(this.getUA())),this.parsedResult.browser},w.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},w.getBrowserName=function(C){return C?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},w.getBrowserVersion=function(){return this.getBrowser().version},w.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},w.parseOS=function(){var C=this;this.parsedResult.os={};var R=h.default.find(o.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.os=R.describe(this.getUA())),this.parsedResult.os},w.getOSName=function(C){var R=this.getOS().name;return C?String(R).toLowerCase()||"":R||""},w.getOSVersion=function(){return this.getOS().version},w.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},w.getPlatformType=function(C){C===void 0&&(C=!1);var R=this.getPlatform().type;return C?String(R).toLowerCase()||"":R||""},w.parsePlatform=function(){var C=this;this.parsedResult.platform={};var R=h.default.find(u.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.platform=R.describe(this.getUA())),this.parsedResult.platform},w.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},w.getEngineName=function(C){return C?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},w.parseEngine=function(){var C=this;this.parsedResult.engine={};var R=h.default.find(p.default,function(S){if(typeof S.test=="function")return S.test(C);if(S.test instanceof Array)return S.test.some(function(b){return C.test(b)});throw new Error("Browser's test function is not valid")});return R&&(this.parsedResult.engine=R.describe(this.getUA())),this.parsedResult.engine},w.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},w.getResult=function(){return h.default.assign({},this.parsedResult)},w.satisfies=function(C){var R=this,S={},b=0,x={},E=0;if(Object.keys(C).forEach(function(ee){var oe=C[ee];typeof oe=="string"?(x[ee]=oe,E+=1):typeof oe=="object"&&(S[ee]=oe,b+=1)}),b>0){var M=Object.keys(S),Z=h.default.find(M,function(ee){return R.isOS(ee)});if(Z){var $=this.satisfies(S[Z]);if($!==void 0)return $}var z=h.default.find(M,function(ee){return R.isPlatform(ee)});if(z){var q=this.satisfies(S[z]);if(q!==void 0)return q}}if(E>0){var X=Object.keys(x),K=h.default.find(X,function(ee){return R.isBrowser(ee,!0)});if(K!==void 0)return this.compareVersion(x[K])}},w.isBrowser=function(C,R){R===void 0&&(R=!1);var S=this.getBrowserName().toLowerCase(),b=C.toLowerCase(),x=h.default.getBrowserTypeByAlias(b);return R&&x&&(b=x.toLowerCase()),b===S},w.compareVersion=function(C){var R=[0],S=C,b=!1,x=this.getBrowserVersion();if(typeof x=="string")return C[0]===">"||C[0]==="<"?(S=C.substr(1),C[1]==="="?(b=!0,S=C.substr(2)):R=[],C[0]===">"?R.push(1):R.push(-1)):C[0]==="="?S=C.substr(1):C[0]==="~"&&(b=!0,S=C.substr(1)),R.indexOf(h.default.compareVersions(x,S,b))>-1},w.isOS=function(C){return this.getOSName(!0)===String(C).toLowerCase()},w.isPlatform=function(C){return this.getPlatformType(!0)===String(C).toLowerCase()},w.isEngine=function(C){return this.getEngineName(!0)===String(C).toLowerCase()},w.is=function(C,R){return R===void 0&&(R=!1),this.isBrowser(C,R)||this.isOS(C)||this.isPlatform(C)},w.some=function(C){var R=this;return C===void 0&&(C=[]),C.some(function(S){return R.is(S)})},_}();r.default=f,n.exports=r.default},92:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=/version\/(\d+(\.?_?\d+)+)/i,p=[{test:[/googlebot/i],describe:function(h){var v={name:"Googlebot"},f=o.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/opera/i],describe:function(h){var v={name:"Opera"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/opr\/|opios/i],describe:function(h){var v={name:"Opera"},f=o.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/SamsungBrowser/i],describe:function(h){var v={name:"Samsung Internet for Android"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/Whale/i],describe:function(h){var v={name:"NAVER Whale Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/MZBrowser/i],describe:function(h){var v={name:"MZ Browser"},f=o.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/focus/i],describe:function(h){var v={name:"Focus"},f=o.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/swing/i],describe:function(h){var v={name:"Swing"},f=o.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/coast/i],describe:function(h){var v={name:"Opera Coast"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(h){var v={name:"Opera Touch"},f=o.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/yabrowser/i],describe:function(h){var v={name:"Yandex Browser"},f=o.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/ucbrowser/i],describe:function(h){var v={name:"UC Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/Maxthon|mxios/i],describe:function(h){var v={name:"Maxthon"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/epiphany/i],describe:function(h){var v={name:"Epiphany"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/puffin/i],describe:function(h){var v={name:"Puffin"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/sleipnir/i],describe:function(h){var v={name:"Sleipnir"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/k-meleon/i],describe:function(h){var v={name:"K-Meleon"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/micromessenger/i],describe:function(h){var v={name:"WeChat"},f=o.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/qqbrowser/i],describe:function(h){var v={name:/qqbrowserlite/i.test(h)?"QQ Browser Lite":"QQ Browser"},f=o.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/msie|trident/i],describe:function(h){var v={name:"Internet Explorer"},f=o.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/\sedg\//i],describe:function(h){var v={name:"Microsoft Edge"},f=o.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/edg([ea]|ios)/i],describe:function(h){var v={name:"Microsoft Edge"},f=o.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/vivaldi/i],describe:function(h){var v={name:"Vivaldi"},f=o.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/seamonkey/i],describe:function(h){var v={name:"SeaMonkey"},f=o.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/sailfish/i],describe:function(h){var v={name:"Sailfish"},f=o.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,h);return f&&(v.version=f),v}},{test:[/silk/i],describe:function(h){var v={name:"Amazon Silk"},f=o.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/phantom/i],describe:function(h){var v={name:"PhantomJS"},f=o.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/slimerjs/i],describe:function(h){var v={name:"SlimerJS"},f=o.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(h){var v={name:"BlackBerry"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/(web|hpw)[o0]s/i],describe:function(h){var v={name:"WebOS Browser"},f=o.default.getFirstMatch(u,h)||o.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/bada/i],describe:function(h){var v={name:"Bada"},f=o.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/tizen/i],describe:function(h){var v={name:"Tizen"},f=o.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/qupzilla/i],describe:function(h){var v={name:"QupZilla"},f=o.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/firefox|iceweasel|fxios/i],describe:function(h){var v={name:"Firefox"},f=o.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/electron/i],describe:function(h){var v={name:"Electron"},f=o.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/MiuiBrowser/i],describe:function(h){var v={name:"Miui"},f=o.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/chromium/i],describe:function(h){var v={name:"Chromium"},f=o.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,h)||o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/chrome|crios|crmo/i],describe:function(h){var v={name:"Chrome"},f=o.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/GSA/i],describe:function(h){var v={name:"Google Search"},f=o.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:function(h){var v=!h.test(/like android/i),f=h.test(/android/i);return v&&f},describe:function(h){var v={name:"Android Browser"},f=o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/playstation 4/i],describe:function(h){var v={name:"PlayStation 4"},f=o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/safari|applewebkit/i],describe:function(h){var v={name:"Safari"},f=o.default.getFirstMatch(u,h);return f&&(v.version=f),v}},{test:[/.*/i],describe:function(h){var v=h.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:o.default.getFirstMatch(v,h),version:o.default.getSecondMatch(v,h)}}}];r.default=p,n.exports=r.default},93:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:[/Roku\/DVP/],describe:function(h){var v=o.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,h);return{name:u.OS_MAP.Roku,version:v}}},{test:[/windows phone/i],describe:function(h){var v=o.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.WindowsPhone,version:v}}},{test:[/windows /i],describe:function(h){var v=o.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,h),f=o.default.getWindowsVersionName(v);return{name:u.OS_MAP.Windows,version:v,versionName:f}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(h){var v={name:u.OS_MAP.iOS},f=o.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,h);return f&&(v.version=f),v}},{test:[/macintosh/i],describe:function(h){var v=o.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,h).replace(/[_\s]/g,"."),f=o.default.getMacOSVersionName(v),_={name:u.OS_MAP.MacOS,version:v};return f&&(_.versionName=f),_}},{test:[/(ipod|iphone|ipad)/i],describe:function(h){var v=o.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,h).replace(/[_\s]/g,".");return{name:u.OS_MAP.iOS,version:v}}},{test:function(h){var v=!h.test(/like android/i),f=h.test(/android/i);return v&&f},describe:function(h){var v=o.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,h),f=o.default.getAndroidVersionName(v),_={name:u.OS_MAP.Android,version:v};return f&&(_.versionName=f),_}},{test:[/(web|hpw)[o0]s/i],describe:function(h){var v=o.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,h),f={name:u.OS_MAP.WebOS};return v&&v.length&&(f.version=v),f}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(h){var v=o.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,h)||o.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,h)||o.default.getFirstMatch(/\bbb(\d+)/i,h);return{name:u.OS_MAP.BlackBerry,version:v}}},{test:[/bada/i],describe:function(h){var v=o.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.Bada,version:v}}},{test:[/tizen/i],describe:function(h){var v=o.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.Tizen,version:v}}},{test:[/linux/i],describe:function(){return{name:u.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:u.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(h){var v=o.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,h);return{name:u.OS_MAP.PlayStation4,version:v}}}];r.default=p,n.exports=r.default},94:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(h){var v=o.default.getFirstMatch(/(can-l01)/i,h)&&"Nova",f={type:u.PLATFORMS_MAP.mobile,vendor:"Huawei"};return v&&(f.model=v),f}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet}}},{test:function(h){var v=h.test(/ipod|iphone/i),f=h.test(/like (ipod|iphone)/i);return v&&!f},describe:function(h){var v=o.default.getFirstMatch(/(ipod|iphone)/i,h);return{type:u.PLATFORMS_MAP.mobile,vendor:"Apple",model:v}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getBrowserName(!0)==="blackberry"},describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(h){return h.getBrowserName(!0)==="bada"},describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getBrowserName()==="windows phone"},describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(h){var v=Number(String(h.getOSVersion()).split(".")[0]);return h.getOSName(!0)==="android"&&v>=3},describe:function(){return{type:u.PLATFORMS_MAP.tablet}}},{test:function(h){return h.getOSName(!0)==="android"},describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(h){return h.getOSName(!0)==="macos"},describe:function(){return{type:u.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(h){return h.getOSName(!0)==="windows"},describe:function(){return{type:u.PLATFORMS_MAP.desktop}}},{test:function(h){return h.getOSName(!0)==="linux"},describe:function(){return{type:u.PLATFORMS_MAP.desktop}}},{test:function(h){return h.getOSName(!0)==="playstation 4"},describe:function(){return{type:u.PLATFORMS_MAP.tv}}},{test:function(h){return h.getOSName(!0)==="roku"},describe:function(){return{type:u.PLATFORMS_MAP.tv}}}];r.default=p,n.exports=r.default},95:function(n,r,i){r.__esModule=!0,r.default=void 0;var a,o=(a=i(17))&&a.__esModule?a:{default:a},u=i(18),p=[{test:function(h){return h.getBrowserName(!0)==="microsoft edge"},describe:function(h){if(/\sedg\//i.test(h))return{name:u.ENGINE_MAP.Blink};var v=o.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,h);return{name:u.ENGINE_MAP.EdgeHTML,version:v}}},{test:[/trident/i],describe:function(h){var v={name:u.ENGINE_MAP.Trident},f=o.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:function(h){return h.test(/presto/i)},describe:function(h){var v={name:u.ENGINE_MAP.Presto},f=o.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:function(h){var v=h.test(/gecko/i),f=h.test(/like gecko/i);return v&&!f},describe:function(h){var v={name:u.ENGINE_MAP.Gecko},f=o.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:u.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(h){var v={name:u.ENGINE_MAP.WebKit},f=o.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,h);return f&&(v.version=f),v}}];r.default=p,n.exports=r.default}})})}}),Vm=Ee({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/grammar.js"(e,t){Y();var n=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(r){return r.encoding?"rtpmap:%d %s/%s/%s":r.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(r){return r.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(r){return r.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(r){return"extmap:%d"+(r.direction?"/%s":"%v")+(r["encrypt-uri"]?" %s":"%v")+" %s"+(r.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(r){return r.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(r){var i="candidate:%s %d %s %d %s %d typ %s";return i+=r.raddr!=null?" raddr %s rport %d":"%v%v",i+=r.tcptype!=null?" tcptype %s":"%v",r.generation!=null&&(i+=" generation %d"),i+=r["network-id"]!=null?" network-id %d":"%v",i+=r["network-cost"]!=null?" network-cost %d":"%v",i}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(r){var i="ssrc:%d";return r.attribute!=null&&(i+=" %s",r.value!=null&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(r){return r.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(r){return r.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(r){return"imageattr:%s %s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(r){return"simulcast:%s %s"+(r.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(r){return"ts-refclk:%s"+(r.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(r){var i="mediaclk:";return i+=r.id!=null?"id=%s %s":"%v%s",i+=r.mediaClockValue!=null?"=%s":"",i+=r.rateNumerator!=null?" rate=%s":"",i+=r.rateDenominator!=null?"/%s":"",i}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(r){var i=n[r];i.forEach(function(a){a.reg||(a.reg=/(.*)/),a.format||(a.format="%s")})})}}),Jw=Ee({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/parser.js"(e){Y();var t=function(u){return String(Number(u))===u?Number(u):u},n=function(u,p,h,v){if(v&&!h)p[v]=t(u[1]);else for(var f=0;f<h.length;f+=1)u[f+1]!=null&&(p[h[f]]=t(u[f+1]))},r=function(u,p,h){var v=u.name&&u.names;u.push&&!p[u.push]?p[u.push]=[]:v&&!p[u.name]&&(p[u.name]={});var f=u.push?{}:v?p[u.name]:p;n(h.match(u.reg),f,u.names,u.name),u.push&&p[u.push].push(f)},i=Vm(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(u){var p={},h=[],v=p;return u.split(/(\r\n|\r|\n)/).filter(a).forEach(function(f){var _=f[0],w=f.slice(2);_==="m"&&(h.push({rtp:[],fmtp:[]}),v=h[h.length-1]);for(var C=0;C<(i[_]||[]).length;C+=1){var R=i[_][C];if(R.reg.test(w))return r(R,v,w)}}),p.media=h,p};var o=function(u,p){var h=p.split(/=(.+)/,2);return h.length===2?u[h[0]]=t(h[1]):h.length===1&&p.length>1&&(u[h[0]]=void 0),u};e.parseParams=function(u){return u.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(u){return u.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(u){for(var p=[],h=u.split(" ").map(t),v=0;v<h.length;v+=3)p.push({component:h[v],ip:h[v+1],port:h[v+2]});return p},e.parseImageAttributes=function(u){return u.split(" ").map(function(p){return p.substring(1,p.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(u){return u.split(";").map(function(p){return p.split(",").map(function(h){var v,f=!1;return h[0]!=="~"?v=t(h):(v=t(h.substring(1,h.length)),f=!0),{scid:v,paused:f}})})}}}),Zw=Ee({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/writer.js"(e,t){Y();var n=Vm(),r=/%[sdv%]/g,i=function(p){var h=1,v=arguments,f=v.length;return p.replace(r,function(_){if(h>=f)return _;var w=v[h];switch(h+=1,_){case"%%":return"%";case"%s":return String(w);case"%d":return Number(w);case"%v":return""}})},a=function(p,h,v){var f=h.format instanceof Function?h.format(h.push?v:v[h.name]):h.format,_=[p+"="+f];if(h.names)for(var w=0;w<h.names.length;w+=1){var C=h.names[w];h.name?_.push(v[h.name][C]):_.push(v[h.names[w]])}else _.push(v[h.name]);return i.apply(null,_)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],u=["i","c","b","a"];t.exports=function(p,h){h=h||{},p.version==null&&(p.version=0),p.name==null&&(p.name=" "),p.media.forEach(function(w){w.payloads==null&&(w.payloads="")});var v=h.outerOrder||o,f=h.innerOrder||u,_=[];return v.forEach(function(w){n[w].forEach(function(C){C.name in p&&p[C.name]!=null?_.push(a(w,C,p)):C.push in p&&p[C.push]!=null&&p[C.push].forEach(function(R){_.push(a(w,C,R))})})}),p.media.forEach(function(w){_.push(a("m",n.m[0],w)),f.forEach(function(C){n[C].forEach(function(R){R.name in w&&w[R.name]!=null?_.push(a(C,R,w)):R.push in w&&w[R.push]!=null&&w[R.push].forEach(function(S){_.push(a(C,R,S))})})})}),_.join(`\r
`)+`\r
`}}}),Fi=Ee({"../../node_modules/.pnpm/sdp-transform@2.15.0/node_modules/sdp-transform/lib/index.js"(e){Y();var t=Jw(),n=Zw(),r=Vm();e.grammar=r,e.write=n,e.parse=t.parse,e.parseParams=t.parseParams,e.parseFmtpConfig=t.parseFmtpConfig,e.parsePayloads=t.parsePayloads,e.parseRemoteCandidates=t.parseRemoteCandidates,e.parseImageAttributes=t.parseImageAttributes,e.parseSimulcastStreamList=t.parseSimulcastStreamList}}),Ly=Ee({"../../node_modules/.pnpm/ua-parser-js@1.0.40/node_modules/ua-parser-js/src/ua-parser.js"(e,t){Y(),function(n,r){var i="1.0.40",a="",o="?",u="function",p="undefined",h="object",v="string",f="major",_="model",w="name",C="type",R="vendor",S="version",b="architecture",x="console",E="mobile",M="tablet",Z="smarttv",$="wearable",z="embedded",q=500,X="Amazon",K="Apple",ee="ASUS",oe="BlackBerry",ce="Browser",ne="Chrome",Te="Edge",ye="Firefox",ue="Google",me="Huawei",_e="LG",ke="Microsoft",le="Motorola",Re="Opera",We="Samsung",Xe="Sharp",Ke="Sony",Le="Xiaomi",qe="Zebra",rt="Facebook",ot="Chromium OS",wt="Mac OS",Pn=" Browser",Xi=function(_t,Ft){var at={};for(var Kt in _t)Ft[Kt]&&Ft[Kt].length%2===0?at[Kt]=Ft[Kt].concat(_t[Kt]):at[Kt]=_t[Kt];return at},kn=function(_t){for(var Ft={},at=0;at<_t.length;at++)Ft[_t[at].toUpperCase()]=_t[at];return Ft},dr=function(_t,Ft){return typeof _t===v?Nn(Ft).indexOf(Nn(_t))!==-1:!1},Nn=function(_t){return _t.toLowerCase()},Qr=function(_t){return typeof _t===v?_t.replace(/[^\d\.]/g,a).split(".")[0]:r},di=function(_t,Ft){if(typeof _t===v)return _t=_t.replace(/^\s\s*/,a),typeof Ft===p?_t:_t.substring(0,q)},zn=function(_t,Ft){for(var at=0,Kt,Er,hr,Ht,dt,Bn;at<Ft.length&&!dt;){var Es=Ft[at],hn=Ft[at+1];for(Kt=Er=0;Kt<Es.length&&!dt&&Es[Kt];)if(dt=Es[Kt++].exec(_t),dt)for(hr=0;hr<hn.length;hr++)Bn=dt[++Er],Ht=hn[hr],typeof Ht===h&&Ht.length>0?Ht.length===2?typeof Ht[1]==u?this[Ht[0]]=Ht[1].call(this,Bn):this[Ht[0]]=Ht[1]:Ht.length===3?typeof Ht[1]===u&&!(Ht[1].exec&&Ht[1].test)?this[Ht[0]]=Bn?Ht[1].call(this,Bn,Ht[2]):r:this[Ht[0]]=Bn?Bn.replace(Ht[1],Ht[2]):r:Ht.length===4&&(this[Ht[0]]=Bn?Ht[3].call(this,Bn.replace(Ht[1],Ht[2])):r):this[Ht]=Bn||r;at+=2}},Hr=function(_t,Ft){for(var at in Ft)if(typeof Ft[at]===h&&Ft[at].length>0){for(var Kt=0;Kt<Ft[at].length;Kt++)if(dr(Ft[at][Kt],_t))return at===o?r:at}else if(dr(Ft[at],_t))return at===o?r:at;return Ft.hasOwnProperty("*")?Ft["*"]:_t},Cs={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},Kn={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},la={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[S,[w,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[S,[w,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[w,S],[/opios[\/ ]+([\w\.]+)/i],[S,[w,Re+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[S,[w,Re+" GX"]],[/\bopr\/([\w\.]+)/i],[S,[w,Re]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[S,[w,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[S,[w,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[w,S],[/quark(?:pc)?\/([-\w\.]+)/i],[S,[w,"Quark"]],[/\bddg\/([\w\.]+)/i],[S,[w,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[S,[w,"UC"+ce]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[S,[w,"WeChat"]],[/konqueror\/([\w\.]+)/i],[S,[w,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[S,[w,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[S,[w,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[S,[w,"Smart Lenovo "+ce]],[/(avast|avg)\/([\w\.]+)/i],[[w,/(.+)/,"$1 Secure "+ce],S],[/\bfocus\/([\w\.]+)/i],[S,[w,ye+" Focus"]],[/\bopt\/([\w\.]+)/i],[S,[w,Re+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[S,[w,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[S,[w,"Dolphin"]],[/coast\/([\w\.]+)/i],[S,[w,Re+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[S,[w,"MIUI"+Pn]],[/fxios\/([\w\.-]+)/i],[S,[w,ye]],[/\bqihoobrowser\/?([\w\.]*)/i],[S,[w,"360"]],[/\b(qq)\/([\w\.]+)/i],[[w,/(.+)/,"$1Browser"],S],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[w,/(.+)/,"$1"+Pn],S],[/samsungbrowser\/([\w\.]+)/i],[S,[w,We+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[S,[w,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[w,"Sogou Mobile"],S],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[w,S],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[w],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[S,w],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[w,rt],S],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[w,S],[/\bgsa\/([\w\.]+) .*safari\//i],[S,[w,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[S,[w,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[S,[w,ne+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[w,ne+" WebView"],S],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[S,[w,"Android "+ce]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[w,S],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[S,[w,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[S,w],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[w,[S,Hr,Cs]],[/(webkit|khtml)\/([\w\.]+)/i],[w,S],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[w,"Netscape"],S],[/(wolvic|librewolf)\/([\w\.]+)/i],[w,S],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[S,[w,ye+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[w,[S,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[w,[S,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[b,"amd64"]],[/(ia32(?=;))/i],[[b,Nn]],[/((?:i[346]|x)86)[;\)]/i],[[b,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[b,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[b,"armhf"]],[/windows (ce|mobile); ppc;/i],[[b,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[b,/ower/,a,Nn]],[/(sun4\w)[;\)]/i],[[b,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[b,Nn]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[_,[R,We],[C,M]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[_,[R,We],[C,E]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[_,[R,K],[C,E]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[_,[R,K],[C,M]],[/(macintosh);/i],[_,[R,K]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[_,[R,Xe],[C,E]],[/(?:honor)([-\w ]+)[;\)]/i],[_,[R,"Honor"],[C,E]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[_,[R,me],[C,M]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[_,[R,me],[C,E]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[_,/_/g," "],[R,Le],[C,E]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[_,/_/g," "],[R,Le],[C,M]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[_,[R,"OPPO"],[C,E]],[/\b(opd2\d{3}a?) bui/i],[_,[R,"OPPO"],[C,M]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[_,[R,"Vivo"],[C,E]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[_,[R,"Realme"],[C,E]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[_,[R,le],[C,E]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[_,[R,le],[C,M]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[_,[R,_e],[C,M]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[_,[R,_e],[C,E]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[_,[R,"Lenovo"],[C,M]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[_,/_/g," "],[R,"Nokia"],[C,E]],[/(pixel c)\b/i],[_,[R,ue],[C,M]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[_,[R,ue],[C,E]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_,[R,Ke],[C,E]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[_,"Xperia Tablet"],[R,Ke],[C,M]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[_,[R,"OnePlus"],[C,E]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[_,[R,X],[C,M]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[_,/(.+)/g,"Fire Phone $1"],[R,X],[C,E]],[/(playbook);[-\w\),; ]+(rim)/i],[_,R,[C,M]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[_,[R,oe],[C,E]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[_,[R,ee],[C,M]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[_,[R,ee],[C,E]],[/(nexus 9)/i],[_,[R,"HTC"],[C,M]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[R,[_,/_/g," "],[C,E]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[_,[R,"TCL"],[C,M]],[/(itel) ((\w+))/i],[[R,Nn],_,[C,Hr,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[_,[R,"Acer"],[C,M]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[_,[R,"Meizu"],[C,E]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[_,[R,"Ulefone"],[C,E]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[_,[R,"Energizer"],[C,E]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[_,[R,"Cat"],[C,E]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[_,[R,"Smartfren"],[C,E]],[/droid.+; (a(?:015|06[35]|142p?))/i],[_,[R,"Nothing"],[C,E]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[R,_,[C,E]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[R,_,[C,M]],[/(surface duo)/i],[_,[R,ke],[C,M]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[_,[R,"Fairphone"],[C,E]],[/(u304aa)/i],[_,[R,"AT&T"],[C,E]],[/\bsie-(\w*)/i],[_,[R,"Siemens"],[C,E]],[/\b(rct\w+) b/i],[_,[R,"RCA"],[C,M]],[/\b(venue[\d ]{2,7}) b/i],[_,[R,"Dell"],[C,M]],[/\b(q(?:mv|ta)\w+) b/i],[_,[R,"Verizon"],[C,M]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[_,[R,"Barnes & Noble"],[C,M]],[/\b(tm\d{3}\w+) b/i],[_,[R,"NuVision"],[C,M]],[/\b(k88) b/i],[_,[R,"ZTE"],[C,M]],[/\b(nx\d{3}j) b/i],[_,[R,"ZTE"],[C,E]],[/\b(gen\d{3}) b.+49h/i],[_,[R,"Swiss"],[C,E]],[/\b(zur\d{3}) b/i],[_,[R,"Swiss"],[C,M]],[/\b((zeki)?tb.*\b) b/i],[_,[R,"Zeki"],[C,M]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[R,"Dragon Touch"],_,[C,M]],[/\b(ns-?\w{0,9}) b/i],[_,[R,"Insignia"],[C,M]],[/\b((nxa|next)-?\w{0,9}) b/i],[_,[R,"NextBook"],[C,M]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[R,"Voice"],_,[C,E]],[/\b(lvtel\-)?(v1[12]) b/i],[[R,"LvTel"],_,[C,E]],[/\b(ph-1) /i],[_,[R,"Essential"],[C,E]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[_,[R,"Envizen"],[C,M]],[/\b(trio[-\w\. ]+) b/i],[_,[R,"MachSpeed"],[C,M]],[/\btu_(1491) b/i],[_,[R,"Rotor"],[C,M]],[/(shield[\w ]+) b/i],[_,[R,"Nvidia"],[C,M]],[/(sprint) (\w+)/i],[R,_,[C,E]],[/(kin\.[onetw]{3})/i],[[_,/\./g," "],[R,ke],[C,E]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[_,[R,qe],[C,M]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[_,[R,qe],[C,E]],[/smart-tv.+(samsung)/i],[R,[C,Z]],[/hbbtv.+maple;(\d+)/i],[[_,/^/,"SmartTV"],[R,We],[C,Z]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[R,_e],[C,Z]],[/(apple) ?tv/i],[R,[_,K+" TV"],[C,Z]],[/crkey/i],[[_,ne+"cast"],[R,ue],[C,Z]],[/droid.+aft(\w+)( bui|\))/i],[_,[R,X],[C,Z]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[_,[R,Xe],[C,Z]],[/(bravia[\w ]+)( bui|\))/i],[_,[R,Ke],[C,Z]],[/(mitv-\w{5}) bui/i],[_,[R,Le],[C,Z]],[/Hbbtv.*(technisat) (.*);/i],[R,_,[C,Z]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[R,di],[_,di],[C,Z]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[C,Z]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[R,_,[C,x]],[/droid.+; (shield) bui/i],[_,[R,"Nvidia"],[C,x]],[/(playstation [345portablevi]+)/i],[_,[R,Ke],[C,x]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[_,[R,ke],[C,x]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[_,[R,We],[C,$]],[/((pebble))app/i],[R,_,[C,$]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[_,[R,K],[C,$]],[/droid.+; (glass) \d/i],[_,[R,ue],[C,$]],[/droid.+; (wt63?0{2,3})\)/i],[_,[R,qe],[C,$]],[/droid.+; (glass) \d/i],[_,[R,ue],[C,$]],[/(pico) (4|neo3(?: link|pro)?)/i],[R,_,[C,$]],[/; (quest( \d| pro)?)/i],[_,[R,rt],[C,$]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[R,[C,z]],[/(aeobc)\b/i],[_,[R,X],[C,z]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[_,[C,E]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[_,[C,M]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[C,M]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[C,E]],[/(android[-\w\. ]{0,9});.+buil/i],[_,[R,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[S,[w,Te+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[w,S],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[S,[w,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[w,S],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[S,w]],os:[[/microsoft (windows) (vista|xp)/i],[w,S],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[w,[S,Hr,Kn]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[S,Hr,Kn],[w,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[S,/_/g,"."],[w,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[w,wt],[S,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[S,w],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[w,S],[/\(bb(10);/i],[S,[w,oe]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[S,[w,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[S,[w,ye+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[S,[w,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[S,[w,"watchOS"]],[/crkey\/([\d\.]+)/i],[S,[w,ne+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[w,ot],S],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[w,S],[/(sunos) ?([\w\.\d]*)/i],[[w,"Solaris"],S],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[w,S]]},jn=function(_t,Ft){if(typeof _t===h&&(Ft=_t,_t=r),!(this instanceof jn))return new jn(_t,Ft).getResult();var at=typeof n!==p&&n.navigator?n.navigator:r,Kt=_t||(at&&at.userAgent?at.userAgent:a),Er=at&&at.userAgentData?at.userAgentData:r,hr=Ft?Xi(la,Ft):la,Ht=at&&at.userAgent==Kt;return this.getBrowser=function(){var dt={};return dt[w]=r,dt[S]=r,zn.call(dt,Kt,hr.browser),dt[f]=Qr(dt[S]),Ht&&at&&at.brave&&typeof at.brave.isBrave==u&&(dt[w]="Brave"),dt},this.getCPU=function(){var dt={};return dt[b]=r,zn.call(dt,Kt,hr.cpu),dt},this.getDevice=function(){var dt={};return dt[R]=r,dt[_]=r,dt[C]=r,zn.call(dt,Kt,hr.device),Ht&&!dt[C]&&Er&&Er.mobile&&(dt[C]=E),Ht&&dt[_]=="Macintosh"&&at&&typeof at.standalone!==p&&at.maxTouchPoints&&at.maxTouchPoints>2&&(dt[_]="iPad",dt[C]=M),dt},this.getEngine=function(){var dt={};return dt[w]=r,dt[S]=r,zn.call(dt,Kt,hr.engine),dt},this.getOS=function(){var dt={};return dt[w]=r,dt[S]=r,zn.call(dt,Kt,hr.os),Ht&&!dt[w]&&Er&&Er.platform&&Er.platform!="Unknown"&&(dt[w]=Er.platform.replace(/chrome os/i,ot).replace(/macos/i,wt)),dt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Kt},this.setUA=function(dt){return Kt=typeof dt===v&&dt.length>q?di(dt,q):dt,this},this.setUA(Kt),this};jn.VERSION=i,jn.BROWSER=kn([w,S,f]),jn.CPU=kn([b]),jn.DEVICE=kn([_,R,C,x,E,Z,M,$,z]),jn.ENGINE=jn.OS=kn([w,S]),typeof e!==p?(typeof t!==p&&t.exports&&(e=t.exports=jn),e.UAParser=jn):typeof define===u&&define.amd?define(function(){return jn}):typeof n!==p&&(n.UAParser=jn);var hi=typeof n!==p&&(n.jQuery||n.Zepto);if(hi&&!hi.ua){var Mi=new jn;hi.ua=Mi.getResult(),hi.ua.get=function(){return Mi.getUA()},hi.ua.set=function(_t){Mi.setUA(_t);var Ft=Mi.getResult();for(var at in Ft)hi.ua[at]=Ft[at]}}}(typeof window=="object"?window:e)}}),Qw=Ee({"../../node_modules/.pnpm/jsrsasign@11.1.0/node_modules/jsrsasign/lib/jsrsasign.js"(e){Y();var t={};t.userAgent=!1;var n={},r="11.1.0",i="jsrsasign(all) 11.1.0 (2024-02-01) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license",a=a||function(s,c){var l={},d=l.lib={},g=d.Base=function(){function P(){}return{extend:function(D){P.prototype=this;var A=new P;return D&&A.mixIn(D),A.hasOwnProperty("init")||(A.init=function(){A.$super.init.apply(this,arguments)}),A.init.prototype=A,A.$super=this,A},create:function(){var D=this.extend();return D.init.apply(D,arguments),D},init:function(){},mixIn:function(D){for(var A in D)D.hasOwnProperty(A)&&(this[A]=D[A]);D.hasOwnProperty("toString")&&(this.toString=D.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),m=d.WordArray=g.extend({init:function(P,D){P=this.words=P||[],D!=c?this.sigBytes=D:this.sigBytes=P.length*4},toString:function(P){return(P||k).stringify(this)},concat:function(P){var D=this.words,A=P.words,N=this.sigBytes,j=P.sigBytes;if(this.clamp(),N%4)for(var W=0;W<j;W++){var se=A[W>>>2]>>>24-W%4*8&255;D[N+W>>>2]|=se<<24-(N+W)%4*8}else for(var W=0;W<j;W+=4)D[N+W>>>2]=A[W>>>2];return this.sigBytes+=j,this},clamp:function(){var P=this.words,D=this.sigBytes;P[D>>>2]&=4294967295<<32-D%4*8,P.length=s.ceil(D/4)},clone:function(){var P=g.clone.call(this);return P.words=this.words.slice(0),P},random:function(P){for(var D=[],A=0;A<P;A+=4)D.push(s.random()*4294967296|0);return new m.init(D,P)}}),T=l.enc={},k=T.Hex={stringify:function(P){for(var D=P.words,A=P.sigBytes,N=[],j=0;j<A;j++){var W=D[j>>>2]>>>24-j%4*8&255;N.push((W>>>4).toString(16)),N.push((W&15).toString(16))}return N.join("")},parse:function(P){for(var D=P.length,A=[],N=0;N<D;N+=2)A[N>>>3]|=parseInt(P.substr(N,2),16)<<24-N%8*4;return new m.init(A,D/2)}},O=T.Latin1={stringify:function(P){for(var D=P.words,A=P.sigBytes,N=[],j=0;j<A;j++){var W=D[j>>>2]>>>24-j%4*8&255;N.push(String.fromCharCode(W))}return N.join("")},parse:function(P){for(var D=P.length,A=[],N=0;N<D;N++)A[N>>>2]|=(P.charCodeAt(N)&255)<<24-N%4*8;return new m.init(A,D)}},F=T.Utf8={stringify:function(P){try{return decodeURIComponent(escape(O.stringify(P)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(P){return O.parse(unescape(encodeURIComponent(P)))}},U=d.BufferedBlockAlgorithm=g.extend({reset:function(){this._data=new m.init,this._nDataBytes=0},_append:function(P){typeof P=="string"&&(P=F.parse(P)),this._data.concat(P),this._nDataBytes+=P.sigBytes},_process:function(P){var D=this._data,A=D.words,N=D.sigBytes,j=this.blockSize,W=j*4,se=N/W;P?se=s.ceil(se):se=s.max((se|0)-this._minBufferSize,0);var he=se*j,de=s.min(he*4,N);if(he){for(var fe=0;fe<he;fe+=j)this._doProcessBlock(A,fe);var G=A.splice(0,he);D.sigBytes-=de}return new m.init(G,de)},clone:function(){var P=g.clone.call(this);return P._data=this._data.clone(),P},_minBufferSize:0});d.Hasher=U.extend({cfg:g.extend(),init:function(P){this.cfg=this.cfg.extend(P),this.reset()},reset:function(){U.reset.call(this),this._doReset()},update:function(P){return this._append(P),this._process(),this},finalize:function(P){P&&this._append(P);var D=this._doFinalize();return D},blockSize:512/32,_createHelper:function(P){return function(D,A){return new P.init(A).finalize(D)}},_createHmacHelper:function(P){return function(D,A){return new L.HMAC.init(P,A).finalize(D)}}});var L=l.algo={};return l}(Math);(function(s){var g=a,c=g.lib,l=c.Base,d=c.WordArray,g=g.x64={};g.Word=l.extend({init:function(m,T){this.high=m,this.low=T}}),g.WordArray=l.extend({init:function(m,T){m=this.words=m||[],this.sigBytes=T!=s?T:8*m.length},toX32:function(){for(var m=this.words,T=m.length,k=[],O=0;O<T;O++){var F=m[O];k.push(F.high),k.push(F.low)}return d.create(k,this.sigBytes)},clone:function(){for(var m=l.clone.call(this),T=m.words=this.words.slice(0),k=T.length,O=0;O<k;O++)T[O]=T[O].clone();return m}})})(),a.lib.Cipher||function(s){var D=a,c=D.lib,l=c.Base,d=c.WordArray,g=c.BufferedBlockAlgorithm,m=D.enc.Base64,T=D.algo.EvpKDF,k=c.Cipher=g.extend({cfg:l.extend(),createEncryptor:function(N,j){return this.create(this._ENC_XFORM_MODE,N,j)},createDecryptor:function(N,j){return this.create(this._DEC_XFORM_MODE,N,j)},init:function(N,j,W){this.cfg=this.cfg.extend(W),this._xformMode=N,this._key=j,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(N){return this._append(N),this._process()},finalize:function(N){return N&&this._append(N),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(N){return{encrypt:function(j,W,se){return(typeof W=="string"?A:P).encrypt(N,j,W,se)},decrypt:function(j,W,se){return(typeof W=="string"?A:P).decrypt(N,j,W,se)}}}});c.StreamCipher=k.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var L=D.mode={},O=function(N,j,W){var se=this._iv;se?this._iv=s:se=this._prevBlock;for(var he=0;he<W;he++)N[j+he]^=se[he]},F=(c.BlockCipherMode=l.extend({createEncryptor:function(N,j){return this.Encryptor.create(N,j)},createDecryptor:function(N,j){return this.Decryptor.create(N,j)},init:function(N,j){this._cipher=N,this._iv=j}})).extend();F.Encryptor=F.extend({processBlock:function(N,j){var W=this._cipher,se=W.blockSize;O.call(this,N,j,se),W.encryptBlock(N,j),this._prevBlock=N.slice(j,j+se)}}),F.Decryptor=F.extend({processBlock:function(N,j){var W=this._cipher,se=W.blockSize,he=N.slice(j,j+se);W.decryptBlock(N,j),O.call(this,N,j,se),this._prevBlock=he}}),L=L.CBC=F,F=(D.pad={}).Pkcs7={pad:function(N,j){for(var W=4*j,W=W-N.sigBytes%W,se=W<<24|W<<16|W<<8|W,he=[],de=0;de<W;de+=4)he.push(se);W=d.create(he,W),N.concat(W)},unpad:function(N){N.sigBytes-=N.words[N.sigBytes-1>>>2]&255}},c.BlockCipher=k.extend({cfg:k.cfg.extend({mode:L,padding:F}),reset:function(){k.reset.call(this);var j=this.cfg,N=j.iv,j=j.mode;if(this._xformMode==this._ENC_XFORM_MODE)var W=j.createEncryptor;else W=j.createDecryptor,this._minBufferSize=1;this._mode=W.call(j,this,N&&N.words)},_doProcessBlock:function(N,j){this._mode.processBlock(N,j)},_doFinalize:function(){var N=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){N.pad(this._data,this.blockSize);var j=this._process(!0)}else j=this._process(!0),N.unpad(j);return j},blockSize:4});var U=c.CipherParams=l.extend({init:function(N){this.mixIn(N)},toString:function(N){return(N||this.formatter).stringify(this)}}),L=(D.format={}).OpenSSL={stringify:function(N){var j=N.ciphertext;return N=N.salt,(N?d.create([1398893684,1701076831]).concat(N).concat(j):j).toString(m)},parse:function(N){N=m.parse(N);var j=N.words;if(j[0]==1398893684&&j[1]==1701076831){var W=d.create(j.slice(2,4));j.splice(0,4),N.sigBytes-=16}return U.create({ciphertext:N,salt:W})}},P=c.SerializableCipher=l.extend({cfg:l.extend({format:L}),encrypt:function(N,j,W,se){se=this.cfg.extend(se);var he=N.createEncryptor(W,se);return j=he.finalize(j),he=he.cfg,U.create({ciphertext:j,key:W,iv:he.iv,algorithm:N,mode:he.mode,padding:he.padding,blockSize:N.blockSize,formatter:se.format})},decrypt:function(N,j,W,se){return se=this.cfg.extend(se),j=this._parse(j,se.format),N.createDecryptor(W,se).finalize(j.ciphertext)},_parse:function(N,j){return typeof N=="string"?j.parse(N,this):N}}),D=(D.kdf={}).OpenSSL={execute:function(N,j,W,se){return se||(se=d.random(8)),N=T.create({keySize:j+W}).compute(N,se),W=d.create(N.words.slice(j),4*W),N.sigBytes=4*j,U.create({key:N,iv:W,salt:se})}},A=c.PasswordBasedCipher=P.extend({cfg:P.cfg.extend({kdf:D}),encrypt:function(N,j,W,se){return se=this.cfg.extend(se),W=se.kdf.execute(W,N.keySize,N.ivSize),se.iv=W.iv,N=P.encrypt.call(this,N,j,W.key,se),N.mixIn(W),N},decrypt:function(N,j,W,se){return se=this.cfg.extend(se),j=this._parse(j,se.format),W=se.kdf.execute(W,N.keySize,N.ivSize,j.salt),se.iv=W.iv,P.decrypt.call(this,N,j,W.key,se)}})}(),function(){for(var s=a,c=s.lib.BlockCipher,G=s.algo,l=[],d=[],g=[],m=[],T=[],k=[],O=[],F=[],U=[],L=[],P=[],D=0;256>D;D++)P[D]=128>D?D<<1:D<<1^283;for(var A=0,N=0,D=0;256>D;D++){var j=N^N<<1^N<<2^N<<3^N<<4,j=j>>>8^j&255^99;l[A]=j,d[j]=A;var W=P[A],se=P[W],he=P[se],de=257*P[j]^16843008*j;g[A]=de<<24|de>>>8,m[A]=de<<16|de>>>16,T[A]=de<<8|de>>>24,k[A]=de,de=16843009*he^65537*se^257*W^16843008*A,O[j]=de<<24|de>>>8,F[j]=de<<16|de>>>16,U[j]=de<<8|de>>>24,L[j]=de,A?(A=W^P[P[P[he^W]]],N^=P[P[N]]):A=N=1}var fe=[0,1,2,4,8,16,32,64,128,27,54],G=G.AES=c.extend({_doReset:function(){for(var J=this._key,Q=J.words,te=J.sigBytes/4,J=4*((this._nRounds=te+6)+1),re=this._keySchedule=[],pe=0;pe<J;pe++)if(pe<te)re[pe]=Q[pe];else{var be=re[pe-1];pe%te?6<te&&pe%te==4&&(be=l[be>>>24]<<24|l[be>>>16&255]<<16|l[be>>>8&255]<<8|l[be&255]):(be=be<<8|be>>>24,be=l[be>>>24]<<24|l[be>>>16&255]<<16|l[be>>>8&255]<<8|l[be&255],be^=fe[pe/te|0]<<24),re[pe]=re[pe-te]^be}for(Q=this._invKeySchedule=[],te=0;te<J;te++)pe=J-te,be=te%4?re[pe]:re[pe-4],Q[te]=4>te||4>=pe?be:O[l[be>>>24]]^F[l[be>>>16&255]]^U[l[be>>>8&255]]^L[l[be&255]]},encryptBlock:function(Q,te){this._doCryptBlock(Q,te,this._keySchedule,g,m,T,k,l)},decryptBlock:function(Q,te){var J=Q[te+1];Q[te+1]=Q[te+3],Q[te+3]=J,this._doCryptBlock(Q,te,this._invKeySchedule,O,F,U,L,d),J=Q[te+1],Q[te+1]=Q[te+3],Q[te+3]=J},_doCryptBlock:function(Q,te,J,re,pe,be,Fe,ve){for(var Ce=this._nRounds,Un=Q[te]^J[0],Jn=Q[te+1]^J[1],Hn=Q[te+2]^J[2],Rn=Q[te+3]^J[3],Ne=4,Me=1;Me<Ce;Me++)var rr=re[Un>>>24]^pe[Jn>>>16&255]^be[Hn>>>8&255]^Fe[Rn&255]^J[Ne++],pn=re[Jn>>>24]^pe[Hn>>>16&255]^be[Rn>>>8&255]^Fe[Un&255]^J[Ne++],tn=re[Hn>>>24]^pe[Rn>>>16&255]^be[Un>>>8&255]^Fe[Jn&255]^J[Ne++],Rn=re[Rn>>>24]^pe[Un>>>16&255]^be[Jn>>>8&255]^Fe[Hn&255]^J[Ne++],Un=rr,Jn=pn,Hn=tn;rr=(ve[Un>>>24]<<24|ve[Jn>>>16&255]<<16|ve[Hn>>>8&255]<<8|ve[Rn&255])^J[Ne++],pn=(ve[Jn>>>24]<<24|ve[Hn>>>16&255]<<16|ve[Rn>>>8&255]<<8|ve[Un&255])^J[Ne++],tn=(ve[Hn>>>24]<<24|ve[Rn>>>16&255]<<16|ve[Un>>>8&255]<<8|ve[Jn&255])^J[Ne++],Rn=(ve[Rn>>>24]<<24|ve[Un>>>16&255]<<16|ve[Jn>>>8&255]<<8|ve[Hn&255])^J[Ne++],Q[te]=rr,Q[te+1]=pn,Q[te+2]=tn,Q[te+3]=Rn},keySize:8});s.AES=c._createHelper(G)}(),function(){function s(P,D){var A=(this._lBlock>>>P^this._rBlock)&D;this._rBlock^=A,this._lBlock^=A<<P}function c(P,D){var A=(this._rBlock>>>P^this._lBlock)&D;this._lBlock^=A,this._rBlock^=A<<P}var l=a,g=l.lib,d=g.WordArray,g=g.BlockCipher,m=l.algo,T=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],k=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],O=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],F=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],U=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],L=m.DES=g.extend({_doReset:function(){for(var P=this._key.words,D=[],A=0;56>A;A++){var N=T[A]-1;D[A]=P[N>>>5]>>>31-N%32&1}for(P=this._subKeys=[],N=0;16>N;N++){for(var j=P[N]=[],W=O[N],A=0;24>A;A++)j[A/6|0]|=D[(k[A]-1+W)%28]<<31-A%6,j[4+(A/6|0)]|=D[28+(k[A+24]-1+W)%28]<<31-A%6;for(j[0]=j[0]<<1|j[0]>>>31,A=1;7>A;A++)j[A]>>>=4*(A-1)+3;j[7]=j[7]<<5|j[7]>>>27}for(D=this._invSubKeys=[],A=0;16>A;A++)D[A]=P[15-A]},encryptBlock:function(P,D){this._doCryptBlock(P,D,this._subKeys)},decryptBlock:function(P,D){this._doCryptBlock(P,D,this._invSubKeys)},_doCryptBlock:function(P,D,A){this._lBlock=P[D],this._rBlock=P[D+1],s.call(this,4,252645135),s.call(this,16,65535),c.call(this,2,858993459),c.call(this,8,16711935),s.call(this,1,1431655765);for(var N=0;16>N;N++){for(var j=A[N],W=this._lBlock,se=this._rBlock,he=0,de=0;8>de;de++)he|=F[de][((se^j[de])&U[de])>>>0];this._lBlock=se,this._rBlock=W^he}A=this._lBlock,this._lBlock=this._rBlock,this._rBlock=A,s.call(this,1,1431655765),c.call(this,8,16711935),c.call(this,2,858993459),s.call(this,16,65535),s.call(this,4,252645135),P[D]=this._lBlock,P[D+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});l.DES=g._createHelper(L),m=m.TripleDES=g.extend({_doReset:function(){var P=this._key.words;this._des1=L.createEncryptor(d.create(P.slice(0,2))),this._des2=L.createEncryptor(d.create(P.slice(2,4))),this._des3=L.createEncryptor(d.create(P.slice(4,6)))},encryptBlock:function(P,D){this._des1.encryptBlock(P,D),this._des2.decryptBlock(P,D),this._des3.encryptBlock(P,D)},decryptBlock:function(P,D){this._des3.decryptBlock(P,D),this._des2.encryptBlock(P,D),this._des1.decryptBlock(P,D)},keySize:6,ivSize:2,blockSize:2}),l.TripleDES=g._createHelper(m)}(),function(){var s=a,c=s.lib.WordArray;s.enc.Base64={stringify:function(l){var d=l.words,g=l.sigBytes,m=this._map;l.clamp(),l=[];for(var T=0;T<g;T+=3)for(var k=(d[T>>>2]>>>24-8*(T%4)&255)<<16|(d[T+1>>>2]>>>24-8*((T+1)%4)&255)<<8|d[T+2>>>2]>>>24-8*((T+2)%4)&255,O=0;4>O&&T+.75*O<g;O++)l.push(m.charAt(k>>>6*(3-O)&63));if(d=m.charAt(64))for(;l.length%4;)l.push(d);return l.join("")},parse:function(l){var d=l.length,g=this._map,m=g.charAt(64);m&&(m=l.indexOf(m),m!=-1&&(d=m));for(var m=[],T=0,k=0;k<d;k++)if(k%4){var O=g.indexOf(l.charAt(k-1))<<2*(k%4),F=g.indexOf(l.charAt(k))>>>6-2*(k%4);m[T>>>2]|=(O|F)<<24-8*(T%4),T++}return c.create(m,T)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(s){function c(L,P,D,A,N,j,W){return L=L+(P&D|~P&A)+N+W,(L<<j|L>>>32-j)+P}function l(L,P,D,A,N,j,W){return L=L+(P&A|D&~A)+N+W,(L<<j|L>>>32-j)+P}function d(L,P,D,A,N,j,W){return L=L+(P^D^A)+N+W,(L<<j|L>>>32-j)+P}function g(L,P,D,A,N,j,W){return L=L+(D^(P|~A))+N+W,(L<<j|L>>>32-j)+P}for(var m=a,O=m.lib,T=O.WordArray,k=O.Hasher,O=m.algo,F=[],U=0;64>U;U++)F[U]=4294967296*s.abs(s.sin(U+1))|0;O=O.MD5=k.extend({_doReset:function(){this._hash=new T.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(L,P){for(var D=0;16>D;D++){var A=P+D,N=L[A];L[A]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}var D=this._hash.words,A=L[P+0],N=L[P+1],j=L[P+2],W=L[P+3],se=L[P+4],he=L[P+5],de=L[P+6],fe=L[P+7],G=L[P+8],Q=L[P+9],te=L[P+10],J=L[P+11],re=L[P+12],pe=L[P+13],be=L[P+14],Fe=L[P+15],ve=D[0],Me=D[1],Ne=D[2],Ce=D[3],ve=c(ve,Me,Ne,Ce,A,7,F[0]),Ce=c(Ce,ve,Me,Ne,N,12,F[1]),Ne=c(Ne,Ce,ve,Me,j,17,F[2]),Me=c(Me,Ne,Ce,ve,W,22,F[3]),ve=c(ve,Me,Ne,Ce,se,7,F[4]),Ce=c(Ce,ve,Me,Ne,he,12,F[5]),Ne=c(Ne,Ce,ve,Me,de,17,F[6]),Me=c(Me,Ne,Ce,ve,fe,22,F[7]),ve=c(ve,Me,Ne,Ce,G,7,F[8]),Ce=c(Ce,ve,Me,Ne,Q,12,F[9]),Ne=c(Ne,Ce,ve,Me,te,17,F[10]),Me=c(Me,Ne,Ce,ve,J,22,F[11]),ve=c(ve,Me,Ne,Ce,re,7,F[12]),Ce=c(Ce,ve,Me,Ne,pe,12,F[13]),Ne=c(Ne,Ce,ve,Me,be,17,F[14]),Me=c(Me,Ne,Ce,ve,Fe,22,F[15]),ve=l(ve,Me,Ne,Ce,N,5,F[16]),Ce=l(Ce,ve,Me,Ne,de,9,F[17]),Ne=l(Ne,Ce,ve,Me,J,14,F[18]),Me=l(Me,Ne,Ce,ve,A,20,F[19]),ve=l(ve,Me,Ne,Ce,he,5,F[20]),Ce=l(Ce,ve,Me,Ne,te,9,F[21]),Ne=l(Ne,Ce,ve,Me,Fe,14,F[22]),Me=l(Me,Ne,Ce,ve,se,20,F[23]),ve=l(ve,Me,Ne,Ce,Q,5,F[24]),Ce=l(Ce,ve,Me,Ne,be,9,F[25]),Ne=l(Ne,Ce,ve,Me,W,14,F[26]),Me=l(Me,Ne,Ce,ve,G,20,F[27]),ve=l(ve,Me,Ne,Ce,pe,5,F[28]),Ce=l(Ce,ve,Me,Ne,j,9,F[29]),Ne=l(Ne,Ce,ve,Me,fe,14,F[30]),Me=l(Me,Ne,Ce,ve,re,20,F[31]),ve=d(ve,Me,Ne,Ce,he,4,F[32]),Ce=d(Ce,ve,Me,Ne,G,11,F[33]),Ne=d(Ne,Ce,ve,Me,J,16,F[34]),Me=d(Me,Ne,Ce,ve,be,23,F[35]),ve=d(ve,Me,Ne,Ce,N,4,F[36]),Ce=d(Ce,ve,Me,Ne,se,11,F[37]),Ne=d(Ne,Ce,ve,Me,fe,16,F[38]),Me=d(Me,Ne,Ce,ve,te,23,F[39]),ve=d(ve,Me,Ne,Ce,pe,4,F[40]),Ce=d(Ce,ve,Me,Ne,A,11,F[41]),Ne=d(Ne,Ce,ve,Me,W,16,F[42]),Me=d(Me,Ne,Ce,ve,de,23,F[43]),ve=d(ve,Me,Ne,Ce,Q,4,F[44]),Ce=d(Ce,ve,Me,Ne,re,11,F[45]),Ne=d(Ne,Ce,ve,Me,Fe,16,F[46]),Me=d(Me,Ne,Ce,ve,j,23,F[47]),ve=g(ve,Me,Ne,Ce,A,6,F[48]),Ce=g(Ce,ve,Me,Ne,fe,10,F[49]),Ne=g(Ne,Ce,ve,Me,be,15,F[50]),Me=g(Me,Ne,Ce,ve,he,21,F[51]),ve=g(ve,Me,Ne,Ce,re,6,F[52]),Ce=g(Ce,ve,Me,Ne,W,10,F[53]),Ne=g(Ne,Ce,ve,Me,te,15,F[54]),Me=g(Me,Ne,Ce,ve,N,21,F[55]),ve=g(ve,Me,Ne,Ce,G,6,F[56]),Ce=g(Ce,ve,Me,Ne,Fe,10,F[57]),Ne=g(Ne,Ce,ve,Me,de,15,F[58]),Me=g(Me,Ne,Ce,ve,pe,21,F[59]),ve=g(ve,Me,Ne,Ce,se,6,F[60]),Ce=g(Ce,ve,Me,Ne,J,10,F[61]),Ne=g(Ne,Ce,ve,Me,j,15,F[62]),Me=g(Me,Ne,Ce,ve,Q,21,F[63]);D[0]=D[0]+ve|0,D[1]=D[1]+Me|0,D[2]=D[2]+Ne|0,D[3]=D[3]+Ce|0},_doFinalize:function(){var L=this._data,P=L.words,D=8*this._nDataBytes,A=8*L.sigBytes;P[A>>>5]|=128<<24-A%32;var N=s.floor(D/4294967296);for(P[(A+64>>>9<<4)+15]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,P[(A+64>>>9<<4)+14]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,L.sigBytes=4*(P.length+1),this._process(),L=this._hash,P=L.words,D=0;4>D;D++)A=P[D],P[D]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;return L},clone:function(){var L=k.clone.call(this);return L._hash=this._hash.clone(),L}}),m.MD5=k._createHelper(O),m.HmacMD5=k._createHmacHelper(O)}(Math),function(){var s=a,g=s.lib,c=g.WordArray,l=g.Hasher,d=[],g=s.algo.SHA1=l.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,T){for(var k=this._hash.words,O=k[0],F=k[1],U=k[2],L=k[3],P=k[4],D=0;80>D;D++){if(16>D)d[D]=m[T+D]|0;else{var A=d[D-3]^d[D-8]^d[D-14]^d[D-16];d[D]=A<<1|A>>>31}A=(O<<5|O>>>27)+P+d[D],A=20>D?A+((F&U|~F&L)+1518500249):40>D?A+((F^U^L)+1859775393):60>D?A+((F&U|F&L|U&L)-1894007588):A+((F^U^L)-899497514),P=L,L=U,U=F<<30|F>>>2,F=O,O=A}k[0]=k[0]+O|0,k[1]=k[1]+F|0,k[2]=k[2]+U|0,k[3]=k[3]+L|0,k[4]=k[4]+P|0},_doFinalize:function(){var m=this._data,T=m.words,k=8*this._nDataBytes,O=8*m.sigBytes;return T[O>>>5]|=128<<24-O%32,T[(O+64>>>9<<4)+14]=Math.floor(k/4294967296),T[(O+64>>>9<<4)+15]=k,m.sigBytes=4*T.length,this._process(),this._hash},clone:function(){var m=l.clone.call(this);return m._hash=this._hash.clone(),m}});s.SHA1=l._createHelper(g),s.HmacSHA1=l._createHmacHelper(g)}(),function(s){for(var c=a,D=c.lib,l=D.WordArray,d=D.Hasher,D=c.algo,g=[],m=[],T=function(N){return 4294967296*(N-(N|0))|0},k=2,O=0;64>O;){var F;e:{F=k;for(var U=s.sqrt(F),L=2;L<=U;L++)if(!(F%L)){F=!1;break e}F=!0}F&&(8>O&&(g[O]=T(s.pow(k,.5))),m[O]=T(s.pow(k,1/3)),O++),k++}var P=[],D=D.SHA256=d.extend({_doReset:function(){this._hash=new l.init(g.slice(0))},_doProcessBlock:function(A,N){for(var j=this._hash.words,W=j[0],se=j[1],he=j[2],de=j[3],fe=j[4],G=j[5],Q=j[6],te=j[7],J=0;64>J;J++){if(16>J)P[J]=A[N+J]|0;else{var re=P[J-15],pe=P[J-2];P[J]=((re<<25|re>>>7)^(re<<14|re>>>18)^re>>>3)+P[J-7]+((pe<<15|pe>>>17)^(pe<<13|pe>>>19)^pe>>>10)+P[J-16]}re=te+((fe<<26|fe>>>6)^(fe<<21|fe>>>11)^(fe<<7|fe>>>25))+(fe&G^~fe&Q)+m[J]+P[J],pe=((W<<30|W>>>2)^(W<<19|W>>>13)^(W<<10|W>>>22))+(W&se^W&he^se&he),te=Q,Q=G,G=fe,fe=de+re|0,de=he,he=se,se=W,W=re+pe|0}j[0]=j[0]+W|0,j[1]=j[1]+se|0,j[2]=j[2]+he|0,j[3]=j[3]+de|0,j[4]=j[4]+fe|0,j[5]=j[5]+G|0,j[6]=j[6]+Q|0,j[7]=j[7]+te|0},_doFinalize:function(){var A=this._data,N=A.words,j=8*this._nDataBytes,W=8*A.sigBytes;return N[W>>>5]|=128<<24-W%32,N[(W+64>>>9<<4)+14]=s.floor(j/4294967296),N[(W+64>>>9<<4)+15]=j,A.sigBytes=4*N.length,this._process(),this._hash},clone:function(){var A=d.clone.call(this);return A._hash=this._hash.clone(),A}});c.SHA256=d._createHelper(D),c.HmacSHA256=d._createHmacHelper(D)}(Math),function(){var s=a,c=s.lib.WordArray,d=s.algo,l=d.SHA256,d=d.SHA224=l.extend({_doReset:function(){this._hash=new c.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var g=l._doFinalize.call(this);return g.sigBytes-=4,g}});s.SHA224=l._createHelper(d),s.HmacSHA224=l._createHmacHelper(d)}(),function(){function s(){return d.create.apply(d,arguments)}for(var c=a,l=c.lib.Hasher,m=c.x64,d=m.Word,g=m.WordArray,m=c.algo,T=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],k=[],O=0;80>O;O++)k[O]=s();m=m.SHA512=l.extend({_doReset:function(){this._hash=new g.init([new d.init(1779033703,4089235720),new d.init(3144134277,2227873595),new d.init(1013904242,4271175723),new d.init(2773480762,1595750129),new d.init(1359893119,2917565137),new d.init(2600822924,725511199),new d.init(528734635,4215389547),new d.init(1541459225,327033209)])},_doProcessBlock:function(F,U){for(var se=this._hash.words,L=se[0],P=se[1],D=se[2],A=se[3],N=se[4],j=se[5],W=se[6],se=se[7],he=L.high,de=L.low,fe=P.high,G=P.low,Q=D.high,te=D.low,J=A.high,re=A.low,pe=N.high,be=N.low,Fe=j.high,ve=j.low,Ce=W.high,Ne=W.low,Me=se.high,rr=se.low,pn=he,tn=de,Rn=fe,Un=G,Jn=Q,Hn=te,ic=J,pr=re,jt=pe,Qt=be,fn=Fe,mn=ve,Rr=Ce,Sn=Ne,sc=Me,fa=rr,fi=0;80>fi;fi++){var As=k[fi];if(16>fi)var Yr=As.high=F[U+2*fi]|0,$t=As.low=F[U+2*fi+1]|0;else{var Yr=k[fi-15],$t=Yr.high,Ui=Yr.low,Yr=($t>>>1|Ui<<31)^($t>>>8|Ui<<24)^$t>>>7,Ui=(Ui>>>1|$t<<31)^(Ui>>>8|$t<<24)^(Ui>>>7|$t<<25),ma=k[fi-2],$t=ma.high,an=ma.low,ma=($t>>>19|an<<13)^($t<<3|an>>>29)^$t>>>6,an=(an>>>19|$t<<13)^(an<<3|$t>>>29)^(an>>>6|$t<<26),$t=k[fi-7],Vh=$t.high,Rs=k[fi-16],Hi=Rs.high,Rs=Rs.low,$t=Ui+$t.low,Yr=Yr+Vh+($t>>>0<Ui>>>0?1:0),$t=$t+an,Yr=Yr+ma+($t>>>0<an>>>0?1:0),$t=$t+Rs,Yr=Yr+Hi+($t>>>0<Rs>>>0?1:0);As.high=Yr,As.low=$t}var Vh=jt&fn^~jt&Rr,Rs=Qt&mn^~Qt&Sn,As=pn&Rn^pn&Jn^Rn&Jn,k2=tn&Un^tn&Hn^Un&Hn,Ui=(pn>>>28|tn<<4)^(pn<<30|tn>>>2)^(pn<<25|tn>>>7),ma=(tn>>>28|pn<<4)^(tn<<30|pn>>>2)^(tn<<25|pn>>>7),an=T[fi],T2=an.high,xg=an.low,an=fa+((Qt>>>14|jt<<18)^(Qt>>>18|jt<<14)^(Qt<<23|jt>>>9)),Hi=sc+((jt>>>14|Qt<<18)^(jt>>>18|Qt<<14)^(jt<<23|Qt>>>9))+(an>>>0<fa>>>0?1:0),an=an+Rs,Hi=Hi+Vh+(an>>>0<Rs>>>0?1:0),an=an+xg,Hi=Hi+T2+(an>>>0<xg>>>0?1:0),an=an+$t,Hi=Hi+Yr+(an>>>0<$t>>>0?1:0),$t=ma+k2,As=Ui+As+($t>>>0<ma>>>0?1:0),sc=Rr,fa=Sn,Rr=fn,Sn=mn,fn=jt,mn=Qt,Qt=pr+an|0,jt=ic+Hi+(Qt>>>0<pr>>>0?1:0)|0,ic=Jn,pr=Hn,Jn=Rn,Hn=Un,Rn=pn,Un=tn,tn=an+$t|0,pn=Hi+As+(tn>>>0<an>>>0?1:0)|0}de=L.low=de+tn,L.high=he+pn+(de>>>0<tn>>>0?1:0),G=P.low=G+Un,P.high=fe+Rn+(G>>>0<Un>>>0?1:0),te=D.low=te+Hn,D.high=Q+Jn+(te>>>0<Hn>>>0?1:0),re=A.low=re+pr,A.high=J+ic+(re>>>0<pr>>>0?1:0),be=N.low=be+Qt,N.high=pe+jt+(be>>>0<Qt>>>0?1:0),ve=j.low=ve+mn,j.high=Fe+fn+(ve>>>0<mn>>>0?1:0),Ne=W.low=Ne+Sn,W.high=Ce+Rr+(Ne>>>0<Sn>>>0?1:0),rr=se.low=rr+fa,se.high=Me+sc+(rr>>>0<fa>>>0?1:0)},_doFinalize:function(){var F=this._data,U=F.words,L=8*this._nDataBytes,P=8*F.sigBytes;return U[P>>>5]|=128<<24-P%32,U[(P+128>>>10<<5)+30]=Math.floor(L/4294967296),U[(P+128>>>10<<5)+31]=L,F.sigBytes=4*U.length,this._process(),this._hash.toX32()},clone:function(){var F=l.clone.call(this);return F._hash=this._hash.clone(),F},blockSize:32}),c.SHA512=l._createHelper(m),c.HmacSHA512=l._createHmacHelper(m)}(),function(){var s=a,g=s.x64,c=g.Word,l=g.WordArray,g=s.algo,d=g.SHA512,g=g.SHA384=d.extend({_doReset:function(){this._hash=new l.init([new c.init(3418070365,3238371032),new c.init(1654270250,914150663),new c.init(2438529370,812702999),new c.init(355462360,4144912697),new c.init(1731405415,4290775857),new c.init(2394180231,1750603025),new c.init(3675008525,1694076839),new c.init(1203062813,3204075428)])},_doFinalize:function(){var m=d._doFinalize.call(this);return m.sigBytes-=16,m}});s.SHA384=d._createHelper(g),s.HmacSHA384=d._createHmacHelper(g)}(),function(){var s=a,F=s.lib,c=F.WordArray,l=F.Hasher,F=s.algo,d=c.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),g=c.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),m=c.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),T=c.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),k=c.create([0,1518500249,1859775393,2400959708,2840853838]),O=c.create([1352829926,1548603684,1836072691,2053994217,0]),F=F.RIPEMD160=l.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(U,L){for(var P=0;16>P;P++){var D=L+P,A=U[D];U[D]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var D=this._hash.words,A=k.words,N=O.words,j=d.words,W=g.words,se=m.words,he=T.words,de,fe,G,Q,te,J,re,pe,be,Fe;J=de=D[0],re=fe=D[1],pe=G=D[2],be=Q=D[3],Fe=te=D[4];for(var ve,P=0;80>P;P+=1)ve=de+U[L+j[P]]|0,ve=16>P?ve+((fe^G^Q)+A[0]):32>P?ve+((fe&G|~fe&Q)+A[1]):48>P?ve+(((fe|~G)^Q)+A[2]):64>P?ve+((fe&Q|G&~Q)+A[3]):ve+((fe^(G|~Q))+A[4]),ve|=0,ve=ve<<se[P]|ve>>>32-se[P],ve=ve+te|0,de=te,te=Q,Q=G<<10|G>>>22,G=fe,fe=ve,ve=J+U[L+W[P]]|0,ve=16>P?ve+((re^(pe|~be))+N[0]):32>P?ve+((re&be|pe&~be)+N[1]):48>P?ve+(((re|~pe)^be)+N[2]):64>P?ve+((re&pe|~re&be)+N[3]):ve+((re^pe^be)+N[4]),ve|=0,ve=ve<<he[P]|ve>>>32-he[P],ve=ve+Fe|0,J=Fe,Fe=be,be=pe<<10|pe>>>22,pe=re,re=ve;ve=D[1]+G+be|0,D[1]=D[2]+Q+Fe|0,D[2]=D[3]+te+J|0,D[3]=D[4]+de+re|0,D[4]=D[0]+fe+pe|0,D[0]=ve},_doFinalize:function(){var U=this._data,L=U.words,P=8*this._nDataBytes,D=8*U.sigBytes;for(L[D>>>5]|=128<<24-D%32,L[(D+64>>>9<<4)+14]=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,U.sigBytes=4*(L.length+1),this._process(),U=this._hash,L=U.words,P=0;5>P;P++)D=L[P],L[P]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360;return U},clone:function(){var U=l.clone.call(this);return U._hash=this._hash.clone(),U}});s.RIPEMD160=l._createHelper(F),s.HmacRIPEMD160=l._createHmacHelper(F)}(),function(){var s=a,c=s.enc.Utf8;s.algo.HMAC=s.lib.Base.extend({init:function(l,d){l=this._hasher=new l.init,typeof d=="string"&&(d=c.parse(d));var g=l.blockSize,m=4*g;d.sigBytes>m&&(d=l.finalize(d)),d.clamp();for(var T=this._oKey=d.clone(),k=this._iKey=d.clone(),O=T.words,F=k.words,U=0;U<g;U++)O[U]^=1549556828,F[U]^=909522486;T.sigBytes=k.sigBytes=m,this.reset()},reset:function(){var l=this._hasher;l.reset(),l.update(this._iKey)},update:function(l){return this._hasher.update(l),this},finalize:function(l){var d=this._hasher;return l=d.finalize(l),d.reset(),d.finalize(this._oKey.clone().concat(l))}})}(),function(){var s=a,d=s.lib,c=d.Base,l=d.WordArray,d=s.algo,g=d.HMAC,m=d.PBKDF2=c.extend({cfg:c.extend({keySize:4,hasher:d.SHA1,iterations:1}),init:function(T){this.cfg=this.cfg.extend(T)},compute:function(T,k){for(var A=this.cfg,O=g.create(A.hasher,T),F=l.create(),U=l.create([1]),L=F.words,P=U.words,D=A.keySize,A=A.iterations;L.length<D;){var N=O.update(k).finalize(U);O.reset();for(var j=N.words,W=j.length,se=N,he=1;he<A;he++){se=O.finalize(se),O.reset();for(var de=se.words,fe=0;fe<W;fe++)j[fe]^=de[fe]}F.concat(N),P[0]++}return F.sigBytes=4*D,F}});s.PBKDF2=function(T,k,O){return m.create(O).compute(T,k)}}();var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="=";function p(s){var c,l,d="";for(c=0;c+3<=s.length;c+=3)l=parseInt(s.substring(c,c+3),16),d+=o.charAt(l>>6)+o.charAt(l&63);for(c+1==s.length?(l=parseInt(s.substring(c,c+1),16),d+=o.charAt(l<<2)):c+2==s.length&&(l=parseInt(s.substring(c,c+2),16),d+=o.charAt(l>>2)+o.charAt((l&3)<<4));(d.length&3)>0;)d+=u;return d}function h(s){var c="",l,d=0,g,m;for(l=0;l<s.length&&s.charAt(l)!=u;++l)m=o.indexOf(s.charAt(l)),!(m<0)&&(d==0?(c+=$(m>>2),g=m&3,d=1):d==1?(c+=$(g<<2|m>>4),g=m&15,d=2):d==2?(c+=$(g),c+=$(m>>2),g=m&3,d=3):(c+=$(g<<2|m>>4),c+=$(m&15),d=0));return d==1&&(c+=$(g<<2)),c}function v(s){var c=h(s),l,d=new Array;for(l=0;2*l<c.length;++l)d[l]=parseInt(c.substring(2*l,2*l+2),16);return d}var f;function _(s,c,l){s!=null&&(typeof s=="number"?this.fromNumber(s,c,l):c==null&&typeof s!="string"?this.fromString(s,256):this.fromString(s,c))}function w(){return new _(null)}function C(s,c,l,d,g,m){for(;--m>=0;){var T=c*this[s++]+l[d]+g;g=Math.floor(T/67108864),l[d++]=T&67108863}return g}function R(s,c,l,d,g,m){for(var T=c&32767,k=c>>15;--m>=0;){var O=this[s]&32767,F=this[s++]>>15,U=k*O+F*T;O=T*O+((U&32767)<<15)+l[d]+(g&1073741823),g=(O>>>30)+(U>>>15)+k*F+(g>>>30),l[d++]=O&1073741823}return g}function S(s,c,l,d,g,m){for(var T=c&16383,k=c>>14;--m>=0;){var O=this[s]&16383,F=this[s++]>>14,U=k*O+F*T;O=T*O+((U&16383)<<14)+l[d]+g,g=(O>>28)+(U>>14)+k*F,l[d++]=O&268435455}return g}t.appName=="Microsoft Internet Explorer"?(_.prototype.am=R,f=30):t.appName!="Netscape"?(_.prototype.am=C,f=26):(_.prototype.am=S,f=28),_.prototype.DB=f,_.prototype.DM=(1<<f)-1,_.prototype.DV=1<<f;var b=52;_.prototype.FV=Math.pow(2,b),_.prototype.F1=b-f,_.prototype.F2=2*f-b;var x="0123456789abcdefghijklmnopqrstuvwxyz",E=new Array,M,Z;for(M=48,Z=0;Z<=9;++Z)E[M++]=Z;for(M=97,Z=10;Z<36;++Z)E[M++]=Z;for(M=65,Z=10;Z<36;++Z)E[M++]=Z;function $(s){return x.charAt(s)}function z(s,c){var l=E[s.charCodeAt(c)];return l??-1}function q(s){for(var c=this.t-1;c>=0;--c)s[c]=this[c];s.t=this.t,s.s=this.s}function X(s){this.t=1,this.s=s<0?-1:0,s>0?this[0]=s:s<-1?this[0]=s+this.DV:this.t=0}function K(s){var c=w();return c.fromInt(s),c}function ee(s,c){var l;if(c==16)l=4;else if(c==8)l=3;else if(c==256)l=8;else if(c==2)l=1;else if(c==32)l=5;else if(c==4)l=2;else{this.fromRadix(s,c);return}this.t=0,this.s=0;for(var d=s.length,g=!1,m=0;--d>=0;){var T=l==8?s[d]&255:z(s,d);if(T<0){s.charAt(d)=="-"&&(g=!0);continue}g=!1,m==0?this[this.t++]=T:m+l>this.DB?(this[this.t-1]|=(T&(1<<this.DB-m)-1)<<m,this[this.t++]=T>>this.DB-m):this[this.t-1]|=T<<m,m+=l,m>=this.DB&&(m-=this.DB)}l==8&&s[0]&128&&(this.s=-1,m>0&&(this[this.t-1]|=(1<<this.DB-m)-1<<m)),this.clamp(),g&&_.ZERO.subTo(this,this)}function oe(){for(var s=this.s&this.DM;this.t>0&&this[this.t-1]==s;)--this.t}function ce(s){if(this.s<0)return"-"+this.negate().toString(s);var c;if(s==16)c=4;else if(s==8)c=3;else if(s==2)c=1;else if(s==32)c=5;else if(s==4)c=2;else return this.toRadix(s);var l=(1<<c)-1,d,g=!1,m="",T=this.t,k=this.DB-T*this.DB%c;if(T-- >0)for(k<this.DB&&(d=this[T]>>k)>0&&(g=!0,m=$(d));T>=0;)k<c?(d=(this[T]&(1<<k)-1)<<c-k,d|=this[--T]>>(k+=this.DB-c)):(d=this[T]>>(k-=c)&l,k<=0&&(k+=this.DB,--T)),d>0&&(g=!0),g&&(m+=$(d));return g?m:"0"}function ne(){var s=w();return _.ZERO.subTo(this,s),s}function Te(){return this.s<0?this.negate():this}function ye(s){var c=this.s-s.s;if(c!=0)return c;var l=this.t;if(c=l-s.t,c!=0)return this.s<0?-c:c;for(;--l>=0;)if((c=this[l]-s[l])!=0)return c;return 0}function ue(s){var c=1,l;return(l=s>>>16)!=0&&(s=l,c+=16),(l=s>>8)!=0&&(s=l,c+=8),(l=s>>4)!=0&&(s=l,c+=4),(l=s>>2)!=0&&(s=l,c+=2),(l=s>>1)!=0&&(s=l,c+=1),c}function me(){return this.t<=0?0:this.DB*(this.t-1)+ue(this[this.t-1]^this.s&this.DM)}function _e(s,c){var l;for(l=this.t-1;l>=0;--l)c[l+s]=this[l];for(l=s-1;l>=0;--l)c[l]=0;c.t=this.t+s,c.s=this.s}function ke(s,c){for(var l=s;l<this.t;++l)c[l-s]=this[l];c.t=Math.max(this.t-s,0),c.s=this.s}function le(s,c){var l=s%this.DB,d=this.DB-l,g=(1<<d)-1,m=Math.floor(s/this.DB),T=this.s<<l&this.DM,k;for(k=this.t-1;k>=0;--k)c[k+m+1]=this[k]>>d|T,T=(this[k]&g)<<l;for(k=m-1;k>=0;--k)c[k]=0;c[m]=T,c.t=this.t+m+1,c.s=this.s,c.clamp()}function Re(s,c){c.s=this.s;var l=Math.floor(s/this.DB);if(l>=this.t){c.t=0;return}var d=s%this.DB,g=this.DB-d,m=(1<<d)-1;c[0]=this[l]>>d;for(var T=l+1;T<this.t;++T)c[T-l-1]|=(this[T]&m)<<g,c[T-l]=this[T]>>d;d>0&&(c[this.t-l-1]|=(this.s&m)<<g),c.t=this.t-l,c.clamp()}function We(s,c){for(var l=0,d=0,g=Math.min(s.t,this.t);l<g;)d+=this[l]-s[l],c[l++]=d&this.DM,d>>=this.DB;if(s.t<this.t){for(d-=s.s;l<this.t;)d+=this[l],c[l++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;l<s.t;)d-=s[l],c[l++]=d&this.DM,d>>=this.DB;d-=s.s}c.s=d<0?-1:0,d<-1?c[l++]=this.DV+d:d>0&&(c[l++]=d),c.t=l,c.clamp()}function Xe(s,c){var l=this.abs(),d=s.abs(),g=l.t;for(c.t=g+d.t;--g>=0;)c[g]=0;for(g=0;g<d.t;++g)c[g+l.t]=l.am(0,d[g],c,g,0,l.t);c.s=0,c.clamp(),this.s!=s.s&&_.ZERO.subTo(c,c)}function Ke(s){for(var c=this.abs(),l=s.t=2*c.t;--l>=0;)s[l]=0;for(l=0;l<c.t-1;++l){var d=c.am(l,c[l],s,2*l,0,1);(s[l+c.t]+=c.am(l+1,2*c[l],s,2*l+1,d,c.t-l-1))>=c.DV&&(s[l+c.t]-=c.DV,s[l+c.t+1]=1)}s.t>0&&(s[s.t-1]+=c.am(l,c[l],s,2*l,0,1)),s.s=0,s.clamp()}function Le(s,c,l){var d=s.abs();if(!(d.t<=0)){var g=this.abs();if(g.t<d.t){c!=null&&c.fromInt(0),l!=null&&this.copyTo(l);return}l==null&&(l=w());var m=w(),T=this.s,k=s.s,O=this.DB-ue(d[d.t-1]);O>0?(d.lShiftTo(O,m),g.lShiftTo(O,l)):(d.copyTo(m),g.copyTo(l));var F=m.t,U=m[F-1];if(U!=0){var L=U*(1<<this.F1)+(F>1?m[F-2]>>this.F2:0),P=this.FV/L,D=(1<<this.F1)/L,A=1<<this.F2,N=l.t,j=N-F,W=c??w();for(m.dlShiftTo(j,W),l.compareTo(W)>=0&&(l[l.t++]=1,l.subTo(W,l)),_.ONE.dlShiftTo(F,W),W.subTo(m,m);m.t<F;)m[m.t++]=0;for(;--j>=0;){var se=l[--N]==U?this.DM:Math.floor(l[N]*P+(l[N-1]+A)*D);if((l[N]+=m.am(0,se,l,j,0,F))<se)for(m.dlShiftTo(j,W),l.subTo(W,l);l[N]<--se;)l.subTo(W,l)}c!=null&&(l.drShiftTo(F,c),T!=k&&_.ZERO.subTo(c,c)),l.t=F,l.clamp(),O>0&&l.rShiftTo(O,l),T<0&&_.ZERO.subTo(l,l)}}}function qe(s){var c=w();return this.abs().divRemTo(s,null,c),this.s<0&&c.compareTo(_.ZERO)>0&&s.subTo(c,c),c}function rt(s){this.m=s}function ot(s){return s.s<0||s.compareTo(this.m)>=0?s.mod(this.m):s}function wt(s){return s}function Pn(s){s.divRemTo(this.m,null,s)}function Xi(s,c,l){s.multiplyTo(c,l),this.reduce(l)}function kn(s,c){s.squareTo(c),this.reduce(c)}rt.prototype.convert=ot,rt.prototype.revert=wt,rt.prototype.reduce=Pn,rt.prototype.mulTo=Xi,rt.prototype.sqrTo=kn;function dr(){if(this.t<1)return 0;var s=this[0];if(!(s&1))return 0;var c=s&3;return c=c*(2-(s&15)*c)&15,c=c*(2-(s&255)*c)&255,c=c*(2-((s&65535)*c&65535))&65535,c=c*(2-s*c%this.DV)%this.DV,c>0?this.DV-c:-c}function Nn(s){this.m=s,this.mp=s.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<s.DB-15)-1,this.mt2=2*s.t}function Qr(s){var c=w();return s.abs().dlShiftTo(this.m.t,c),c.divRemTo(this.m,null,c),s.s<0&&c.compareTo(_.ZERO)>0&&this.m.subTo(c,c),c}function di(s){var c=w();return s.copyTo(c),this.reduce(c),c}function zn(s){for(;s.t<=this.mt2;)s[s.t++]=0;for(var c=0;c<this.m.t;++c){var l=s[c]&32767,d=l*this.mpl+((l*this.mph+(s[c]>>15)*this.mpl&this.um)<<15)&s.DM;for(l=c+this.m.t,s[l]+=this.m.am(0,d,s,c,0,this.m.t);s[l]>=s.DV;)s[l]-=s.DV,s[++l]++}s.clamp(),s.drShiftTo(this.m.t,s),s.compareTo(this.m)>=0&&s.subTo(this.m,s)}function Hr(s,c){s.squareTo(c),this.reduce(c)}function Cs(s,c,l){s.multiplyTo(c,l),this.reduce(l)}Nn.prototype.convert=Qr,Nn.prototype.revert=di,Nn.prototype.reduce=zn,Nn.prototype.mulTo=Cs,Nn.prototype.sqrTo=Hr;function Kn(){return(this.t>0?this[0]&1:this.s)==0}function la(s,c){if(s>4294967295||s<1)return _.ONE;var l=w(),d=w(),g=c.convert(this),m=ue(s)-1;for(g.copyTo(l);--m>=0;)if(c.sqrTo(l,d),(s&1<<m)>0)c.mulTo(d,g,l);else{var T=l;l=d,d=T}return c.revert(l)}function jn(s,c){var l;return s<256||c.isEven()?l=new rt(c):l=new Nn(c),this.exp(s,l)}_.prototype.copyTo=q,_.prototype.fromInt=X,_.prototype.fromString=ee,_.prototype.clamp=oe,_.prototype.dlShiftTo=_e,_.prototype.drShiftTo=ke,_.prototype.lShiftTo=le,_.prototype.rShiftTo=Re,_.prototype.subTo=We,_.prototype.multiplyTo=Xe,_.prototype.squareTo=Ke,_.prototype.divRemTo=Le,_.prototype.invDigit=dr,_.prototype.isEven=Kn,_.prototype.exp=la,_.prototype.toString=ce,_.prototype.negate=ne,_.prototype.abs=Te,_.prototype.compareTo=ye,_.prototype.bitLength=me,_.prototype.mod=qe,_.prototype.modPowInt=jn,_.ZERO=K(0),_.ONE=K(1);function hi(){var s=w();return this.copyTo(s),s}function Mi(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function _t(){return this.t==0?this.s:this[0]<<24>>24}function Ft(){return this.t==0?this.s:this[0]<<16>>16}function at(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function Kt(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Er(s){if(s==null&&(s=10),this.signum()==0||s<2||s>36)return"0";var c=this.chunkSize(s),l=Math.pow(s,c),d=K(l),g=w(),m=w(),T="";for(this.divRemTo(d,g,m);g.signum()>0;)T=(l+m.intValue()).toString(s).substr(1)+T,g.divRemTo(d,g,m);return m.intValue().toString(s)+T}function hr(s,c){this.fromInt(0),c==null&&(c=10);for(var l=this.chunkSize(c),d=Math.pow(c,l),g=!1,m=0,T=0,k=0;k<s.length;++k){var O=z(s,k);if(O<0){s.charAt(k)=="-"&&this.signum()==0&&(g=!0);continue}T=c*T+O,++m>=l&&(this.dMultiply(d),this.dAddOffset(T,0),m=0,T=0)}m>0&&(this.dMultiply(Math.pow(c,m)),this.dAddOffset(T,0)),g&&_.ZERO.subTo(this,this)}function Ht(s,c,l){if(typeof c=="number")if(s<2)this.fromInt(1);else for(this.fromNumber(s,l),this.testBit(s-1)||this.bitwiseTo(_.ONE.shiftLeft(s-1),Ps,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>s&&this.subTo(_.ONE.shiftLeft(s-1),this);else{var d=new Array,g=s&7;d.length=(s>>3)+1,c.nextBytes(d),g>0?d[0]&=(1<<g)-1:d[0]=0,this.fromString(d,256)}}function dt(){var s=this.t,c=new Array;c[0]=this.s;var l=this.DB-s*this.DB%8,d,g=0;if(s-- >0)for(l<this.DB&&(d=this[s]>>l)!=(this.s&this.DM)>>l&&(c[g++]=d|this.s<<this.DB-l);s>=0;)l<8?(d=(this[s]&(1<<l)-1)<<8-l,d|=this[--s]>>(l+=this.DB-8)):(d=this[s]>>(l-=8)&255,l<=0&&(l+=this.DB,--s)),d&128&&(d|=-256),g==0&&(this.s&128)!=(d&128)&&++g,(g>0||d!=this.s)&&(c[g++]=d);return c}function Bn(s){return this.compareTo(s)==0}function Es(s){return this.compareTo(s)<0?this:s}function hn(s){return this.compareTo(s)>0?this:s}function $a(s,c,l){var d,g,m=Math.min(s.t,this.t);for(d=0;d<m;++d)l[d]=c(this[d],s[d]);if(s.t<this.t){for(g=s.s&this.DM,d=m;d<this.t;++d)l[d]=c(this[d],g);l.t=this.t}else{for(g=this.s&this.DM,d=m;d<s.t;++d)l[d]=c(g,s[d]);l.t=s.t}l.s=c(this.s,s.s),l.clamp()}function Rl(s,c){return s&c}function nn(s){var c=w();return this.bitwiseTo(s,Rl,c),c}function Ps(s,c){return s|c}function Al(s){var c=w();return this.bitwiseTo(s,Ps,c),c}function Li(s,c){return s^c}function Xr(s){var c=w();return this.bitwiseTo(s,Li,c),c}function Rt(s,c){return s&~c}function Il(s){var c=w();return this.bitwiseTo(s,Rt,c),c}function Wa(){for(var s=w(),c=0;c<this.t;++c)s[c]=this.DM&~this[c];return s.t=this.t,s.s=~this.s,s}function Fl(s){var c=w();return s<0?this.rShiftTo(-s,c):this.lShiftTo(s,c),c}function Dl(s){var c=w();return s<0?this.lShiftTo(-s,c):this.rShiftTo(s,c),c}function Yi(s){if(s==0)return-1;var c=0;return s&65535||(s>>=16,c+=16),s&255||(s>>=8,c+=8),s&15||(s>>=4,c+=4),s&3||(s>>=2,c+=2),s&1||++c,c}function $o(){for(var s=0;s<this.t;++s)if(this[s]!=0)return s*this.DB+Yi(this[s]);return this.s<0?this.t*this.DB:-1}function ji(s){for(var c=0;s!=0;)s&=s-1,++c;return c}function es(){for(var s=0,c=this.s&this.DM,l=0;l<this.t;++l)s+=ji(this[l]^c);return s}function ph(s){var c=Math.floor(s/this.DB);return c>=this.t?this.s!=0:(this[c]&1<<s%this.DB)!=0}function fh(s,c){var l=_.ONE.shiftLeft(s);return this.bitwiseTo(l,c,l),l}function $n(s){return this.changeBit(s,Ps)}function ua(s){return this.changeBit(s,Rt)}function mh(s){return this.changeBit(s,Li)}function Wo(s,c){for(var l=0,d=0,g=Math.min(s.t,this.t);l<g;)d+=this[l]+s[l],c[l++]=d&this.DM,d>>=this.DB;if(s.t<this.t){for(d+=s.s;l<this.t;)d+=this[l],c[l++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;l<s.t;)d+=s[l],c[l++]=d&this.DM,d>>=this.DB;d+=s.s}c.s=d<0?-1:0,d>0?c[l++]=d:d<-1&&(c[l++]=this.DV+d),c.t=l,c.clamp()}function gh(s){var c=w();return this.addTo(s,c),c}function ks(s){var c=w();return this.subTo(s,c),c}function vh(s){var c=w();return this.multiplyTo(s,c),c}function Nl(){var s=w();return this.squareTo(s),s}function Ol(s){var c=w();return this.divRemTo(s,c,null),c}function yh(s){var c=w();return this.divRemTo(s,null,c),c}function Go(s){var c=w(),l=w();return this.divRemTo(s,c,l),new Array(c,l)}function ts(s){this[this.t]=this.am(0,s-1,this,0,0,this.t),++this.t,this.clamp()}function _h(s,c){if(s!=0){for(;this.t<=c;)this[this.t++]=0;for(this[c]+=s;this[c]>=this.DV;)this[c]-=this.DV,++c>=this.t&&(this[this.t++]=0),++this[c]}}function da(){}function ha(s){return s}function bh(s,c,l){s.multiplyTo(c,l)}function Ml(s,c){s.squareTo(c)}da.prototype.convert=ha,da.prototype.revert=ha,da.prototype.mulTo=bh,da.prototype.sqrTo=Ml;function Sh(s){return this.exp(s,new da)}function Ll(s,c,l){var d=Math.min(this.t+s.t,c);for(l.s=0,l.t=d;d>0;)l[--d]=0;var g;for(g=l.t-this.t;d<g;++d)l[d+this.t]=this.am(0,s[d],l,d,0,this.t);for(g=Math.min(s.t,c);d<g;++d)this.am(0,s[d],l,d,0,c-d);l.clamp()}function Jo(s,c,l){--c;var d=l.t=this.t+s.t-c;for(l.s=0;--d>=0;)l[d]=0;for(d=Math.max(c-this.t,0);d<s.t;++d)l[this.t+d-c]=this.am(c-d,s[d],l,0,0,this.t+d-c);l.clamp(),l.drShiftTo(1,l)}function ns(s){this.r2=w(),this.q3=w(),_.ONE.dlShiftTo(2*s.t,this.r2),this.mu=this.r2.divide(s),this.m=s}function wh(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);if(s.compareTo(this.m)<0)return s;var c=w();return s.copyTo(c),this.reduce(c),c}function xh(s){return s}function Ch(s){for(s.drShiftTo(this.m.t-1,this.r2),s.t>this.m.t+1&&(s.t=this.m.t+1,s.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);s.compareTo(this.r2)<0;)s.dAddOffset(1,this.m.t+1);for(s.subTo(this.r2,s);s.compareTo(this.m)>=0;)s.subTo(this.m,s)}function Eh(s,c){s.squareTo(c),this.reduce(c)}function jl(s,c,l){s.multiplyTo(c,l),this.reduce(l)}ns.prototype.convert=wh,ns.prototype.revert=xh,ns.prototype.reduce=Ch,ns.prototype.mulTo=jl,ns.prototype.sqrTo=Eh;function Ph(s,c){var l=s.bitLength(),d,g=K(1),m;if(l<=0)return g;l<18?d=1:l<48?d=3:l<144?d=4:l<768?d=5:d=6,l<8?m=new rt(c):c.isEven()?m=new ns(c):m=new Nn(c);var T=new Array,k=3,O=d-1,F=(1<<d)-1;if(T[1]=m.convert(this),d>1){var U=w();for(m.sqrTo(T[1],U);k<=F;)T[k]=w(),m.mulTo(U,T[k-2],T[k]),k+=2}var L=s.t-1,P,D=!0,A=w(),N;for(l=ue(s[L])-1;L>=0;){for(l>=O?P=s[L]>>l-O&F:(P=(s[L]&(1<<l+1)-1)<<O-l,L>0&&(P|=s[L-1]>>this.DB+l-O)),k=d;!(P&1);)P>>=1,--k;if((l-=k)<0&&(l+=this.DB,--L),D)T[P].copyTo(g),D=!1;else{for(;k>1;)m.sqrTo(g,A),m.sqrTo(A,g),k-=2;k>0?m.sqrTo(g,A):(N=g,g=A,A=N),m.mulTo(A,T[P],g)}for(;L>=0&&!(s[L]&1<<l);)m.sqrTo(g,A),N=g,g=A,A=N,--l<0&&(l=this.DB-1,--L)}return m.revert(g)}function kh(s){var c=this.s<0?this.negate():this.clone(),l=s.s<0?s.negate():s.clone();if(c.compareTo(l)<0){var d=c;c=l,l=d}var g=c.getLowestSetBit(),m=l.getLowestSetBit();if(m<0)return c;for(g<m&&(m=g),m>0&&(c.rShiftTo(m,c),l.rShiftTo(m,l));c.signum()>0;)(g=c.getLowestSetBit())>0&&c.rShiftTo(g,c),(g=l.getLowestSetBit())>0&&l.rShiftTo(g,l),c.compareTo(l)>=0?(c.subTo(l,c),c.rShiftTo(1,c)):(l.subTo(c,l),l.rShiftTo(1,l));return m>0&&l.lShiftTo(m,l),l}function Zo(s){if(s<=0)return 0;var c=this.DV%s,l=this.s<0?s-1:0;if(this.t>0)if(c==0)l=this[0]%s;else for(var d=this.t-1;d>=0;--d)l=(c*l+this[d])%s;return l}function Th(s){var c=s.isEven();if(this.isEven()&&c||s.signum()==0)return _.ZERO;for(var l=s.clone(),d=this.clone(),g=K(1),m=K(0),T=K(0),k=K(1);l.signum()!=0;){for(;l.isEven();)l.rShiftTo(1,l),c?((!g.isEven()||!m.isEven())&&(g.addTo(this,g),m.subTo(s,m)),g.rShiftTo(1,g)):m.isEven()||m.subTo(s,m),m.rShiftTo(1,m);for(;d.isEven();)d.rShiftTo(1,d),c?((!T.isEven()||!k.isEven())&&(T.addTo(this,T),k.subTo(s,k)),T.rShiftTo(1,T)):k.isEven()||k.subTo(s,k),k.rShiftTo(1,k);l.compareTo(d)>=0?(l.subTo(d,l),c&&g.subTo(T,g),m.subTo(k,m)):(d.subTo(l,d),c&&T.subTo(g,T),k.subTo(m,k))}if(d.compareTo(_.ONE)!=0)return _.ZERO;if(k.compareTo(s)>=0)return k.subtract(s);if(k.signum()<0)k.addTo(s,k);else return k;return k.signum()<0?k.add(s):k}var Wn=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Rh=(1<<26)/Wn[Wn.length-1];function Ah(s){var c,l=this.abs();if(l.t==1&&l[0]<=Wn[Wn.length-1]){for(c=0;c<Wn.length;++c)if(l[0]==Wn[c])return!0;return!1}if(l.isEven())return!1;for(c=1;c<Wn.length;){for(var d=Wn[c],g=c+1;g<Wn.length&&d<Rh;)d*=Wn[g++];for(d=l.modInt(d);c<g;)if(d%Wn[c++]==0)return!1}return l.millerRabin(s)}function Qo(s){var c=this.subtract(_.ONE),l=c.getLowestSetBit();if(l<=0)return!1;var d=c.shiftRight(l);s=s+1>>1,s>Wn.length&&(s=Wn.length);for(var g=w(),m=0;m<s;++m){g.fromInt(Wn[Math.floor(Math.random()*Wn.length)]);var T=g.modPow(d,this);if(T.compareTo(_.ONE)!=0&&T.compareTo(c)!=0){for(var k=1;k++<l&&T.compareTo(c)!=0;)if(T=T.modPowInt(2,this),T.compareTo(_.ONE)==0)return!1;if(T.compareTo(c)!=0)return!1}}return!0}_.prototype.chunkSize=at,_.prototype.toRadix=Er,_.prototype.fromRadix=hr,_.prototype.fromNumber=Ht,_.prototype.bitwiseTo=$a,_.prototype.changeBit=fh,_.prototype.addTo=Wo,_.prototype.dMultiply=ts,_.prototype.dAddOffset=_h,_.prototype.multiplyLowerTo=Ll,_.prototype.multiplyUpperTo=Jo,_.prototype.modInt=Zo,_.prototype.millerRabin=Qo,_.prototype.clone=hi,_.prototype.intValue=Mi,_.prototype.byteValue=_t,_.prototype.shortValue=Ft,_.prototype.signum=Kt,_.prototype.toByteArray=dt,_.prototype.equals=Bn,_.prototype.min=Es,_.prototype.max=hn,_.prototype.and=nn,_.prototype.or=Al,_.prototype.xor=Xr,_.prototype.andNot=Il,_.prototype.not=Wa,_.prototype.shiftLeft=Fl,_.prototype.shiftRight=Dl,_.prototype.getLowestSetBit=$o,_.prototype.bitCount=es,_.prototype.testBit=ph,_.prototype.setBit=$n,_.prototype.clearBit=ua,_.prototype.flipBit=mh,_.prototype.add=gh,_.prototype.subtract=ks,_.prototype.multiply=vh,_.prototype.divide=Ol,_.prototype.remainder=yh,_.prototype.divideAndRemainder=Go,_.prototype.modPow=Ph,_.prototype.modInverse=Th,_.prototype.pow=Sh,_.prototype.gcd=kh,_.prototype.isProbablePrime=Ah,_.prototype.square=Nl;function Xo(){this.i=0,this.j=0,this.S=new Array}function Ih(s){var c,l,d;for(c=0;c<256;++c)this.S[c]=c;for(l=0,c=0;c<256;++c)l=l+this.S[c]+s[c%s.length]&255,d=this.S[c],this.S[c]=this.S[l],this.S[l]=d;this.i=0,this.j=0}function Fh(){var s;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,s=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=s,this.S[s+this.S[this.i]&255]}Xo.prototype.init=Ih,Xo.prototype.next=Fh;function Dh(){return new Xo}var Yo=256,pa,tr,xn;function Bl(s){tr[xn++]^=s&255,tr[xn++]^=s>>8&255,tr[xn++]^=s>>16&255,tr[xn++]^=s>>24&255,xn>=Yo&&(xn-=Yo)}function Ga(){Bl(new Date().getTime())}if(tr==null){if(tr=new Array,xn=0,n!==void 0&&(n.crypto!==void 0||n.msCrypto!==void 0)){if(ec=n.crypto||n.msCrypto,ec.getRandomValues)for(Ja=new Uint8Array(32),ec.getRandomValues(Ja),Pr=0;Pr<32;++Pr)tr[xn++]=Ja[Pr];else if(t.appName=="Netscape"&&t.appVersion<"5")for(I=n.crypto.random(32),Pr=0;Pr<I.length;++Pr)tr[xn++]=I.charCodeAt(Pr)&255}for(;xn<Yo;)Pr=Math.floor(65536*Math.random()),tr[xn++]=Pr>>>8,tr[xn++]=Pr&255;xn=0,Ga()}var Pr,ec,Ja,I;function B(){if(pa==null){for(Ga(),pa=Dh(),pa.init(tr),xn=0;xn<tr.length;++xn)tr[xn]=0;xn=0}return pa.next()}function V(s){var c;for(c=0;c<s.length;++c)s[c]=B()}function ae(){}ae.prototype.nextBytes=V;function Se(s,c){return new _(s,c)}function xe(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Pe(s,c){if(this.isPublic=!0,this.isPrivate=!1,typeof s!="string")this.n=s,this.e=c;else if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=Se(s,16),this.e=parseInt(c,16);else throw"Invalid RSA public key"}function De(s){return s.modPowInt(this.e,this.n)}xe.prototype.doPublic=De,xe.prototype.setPublic=Pe,xe.prototype.type="RSA";function He(s,c,l){if(this.isPrivate=!0,typeof s!="string")this.n=s,this.e=c,this.d=l;else if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=Se(s,16),this.e=parseInt(c,16),this.d=Se(l,16);else throw"Invalid RSA private key"}function Je(s,c,l,d,g,m,T,k){if(this.isPrivate=!0,this.isPublic=!1,s==null)throw"RSASetPrivateEx N == null";if(c==null)throw"RSASetPrivateEx E == null";if(s.length==0)throw"RSASetPrivateEx N.length == 0";if(c.length==0)throw"RSASetPrivateEx E.length == 0";if(s!=null&&c!=null&&s.length>0&&c.length>0)this.n=Se(s,16),this.e=parseInt(c,16),this.d=Se(l,16),this.p=Se(d,16),this.q=Se(g,16),this.dmp1=Se(m,16),this.dmq1=Se(T,16),this.coeff=Se(k,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function pt(s,c){var l=new ae,d=s>>1;this.e=parseInt(c,16);for(var g=new _(c,16),m=s/2-100,T=_.ONE.shiftLeft(m);;){for(;this.p=new _(s-d,1,l),!(this.p.subtract(_.ONE).gcd(g).compareTo(_.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new _(d,1,l),!(this.q.subtract(_.ONE).gcd(g).compareTo(_.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var k=this.p;this.p=this.q,this.q=k}var O=this.q.subtract(this.p).abs();if(!(O.bitLength()<m||O.compareTo(T)<=0)){var F=this.p.subtract(_.ONE),U=this.q.subtract(_.ONE),L=F.multiply(U);if(L.gcd(g).compareTo(_.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==s)){this.d=g.modInverse(L),this.dmp1=this.d.mod(F),this.dmq1=this.d.mod(U),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function zt(s){if(this.p==null||this.q==null)return s.modPow(this.d,this.n);for(var c=s.mod(this.p).modPow(this.dmp1,this.p),l=s.mod(this.q).modPow(this.dmq1,this.q);c.compareTo(l)<0;)c=c.add(this.p);return c.subtract(l).multiply(this.coeff).mod(this.p).multiply(this.q).add(l)}xe.prototype.doPrivate=zt,xe.prototype.setPrivate=He,xe.prototype.setPrivateEx=Je,xe.prototype.generate=pt;function st(s,c){this.x=c,this.q=s}function vt(s){return s==this?!0:this.q.equals(s.q)&&this.x.equals(s.x)}function nt(){return this.x}function ft(){return new st(this.q,this.x.negate().mod(this.q))}function xt(s){return new st(this.q,this.x.add(s.toBigInteger()).mod(this.q))}function Dt(s){return new st(this.q,this.x.subtract(s.toBigInteger()).mod(this.q))}function Tn(s){return new st(this.q,this.x.multiply(s.toBigInteger()).mod(this.q))}function Gt(){return new st(this.q,this.x.square().mod(this.q))}function Gn(s){return new st(this.q,this.x.multiply(s.toBigInteger().modInverse(this.q)).mod(this.q))}st.prototype.equals=vt,st.prototype.toBigInteger=nt,st.prototype.negate=ft,st.prototype.add=xt,st.prototype.subtract=Dt,st.prototype.multiply=Tn,st.prototype.square=Gt,st.prototype.divide=Gn,st.prototype.sqrt=function(){return new st(this.q,this.x.sqrt().mod(this.q))};function ct(s,c,l,d){this.curve=s,this.x=c,this.y=l,d==null?this.z=_.ONE:this.z=d,this.zinv=null}function bt(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Mt(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Bt(s){if(s==this)return!0;if(this.isInfinity())return s.isInfinity();if(s.isInfinity())return this.isInfinity();var c,l;return c=s.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(s.z)).mod(this.curve.q),c.equals(_.ZERO)?(l=s.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(s.z)).mod(this.curve.q),l.equals(_.ZERO)):!1}function kt(){return this.x==null&&this.y==null?!0:this.z.equals(_.ZERO)&&!this.y.toBigInteger().equals(_.ZERO)}function Lt(){return new ct(this.curve,this.x,this.y.negate(),this.z)}function Ut(s){if(this.isInfinity())return s;if(s.isInfinity())return this;var c=s.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(s.z)).mod(this.curve.q),l=s.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(s.z)).mod(this.curve.q);if(_.ZERO.equals(l))return _.ZERO.equals(c)?this.twice():this.curve.getInfinity();var d=new _("3"),g=this.x.toBigInteger(),m=this.y.toBigInteger();s.x.toBigInteger(),s.y.toBigInteger();var T=l.square(),k=T.multiply(l),O=g.multiply(T),F=c.square().multiply(this.z),U=F.subtract(O.shiftLeft(1)).multiply(s.z).subtract(k).multiply(l).mod(this.curve.q),L=O.multiply(d).multiply(c).subtract(m.multiply(k)).subtract(F.multiply(c)).multiply(s.z).add(c.multiply(k)).mod(this.curve.q),P=k.multiply(this.z).multiply(s.z).mod(this.curve.q);return new ct(this.curve,this.curve.fromBigInteger(U),this.curve.fromBigInteger(L),P)}function Ts(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var s=new _("3"),c=this.x.toBigInteger(),l=this.y.toBigInteger(),d=l.multiply(this.z),g=d.multiply(l).mod(this.curve.q),m=this.curve.a.toBigInteger(),T=c.square().multiply(s);_.ZERO.equals(m)||(T=T.add(this.z.square().multiply(m))),T=T.mod(this.curve.q);var k=T.square().subtract(c.shiftLeft(3).multiply(g)).shiftLeft(1).multiply(d).mod(this.curve.q),O=T.multiply(s).multiply(c).subtract(g.shiftLeft(1)).shiftLeft(2).multiply(g).subtract(T.square().multiply(T)).mod(this.curve.q),F=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new ct(this.curve,this.curve.fromBigInteger(k),this.curve.fromBigInteger(O),F)}function Qb(s){if(this.isInfinity())return this;if(s.signum()==0)return this.curve.getInfinity();var c=s,l=c.multiply(new _("3")),d=this.negate(),g=this,m=this.curve.q.subtract(s),T=m.multiply(new _("3")),k=new ct(this.curve,this.x,this.y),O=k.negate(),F;for(F=l.bitLength()-2;F>0;--F){g=g.twice();var U=l.testBit(F),L=c.testBit(F);U!=L&&(g=g.add(U?this:d))}for(F=T.bitLength()-2;F>0;--F){k=k.twice();var P=T.testBit(F),D=m.testBit(F);P!=D&&(k=k.add(P?k:O))}return g}function Xb(s,c,l){var d;s.bitLength()>l.bitLength()?d=s.bitLength()-1:d=l.bitLength()-1;for(var g=this.curve.getInfinity(),m=this.add(c);d>=0;)g=g.twice(),s.testBit(d)?l.testBit(d)?g=g.add(m):g=g.add(this):l.testBit(d)&&(g=g.add(c)),--d;return g}ct.prototype.getX=bt,ct.prototype.getY=Mt,ct.prototype.equals=Bt,ct.prototype.isInfinity=kt,ct.prototype.negate=Lt,ct.prototype.add=Ut,ct.prototype.twice=Ts,ct.prototype.multiply=Qb,ct.prototype.multiplyTwo=Xb;function rs(s,c,l){this.q=s,this.a=this.fromBigInteger(c),this.b=this.fromBigInteger(l),this.infinity=new ct(this,null,null)}function Yb(){return this.q}function e2(){return this.a}function t2(){return this.b}function n2(s){return s==this?!0:this.q.equals(s.q)&&this.a.equals(s.a)&&this.b.equals(s.b)}function r2(){return this.infinity}function i2(s){return new st(this.q,s)}function s2(s){switch(parseInt(s.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var c=s.substr(0,2);s.substr(2);var l=this.fromBigInteger(new _(O,16)),d=this.getA(),g=this.getB(),m=l.square().add(d).multiply(l).add(g),T=m.sqrt();return c=="03"&&(T=T.negate()),new ct(this,l,T);case 4:case 6:case 7:var k=(s.length-2)/2,O=s.substr(2,k),F=s.substr(k+2,k);return new ct(this,this.fromBigInteger(new _(O,16)),this.fromBigInteger(new _(F,16)));default:return null}}rs.prototype.getQ=Yb,rs.prototype.getA=e2,rs.prototype.getB=t2,rs.prototype.equals=n2,rs.prototype.getInfinity=r2,rs.prototype.fromBigInteger=i2,rs.prototype.decodePointHex=s2,st.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ct.prototype.getEncoded=function(s){var c=function(m,T){var k=m.toByteArrayUnsigned();if(T<k.length)k=k.slice(k.length-T);else for(;T>k.length;)k.unshift(0);return k},l=this.getX().toBigInteger(),d=this.getY().toBigInteger(),g=c(l,32);return s?d.isEven()?g.unshift(2):g.unshift(3):(g.unshift(4),g=g.concat(c(d,32))),g},ct.decodeFrom=function(s,c){c[0];var l=c.length-1,d=c.slice(1,1+l/2),g=c.slice(1+l/2,1+l);d.unshift(0),g.unshift(0);var m=new _(d),T=new _(g);return new ct(s,s.fromBigInteger(m),s.fromBigInteger(T))},ct.decodeFromHex=function(s,c){c.substr(0,2);var l=c.length-2,d=c.substr(2,l/2),g=c.substr(2+l/2,l/2),m=new _(d,16),T=new _(g,16);return new ct(s,s.fromBigInteger(m),s.fromBigInteger(T))},ct.prototype.add2D=function(s){if(this.isInfinity())return s;if(s.isInfinity())return this;if(this.x.equals(s.x))return this.y.equals(s.y)?this.twice():this.curve.getInfinity();var c=s.x.subtract(this.x),l=s.y.subtract(this.y),d=l.divide(c),g=d.square().subtract(this.x).subtract(s.x),m=d.multiply(this.x.subtract(g)).subtract(this.y);return new ct(this.curve,g,m)},ct.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var s=this.curve.fromBigInteger(_.valueOf(2)),c=this.curve.fromBigInteger(_.valueOf(3)),l=this.x.square().multiply(c).add(this.curve.a).divide(this.y.multiply(s)),d=l.square().subtract(this.x.multiply(s)),g=l.multiply(this.x.subtract(d)).subtract(this.y);return new ct(this.curve,d,g)},ct.prototype.multiply2D=function(s){if(this.isInfinity())return this;if(s.signum()==0)return this.curve.getInfinity();var c=s,l=c.multiply(new _("3")),d=this.negate(),g=this,m;for(m=l.bitLength()-2;m>0;--m){g=g.twice();var T=l.testBit(m),k=c.testBit(m);T!=k&&(g=g.add2D(T?this:d))}return g},ct.prototype.isOnCurve=function(){var s=this.getX().toBigInteger(),c=this.getY().toBigInteger(),l=this.curve.getA().toBigInteger(),d=this.curve.getB().toBigInteger(),g=this.curve.getQ(),m=c.multiply(c).mod(g),T=s.multiply(s).multiply(s).add(l.multiply(s)).add(d).mod(g);return m.equals(T)},ct.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ct.prototype.validate=function(){var s=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var c=this.getX().toBigInteger(),l=this.getY().toBigInteger();if(c.compareTo(_.ONE)<0||c.compareTo(s.subtract(_.ONE))>0)throw new Error("x coordinate out of bounds");if(l.compareTo(_.ONE)<0||l.compareTo(s.subtract(_.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(s).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var ag=function(){var s="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",c='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',l='(?:"'+c+'*")',d=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+s+"|"+l+")","g"),g=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),m={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function T(U,L,P){return L?m[L]:String.fromCharCode(parseInt(P,16))}var k=new String(""),O="\\",F=Object.hasOwnProperty;return function(U,L){var P=U.match(d),D,A=P[0],N=!1;A==="{"?D={}:A==="["?D=[]:(D=[],N=!0);for(var j,W=[D],se=1-N,he=P.length;se<he;++se){A=P[se];var de;switch(A.charCodeAt(0)){default:de=W[0],de[j||de.length]=+A,j=void 0;break;case 34:if(A=A.substring(1,A.length-1),A.indexOf(O)!==-1&&(A=A.replace(g,T)),de=W[0],!j)if(de instanceof Array)j=de.length;else{j=A||k;break}de[j]=A,j=void 0;break;case 91:de=W[0],W.unshift(de[j||de.length]=[]),j=void 0;break;case 93:W.shift();break;case 102:de=W[0],de[j||de.length]=!1,j=void 0;break;case 110:de=W[0],de[j||de.length]=null,j=void 0;break;case 116:de=W[0],de[j||de.length]=!0,j=void 0;break;case 123:de=W[0],W.unshift(de[j||de.length]={}),j=void 0;break;case 125:W.shift();break}}if(N){if(W.length!==1)throw new Error;D=D[0]}else if(W.length)throw new Error;if(L){var fe=function(G,Q){var te=G[Q];if(te&&typeof te=="object"){var J=null;for(var re in te)if(F.call(te,re)&&te!==G){var pe=fe(te,re);pe!==void 0?te[re]=pe:(J||(J=[]),J.push(re))}if(J)for(var be=J.length;--be>=0;)delete te[J[be]]}return L.call(G,Q,te)};D=fe({"":D},"")}return D}}();(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),y.asn1.ASN1Util=new function(){this.integerToByteHex=function(s){var c=s.toString(16);return c.length%2==1&&(c="0"+c),c},this.bigIntToMinTwosComplementsHex=function(s){return rc(s)},this.getPEMStringFromHex=function(s,c){return nr(s,c)},this.newObject=function(s){var c=y,l=c.asn1,d=l.ASN1Object,g=l.DERBoolean,m=l.DERInteger,T=l.DERBitString,k=l.DEROctetString,O=l.DERNull,F=l.DERObjectIdentifier,U=l.DEREnumerated,L=l.DERUTF8String,P=l.DERNumericString,D=l.DERPrintableString,A=l.DERTeletexString,N=l.DERIA5String,j=l.DERUTCTime,W=l.DERGeneralizedTime,se=l.DERVisibleString,he=l.DERBMPString,de=l.DERSequence,fe=l.DERSet,G=l.DERTaggedObject,Q=l.ASN1Util.newObject;if(s instanceof l.ASN1Object)return s;var te=Object.keys(s);if(te.length!=1)throw new Error("key of param shall be only one.");var J=te[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+J+":")==-1)throw new Error("undefined key: "+J);if(J=="bool")return new g(s[J]);if(J=="int")return new m(s[J]);if(J=="bitstr")return new T(s[J]);if(J=="octstr")return new k(s[J]);if(J=="null")return new O(s[J]);if(J=="oid")return new F(s[J]);if(J=="enum")return new U(s[J]);if(J=="utf8str")return new L(s[J]);if(J=="numstr")return new P(s[J]);if(J=="prnstr")return new D(s[J]);if(J=="telstr")return new A(s[J]);if(J=="ia5str")return new N(s[J]);if(J=="utctime")return new j(s[J]);if(J=="gentime")return new W(s[J]);if(J=="visstr")return new se(s[J]);if(J=="bmpstr")return new he(s[J]);if(J=="asn1")return new d(s[J]);if(J=="seq"){for(var re=s[J],pe=[],be=0;be<re.length;be++){var Fe=Q(re[be]);pe.push(Fe)}return new de({array:pe})}if(J=="set"){for(var re=s[J],pe=[],be=0;be<re.length;be++){var Fe=Q(re[be]);pe.push(Fe)}return new fe({array:pe})}if(J=="tag"){var ve=s[J];if(Object.prototype.toString.call(ve)==="[object Array]"&&ve.length==3){var Ce=Q(ve[2]);return new G({tag:ve[0],explicit:ve[1],obj:Ce})}else return new G(ve)}},this.jsonToASN1HEX=function(s){var c=this.newObject(s);return c.tohex()}},y.asn1.ASN1Util.oidHexToInt=function(s){for(var g="",c=parseInt(s.substr(0,2),16),l=Math.floor(c/40),d=c%40,g=l+"."+d,m="",T=2;T<s.length;T+=2){var k=parseInt(s.substr(T,2),16),O=("00000000"+k.toString(2)).slice(-8);if(m=m+O.substr(1,7),O.substr(0,1)=="0"){var F=new _(m,2);g=g+"."+F.toString(10),m=""}}return g},y.asn1.ASN1Util.oidIntToHex=function(s){var c=function(k){var O=k.toString(16);return O.length==1&&(O="0"+O),O},l=function(k){var O="",F=new _(k,10),U=F.toString(2),L=7-U.length%7;L==7&&(L=0);for(var P="",D=0;D<L;D++)P+="0";U=P+U;for(var D=0;D<U.length-1;D+=7){var A=U.substr(D,7);D!=U.length-7&&(A="1"+A),O+=c(parseInt(A,2))}return O};if(!s.match(/^[0-9.]+$/))throw"malformed oid string: "+s;var d="",g=s.split("."),m=parseInt(g[0])*40+parseInt(g[1]);d+=c(m),g.splice(0,2);for(var T=0;T<g.length;T++)d+=l(g[T]);return d},y.asn1.ASN1Object=function(s){var c="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+c.length+",v="+this.hV);var l=this.hV.length/2,d=l.toString(16);if(d.length%2==1&&(d="0"+d),l<128)return d;var g=d.length/2;if(g>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+l.toString(16));var m=128+g;return m.toString(16)+d},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(l){this.params=l},s!=null&&s.tlv!=null&&(this.hTLV=s.tlv,this.isModified=!1)},y.asn1.DERAbstractString=function(s){y.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(c){this.hTLV=null,this.isModified=!0,this.s=c,this.hV=Hl(this.s).toLowerCase()},this.setStringHex=function(c){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=c},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s=="string"?this.setString(s):typeof s.str<"u"?this.setString(s.str):typeof s.hex<"u"&&this.setStringHex(s.hex))},Ie(y.asn1.DERAbstractString,y.asn1.ASN1Object),y.asn1.DERAbstractTime=function(s){y.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(c){var l=c.getTime()+c.getTimezoneOffset()*6e4,d=new Date(l);return d},this.formatDate=function(c,l,d){var g=this.zeroPadding,m=this.localDateToUTC(c),T=String(m.getFullYear());l=="utc"&&(T=T.substr(2,2));var k=g(String(m.getMonth()+1),2),O=g(String(m.getDate()),2),F=g(String(m.getHours()),2),U=g(String(m.getMinutes()),2),L=g(String(m.getSeconds()),2),P=T+k+O+F+U+L;if(d===!0){var D=m.getMilliseconds();if(D!=0){var A=g(String(D),3);A=A.replace(/[0]+$/,""),P=P+"."+A}}return P+"Z"},this.zeroPadding=function(c,l){return c.length>=l?c:new Array(l-c.length+1).join("0")+c},this.setByParam=function(c){this.hV=null,this.hTLV=null,this.params=c},this.getString=function(){},this.setString=function(c){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=c},this.setByDate=function(c){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=c},this.setByDateValue=function(c,l,d,g,m,T){var k=new Date(Date.UTC(c,l-1,d,g,m,T,0));this.setByDate(k)},this.getFreshValueHex=function(){return this.hV}},Ie(y.asn1.DERAbstractTime,y.asn1.ASN1Object),y.asn1.DERAbstractStructured=function(s){y.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array=c},this.appendASN1Object=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array.push(c)},this.asn1Array=new Array,typeof s<"u"&&typeof s.array<"u"&&(this.asn1Array=s.array)},Ie(y.asn1.DERAbstractStructured,y.asn1.ASN1Object),y.asn1.DERBoolean=function(s){y.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",s==!1?this.hTLV="010100":this.hTLV="0101ff"},Ie(y.asn1.DERBoolean,y.asn1.ASN1Object),y.asn1.DERInteger=function(s){y.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var c=rc;this.setByBigInteger=function(l){this.isModified=!0,this.params={bigint:l}},this.setByInteger=function(l){this.isModified=!0,this.params=l},this.setValueHex=function(l){this.isModified=!0,this.params={hex:l}},this.getFreshValueHex=function(){var l=this.params,d=null;if(l==null)throw new Error("value not set");if(typeof l=="object"&&l.hex!=null)return this.hV=l.hex,this.hV;if(typeof l=="number")d=new _(String(l),10);else if(l.int!=null)d=new _(String(l.int),10);else if(l.bigint!=null)d=l.bigint;else throw new Error("wrong parameter");return this.hV=c(d),this.hV},s!=null&&(this.params=s)},Ie(y.asn1.DERInteger,y.asn1.ASN1Object),y.asn1.DERBitString=function(s){if(s!==void 0&&typeof s.obj<"u"){var c=y.asn1.ASN1Util.newObject(s.obj);s.hex="00"+c.tohex()}y.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(l){this.hTLV=null,this.isModified=!0,this.hV=l},this.setUnusedBitsAndHexValue=function(l,d){if(l<0||7<l)throw"unused bits shall be from 0 to 7: u = "+l;var g="0"+l;this.hTLV=null,this.isModified=!0,this.hV=g+d},this.setByBinaryString=function(l){l=l.replace(/0+$/,"");var d=8-l.length%8;d==8&&(d=0),l+="0000000".substr(0,d);for(var g="",m=0;m<l.length-1;m+=8){var T=l.substr(m,8),k=parseInt(T,2).toString(16);k.length==1&&(k="0"+k),g+=k}this.hTLV=null,this.isModified=!0,this.hV="0"+d+g},this.setByBooleanArray=function(l){for(var d="",g=0;g<l.length;g++)l[g]==!0?d+="1":d+="0";this.setByBinaryString(d)},this.newFalseArray=function(l){for(var d=new Array(l),g=0;g<l;g++)d[g]=!1;return d},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s=="string"&&s.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(s):typeof s.hex<"u"?this.setHexValueIncludingUnusedBits(s.hex):typeof s.bin<"u"?this.setByBinaryString(s.bin):typeof s.array<"u"&&this.setByBooleanArray(s.array))},Ie(y.asn1.DERBitString,y.asn1.ASN1Object),y.asn1.DEROctetString=function(s){if(s!==void 0&&typeof s.obj<"u"){var c=y.asn1.ASN1Util.newObject(s.obj);s.hex=c.tohex()}y.asn1.DEROctetString.superclass.constructor.call(this,s),this.hT="04"},Ie(y.asn1.DEROctetString,y.asn1.DERAbstractString),y.asn1.DERNull=function(){y.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Ie(y.asn1.DERNull,y.asn1.ASN1Object),y.asn1.DERObjectIdentifier=function(s){y.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(c){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=c},this.setValueOidString=function(c){var l=mg(c);if(l==null)throw new Error("malformed oid string: "+c);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=l},this.setValueName=function(c){var l=y.asn1.x509.OID.name2oid(c);if(l!=="")this.setValueOidString(l);else throw new Error("DERObjectIdentifier oidName undefined: "+c)},this.setValueNameOrOid=function(c){c.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(c):this.setValueName(c)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(c){typeof c=="string"?this.setValueNameOrOid(c):c.oid!==void 0?this.setValueNameOrOid(c.oid):c.name!==void 0?this.setValueNameOrOid(c.name):c.hex!==void 0&&this.setValueHex(c.hex)},s!==void 0&&this.setByParam(s)},Ie(y.asn1.DERObjectIdentifier,y.asn1.ASN1Object),y.asn1.DEREnumerated=function(s){y.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(c){this.hTLV=null,this.isModified=!0,this.hV=rc(c)},this.setByInteger=function(c){var l=new _(String(c),10);this.setByBigInteger(l)},this.setValueHex=function(c){this.hV=c},this.getFreshValueHex=function(){return this.hV},typeof s<"u"&&(typeof s.int<"u"?this.setByInteger(s.int):typeof s=="number"?this.setByInteger(s):typeof s.hex<"u"&&this.setValueHex(s.hex))},Ie(y.asn1.DEREnumerated,y.asn1.ASN1Object),y.asn1.DERUTF8String=function(s){y.asn1.DERUTF8String.superclass.constructor.call(this,s),this.hT="0c"},Ie(y.asn1.DERUTF8String,y.asn1.DERAbstractString),y.asn1.DERNumericString=function(s){y.asn1.DERNumericString.superclass.constructor.call(this,s),this.hT="12"},Ie(y.asn1.DERNumericString,y.asn1.DERAbstractString),y.asn1.DERPrintableString=function(s){y.asn1.DERPrintableString.superclass.constructor.call(this,s),this.hT="13"},Ie(y.asn1.DERPrintableString,y.asn1.DERAbstractString),y.asn1.DERTeletexString=function(s){y.asn1.DERTeletexString.superclass.constructor.call(this,s),this.hT="14"},Ie(y.asn1.DERTeletexString,y.asn1.DERAbstractString),y.asn1.DERIA5String=function(s){y.asn1.DERIA5String.superclass.constructor.call(this,s),this.hT="16"},Ie(y.asn1.DERIA5String,y.asn1.DERAbstractString),y.asn1.DERVisibleString=function(s){y.asn1.DERIA5String.superclass.constructor.call(this,s),this.hT="1a"},Ie(y.asn1.DERVisibleString,y.asn1.DERAbstractString),y.asn1.DERBMPString=function(s){y.asn1.DERBMPString.superclass.constructor.call(this,s),this.hT="1e"},Ie(y.asn1.DERBMPString,y.asn1.DERAbstractString),y.asn1.DERUTCTime=function(s){y.asn1.DERUTCTime.superclass.constructor.call(this,s),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var c=this.params;if(this.params==null&&(c={date:new Date}),typeof c=="string")if(c.match(/^[0-9]{12}Z$/)||c.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=kr(c);else throw new Error("malformed string for UTCTime: "+c);else if(c.str!=null)this.hV=kr(c.str);else if(c.date==null&&c.millis==!0){var l=new Date;this.hV=kr(this.formatDate(l,"utc",!0))}else if(c.date!=null&&c.date instanceof Date){var d=c.millis===!0;this.hV=kr(this.formatDate(c.date,"utc",d))}else c instanceof Date&&(this.hV=kr(this.formatDate(c,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},s!=null&&this.setByParam(s)},Ie(y.asn1.DERUTCTime,y.asn1.DERAbstractTime),y.asn1.DERGeneralizedTime=function(s){y.asn1.DERGeneralizedTime.superclass.constructor.call(this,s),this.hT="18",this.params=s,this.getFreshValueHex=function(){var c=this.params;if(this.params==null&&(c={date:new Date}),typeof c=="string")if(c.match(/^[0-9]{14}Z$/)||c.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=kr(c);else throw new Error("malformed string for GeneralizedTime: "+c);else if(c.str!=null)this.hV=kr(c.str);else if(c.date==null&&c.millis==!0){var l=new Date;this.hV=kr(this.formatDate(l,"gen",!0))}else if(c.date!=null&&c.date instanceof Date){var d=c.millis===!0;this.hV=kr(this.formatDate(c.date,"gen",d))}else c instanceof Date&&(this.hV=kr(this.formatDate(c,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},s!=null&&this.setByParam(s)},Ie(y.asn1.DERGeneralizedTime,y.asn1.DERAbstractTime),y.asn1.DERSequence=function(s){y.asn1.DERSequence.superclass.constructor.call(this,s),this.hT="30",this.getFreshValueHex=function(){for(var c="",l=0;l<this.asn1Array.length;l++){var d=this.asn1Array[l];c+=d.tohex()}return this.hV=c,this.hV}},Ie(y.asn1.DERSequence,y.asn1.DERAbstractStructured),y.asn1.DERSet=function(s){y.asn1.DERSet.superclass.constructor.call(this,s),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var c=new Array,l=0;l<this.asn1Array.length;l++){var d=this.asn1Array[l];c.push(d.tohex())}return this.sortFlag==!0&&c.sort(),this.hV=c.join(""),this.hV},typeof s<"u"&&typeof s.sortflag<"u"&&s.sortflag==!1&&(this.sortFlag=!1)},Ie(y.asn1.DERSet,y.asn1.DERAbstractStructured),y.asn1.DERTaggedObject=function(s){y.asn1.DERTaggedObject.superclass.constructor.call(this);var c=y.asn1,l=je,d=l.getV;l.isASN1HEX;var g=c.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(m,T,k){this.params={tag:T,explicit:m,obj:k}},this.getFreshValueHex=function(){var m=this.params;if(m.explicit==null&&(m.explicit=!0),m.tage!=null&&(m.tag=m.tage,m.explicit=!0),m.tagi!=null&&(m.tag=m.tagi,m.explicit=!1),m.str!=null)this.hV=Hl(m.str);else if(m.hex!=null)this.hV=m.hex;else if(m.obj!=null){var T;m.obj instanceof c.ASN1Object?T=m.obj.tohex():typeof m.obj=="object"&&(T=g(m.obj).tohex()),m.explicit?this.hV=T:this.hV=d(T,0)}else throw new Error("str, hex nor obj not specified");return m.tag==null&&(m.tag="a0"),this.hT=m.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(m){this.params=m},s!==void 0&&this.setByParam(s)},Ie(y.asn1.DERTaggedObject,y.asn1.ASN1Object);var je=new function(){};je.getLblen=function(s,c){if(s.substr(c+2,1)!="8")return 1;var l=parseInt(s.substr(c+3,1));return l==0?-1:0<l&&l<10?l+1:-2},je.getL=function(s,c){var l=je.getLblen(s,c);return l<1?"":s.substr(c+2,l*2)},je.getVblen=function(s,c){var l,d;return l=je.getL(s,c),l==""?-1:(l.substr(0,1)==="8"?d=new _(l.substr(2),16):d=new _(l,16),d.intValue())},je.getVidx=function(s,c){var l=je.getLblen(s,c);return l<0?l:c+(l+1)*2},je.getV=function(s,c){var l=je.getVidx(s,c),d=je.getVblen(s,c);return s.substr(l,d*2)},je.getTLV=function(s,c){return s.substr(c,2)+je.getL(s,c)+je.getV(s,c)},je.getTLVblen=function(s,c){return 2+je.getLblen(s,c)*2+je.getVblen(s,c)*2},je.getNextSiblingIdx=function(s,c){var l=je.getVidx(s,c),d=je.getVblen(s,c);return l+d*2},je.getChildIdx=function(s,c){var l=je,d=[],g,m,T;g=l.getVidx(s,c),m=l.getVblen(s,c)*2,s.substr(c,2)=="03"&&(g+=2,m-=2),T=0;for(var k=g;T<=m;){var O=l.getTLVblen(s,k);if(T+=O,T<=m&&d.push(k),k+=O,T>=m)break}return d},je.getNthChildIdx=function(s,c,l){var d=je.getChildIdx(s,c);return d[l]},je.getIdxbyList=function(s,c,l,d){var g=je,m,T;return l.length==0?d!==void 0&&s.substr(c,2)!==d?-1:c:(m=l.shift(),T=g.getChildIdx(s,c),m>=T.length?-1:g.getIdxbyList(s,T[m],l,d))},je.getIdxbyListEx=function(s,c,l,d){var g=je,m,T;if(l.length==0)return d!==void 0&&s.substr(c,2)!==d?-1:c;m=l.shift(),T=g.getChildIdx(s,c);for(var k=0,O=0;O<T.length;O++){var F=s.substr(T[O],2);if(typeof m=="number"&&!g.isContextTag(F)&&k==m||typeof m=="string"&&g.isContextTag(F,m))return g.getIdxbyListEx(s,T[O],l,d);g.isContextTag(F)||k++}return-1},je.getTLVbyList=function(s,c,l,d){var g=je,m=g.getIdxbyList(s,c,l,d);return m==-1||m>=s.length?null:g.getTLV(s,m)},je.getTLVbyListEx=function(s,c,l,d){var g=je,m=g.getIdxbyListEx(s,c,l,d);return m==-1?null:g.getTLV(s,m)},je.getVbyList=function(s,c,l,d,g){var m=je,T,k;return T=m.getIdxbyList(s,c,l,d),T==-1||T>=s.length?null:(k=m.getV(s,T),g===!0&&(k=k.substr(2)),k)},je.getVbyListEx=function(s,c,l,d,g){var m=je,T,k;return T=m.getIdxbyListEx(s,c,l,d),T==-1?null:(k=m.getV(s,T),s.substr(T,2)=="03"&&g!==!1&&(k=k.substr(2)),k)},je.getInt=function(s,c,l){l==null&&(l=-1);try{var d=s.substr(c,2);if(d!="02"&&d!="03")return l;var g=je.getV(s,c);return d=="02"?parseInt(g,16):vg(g)}catch{return l}},je.getOID=function(s,c,l){l==null&&(l=null);try{if(s.substr(c,2)!="06")return l;var d=je.getV(s,c);return Wl(d)}catch{return l}},je.getOIDName=function(s,c,l){l==null&&(l=null);try{var d=je.getOID(s,c,l);if(d==l)return l;var g=y.asn1.x509.OID.oid2name(d);return g==""?d:g}catch{return l}},je.getString=function(s,c,l){l==null&&(l=null);try{var d=je.getV(s,c);return Tr(d)}catch{return l}},je.hextooidstr=function(s){var c=function(L,P){return L.length>=P?L:new Array(P-L.length+1).join("0")+L},l=[],d=s.substr(0,2),g=parseInt(d,16);l[0]=new String(Math.floor(g/40)),l[1]=new String(g%40);for(var m=s.substr(2),T=[],k=0;k<m.length/2;k++)T.push(parseInt(m.substr(k*2,2),16));for(var O=[],F="",k=0;k<T.length;k++)T[k]&128?F=F+c((T[k]&127).toString(2),7):(F=F+c((T[k]&127).toString(2),7),O.push(new String(parseInt(F,2))),F="");var U=l.join(".");return O.length>0&&(U=U+"."+O.join(".")),U},je.dump=function(s,c,l,d){var g=je,m=g.getV,T=g.dump,k=g.getChildIdx,O=s;s instanceof y.asn1.ASN1Object&&(O=s.tohex());var F=function(Q,te){if(Q.length<=te*2)return Q;var J=Q.substr(0,te)+"..(total "+Q.length/2+"bytes).."+Q.substr(Q.length-te,te);return J};c===void 0&&(c={ommit_long_octet:32}),l===void 0&&(l=0),d===void 0&&(d="");var U=c.ommit_long_octet,fe=O.substr(l,2);if(fe=="01"){var L=m(O,l);return L=="00"?d+`BOOLEAN FALSE
`:d+`BOOLEAN TRUE
`}if(fe=="02"){var L=m(O,l);return d+"INTEGER "+F(L,U)+`
`}if(fe=="03"){var L=m(O,l);if(g.isASN1HEX(L.substr(2))){var P=d+`BITSTRING, encapsulates
`;return P=P+T(L.substr(2),c,0,d+"  "),P}else return d+"BITSTRING "+F(L,U)+`
`}if(fe=="04"){var L=m(O,l);if(g.isASN1HEX(L)){var P=d+`OCTETSTRING, encapsulates
`;return P=P+T(L,c,0,d+"  "),P}else return d+"OCTETSTRING "+F(L,U)+`
`}if(fe=="05")return d+`NULL
`;if(fe=="06"){var D=m(O,l),A=y.asn1.ASN1Util.oidHexToInt(D),N=y.asn1.x509.OID.oid2name(A),j=A.replace(/\./g," ");return N!=""?d+"ObjectIdentifier "+N+" ("+j+`)
`:d+"ObjectIdentifier ("+j+`)
`}if(fe=="0a")return d+"ENUMERATED "+parseInt(m(O,l))+`
`;if(fe=="0c")return d+"UTF8String '"+Jt(m(O,l))+`'
`;if(fe=="13")return d+"PrintableString '"+Jt(m(O,l))+`'
`;if(fe=="14")return d+"TeletexString '"+Jt(m(O,l))+`'
`;if(fe=="16")return d+"IA5String '"+Jt(m(O,l))+`'
`;if(fe=="17")return d+"UTCTime "+Jt(m(O,l))+`
`;if(fe=="18")return d+"GeneralizedTime "+Jt(m(O,l))+`
`;if(fe=="1a")return d+"VisualString '"+Jt(m(O,l))+`'
`;if(fe=="1e")return d+"BMPString '"+Bh(m(O,l))+`'
`;if(fe=="30"){if(O.substr(l,4)=="3000")return d+`SEQUENCE {}
`;var P=d+`SEQUENCE
`,W=k(O,l),se=c;if((W.length==2||W.length==3)&&O.substr(W[0],2)=="06"&&O.substr(W[W.length-1],2)=="04"){var N=g.oidname(m(O,W[0])),he=JSON.parse(JSON.stringify(c));he.x509ExtName=N,se=he}for(var de=0;de<W.length;de++)P=P+T(O,se,W[de],d+"  ");return P}if(fe=="31"){for(var P=d+`SET
`,W=k(O,l),de=0;de<W.length;de++)P=P+T(O,c,W[de],d+"  ");return P}var fe=parseInt(fe,16);if(fe&128){var G=fe&31;if(fe&32){for(var P=d+"["+G+`]
`,W=k(O,l),de=0;de<W.length;de++)P=P+T(O,c,W[de],d+"  ");return P}else{var L=m(O,l);if(je.isASN1HEX(L)){var P=d+"["+G+`]
`;return P=P+T(L,c,0,d+"  "),P}else(L.substr(0,8)=="68747470"||c.x509ExtName==="subjectAltName"&&G==2)&&(L=Jt(L));var P=d+"["+G+"] "+L+`
`;return P}}return d+"UNKNOWN("+fe+") "+m(O,l)+`
`},je.parse=function(s){var c=je,l=c.parse,d=c.isASN1HEX,g=c.getV,m=c.getTLV,T=c.getChildIdx,k=y.asn1,O=k.ASN1Util.oidHexToInt,F=k.x509.OID.oid2name,U=Jt,L=Bh,P=d2,D={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},A=function(J){for(var re=[],pe=T(J,0),be=0;be<pe.length;be++){var Fe=pe[be],ve=m(J,Fe),Ce=l(ve);re.push(Ce)}return re},N=s.substr(0,2),j={},W=g(s,0);if(N=="01")return s=="0101ff"?{bool:!0}:{bool:!1};if(N=="02")return{int:{hex:W}};if(N=="03")try{if(W.substr(0,2)!="00")throw"not encap";var se=W.substr(2);if(!d(se))throw"not encap";return{bitstr:{obj:l(se)}}}catch{var he=null;return W.length<=10&&(he=_g(W)),he==null?{bitstr:{hex:W}}:{bitstr:{bin:he}}}else if(N=="04")try{if(!d(W))throw"not encap";return{octstr:{obj:l(W)}}}catch{return{octstr:{hex:W}}}else{if(N=="05")return{null:""};if(N=="06"){var de=O(W),fe=F(de);return fe==""?{oid:de}:{oid:fe}}else{if(N=="0a")return W.length>4?{enum:{hex:W}}:{enum:parseInt(W,16)};if(N=="30"||N=="31")return j[D[N]]=A(s),j;if(N=="14"){var G=P(W);return j[D[N]]={str:G},j}else if(N=="1e"){var G=L(W);return j[D[N]]={str:G},j}else if(":0c:12:13:16:17:18:1a:".indexOf(N)!=-1){var G=U(W);return j[D[N]]={str:G},j}else if(N.match(/^8[0-9]$/)){var G=U(W);return G==null|G==""?{tag:{tag:N,explicit:!1,hex:W}}:G.match(/[\x00-\x1F\x7F-\x9F]/)!=null||G.match(/[\u0000-\u001F\u0080\u009F]/)!=null?{tag:{tag:N,explicit:!1,hex:W}}:{tag:{tag:N,explicit:!1,str:G}}}else if(N.match(/^a[0-9]$/))try{if(!d(W))throw new Error("not encap");return{tag:{tag:N,explicit:!0,obj:l(W)}}}catch{return{tag:{tag:N,explicit:!0,hex:W}}}else{var Q=new y.asn1.ASN1Object;Q.hV=W;var te=Q.getLengthHexFromValue();return{asn1:{tlv:N+te+W}}}}}},je.isContextTag=function(s,c){s=s.toLowerCase();var l,d;try{l=parseInt(s,16)}catch{return-1}if(c===void 0)return(l&192)==128;try{var g=c.match(/^\[[0-9]+\]$/);return g==null||(d=parseInt(c.substr(1,c.length-1),10),d>31)?!1:(l&192)==128&&(l&31)==d}catch{return!1}},je.isASN1HEX=function(s){var c=je;if(s.length%2==1)return!1;var l=c.getVblen(s,0),d=s.substr(0,2),g=c.getL(s,0),m=s.length-d.length-g.length;return m==l*2},je.checkStrictDER=function(s,c,l,d,g){var m=je;if(l===void 0){if(typeof s!="string")throw new Error("not hex string");if(s=s.toLowerCase(),!y.lang.String.isHex(s))throw new Error("not hex string");l=s.length,d=s.length/2,d<128?g=1:g=Math.ceil(d.toString(16))+1}var T=m.getL(s,c);if(T.length>g*2)throw new Error("L of TLV too long: idx="+c);var k=m.getVblen(s,c);if(k>d)throw new Error("value of L too long than hex: idx="+c);var O=m.getTLV(s,c),F=O.length-2-m.getL(s,c).length;if(F!==k*2)throw new Error("V string length and L's value not the same:"+F+"/"+k*2);if(c===0&&s.length!=O.length)throw new Error("total length and TLV length unmatch:"+s.length+"!="+O.length);var U=s.substr(c,2);if(U==="02"){var L=m.getVidx(s,c);if(s.substr(L,2)=="00"&&s.charCodeAt(L+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(U,16)&32){for(var P=m.getVblen(s,c),D=0,A=m.getChildIdx(s,c),N=0;N<A.length;N++){var j=m.getTLV(s,A[N]);D+=j.length,m.checkStrictDER(s,A[N],l,d,g)}if(P*2!=D)throw new Error("sum of children's TLV length and L unmatch: "+P*2+"!="+D)}},je.oidname=function(s){var c=y.asn1;y.lang.String.isHex(s)&&(s=c.ASN1Util.oidHexToInt(s));var l=c.x509.OID.oid2name(s);return l===""&&(l=s),l},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.x509>"u"||!y.asn1.x509)&&(y.asn1.x509={}),y.asn1.x509.Certificate=function(s){y.asn1.x509.Certificate.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERBitString,g=l.DERSequence,m=l.x509,T=m.TBSCertificate,k=m.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(O){this.params=O},this.sign=function(){var O=this.params,F=O.sigalg;O.sigalg.name!=null&&(F=O.sigalg.name);var U=O.tbsobj.tohex(),L=new y.crypto.Signature({alg:F});L.init(O.cakey),L.updateHex(U),O.sighex=L.sign()},this.getPEM=function(){return nr(this.tohex(),"CERTIFICATE")},this.tohex=function(){var O=this.params;if((O.tbsobj==null||O.tbsobj==null)&&(O.tbsobj=new T(O)),O.sighex==null&&O.cakey!=null&&this.sign(),O.sighex==null)throw new Error("sighex or cakey parameter not defined");var F=[];F.push(O.tbsobj),F.push(new k({name:O.sigalg})),F.push(new d({hex:"00"+O.sighex}));var U=new g({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&(this.params=s)},Ie(y.asn1.x509.Certificate,y.asn1.ASN1Object),y.asn1.x509.TBSCertificate=function(s){y.asn1.x509.TBSCertificate.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509,g=l.DERTaggedObject,m=l.DERInteger,T=l.DERSequence,k=d.AlgorithmIdentifier,O=d.Time,F=d.X500Name,U=d.Extensions,L=d.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(P){this.params=P},this.tohex=function(){var P=[],D=this.params;if(D.version!=null||D.version!=1){var A=2;D.version!=null&&(A=D.version-1);var N=new g({obj:new m({int:A})});P.push(N)}P.push(new m(D.serial)),P.push(new k({name:D.sigalg})),P.push(new F(D.issuer)),P.push(new T({array:[new O(D.notbefore),new O(D.notafter)]})),P.push(new F(D.subject)),P.push(new L(Nt.getKey(D.sbjpubkey))),D.ext!==void 0&&D.ext.length>0&&P.push(new g({tag:"a3",obj:new U(D.ext)}));var j=new y.asn1.DERSequence({array:P});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.TBSCertificate,y.asn1.ASN1Object),y.asn1.x509.Extensions=function(s){y.asn1.x509.Extensions.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERSequence,g=l.x509;this.aParam=[],this.setByParam=function(m){this.aParam=m},this.tohex=function(){for(var m=[],T=0;T<this.aParam.length;T++){var k=this.aParam[T],O=k.extname,F=null;if(k.extn!=null)F=new g.PrivateExtension(k);else if(O=="subjectKeyIdentifier")F=new g.SubjectKeyIdentifier(k);else if(O=="keyUsage")F=new g.KeyUsage(k);else if(O=="subjectAltName")F=new g.SubjectAltName(k);else if(O=="issuerAltName")F=new g.IssuerAltName(k);else if(O=="basicConstraints")F=new g.BasicConstraints(k);else if(O=="nameConstraints")F=new g.NameConstraints(k);else if(O=="cRLDistributionPoints")F=new g.CRLDistributionPoints(k);else if(O=="certificatePolicies")F=new g.CertificatePolicies(k);else if(O=="policyMappings")F=new g.PolicyMappings(k);else if(O=="policyConstraints")F=new g.PolicyConstraints(k);else if(O=="inhibitAnyPolicy")F=new g.InhibitAnyPolicy(k);else if(O=="authorityKeyIdentifier")F=new g.AuthorityKeyIdentifier(k);else if(O=="extKeyUsage")F=new g.ExtKeyUsage(k);else if(O=="authorityInfoAccess")F=new g.AuthorityInfoAccess(k);else if(O=="cRLNumber")F=new g.CRLNumber(k);else if(O=="cRLReason")F=new g.CRLReason(k);else if(O=="ocspNonce")F=new g.OCSPNonce(k);else if(O=="ocspNoCheck")F=new g.OCSPNoCheck(k);else if(O=="adobeTimeStamp")F=new g.AdobeTimeStamp(k);else if(O=="subjectDirectoryAttributes")F=new g.SubjectDirectoryAttributes(k);else throw new Error("extension not supported:"+JSON.stringify(k));F!=null&&m.push(F)}var U=new d({array:m});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.x509.Extensions,y.asn1.ASN1Object),y.asn1.x509.Extension=function(s){y.asn1.x509.Extension.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERObjectIdentifier,g=l.DEROctetString;l.DERBitString;var m=l.DERBoolean,T=l.DERSequence;this.tohex=function(){var k=new d({oid:this.oid}),O=new g({hex:this.getExtnValueHex()}),F=new Array;F.push(k),this.critical&&F.push(new m),F.push(O);var U=new T({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,s!==void 0&&s.critical!==void 0&&(this.critical=s.critical)},Ie(y.asn1.x509.Extension,y.asn1.ASN1Object),y.asn1.x509.KeyUsage=function(s){y.asn1.x509.KeyUsage.superclass.constructor.call(this,s);var c=Error,l={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var d=this.getBinValue();return this.asn1ExtnValue=new y.asn1.DERBitString({bin:d}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var d=this.params;if(typeof d!="object"||typeof d.names!="object"&&typeof d.bin!="string")throw new c("parameter not yet set");if(d.names!=null)return Jl(d.names,l);if(d.bin!=null)return d.bin;throw new c("parameter not set properly")},this.oid="2.5.29.15",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.KeyUsage,y.asn1.x509.Extension),y.asn1.x509.BasicConstraints=function(s){y.asn1.x509.BasicConstraints.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERBoolean,d=c.DERInteger,g=c.DERSequence;this.getExtnValueHex=function(){var m=new Array;this.cA&&m.push(new l),this.pathLen>-1&&m.push(new d({int:this.pathLen}));var T=new g({array:m});return this.asn1ExtnValue=T,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,s!==void 0&&(s.cA!==void 0&&(this.cA=s.cA),s.pathLen!==void 0&&(this.pathLen=s.pathLen))},Ie(y.asn1.x509.BasicConstraints,y.asn1.x509.Extension),y.asn1.x509.CRLDistributionPoints=function(s){y.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(g){for(var m=[],T=0;T<g.length;T++)if(g[T]instanceof y.asn1.ASN1Object)m.push(g[T]);else{var k=new d.DistributionPoint(g[T]);m.push(k)}this.asn1ExtnValue=new l.DERSequence({array:m})},this.setByOneURI=function(g){var m=new d.DistributionPoint({fulluri:g});this.setByDPArray([m])},this.oid="2.5.29.31",s!==void 0&&(s.array!==void 0?this.setByDPArray(s.array):s.uri!==void 0&&this.setByOneURI(s.uri))},Ie(y.asn1.x509.CRLDistributionPoints,y.asn1.x509.Extension),y.asn1.x509.DistributionPoint=function(s){y.asn1.x509.DistributionPoint.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509.DistributionPointName;this.tohex=function(){var g=new l.DERSequence;if(this.asn1DP!=null){var m=new l.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});g.appendASN1Object(m)}return this.hTLV=g.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.dpobj!==void 0?this.asn1DP=s.dpobj:s.dpname!==void 0?this.asn1DP=new d(s.dpname):s.fulluri!==void 0&&(this.asn1DP=new d({full:[{uri:s.fulluri}]})))},Ie(y.asn1.x509.DistributionPoint,y.asn1.ASN1Object),y.asn1.x509.DistributionPointName=function(s){y.asn1.x509.DistributionPointName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new d({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0)if(l.x509.GeneralNames.prototype.isPrototypeOf(s))this.type="full",this.tag="a0",this.asn1V=s;else if(s.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new l.x509.GeneralNames(s.full);else throw new Error("This class supports GeneralNames only as argument")},Ie(y.asn1.x509.DistributionPointName,y.asn1.ASN1Object),y.asn1.x509.CertificatePolicies=function(s){y.asn1.x509.CertificatePolicies.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509,g=l.DERSequence,m=d.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var T=[],k=0;k<this.params.array.length;k++)T.push(new m(this.params.array[k]));var O=new g({array:T});return this.asn1ExtnValue=O,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.CertificatePolicies,y.asn1.x509.Extension),y.asn1.x509.PolicyInformation=function(s){y.asn1.x509.PolicyInformation.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.DERObjectIdentifier,g=c.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var m=[new d(this.params.policyoid)];if(this.params.array!==void 0){for(var T=[],k=0;k<this.params.array.length;k++)T.push(new g(this.params.array[k]));T.length>0&&m.push(new l({array:T}))}var O=new l({array:m});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Ie(y.asn1.x509.PolicyInformation,y.asn1.ASN1Object),y.asn1.x509.PolicyQualifierInfo=function(s){y.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.DERIA5String,g=c.DERObjectIdentifier,m=c.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var T=new l({array:[new g({oid:"1.3.6.1.5.5.7.2.1"}),new d({str:this.params.cps})]});return T.tohex()}if(this.params.unotice!=null){var T=new l({array:[new g({oid:"1.3.6.1.5.5.7.2.2"}),new m(this.params.unotice)]});return T.tohex()}},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Ie(y.asn1.x509.PolicyQualifierInfo,y.asn1.ASN1Object),y.asn1.x509.UserNotice=function(s){y.asn1.x509.UserNotice.superclass.constructor.call(this,s);var c=y.asn1.DERSequence;y.asn1.DERInteger;var l=y.asn1.x509.DisplayText,d=y.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var g=[];this.params.noticeref!==void 0&&g.push(new d(this.params.noticeref)),this.params.exptext!==void 0&&g.push(new l(this.params.exptext));var m=new c({array:g});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Ie(y.asn1.x509.UserNotice,y.asn1.ASN1Object),y.asn1.x509.NoticeReference=function(s){y.asn1.x509.NoticeReference.superclass.constructor.call(this,s);var c=y.asn1.DERSequence,l=y.asn1.DERInteger,d=y.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var g=[];if(this.params.org!==void 0&&g.push(new d(this.params.org)),this.params.noticenum!==void 0){for(var m=[],T=this.params.noticenum,k=0;k<T.length;k++)m.push(new l(T[k]));g.push(new c({array:m}))}if(g.length==0)throw new Error("parameter is empty");var O=new c({array:g});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(this.params=s)},Ie(y.asn1.x509.NoticeReference,y.asn1.ASN1Object),y.asn1.x509.DisplayText=function(s){y.asn1.x509.DisplayText.superclass.constructor.call(this,s),this.hT="0c",s!==void 0&&(s.type==="ia5"?this.hT="16":s.type==="vis"?this.hT="1a":s.type==="bmp"&&(this.hT="1e"))},Ie(y.asn1.x509.DisplayText,y.asn1.DERAbstractString),y.asn1.x509.PolicyMappings=function(s){y.asn1.x509.PolicyMappings.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var g=this.params,m=[],T=0;T<g.array.length;T++){var k=g.array[T];m.push({seq:[{oid:k[0]},{oid:k[1]}]})}return this.asn1ExtnValue=d({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.PolicyMappings,y.asn1.x509.Extension),y.asn1.x509.PolicyConstraints=function(s){y.asn1.x509.PolicyConstraints.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var g=this.params,m=[];return g.reqexp!=null&&m.push({tag:{tagi:"80",obj:{int:g.reqexp}}}),g.inhibit!=null&&m.push({tag:{tagi:"81",obj:{int:g.inhibit}}}),this.asn1ExtnValue=d({seq:m}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.PolicyConstraints,y.asn1.x509.Extension),y.asn1.x509.InhibitAnyPolicy=function(s){y.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,s);var c=y,l=c.asn1;l.x509;var d=l.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=d({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.InhibitAnyPolicy,y.asn1.x509.Extension),y.asn1.x509.NameConstraints=function(s){y.asn1.x509.NameConstraints.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.x509,g=l.ASN1Util.newObject,m=d.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var T=this.params,k=[];if(T.permit!=null&&T.permit.length!=null){for(var O=[],F=0;F<T.permit.length;F++)O.push(new m(T.permit[F]));k.push({tag:{tagi:"a0",obj:{seq:O}}})}if(T.exclude!=null&&T.exclude.length!=null){for(var U=[],F=0;F<T.exclude.length;F++)U.push(new m(T.exclude[F]));k.push({tag:{tagi:"a1",obj:{seq:U}}})}return this.asn1ExtnValue=g({seq:k}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.NameConstraints,y.asn1.x509.Extension),y.asn1.x509.GeneralSubtree=function(s){y.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var c=y.asn1,l=c.x509,d=l.GeneralName,g=c.ASN1Util.newObject;this.params=null,this.setByParam=function(m){this.params=m},this.tohex=function(){var m=this.params,T=[new d(m)];m.min!=null&&T.push({tag:{tagi:"80",obj:{int:m.min}}}),m.max!=null&&T.push({tag:{tagi:"81",obj:{int:m.max}}});var k=g({seq:T});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.GeneralSubtree,y.asn1.ASN1Object),y.asn1.x509.ExtKeyUsage=function(s){y.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,s);var c=y,l=c.asn1;this.setPurposeArray=function(d){this.asn1ExtnValue=new l.DERSequence;for(var g=0;g<d.length;g++){var m=new l.DERObjectIdentifier(d[g]);this.asn1ExtnValue.appendASN1Object(m)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",s!==void 0&&s.array!==void 0&&this.setPurposeArray(s.array)},Ie(y.asn1.x509.ExtKeyUsage,y.asn1.x509.Extension),y.asn1.x509.AuthorityKeyIdentifier=function(s){y.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DERTaggedObject,g=l.x509.GeneralNames;c.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var m=new Array;this.asn1KID&&m.push(new d({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&m.push(new d({explicit:!1,tag:"a1",obj:new g([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&m.push(new d({explicit:!1,tag:"82",obj:this.asn1CertSN}));var T=new l.DERSequence({array:m});return this.asn1ExtnValue=T,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(m){if(m.str!==void 0||m.hex!==void 0)this.asn1KID=new y.asn1.DEROctetString(m);else if(typeof m=="object"&&y.crypto.Util.isKey(m)||typeof m=="string"&&m.indexOf("BEGIN ")!=-1){var T=m;typeof m=="string"&&(T=Nt.getKey(m));var k=Nt.getKeyID(T);this.asn1KID=new y.asn1.DEROctetString({hex:k})}},this.setCertIssuerByParam=function(m){m.str!==void 0||m.ldapstr!==void 0||m.hex!==void 0||m.certsubject!==void 0||m.certissuer!==void 0?this.asn1CertIssuer=new y.asn1.x509.X500Name(m):typeof m=="string"&&m.indexOf("BEGIN ")!=-1&&m.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new y.asn1.x509.X500Name({certissuer:m}))},this.setCertSNByParam=function(m){if(m.str!==void 0||m.bigint!==void 0||m.hex!==void 0)this.asn1CertSN=new y.asn1.DERInteger(m);else if(typeof m=="string"&&m.indexOf("BEGIN ")!=-1&&m.indexOf("CERTIFICATE")){var T=new lt;T.readCertPEM(m);var k=T.getSerialNumberHex();this.asn1CertSN=new y.asn1.DERInteger({hex:k})}},this.oid="2.5.29.35",s!==void 0&&(s.kid!==void 0&&this.setKIDByParam(s.kid),s.issuer!==void 0&&this.setCertIssuerByParam(s.issuer),s.sn!==void 0&&this.setCertSNByParam(s.sn),s.issuersn!==void 0&&typeof s.issuersn=="string"&&s.issuersn.indexOf("BEGIN ")!=-1&&s.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(s.issuersn),this.setCertIssuerByParam(s.issuersn)))},Ie(y.asn1.x509.AuthorityKeyIdentifier,y.asn1.x509.Extension),y.asn1.x509.SubjectKeyIdentifier=function(s){y.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(g){if(g.str!==void 0||g.hex!==void 0)this.asn1KID=new d(g);else if(typeof g=="object"&&y.crypto.Util.isKey(g)||typeof g=="string"&&g.indexOf("BEGIN")!=-1){var m=g;typeof g=="string"&&(m=Nt.getKey(g));var T=Nt.getKeyID(m);this.asn1KID=new y.asn1.DEROctetString({hex:T})}},this.oid="2.5.29.14",s!==void 0&&s.kid!==void 0&&this.setKIDByParam(s.kid)},Ie(y.asn1.x509.SubjectKeyIdentifier,y.asn1.x509.Extension),y.asn1.x509.AuthorityInfoAccess=function(s){y.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,s),this.setAccessDescriptionArray=function(c){for(var l=new Array,d=y,g=d.asn1,m=g.DERSequence,T=g.DERObjectIdentifier,k=g.x509.GeneralName,O=0;O<c.length;O++){var F,U=c[O];if(U.ocsp!==void 0)F=new m({array:[new T({oid:"1.3.6.1.5.5.7.48.1"}),new k({uri:U.ocsp})]});else if(U.caissuer!==void 0)F=new m({array:[new T({oid:"1.3.6.1.5.5.7.48.2"}),new k({uri:U.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(U));l.push(F)}this.asn1ExtnValue=new m({array:l})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",s!==void 0&&s.array!==void 0&&this.setAccessDescriptionArray(s.array)},Ie(y.asn1.x509.AuthorityInfoAccess,y.asn1.x509.Extension),y.asn1.x509.SubjectAltName=function(s){y.asn1.x509.SubjectAltName.superclass.constructor.call(this,s),this.setNameArray=function(c){this.asn1ExtnValue=new y.asn1.x509.GeneralNames(c)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",s!==void 0&&s.array!==void 0&&this.setNameArray(s.array)},Ie(y.asn1.x509.SubjectAltName,y.asn1.x509.Extension),y.asn1.x509.IssuerAltName=function(s){y.asn1.x509.IssuerAltName.superclass.constructor.call(this,s),this.setNameArray=function(c){this.asn1ExtnValue=new y.asn1.x509.GeneralNames(c)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",s!==void 0&&s.array!==void 0&&this.setNameArray(s.array)},Ie(y.asn1.x509.IssuerAltName,y.asn1.x509.Extension),y.asn1.x509.SubjectDirectoryAttributes=function(s){y.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,s);var c=y.asn1,l=c.DERSequence,d=c.ASN1Util.newObject,g=c.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var m=[],T=0;T<this.params.array.length;T++){var k=this.params.array[T];if(k.attr!=null&&k.array!=null){var O={seq:[{oid:k.attr},{set:k.array}]};m.push(d(O));continue}var F={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(k.attr=="dateOfBirth")F.seq[0].oid=g(k.attr),F.seq[1].set[0]={gentime:k.str};else if(k.attr=="placeOfBirth")F.seq[0].oid=g(k.attr),F.seq[1].set[0]={utf8str:k.str};else if(k.attr=="gender")F.seq[0].oid=g(k.attr),F.seq[1].set[0]={prnstr:k.str};else if(k.attr=="countryOfCitizenship")F.seq[0].oid=g(k.attr),F.seq[1].set[0]={prnstr:k.str};else if(k.attr=="countryOfResidence")F.seq[0].oid=g(k.attr),F.seq[1].set[0]={prnstr:k.str};else throw new Error("unsupported attribute: "+k.attr);m.push(new d(F))}var U=new l({array:m});return this.asn1ExtnValue=U,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",s!==void 0&&(this.params=s)},Ie(y.asn1.x509.SubjectDirectoryAttributes,y.asn1.x509.Extension),y.asn1.x509.PrivateExtension=function(s){y.asn1.x509.PrivateExtension.superclass.constructor.call(this,s);var c=y,l=c.lang.String.isHex,d=c.asn1,g=d.x509.OID.name2oid,m=d.ASN1Util.newObject;this.params=null,this.setByParam=function(T){this.oid=g(T.extname),this.params=T},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var T=this.params.extn;if(typeof T=="string"&&l(T))return T;if(typeof T=="object")try{return m(T).tohex()}catch{}throw new Error("unsupported extn value")},s!=null&&this.setByParam(s)},Ie(y.asn1.x509.PrivateExtension,y.asn1.x509.Extension),y.asn1.x509.CRL=function(s){y.asn1.x509.CRL.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERSequence,g=l.DERBitString,m=l.x509,T=m.AlgorithmIdentifier,k=m.TBSCertList;this.params=void 0,this.setByParam=function(O){this.params=O},this.sign=function(){var O=new k(this.params).tohex(),F=new y.crypto.Signature({alg:this.params.sigalg});F.init(this.params.cakey),F.updateHex(O);var U=F.sign();this.params.sighex=U},this.getPEM=function(){return nr(this.tohex(),"X509 CRL")},this.tohex=function(){var O=this.params;if(O.tbsobj==null&&(O.tbsobj=new k(O)),O.sighex==null&&O.cakey!=null&&this.sign(),O.sighex==null)throw new Error("sighex or cakey parameter not defined");var F=[];F.push(O.tbsobj),F.push(new T({name:O.sigalg})),F.push(new g({hex:"00"+O.sighex}));var U=new d({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&(this.params=s)},Ie(y.asn1.x509.CRL,y.asn1.ASN1Object),y.asn1.x509.TBSCertList=function(s){y.asn1.x509.TBSCertList.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERInteger,g=l.DERSequence,m=l.DERTaggedObject;l.DERObjectIdentifier;var T=l.x509,k=T.AlgorithmIdentifier,O=T.Time,F=T.Extensions,U=T.X500Name;this.params=null,this.setByParam=function(L){this.params=L},this.getRevCertSequence=function(){for(var L=[],P=this.params.revcert,D=0;D<P.length;D++){var A=[new d(P[D].sn),new O(P[D].date)];P[D].ext!=null&&A.push(new F(P[D].ext)),L.push(new g({array:A}))}return new g({array:L})},this.tohex=function(){var L=[],P=this.params;if(P.version!=null){var D=P.version-1,A=new d({int:D});L.push(A)}if(L.push(new k({name:P.sigalg})),L.push(new U(P.issuer)),L.push(new O(P.thisupdate)),P.nextupdate!=null&&L.push(new O(P.nextupdate)),P.revcert!=null&&L.push(this.getRevCertSequence()),P.ext!=null){var N=new F(P.ext);L.push(new m({tag:"a0",explicit:!0,obj:N}))}var j=new g({array:L});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.TBSCertList,y.asn1.ASN1Object),y.asn1.x509.CRLEntry=function(s){y.asn1.x509.CRLEntry.superclass.constructor.call(this);var c=y,l=c.asn1;this.setCertSerial=function(d){this.sn=new l.DERInteger(d)},this.setRevocationDate=function(d){this.time=new l.x509.Time(d)},this.tohex=function(){var d=new l.DERSequence({array:[this.sn,this.time]});return this.TLV=d.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.time!==void 0&&this.setRevocationDate(s.time),s.sn!==void 0&&this.setCertSerial(s.sn))},Ie(y.asn1.x509.CRLEntry,y.asn1.ASN1Object),y.asn1.x509.CRLNumber=function(s){y.asn1.x509.CRLNumber.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",s!=null&&(this.params=s)},Ie(y.asn1.x509.CRLNumber,y.asn1.x509.Extension),y.asn1.x509.CRLReason=function(s){y.asn1.x509.CRLReason.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",s!=null&&(this.params=s)},Ie(y.asn1.x509.CRLReason,y.asn1.x509.Extension),y.asn1.x509.OCSPNonce=function(s){y.asn1.x509.OCSPNonce.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",s!=null&&(this.params=s)},Ie(y.asn1.x509.OCSPNonce,y.asn1.x509.Extension),y.asn1.x509.OCSPNoCheck=function(s){y.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,s),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new y.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",s!=null&&(this.params=s)},Ie(y.asn1.x509.OCSPNoCheck,y.asn1.x509.Extension),y.asn1.x509.AdobeTimeStamp=function(s){y.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,s);var c=y,l=c.asn1,d=l.DERInteger,g=l.DERBoolean,m=l.DERSequence,T=l.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var k=this.params,O=[new d(1)];return O.push(new T({uri:k.uri})),k.reqauth!=null&&O.push(new g(k.reqauth)),this.asn1ExtnValue=new m({array:O}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.AdobeTimeStamp,y.asn1.x509.Extension),y.asn1.x509.X500Name=function(s){y.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var c=y,l=c.asn1,d=l.x509,g=d.RDN;this.setByString=function(m,T){T!==void 0&&(this.sRule=T);var k=m.split("/");k.shift();for(var O=[],F=0;F<k.length;F++)if(k[F].match(/^[^=]+=.+$/))O.push(k[F]);else{var U=O.length-1;O[U]=O[U]+"/"+k[F]}for(var F=0;F<O.length;F++)this.asn1Array.push(new g({str:O[F],rule:this.sRule}))},this.setByLdapString=function(m,T){T!==void 0&&(this.sRule=T);var k=d.X500Name.ldapToCompat(m);this.setByString(k,T)},this.setByObject=function(m,T){T!==void 0&&(this.sRule=T);for(var k in m)if(m.hasOwnProperty(k)){var O=new g({str:k+"="+m[k],rule:this.sRule});this.asn1Array?this.asn1Array.push(O):this.asn1Array=[O]}},this.setByParam=function(m){if(m.rule!==void 0&&(this.sRule=m.rule),m.array!==void 0)this.paramArray=m.array;else if(m.str!==void 0)this.setByString(m.str);else if(m.ldapstr!==void 0)this.setByLdapString(m.ldapstr);else if(m.hex!==void 0)this.hTLV=m.hex;else if(m.certissuer!==void 0){var T=new lt;T.readCertPEM(m.certissuer),this.hTLV=T.getIssuerHex()}else if(m.certsubject!==void 0){var T=new lt;T.readCertPEM(m.certsubject),this.hTLV=T.getSubjectHex()}else typeof m=="object"&&m.certsubject===void 0&&m.certissuer===void 0&&this.setByObject(m)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var m=0;m<this.paramArray.length;m++){var T={array:this.paramArray[m]};this.sRule!="utf8"&&(T.rule=this.sRule);var k=new g(T);this.asn1Array.push(k)}var O=new l.DERSequence({array:this.asn1Array});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.X500Name,y.asn1.ASN1Object),y.asn1.x509.X500Name.compatToLDAP=function(s){if(s.substr(0,1)!=="/")throw"malformed input";s=s.substr(1);var c=s.split("/");return c.reverse(),c=c.map(function(l){return l.replace(/,/,"\\,")}),c.join(",")},y.asn1.x509.X500Name.onelineToLDAP=function(s){return y.asn1.x509.X500Name.compatToLDAP(s)},y.asn1.x509.X500Name.ldapToCompat=function(s){for(var c=s.split(","),l=!1,d=[],g=0;c.length>0;g++){var m=c.shift();if(l===!0){var T=d.pop(),k=(T+","+m).replace(/\\,/g,",");d.push(k),l=!1}else d.push(m);m.substr(-1,1)==="\\"&&(l=!0)}return d=d.map(function(O){return O.replace("/","\\/")}),d.reverse(),"/"+d.join("/")},y.asn1.x509.X500Name.ldapToOneline=function(s){return y.asn1.x509.X500Name.ldapToCompat(s)},y.asn1.x509.RDN=function(s){y.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var c=y.asn1.x509.AttributeTypeAndValue;this.setByParam=function(l){l.rule!==void 0&&(this.sRule=l.rule),l.str!==void 0&&this.addByMultiValuedString(l.str),l.array!==void 0&&(this.paramArray=l.array)},this.addByString=function(l){this.asn1Array.push(new y.asn1.x509.AttributeTypeAndValue({str:l,rule:this.sRule}))},this.addByMultiValuedString=function(l){for(var d=y.asn1.x509.RDN.parseString(l),g=0;g<d.length;g++)this.addByString(d[g])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var l=0;l<this.paramArray.length;l++){var d=this.paramArray[l];d.rule!==void 0&&this.sRule!="utf8"&&(d.rule=this.sRule);var g=new c(d);this.asn1Array.push(g)}var m=new y.asn1.DERSet({array:this.asn1Array});return this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.RDN,y.asn1.ASN1Object),y.asn1.x509.RDN.parseString=function(s){for(var c=s.split(/\+/),l=!1,d=[],g=0;c.length>0;g++){var m=c.shift();if(l===!0){var T=d.pop(),k=(T+"+"+m).replace(/\\\+/g,"+");d.push(k),l=!1}else d.push(m);m.substr(-1,1)==="\\"&&(l=!0)}for(var O=!1,F=[],g=0;d.length>0;g++){var m=d.shift();if(O===!0){var U=F.pop();if(m.match(/"$/)){var k=(U+"+"+m).replace(/^([^=]+)="(.*)"$/,"$1=$2");F.push(k),O=!1}else F.push(U+"+"+m)}else F.push(m);m.match(/^[^=]+="/)&&(O=!0)}return F},y.asn1.x509.AttributeTypeAndValue=function(s){y.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var c=y,l=c.asn1,d=l.DERSequence,g=l.DERUTF8String,m=l.DERPrintableString,T=l.DERTeletexString,k=l.DERIA5String,O=l.DERVisibleString,F=l.DERBMPString,U=c.lang.String.isMail,L=c.lang.String.isPrintable;this.setByParam=function(P){if(P.rule!==void 0&&(this.sRule=P.rule),P.ds!==void 0&&(this.dsType=P.ds),P.value===void 0&&P.str!==void 0){var D=P.str,A=D.match(/^([^=]+)=(.+)$/);if(A)this.sType=A[1],this.sValue=A[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=P.type,this.sValue=P.value},this.setByString=function(P,D){D!==void 0&&(this.sRule=D);var A=P.match(/^([^=]+)=(.+)$/);if(A)this.setByAttrTypeAndValueStr(A[1],A[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var P=this.sType,D=this.sValue,A=this.sRule;return A==="prn"?P=="CN"&&U(D)?"ia5":L(D)?"prn":"utf8":A==="utf8"?P=="CN"&&U(D)?"ia5":P=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(P,D,A){A!==void 0&&(this.sRule=A),this.sType=P,this.sValue=D},this.getValueObj=function(P,D){if(P=="utf8")return new g({str:D});if(P=="prn")return new m({str:D});if(P=="tel")return new T({str:D});if(P=="ia5")return new k({str:D});if(P=="vis")return new O({str:D});if(P=="bmp")return new F({str:D});throw new Error("unsupported directory string type: type="+P+" value="+D)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var P=y.asn1.x509.OID.atype2obj(this.sType),D=this.getValueObj(this.dsType,this.sValue),A=new d({array:[P,D]});return this.TLV=A.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.AttributeTypeAndValue,y.asn1.ASN1Object),y.asn1.x509.SubjectPublicKeyInfo=function(s){y.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERInteger,g=l.DERBitString,m=l.DERObjectIdentifier,T=l.DERSequence,k=l.ASN1Util.newObject,O=l.x509,F=O.AlgorithmIdentifier,U=c.crypto;U.ECDSA,U.DSA,this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var L=new T({array:[this.asn1AlgId,this.asn1SubjPKey]});return L},this.tohex=function(){var L=this.getASN1Object();return this.hTLV=L.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(L){try{if(L instanceof xe){var P=k({seq:[{int:{bigint:L.n}},{int:{int:L.e}}]}),D=P.tohex();this.asn1AlgId=new F({name:"rsaEncryption"}),this.asn1SubjPKey=new g({hex:"00"+D})}}catch{}try{if(L instanceof y.crypto.ECDSA){var A=new m({name:L.curveName});this.asn1AlgId=new F({name:"ecPublicKey",asn1params:A}),this.asn1SubjPKey=new g({hex:"00"+L.pubKeyHex})}}catch{}try{if(L instanceof y.crypto.DSA){var A=new k({seq:[{int:{bigint:L.p}},{int:{bigint:L.q}},{int:{bigint:L.g}}]});this.asn1AlgId=new F({name:"dsa",asn1params:A});var N=new d({bigint:L.y});this.asn1SubjPKey=new g({hex:"00"+N.tohex()})}}catch{}},s!==void 0&&this.setPubKey(s)},Ie(y.asn1.x509.SubjectPublicKeyInfo,y.asn1.ASN1Object),y.asn1.x509.Time=function(s){y.asn1.x509.Time.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERUTCTime,g=l.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(m){this.timeParams=m},this.setByParam=function(m){this.params=m},this.getType=function(m){return m.match(/^[0-9]{12}Z$/)?"utc":m.match(/^[0-9]{14}Z$/)?"gen":m.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":m.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var m=this.params,T=null;if(typeof m=="string"&&(m={str:m}),m!=null&&m.str&&(m.type==null||m.type==null)&&(m.type=this.getType(m.str)),m!=null&&m.str?(m.type=="utc"&&(T=new d(m.str)),m.type=="gen"&&(T=new g(m.str))):this.type=="gen"?T=new g:T=new d,T==null)throw new Error("wrong setting for Time");return this.TLV=T.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},y.asn1.x509.Time_bak=function(s){y.asn1.x509.Time_bak.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERUTCTime,g=l.DERGeneralizedTime;this.setTimeParams=function(m){this.timeParams=m},this.tohex=function(){var m=null;return this.timeParams!=null?this.type=="utc"?m=new d(this.timeParams):m=new g(this.timeParams):this.type=="utc"?m=new d:m=new g,this.TLV=m.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",s!==void 0&&(s.type!==void 0?this.type=s.type:s.str!==void 0&&(s.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),s.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=s)},Ie(y.asn1.x509.Time,y.asn1.ASN1Object),y.asn1.x509.AlgorithmIdentifier=function(s){y.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var c=y,l=c.asn1,d=l.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var m=null;for(var T in d)T===this.nameAlg&&(m=d[T]);if(m!==null)return this.hTLV=m,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=l.x509.OID.name2obj(this.nameAlg));var k=[this.asn1Alg];this.asn1Params!==null&&k.push(this.asn1Params);var O=new l.DERSequence({array:k});return this.hTLV=O.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&(s.name!==void 0&&(this.nameAlg=s.name),s.asn1params!==void 0&&(this.asn1Params=s.asn1params),s.paramempty!==void 0&&(this.paramEmpty=s.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var g=this.nameAlg.toLowerCase();g.substr(-7,7)!=="withdsa"&&g.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new l.DERNull)}},Ie(y.asn1.x509.AlgorithmIdentifier,y.asn1.ASN1Object),y.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},y.asn1.x509.GeneralName=function(s){y.asn1.x509.GeneralName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.x509,g=d.X500Name,m=d.OtherName,T=l.DERIA5String;l.DERPrintableString;var k=l.DEROctetString,O=l.DERTaggedObject,F=l.ASN1Object,U=Error;this.params=null,this.setByParam=function(L){this.params=L},this.tohex=function(){var L=this.params,P,A,D,A=!1;if(L.other!==void 0)P="a0",D=new m(L.other);else if(L.rfc822!==void 0)P="81",D=new T({str:L.rfc822});else if(L.dns!==void 0)P="82",D=new T({str:L.dns});else if(L.dn!==void 0)P="a4",A=!0,typeof L.dn=="string"?D=new g({str:L.dn}):L.dn instanceof y.asn1.x509.X500Name?D=L.dn:D=new g(L.dn);else if(L.ldapdn!==void 0)P="a4",A=!0,D=new g({ldapstr:L.ldapdn});else if(L.certissuer!==void 0||L.certsubj!==void 0){P="a4",A=!0;var N,j,W=null;if(L.certsubj!==void 0?(N=!1,j=L.certsubj):(N=!0,j=L.certissuer),j.match(/^[0-9A-Fa-f]+$/),j.indexOf("-----BEGIN ")!=-1&&(W=bn(j)),W==null)throw new Error("certsubj/certissuer not cert");var se=new lt;se.hex=W;var he;N?he=se.getIssuerHex():he=se.getSubjectHex(),D=new F,D.hTLV=he}else if(L.uri!==void 0)P="86",D=new T({str:L.uri});else if(L.ip!==void 0){P="87";var de,fe=L.ip;try{if(fe.match(/^[0-9a-f]+$/)){var G=fe.length;if(G==8||G==16||G==32||G==64)de=fe;else throw"err"}else de=jh(fe)}catch(te){throw new U("malformed IP address: "+L.ip+":"+te.message)}D=new k({hex:de})}else throw new U("improper params");var Q=new O({tag:P,explicit:A,obj:D});return Q.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.GeneralName,y.asn1.ASN1Object),y.asn1.x509.GeneralNames=function(s){y.asn1.x509.GeneralNames.superclass.constructor.call(this);var c=y,l=c.asn1;this.setByParamArray=function(d){for(var g=0;g<d.length;g++){var m=new l.x509.GeneralName(d[g]);this.asn1Array.push(m)}},this.tohex=function(){var d=new l.DERSequence({array:this.asn1Array});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof s<"u"&&this.setByParamArray(s)},Ie(y.asn1.x509.GeneralNames,y.asn1.ASN1Object),y.asn1.x509.OtherName=function(s){y.asn1.x509.OtherName.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DERObjectIdentifier,g=l.DERSequence,m=l.ASN1Util.newObject;this.params=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(T.oid==null||T.value==null)throw new Error("oid or value not specified");var k=new d({oid:T.oid}),O=m({tag:{tag:"a0",explicit:!0,obj:T.value}}),F=new g({array:[k,O]});return F.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.x509.OtherName,y.asn1.ASN1Object),y.asn1.x509.OID=new function(){var s=y.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(c){if(typeof this.objCache[c]<"u")return this.objCache[c];if(typeof this.name2oidList[c]>"u")throw"Name of ObjectIdentifier not defined: "+c;var l=this.name2oidList[c],d=new s({oid:l});return this.objCache[c]=d,d},this.atype2obj=function(c){if(this.objCache[c]!==void 0)return this.objCache[c];var l;if(c.match(/^\d+\.\d+\.[0-9.]+$/))l=c;else if(this.atype2oidList[c]!==void 0)l=this.atype2oidList[c];else if(this.name2oidList[c]!==void 0)l=this.name2oidList[c];else throw new Error("AttributeType name undefined: "+c);var d=new s({oid:l});return this.objCache[c]=d,d},this.registerOIDs=function(c){if(this.checkOIDs(c))for(var l in c)this.name2oidList[l]=c[l]},this.checkOIDs=function(c){try{var l=Object.keys(c);return l.length==0?!1:(l.map(function(d,g,m){var T=this[d];if(!T.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},c),!0)}catch{return!1}}},y.asn1.x509.OID.oid2name=function(s){var c=y.asn1.x509.OID.name2oidList;for(var l in c)if(c[l]==s)return l;return""},y.asn1.x509.OID.oid2atype=function(s){var c=y.asn1.x509.OID.atype2oidList;for(var l in c)if(c[l]==s)return l;return s},y.asn1.x509.OID.name2oid=function(s){if(s.match(/^[0-9.]+$/))return s;var c=y.asn1.x509.OID.name2oidList;return c[s]===void 0?"":c[s]},y.asn1.x509.X509Util={},y.asn1.x509.X509Util.newCertPEM=function(s){var c=y.asn1.x509;c.TBSCertificate;var l=c.Certificate,d=new l(s);return d.getPEM()},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.cms>"u"||!y.asn1.cms)&&(y.asn1.cms={}),y.asn1.cms.Attribute=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSequence,m=d.DERSet,T=d.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(k){this.params=k},this.getValueArray=function(){throw new c("not yet implemented abstract")},this.tohex=function(){var k=new T({oid:this.typeOid}),O=new m({array:this.getValueArray()}),F=new g({array:[k,O]});return F.tohex()},this.getEncodedHex=function(){return this.tohex()}},Ie(y.asn1.cms.Attribute,y.asn1.ASN1Object),y.asn1.cms.ContentType=function(s){var c=y,l=c.asn1;l.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var d=new l.DERObjectIdentifier(this.params.type);return[d]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.ContentType,y.asn1.cms.Attribute),y.asn1.cms.MessageDigest=function(s){var c=y,l=c.asn1,d=l.DEROctetString,g=l.cms;g.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var m=new d(this.params);return[m]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.MessageDigest,y.asn1.cms.Attribute),y.asn1.cms.SigningTime=function(s){var c=y,l=c.asn1;l.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var d=new l.x509.Time(this.params);return[d]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SigningTime,y.asn1.cms.Attribute),y.asn1.cms.SigningCertificate=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSequence,m=d.cms,T=m.ESSCertID;l.crypto,m.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new c("parameter 'array' not specified");for(var k=this.params.array,O=[],F=0;F<k.length;F++){var U=k[F];s.hasis==!1&&typeof U=="string"&&(U.indexOf("-----BEGIN")!=-1||je.isASN1HEX(U))&&(U={cert:U}),U.hasis!=!1&&s.hasis==!1&&(U.hasis=!1),O.push(new T(U))}var L=new g({array:O}),P=new g({array:[L]});return[P]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SigningCertificate,y.asn1.cms.Attribute),y.asn1.cms.ESSCertID=function(s){y.asn1.cms.ESSCertID.superclass.constructor.call(this);var c=Error,l=y,d=l.asn1,g=d.DEROctetString,m=d.DERSequence,T=d.cms.IssuerSerial;this.params=null,this.getCertHash=function(k,O){if(k.hash!=null)return k.hash;if(typeof k=="string"&&k.indexOf("-----BEGIN")==-1&&!je.isASN1HEX(k))return k;var F;if(typeof k=="string")F=k;else if(k.cert!=null)F=k.cert;else throw new c("hash nor cert unspecified");var U;F.indexOf("-----BEGIN")!=-1?U=bn(F):U=F,typeof k=="string"&&(k.indexOf("-----BEGIN")!=-1?U=bn(k):je.isASN1HEX(k)&&(U=k));var L;if(k.alg!=null)L=k.alg;else if(O!=null)L=O;else throw new c("hash alg unspecified");return l.crypto.Util.hashHex(U,L)},this.tohex=function(){var k=this.params,O=this.getCertHash(k,"sha1"),F=[];F.push(new g({hex:O})),(typeof k=="string"&&k.indexOf("-----BEGIN")!=-1||k.cert!=null&&k.hasis!=!1||k.issuer!=null&&k.serial!=null)&&F.push(new T(k));var U=new m({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.ESSCertID,y.asn1.ASN1Object),y.asn1.cms.SigningCertificateV2=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSequence;d.x509;var m=d.cms,T=m.ESSCertIDv2;l.crypto,m.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new c("parameter 'array' not specified");for(var k=this.params.array,O=[],F=0;F<k.length;F++){var U=k[F];(s.alg!=null||s.hasis==!1)&&typeof U=="string"&&(U.indexOf("-----BEGIN")!=-1||je.isASN1HEX(U))&&(U={cert:U}),U.alg==null&&s.alg!=null&&(U.alg=s.alg),U.hasis!=!1&&s.hasis==!1&&(U.hasis=!1),O.push(new T(U))}var L=new g({array:O}),P=new g({array:[L]});return[P]},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SigningCertificateV2,y.asn1.cms.Attribute),y.asn1.cms.ESSCertIDv2=function(s){y.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.DEROctetString,g=l.DERSequence,m=l.cms.IssuerSerial,T=l.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var k=this.params,O=this.getCertHash(k,"sha256"),F=[];k.alg!=null&&k.alg!="sha256"&&F.push(new T({name:k.alg})),F.push(new d({hex:O})),(typeof k=="string"&&k.indexOf("-----BEGIN")!=-1||k.cert!=null&&k.hasis!=!1||k.issuer!=null&&k.serial!=null)&&F.push(new m(k));var U=new g({array:F});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.ESSCertIDv2,y.asn1.cms.ESSCertID),y.asn1.cms.IssuerSerial=function(s){var c=Error,l=y,d=l.asn1,g=d.DERInteger,m=d.DERSequence,T=d.cms,k=d.x509,O=k.GeneralNames,F=lt;T.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(U){this.params=U},this.tohex=function(){var U=this.params,L,P;if(typeof U=="string"&&U.indexOf("-----BEGIN")!=-1||U.cert!=null){var D;U.cert!=null?D=U.cert:D=U;var A=new F;A.readCertPEM(D),L=A.getIssuer(),P={hex:A.getSerialNumberHex()}}else if(U.issuer!=null&&U.serial)L=U.issuer,P=U.serial;else throw new c("cert or issuer and serial parameter not specified");var N=new O([{dn:L}]),j=new g(P),W=new m({array:[N,j]});return W.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.IssuerSerial,y.asn1.ASN1Object),y.asn1.cms.SignerIdentifier=function(s){var c=y,l=c.asn1;l.DERInteger,l.DERSequence;var d=l.cms,g=d.IssuerAndSerialNumber,m=d.SubjectKeyIdentifier,T=l.x509;T.X500Name,d.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;if(k.type=="isssn"){var O=new g(k);return O.tohex()}else if(k.type=="skid"){var F=new m(k);return F.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SignerIdentifier,y.asn1.ASN1Object),y.asn1.cms.IssuerAndSerialNumber=function(s){var c=y,l=c.asn1,d=l.DERInteger,g=l.DERSequence,m=l.cms,T=l.x509,k=T.X500Name,O=lt,F=Error;m.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var U=this.params,L,P;if(typeof U=="string"&&U.indexOf("-----BEGIN")!=-1||U.cert!=null){var D;U.cert!=null?D=U.cert:D=U;var A=new O;A.readCertPEM(D),L=A.getIssuer(),P={hex:A.getSerialNumberHex()}}else if(U.issuer!=null&&U.serial)L=U.issuer,P=U.serial;else throw new F("cert or issuer and serial parameter not specified");var N=new k(L),j=new d(P),W=new g({array:[N,j]});return W.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(U){this.params=U},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.IssuerAndSerialNumber,y.asn1.ASN1Object),y.asn1.cms.SubjectKeyIdentifier=function(s){var c=y,l=c.asn1;l.DERInteger,l.DERSequence;var d=l.ASN1Util.newObject,g=l.cms;g.IssuerAndSerialName,g.SubjectKeyIdentifier;var m=l.x509;m.X500Name;var T=lt,k=Error;g.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var O=this.params;if(O.cert==null&&O.skid==null)throw new k("property cert nor skid undefined");var F;if(O.cert!=null){var U=new T(O.cert),L=U.getExtSubjectKeyIdentifier();F=L.kid.hex}else O.skid!=null&&(F=O.skid);var P=d({tag:{tage:"a0",obj:{octstr:{hex:F}}}});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SubjectKeyIdentifier,y.asn1.ASN1Object),y.asn1.cms.AttributeList=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSet,m=d.cms;m.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(this.hTLV!=null)return this.hTLV;var k=!0;T.sortflag!=null&&(k=T.sortflag);for(var O=T.array,F=[],U=0;U<O.length;U++){var L=O[U],P=L.attr;if(P=="contentType")F.push(new m.ContentType(L));else if(P=="messageDigest")F.push(new m.MessageDigest(L));else if(P=="signingTime")F.push(new m.SigningTime(L));else if(P=="signingCertificate")F.push(new m.SigningCertificate(L));else if(P=="signingCertificateV2")F.push(new m.SigningCertificateV2(L));else if(P=="signaturePolicyIdentifier")F.push(new y.asn1.cades.SignaturePolicyIdentifier(L));else if(P=="signatureTimeStamp"||P=="timeStampToken")F.push(new y.asn1.cades.SignatureTimeStamp(L));else throw new c("unknown attr: "+P)}var D=new g({array:F,sortflag:k});return this.hTLV=D.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.AttributeList,y.asn1.ASN1Object),y.asn1.cms.SignerInfo=function(s){var c=Error,l=y,d=l.asn1,g=d.DERInteger,m=d.DEROctetString,T=d.DERSequence,k=d.DERTaggedObject,O=d.cms,F=O.SignerIdentifier,U=O.AttributeList;O.ContentType,O.EncapsulatedContentInfo,O.MessageDigest,O.SignedData;var L=d.x509,P=L.AlgorithmIdentifier,D=l.crypto,A=Nt;O.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var N=this.params,j=N.sigalg,W=new U(N.sattrs).tohex(),se=A.getKey(N.signkey),he=new D.Signature({alg:j});he.init(se),he.updateHex(W);var de=he.sign();N.sighex=de},this.tohex=function(){var N=this.params,j=[];if(j.push(new g({int:N.version})),j.push(new F(N.id)),j.push(new P({name:N.hashalg})),N.sattrs!=null){var W=new U(N.sattrs);try{j.push(new k({tag:"a0",explicit:!1,obj:W}))}catch(he){throw new c("si sattr error: "+he)}}if(N.sigalgfield!=null?j.push(new P({name:N.sigalgfield})):j.push(new P({name:N.sigalg})),N.sighex==null&&N.signkey!=null&&this.sign(),j.push(new m({hex:N.sighex})),N.uattrs!=null){var W=new U(N.uattrs);try{j.push(new k({tag:"a1",explicit:!1,obj:W}))}catch(de){throw new c("si uattr error: "+de)}}var se=new T({array:j});return se.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SignerInfo,y.asn1.ASN1Object),y.asn1.cms.EncapsulatedContentInfo=function(s){var c=y,l=c.asn1,d=l.DERTaggedObject,g=l.DERSequence,m=l.DERObjectIdentifier,T=l.DEROctetString,k=l.cms;k.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var O=this.params,F=[];if(F.push(new m(O.type)),O.content!=null&&(O.content.hex!=null||O.content.str!=null)&&O.isDetached!=!0){var U=new T(O.content),L=new d({tag:"a0",explicit:!0,obj:U});F.push(L)}var P=new g({array:F});return P.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(O){this.params=O},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.EncapsulatedContentInfo,y.asn1.ASN1Object),y.asn1.cms.ContentInfo=function(s){var c=y,l=c.asn1,d=l.DERTaggedObject,g=l.DERSequence,m=l.DERObjectIdentifier,T=l.x509;T.OID.name2obj,y.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params,O=[];O.push(new m(k.type));var F=new d({tag:"a0",explicit:!0,obj:k.obj});O.push(F);var U=new g({array:O});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(k){this.params=k},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.ContentInfo,y.asn1.ASN1Object),y.asn1.cms.SignedData=function(s){var c=y,l=c.asn1;l.ASN1Object;var d=l.DERInteger,g=l.DERSet,m=l.DERSequence;l.DERTaggedObject;var T=l.cms,k=T.EncapsulatedContentInfo,O=T.SignerInfo,F=T.ContentInfo,U=T.CertificateSet,L=T.RevocationInfoChoices,P=l.x509,D=P.AlgorithmIdentifier;y.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var A=this.params;this._setDigestAlgs(A),this._setContentTypeByEContent(A),this._setMessageDigestByEContent(A),this._setSignerInfoVersion(A),this._setSignedDataVersion(A)},this._setDigestAlgs=function(A){for(var N={},j=A.sinfos,W=0;W<j.length;W++){var se=j[W];N[se.hashalg]=1}A.hashalgs=Object.keys(N).sort()},this._setContentTypeByEContent=function(A){for(var N=A.econtent.type,j=A.sinfos,W=0;W<j.length;W++){var se=j[W],he=this._getAttrParamByName(se,"contentType");he.type=N}},this._setMessageDigestByEContent=function(A){var N=A.econtent;A.econtent.type;var j=N.content.hex;j==null&&N.type=="data"&&N.content.str!=null&&(j=Bi(N.content.str));for(var W=A.sinfos,se=0;se<W.length;se++){var he=W[se],de=he.hashalg,fe=this._getAttrParamByName(he,"messageDigest"),G=y.crypto.Util.hashHex(j,de);fe.hex=G}},this._getAttrParamByName=function(A,N){for(var j=A.sattrs.array,W=0;W<j.length;W++)if(j[W].attr==N)return j[W]},this._setSignerInfoVersion=function(A){for(var N=A.sinfos,j=0;j<N.length;j++){var W=N[j],se=1;W.id.type=="skid"&&(se=3),W.version=se}},this._setSignedDataVersion=function(A){var N=this._getSignedDataVersion(A);A.version=N},this._getSignedDataVersion=function(A){if(A.revinfos!=null)for(var N=A.revinfos,j=0;j<N.length;j++){var W=N[j];if(W.ocsp!=null)return 5}for(var se=A.sinfos,j=0;j<se.length;j++){var he=A.sinfos[j];if(he.version==3)return 3}return A.econtent.type!="data"?3:1},this.tohex=function(){var A=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),A.fixed!=!0&&this.checkAndFixParam();var N=[];N.push(new d({int:A.version}));for(var j=[],W=0;W<A.hashalgs.length;W++){var se=A.hashalgs[W];j.push(new D({name:se}))}N.push(new g({array:j})),N.push(new k(A.econtent)),A.certs!=null&&N.push(new U(A.certs)),A.revinfos!=null&&N.push(new L(A.revinfos));for(var he=[],W=0;W<A.sinfos.length;W++){var de=A.sinfos[W];he.push(new O(de))}N.push(new g({array:he}));var fe=new m({array:N});return fe.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var A=new F({type:"signed-data",obj:this});return A},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.SignedData,y.asn1.ASN1Object),y.asn1.cms.CertificateSet=function(s){y.asn1.cms.CertificateSet.superclass.constructor.call(this);var c=Error,l=y.asn1,d=l.DERTaggedObject,g=l.DERSet,m=l.ASN1Object;this.params=null,this.tohex=function(){var T=this.params,k=[],O;if(T instanceof Array)O=T;else if(T.array!=null)O=T.array;else throw new c("cert array not specified");for(var F=0;F<O.length;F++){var U=O[F],L=bn(U),P=new m;P.hTLV=L,k.push(P)}var D={array:k};T.sortflag==!1&&(D.sortflag=!1);var A=new g(D),N=new d({tag:"a0",explicit:!1,obj:A});return N.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.CertificateSet,y.asn1.ASN1Object),y.asn1.cms.RevocationInfoChoices=function(s){y.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(!c instanceof Array)throw new Error("params is not array");for(var l=[],d=0;d<c.length;d++)l.push(new y.asn1.cms.RevocationInfoChoice(c[d]));var g=y.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:l}}});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.RevocationInfoChoices,y.asn1.ASN1Object),y.asn1.cms.RevocationInfoChoice=function(s){y.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(c.crl!=null&&typeof c.crl=="string"){var l=c.crl;return c.crl.indexOf("-----BEGIN")!=-1&&(l=bn(c.crl)),l}else if(c.ocsp!=null){var d=y.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new y.asn1.cms.OtherRevocationFormat(c)}});return d.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.RevocationInfoChoice,y.asn1.ASN1Object),y.asn1.cms.OtherRevocationFormat=function(s){y.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var c=Error,l=y,d=l.asn1,g=d.ASN1Util.newObject,m=l.lang.String.isHex;this.params=null,this.tohex=function(){var T=this.params;if(T.ocsp==null)throw new c("property ocsp not specified");if(!m(T.ocsp)||!je.isASN1HEX(T.ocsp))throw new c("ocsp value not ASN.1 hex string");var k=g({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:T.ocsp}}]});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cms.OtherRevocationFormat,y.asn1.ASN1Object),y.asn1.cms.CMSUtil=new function(){},y.asn1.cms.CMSUtil.newSignedData=function(s){return new y.asn1.cms.SignedData(s)},y.asn1.cms.CMSUtil.verifySignedData=function(s){var c=y,l=c.asn1,d=l.cms;d.SignerInfo,d.SignedData,d.SigningTime,d.SigningCertificate,d.SigningCertificateV2;var g=l.cades;g.SignaturePolicyIdentifier;var m=c.lang.String.isHex,T=je,k=T.getVbyList,O=T.getTLVbyList,F=T.getIdxbyList,U=T.getChildIdx,L=T.getTLV,P=T.oidname,D=c.crypto.Util.hashHex;s.cms===void 0&&m(s.cms);var A=s.cms,N=function(te,J){for(var re,pe=3;pe<6;pe++)if(re=F(te,0,[1,0,pe]),re!==void 0){var be=te.substr(re,2);be==="a0"&&(J.certsIdx=re),be==="a1"&&(J.revinfosIdx=re),be==="31"&&(J.signerinfosIdx=re)}},j=function(te,J){var re=J.signerinfosIdx;if(re!==void 0){var pe=U(te,re);J.signerInfoIdxList=pe;for(var be=0;be<pe.length;be++){var Fe=pe[be],ve={idx:Fe};W(te,ve),J.signerInfos.push(ve)}}},W=function(te,J){var re=J.idx;J.signerid_issuer1=O(te,re,[1,0],"30"),J.signerid_serial1=k(te,re,[1,1],"02"),J.hashalg=P(k(te,re,[2,0],"06"));var pe=F(te,re,[3],"a0");J.idxSignedAttrs=pe,se(te,J,pe);var be=U(te,re),Fe=be.length;if(Fe<6)throw"malformed SignerInfo";J.sigalg=P(k(te,re,[Fe-2,0],"06")),J.sigval=k(te,re,[Fe-1],"04")},se=function(te,J,re){var pe=U(te,re);J.signedAttrIdxList=pe;for(var be=0;be<pe.length;be++){var Fe=pe[be],ve=k(te,Fe,[0],"06"),Ce;ve==="2a864886f70d010905"?(Ce=Jt(k(te,Fe,[1,0])),J.saSigningTime=Ce):ve==="2a864886f70d010904"&&(Ce=k(te,Fe,[1,0],"04"),J.saMessageDigest=Ce)}},he=function(te,J){if(k(te,0,[0],"06")!=="2a864886f70d010702")return J;J.cmsType="signedData",J.econtent=k(te,0,[1,0,2,1,0]),N(te,J),J.signerInfos=[],j(te,J)},de=function(te,J){for(var re=J.parse.signerInfos,pe=re.length,be=!0,Fe=0;Fe<pe;Fe++){var ve=re[Fe];G(te,J,ve),ve.isValid||(be=!1)}J.isValid=be},fe=function(te,J,re,pe){var be=J.parse.certsIdx,Fe;if(J.certs===void 0){Fe=[],J.certkeys=[];for(var ve=U(te,be),Ce=0;Ce<ve.length;Ce++){var Ne=L(te,ve[Ce]),Me=new lt;Me.readCertHex(Ne),Fe[Ce]=Me,J.certkeys[Ce]=Me.getPublicKey()}J.certs=Fe}else Fe=J.certs;J.cccc=Fe.length,J.cccci=ve.length;for(var Ce=0;Ce<Fe.length;Ce++){var rr=Me.getIssuerHex(),pn=Me.getSerialNumberHex();re.signerid_issuer1===rr&&re.signerid_serial1===pn&&(re.certkey_idx=Ce)}},G=function(te,J,re,pe){re.verifyDetail={};var be=re.verifyDetail,Fe=J.parse.econtent,ve=re.hashalg,Ce=re.saMessageDigest;be.validMessageDigest=!1,D(Fe,ve)===Ce&&(be.validMessageDigest=!0),fe(te,J,re),be.validSignatureValue=!1;var Ne=re.sigalg,Me="31"+L(te,re.idxSignedAttrs).substr(2);re.signedattrshex=Me;var rr=J.certs[re.certkey_idx].getPublicKey(),pn=new y.crypto.Signature({alg:Ne});pn.init(rr),pn.updateHex(Me);var tn=pn.verify(re.sigval);be.validSignatureValue_isValid=tn,tn===!0&&(be.validSignatureValue=!0),re.isValid=!1,be.validMessageDigest&&be.validSignatureValue&&(re.isValid=!0)},Q={isValid:!1,parse:{}};return he(A,Q.parse),de(A,Q),Q},y.asn1.cms.CMSParser=function(){var s=Error,c=lt,l=new c,d=je,g=d.getV,m=d.getTLV;d.getIdxbyList;var T=d.getTLVbyList,k=d.getTLVbyListEx,O=d.getVbyList,F=d.getVbyListEx,U=d.getChildIdx;this.getCMSSignedData=function(L){var P=T(L,0,[1,0]),D=this.getSignedData(P);return D},this.getSignedData=function(L){var P=U(L,0),D={},A=g(L,P[0]),N=parseInt(A,16);D.version=N;var j=m(L,P[1]);D.hashalgs=this.getHashAlgArray(j);var W=m(L,P[2]);D.econtent=this.getEContent(W);var se=k(L,0,["[0]"]);se!=null&&(D.certs=this.getCertificateSet(se)),k(L,0,["[1]"]);var he=k(L,0,[3]);return D.sinfos=this.getSignerInfos(he),D},this.getHashAlgArray=function(L){for(var P=U(L,0),D=new c,A=[],N=0;N<P.length;N++){var j=m(L,P[N]),W=D.getAlgorithmIdentifierName(j);A.push(W)}return A},this.getEContent=function(L){var P={},D=O(L,0,[0]),A=O(L,0,[1,0]);return P.type=y.asn1.x509.OID.oid2name(je.hextooidstr(D)),P.content={hex:A},P},this.getSignerInfos=function(L){for(var P=[],D=U(L,0),A=0;A<D.length;A++){var N=m(L,D[A]),j=this.getSignerInfo(N);P.push(j)}return P},this.getSignerInfo=function(L){var P={},D=U(L,0),A=d.getInt(L,D[0],-1);A!=-1&&(P.version=A);var N=m(L,D[1]),j=this.getIssuerAndSerialNumber(N);P.id=j;var W=m(L,D[2]),se=l.getAlgorithmIdentifierName(W);P.hashalg=se;var he=k(L,0,["[0]"]);if(he!=null){var de=this.getAttributeList(he);P.sattrs=de}var fe=k(L,0,[3]),G=l.getAlgorithmIdentifierName(fe);P.sigalg=G;var Q=F(L,0,[4]);P.sighex=Q;var te=k(L,0,["[1]"]);if(te!=null){var J=this.getAttributeList(te);P.uattrs=J}return P},this.getSignerIdentifier=function(L){if(L.substr(0,2)=="30")return this.getIssuerAndSerialNumber(L);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(L){var P={type:"isssn"},D=U(L,0),A=m(L,D[0]);P.issuer=l.getX500Name(A);var N=g(L,D[1]);return P.serial={hex:N},P},this.getAttributeList=function(L){for(var P=[],D=U(L,0),A=0;A<D.length;A++){var N=m(L,D[A]),j=this.getAttribute(N);P.push(j)}return{array:P}},this.getAttribute=function(L){var P={},D=U(L,0),A=d.getOID(L,D[0]),N=y.asn1.x509.OID.oid2name(A);P.attr=N;var j=m(L,D[1]),W=U(j,0);if(W.length==1)P.valhex=m(j,W[0]);else{for(var se=[],he=0;he<W.length;he++)se.push(m(j,W[he]));P.valhex=se}return N=="contentType"?this.setContentType(P):N=="messageDigest"?this.setMessageDigest(P):N=="signingTime"?this.setSigningTime(P):N=="signingCertificate"?this.setSigningCertificate(P):N=="signingCertificateV2"?this.setSigningCertificateV2(P):N=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(P),P},this.setContentType=function(L){var P=d.getOIDName(L.valhex,0,null);P!=null&&(L.type=P,delete L.valhex)},this.setSigningTime=function(L){var P=g(L.valhex,0),D=Jt(P);L.str=D,delete L.valhex},this.setMessageDigest=function(L){var P=g(L.valhex,0);L.hex=P,delete L.valhex},this.setSigningCertificate=function(L){var P=U(L.valhex,0);if(P.length>0){for(var D=m(L.valhex,P[0]),A=U(D,0),N=[],j=0;j<A.length;j++){var W=m(D,A[j]),se=this.getESSCertID(W);N.push(se)}L.array=N}if(P.length>1){var he=m(L.valhex,P[1]);L.polhex=he}delete L.valhex},this.setSignaturePolicyIdentifier=function(L){var P=U(L.valhex,0);if(P.length>0){var D=d.getOID(L.valhex,P[0]);L.oid=D}if(P.length>1){var A=new c,N=U(L.valhex,P[1]),j=m(L.valhex,N[0]),W=A.getAlgorithmIdentifierName(j);L.alg=W;var se=g(L.valhex,N[1]);L.hash=se}delete L.valhex},this.setSigningCertificateV2=function(L){var P=U(L.valhex,0);if(P.length>0){for(var D=m(L.valhex,P[0]),A=U(D,0),N=[],j=0;j<A.length;j++){var W=m(D,A[j]),se=this.getESSCertIDv2(W);N.push(se)}L.array=N}if(P.length>1){var he=m(L.valhex,P[1]);L.polhex=he}delete L.valhex},this.getESSCertID=function(L){var P={},D=U(L,0);if(D.length>0){var A=g(L,D[0]);P.hash=A}if(D.length>1){var N=m(L,D[1]),j=this.getIssuerSerial(N);j.serial!=null&&(P.serial=j.serial),j.issuer!=null&&(P.issuer=j.issuer)}return P},this.getESSCertIDv2=function(L){var P={},D=U(L,0);if(D.length<1||3<D.length)throw new s("wrong number of elements");var A=0;if(L.substr(D[0],2)=="30"){var N=m(L,D[0]);P.alg=l.getAlgorithmIdentifierName(N),A++}else P.alg="sha256";var j=g(L,D[A]);if(P.hash=j,D.length>A+1){var W=m(L,D[A+1]),se=this.getIssuerSerial(W);P.issuer=se.issuer,P.serial=se.serial}return P},this.getIssuerSerial=function(L){var P={},D=U(L,0),A=m(L,D[0]),N=l.getGeneralNames(A),j=N[0].dn;P.issuer=j;var W=g(L,D[1]);return P.serial={hex:W},P},this.getCertificateSet=function(L){for(var P=U(L,0),D=[],A=0;A<P.length;A++){var N=m(L,P[A]);if(N.substr(0,2)=="30"){var j=nr(N,"CERTIFICATE");D.push(j)}}return{array:D,sortflag:!1}}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.tsp>"u"||!y.asn1.tsp)&&(y.asn1.tsp={}),y.asn1.tsp.TimeStampToken=function(s){var c=y,l=c.asn1,d=l.tsp;d.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var g=new d.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=g.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.TimeStampToken,y.asn1.cms.SignedData),y.asn1.tsp.TSTInfo=function(s){var c=y,l=c.asn1,d=l.DERSequence,g=l.DERInteger,m=l.DERBoolean,T=l.DERGeneralizedTime,k=l.DERObjectIdentifier,O=l.DERTaggedObject,F=l.tsp,U=F.MessageImprint,L=F.Accuracy;l.x509.X500Name;var P=l.x509.GeneralName;if(F.TSTInfo.superclass.constructor.call(this),this.dVersion=new g({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var D=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(D.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(D.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(D.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");D.push(this.dGenTime),this.dAccuracy!=null&&D.push(this.dAccuracy),this.dOrdering!=null&&D.push(this.dOrdering),this.dNonce!=null&&D.push(this.dNonce),this.dTsa!=null&&D.push(this.dTsa);var A=new d({array:D});return this.hTLV=A.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0){if(typeof s.policy=="string"){if(!s.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new k({oid:s.policy})}s.messageImprint!==void 0&&(this.dMessageImprint=new U(s.messageImprint)),s.serial!==void 0&&(this.dSerial=new g(s.serial)),s.genTime!==void 0&&(this.dGenTime=new T(s.genTime)),s.accuracy!==void 0&&(this.dAccuracy=new L(s.accuracy)),s.ordering!==void 0&&s.ordering==!0&&(this.dOrdering=new m),s.nonce!==void 0&&(this.dNonce=new g(s.nonce)),s.tsa!==void 0&&(this.dTsa=new O({tag:"a0",explicit:!0,obj:new P({dn:s.tsa})}))}},Ie(y.asn1.tsp.TSTInfo,y.asn1.ASN1Object),y.asn1.tsp.Accuracy=function(s){var c=y,l=c.asn1,d=l.ASN1Util.newObject;l.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var g=this.params,m=[];return g.seconds!=null&&typeof g.seconds=="number"&&m.push({int:g.seconds}),g.millis!=null&&typeof g.millis=="number"&&m.push({tag:{tagi:"80",obj:{int:g.millis}}}),g.micros!=null&&typeof g.micros=="number"&&m.push({tag:{tagi:"81",obj:{int:g.micros}}}),d({seq:m}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.Accuracy,y.asn1.ASN1Object),y.asn1.tsp.MessageImprint=function(s){var c=y,l=c.asn1,d=l.DERSequence,g=l.DEROctetString,m=l.x509,T=m.AlgorithmIdentifier;l.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params,O=new T({name:k.alg}),F=new g({hex:k.hash}),U=new d({array:[O,F]});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.tsp.MessageImprint,y.asn1.ASN1Object),y.asn1.tsp.TimeStampReq=function(s){var c=y,l=c.asn1,d=l.DERSequence,g=l.DERInteger,m=l.DERBoolean;l.ASN1Object;var T=l.DERObjectIdentifier,k=l.tsp,O=k.MessageImprint;k.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];U.push(new g({int:1})),F.messageImprint instanceof y.asn1.ASN1Object?U.push(F.messageImprint):U.push(new O(F.messageImprint)),F.policy!=null&&U.push(new T(F.policy)),F.nonce!=null&&U.push(new g(F.nonce)),F.certreq==!0&&U.push(new m);var L=new d({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.TimeStampReq,y.asn1.ASN1Object),y.asn1.tsp.TimeStampResp=function(s){var c=y,l=c.asn1,d=l.DERSequence;l.ASN1Object;var g=l.tsp,m=g.PKIStatusInfo;g.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var T=this.params,k=[];if(T.econtent!=null||T.tst!=null)if(T.statusinfo!=null?k.push(new m(T.statusinfo)):k.push(new m("granted")),T.econtent!=null)k.push(new g.TimeStampToken(T).getContentInfo());else if(T.tst instanceof l.ASN1Object)k.push(T.tst);else throw new Error("improper member tst value");else if(T.statusinfo!=null)k.push(new m(T.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var O=new d({array:k});return O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.TimeStampResp,y.asn1.ASN1Object),y.asn1.tsp.PKIStatusInfo=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSequence,m=d.tsp,T=m.PKIStatus,k=m.PKIFreeText,O=m.PKIFailureInfo;m.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];if(typeof F=="string")U.push(new T(F));else{if(F.status==null)throw new c("property 'status' unspecified");U.push(new T(F.status)),F.statusstr!=null&&U.push(new k(F.statusstr)),F.failinfo!=null&&U.push(new O(F.failinfo))}var L=new g({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.PKIStatusInfo,y.asn1.ASN1Object),y.asn1.tsp.PKIStatus=function(s){var c=Error,l=y,d=l.asn1,g=d.DERInteger,m=d.tsp;m.PKIStatus.superclass.constructor.call(this);var T={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var k=this.params,O;if(typeof k=="string")try{O=T[k]}catch{throw new c("undefined name: "+k)}else if(typeof k=="number")O=k;else throw new c("unsupported params");return new g({int:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.PKIStatus,y.asn1.ASN1Object),y.asn1.tsp.PKIFreeText=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSequence,m=d.DERUTF8String,T=d.tsp;T.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;if(!k instanceof Array)throw new c("wrong params: not array");for(var O=[],F=0;F<k.length;F++)O.push(new m({str:k[F]}));var U=new g({array:O});return U.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.PKIFreeText,y.asn1.ASN1Object),y.asn1.tsp.PKIFailureInfo=function(s){var c=Error,l=y,d=l.asn1,g=d.DERBitString,m=d.tsp,T=m.PKIFailureInfo,k={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};T.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var O=this.params,F=0;if(typeof O=="number"&&0<=O&&O<=25){F|=1<<O;for(var U=F.toString(2),L="",P=U.length-1;P>=0;P--)L+=U[P];return L}else{if(typeof O=="string"&&k[O]!=null)return Jl([O],k);if(typeof O=="object"&&O.length!=null)return Jl(O,k);throw new c("wrong params")}},this.tohex=function(){this.params;var O=this.getBinValue();return new g({bin:O}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.tsp.PKIFailureInfo,y.asn1.ASN1Object),y.asn1.tsp.AbstractTSAAdapter=function(s){this.getTSTHex=function(c,l){throw"not implemented yet"}},y.asn1.tsp.SimpleTSAAdapter=function(s){var c=y,l=c.asn1,d=l.tsp,g=c.crypto.Util.hashHex;d.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(m,T){var k=g(m,T);this.params.econtent.content.messageImprint={alg:T,hash:k},this.params.econtent.content.serial={int:this.serial++};var O=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:O};var F=new d.TimeStampToken(this.params);return F.getContentInfoEncodedHex()},s!==void 0&&(this.params=s)},Ie(y.asn1.tsp.SimpleTSAAdapter,y.asn1.tsp.AbstractTSAAdapter),y.asn1.tsp.FixedTSAAdapter=function(s){var c=y,l=c.asn1,d=l.tsp,g=c.crypto.Util.hashHex;d.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(m,T){var k=g(m,T);this.params.econtent.content.messageImprint={alg:T,hash:k};var O=new d.TimeStampToken(this.params);return O.getContentInfoEncodedHex()},s!==void 0&&(this.params=s)},Ie(y.asn1.tsp.FixedTSAAdapter,y.asn1.tsp.AbstractTSAAdapter),y.asn1.tsp.TSPUtil=new function(){},y.asn1.tsp.TSPUtil.newTimeStampToken=function(s){return new y.asn1.tsp.TimeStampToken(s)},y.asn1.tsp.TSPUtil.parseTimeStampReq=function(s){var c=new y.asn1.tsp.TSPParser;return c.getTimeStampReq(s)},y.asn1.tsp.TSPUtil.parseMessageImprint=function(s){var c=new y.asn1.tsp.TSPParser;return c.getMessageImprint(s)},y.asn1.tsp.TSPParser=function(){var s=lt,c=new s,l=je,d=l.getV,g=l.getTLV,m=l.getIdxbyList;l.getTLVbyListEx;var T=l.getChildIdx,k=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],O={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(F){var U=T(F,0);if(U.length==1)return this.getPKIStatusInfo(g(F,U[0]));if(U.length>1){var L=this.getPKIStatusInfo(g(F,U[0])),P=g(F,U[1]),D=this.getToken(P);return D.statusinfo=L,D}},this.getToken=function(F){var U=new y.asn1.cms.CMSParser,L=U.getCMSSignedData(F);return this.setTSTInfo(L),L},this.setTSTInfo=function(F){var U=F.econtent;if(U.type=="tstinfo"){var L=U.content.hex,P=this.getTSTInfo(L);U.content=P}},this.getTSTInfo=function(F){var U={},L=T(F,0),P=d(F,L[1]);U.policy=Wl(P);var D=g(F,L[2]);U.messageImprint=this.getMessageImprint(D);var A=d(F,L[3]);U.serial={hex:A};var N=d(F,L[4]);U.genTime={str:Jt(N)};var j=0;if(L.length>5&&F.substr(L[5],2)=="30"){var W=g(F,L[5]);U.accuracy=this.getAccuracy(W),j++}if(L.length>5+j&&F.substr(L[5+j],2)=="01"){var se=d(F,L[5+j]);se=="ff"&&(U.ordering=!0),j++}if(L.length>5+j&&F.substr(L[5+j],2)=="02"){var he=d(F,L[5+j]);U.nonce={hex:he},j++}if(L.length>5+j&&F.substr(L[5+j],2)=="a0"){var de=g(F,L[5+j]);de="30"+de.substr(2),pGeneralNames=c.getGeneralNames(de);var fe=pGeneralNames[0].dn;U.tsa=fe,j++}if(L.length>5+j&&F.substr(L[5+j],2)=="a1"){var G=g(F,L[5+j]);G="30"+G.substr(2);var Q=c.getExtParamArray(G);U.ext=Q,j++}return U},this.getAccuracy=function(F){for(var U={},L=T(F,0),P=0;P<L.length;P++){var D=F.substr(L[P],2),A=d(F,L[P]),N=parseInt(A,16);D=="02"?U.seconds=N:D=="80"?U.millis=N:D=="81"&&(U.micros=N)}return U},this.getMessageImprint=function(F){if(F.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var U={};T(F,0);var L=m(F,0,[0,0]),P=d(F,L),D=l.hextooidstr(P),A=y.asn1.x509.OID.oid2name(D);if(A=="")throw new Error("hashAlg name undefined: "+D);var N=A,j=m(F,0,[1]);return U.alg=N,U.hash=d(F,j),U},this.getPKIStatusInfo=function(F){var U={},L=T(F,0),P=0;try{var D=d(F,L[0]),A=parseInt(D,16);U.status=k[A]}catch{}if(L.length>1&&F.substr(L[1],2)=="30"){var N=g(F,L[1]);U.statusstr=this.getPKIFreeText(N),P++}if(L.length>P&&F.substr(L[1+P],2)=="03"){var j=g(F,L[1+P]);U.failinfo=this.getPKIFailureInfo(j)}return U},this.getPKIFreeText=function(F){for(var U=[],L=T(F,0),P=0;P<L.length;P++)U.push(l.getString(F,L[P]));return U},this.getPKIFailureInfo=function(F){var U=l.getInt(F,0);return O[U]!=null?O[U]:U},this.getTimeStampReq=function(F){var U={};U.certreq=!1;var L=T(F,0);if(L.length<2)throw new Error("TimeStampReq must have at least 2 items");var P=g(F,L[1]);U.messageImprint=y.asn1.tsp.TSPUtil.parseMessageImprint(P);for(var D=2;D<L.length;D++){var A=L[D],N=F.substr(A,2);if(N=="06"){var j=d(F,A);U.policy=l.hextooidstr(j)}N=="02"&&(U.nonce=d(F,A)),N=="01"&&(U.certreq=!0)}return U}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.cades>"u"||!y.asn1.cades)&&(y.asn1.cades={}),y.asn1.cades.SignaturePolicyIdentifier=function(s){var c=y,l=c.asn1,d=l.cades,g=d.SignaturePolicyId;d.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new g(this.params)]},this.setByParam=function(m){this.params=m},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.SignaturePolicyIdentifier,y.asn1.cms.Attribute),y.asn1.cades.SignaturePolicyId=function(s){var c=y,l=c.asn1,d=l.DERSequence,g=l.DERObjectIdentifier,m=l.x509;m.AlgorithmIdentifier;var T=l.cades,k=T.SignaturePolicyId,O=T.OtherHashAlgAndValue;k.superclass.constructor.call(this),this.params=null,this.tohex=function(){var F=this.params,U=[];U.push(new g(F.oid)),U.push(new O(F));var L=new d({array:U});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(F){this.params=F},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.SignaturePolicyId,y.asn1.ASN1Object),y.asn1.cades.OtherHashAlgAndValue=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSequence,m=d.DEROctetString,T=d.x509,k=T.AlgorithmIdentifier,O=d.cades,F=O.OtherHashAlgAndValue;F.superclass.constructor.call(this),this.params=null,this.tohex=function(){var U=this.params;if(U.alg==null)throw new c("property 'alg' not specified");if(U.hash==null&&U.cert==null)throw new c("property 'hash' nor 'cert' not specified");var L=null;if(U.hash!=null)L=U.hash;else if(U.cert!=null){if(typeof U.cert!="string")throw new c("cert not string");var P=U.cert;U.cert.indexOf("-----BEGIN")!=-1&&(P=bn(U.cert)),L=y.crypto.Util.hashHex(P,U.alg)}var D=[];D.push(new k({name:U.alg})),D.push(new m({hex:L}));var A=new g({array:D});return A.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.OtherHashAlgAndValue,y.asn1.ASN1Object),y.asn1.cades.OtherHashValue=function(s){y.asn1.cades.OtherHashValue.superclass.constructor.call(this);var c=Error,l=y;l.lang.String.isHex;var d=l.asn1,g=d.DEROctetString;l.crypto.Util.hashHex,this.params=null,this.tohex=function(){var m=this.params;if(m.hash==null&&m.cert==null)throw new c("hash or cert not specified");var T=null;if(m.hash!=null)T=m.hash;else if(m.cert!=null){if(typeof m.cert!="string")throw new c("cert not string");var k=m.cert;m.cert.indexOf("-----BEGIN")!=-1&&(k=bn(m.cert)),T=y.crypto.Util.hashHex(k,"sha1")}return new g({hex:T}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.OtherHashValue,y.asn1.ASN1Object),y.asn1.cades.SignatureTimeStamp=function(s){var c=Error,l=y,d=l.lang.String.isHex,g=l.asn1,m=g.ASN1Object;g.x509;var T=g.cades;T.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var k=this.params;if(k.tst!=null)if(d(k.tst)){var O=new m;return O.hTLV=k.tst,[O]}else{if(k.tst instanceof m)return[k.tst];throw new c("params.tst has wrong value")}else if(k.res!=null){var F=k.res;if(F instanceof m&&(F=F.tohex()),typeof F!="string"||!d(F))throw new c("params.res has wrong value");je.getTLVbyList(F,0,[1]);var O=new m;return O.hTLV=k.tst,[O]}},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.SignatureTimeStamp,y.asn1.cms.Attribute),y.asn1.cades.CompleteCertificateRefs=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSequence,m=d.cades,T=m.OtherCertID,k=l.lang.String.isHex;m.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var O=this.params,F=[],U=0;U<O.array.length;U++){var L=O.array[U];if(typeof L=="string")if(L.indexOf("-----BEGIN")!=-1)L={cert:L};else if(k(L))L={hash:L};else throw new c("unsupported value: "+L);O.alg!=null&&L.alg==null&&(L.alg=O.alg),O.hasis!=null&&L.hasis==null&&(L.hasis=O.hasis);var P=new T(L);F.push(P)}var D=new g({array:F});return[D]},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.CompleteCertificateRefs,y.asn1.cms.Attribute),y.asn1.cades.OtherCertID=function(s){var c=y,l=c.asn1,d=l.DERSequence,g=l.cms,m=g.IssuerSerial,T=l.cades,k=T.OtherHashValue,O=T.OtherHashAlgAndValue;T.OtherCertID.superclass.constructor.call(this),this.params=s,this.tohex=function(){var F=this.params;typeof F=="string"&&(F.indexOf("-----BEGIN")!=-1?F={cert:F}:_isHex(F)&&(F={hash:F}));var U=[],L=null;if(F.alg!=null?L=new O(F):L=new k(F),U.push(L),F.cert!=null&&F.hasis==!0||F.issuer!=null&&F.serial!=null){var P=new m(F);U.push(P)}var D=new d({array:U});return D.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.OtherCertID,y.asn1.ASN1Object),y.asn1.cades.OtherHash=function(s){var c=y,l=c.asn1;l.cms;var d=l.cades,g=d.OtherHashAlgAndValue,m=d.OtherHashValue;c.crypto.Util.hashHex;var T=c.lang.String.isHex;d.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var k=this.params;typeof k=="string"&&(k.indexOf("-----BEGIN")!=-1?k={cert:k}:T(k)&&(k={hash:k}));var O=null;return k.alg!=null?O=new g(k):O=new m(k),O.tohex()},this.getEncodedHex=function(){return this.tohex()},s!=null&&this.setByParam(s)},Ie(y.asn1.cades.OtherHash,y.asn1.ASN1Object),y.asn1.cades.CAdESUtil=new function(){},y.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(s){var c=new y.asn1.cms.CMSParser,l=c.getCMSSignedData(s);return l},y.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(s,c,l){var d=je,g=d.getChildIdx,m=d.getTLV,T=d.getV,k=y,O=k.asn1,F=O.ASN1Object,U=O.cms,L=U.AttributeList,P=U.SignerInfo,D={},A=g(s,c);if(A.length!=6)throw"not supported items for SignerInfo (!=6)";var N=A.shift();D.version=m(s,N);var j=A.shift();D.si=m(s,j);var W=A.shift();D.digalg=m(s,W);var se=A.shift();D.sattrs=m(s,se);var he=A.shift();D.sigalg=m(s,he);var de=A.shift();D.sig=m(s,de),D.sigval=T(s,de);var fe=null;return D.obj=new P,fe=new F,fe.hTLV=D.version,D.obj.dCMSVersion=fe,fe=new F,fe.hTLV=D.si,D.obj.dSignerIdentifier=fe,fe=new F,fe.hTLV=D.digalg,D.obj.dDigestAlgorithm=fe,fe=new F,fe.hTLV=D.sattrs,D.obj.dSignedAttrs=fe,fe=new F,fe.hTLV=D.sigalg,D.obj.dSigAlg=fe,fe=new F,fe.hTLV=D.sig,D.obj.dSig=fe,D.obj.dUnsignedAttrs=new L,D},(typeof y.asn1.csr>"u"||!y.asn1.csr)&&(y.asn1.csr={}),y.asn1.csr.CertificationRequest=function(s){var c=y,l=c.asn1,d=l.DERBitString,g=l.DERSequence,m=l.csr;l.x509;var T=m.CertificationRequestInfo;m.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(k){this.params=k},this.sign=function(){var k=new T(this.params).tohex(),O=new y.crypto.Signature({alg:this.params.sigalg});O.init(this.params.sbjprvkey),O.updateHex(k);var F=O.sign();this.params.sighex=F},this.getPEM=function(){return nr(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var k=this.params,O=new y.asn1.csr.CertificationRequestInfo(this.params),F=new y.asn1.x509.AlgorithmIdentifier({name:k.sigalg});if(k.sighex==null&&k.sbjprvkey!=null&&this.sign(),k.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var U=new d({hex:"00"+k.sighex}),L=new g({array:[O,F,U]});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.csr.CertificationRequest,y.asn1.ASN1Object),y.asn1.csr.CertificationRequestInfo=function(s){var c=y,l=c.asn1;l.DERBitString;var d=l.DERSequence,g=l.DERInteger,m=l.DERUTF8String,T=l.DERTaggedObject,k=l.ASN1Util.newObject,O=l.csr,F=l.x509,U=F.X500Name,L=F.Extensions,P=F.SubjectPublicKeyInfo;O.AttributeList,O.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(A){A!=null&&(this.params=A)},this.tohex=function(){var A=this.params,N=[];if(N.push(new g({int:0})),N.push(new U(A.subject)),N.push(new P(Nt.getKey(A.sbjpubkey))),A.attrs!=null){var j=D(A.attrs),W=k({tag:{tage:"a0",obj:j}});N.push(W)}else if(A.extreq!=null){var se=new L(A.extreq),W=k({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[se]}]}}});N.push(W)}else N.push(new T({tag:"a0",explicit:!1,obj:new m({str:""})}));var he=new d({array:N});return he.tohex()},this.getEncodedHex=function(){return this.tohex()};function D(A){for(var N=Error,j=y.asn1.x509.Extensions,W=[],se=0;se<A.length;se++){var he=A[se],de=he.attr;if(de=="extensionRequest"){var fe=new j(he.ext),G={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[fe]}]};W.push(G)}else if(de=="unstructuredName"){var G={seq:[{oid:"1.2.840.113549.1.9.2"},{set:he.names}]};W.push(G)}else if(de=="challengePassword"){var G={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:he.password}]}]};W.push(G)}else throw new N("unknown CSR attribute")}return{set:W}}s!=null&&this.setByParam(s)},Ie(y.asn1.csr.CertificationRequestInfo,y.asn1.ASN1Object),y.asn1.csr.AttributeList=function(s){},Ie(y.asn1.csr.AttributeList,y.asn1.ASN1Object),y.asn1.csr.CSRUtil=new function(){},y.asn1.csr.CSRUtil.newCSRPEM=function(s){var c=y.asn1.csr,l=new c.CertificationRequest(s),d=l.getPEM();return d},y.asn1.csr.CSRUtil.getParam=function(s,c){var l=je,d=l.getV,g=l.getIdxbyList,m=l.getTLVbyList,T=l.getTLVbyListEx,k=l.getVbyListEx,O=function(se){var he=g(se,0,[0,3,0,0],"06");return d(se,he)!="2a864886f70d01090e"?null:m(se,0,[0,3,0,1,0],"30")},F={};if(s.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var U=bn(s,"CERTIFICATE REQUEST");c&&(F.tbs=m(U,0,[0]));try{var L=T(U,0,[0,1]);if(L=="3000")F.subject={};else{var N=new lt;F.subject=N.getX500Name(L)}}catch{}var P=T(U,0,[0,2]),D=Nt.getKey(P,null,"pkcs8pub");F.sbjpubkey=Nt.getPEM(D,"PKCS8PUB");var A=O(U),N=new lt;A!=null&&(F.extreq=N.getExtParamArray(A));try{var j=T(U,0,[1],"30"),N=new lt;F.sigalg=N.getAlgorithmIdentifierName(j)}catch{}try{var W=k(U,0,[2]);F.sighex=W}catch{}return F},y.asn1.csr.CSRUtil.verifySignature=function(s){try{var c=null;if(typeof s=="string"&&s.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?c=y.asn1.csr.CSRUtil.getParam(s,!0):typeof s=="object"&&s.sbjpubkey!=null&&s.sigalg!=null&&s.sighex!=null&&s.tbs!=null&&(c=s),c==null)return!1;var l=new y.crypto.Signature({alg:c.sigalg});return l.init(c.sbjpubkey),l.updateHex(c.tbs),l.verify(c.sighex)}catch(d){return alert(d),!1}},(typeof y>"u"||!y)&&(y={}),(typeof y.asn1>"u"||!y.asn1)&&(y.asn1={}),(typeof y.asn1.ocsp>"u"||!y.asn1.ocsp)&&(y.asn1.ocsp={}),y.asn1.ocsp.DEFAULT_HASH="sha1",y.asn1.ocsp.OCSPResponse=function(s){y.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),y.asn1.DEREnumerated;var c=y.asn1.ASN1Util.newObject,l=y.asn1.ocsp.ResponseBytes,d=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var g=this.params.resstatus;return typeof g=="number"?g:typeof g!="string"?-1:d.indexOf(g)},this.setByParam=function(g){this.params=g},this.tohex=function(){var g=this.params,m=this._getStatusCode();if(m==-1)throw new Error("responseStatus not supported: "+g.resstatus);if(m!=0)return c({seq:[{enum:{int:m}}]}).tohex();var T=new l(g);return c({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:T}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.OCSPResponse,y.asn1.ASN1Object),y.asn1.ocsp.ResponseBytes=function(s){y.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.DERObjectIdentifier,g=c.DEROctetString,m=c.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(T){this.params=T},this.tohex=function(){var T=this.params;if(T.restype!="ocspBasic")throw new Error("not supported responseType: "+T.restype);var k=new m(T),O=[];O.push(new d({name:"ocspBasic"})),O.push(new g({hex:k.tohex()}));var F=new l({array:O});return F.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.ResponseBytes,y.asn1.ASN1Object),y.asn1.ocsp.BasicOCSPResponse=function(s){y.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var c=Error,l=y.asn1,d=l.ASN1Object,g=l.DERSequence;l.DERGeneralizedTime;var m=l.DERTaggedObject,T=l.DERBitString;l.x509.Extensions;var k=l.x509.AlgorithmIdentifier,O=l.ocsp;O.ResponderID,_SingleResponseList=O.SingleResponseList,_ResponseData=O.ResponseData,this.params=null,this.setByParam=function(F){this.params=F},this.sign=function(){var F=this.params,U=F.tbsresp.tohex(),L=new y.crypto.Signature({alg:F.sigalg});L.init(F.reskey),L.updateHex(U),F.sighex=L.sign()},this.tohex=function(){var F=this.params;F.tbsresp==null&&(F.tbsresp=new _ResponseData(F)),F.sighex==null&&F.reskey!=null&&this.sign();var U=[];if(U.push(F.tbsresp),U.push(new k({name:F.sigalg})),U.push(new T({hex:"00"+F.sighex})),F.certs!=null&&F.certs.length!=null){for(var L=[],P=0;P<F.certs.length;P++){var D=F.certs[P],A=null;if(je.isASN1HEX(D))A=D;else if(D.match(/-----BEGIN/))A=bn(D);else throw new c("certs["+P+"] not hex or PEM");L.push(new d({tlv:A}))}var N=new g({array:L});U.push(new m({tag:"a0",explicit:!0,obj:N}))}var j=new g({array:U});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.BasicOCSPResponse,y.asn1.ASN1Object),y.asn1.ocsp.ResponseData=function(s){y.asn1.ocsp.ResponseData.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.DERGeneralizedTime,g=c.DERTaggedObject,m=c.x509.Extensions,T=c.ocsp,k=T.ResponderID;_SingleResponseList=T.SingleResponseList,this.params=null,this.tohex=function(){var O=this.params;O.respid!=null,O.prodat!=null,O.array!=null;var F=[];if(F.push(new k(O.respid)),F.push(new d(O.prodat)),F.push(new _SingleResponseList(O.array)),O.ext!=null){var U=new m(O.ext);F.push(new g({tag:"a1",explicit:!0,obj:U}))}var L=new l({array:F});return L.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(O){this.params=O},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.ResponseData,y.asn1.ASN1Object),y.asn1.ocsp.ResponderID=function(s){y.asn1.ocsp.ResponderID.superclass.constructor.call(this);var c=y,l=c.asn1,d=l.ASN1Util.newObject,g=l.x509.X500Name,m=c.lang.String.isHex,T=Error;this.params=null,this.tohex=function(){var k=this.params;if(k.key!=null){var O=null;if(typeof k.key=="string"){if(m(k.key)&&(O=k.key),k.key.match(/-----BEGIN CERTIFICATE/)){var F=new lt(k.key),U=F.getExtSubjectKeyIdentifier();U!=null&&(O=U.kid.hex)}}else if(k.key instanceof lt){var U=k.key.getExtSubjectKeyIdentifier();U!=null&&(O=U.kid.hex)}if(O==null)throw new T("wrong key member value");var L=d({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:O}}}});return L.tohex()}else if(k.name!=null){var P=null;if(typeof k.name=="string"&&k.name.match(/-----BEGIN CERTIFICATE/)){var F=new lt(k.name);P=F.getSubject()}else k.name instanceof lt?P=k.name.getSubject():typeof k.name=="object"&&(k.name.array!=null||k.name.str!=null)&&(P=k.name);if(P==null)throw new T("wrong name member value");var L=d({tag:{tag:"a1",explicit:!0,obj:new g(P)}});return L.tohex()}throw new T("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(k){this.params=k},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.ResponderID,y.asn1.ASN1Object),y.asn1.ocsp.SingleResponseList=function(s){y.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var c=y.asn1,l=c.DERSequence,d=c.ocsp.SingleResponse;this.params=null,this.tohex=function(){var g=this.params;if(typeof g!="object"||g.length==null)throw new Error("params not specified properly");for(var m=[],T=0;T<g.length;T++)m.push(new d(g[T]));var k=new l({array:m});return k.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(g){this.params=g},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.SingleResponseList,y.asn1.ASN1Object),y.asn1.ocsp.SingleResponse=function(s){var c=Error,l=y,d=l.asn1,g=d.DERSequence,m=d.DERGeneralizedTime,T=d.DERTaggedObject,k=d.ocsp,O=k.CertID,F=k.CertStatus,U=d.x509,L=U.Extensions;k.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var P=this.params,D=[];if(P.certid==null)throw new c("certid unspecified");if(P.status==null)throw new c("status unspecified");if(P.thisupdate==null)throw new c("thisupdate unspecified");if(D.push(new O(P.certid)),D.push(new F(P.status)),D.push(new m(P.thisupdate)),P.nextupdate!=null){var A=new m(P.nextupdate);D.push(new T({tag:"a0",explicit:!0,obj:A}))}if(P.ext!=null){var N=new L(P.ext);D.push(new T({tag:"a1",explicit:!0,obj:N}))}var j=new g({array:D});return j.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(P){this.params=P},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.SingleResponse,y.asn1.ASN1Object),y.asn1.ocsp.CertID=function(s){var c=y,l=c.asn1,d=l.DEROctetString,g=l.DERInteger,m=l.DERSequence,T=l.x509,k=T.AlgorithmIdentifier,O=l.ocsp;O.DEFAULT_HASH;var F=c.crypto,U=F.Util.hashHex,L=lt,P=je,D=P.getVbyList;O.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(A,N,j,W){W==null&&(W=this.DEFAULT_HASH),this.params={alg:W,issname:A,isskey:N,sbjsn:j}},this.setByCert=function(A,N,j){j==null&&(j=this.DEFAULT_HASH),this.params={alg:j,issuerCert:A,subjectCert:N}},this.getParamByCerts=function(A,N,j){j==null&&(j=this.DEFAULT_HASH);var W=new L(A),se=new L(N),he=U(W.getSubjectHex(),j),de=W.getPublicKeyHex(),fe=U(D(de,0,[1],"03",!0),j),G=se.getSerialNumberHex(),Q={alg:j,issname:he,isskey:fe,sbjsn:G};return Q},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var A=this.params,N,j,W,se;if(A.alg==null?se=this.DEFAULT_HASH:se=A.alg,A.issuerCert!=null&&A.subjectCert!=null){var he=this.getParamByCerts(A.issuerCert,A.subjectCert,se);N=he.issname,j=he.isskey,W=he.sbjsn}else if(A.issname!=null&&A.isskey!=null&&A.sbjsn!=null)N=A.issname,j=A.isskey,W=A.sbjsn;else throw new Error("required param members not defined");var de=new k({name:se}),fe=new d({hex:N}),G=new d({hex:j}),Q=new g({hex:W}),te=new m({array:[de,fe,G,Q]});return this.hTLV=te.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.CertID,y.asn1.ASN1Object),y.asn1.ocsp.CertStatus=function(s){y.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var c=this.params;if(c.status=="good")return"8000";if(c.status=="unknown")return"8200";if(c.status=="revoked"){var l=[{gentime:{str:c.time}}];c.reason!=null&&l.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:c.reason}}}});var d={tag:"a1",explicit:!1,obj:{seq:l}};return y.asn1.ASN1Util.newObject({tag:d}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(c){this.params=c},s!==void 0&&this.setByParam(s)},Ie(y.asn1.ocsp.CertStatus,y.asn1.ASN1Object),y.asn1.ocsp.Request=function(s){var c=y,l=c.asn1,d=l.DERSequence,g=l.ocsp;if(g.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var T=[];if(this.dReqCert===null)throw"reqCert not set";T.push(this.dReqCert);var k=new d({array:T});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof s<"u"){var m=new g.CertID(s);this.dReqCert=m}},Ie(y.asn1.ocsp.Request,y.asn1.ASN1Object),y.asn1.ocsp.TBSRequest=function(s){var c=y,l=c.asn1,d=l.DERSequence,g=l.ocsp;g.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(m){for(var T=[],k=0;k<m.length;k++){var O=new g.Request(m[0]);T.push(O)}this.dRequestList=T},this.tohex=function(){var m=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var T=new d({array:this.dRequestList});if(m.push(T),this.dRequestExt!==null)throw"requestExtensions not supported";var k=new d({array:m});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&s.reqList!==void 0&&this.setRequestListByParam(s.reqList)},Ie(y.asn1.ocsp.TBSRequest,y.asn1.ASN1Object),y.asn1.ocsp.OCSPRequest=function(s){var c=y,l=c.asn1,d=l.DERSequence,g=l.ocsp;if(g.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var T=[];if(this.dTbsRequest!==null)T.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var k=new d({array:T});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},s!==void 0&&s.reqList!==void 0){var m=new g.TBSRequest(s);this.dTbsRequest=m}},Ie(y.asn1.ocsp.OCSPRequest,y.asn1.ASN1Object),y.asn1.ocsp.OCSPUtil={},y.asn1.ocsp.OCSPUtil.getRequestHex=function(s,c,l){var d=y,g=d.asn1,m=g.ocsp;l===void 0&&(l=m.DEFAULT_HASH);var T={alg:l,issuerCert:s,subjectCert:c},k=new m.OCSPRequest({reqList:[T]});return k.tohex()},y.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(s){var c=je,l=c.getVbyList,d=c.getVbyListEx,g=c.getIdxbyList;c.getIdxbyListEx;var m=c.getV,T={};try{var k=d(s,0,[0],"0a");T.responseStatus=parseInt(k,16)}catch{}if(T.responseStatus!==0)return T;try{var O=g(s,0,[1,0,1,0,0,2,0,1]);s.substr(O,2)==="80"?T.certStatus="good":s.substr(O,2)==="a1"?(T.certStatus="revoked",T.revocationTime=Jt(l(s,O,[0]))):s.substr(O,2)==="82"&&(T.certStatus="unknown")}catch{}try{var F=g(s,0,[1,0,1,0,0,2,0,2]);T.thisUpdate=Jt(m(s,F))}catch{}try{var U=g(s,0,[1,0,1,0,0,2,0,3]);s.substr(U,2)==="a0"&&(T.nextUpdate=Jt(l(s,U,[0])))}catch{}return T},y.asn1.ocsp.OCSPParser=function(){var s=Error,c=lt,l=new c,d=je,g=d.getV,m=d.getTLV,T=d.getIdxbyList,k=d.getVbyList,O=d.getTLVbyList,F=d.getVbyListEx,U=d.getTLVbyListEx,L=d.getChildIdx;this.getOCSPRequest=function(P){var D=L(P,0);if(D.length!=1&&D.length!=2)throw new s("wrong number elements: "+D.length);var A=this.getTBSRequest(m(P,D[0]));return A},this.getTBSRequest=function(P){var D={},A=U(P,0,[0],"30");D.array=this.getRequestList(A);var N=U(P,0,["[2]",0],"30");return N!=null&&(D.ext=l.getExtParamArray(N)),D},this.getRequestList=function(P){for(var D=[],A=L(P,0),N=0;N<A.length;N++){var P=m(P,A[N]);D.push(this.getRequest(P))}return D},this.getRequest=function(P){var D=L(P,0);if(D.length!=1&&D.length!=2)throw new s("wrong number elements: "+D.length);var A=this.getCertID(m(P,D[0]));if(D.length==2){var N=T(P,0,[1,0]);A.ext=l.getExtParamArray(m(P,N))}return A},this.getCertID=function(P){var D=L(P,0);if(D.length!=4)throw new s("wrong number elements: "+D.length);var A=new c,N={};return N.alg=A.getAlgorithmIdentifierName(m(P,D[0])),N.issname=g(P,D[1]),N.isskey=g(P,D[2]),N.sbjsn=g(P,D[3]),N},this.getOCSPResponse=function(P){var D=L(P,0),A,N=g(P,D[0]),j=parseInt(N);if(D.length==1)return{resstatus:j};var W=O(P,0,[1,0]);return A=this.getResponseBytes(W),A.resstatus=j,A},this.getResponseBytes=function(P){var D=L(P,0),A,N=O(P,0,[1,0]);A=this.getBasicOCSPResponse(N);var j=g(P,D[0]);return A.restype=y.asn1.x509.OID.oid2name(Wl(j)),A},this.getBasicOCSPResponse=function(P){var D=L(P,0),A;A=this.getResponseData(m(P,D[0]));var N=new lt;A.alg=N.getAlgorithmIdentifierName(m(P,D[1]));var j=g(P,D[2]);A.sighex=j.substr(2);var W=F(P,0,["[0]"]);if(W!=null){for(var se=L(W,0),he=[],de=0;de<se.length;de++){var fe=m(W,se[de]);he.push(fe)}A.certs=he}return A},this.getResponseData=function(P){var D=L(P,0),A=D.length,N={},j=0;P.substr(D[0],2)=="a0"&&j++,N.respid=this.getResponderID(m(P,D[j++]));var W=g(P,D[j++]);if(N.prodat=Jt(W),N.array=this.getSingleResponseList(m(P,D[j++])),P.substr(D[A-1],2)=="a1"){var se=O(P,D[A-1],[0]),he=new lt;N.ext=he.getExtParamArray(se)}return N},this.getResponderID=function(P){var D={};if(P.substr(0,2)=="a2"){var A=k(P,0,[0]);D.key=A}if(P.substr(0,2)=="a1"){var N=O(P,0,[0]),j=new lt;D.name=j.getX500Name(N)}return D},this.getSingleResponseList=function(P){for(var D=L(P,0),A=[],N=0;N<D.length;N++){var j=this.getSingleResponse(m(P,D[N]));A.push(j)}return A},this.getSingleResponse=function(P){var D=L(P,0),A={},N=this.getCertID(m(P,D[0]));A.certid=N;var j=this.getCertStatus(m(P,D[1]));if(A.status=j,P.substr(D[2],2)=="18"){var W=g(P,D[2]);A.thisupdate=Jt(W)}for(var se=3;se<D.length;se++){if(P.substr(D[se],2)=="a0"){var he=k(P,D[se],[0],"18");A.nextupdate=Jt(he)}if(P.substr(D[se],2)=="a1"){var de=new lt,fe=O(P,0,[se,0]);A.ext=de.getExtParamArray(fe)}}return A},this.getCertStatus=function(P){var D={};if(P=="8000")return{status:"good"};if(P=="8200")return{status:"unknown"};if(P.substr(0,2)=="a1"){D.status="revoked";var A=k(P,0,[0]),N=Jt(A);D.time=N}return D}};var y;(typeof y>"u"||!y)&&(y={}),(typeof y.lang>"u"||!y.lang)&&(y.lang={}),y.lang.String=function(){};function og(s){for(var c=new Array,l=0;l<s.length;l++)c[l]=s.charCodeAt(l);return c}function cg(s){for(var c="",l=0;l<s.length;l++)c=c+String.fromCharCode(s[l]);return c}function Ul(s){for(var c="",l=0;l<s.length;l++){var d=s[l].toString(16);d.length==1&&(d="0"+d),c=c+d}return c}function kr(s){return Ul(og(s))}function a2(s){return p(kr(s))}function o2(s){return Za(p(kr(s)))}function c2(s){return cg(v(tc(s)))}function Za(s){return s=s.replace(/\=/g,""),s=s.replace(/\+/g,"-"),s=s.replace(/\//g,"_"),s}function tc(s){return s.length%4==2?s=s+"==":s.length%4==3&&(s=s+"="),s=s.replace(/-/g,"+"),s=s.replace(/_/g,"/"),s}function On(s){return s.length%2==1&&(s="0"+s),Za(p(s))}function sn(s){return h(tc(s))}var nc,pi;typeof Buffer=="function"?(nc=function(s){return Za(Buffer.from(s,"utf8").toString("base64"))},pi=function(s){return Buffer.from(tc(s),"base64").toString("utf8")}):(nc=function(s){return On(ql($l(s)))},pi=function(s){return decodeURIComponent(zl(sn(s)))});function l2(s){return p(ql($l(s)))}function u2(s){return decodeURIComponent(zl(h(s)))}function Hl(s){return ql($l(s)).toLowerCase()}function Jt(s){try{return decodeURIComponent(zl(s))}catch{return null}}function d2(s){return Jt(h2(s))}function h2(s){for(var c=s.match(/.{1,2}/g),l=[],d=0;d<c.length;d++){var g=parseInt(c[d],16);161<=g&&g<=191?(l.push("c2"),l.push(c[d])):192<=g&&g<=255?(l.push("c3"),l.push((g-64).toString(16))):l.push(c[d])}return l.join("")}function Tr(s){for(var c="",l=0;l<s.length-1;l+=2)c+=String.fromCharCode(parseInt(s.substr(l,2),16));return c}function Bi(s){for(var c="",l=0;l<s.length;l++)c+=("0"+s.charCodeAt(l).toString(16)).slice(-2);return c}function Nh(s){return p(s)}function p2(s){return Vl(Nh(s),64)}function Vl(s,c){return s=s.replace(new RegExp("(.{"+c+"})","g"),`$1\r
`),s=s.replace(/\s+$/,""),s}function lg(s){var c=s.replace(/[^0-9A-Za-z\/+=]*/g,""),l=h(c);return l}function f2(s,c){return"-----BEGIN "+c+`-----\r
`+Vl(s,64)+`\r
-----END `+c+`-----\r
`}function nr(s,c){return"-----BEGIN "+c+`-----\r
`+Vl(Nh(s),64)+`\r
-----END `+c+`-----\r
`}function bn(s,c){if(s.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return c!==void 0?(s=s.replace(new RegExp("^[^]*-----BEGIN "+c+"-----"),""),s=s.replace(new RegExp("-----END "+c+"-----[^]*$"),"")):(s=s.replace(/^[^]*-----BEGIN [^-]+-----/,""),s=s.replace(/-----END [^-]+-----[^]*$/,"")),lg(s)}function m2(s){return s.indexOf("-----BEGIN ")==-1||s.indexOf("-----END ")==-1?null:(s=s.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),s=s.replace(/-----END [\s\S]+$/m,""),s=s.replace(/\s+/g,""),s.match(/^[0-9a-zA-Z+/=]+$/)?s:null)}function g2(s){if(s.length%2!=0)throw"input is not even length";if(s.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var c=new ArrayBuffer(s.length/2),l=new DataView(c),d=0;d<s.length/2;d++)l.setUint8(d,parseInt(s.substr(d*2,2),16));return c}function v2(s){for(var c="",l=new DataView(s),d=0;d<s.byteLength;d++)c+=("00"+l.getUint8(d).toString(16)).slice(-2);return c}function Oh(s){var c,l,d,g,m,T,k,O,F,U;if(s=dg(s),U=s.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),U)return c=parseInt(U[1]),l=parseInt(U[2])-1,d=parseInt(U[3]),g=parseInt(U[4]),m=parseInt(U[5]),T=parseInt(U[6]),k=0,O=U[7],O!==""&&(F=(O.substr(1)+"00").substr(0,3),k=parseInt(F)),Date.UTC(c,l,d,g,m,T,k);throw new Error("unsupported zulu format: "+s)}function y2(s){var c=new Date(s),l=("0000"+c.getUTCFullYear()).slice(-4),d=("00"+(c.getUTCMonth()+1)).slice(-2),g=("00"+c.getUTCDate()).slice(-2),m=("00"+c.getUTCHours()).slice(-2),T=("00"+c.getUTCMinutes()).slice(-2),k=("00"+c.getUTCSeconds()).slice(-2),O=("000"+c.getUTCMilliseconds()).slice(-3);return O=O.replace(/0+$/,""),O=O!=""?"."+O:O,l+d+g+m+T+k+O+"Z"}function ug(s){return Math.round(Oh(s)/1e3)}function _2(s){return new Date(Oh(s))}function b2(s,c,l){var d,g=s.getUTCFullYear();if(c){if(g<1950||2049<g)throw"not proper year for UTCTime: "+g;d=(""+g).slice(-2)}else d=("000"+g).slice(-4);if(d+=("0"+(s.getUTCMonth()+1)).slice(-2),d+=("0"+s.getUTCDate()).slice(-2),d+=("0"+s.getUTCHours()).slice(-2),d+=("0"+s.getUTCMinutes()).slice(-2),d+=("0"+s.getUTCSeconds()).slice(-2),l){var m=s.getUTCMilliseconds();m!==0&&(m=("00"+m).slice(-3),m=m.replace(/0+$/g,""),d+="."+m)}return d+="Z",d}function dg(s){return s.match(/^[0-9]{12}Z$/)||s.match(/^[0-9]{12}[.][0-9]*Z$/)?s.match(/^[0-4]/)?"20"+s:"19"+s:s}function ql(s){return s.replace(/%/g,"")}function zl(s){return s.replace(/(..)/g,"%$1")}function Mh(s){var c="malformed IPv6 address";if(!s.match(/^[0-9A-Fa-f:]+$/))throw c;s=s.toLowerCase();var l=s.split(":").length-1;if(l<2)throw c;var d=":".repeat(7-l+2);s=s.replace("::",d);var g=s.split(":");if(g.length!=8)throw c;for(var m=0;m<8;m++)g[m]=("0000"+g[m]).slice(-4);return g.join("")}function Lh(s){if(!s.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+s);s=s.toLowerCase();var c=s.match(/.{1,4}/g);c=c.map(function(g){return g.replace(/^0+/,"")}),c=c.map(function(g){return g==""?"0":g}),s=":"+c.join(":")+":";var l=s.match(/:(0:){2,}/g);if(l==null)return s.slice(1,-1);var d=l.sort().slice(-1)[0];return s=s.replace(d.substr(0,d.length-1),":"),s.substr(0,2)!="::"&&(s=s.substr(1)),s.substr(-2,2)!="::"&&(s=s.substr(0,s.length-1)),s}function Kl(s){var c=new Error("malformed hex value");if(!s.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw c;if(s.length==8){var l;try{return l=parseInt(s.substr(0,2),16)+"."+parseInt(s.substr(2,2),16)+"."+parseInt(s.substr(4,2),16)+"."+parseInt(s.substr(6,2),16),l}catch{throw c}}else if(s.length==16)try{return Kl(s.substr(0,8))+"/"+hg(s.substr(8))}catch{throw c}else{if(s.length==32)return Lh(s);if(s.length==64){try{return Lh(s.substr(0,32))+"/"+hg(s.substr(32))}catch{throw c}return}else return s}}function hg(s){var c=new Error("malformed mask"),l;try{l=new _(s,16).toString(2)}catch{throw c}if(!l.match(/^1*0*$/))throw c;return l.replace(/0+$/,"").length}function jh(s){var c=new Error("malformed IP address");if(s=s.toLowerCase(s),!s.match(/^[0-9a-f.:/]+$/))throw c;if(s.match(/^[0-9.]+$/)){var l=s.split(".");if(l.length!==4)throw c;var d="";try{for(var g=0;g<4;g++){var m=parseInt(l[g]);d+=("0"+m.toString(16)).slice(-2)}return d}catch{throw c}}else if(s.match(/^[0-9.]+\/[0-9]+$/)){var T=s.split("/");return jh(T[0])+pg(parseInt(T[1]),32)}else{if(s.match(/^[0-9a-f:]+$/)&&s.indexOf(":")!==-1)return Mh(s);if(s.match(/^[0-9a-f:]+\/[0-9]+$/)&&s.indexOf(":")!==-1){var T=s.split("/");return Mh(T[0])+pg(parseInt(T[1]),128)}else throw c}}function pg(s,c){if(c==32&&s==0)return"00000000";if(c==128&&s==0)return"00000000000000000000000000000000";var l=Array(s+1).join("1")+Array(c-s+1).join("0");return new _(l,2).toString(16)}function Bh(s){function c(g){var m=parseInt(g.substr(0,2),16),T=parseInt(g.substr(2),16);if(m==0&T<128)return String.fromCharCode(T);if(m<8){var k=192|(m&7)<<3|(T&192)>>6,O=128|T&63;return Jt(k.toString(16)+O.toString(16))}var k=224|(m&240)>>4,O=128|(m&15)<<2|(T&192)>>6,F=128|T&63;return Jt(k.toString(16)+O.toString(16)+F.toString(16))}var l=s.match(/.{4}/g),d=l.map(c);return d.join("")}function $l(s){for(var c=encodeURIComponent(s),l="",d=0;d<c.length;d++)c[d]=="%"?(l=l+c.substr(d,3),d=d+2):l=l+"%"+kr(c[d]);return l}function S2(s){return s=s.replace(/\r\n/mg,`
`),s}function w2(s){return s=s.replace(/\r\n/mg,`
`),s=s.replace(/\n/mg,`\r
`),s}y.lang.String.isInteger=function(s){return s.match(/^[0-9]+$/)?!0:!!s.match(/^-[0-9]+$/)},y.lang.String.isHex=function(s){return fg(s)};function fg(s){return!!(s.length%2==0&&(s.match(/^[0-9a-f]+$/)||s.match(/^[0-9A-F]+$/)))}y.lang.String.isBase64=function(s){return s=s.replace(/\s+/g,""),!!(s.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&s.length%4==0)},y.lang.String.isBase64URL=function(s){return s.match(/[+/=]/)?!1:(s=tc(s),y.lang.String.isBase64(s))};function Uh(s){return!!s.match(/^[0-9A-Za-z-_.]+$/)}y.lang.String.isIntegerArray=function(s){return s=s.replace(/\s+/g,""),!!s.match(/^\[[0-9,]+\]$/)},y.lang.String.isPrintable=function(s){return s.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null},y.lang.String.isIA5=function(s){return s.match(/^[\x20-\x21\x23-\x7f]*$/)!==null},y.lang.String.isMail=function(s){return s.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function Hh(s){return s.length%2==1?"0"+s:s.substr(0,1)>"7"?"00"+s:s}function x2(s){s=s.replace(/^\s*\[\s*/,""),s=s.replace(/\s*\]\s*$/,""),s=s.replace(/\s*/g,"");try{var c=s.split(/,/).map(function(l,d,g){var m=parseInt(l);if(m<0||255<m)throw"integer not in range 0-255";var T=("00"+m.toString(16)).slice(-2);return T}).join("");return c}catch(l){throw"malformed integer array string: "+l}}var C2=function(s,c){var l=s.length;s.length>c.length&&(l=c.length);for(var d=0;d<l;d++)if(s.charCodeAt(d)!=c.charCodeAt(d))return d;return s.length!=c.length?l:-1};function mg(s){var c=function(k){var O=k.toString(16);return O.length==1&&(O="0"+O),O},l=function(k){var O="",F=parseInt(k,10),U=F.toString(2),L=7-U.length%7;L==7&&(L=0);for(var P="",D=0;D<L;D++)P+="0";U=P+U;for(var D=0;D<U.length-1;D+=7){var A=U.substr(D,7);D!=U.length-7&&(A="1"+A),O+=c(parseInt(A,2))}return O};try{if(!s.match(/^[0-9.]+$/))return null;var d="",g=s.split("."),m=parseInt(g[0],10)*40+parseInt(g[1],10);d+=c(m),g.splice(0,2);for(var T=0;T<g.length;T++)d+=l(g[T]);return d}catch{return null}}function Wl(s){if(!fg(s))return null;try{var c=[],l=s.substr(0,2),d=parseInt(l,16);c[0]=new String(Math.floor(d/40)),c[1]=new String(d%40);for(var g=s.substr(2),m=[],T=0;T<g.length/2;T++)m.push(parseInt(g.substr(T*2,2),16));for(var k=[],O="",T=0;T<m.length;T++)m[T]&128?O=O+Gl((m[T]&127).toString(2),7):(O=O+Gl((m[T]&127).toString(2),7),k.push(new String(parseInt(O,2))),O="");var F=c.join(".");return k.length>0&&(F=F+"."+k.join(".")),F}catch{return null}}function gg(s){var c=new _(String(s),10);return rc(c)}function rc(s){var c=s.toString(16);if(c.substr(0,1)!="-")return c.length%2==1?c="0"+c:c.match(/^[0-7]/)||(c="00"+c),c;var l=c.substr(1),d=l.length;d%2==1?d+=1:c.match(/^[0-7]/)||(d+=2);for(var g="",m=0;m<d;m++)g+="f";var T=new _(g,16),k=T.xor(s).add(_.ONE);return c=k.toString(16).replace(/^-/,""),c}var Gl=function(s,c,l){return l==null&&(l="0"),s.length>=c?s:new Array(c-s.length+1).join(l)+s};function vg(s){if(s.length%2!=0||(s=s.toLowerCase(),s.match(/^[0-9a-f]+$/)==null))return-1;try{var c=s.substr(0,2);if(c=="00")return parseInt(s.substr(2),16);var l=parseInt(c,16);if(l>7)return-1;var d=s.substr(2),g=parseInt(d,16).toString(2);g=="0"&&(g="00000000"),g=g.slice(0,0-l);var m=parseInt(g,2);return m==NaN?-1:m}catch{return-1}}function yg(s){if(typeof s!="number"||s<0)return null;var c=Number(s).toString(2),l=8-c.length%8;l==8&&(l=0),c=c+Gl("",l,"0");var d=parseInt(c,2).toString(16);d.length%2==1&&(d="0"+d);var g="0"+l;return g+d}function _g(s){if(typeof s!="string"||s.length%2!=0||!s.match(/^[0-9a-f]+$/))return null;try{var c=parseInt(s.substr(0,2),16);if(c<0||7<c)return null;for(var l=s.substr(2),d="",g=0;g<l.length;g+=2){var m=l.substr(g,2),T=parseInt(m,16).toString(2);T=("0000000"+T).slice(-8),d+=T}return d.substr(0,d.length-c)}catch{return null}}function E2(s){if(typeof s!="string"||s.match(/^[01]+$/)==null)return null;try{var c=parseInt(s,2);return yg(c)}catch{return null}}function Jl(s,c){for(var l=0,d=0;d<s.length;d++)l|=1<<c[s[d]];for(var g=l.toString(2),m="",d=g.length-1;d>=0;d--)m+=g[d];return m}function Yt(s,d,l){if(typeof s=="object"){for(var d=String(d).split("."),g=0;g<d.length&&s;g++){var m=d[g];m.match(/^[0-9]+$/)&&(m=parseInt(m)),s=s[m]}return s||s===!1?s:l}}function Ie(s,c){var l=function(){};l.prototype=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.superclass=c.prototype,c.prototype.constructor==Object.prototype.constructor&&(c.prototype.constructor=c)}(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:a.algo.MD5,sha1:a.algo.SHA1,sha224:a.algo.SHA224,sha256:a.algo.SHA256,sha384:a.algo.SHA384,sha512:a.algo.SHA512,ripemd160:a.algo.RIPEMD160},this.getDigestInfoHex=function(s,c){if(typeof this.DIGESTINFOHEAD[c]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+c;return this.DIGESTINFOHEAD[c]+s},this.getPaddedDigestInfoHex=function(s,c,l){var d=this.getDigestInfoHex(s,c),g=l/4;if(d.length+22>g)throw"key is too short for SigAlg: keylen="+l+","+c;for(var m="0001",T="00"+d,k="",O=g-m.length-T.length,F=0;F<O;F+=2)k+="ff";var U=m+k+T;return U},this.hashString=function(s,c){var l=new y.crypto.MessageDigest({alg:c});return l.digestString(s)},this.hashHex=function(s,c){var l=new y.crypto.MessageDigest({alg:c});return l.digestHex(s)},this.sha1=function(s){return this.hashString(s,"sha1")},this.sha256=function(s){return this.hashString(s,"sha256")},this.sha256Hex=function(s){return this.hashHex(s,"sha256")},this.sha512=function(s){return this.hashString(s,"sha512")},this.sha512Hex=function(s){return this.hashHex(s,"sha512")},this.isKey=function(s){return s instanceof xe||s instanceof y.crypto.DSA||s instanceof y.crypto.ECDSA}},y.crypto.Util.md5=function(s){var c=new y.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return c.digestString(s)},y.crypto.Util.ripemd160=function(s){var c=new y.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return c.digestString(s)},y.crypto.Util.SECURERANDOMGEN=new ae,y.crypto.Util.getRandomHexOfNbytes=function(s){var c=new Array(s);return y.crypto.Util.SECURERANDOMGEN.nextBytes(c),Ul(c)},y.crypto.Util.getRandomBigIntegerOfNbytes=function(s){return new _(y.crypto.Util.getRandomHexOfNbytes(s),16)},y.crypto.Util.getRandomHexOfNbits=function(s){var c=s%8,l=(s-c)/8,d=new Array(l+1);return y.crypto.Util.SECURERANDOMGEN.nextBytes(d),d[0]=(255<<c&255^255)&d[0],Ul(d)},y.crypto.Util.getRandomBigIntegerOfNbits=function(s){return new _(y.crypto.Util.getRandomHexOfNbits(s),16)},y.crypto.Util.getRandomBigIntegerZeroToMax=function(s){for(var c=s.bitLength();;){var l=y.crypto.Util.getRandomBigIntegerOfNbits(c);if(s.compareTo(l)!=-1)return l}},y.crypto.Util.getRandomBigIntegerMinToMax=function(s,c){var l=s.compareTo(c);if(l==1)throw"biMin is greater than biMax";if(l==0)return s;var d=c.subtract(s),g=y.crypto.Util.getRandomBigIntegerZeroToMax(d);return g.add(s)},y.crypto.MessageDigest=function(s){this.setAlgAndProvider=function(c,l){if(c=y.crypto.MessageDigest.getCanonicalAlgName(c),c!==null&&l===void 0&&(l=y.crypto.Util.DEFAULTPROVIDER[c]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)!=-1&&l=="cryptojs"){try{this.md=y.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c].create()}catch(d){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+d}this.updateString=function(d){this.md.update(d)},this.updateHex=function(d){var g=a.enc.Hex.parse(d);this.md.update(g)},this.digest=function(){var d=this.md.finalize();return d.toString(a.enc.Hex)},this.digestString=function(d){return this.updateString(d),this.digest()},this.digestHex=function(d){return this.updateHex(d),this.digest()}}if(":sha256:".indexOf(c)!=-1&&l=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(d){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+d}this.updateString=function(d){this.md.update(d)},this.updateHex=function(d){var g=sjcl.codec.hex.toBits(d);this.md.update(g)},this.digest=function(){var d=this.md.finalize();return sjcl.codec.hex.fromBits(d)},this.digestString=function(d){return this.updateString(d),this.digest()},this.digestHex=function(d){return this.updateHex(d),this.digest()}}},this.updateString=function(c){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(c){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(c){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},s!==void 0&&s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0&&(this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},y.crypto.MessageDigest.getCanonicalAlgName=function(s){return typeof s=="string"&&(s=s.toLowerCase(),s=s.replace(/-/,"")),s},y.crypto.MessageDigest.getHashLength=function(s){var c=y.crypto.MessageDigest,l=c.getCanonicalAlgName(s);if(c.HASHLENGTH[l]===void 0)throw"not supported algorithm: "+s;return c.HASHLENGTH[l]},y.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},y.crypto.Mac=function(s){this.setAlgAndProvider=function(c,l){if(c=c.toLowerCase(),c==null&&(c="hmacsha1"),c=c.toLowerCase(),c.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+c;l===void 0&&(l=y.crypto.Util.DEFAULTPROVIDER[c]),this.algProv=c+"/"+l;var d=c.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(d)!=-1&&l=="cryptojs"){try{var g=y.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[d];this.mac=a.algo.HMAC.create(g,this.pass)}catch(m){throw"setAlgAndProvider hash alg set fail hashAlg="+d+"/"+m}this.updateString=function(m){this.mac.update(m)},this.updateHex=function(m){var T=a.enc.Hex.parse(m);this.mac.update(T)},this.doFinal=function(){var m=this.mac.finalize();return m.toString(a.enc.Hex)},this.doFinalString=function(m){return this.updateString(m),this.doFinal()},this.doFinalHex=function(m){return this.updateHex(m),this.doFinal()}}},this.updateString=function(c){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(c){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(c){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(c){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(c){if(typeof c=="string"){var l=c;(c.length%2==1||!c.match(/^[0-9A-Fa-f]+$/))&&(l=Bi(c)),this.pass=a.enc.Hex.parse(l);return}if(typeof c!="object")throw"KJUR.crypto.Mac unsupported password type: "+c;var l=null;if(c.hex!==void 0){if(c.hex.length%2!=0||!c.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+c.hex;l=c.hex}if(c.utf8!==void 0&&(l=Hl(c.utf8)),c.rstr!==void 0&&(l=Bi(c.rstr)),c.b64!==void 0&&(l=h(c.b64)),c.b64u!==void 0&&(l=sn(c.b64u)),l==null)throw"KJUR.crypto.Mac unsupported password type: "+c;this.pass=a.enc.Hex.parse(l)},s!==void 0&&(s.pass!==void 0&&this.setPassword(s.pass),s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0&&(this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},y.crypto.Signature=function(s){var c=null;if(this._setAlgNames=function(){var l=this.algName.match(/^(.+)with(.+)$/);l&&(this.mdAlgName=l[1].toLowerCase(),this.pubkeyAlgName=l[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(l,d){for(var g="",m=d/4-l.length,T=0;T<m;T++)g=g+"0";return g+l},this.setAlgAndProvider=function(l,d){if(this._setAlgNames(),d!="cryptojs/jsrsa")throw new Error("provider not supported: "+d);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new y.crypto.MessageDigest({alg:this.mdAlgName})}catch(g){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+g)}this.init=function(g,m){var T=null;try{m===void 0?T=Nt.getKey(g):T=Nt.getKey(g,m)}catch(k){throw"init failed:"+k}if(T.isPrivate===!0)this.prvKey=T,this.state="SIGN";else if(T.isPublic===!0)this.pubKey=T,this.state="VERIFY";else throw"init failed.:"+T},this.updateString=function(g){this.md.updateString(g)},this.updateHex=function(g){this.md.updateHex(g)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&y.crypto.ECDSA!==void 0&&(this.prvKey=new y.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof xe&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof xe&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof y.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof y.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(g){return this.updateString(g),this.sign()},this.signHex=function(g){return this.updateHex(g),this.sign()},this.verify=function(g){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&y.crypto.ECDSA!==void 0&&(this.pubKey=new y.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof xe&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,g,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof xe&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,g);if(y.crypto.ECDSA!==void 0&&this.pubKey instanceof y.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,g);if(y.crypto.DSA!==void 0&&this.pubKey instanceof y.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,g);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(l,d){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(l){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(l){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(l){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(l){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(l){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=s,s!==void 0&&(s.alg!==void 0&&(this.algName=s.alg,s.prov===void 0?this.provName=y.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=s.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),s.psssaltlen!==void 0&&(this.pssSaltLen=s.psssaltlen),s.prvkeypem!==void 0)){if(s.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var c=Nt.getKey(s.prvkeypem);this.init(c)}catch(l){throw"fatal error to load pem private key: "+l}}},y.crypto.Cipher=function(s){},y.crypto.Cipher.encrypt=function(s,c,l,d){if(Yt(d,"enclag")!=null&&(l=d.encalg),typeof l=="string"&&l.substr(-4)=="-CBC"){var g=c,m=s;Yt(d,"key")!=null&&(g=d.key),Yt(d,"enc")!=null&&(hEnc=d.enc);var T=a.enc.Hex.parse(g),k=a.enc.Hex.parse(m),O=a.enc.Hex.parse(d.iv),F;if(l=="des-EDE3-CBC")F=a.TripleDES.encrypt(k,T,{iv:O});else if(l=="aes128-CBC"||l=="aes256-CBC")F=a.AES.encrypt(k,T,{iv:O});else throw new Error("unsupported algorithm: "+l);return F+""}else throw new Error("Cipher.encrypt: unsupported key or algorithm")},y.crypto.Cipher.decrypt=function(s,c,l,d){if(Yt(d,"enclag")!=null&&(l=d.encalg),typeof l=="string"&&l.substr(-4)=="-CBC"){var g=c,m=s;Yt(d,"key")!=null&&(g=d.key),Yt(d,"enc")!=null&&(m=d.enc);var T=a.enc.Hex.parse(g),k=a.enc.Hex.parse(m),O=a.enc.Hex.parse(d.iv),F;if(l=="des-EDE3-CBC")F=a.TripleDES.decrypt({ciphertext:k},T,{iv:O});else if(l=="aes128-CBC"||l=="aes256-CBC")F=a.AES.decrypt({ciphertext:k},T,{iv:O});else throw new Error("unsupported algorithm: "+l);return a.enc.Hex.stringify(F)}else throw new Error("Cipher.decrypt: unsupported key or algorithm")},y.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.ECDSA=function(s){var c="secp256r1",l=Error,d=_,g=ct,m=y.crypto.ECDSA,T=y.crypto.ECParameterDB,k=m.getName,O=je,F=O.getVbyListEx,U=O.isASN1HEX,L=new ae;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(P){return new d(P.bitLength(),L).mod(P.subtract(d.ONE)).add(d.ONE)},this.setNamedCurve=function(P){this.ecparams=T.getByName(P),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=P},this.setPrivateKeyHex=function(P){this.isPrivate=!0,this.prvKeyHex=P},this.setPublicKeyHex=function(P){this.isPublic=!0,this.pubKeyHex=P},this.getPublicKeyXYHex=function(){var P=this.pubKeyHex;if(P.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var D=this.ecparams.keycharlen;if(P.length!==2+D*2)throw"malformed public key hex length";var A={};return A.x=P.substr(2,D),A.y=P.substr(2+D),A},this.getShortNISTPCurveName=function(){var P=this.curveName;return P==="secp256r1"||P==="NIST P-256"||P==="P-256"||P==="prime256v1"?"P-256":P==="secp384r1"||P==="NIST P-384"||P==="P-384"?"P-384":P==="secp521r1"||P==="NIST P-521"||P==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var P=this.ecparams.n,D=this.getBigRandom(P),A=this.ecparams.keycharlen,N=("0000000000"+D.toString(16)).slice(-A);this.setPrivateKeyHex(N);var j=this.generatePublicKeyHex();return{ecprvhex:N,ecpubhex:j}},this.generatePublicKeyHex=function(){var P=new d(this.prvKeyHex,16),D=this.ecparams.G.multiply(P),A=D.getX().toBigInteger(),N=D.getY().toBigInteger(),j=this.ecparams.keycharlen,W=("0000000000"+A.toString(16)).slice(-j),se=("0000000000"+N.toString(16)).slice(-j),he="04"+W+se;return this.setPublicKeyHex(he),he},this.signWithMessageHash=function(P){return this.signHex(P,this.prvKeyHex)},this.signHex=function(P,D){var A=new d(D,16),N=this.ecparams.n,j=new d(P.substring(0,this.ecparams.keycharlen),16);do var W=this.getBigRandom(N),se=this.ecparams.G,he=se.multiply(W),de=he.getX().toBigInteger().mod(N);while(de.compareTo(d.ZERO)<=0);var fe=W.modInverse(N).multiply(j.add(A.multiply(de))).mod(N);return m.biRSSigToASN1Sig(de,fe)},this.sign=function(P,D){var A=D,N=this.ecparams.n,j=d.fromByteArrayUnsigned(P);do var W=this.getBigRandom(N),se=this.ecparams.G,he=se.multiply(W),de=he.getX().toBigInteger().mod(N);while(de.compareTo(_.ZERO)<=0);var fe=W.modInverse(N).multiply(j.add(A.multiply(de))).mod(N);return this.serializeSig(de,fe)},this.verifyWithMessageHash=function(P,D){return this.verifyHex(P,D,this.pubKeyHex)},this.verifyHex=function(P,D,A){try{var N,j,W=m.parseSigHex(D);N=W.r,j=W.s;var se=g.decodeFromHex(this.ecparams.curve,A),he=new d(P.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(he,N,j,se)}catch{return!1}},this.verify=function(P,D,A){var N,j;if(Bitcoin.Util.isArray(D)){var W=this.parseSig(D);N=W.r,j=W.s}else if(typeof D=="object"&&D.r&&D.s)N=D.r,j=D.s;else throw"Invalid value for signature";var se;if(A instanceof ct)se=A;else if(Bitcoin.Util.isArray(A))se=g.decodeFrom(this.ecparams.curve,A);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var he=d.fromByteArrayUnsigned(P);return this.verifyRaw(he,N,j,se)},this.verifyRaw=function(P,D,A,N){var j=this.ecparams.n,W=this.ecparams.G;if(D.compareTo(d.ONE)<0||D.compareTo(j)>=0||A.compareTo(d.ONE)<0||A.compareTo(j)>=0)return!1;var se=A.modInverse(j),he=P.multiply(se).mod(j),de=D.multiply(se).mod(j),fe=W.multiply(he).add(N.multiply(de)),G=fe.getX().toBigInteger().mod(j);return G.equals(D)},this.serializeSig=function(P,D){var A=P.toByteArraySigned(),N=D.toByteArraySigned(),j=[];return j.push(2),j.push(A.length),j=j.concat(A),j.push(2),j.push(N.length),j=j.concat(N),j.unshift(j.length),j.unshift(48),j},this.parseSig=function(P){var D;if(P[0]!=48)throw new Error("Signature not a valid DERSequence");if(D=2,P[D]!=2)throw new Error("First element in signature must be a DERInteger");var A=P.slice(D+2,D+2+P[D+1]);if(D+=2+P[D+1],P[D]!=2)throw new Error("Second element in signature must be a DERInteger");var N=P.slice(D+2,D+2+P[D+1]);D+=2+P[D+1];var j=d.fromByteArrayUnsigned(A),W=d.fromByteArrayUnsigned(N);return{r:j,s:W}},this.parseSigCompact=function(P){if(P.length!==65)throw"Signature has the wrong length";var D=P[0]-27;if(D<0||D>7)throw"Invalid signature type";var A=this.ecparams.n,N=d.fromByteArrayUnsigned(P.slice(1,33)).mod(A),j=d.fromByteArrayUnsigned(P.slice(33,65)).mod(A);return{r:N,s:j,i:D}},this.readPKCS5PrvKeyHex=function(P){if(U(P)===!1)throw new Error("not ASN.1 hex string");var D,A,N;try{D=F(P,0,["[0]",0],"06"),A=F(P,0,[1],"04");try{N=F(P,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=k(D),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(N),this.setPrivateKeyHex(A),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(P){if(U(P)===!1)throw new l("not ASN.1 hex string");var D,A,N,j;try{D=F(P,0,[1,0],"06"),A=F(P,0,[1,1],"06"),N=F(P,0,[2,0,1],"04");try{j=F(P,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new l("malformed PKCS#8 plain ECC private key")}if(this.curveName=k(A),this.curveName===void 0)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(j),this.setPrivateKeyHex(N),this.isPublic=!1},this.readPKCS8PubKeyHex=function(P){if(U(P)===!1)throw new l("not ASN.1 hex string");var D,A,N;try{D=F(P,0,[0,0],"06"),A=F(P,0,[0,1],"06"),N=F(P,0,[1],"03")}catch{throw new l("malformed PKCS#8 ECC public key")}if(this.curveName=k(A),this.curveName===null)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(N)},this.readCertPubKeyHex=function(P,D){if(U(P)===!1)throw new l("not ASN.1 hex string");var A,N;try{A=F(P,0,[0,5,0,1],"06"),N=F(P,0,[0,5,1],"03")}catch{throw new l("malformed X.509 certificate ECC public key")}if(this.curveName=k(A),this.curveName===null)throw new l("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(N)},s!==void 0&&s.curve!==void 0&&(this.curveName=s.curve),this.curveName===void 0&&(this.curveName=c),this.setNamedCurve(this.curveName),s!==void 0&&(s.prv!==void 0&&this.setPrivateKeyHex(s.prv),s.pub!==void 0&&this.setPublicKeyHex(s.pub))},y.crypto.ECDSA.parseSigHex=function(s){var c=y.crypto.ECDSA.parseSigHexInHexRS(s),l=new _(c.r,16),d=new _(c.s,16);return{r:l,s:d}},y.crypto.ECDSA.parseSigHexInHexRS=function(s){var c=je,l=c.getChildIdx,d=c.getV;if(c.checkStrictDER(s,0),s.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var g=l(s,0);if(g.length!=2)throw new Error("signature shall have two elements");var m=g[0],T=g[1];if(s.substr(m,2)!="02")throw new Error("1st item not ASN.1 integer");if(s.substr(T,2)!="02")throw new Error("2nd item not ASN.1 integer");var k=d(s,m),O=d(s,T);return{r:k,s:O}},y.crypto.ECDSA.asn1SigToConcatSig=function(s){var c=y.crypto.ECDSA.parseSigHexInHexRS(s),l=c.r,d=c.s;if(l.length>=130&&l.length<=134){if(l.length%2!=0)throw Error("unknown ECDSA sig r length error");if(d.length%2!=0)throw Error("unknown ECDSA sig s length error");l.substr(0,2)=="00"&&(l=l.substr(2)),d.substr(0,2)=="00"&&(d=d.substr(2));var g=Math.max(l.length,d.length);return l=("000000"+l).slice(-g),d=("000000"+d).slice(-g),l+d}if(l.substr(0,2)=="00"&&l.length%32==2&&(l=l.substr(2)),d.substr(0,2)=="00"&&d.length%32==2&&(d=d.substr(2)),l.length%32==30&&(l="00"+l),d.length%32==30&&(d="00"+d),l.length%32!=0)throw Error("unknown ECDSA sig r length error");if(d.length%32!=0)throw Error("unknown ECDSA sig s length error");return l+d},y.crypto.ECDSA.concatSigToASN1Sig=function(s){if(s.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var c=s.substr(0,s.length/2),l=s.substr(s.length/2);return y.crypto.ECDSA.hexRSSigToASN1Sig(c,l)},y.crypto.ECDSA.hexRSSigToASN1Sig=function(s,c){var l=new _(s,16),d=new _(c,16);return y.crypto.ECDSA.biRSSigToASN1Sig(l,d)},y.crypto.ECDSA.biRSSigToASN1Sig=function(s,c){var l=y.asn1,d=new l.DERInteger({bigint:s}),g=new l.DERInteger({bigint:c}),m=new l.DERSequence({array:[d,g]});return m.tohex()},y.crypto.ECDSA.getName=function(s){return s==="2b8104001f"?"secp192k1":s==="2a8648ce3d030107"?"secp256r1":s==="2b8104000a"?"secp256k1":s==="2b81040021"?"secp224r1":s==="2b81040022"?"secp384r1":s==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(s)!==-1?"secp256r1":"|secp256k1|".indexOf(s)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(s)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(s)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(s)!==-1?"secp521r1":null},(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.ECParameterDB=new function(){var s={},c={};function l(d){return new _(d,16)}this.getByName=function(d){var g=d;if(typeof c[g]<"u"&&(g=c[d]),typeof s[g]<"u")return s[g];throw"unregistered EC curve name: "+g},this.regist=function(d,g,m,T,k,O,F,U,L,P,D,A){s[d]={};var N=l(m),j=l(T),W=l(k),se=l(O),he=l(F),de=new rs(N,j,W),fe=de.decodePointHex("04"+U+L);s[d].name=d,s[d].keylen=g,s[d].keycharlen=Math.ceil(g/8)*2,s[d].curve=de,s[d].G=fe,s[d].n=se,s[d].h=he,s[d].oid=D,s[d].info=A;for(var G=0;G<P.length;G++)c[P[G]]=d}},y.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),y.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),y.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),y.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),y.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),y.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),y.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),y.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),y.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),y.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),(typeof y>"u"||!y)&&(y={}),(typeof y.crypto>"u"||!y.crypto)&&(y.crypto={}),y.crypto.DSA=function(){var s=je;s.getVbyList;var c=s.getVbyListEx,l=s.isASN1HEX,d=_;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(g,m,T,k,O){this.isPrivate=!0,this.p=g,this.q=m,this.g=T,this.y=k,this.x=O},this.setPrivateHex=function(g,m,T,k,O){var F,U,L,P,D;F=new _(g,16),U=new _(m,16),L=new _(T,16),typeof k=="string"&&k.length>1?P=new _(k,16):P=null,D=new _(O,16),this.setPrivate(F,U,L,P,D)},this.setPublic=function(g,m,T,k){this.isPublic=!0,this.p=g,this.q=m,this.g=T,this.y=k,this.x=null},this.setPublicHex=function(g,m,T,k){var O,F,U,L;O=new _(g,16),F=new _(m,16),U=new _(T,16),L=new _(k,16),this.setPublic(O,F,U,L)},this.signWithMessageHash=function(g){var m=this.p,T=this.q,k=this.g;this.y;var O=this.x,F=y.crypto.Util.getRandomBigIntegerMinToMax(_.ONE.add(_.ONE),T.subtract(_.ONE)),U=g.substr(0,T.bitLength()/4),L=new _(U,16),P=k.modPow(F,m).mod(T),D=F.modInverse(T).multiply(L.add(O.multiply(P))).mod(T),A=y.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:P}},{int:{bigint:D}}]});return A},this.verifyWithMessageHash=function(g,m){var T=this.p,k=this.q,O=this.g,F=this.y,U=this.parseASN1Signature(m),L=U[0],P=U[1],D=g.substr(0,k.bitLength()/4),A=new _(D,16);if(_.ZERO.compareTo(L)>0||L.compareTo(k)>0||_.ZERO.compareTo(P)>=0||P.compareTo(k)>0)throw"invalid DSA signature";var N=P.modInverse(k),j=A.multiply(N).mod(k),W=L.multiply(N).mod(k),se=O.modPow(j,T).multiply(F.modPow(W,T)).mod(T).mod(k);return se.compareTo(L)==0},this.parseASN1Signature=function(g){try{var m=new d(c(g,0,[0],"02"),16),T=new d(c(g,0,[1],"02"),16);return[m,T]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(g){var m,T,k,O,F;if(l(g)===!1)throw new Error("not ASN.1 hex string");try{m=c(g,0,[1],"02"),T=c(g,0,[2],"02"),k=c(g,0,[3],"02"),O=c(g,0,[4],"02"),F=c(g,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(m,T,k,O,F)},this.readPKCS8PrvKeyHex=function(g){var m,T,k,O;if(l(g)===!1)throw new Error("not ASN.1 hex string");try{m=c(g,0,[1,1,0],"02"),T=c(g,0,[1,1,1],"02"),k=c(g,0,[1,1,2],"02"),O=c(g,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(m,T,k,null,O)},this.readPKCS8PubKeyHex=function(g){var m,T,k,O;if(l(g)===!1)throw new Error("not ASN.1 hex string");try{m=c(g,0,[0,1,0],"02"),T=c(g,0,[0,1,1],"02"),k=c(g,0,[0,1,2],"02"),O=c(g,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(m,T,k,O)},this.readCertPubKeyHex=function(g,m){var T,k,O,F;if(l(g)===!1)throw new Error("not ASN.1 hex string");try{T=c(g,0,[0,5,0,1,0],"02"),k=c(g,0,[0,5,0,1,1],"02"),O=c(g,0,[0,5,0,1,2],"02"),F=c(g,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(T,k,O,F)}};var Nt=function(){var s=function(A,N,j){return d(a.AES,A,N,j)},c=function(A,N,j){return d(a.TripleDES,A,N,j)},l=function(A,N,j){return d(a.DES,A,N,j)},d=function(A,N,j,W){var se=a.enc.Hex.parse(N),he=a.enc.Hex.parse(j),de=a.enc.Hex.parse(W),fe={};fe.key=he,fe.iv=de,fe.ciphertext=se;var G=A.decrypt(fe,he,{iv:de});return a.enc.Hex.stringify(G)},g=function(A,N,j){return k(a.AES,A,N,j)},m=function(A,N,j){return k(a.TripleDES,A,N,j)},T=function(A,N,j){return k(a.DES,A,N,j)},k=function(A,N,j,W){var se=a.enc.Hex.parse(N),he=a.enc.Hex.parse(j),de=a.enc.Hex.parse(W),fe=A.encrypt(se,he,{iv:de}),G=a.enc.Hex.parse(fe.toString()),Q=a.enc.Base64.stringify(G);return Q},O={"AES-256-CBC":{proc:s,eproc:g,keylen:32,ivlen:16},"AES-192-CBC":{proc:s,eproc:g,keylen:24,ivlen:16},"AES-128-CBC":{proc:s,eproc:g,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:c,eproc:m,keylen:24,ivlen:8},"DES-CBC":{proc:l,eproc:T,keylen:8,ivlen:8}},F=function(A){var N=a.lib.WordArray.random(A),j=a.enc.Hex.stringify(N);return j},U=function(A){var N={},j=A.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));j&&(N.cipher=j[1],N.ivsalt=j[2]);var W=A.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));W&&(N.type=W[1]);var se=-1,he=0;A.indexOf(`\r
\r
`)!=-1&&(se=A.indexOf(`\r
\r
`),he=2),A.indexOf(`

`)!=-1&&(se=A.indexOf(`

`),he=1);var de=A.indexOf("-----END");if(se!=-1&&de!=-1){var fe=A.substring(se+he*2,de-he);fe=fe.replace(/\s+/g,""),N.data=fe}return N},L=function(A,N,j){for(var W=j.substring(0,16),se=a.enc.Hex.parse(W),he=a.enc.Utf8.parse(N),de=O[A].keylen+O[A].ivlen,fe="",G=null;;){var Q=a.algo.MD5.create();if(G!=null&&Q.update(G),Q.update(he),Q.update(se),G=Q.finalize(),fe=fe+a.enc.Hex.stringify(G),fe.length>=de*2)break}var te={};return te.keyhex=fe.substr(0,O[A].keylen*2),te.ivhex=fe.substr(O[A].keylen*2,O[A].ivlen*2),te},P=function(A,N,j,W){var se=a.enc.Base64.parse(A),he=a.enc.Hex.stringify(se),de=O[N].proc,fe=de(he,j,W);return fe},D=function(A,N,j,W){var se=O[N].eproc,he=se(A,j,W);return he};return{version:"1.0.0",parsePKCS5PEM:function(A){return U(A)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(A,N,j){return L(A,N,j)},decryptKeyB64:function(A,N,j,W){return P(A,N,j,W)},getDecryptedKeyHex:function(A,N){var j=U(A),W=j.cipher,se=j.ivsalt,he=j.data,de=L(W,N,se),fe=de.keyhex,G=P(he,W,fe,se);return G},getEncryptedPKCS5PEMFromPrvKeyHex:function(A,N,j,W,se){var J="";if((typeof W>"u"||W==null)&&(W="AES-256-CBC"),typeof O[W]>"u")throw new Error("KEYUTIL unsupported algorithm: "+W);if(typeof se>"u"||se==null){var he=O[W].ivlen,de=F(he);se=de.toUpperCase()}var fe=L(W,j,se),G=fe.keyhex,Q=D(N,W,G,se),te=Q.replace(/(.{64})/g,`$1\r
`),J="-----BEGIN "+A+` PRIVATE KEY-----\r
`;return J+=`Proc-Type: 4,ENCRYPTED\r
`,J+="DEK-Info: "+W+","+se+`\r
`,J+=`\r
`,J+=te,J+=`\r
-----END `+A+` PRIVATE KEY-----\r
`,J},getEncryptedPKCS8PEM:function(A,N,j){var W=this.getEncryptedPKCS8Hex(A,N,j);return nr(W,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(A,N,j){var W;j==null||j==null?W={}:W=JSON.parse(JSON.stringify(j)),W.plain=A,this.initPBES2Param(W),this.encryptPBES2Param(W,N);var se=this.generatePBES2ASN1Param(W);return y.asn1.ASN1Util.newObject(se).tohex()},initPBES2Param:function(A){if(Yt(A,"encalg")==null&&(A.encalg="aes256-CBC"),Yt(A,"iter")==null&&(A.iter=2048),Yt(A,"prf")==null&&(A.prf="hmacWithSHA256"),Yt(A,"salt")==null&&(A.salt=a.enc.Hex.stringify(a.lib.WordArray.random(8))),Yt(A,"enciv")==null){var N;A.encalg=="des-EDE3-CBC"&&(N=8),A.encalg=="aes128-CBC"&&(N=16),A.encalg=="aes256-CBC"&&(N=16),A.enciv=a.enc.Hex.stringify(a.lib.WordArray.random(N))}},encryptPBES2Param:function(A,N){var j=Nt.getDKFromPBES2Param(A,N);try{var W=y.crypto.Cipher.encrypt(A.plain,j,A.encalg,{iv:A.enciv})}catch{throw new Error("encrypt error: "+A.plain+" "+j+" "+A.encalg+" "+A.enciv)}A.enc=W},generatePBES2ASN1Param:function(A){var N={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:A.salt}},{int:{hex:gg(A.iter)}}]}]},{seq:[{oid:A.encalg},{octstr:{hex:A.enciv}}]}]}]},{octstr:{hex:A.enc}}]};return A.prf!="hmacWithSHA1"&&N.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:A.prf},{null:""}]}),N},parseHexOfEncryptedPKCS8:function(A){var N=je,j=N.getChildIdx,W=N.getV,se={},he=j(A,0);if(he.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+he.length);se.ciphertext=W(A,he[1]);var de=j(A,he[0]);if(de.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+de.length);if(W(A,de[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var fe=j(A,de[1]);if(de.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+fe.length);var G=j(A,fe[1]);if(G.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+G.length);if(W(A,G[0])!="2a864886f70d0307")throw"this only supports TripleDES";se.encryptionSchemeAlg="TripleDES",se.encryptionSchemeIV=W(A,G[1]);var Q=j(A,fe[0]);if(Q.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+Q.length);if(W(A,Q[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var te=j(A,Q[1]);if(te.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+te.length);se.pbkdf2Salt=W(A,te[0]);var J=W(A,te[1]);try{se.pbkdf2Iter=parseInt(J,16)}catch{throw new Error("malformed format pbkdf2Iter: "+J)}return se},getPBKDF2KeyHexFromParam:function(A,N){var j=a.enc.Hex.parse(A.pbkdf2Salt),W=A.pbkdf2Iter,se=a.PBKDF2(N,j,{keySize:192/32,iterations:W}),he=a.enc.Hex.stringify(se);return he},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(A,N){var j=bn(A,"ENCRYPTED PRIVATE KEY"),W=this.parseHexOfEncryptedPKCS8(j),se=Nt.getPBKDF2KeyHexFromParam(W,N),he={};he.ciphertext=a.enc.Hex.parse(W.ciphertext);var de=a.enc.Hex.parse(se),fe=a.enc.Hex.parse(W.encryptionSchemeIV),G=a.TripleDES.decrypt(he,de,{iv:fe}),Q=a.enc.Hex.stringify(G);return Q},parsePBES2:function(A){var N=je.parse(A);if(Yt(N,"seq.0.seq.0.oid")!="pkcs5PBES2"||Yt(N,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var j=Yt(N,"seq.0.seq.1.seq.0.seq.1.seq");if(j==null)throw new Error("PBKDF2 parameter not found");var W=Yt(j,"0.octstr.hex"),se=Yt(j,"1.int.hex"),he=Yt(j,"2.seq.0.oid","hmacWithSHA1"),de=-1;try{de=parseInt(se,16)}catch{throw new Error("iter not proper value")}var fe=Yt(N,"seq.0.seq.1.seq.1.seq.0.oid"),G=Yt(N,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),Q=Yt(N,"seq.1.octstr.hex");if(fe==null||G==null||Q==null)throw new Error("encalg, enciv or enc is undefined");var te={salt:W,iter:de,prf:he,encalg:fe,enciv:G,enc:Q};return te},getDKFromPBES2Param:function(A,N){var j={hmacWithSHA1:a.algo.SHA1,hmacWithSHA224:a.algo.SHA224,hmacWithSHA256:a.algo.SHA256,hmacWithSHA384:a.algo.SHA384,hmacWithSHA512:a.algo.SHA512},W={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},se=j[A.prf];if(se==null)throw new Error("unsupported prf");var he=W[A.encalg];if(he==null)throw new Error("unsupported encalg");var de=a.enc.Hex.parse(A.salt),fe=A.iter;try{var G=a.PBKDF2(N,de,{keySize:he,iterations:fe,hasher:se});return a.enc.Hex.stringify(G)}catch(Q){throw new Error("PBKDF2 error: "+Q+" "+JSON.stringify(A)+" "+N)}},getPlainHexFromEncryptedPKCS8PEM:function(A,N){if(A.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var j=bn(A),W;try{W=Nt.parsePBES2(j)}catch(he){throw new Error("malformed PBES2 format: "+he.message)}var se=Nt.getDKFromPBES2Param(W,N);return y.crypto.Cipher.decrypt(W.enc,se,W.encalg,{iv:W.enciv})},getKeyFromEncryptedPKCS8PEM:function(A,N){var j=this.getPlainHexFromEncryptedPKCS8PEM(A,N),W=this.getKeyFromPlainPrivatePKCS8Hex(j);return W},parsePlainPrivatePKCS8Hex:function(A){var N=je,j=N.getChildIdx,W=N.getV,se={};if(se.algparam=null,A.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var he=j(A,0);if(he.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(A.substr(he[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var de=j(A,he[1]);if(de.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(A.substr(de[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(se.algoid=W(A,de[0]),A.substr(de[1],2)=="06"&&(se.algparam=W(A,de[1])),A.substr(he[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return se.keyidx=N.getVidx(A,he[2]),se},getKeyFromPlainPrivatePKCS8PEM:function(A){var N=bn(A,"PRIVATE KEY"),j=this.getKeyFromPlainPrivatePKCS8Hex(N);return j},getKeyFromPlainPrivatePKCS8Hex:function(A){var N=this.parsePlainPrivatePKCS8Hex(A),j;if(N.algoid=="2a864886f70d010101")j=new xe;else if(N.algoid=="2a8648ce380401")j=new y.crypto.DSA;else if(N.algoid=="2a8648ce3d0201")j=new y.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return j.readPKCS8PrvKeyHex(A),j},_getKeyFromPublicPKCS8Hex:function(A){var N,j=je.getVbyList(A,0,[0,0],"06");if(j==="2a864886f70d010101")N=new xe;else if(j==="2a8648ce380401")N=new y.crypto.DSA;else if(j==="2a8648ce3d0201")N=new y.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return N.readPKCS8PubKeyHex(A),N},parsePublicRawRSAKeyHex:function(A){var N=je,j=N.getChildIdx,W=N.getV,se={};if(A.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var he=j(A,0);if(he.length!=2)throw new Error("malformed RSA key(code:002)");if(A.substr(he[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(se.n=W(A,he[0]),A.substr(he[1],2)!="02")throw new Error("malformed RSA key(code:004)");return se.e=W(A,he[1]),se},parsePublicPKCS8Hex:function(A){var N=je,j=N.getChildIdx,W=N.getV,se={};se.algparam=null;var he=j(A,0);if(he.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+he.length);var de=he[0];if(A.substr(de,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var fe=j(A,de);if(fe.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(A.substr(fe[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(se.algoid=W(A,fe[0]),A.substr(fe[1],2)=="06"?se.algparam=W(A,fe[1]):A.substr(fe[1],2)=="30"&&(se.algparam={},se.algparam.p=N.getVbyList(A,fe[1],[0],"02"),se.algparam.q=N.getVbyList(A,fe[1],[1],"02"),se.algparam.g=N.getVbyList(A,fe[1],[2],"02")),A.substr(he[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return se.key=W(A,he[1]).substr(2),se}}}();Nt.getKey=function(s,c,l){var d=je,g=d.getChildIdx;d.getV;var m=d.getVbyList,T=y.crypto,k=T.ECDSA,O=T.DSA,F=xe,U=bn,L=Nt;if(typeof F<"u"&&s instanceof F||typeof k<"u"&&s instanceof k||typeof O<"u"&&s instanceof O)return s;if(s.curve!==void 0&&s.xy!==void 0&&s.d===void 0)return new k({pub:s.xy,curve:s.curve});if(s.curve!==void 0&&s.d!==void 0)return new k({prv:s.d,curve:s.curve});if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d===void 0){var P=new F;return P.setPublic(s.n,s.e),P}if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p!==void 0&&s.q!==void 0&&s.dp!==void 0&&s.dq!==void 0&&s.co!==void 0&&s.qi===void 0){var P=new F;return P.setPrivateEx(s.n,s.e,s.d,s.p,s.q,s.dp,s.dq,s.co),P}if(s.kty===void 0&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p===void 0){var P=new F;return P.setPrivate(s.n,s.e,s.d),P}if(s.p!==void 0&&s.q!==void 0&&s.g!==void 0&&s.y!==void 0&&s.x===void 0){var P=new O;return P.setPublic(s.p,s.q,s.g,s.y),P}if(s.p!==void 0&&s.q!==void 0&&s.g!==void 0&&s.y!==void 0&&s.x!==void 0){var P=new O;return P.setPrivate(s.p,s.q,s.g,s.y,s.x),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d===void 0){var P=new F;return P.setPublic(sn(s.n),sn(s.e)),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0&&s.p!==void 0&&s.q!==void 0&&s.dp!==void 0&&s.dq!==void 0&&s.qi!==void 0){var P=new F;return P.setPrivateEx(sn(s.n),sn(s.e),sn(s.d),sn(s.p),sn(s.q),sn(s.dp),sn(s.dq),sn(s.qi)),P}if(s.kty==="RSA"&&s.n!==void 0&&s.e!==void 0&&s.d!==void 0){var P=new F;return P.setPrivate(sn(s.n),sn(s.e),sn(s.d)),P}if(s.kty==="EC"&&s.crv!==void 0&&s.x!==void 0&&s.y!==void 0&&s.d===void 0){var D=new k({curve:s.crv}),A=D.ecparams.keycharlen,N=("0000000000"+sn(s.x)).slice(-A),j=("0000000000"+sn(s.y)).slice(-A),W="04"+N+j;return D.setPublicKeyHex(W),D}if(s.kty==="EC"&&s.crv!==void 0&&s.x!==void 0&&s.y!==void 0&&s.d!==void 0){var D=new k({curve:s.crv}),A=D.ecparams.keycharlen,N=("0000000000"+sn(s.x)).slice(-A),j=("0000000000"+sn(s.y)).slice(-A),W="04"+N+j,se=("0000000000"+sn(s.d)).slice(-A);return D.setPublicKeyHex(W),D.setPrivateKeyHex(se),D}if(l==="pkcs5prv"){var he=s,d=je,de,P;if(de=g(he,0),de.length===9)P=new F,P.readPKCS5PrvKeyHex(he);else if(de.length===6)P=new O,P.readPKCS5PrvKeyHex(he);else if(de.length>2&&he.substr(de[1],2)==="04")P=new k,P.readPKCS5PrvKeyHex(he);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return P}if(l==="pkcs8prv"){var P=L.getKeyFromPlainPrivatePKCS8Hex(s);return P}if(l==="pkcs8pub")return L._getKeyFromPublicPKCS8Hex(s);if(l==="x509pub")return lt.getPublicKeyFromCertHex(s);if(s.indexOf("-END CERTIFICATE-",0)!=-1||s.indexOf("-END X509 CERTIFICATE-",0)!=-1||s.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return lt.getPublicKeyFromCertPEM(s);if(s.indexOf("-END PUBLIC KEY-")!=-1){var fe=bn(s,"PUBLIC KEY");return L._getKeyFromPublicPKCS8Hex(fe)}if(s.indexOf("-END RSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var G=U(s,"RSA PRIVATE KEY");return L.getKey(G,null,"pkcs5prv")}if(s.indexOf("-END DSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var Q=U(s,"DSA PRIVATE KEY"),te=m(Q,0,[1],"02"),J=m(Q,0,[2],"02"),re=m(Q,0,[3],"02"),pe=m(Q,0,[4],"02"),be=m(Q,0,[5],"02"),P=new O;return P.setPrivate(new _(te,16),new _(J,16),new _(re,16),new _(pe,16),new _(be,16)),P}if(s.indexOf("-END EC PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")==-1){var G=U(s,"EC PRIVATE KEY");return L.getKey(G,null,"pkcs5prv")}if(s.indexOf("-END PRIVATE KEY-")!=-1)return L.getKeyFromPlainPrivatePKCS8PEM(s);if(s.indexOf("-END RSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var Fe=L.getDecryptedKeyHex(s,c),ve=new xe;return ve.readPKCS5PrvKeyHex(Fe),ve}if(s.indexOf("-END EC PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var Q=L.getDecryptedKeyHex(s,c),P=m(Q,0,[1],"04"),Ce=m(Q,0,[2,0],"06"),Ne=m(Q,0,[3,0],"03").substr(2),Me="";if(y.crypto.OID.oidhex2name[Ce]!==void 0)Me=y.crypto.OID.oidhex2name[Ce];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+Ce);var D=new k({curve:Me});return D.setPublicKeyHex(Ne),D.setPrivateKeyHex(P),D.isPublic=!1,D}if(s.indexOf("-END DSA PRIVATE KEY-")!=-1&&s.indexOf("4,ENCRYPTED")!=-1){var Q=L.getDecryptedKeyHex(s,c),te=m(Q,0,[1],"02"),J=m(Q,0,[2],"02"),re=m(Q,0,[3],"02"),pe=m(Q,0,[4],"02"),be=m(Q,0,[5],"02"),P=new O;return P.setPrivate(new _(te,16),new _(J,16),new _(re,16),new _(pe,16),new _(be,16)),P}if(s.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return L.getKeyFromEncryptedPKCS8PEM(s,c);throw new Error("not supported argument")},Nt.generateKeypair=function(s,c){if(s=="RSA"){var l=c,d=new xe;d.generate(l,"10001"),d.isPrivate=!0,d.isPublic=!0;var g=new xe,m=d.n.toString(16),T=d.e.toString(16);g.setPublic(m,T),g.isPrivate=!1,g.isPublic=!0;var k={};return k.prvKeyObj=d,k.pubKeyObj=g,k}else if(s=="EC"){var O=c,F=new y.crypto.ECDSA({curve:O}),U=F.generateKeyPairHex(),d=new y.crypto.ECDSA({curve:O});d.setPublicKeyHex(U.ecpubhex),d.setPrivateKeyHex(U.ecprvhex),d.isPrivate=!0,d.isPublic=!1;var g=new y.crypto.ECDSA({curve:O});g.setPublicKeyHex(U.ecpubhex),g.isPrivate=!1,g.isPublic=!0;var k={};return k.prvKeyObj=d,k.pubKeyObj=g,k}else throw new Error("unknown algorithm: "+s)},Nt.getPEM=function(s,c,l,d,g,m){var T=y,k=T.asn1,O=k.DERObjectIdentifier,F=k.DERInteger,U=k.ASN1Util.newObject,L=k.x509,P=L.SubjectPublicKeyInfo,D=T.crypto,A=D.DSA,N=D.ECDSA,j=xe;function W(Ce){var Ne=U({seq:[{int:0},{int:{bigint:Ce.n}},{int:Ce.e},{int:{bigint:Ce.d}},{int:{bigint:Ce.p}},{int:{bigint:Ce.q}},{int:{bigint:Ce.dmp1}},{int:{bigint:Ce.dmq1}},{int:{bigint:Ce.coeff}}]});return Ne}function se(Ce){var Ne=U({seq:[{int:1},{octstr:{hex:Ce.prvKeyHex}},{tag:["a0",!0,{oid:{name:Ce.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+Ce.pubKeyHex}}]}]});return Ne}function he(Ce){var Ne=U({seq:[{int:0},{int:{bigint:Ce.p}},{int:{bigint:Ce.q}},{int:{bigint:Ce.g}},{int:{bigint:Ce.y}},{int:{bigint:Ce.x}}]});return Ne}if((j!==void 0&&s instanceof j||A!==void 0&&s instanceof A||N!==void 0&&s instanceof N)&&s.isPublic==!0&&(c===void 0||c=="PKCS8PUB")){var de=new P(s),fe=de.tohex();return nr(fe,"PUBLIC KEY")}if(c=="PKCS1PRV"&&j!==void 0&&s instanceof j&&(l===void 0||l==null)&&s.isPrivate==!0){var de=W(s),fe=de.tohex();return nr(fe,"RSA PRIVATE KEY")}if(c=="PKCS1PRV"&&N!==void 0&&s instanceof N&&(l===void 0||l==null)&&s.isPrivate==!0){var G=new O({name:s.curveName}),Q=G.tohex(),te=se(s),J=te.tohex(),re="";return re+=nr(Q,"EC PARAMETERS"),re+=nr(J,"EC PRIVATE KEY"),re}if(c=="PKCS1PRV"&&A!==void 0&&s instanceof A&&(l===void 0||l==null)&&s.isPrivate==!0){var de=he(s),fe=de.tohex();return nr(fe,"DSA PRIVATE KEY")}if(c=="PKCS5PRV"&&j!==void 0&&s instanceof j&&l!==void 0&&l!=null&&s.isPrivate==!0){var de=W(s),fe=de.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",fe,l,d,m)}if(c=="PKCS5PRV"&&N!==void 0&&s instanceof N&&l!==void 0&&l!=null&&s.isPrivate==!0){var de=se(s),fe=de.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",fe,l,d,m)}if(c=="PKCS5PRV"&&A!==void 0&&s instanceof A&&l!==void 0&&l!=null&&s.isPrivate==!0){var de=he(s),fe=de.tohex();return d===void 0&&(d="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",fe,l,d,m)}var pe=function(Ce,Ne){if(typeof Ne=="string")return Nt.getEncryptedPKCS8PEM(Ce,Ne);if(typeof Ne=="object"&&Yt(Ne,"passcode")!=null){var Me=JSON.parse(JSON.stringify(Ne)),rr=Me.passcode;return delete Me.passcode,Nt.getEncryptedPKCS8PEM(Ce,rr,Me)}};if(c=="PKCS8PRV"&&j!=null&&s instanceof j&&s.isPrivate==!0){var be=W(s),Fe=be.tohex(),de=U({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:Fe}}]}),fe=de.tohex();return l===void 0||l==null?nr(fe,"PRIVATE KEY"):pe(fe,l)}if(c=="PKCS8PRV"&&N!==void 0&&s instanceof N&&s.isPrivate==!0){var ve={seq:[{int:1},{octstr:{hex:s.prvKeyHex}}]};typeof s.pubKeyHex=="string"&&ve.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+s.pubKeyHex}}]});var be=new U(ve),Fe=be.tohex(),de=U({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:s.curveName}}]},{octstr:{hex:Fe}}]}),fe=de.tohex();return l===void 0||l==null?nr(fe,"PRIVATE KEY"):pe(fe,l)}if(c=="PKCS8PRV"&&A!==void 0&&s instanceof A&&s.isPrivate==!0){var be=new F({bigint:s.x}),Fe=be.tohex(),de=U({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:s.p}},{int:{bigint:s.q}},{int:{bigint:s.g}}]}]},{octstr:{hex:Fe}}]}),fe=de.tohex();return l===void 0||l==null?nr(fe,"PRIVATE KEY"):pe(fe,l)}throw new Error("unsupported object nor format")},Nt.getKeyFromCSRPEM=function(s){var c=bn(s,"CERTIFICATE REQUEST"),l=Nt.getKeyFromCSRHex(c);return l},Nt.getKeyFromCSRHex=function(s){var c=Nt.parseCSRHex(s),l=Nt.getKey(c.p8pubkeyhex,null,"pkcs8pub");return l},Nt.parseCSRHex=function(s){var c=je,l=c.getChildIdx,d=c.getTLV,g={},m=s;if(m.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var T=l(m,0);if(T.length<1)throw new Error("malformed CSR(code:002)");if(m.substr(T[0],2)!="30")throw new Error("malformed CSR(code:003)");var k=l(m,T[0]);if(k.length<3)throw new Error("malformed CSR(code:004)");return g.p8pubkeyhex=d(m,k[2]),g},Nt.getKeyID=function(s){var c=Nt,l=je;typeof s=="string"&&s.indexOf("BEGIN ")!=-1&&(s=c.getKey(s));var d=bn(c.getPEM(s)),g=l.getIdxbyList(d,0,[1]),m=l.getV(d,g).substring(2);return y.crypto.Util.hashHex(m,"sha1")},Nt.getJWK=function(s,c,l,d,g){var m,T={},k,O=y.crypto.Util.hashHex;if(typeof s=="string")m=Nt.getKey(s),s.indexOf("CERTIFICATE")!=-1&&(k=bn(s));else if(typeof s=="object")s instanceof lt?(m=s.getPublicKey(),k=s.hex):m=s;else throw new Error("unsupported keyinfo type");if(m instanceof xe&&m.isPrivate)T.kty="RSA",T.n=On(m.n.toString(16)),T.e=On(m.e.toString(16)),T.d=On(m.d.toString(16)),T.p=On(m.p.toString(16)),T.q=On(m.q.toString(16)),T.dp=On(m.dmp1.toString(16)),T.dq=On(m.dmq1.toString(16)),T.qi=On(m.coeff.toString(16));else if(m instanceof xe&&m.isPublic)T.kty="RSA",T.n=On(m.n.toString(16)),T.e=On(m.e.toString(16));else if(m instanceof y.crypto.ECDSA&&m.isPrivate){var F=m.getShortNISTPCurveName();if(F!=="P-256"&&F!=="P-384"&&F!=="P-521")throw new Error("unsupported curve name for JWT: "+F);var U=m.getPublicKeyXYHex();T.kty="EC",T.crv=F,T.x=On(U.x),T.y=On(U.y),T.d=On(m.prvKeyHex)}else if(m instanceof y.crypto.ECDSA&&m.isPublic){var F=m.getShortNISTPCurveName();if(F!=="P-256"&&F!=="P-384"&&F!=="P-521")throw new Error("unsupported curve name for JWT: "+F);var U=m.getPublicKeyXYHex();T.kty="EC",T.crv=F,T.x=On(U.x),T.y=On(U.y)}if(T.kty==null)throw new Error("unsupported keyinfo");return!m.isPrivate&&c!=!0&&(T.kid=y.jws.JWS.getJWKthumbprint(T)),k!=null&&l!=!0&&(T.x5c=[p(k)]),k!=null&&d!=!0&&(T.x5t=Za(p(O(k,"sha1")))),k!=null&&g!=!0&&(T["x5t#S256"]=Za(p(O(k,"sha256")))),T},Nt.getJWKFromKey=function(s){return Nt.getJWK(s,!0,!0,!0,!0)},xe.getPosArrayOfChildrenFromHex=function(s){return je.getChildIdx(s,0)},xe.getHexValueArrayOfChildrenFromHex=function(s){var c=je,l=c.getV,P=xe.getPosArrayOfChildrenFromHex(s),d=l(s,P[0]),g=l(s,P[1]),m=l(s,P[2]),T=l(s,P[3]),k=l(s,P[4]),O=l(s,P[5]),F=l(s,P[6]),U=l(s,P[7]),L=l(s,P[8]),P=new Array;return P.push(d,g,m,T,k,O,F,U,L),P},xe.prototype.readPrivateKeyFromPEMString=function(s){var c=bn(s),l=xe.getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8])},xe.prototype.readPKCS5PrvKeyHex=function(s){var c=xe.getHexValueArrayOfChildrenFromHex(s);this.setPrivateEx(c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])},xe.prototype.readPKCS8PrvKeyHex=function(s){var c,l,d,g,m,T,k,O,F=je,U=F.getVbyListEx;if(F.isASN1HEX(s)===!1)throw new Error("not ASN.1 hex string");try{c=U(s,0,[2,0,1],"02"),l=U(s,0,[2,0,2],"02"),d=U(s,0,[2,0,3],"02"),g=U(s,0,[2,0,4],"02"),m=U(s,0,[2,0,5],"02"),T=U(s,0,[2,0,6],"02"),k=U(s,0,[2,0,7],"02"),O=U(s,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(c,l,d,g,m,T,k,O)},xe.prototype.readPKCS5PubKeyHex=function(s){var c=je,l=c.getV;if(c.isASN1HEX(s)===!1)throw new Error("keyHex is not ASN.1 hex string");var d=c.getChildIdx(s,0);if(d.length!==2||s.substr(d[0],2)!=="02"||s.substr(d[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var g=l(s,d[0]),m=l(s,d[1]);this.setPublic(g,m)},xe.prototype.readPKCS8PubKeyHex=function(s){var c=je;if(c.isASN1HEX(s)===!1)throw new Error("not ASN.1 hex string");if(c.getTLVbyListEx(s,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var l=c.getTLVbyListEx(s,0,[1,0]);this.readPKCS5PubKeyHex(l)},xe.prototype.readCertPubKeyHex=function(s,c){var l,d;l=new lt,l.readCertHex(s),d=l.getPublicKeyHex(),this.readPKCS8PubKeyHex(d)};function bg(s,c){for(var l="",d=c/4-s.length,g=0;g<d;g++)l=l+"0";return l+s}xe.prototype.sign=function(s,c){var l=function(g){return y.crypto.Util.hashString(g,c)},d=l(s);return this.signWithMessageHash(d,c)},xe.prototype.signWithMessageHash=function(s,c){var l=y.crypto.Util.getPaddedDigestInfoHex(s,c,this.n.bitLength()),d=Se(l,16),g=this.doPrivate(d),m=g.toString(16);return bg(m,this.n.bitLength())};function Sg(s,c,l){for(var d="",g=0;d.length<c;)d+=Tr(l(Bi(s+String.fromCharCode.apply(String,[(g&4278190080)>>24,(g&16711680)>>16,(g&65280)>>8,g&255])))),g+=1;return d}xe.prototype.signPSS=function(s,c,l){var d=function(m){return y.crypto.Util.hashHex(m,c)},g=d(Bi(s));return l===void 0&&(l=-1),this.signWithMessageHashPSS(g,c,l)},xe.prototype.signWithMessageHashPSS=function(s,c,l){var d=Tr(s),g=d.length,m=this.n.bitLength()-1,T=Math.ceil(m/8),k,O=function(j){return y.crypto.Util.hashHex(j,c)};if(l===-1||l===void 0)l=g;else if(l===-2)l=T-g-2;else if(l<-2)throw new Error("invalid salt length");if(T<g+l+2)throw new Error("data too long");var F="";l>0&&(F=new Array(l),new ae().nextBytes(F),F=String.fromCharCode.apply(String,F));var U=Tr(O(Bi("\0\0\0\0\0\0\0\0"+d+F))),L=[];for(k=0;k<T-l-g-2;k+=1)L[k]=0;var P=String.fromCharCode.apply(String,L)+""+F,D=Sg(U,P.length,O),A=[];for(k=0;k<P.length;k+=1)A[k]=P.charCodeAt(k)^D.charCodeAt(k);var N=65280>>8*T-m&255;for(A[0]&=~N,k=0;k<g;k++)A.push(U.charCodeAt(k));return A.push(188),bg(this.doPrivate(new _(A)).toString(16),this.n.bitLength())};function wg(s){for(var c in y.crypto.Util.DIGESTINFOHEAD){var l=y.crypto.Util.DIGESTINFOHEAD[c],d=l.length;if(s.substring(0,d)==l){var g=[c,s.substring(d)];return g}}return[]}xe.prototype.verify=function(s,c){if(c=c.toLowerCase(),c.match(/^[0-9a-f]+$/)==null)return!1;var l=Se(c,16),d=this.n.bitLength();if(l.bitLength()>d)return!1;var g=this.doPublic(l),m=g.toString(16);if(m.length+3!=d/4)return!1;var T=m.replace(/^1f+00/,""),k=wg(T);if(k.length==0)return!1;var O=k[0],F=k[1],U=function(P){return y.crypto.Util.hashString(P,O)},L=U(s);return F==L},xe.prototype.verifyWithMessageHash=function(s,c){if(c.length!=Math.ceil(this.n.bitLength()/4))return!1;var l=Se(c,16);if(l.bitLength()>this.n.bitLength())return 0;var d=this.doPublic(l),g=d.toString(16).replace(/^1f+00/,""),m=wg(g);if(m.length==0)return!1;m[0];var T=m[1];return T==s},xe.prototype.verifyPSS=function(s,c,l,d){var g=function(T){return y.crypto.Util.hashHex(T,l)},m=g(Bi(s));return d===void 0&&(d=-1),this.verifyWithMessageHashPSS(m,c,l,d)},xe.prototype.verifyWithMessageHashPSS=function(s,c,l,d){if(c.length!=Math.ceil(this.n.bitLength()/4))return!1;var g=new _(c,16),m=function(se){return y.crypto.Util.hashHex(se,l)},T=Tr(s),k=T.length,O=this.n.bitLength()-1,F=Math.ceil(O/8),U;if(d===-1||d===void 0)d=k;else if(d===-2)d=F-k-2;else if(d<-2)throw new Error("invalid salt length");if(F<k+d+2)throw new Error("data too long");var L=this.doPublic(g).toByteArray();for(U=0;U<L.length;U+=1)L[U]&=255;for(;L.length<F;)L.unshift(0);if(L[F-1]!==188)throw new Error("encoded message does not end in 0xbc");L=String.fromCharCode.apply(String,L);var P=L.substr(0,F-k-1),D=L.substr(P.length,k),A=65280>>8*F-O&255;if(P.charCodeAt(0)&A)throw new Error("bits beyond keysize not zero");var N=Sg(D,P.length,m),j=[];for(U=0;U<P.length;U+=1)j[U]=P.charCodeAt(U)^N.charCodeAt(U);j[0]&=~A;var W=F-k-d-2;for(U=0;U<W;U+=1)if(j[U]!==0)throw new Error("leftmost octets not zero");if(j[W]!==1)throw new Error("0x01 marker not found");return D===Tr(m(Bi("\0\0\0\0\0\0\0\0"+T+String.fromCharCode.apply(String,j.slice(-d)))))},xe.SALT_LEN_HLEN=-1,xe.SALT_LEN_MAX=-2,xe.SALT_LEN_RECOVER=-2;function lt(s){var c=je,l=c.getChildIdx,d=c.getV;c.dump;var g=c.parse,m=c.getTLV,T=c.getVbyList,k=c.getVbyListEx,O=c.getTLVbyList,F=c.getTLVbyListEx,U=c.getIdxbyList,L=c.getIdxbyListEx,P=c.getVidx,D=c.getInt,A=c.oidname,N=c.hextooidstr,j=bn,W,se=Error;try{W=y.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var G=O(this.hex,0,[0,0]);if(G.substr(0,2)=="a0"){var Q=O(G,0,[0]),te=D(Q,0);if(te<0||2<te)throw new Error("malformed version field");return this.version=te+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return k(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var G=F(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(G)},this.getAlgorithmIdentifierName=function(G){for(var Q in W)if(G===W[Q])return Q;return A(k(G,0,[0],"06"))},this.getIssuer=function(G,Q){return this.getX500Name(this.getIssuerHex(),G,Q)},this.getIssuerHex=function(){return O(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var G=this.getIssuer();return G.str},this.getSubject=function(G,Q){return this.getX500Name(this.getSubjectHex(),G,Q)},this.getSubjectHex=function(){return O(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var G=this.getSubject();return G.str},this.getNotBefore=function(){var G=T(this.hex,0,[0,4+this.foffset,0]);return G=G.replace(/(..)/g,"%$1"),G=decodeURIComponent(G),G},this.getNotAfter=function(){var G=T(this.hex,0,[0,4+this.foffset,1]);return G=G.replace(/(..)/g,"%$1"),G=decodeURIComponent(G),G},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return O(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var G=this.getSPKI();return G==null?null:T(G,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return U(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var G=this.getPublicKeyIdx();return U(this.hex,G,[1,0],"30")},this.getPublicKey=function(){return Nt.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var G=O(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(G)},this.getSignatureValueHex=function(){return T(this.hex,0,[2],"03",!0)},this.verifySignature=function(G){var Q=this.getSignatureAlgorithmField(),te=this.getSignatureValueHex(),J=O(this.hex,0,[0],"30"),re=new y.crypto.Signature({alg:Q});return re.init(G),re.updateHex(J),re.verify(te)},this.parseExt=function(G){var Q,te,J;if(G===void 0){if(J=this.hex,this.version!==3)return-1;Q=U(J,0,[0,7,0],"30"),te=l(J,Q)}else{J=bn(G);var re=U(J,0,[0,3,0,0],"06");if(d(J,re)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}Q=U(J,0,[0,3,0,1,0],"30"),te=l(J,Q),this.hex=J}this.aExtInfo=new Array;for(var pe=0;pe<te.length;pe++){var be={};be.critical=!1;var Fe=l(J,te[pe]),ve=0;Fe.length===3&&(be.critical=!0,ve=1),be.oid=c.hextooidstr(T(J,te[pe],[0],"06"));var Ce=U(J,te[pe],[1+ve]);be.vidx=P(J,Ce),this.aExtInfo.push(be)}},this.getExtInfo=function(G){var Q=this.aExtInfo,te=G;if(G.match(/^[0-9.]+$/)||(te=y.asn1.x509.OID.name2oid(G)),te!==""){for(var J=0;J<Q.length;J++)if(Q[J].oid===te)return Q[J]}},this.getCriticalExtV=function(G,Q,te){if(Q!=null)return[Q,te];var J=this.getExtInfo(G);return J==null?[null,null]:[m(this.hex,J.vidx),J.critical]},this.getExtBasicConstraints=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("basicConstraints");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"basicConstraints"};if(Q&&(J.critical=!0),G==="3000")return J;if(G==="30030101ff")return J.cA=!0,J;if(G.substr(0,12)==="30060101ff02"){var re=d(G,10),pe=parseInt(re,16);return J.cA=!0,J.pathLen=pe,J}throw new Error("hExtV parse error: "+G)},this.getExtNameConstraints=function(G,Q){var te=this.getCriticalExtV("nameConstraints",G,Q);if(G=te[0],Q=te[1],G!=null){var J={extname:"nameConstraints"};Q&&(J.critical=!0);for(var re=l(G,0),pe=0;pe<re.length;pe++){for(var be=[],Fe=l(G,re[pe]),ve=0;ve<Fe.length;ve++){var Ce=m(G,Fe[ve]),Ne=this.getGeneralSubtree(Ce);be.push(Ne)}var Me=G.substr(re[pe],2);Me=="a0"?J.permit=be:Me=="a1"&&(J.exclude=be)}return J}},this.getGeneralSubtree=function(G){var Q=l(G,0),te=Q.length;if(te<1||2<te)throw new Error("wrong num elements");for(var J=this.getGeneralName(m(G,Q[0])),re=1;re<te;re++){var pe=G.substr(Q[re],2),be=d(G,Q[re]),Fe=parseInt(be,16);pe=="80"&&(J.min=Fe),pe=="81"&&(J.max=Fe)}return J},this.getExtKeyUsage=function(G,Q){var te=this.getCriticalExtV("keyUsage",G,Q);if(G=te[0],Q=te[1],G!=null){var J={extname:"keyUsage"};return Q&&(J.critical=!0),J.names=this.getExtKeyUsageString(G).split(","),J}},this.getExtKeyUsageBin=function(G){if(G===void 0){var Q=this.getExtInfo("keyUsage");if(Q===void 0)return"";G=m(this.hex,Q.vidx)}if(G.length!=8&&G.length!=10)throw new Error("malformed key usage value: "+G);var te="000000000000000"+parseInt(G.substr(6),16).toString(2);return G.length==8&&(te=te.slice(-8)),G.length==10&&(te=te.slice(-16)),te=te.replace(/0+$/,""),te==""&&(te="0"),te},this.getExtKeyUsageString=function(G){for(var Q=this.getExtKeyUsageBin(G),te=new Array,J=0;J<Q.length;J++)Q.substr(J,1)=="1"&&te.push(lt.KEYUSAGE_NAME[J]);return te.join(",")},this.getExtSubjectKeyIdentifier=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("subjectKeyIdentifier");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"subjectKeyIdentifier"};Q&&(J.critical=!0);var re=d(G,0);return J.kid={hex:re},J},this.getExtAuthorityKeyIdentifier=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("authorityKeyIdentifier");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"authorityKeyIdentifier"};Q&&(J.critical=!0);for(var re=l(G,0),pe=0;pe<re.length;pe++){var be=G.substr(re[pe],2);if(be==="80"&&(J.kid={hex:d(G,re[pe])}),be==="a1"){var Fe=m(G,re[pe]),ve=this.getGeneralNames(Fe);J.issuer=ve[0].dn}be==="82"&&(J.sn={hex:d(G,re[pe])})}return J},this.getExtExtKeyUsage=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("extKeyUsage");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"extKeyUsage",array:[]};Q&&(J.critical=!0);for(var re=l(G,0),pe=0;pe<re.length;pe++)J.array.push(A(d(G,re[pe])));return J},this.getExtExtKeyUsageName=function(){var G=this.getExtInfo("extKeyUsage");if(G===void 0)return G;var Q=new Array,te=m(this.hex,G.vidx);if(te==="")return Q;for(var J=l(te,0),re=0;re<J.length;re++)Q.push(A(d(te,J[re])));return Q},this.getExtSubjectAltName=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("subjectAltName");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"subjectAltName",array:[]};return Q&&(J.critical=!0),J.array=this.getGeneralNames(G),J},this.getExtIssuerAltName=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("issuerAltName");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"issuerAltName",array:[]};return Q&&(J.critical=!0),J.array=this.getGeneralNames(G),J},this.getGeneralNames=function(G){for(var Q=l(G,0),te=[],J=0;J<Q.length;J++){var re=this.getGeneralName(m(G,Q[J]));re!==void 0&&te.push(re)}return te},this.getGeneralName=function(G){var Q=G.substr(0,2),te=d(G,0),J=Tr(te);if(Q=="81")return{rfc822:J};if(Q=="82")return{dns:J};if(Q=="86")return{uri:J};if(Q=="87")return{ip:Kl(te)};if(Q=="a4")return{dn:this.getX500Name(te)};if(Q=="a0")return{other:this.getOtherName(G)}},this.getExtSubjectAltName2=function(){var G,Q,te,J=this.getExtInfo("subjectAltName");if(J===void 0)return J;for(var re=new Array,pe=m(this.hex,J.vidx),be=l(pe,0),Fe=0;Fe<be.length;Fe++)te=pe.substr(be[Fe],2),G=d(pe,be[Fe]),te==="81"&&(Q=Jt(G),re.push(["MAIL",Q])),te==="82"&&(Q=Jt(G),re.push(["DNS",Q])),te==="84"&&(Q=lt.hex2dn(G,0),re.push(["DN",Q])),te==="86"&&(Q=Jt(G),re.push(["URI",Q])),te==="87"&&(Q=Kl(G),re.push(["IP",Q]));return re},this.getExtCRLDistributionPoints=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("cRLDistributionPoints");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"cRLDistributionPoints",array:[]};Q&&(J.critical=!0);for(var re=l(G,0),pe=0;pe<re.length;pe++){var be=m(G,re[pe]);J.array.push(this.getDistributionPoint(be))}return J},this.getDistributionPoint=function(G){for(var Q={},te=l(G,0),J=0;J<te.length;J++){var re=G.substr(te[J],2),pe=m(G,te[J]);re=="a0"&&(Q.dpname=this.getDistributionPointName(pe))}return Q},this.getDistributionPointName=function(G){for(var Q={},te=l(G,0),J=0;J<te.length;J++){var re=G.substr(te[J],2),pe=m(G,te[J]);re=="a0"&&(Q.full=this.getGeneralNames(pe))}return Q},this.getExtCRLDistributionPointsURI=function(){var G=this.getExtCRLDistributionPoints();if(G==null)return G;for(var Q=G.array,te=[],J=0;J<Q.length;J++)try{Q[J].dpname.full[0].uri!=null&&te.push(Q[J].dpname.full[0].uri)}catch{}return te},this.getExtAIAInfo=function(){var G=this.getExtInfo("authorityInfoAccess");if(G===void 0)return G;for(var Q={ocsp:[],caissuer:[]},te=l(this.hex,G.vidx),J=0;J<te.length;J++){var re=T(this.hex,te[J],[0],"06"),pe=T(this.hex,te[J],[1],"86");re==="2b06010505073001"&&Q.ocsp.push(Jt(pe)),re==="2b06010505073002"&&Q.caissuer.push(Jt(pe))}return Q},this.getExtAuthorityInfoAccess=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("authorityInfoAccess");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"authorityInfoAccess",array:[]};Q&&(J.critical=!0);for(var re=l(G,0),pe=0;pe<re.length;pe++){var be=k(G,re[pe],[0],"06"),Fe=T(G,re[pe],[1],"86"),ve=Jt(Fe);if(be=="2b06010505073001")J.array.push({ocsp:ve});else if(be=="2b06010505073002")J.array.push({caissuer:ve});else throw new Error("unknown method: "+be)}return J},this.getExtCertificatePolicies=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("certificatePolicies");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"certificatePolicies",array:[]};Q&&(J.critical=!0);for(var re=l(G,0),pe=0;pe<re.length;pe++){var be=m(G,re[pe]),Fe=this.getPolicyInformation(be);J.array.push(Fe)}return J},this.getPolicyInformation=function(G){var Q={},te=T(G,0,[0],"06");Q.policyoid=A(te);var J=L(G,0,[1],"30");if(J!=-1){Q.array=[];for(var re=l(G,J),pe=0;pe<re.length;pe++){var be=m(G,re[pe]),Fe=this.getPolicyQualifierInfo(be);Q.array.push(Fe)}}return Q},this.getOtherName=function(G){var Q={},te=l(G,0),J=T(G,te[0],[],"06"),re=T(G,te[1],[]);return Q.oid=A(J),Q.value=g(re),Q},this.getPolicyQualifierInfo=function(G){var Q={},te=T(G,0,[0],"06");if(te==="2b06010505070201"){var J=k(G,0,[1],"16");Q.cps=Tr(J)}else if(te==="2b06010505070202"){var re=O(G,0,[1],"30");Q.unotice=this.getUserNotice(re)}return Q},this.getUserNotice=function(G){var Q=null;try{Q=c.parse(G);var te=this._asn1ToUnotice(Q);return te}catch{return}},this._asn1ToUnotice=function(G){try{for(var Q={},te=Yt(G,"seq"),J=0;J<te.length;J++){var re=this._asn1ToNoticeRef(te[J]);re!=null&&(Q.noticeref=re);var pe=this.asn1ToDisplayText(te[J]);pe!=null&&(Q.exptext=pe)}return Object.keys(Q).length>0?Q:void 0}catch{return}},this._asn1ToNoticeRef=function(G){try{for(var Q={},te=Yt(G,"seq"),J=0;J<te.length;J++){var re=this._asn1ToNoticeNum(te[J]);re!=null&&(Q.noticenum=re);var pe=this.asn1ToDisplayText(te[J]);pe!=null&&(Q.org=pe)}return Object.keys(Q).length>0?Q:void 0}catch{return}},this._asn1ToNoticeNum=function(G){try{for(var Q=Yt(G,"seq"),te=[],J=0;J<Q.length;J++){var re=Q[J];te.push(parseInt(Yt(re,"int.hex"),16))}return te}catch{return}},this.getDisplayText=function(G){var Q={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},te={};return te.type=Q[G.substr(0,2)],te.str=Tr(d(G,0)),te},this.asn1ToDisplayText=function(G){if(G.utf8str!=null)return{type:"utf8",str:G.utf8str.str};if(G.ia5str!=null)return{type:"ia5",str:G.ia5str.str};if(G.visstr!=null)return{type:"vis",str:G.visstr.str};if(G.bmpstr!=null)return{type:"bmp",str:G.bmpstr.str};if(G.prnstr!=null)return{type:"prn",str:G.prnstr.str}},this.getExtPolicyMappings=function(G,Q){var te=this.getCriticalExtV("policyMappings",G,Q);if(G=te[0],Q=te[1],G!=null){var J={extname:"policyMappings"};Q&&(J.critical=!0);try{for(var re=g(G),pe=re.seq,be=[],Fe=0;Fe<pe.length;Fe++){var ve=pe[Fe].seq;be.push([ve[0].oid,ve[1].oid])}J.array=be}catch{throw new se("malformed policyMappings")}return J}},this.getExtPolicyConstraints=function(G,Q){var te=this.getCriticalExtV("policyConstraints",G,Q);if(G=te[0],Q=te[1],G!=null){var J={extname:"policyConstraints"};Q&&(J.critical=!0);var re=g(G);try{for(var pe=re.seq,be=0;be<pe.length;be++){var Fe=pe[be].tag;Fe.explicit==!1&&(Fe.tag=="80"&&(J.reqexp=parseInt(Fe.hex,16)),Fe.tag=="81"&&(J.inhibit=parseInt(Fe.hex,16)))}}catch{return new se("malformed policyConstraints value")}return J}},this.getExtInhibitAnyPolicy=function(G,Q){var te=this.getCriticalExtV("inhibitAnyPolicy",G,Q);if(G=te[0],Q=te[1],G!=null){var J={extname:"inhibitAnyPolicy"};Q&&(J.critical=!0);var re=D(G,0);return re==-1?new se("wrong value"):(J.skip=re,J)}},this.getExtCRLNumber=function(G,Q){var te={extname:"cRLNumber"};if(Q&&(te.critical=!0),G.substr(0,2)=="02")return te.num={hex:d(G,0)},te;throw new se("hExtV parse error: "+G)},this.getExtCRLReason=function(G,Q){var te={extname:"cRLReason"};if(Q&&(te.critical=!0),G.substr(0,2)=="0a")return te.code=parseInt(d(G,0),16),te;throw new Error("hExtV parse error: "+G)},this.getExtOcspNonce=function(G,Q){var te={extname:"ocspNonce"};Q&&(te.critical=!0);var J=d(G,0);return te.hex=J,te},this.getExtOcspNoCheck=function(G,Q){var te={extname:"ocspNoCheck"};return Q&&(te.critical=!0),te},this.getExtAdobeTimeStamp=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("adobeTimeStamp");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"adobeTimeStamp"};Q&&(J.critical=!0);var re=l(G,0);if(re.length>1){var pe=m(G,re[1]),be=this.getGeneralName(pe);be.uri!=null&&(J.uri=be.uri)}if(re.length>2){var Fe=m(G,re[2]);Fe=="0101ff"&&(J.reqauth=!0),Fe=="010100"&&(J.reqauth=!1)}return J},this.getExtSubjectDirectoryAttributes=function(G,Q){if(G===void 0&&Q===void 0){var te=this.getExtInfo("subjectDirectoryAttributes");if(te===void 0)return;G=m(this.hex,te.vidx),Q=te.critical}var J={extname:"subjectDirectoryAttributes"};Q&&(J.critical=!0);try{for(var re=g(G),pe=[],be=0;be<re.seq.length;be++){var Fe=re.seq[be],ve=Yt(Fe,"seq.0.oid"),Ce=Yt(Fe,"seq.1.set");if(ve==null||Ce==null)throw"error";pe.push({attr:ve,array:Ce})}return J.array=pe,J}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var he=function(G){var Q={};try{var te=G.seq[0].oid,J=y.asn1.x509.OID.name2oid(te);Q.type=y.asn1.x509.OID.oid2atype(J);var re=G.seq[1];if(re.utf8str!=null)Q.ds="utf8",Q.value=re.utf8str.str;else if(re.numstr!=null)Q.ds="num",Q.value=re.numstr.str;else if(re.telstr!=null)Q.ds="tel",Q.value=re.telstr.str;else if(re.prnstr!=null)Q.ds="prn",Q.value=re.prnstr.str;else if(re.ia5str!=null)Q.ds="ia5",Q.value=re.ia5str.str;else if(re.visstr!=null)Q.ds="vis",Q.value=re.visstr.str;else if(re.bmpstr!=null)Q.ds="bmp",Q.value=re.bmpstr.str;else throw"error";return Q}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},de=function(G){try{return G.set.map(function(Q){return he(Q)})}catch(Q){throw new Error("improper ASN.1 parsed RDN: "+Q)}},fe=function(G){try{return G.seq.map(function(Q){return de(Q)})}catch(Q){throw new Error("improper ASN.1 parsed X500Name: "+Q)}};this.getX500NameRule=function(G){for(var Q=null,te=[],J=0;J<G.length;J++)for(var re=G[J],pe=0;pe<re.length;pe++)te.push(re[pe]);for(var J=0;J<te.length;J++){var be=te[J],Fe=be.ds,ve=be.value,Ce=be.type;if(Fe!="prn"&&Fe!="utf8"&&Fe!="ia5")return"mixed";if(Fe=="ia5"){if(Ce!="CN")return"mixed";if(y.lang.String.isMail(ve))continue;return"mixed"}if(Ce=="C"){if(Fe=="prn")continue;return"mixed"}if(Q==null)Q=Fe;else if(Q!==Fe)return"mixed"}return Q??"prn"},this.getAttrTypeAndValue=function(G){var Q=g(G);return he(Q)},this.getRDN=function(G){var Q=g(G);return de(Q)},this.getX500NameArray=function(G){var Q=g(G);return fe(Q)},this.getX500Name=function(G,Q,te){var J=this.getX500NameArray(G),re=this.dnarraytostr(J),pe={str:re};return pe.array=J,te==!0&&(pe.hex=G),Q==!0&&(pe.canon=this.c14nRDNArray(J)),pe},this.readCertPEM=function(G){this.readCertHex(j(G))},this.readCertHex=function(G){this.hex=G,this.getVersion();try{U(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(G){var Q={};return G==null&&(G={}),Q.version=this.getVersion(),Q.serial={hex:this.getSerialNumberHex()},Q.sigalg=this.getSignatureAlgorithmField(),Q.issuer=this.getIssuer(G.dncanon,G.dnhex),Q.notbefore=this.getNotBefore(),Q.notafter=this.getNotAfter(),Q.subject=this.getSubject(G.dncanon,G.dnhex),Q.sbjpubkey=nr(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(Q.ext=this.getExtParamArray()),Q.sighex=this.getSignatureValueHex(),G.tbshex==!0&&(Q.tbshex=O(this.hex,0,[0])),G.nodnarray==!0&&(delete Q.issuer.array,delete Q.subject.array),Q},this.getExtParamArray=function(G){if(G==null){var Q=L(this.hex,0,[0,"[3]"]);Q!=-1&&(G=F(this.hex,0,[0,"[3]",0],"30"))}for(var te=[],J=l(G,0),re=0;re<J.length;re++){var pe=m(G,J[re]),be=this.getExtParam(pe);be!=null&&te.push(be)}return te},this.getExtParam=function(G){var Q=l(G,0),te=Q.length;if(te!=2&&te!=3)throw new Error("wrong number elements in Extension: "+te+" "+G);var J=N(T(G,0,[0],"06")),re=!1;te==3&&O(G,0,[1])=="0101ff"&&(re=!0);var pe=O(G,0,[te-1,0]),be=void 0;if(J=="2.5.29.14"?be=this.getExtSubjectKeyIdentifier(pe,re):J=="2.5.29.15"?be=this.getExtKeyUsage(pe,re):J=="2.5.29.17"?be=this.getExtSubjectAltName(pe,re):J=="2.5.29.18"?be=this.getExtIssuerAltName(pe,re):J=="2.5.29.19"?be=this.getExtBasicConstraints(pe,re):J=="2.5.29.30"?be=this.getExtNameConstraints(pe,re):J=="2.5.29.31"?be=this.getExtCRLDistributionPoints(pe,re):J=="2.5.29.32"?be=this.getExtCertificatePolicies(pe,re):J=="2.5.29.33"?be=this.getExtPolicyMappings(pe,re):J=="2.5.29.35"?be=this.getExtAuthorityKeyIdentifier(pe,re):J=="2.5.29.36"?be=this.getExtPolicyConstraints(pe,re):J=="2.5.29.37"?be=this.getExtExtKeyUsage(pe,re):J=="2.5.29.54"?be=this.getExtInhibitAnyPolicy(pe,re):J=="1.3.6.1.5.5.7.1.1"?be=this.getExtAuthorityInfoAccess(pe,re):J=="2.5.29.20"?be=this.getExtCRLNumber(pe,re):J=="2.5.29.21"?be=this.getExtCRLReason(pe,re):J=="2.5.29.9"?be=this.getExtSubjectDirectoryAttributes(pe,re):J=="1.3.6.1.5.5.7.48.1.2"?be=this.getExtOcspNonce(pe,re):J=="1.3.6.1.5.5.7.48.1.5"?be=this.getExtOcspNoCheck(pe,re):J=="1.2.840.113583.1.1.9.1"?be=this.getExtAdobeTimeStamp(pe,re):lt.EXT_PARSER[J]!=null&&(be=lt.EXT_PARSER[J](J,re,pe)),be!=null)return be;var Fe={extname:J,extn:pe};try{Fe.extn=g(pe)}catch{}return re&&(Fe.critical=!0),Fe},this.findExt=function(G,Q){for(var te=0;te<G.length;te++)if(G[te].extname==Q)return G[te];return null},this.updateExtCDPFullURI=function(G,Q){var te=this.findExt(G,"cRLDistributionPoints");if(te!=null&&te.array!=null){for(var J=te.array,re=0;re<J.length;re++)if(J[re].dpname!=null&&J[re].dpname.full!=null)for(var pe=J[re].dpname.full,be=0;be<pe.length;be++){var Fe=pe[re];Fe.uri!=null&&(Fe.uri=Q)}}},this.updateExtAIAOCSP=function(G,Q){var te=this.findExt(G,"authorityInfoAccess");if(te!=null&&te.array!=null)for(var J=te.array,re=0;re<J.length;re++)J[re].ocsp!=null&&(J[re].ocsp=Q)},this.updateExtAIACAIssuer=function(G,Q){var te=this.findExt(G,"authorityInfoAccess");if(te!=null&&te.array!=null)for(var J=te.array,re=0;re<J.length;re++)J[re].caissuer!=null&&(J[re].caissuer=Q)},this.dnarraytostr=function(G){function Q(J){return J.map(function(re){return te(re).replace(/\+/,"\\+")}).join("+")}function te(J){return J.type+"="+J.value}return"/"+G.map(function(J){return Q(J).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(G){var Q;if(G.str!=null&&G.array==null){var te=new y.asn1.x509.X500Name({str:G.str}),J=te.tohex();Q=this.getX500NameArray(J)}else Q=G.array;G.canon==null&&(G.canon=this.c14nRDNArray(Q))},this.c14nRDNArray=function(G){for(var Q=[],te=0;te<G.length;te++){for(var J=G[te],re=[],pe=0;pe<J.length;pe++){var be=J[pe],Fe=be.value;Fe=Fe.replace(/^\s*/,""),Fe=Fe.replace(/\s*$/,""),Fe=Fe.replace(/\s+/g," "),Fe=Fe.toLowerCase(),re.push(be.type.toLowerCase()+"="+Fe)}Q.push(re.join("+"))}return"/"+Q.join("/")},this.getInfo=function(){var G=function(pr){for(var jt="",Qt="    ",fn=`
`,mn=pr.array,Rr=0;Rr<mn.length;Rr++){var Sn=mn[Rr];if(Sn.dn!=null&&(jt+=Qt+"dn: "+Sn.dn.str+fn),Sn.ip!=null&&(jt+=Qt+"ip: "+Sn.ip+fn),Sn.rfc822!=null&&(jt+=Qt+"rfc822: "+Sn.rfc822+fn),Sn.dns!=null&&(jt+=Qt+"dns: "+Sn.dns+fn),Sn.uri!=null&&(jt+=Qt+"uri: "+Sn.uri+fn),Sn.other!=null){var sc=Sn.other.oid,fa=JSON.stringify(Sn.other.value).replace(/\"/g,"");jt+=Qt+"other: "+sc+"="+fa+fn}}return jt=jt.replace(/\n$/,""),jt},Q=function(pr){for(var jt="",Qt=pr.array,fn=0;fn<Qt.length;fn++){var mn=Qt[fn];if(jt+="    policy oid: "+mn.policyoid+`
`,mn.array!==void 0)for(var Rr=0;Rr<mn.array.length;Rr++){var Sn=mn.array[Rr];Sn.cps!==void 0&&(jt+="    cps: "+Sn.cps+`
`)}}return jt},te=function(pr){for(var jt="",Qt=pr.array,fn=0;fn<Qt.length;fn++){var mn=Qt[fn];try{mn.dpname.full[0].uri!==void 0&&(jt+="    "+mn.dpname.full[0].uri+`
`)}catch{}try{mn.dname.full[0].dn.hex!==void 0&&(jt+="    "+lt.hex2dn(mn.dpname.full[0].dn.hex)+`
`)}catch{}}return jt},J=function(pr){for(var jt="",Qt=pr.array,fn=0;fn<Qt.length;fn++){var mn=Qt[fn];mn.caissuer!==void 0&&(jt+="    caissuer: "+mn.caissuer+`
`),mn.ocsp!==void 0&&(jt+="    ocsp: "+mn.ocsp+`
`)}return jt},re,pe,be;if(re=`Basic Fields
`,re+="  serial number: "+this.getSerialNumberHex()+`
`,re+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,re+="  issuer: "+this.getIssuerString()+`
`,re+="  notBefore: "+this.getNotBefore()+`
`,re+="  notAfter: "+this.getNotAfter()+`
`,re+="  subject: "+this.getSubjectString()+`
`,re+=`  subject public key info: 
`,pe=this.getPublicKey(),re+="    key algorithm: "+pe.type+`
`,pe.type==="RSA"&&(re+="    n="+Hh(pe.n.toString(16)).substr(0,16)+`...
`,re+="    e="+Hh(pe.e.toString(16))+`
`),be=this.aExtInfo,be!=null){re+=`X509v3 Extensions:
`;for(var Fe=0;Fe<be.length;Fe++){var ve=be[Fe],Ce=y.asn1.x509.OID.oid2name(ve.oid);Ce===""&&(Ce=ve.oid);var Ne="";if(ve.critical===!0&&(Ne="CRITICAL"),re+="  "+Ce+" "+Ne+`:
`,Ce==="basicConstraints"){var Me=this.getExtBasicConstraints();Me.cA===void 0?re+=`    {}
`:(re+="    cA=true",Me.pathLen!==void 0&&(re+=", pathLen="+Me.pathLen),re+=`
`)}else if(Ce=="policyMappings"){var rr=this.getExtPolicyMappings().array,pn=rr.map(function(pr){var jt=pr;return jt[0]+":"+jt[1]}).join(", ");re+="    "+pn+`
`}else if(Ce=="policyConstraints"){var tn=this.getExtPolicyConstraints();re+="    ",tn.reqexp!=null&&(re+=" reqexp="+tn.reqexp),tn.inhibit!=null&&(re+=" inhibit="+tn.inhibit),re+=`
`}else if(Ce=="inhibitAnyPolicy"){var tn=this.getExtInhibitAnyPolicy();re+="    skip="+tn.skip+`
`}else if(Ce=="keyUsage")re+="    "+this.getExtKeyUsageString()+`
`;else if(Ce=="subjectKeyIdentifier")re+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(Ce=="authorityKeyIdentifier"){var Rn=this.getExtAuthorityKeyIdentifier();Rn.kid!==void 0&&(re+="    kid="+Rn.kid.hex+`
`)}else if(Ce=="extKeyUsage"){var Un=this.getExtExtKeyUsage().array;re+="    "+Un.join(", ")+`
`}else if(Ce=="subjectAltName"){var Jn=G(this.getExtSubjectAltName());re+=Jn+`
`}else if(Ce=="cRLDistributionPoints"){var Hn=this.getExtCRLDistributionPoints();re+=te(Hn)}else if(Ce=="authorityInfoAccess"){var ic=this.getExtAuthorityInfoAccess();re+=J(ic)}else Ce=="certificatePolicies"&&(re+=Q(this.getExtCertificatePolicies()))}}return re+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,re+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,re},typeof s=="string"&&(s.indexOf("-----BEGIN")!=-1?this.readCertPEM(s):y.lang.String.isHex(s)&&this.readCertHex(s))}lt.EXT_PARSER={},lt.registExtParser=function(s,c){lt.EXT_PARSER[s]=c},lt.hex2dn=function(s,c){c===void 0&&(c=0);var l=new lt;je.getTLV(s,c);var d=l.getX500Name(s);return d.str},lt.hex2rdn=function(s,c){if(c===void 0&&(c=0),s.substr(c,2)!=="31")throw new Error("malformed RDN");for(var l=new Array,d=je.getChildIdx(s,c),g=0;g<d.length;g++)l.push(lt.hex2attrTypeValue(s,d[g]));return l=l.map(function(m){return m.replace("+","\\+")}),l.join("+")},lt.hex2attrTypeValue=function(s,c){var l=je,d=l.getV;if(c===void 0&&(c=0),s.substr(c,2)!=="30")throw new Error("malformed attribute type and value");var g=l.getChildIdx(s,c);g.length!==2||s.substr(g[0],2);var m=d(s,g[0]),T=y.asn1.ASN1Util.oidHexToInt(m),k=y.asn1.x509.OID.oid2atype(T),O=d(s,g[1]),F=Tr(O);return k+"="+F},lt.getPublicKeyFromCertHex=function(s){var c=new lt;return c.readCertHex(s),c.getPublicKey()},lt.getPublicKeyFromCertPEM=function(s){var c=new lt;return c.readCertPEM(s),c.getPublicKey()},lt.getPublicKeyInfoPropOfCertPEM=function(s){var c=je,l=c.getVbyList,d={},g,m;return d.algparam=null,g=new lt,g.readCertPEM(s),m=g.getPublicKeyHex(),d.keyhex=l(m,0,[1],"03").substr(2),d.algoid=l(m,0,[0,0],"06"),d.algoid==="2a8648ce3d0201"&&(d.algparam=l(m,0,[0,1],"06")),d},lt.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var P2=function(s){var c=y,l=c.lang.String.isHex,d=je,g=d.getV,m=d.getTLV,T=d.getVbyList,k=d.getTLVbyList,O=d.getTLVbyListEx,F=d.getIdxbyList,U=d.getIdxbyListEx,L=d.getChildIdx,P=new lt;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var D=F(this.hex,0,[0,0]),A=this.hex.substr(D,2);if(A=="02")this.posSigAlg=1;else if(A=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+A);var N=F(this.hex,0,[0,this.posSigAlg+3]),j=this.hex.substr(N,2);if(j=="17"||j=="18"){var W,se;W=F(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,W!=-1&&(se=this.hex.substr(W,2),se=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(j=="30")this.posRevCert=this.posSigAlg+3;else if(j=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+j)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(T(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var D=k(this.hex,0,[0,this.posSigAlg],"30");return P.getAlgorithmIdentifierName(D)},this.getIssuer=function(){return P.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return k(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var D=T(this.hex,0,[0,this.posSigAlg+2]);return result=Tr(D)},this.getNextUpdate=function(){var D=F(this.hex,0,[0,this.posSigAlg+3]),A=this.hex.substr(D,2);return A!="17"&&A!="18"?null:Tr(g(this.hex,D))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var D=[],A=F(this.hex,0,[0,this.posRevCert]),N=L(this.hex,A),j=0;j<N.length;j++){var W=m(this.hex,N[j]);D.push(this.getRevCert(W))}return D},this.getRevCert=function(D){var A={},N=L(D,0);return A.sn={hex:T(D,0,[0],"02")},A.date=Tr(T(D,0,[1])),N.length==3&&(A.ext=P.getExtParamArray(k(D,0,[2]))),A},this.findRevCert=function(D){var A=new lt(D),N=A.getSerialNumberHex();return this.findRevCertBySN(N)},this.findRevCertBySN=function(D){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var A=this.parsed.revcert,N=0;N<A.length;N++)if(D==A[N].sn.hex)return A[N];return null},this.getSignatureValueHex=function(){return T(this.hex,0,[2],"03",!0)},this.verifySignature=function(D){var A=this.getSignatureAlgorithmField(),N=this.getSignatureValueHex(),j=k(this.hex,0,[0],"30"),W=new y.crypto.Signature({alg:A});return W.init(D),W.updateHex(j),W.verify(N)},this.getParam=function(D){var A={},N=this.getVersion();N!=null&&(A.version=N),A.sigalg=this.getSignatureAlgorithmField(),A.issuer=this.getIssuer(),A.thisupdate=this.getThisUpdate();var j=this.getNextUpdate();j!=null&&(A.nextupdate=j);var W=this.getRevCertArray();W!=null&&(A.revcert=W);var se=U(this.hex,0,[0,"[0]"]);if(se!=-1){var he=O(this.hex,0,[0,"[0]",0]);A.ext=P.getExtParamArray(he)}return A.sighex=this.getSignatureValueHex(),this.parsed=A,typeof D=="object"&&(D.tbshex==!0&&(A.tbshex=k(this.hex,0,[0])),D.nodnarray==!0&&delete A.issuer.array),A},typeof s=="string"&&(l(s)?this.hex=s:s.match(/-----BEGIN X509 CRL/)&&(this.hex=bn(s)),this._setPos())};(typeof y>"u"||!y)&&(y={}),(typeof y.jws>"u"||!y.jws)&&(y.jws={}),y.jws.JWS=function(){var s=y,c=s.jws.JWS,l=c.isSafeJSONString;this.parseJWS=function(d,g){if(!(this.parsedJWS!==void 0&&(g||this.parsedJWS.sigvalH!==void 0))){var m=d.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(m==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var T=m[1],k=m[2],O=m[3],F=T+"."+k;if(this.parsedJWS={},this.parsedJWS.headB64U=T,this.parsedJWS.payloadB64U=k,this.parsedJWS.sigvalB64U=O,this.parsedJWS.si=F,!g){var U=sn(O),L=Se(U,16);this.parsedJWS.sigvalH=U,this.parsedJWS.sigvalBI=L}var P=pi(T),D=pi(k);if(this.parsedJWS.headS=P,this.parsedJWS.payloadS=D,!l(P,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+P}}},y.jws.JWS.sign=function(s,c,l,d,g){var m=y,T=m.jws,k=T.JWS,O=k.readSafeJSONString,F=k.isSafeJSONString,U=m.crypto;U.ECDSA;var L=U.Mac,P=U.Signature,D=JSON,A,N,j;if(typeof c!="string"&&typeof c!="object")throw"spHeader must be JSON string or object: "+c;if(typeof c=="object"&&(N=c,A=D.stringify(N)),typeof c=="string"){if(A=c,!F(A))throw"JWS Head is not safe JSON string: "+A;N=O(A)}if(j=l,typeof l=="object"&&(j=D.stringify(l)),(s==""||s==null)&&N.alg!==void 0&&(s=N.alg),s!=""&&s!=null&&N.alg===void 0&&(N.alg=s,A=D.stringify(N)),s!==N.alg)throw"alg and sHeader.alg doesn't match: "+s+"!="+N.alg;var W=null;if(k.jwsalg2sigalg[s]===void 0)throw"unsupported alg name: "+s;W=k.jwsalg2sigalg[s];var se=nc(A),he=nc(j),de=se+"."+he,fe="";if(W.substr(0,4)=="Hmac"){if(d===void 0)throw"mac key shall be specified for HS* alg";var G=new L({alg:W,prov:"cryptojs",pass:d});G.updateString(de),fe=G.doFinal()}else if(W.indexOf("withECDSA")!=-1){var Q=new P({alg:W});Q.init(d,g),Q.updateString(de);var te=Q.sign();fe=y.crypto.ECDSA.asn1SigToConcatSig(te)}else if(W!="none"){var Q=new P({alg:W});Q.init(d,g),Q.updateString(de),fe=Q.sign()}var J=On(fe);return de+"."+J},y.jws.JWS.verify=function(s,c,l){var d=y,g=d.jws,m=g.JWS,T=m.readSafeJSONString,k=d.crypto,O=k.ECDSA,F=k.Mac,U=k.Signature,L;if(typeof xe!==void 0&&(L=xe),!Uh(s))return!1;var P=s.split(".");if(P.length!==3)return!1;var D=P[0],A=P[1],N=D+"."+A,j=sn(P[2]),W=T(pi(P[0])),se=null,he=null;if(W.alg===void 0)throw"algorithm not specified in header";if(se=W.alg,he=se.substr(0,2),l!=null&&Object.prototype.toString.call(l)==="[object Array]"&&l.length>0){var de=":"+l.join(":")+":";if(de.indexOf(":"+se+":")==-1)throw"algorithm '"+se+"' not accepted in the list"}if(se!="none"&&c===null)throw"key shall be specified to verify.";if(typeof c=="string"&&c.indexOf("-----BEGIN ")!=-1&&(c=Nt.getKey(c)),(he=="RS"||he=="PS")&&!(c instanceof L))throw"key shall be a RSAKey obj for RS* and PS* algs";if(he=="ES"&&!(c instanceof O))throw"key shall be a ECDSA obj for ES* algs";var fe=null;if(m.jwsalg2sigalg[W.alg]===void 0)throw"unsupported alg name: "+se;if(fe=m.jwsalg2sigalg[se],fe=="none")throw"not supported";if(fe.substr(0,4)=="Hmac"){var G=null;if(c===void 0)throw"hexadecimal key shall be specified for HMAC";var Q=new F({alg:fe,pass:c});return Q.updateString(N),G=Q.doFinal(),j==G}else if(fe.indexOf("withECDSA")!=-1){var te=null;try{te=O.concatSigToASN1Sig(j)}catch{return!1}var J=new U({alg:fe});return J.init(c),J.updateString(N),J.verify(te)}else{var J=new U({alg:fe});return J.init(c),J.updateString(N),J.verify(j)}},y.jws.JWS.parse=function(s){var c=s.split("."),l={},d,g,m;if(c.length!=2&&c.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return d=c[0],g=c[1],c.length==3&&(m=c[2]),l.headerObj=y.jws.JWS.readSafeJSONString(pi(d)),l.payloadObj=y.jws.JWS.readSafeJSONString(pi(g)),l.headerPP=JSON.stringify(l.headerObj,null,"  "),l.payloadObj==null?l.payloadPP=pi(g):l.payloadPP=JSON.stringify(l.payloadObj,null,"  "),m!==void 0&&(l.sigHex=sn(m)),l},y.jws.JWS.verifyJWT=function(s,c,l){var d=y,g=d.jws,m=g.JWS,T=m.readSafeJSONString,k=m.inArray,O=m.includedArray;if(!Uh(s))return!1;var F=s.split(".");if(F.length!=3)return!1;var U=F[0],L=F[1];sn(F[2]);var P=T(pi(U)),D=T(pi(L));if(P.alg===void 0)return!1;if(l.alg===void 0)throw"acceptField.alg shall be specified";if(!k(P.alg,l.alg)||D.iss!==void 0&&typeof l.iss=="object"&&!k(D.iss,l.iss)||D.sub!==void 0&&typeof l.sub=="object"&&!k(D.sub,l.sub))return!1;if(D.aud!==void 0&&typeof l.aud=="object"){if(typeof D.aud=="string"){if(!k(D.aud,l.aud))return!1}else if(typeof D.aud=="object"&&!O(D.aud,l.aud))return!1}var A=g.IntDate.getNow();return l.verifyAt!==void 0&&typeof l.verifyAt=="number"&&(A=l.verifyAt),(l.gracePeriod===void 0||typeof l.gracePeriod!="number")&&(l.gracePeriod=0),!(D.exp!==void 0&&typeof D.exp=="number"&&D.exp+l.gracePeriod<A||D.nbf!==void 0&&typeof D.nbf=="number"&&A<D.nbf-l.gracePeriod||D.iat!==void 0&&typeof D.iat=="number"&&A<D.iat-l.gracePeriod||D.jti!==void 0&&l.jti!==void 0&&D.jti!==l.jti||!m.verify(s,c,l.alg))},y.jws.JWS.includedArray=function(s,c){var l=y.jws.JWS.inArray;if(s===null||typeof s!="object"||typeof s.length!="number")return!1;for(var d=0;d<s.length;d++)if(!l(s[d],c))return!1;return!0},y.jws.JWS.inArray=function(s,c){if(c===null||typeof c!="object"||typeof c.length!="number")return!1;for(var l=0;l<c.length;l++)if(c[l]==s)return!0;return!1},y.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},y.jws.JWS.isSafeJSONString=function(s,c,l){var d=null;try{return d=ag(s),typeof d!="object"||d.constructor===Array?0:(c&&(c[l]=d),1)}catch{return 0}},y.jws.JWS.readSafeJSONString=function(s){var c=null;try{return c=ag(s),typeof c!="object"||c.constructor===Array?null:c}catch{return null}},y.jws.JWS.getEncodedSignatureValueFromJWS=function(s){var c=s.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(c==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return c[1]},y.jws.JWS.getJWKthumbprint=function(s){if(s.kty!=="RSA"&&s.kty!=="EC"&&s.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var c="{";if(s.kty==="RSA"){if(typeof s.n!="string"||typeof s.e!="string")throw"wrong n and e value for RSA key";c+='"e":"'+s.e+'",',c+='"kty":"'+s.kty+'",',c+='"n":"'+s.n+'"}'}else if(s.kty==="EC"){if(typeof s.crv!="string"||typeof s.x!="string"||typeof s.y!="string")throw"wrong crv, x and y value for EC key";c+='"crv":"'+s.crv+'",',c+='"kty":"'+s.kty+'",',c+='"x":"'+s.x+'",',c+='"y":"'+s.y+'"}'}else if(s.kty==="oct"){if(typeof s.k!="string")throw"wrong k value for oct(symmetric) key";c+='"kty":"'+s.kty+'",',c+='"k":"'+s.k+'"}'}var l=Bi(c),d=y.crypto.Util.hashHex(l,"sha256"),g=On(d);return g},y.jws.IntDate={},y.jws.IntDate.get=function(s){var c=y.jws.IntDate,l=c.getNow,d=c.getZulu;if(s=="now")return l();if(s=="now + 1hour")return l()+60*60;if(s=="now + 1day")return l()+60*60*24;if(s=="now + 1month")return l()+60*60*24*30;if(s=="now + 1year")return l()+60*60*24*365;if(s.match(/Z$/))return d(s);if(s.match(/^[0-9]+$/))return parseInt(s);throw"unsupported format: "+s},y.jws.IntDate.getZulu=function(s){return ug(s)},y.jws.IntDate.getNow=function(){var s=~~(new Date/1e3);return s},y.jws.IntDate.intDate2UTCString=function(s){var c=new Date(s*1e3);return c.toUTCString()},y.jws.IntDate.intDate2Zulu=function(s){var c=new Date(s*1e3),l=("0000"+c.getUTCFullYear()).slice(-4),d=("00"+(c.getUTCMonth()+1)).slice(-2),g=("00"+c.getUTCDate()).slice(-2),m=("00"+c.getUTCHours()).slice(-2),T=("00"+c.getUTCMinutes()).slice(-2),k=("00"+c.getUTCSeconds()).slice(-2);return l+d+g+m+T+k+"Z"},(typeof y>"u"||!y)&&(y={}),(typeof y.jws>"u"||!y.jws)&&(y.jws={}),y.jws.JWSJS=function(){var s=y,c=s.jws,l=c.JWS,d=l.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(g){this.init();var m=g.split(".");if(m.length!=3)throw"malformed input JWS";this.aHeader.push(m[0]),this.sPayload=m[1],this.aSignature.push(m[2])},this.addSignature=function(g,m,T,k){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var O=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var F=y.jws.JWS.sign(g,m,this.sPayload,T,k),U=F.split("."),L=U[0],P=U[2];this.aHeader.push(U[0]),this.aSignature.push(U[2])}catch(D){throw this.aHeader.length>O&&this.aHeader.pop(),this.aSignature.length>O&&this.aSignature.pop(),"addSignature failed: "+D}},this.verifyAll=function(g){if(this.aHeader.length!==g.length||this.aSignature.length!==g.length)return!1;for(var m=0;m<g.length;m++){var T=g[m];if(T.length!==2)return!1;var k=this.verifyNth(m,T[0],T[1]);if(k===!1)return!1}return!0},this.verifyNth=function(g,m,T){if(this.aHeader.length<=g||this.aSignature.length<=g)return!1;var k=this.aHeader[g],O=this.aSignature[g],F=k+"."+this.sPayload+"."+O,U=!1;try{U=l.verify(F,m,T)}catch{return!1}return U},this.readJWSJS=function(g){if(typeof g=="string"){var m=d(g);if(m==null)throw"argument is not safe JSON object string";this.aHeader=m.headers,this.sPayload=m.payload,this.aSignature=m.signatures}else try{if(g.headers.length>0)this.aHeader=g.headers;else throw"malformed header";if(typeof g.payload=="string")this.sPayload=g.payload;else throw"malformed signatures";if(g.signatures.length>0)this.aSignature=g.signatures;else throw"malformed signatures"}catch(T){throw"malformed JWS-JS JSON object: "+T}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}},e.SecureRandom=ae,e.rng_seed_time=Ga,e.BigInteger=_,e.RSAKey=xe,e.ECDSA=y.crypto.ECDSA,e.DSA=y.crypto.DSA,e.Signature=y.crypto.Signature,e.MessageDigest=y.crypto.MessageDigest,e.Mac=y.crypto.Mac,e.KEYUTIL=Nt,e.ASN1HEX=je,e.X509=lt,e.X509CRL=P2,e.CryptoJS=a,e.b64tohex=h,e.b64toBA=v,e.ECFieldElementFp=st,e.ECPointFp=ct,e.ECCurveFp=rs,e.stoBA=og,e.BAtos=cg,e.BAtohex=Ul,e.stohex=kr,e.stob64=a2,e.stob64u=o2,e.b64utos=c2,e.b64tob64u=Za,e.b64utob64=tc,e.hex2b64=p,e.hextob64u=On,e.b64utohex=sn,e.utf8tob64u=nc,e.b64utoutf8=pi,e.utf8tob64=l2,e.b64toutf8=u2,e.utf8tohex=Hl,e.hextoutf8=Jt,e.hextorstr=Tr,e.rstrtohex=Bi,e.hextob64=Nh,e.hextob64nl=p2,e.b64nltohex=lg,e.hextopem=nr,e.pemtohex=bn,e.hextoArrayBuffer=g2,e.ArrayBuffertohex=v2,e.zulutomsec=Oh,e.msectozulu=y2,e.zulutosec=ug,e.zulutodate=_2,e.datetozulu=b2,e.uricmptohex=ql,e.hextouricmp=zl,e.ipv6tohex=Mh,e.hextoipv6=Lh,e.hextoip=Kl,e.iptohex=jh,e.ucs2hextoutf8=Bh,e.encodeURIComponentAll=$l,e.newline_toUnix=S2,e.newline_toDos=w2,e.hextoposhex=Hh,e.intarystrtohex=x2,e.strdiffidx=C2,e.oidtohex=mg,e.hextooid=Wl,e.strpad=Gl,e.bitstrtoint=vg,e.inttobitstr=yg,e.bitstrtobinstr=_g,e.binstrtobitstr=E2,e.isBase64URLDot=Uh,e.namearraytobinstr=Jl,e.extendClass=Ie,e.foldnl=Vl,e.b64topem=f2,e.pemtob64=m2,e.timeogen=dg,e.aryval=Yt,e.inttohex=gg,e.twoscompl=rc,e.KJUR=y,e.crypto=y.crypto,e.asn1=y.asn1,e.jws=y.jws,e.lang=y.lang,e.VERSION=r,e.VERSION_FULL=i}}),qm=Ee({"../../node_modules/.pnpm/isomorphic-ws@4.0.1_ws@8.18.2/node_modules/isomorphic-ws/browser.js"(e,t){Y();var n=null;typeof WebSocket<"u"?n=WebSocket:typeof MozWebSocket<"u"?n=MozWebSocket:typeof global<"u"?n=global.WebSocket||global.MozWebSocket:typeof window<"u"?n=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(n=self.WebSocket||self.MozWebSocket),t.exports=n}}),jy=Ee({"../../node_modules/.pnpm/deepmerge@4.3.1/node_modules/deepmerge/dist/cjs.js"(e,t){Y();var n=function(M){return r(M)&&!i(M)};function r(E){return!!E&&typeof E=="object"}function i(E){var M=Object.prototype.toString.call(E);return M==="[object RegExp]"||M==="[object Date]"||u(E)}var a=typeof Symbol=="function"&&Symbol.for,o=a?Symbol.for("react.element"):60103;function u(E){return E.$$typeof===o}function p(E){return Array.isArray(E)?[]:{}}function h(E,M){return M.clone!==!1&&M.isMergeableObject(E)?b(p(E),E,M):E}function v(E,M,Z){return E.concat(M).map(function($){return h($,Z)})}function f(E,M){if(!M.customMerge)return b;var Z=M.customMerge(E);return typeof Z=="function"?Z:b}function _(E){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(E).filter(function(M){return Object.propertyIsEnumerable.call(E,M)}):[]}function w(E){return Object.keys(E).concat(_(E))}function C(E,M){try{return M in E}catch{return!1}}function R(E,M){return C(E,M)&&!(Object.hasOwnProperty.call(E,M)&&Object.propertyIsEnumerable.call(E,M))}function S(E,M,Z){var $={};return Z.isMergeableObject(E)&&w(E).forEach(function(z){$[z]=h(E[z],Z)}),w(M).forEach(function(z){R(E,z)||(C(E,z)&&Z.isMergeableObject(M[z])?$[z]=f(z,Z)(E[z],M[z],Z):$[z]=h(M[z],Z))}),$}function b(E,M,Z){Z=Z||{},Z.arrayMerge=Z.arrayMerge||v,Z.isMergeableObject=Z.isMergeableObject||n,Z.cloneUnlessOtherwiseSpecified=h;var $=Array.isArray(M),z=Array.isArray(E),q=$===z;return q?$?Z.arrayMerge(E,M,Z):S(E,M,Z):h(M,Z)}b.all=function(M,Z){if(!Array.isArray(M))throw new Error("first argument should be an array");return M.reduce(function($,z){return b($,z,Z)},{})};var x=b;t.exports=x}}),Xw=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheClear.js"(e,t){Y();function n(){this.__data__=[],this.size=0}t.exports=n}}),By=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/eq.js"(e,t){Y();function n(r,i){return r===i||r!==r&&i!==i}t.exports=n}}),$d=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_assocIndexOf.js"(e,t){Y();var n=By();function r(i,a){for(var o=i.length;o--;)if(n(i[o][0],a))return o;return-1}t.exports=r}}),Yw=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheDelete.js"(e,t){Y();var n=$d(),r=Array.prototype,i=r.splice;function a(o){var u=this.__data__,p=n(u,o);if(p<0)return!1;var h=u.length-1;return p==h?u.pop():i.call(u,p,1),--this.size,!0}t.exports=a}}),e4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheGet.js"(e,t){Y();var n=$d();function r(i){var a=this.__data__,o=n(a,i);return o<0?void 0:a[o][1]}t.exports=r}}),t4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheHas.js"(e,t){Y();var n=$d();function r(i){return n(this.__data__,i)>-1}t.exports=r}}),n4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheSet.js"(e,t){Y();var n=$d();function r(i,a){var o=this.__data__,u=n(o,i);return u<0?(++this.size,o.push([i,a])):o[u][1]=a,this}t.exports=r}}),Wd=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_ListCache.js"(e,t){Y();var n=Xw(),r=Yw(),i=e4(),a=t4(),o=n4();function u(p){var h=-1,v=p==null?0:p.length;for(this.clear();++h<v;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),r4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackClear.js"(e,t){Y();var n=Wd();function r(){this.__data__=new n,this.size=0}t.exports=r}}),i4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackDelete.js"(e,t){Y();function n(r){var i=this.__data__,a=i.delete(r);return this.size=i.size,a}t.exports=n}}),s4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackGet.js"(e,t){Y();function n(r){return this.__data__.get(r)}t.exports=n}}),a4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackHas.js"(e,t){Y();function n(r){return this.__data__.has(r)}t.exports=n}}),Uy=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_freeGlobal.js"(e,t){Y();var n=typeof global=="object"&&global&&global.Object===Object&&global;t.exports=n}}),ws=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_root.js"(e,t){Y();var n=Uy(),r=typeof self=="object"&&self&&self.Object===Object&&self,i=n||r||Function("return this")();t.exports=i}}),zm=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Symbol.js"(e,t){Y();var n=ws(),r=n.Symbol;t.exports=r}}),o4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getRawTag.js"(e,t){Y();var n=zm(),r=Object.prototype,i=r.hasOwnProperty,a=r.toString,o=n?n.toStringTag:void 0;function u(p){var h=i.call(p,o),v=p[o];try{p[o]=void 0;var f=!0}catch{}var _=a.call(p);return f&&(h?p[o]=v:delete p[o]),_}t.exports=u}}),c4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_objectToString.js"(e,t){Y();var n=Object.prototype,r=n.toString;function i(a){return r.call(a)}t.exports=i}}),Gd=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseGetTag.js"(e,t){Y();var n=zm(),r=o4(),i=c4(),a="[object Null]",o="[object Undefined]",u=n?n.toStringTag:void 0;function p(h){return h==null?h===void 0?o:a:u&&u in Object(h)?r(h):i(h)}t.exports=p}}),Hy=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObject.js"(e,t){Y();function n(r){var i=typeof r;return r!=null&&(i=="object"||i=="function")}t.exports=n}}),Vy=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isFunction.js"(e,t){Y();var n=Gd(),r=Hy(),i="[object AsyncFunction]",a="[object Function]",o="[object GeneratorFunction]",u="[object Proxy]";function p(h){if(!r(h))return!1;var v=n(h);return v==a||v==o||v==i||v==u}t.exports=p}}),l4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_coreJsData.js"(e,t){Y();var n=ws(),r=n["__core-js_shared__"];t.exports=r}}),u4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isMasked.js"(e,t){Y();var n=l4(),r=function(){var a=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}();function i(a){return!!r&&r in a}t.exports=i}}),qy=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_toSource.js"(e,t){Y();var n=Function.prototype,r=n.toString;function i(a){if(a!=null){try{return r.call(a)}catch{}try{return a+""}catch{}}return""}t.exports=i}}),d4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsNative.js"(e,t){Y();var n=Vy(),r=u4(),i=Hy(),a=qy(),o=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,p=Function.prototype,h=Object.prototype,v=p.toString,f=h.hasOwnProperty,_=RegExp("^"+v.call(f).replace(o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function w(C){if(!i(C)||r(C))return!1;var R=n(C)?_:u;return R.test(a(C))}t.exports=w}}),h4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getValue.js"(e,t){Y();function n(r,i){return r==null?void 0:r[i]}t.exports=n}}),Ho=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getNative.js"(e,t){Y();var n=d4(),r=h4();function i(a,o){var u=r(a,o);return n(u)?u:void 0}t.exports=i}}),Km=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Map.js"(e,t){Y();var n=Ho(),r=ws(),i=n(r,"Map");t.exports=i}}),Jd=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nativeCreate.js"(e,t){Y();var n=Ho(),r=n(Object,"create");t.exports=r}}),p4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashClear.js"(e,t){Y();var n=Jd();function r(){this.__data__=n?n(null):{},this.size=0}t.exports=r}}),f4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashDelete.js"(e,t){Y();function n(r){var i=this.has(r)&&delete this.__data__[r];return this.size-=i?1:0,i}t.exports=n}}),m4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashGet.js"(e,t){Y();var n=Jd(),r="__lodash_hash_undefined__",i=Object.prototype,a=i.hasOwnProperty;function o(u){var p=this.__data__;if(n){var h=p[u];return h===r?void 0:h}return a.call(p,u)?p[u]:void 0}t.exports=o}}),g4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashHas.js"(e,t){Y();var n=Jd(),r=Object.prototype,i=r.hasOwnProperty;function a(o){var u=this.__data__;return n?u[o]!==void 0:i.call(u,o)}t.exports=a}}),v4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashSet.js"(e,t){Y();var n=Jd(),r="__lodash_hash_undefined__";function i(a,o){var u=this.__data__;return this.size+=this.has(a)?0:1,u[a]=n&&o===void 0?r:o,this}t.exports=i}}),y4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Hash.js"(e,t){Y();var n=p4(),r=f4(),i=m4(),a=g4(),o=v4();function u(p){var h=-1,v=p==null?0:p.length;for(this.clear();++h<v;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),_4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheClear.js"(e,t){Y();var n=y4(),r=Wd(),i=Km();function a(){this.size=0,this.__data__={hash:new n,map:new(i||r),string:new n}}t.exports=a}}),b4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isKeyable.js"(e,t){Y();function n(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}t.exports=n}}),Zd=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getMapData.js"(e,t){Y();var n=b4();function r(i,a){var o=i.__data__;return n(a)?o[typeof a=="string"?"string":"hash"]:o.map}t.exports=r}}),S4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheDelete.js"(e,t){Y();var n=Zd();function r(i){var a=n(this,i).delete(i);return this.size-=a?1:0,a}t.exports=r}}),w4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheGet.js"(e,t){Y();var n=Zd();function r(i){return n(this,i).get(i)}t.exports=r}}),x4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheHas.js"(e,t){Y();var n=Zd();function r(i){return n(this,i).has(i)}t.exports=r}}),C4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheSet.js"(e,t){Y();var n=Zd();function r(i,a){var o=n(this,i),u=o.size;return o.set(i,a),this.size+=o.size==u?0:1,this}t.exports=r}}),zy=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_MapCache.js"(e,t){Y();var n=_4(),r=S4(),i=w4(),a=x4(),o=C4();function u(p){var h=-1,v=p==null?0:p.length;for(this.clear();++h<v;){var f=p[h];this.set(f[0],f[1])}}u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=i,u.prototype.has=a,u.prototype.set=o,t.exports=u}}),E4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stackSet.js"(e,t){Y();var n=Wd(),r=Km(),i=zy(),a=200;function o(u,p){var h=this.__data__;if(h instanceof n){var v=h.__data__;if(!r||v.length<a-1)return v.push([u,p]),this.size=++h.size,this;h=this.__data__=new i(v)}return h.set(u,p),this.size=h.size,this}t.exports=o}}),P4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Stack.js"(e,t){Y();var n=Wd(),r=r4(),i=i4(),a=s4(),o=a4(),u=E4();function p(h){var v=this.__data__=new n(h);this.size=v.size}p.prototype.clear=r,p.prototype.delete=i,p.prototype.get=a,p.prototype.has=o,p.prototype.set=u,t.exports=p}}),k4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setCacheAdd.js"(e,t){Y();var n="__lodash_hash_undefined__";function r(i){return this.__data__.set(i,n),this}t.exports=r}}),T4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setCacheHas.js"(e,t){Y();function n(r){return this.__data__.has(r)}t.exports=n}}),R4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_SetCache.js"(e,t){Y();var n=zy(),r=k4(),i=T4();function a(o){var u=-1,p=o==null?0:o.length;for(this.__data__=new n;++u<p;)this.add(o[u])}a.prototype.add=a.prototype.push=r,a.prototype.has=i,t.exports=a}}),A4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arraySome.js"(e,t){Y();function n(r,i){for(var a=-1,o=r==null?0:r.length;++a<o;)if(i(r[a],a,r))return!0;return!1}t.exports=n}}),I4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_cacheHas.js"(e,t){Y();function n(r,i){return r.has(i)}t.exports=n}}),Ky=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalArrays.js"(e,t){Y();var n=R4(),r=A4(),i=I4(),a=1,o=2;function u(p,h,v,f,_,w){var C=v&a,R=p.length,S=h.length;if(R!=S&&!(C&&S>R))return!1;var b=w.get(p),x=w.get(h);if(b&&x)return b==h&&x==p;var E=-1,M=!0,Z=v&o?new n:void 0;for(w.set(p,h),w.set(h,p);++E<R;){var $=p[E],z=h[E];if(f)var q=C?f(z,$,E,h,p,w):f($,z,E,p,h,w);if(q!==void 0){if(q)continue;M=!1;break}if(Z){if(!r(h,function(X,K){if(!i(Z,K)&&($===X||_($,X,v,f,w)))return Z.push(K)})){M=!1;break}}else if(!($===z||_($,z,v,f,w))){M=!1;break}}return w.delete(p),w.delete(h),M}t.exports=u}}),F4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Uint8Array.js"(e,t){Y();var n=ws(),r=n.Uint8Array;t.exports=r}}),D4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapToArray.js"(e,t){Y();function n(r){var i=-1,a=Array(r.size);return r.forEach(function(o,u){a[++i]=[u,o]}),a}t.exports=n}}),N4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_setToArray.js"(e,t){Y();function n(r){var i=-1,a=Array(r.size);return r.forEach(function(o){a[++i]=o}),a}t.exports=n}}),O4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalByTag.js"(e,t){Y();var n=zm(),r=F4(),i=By(),a=Ky(),o=D4(),u=N4(),p=1,h=2,v="[object Boolean]",f="[object Date]",_="[object Error]",w="[object Map]",C="[object Number]",R="[object RegExp]",S="[object Set]",b="[object String]",x="[object Symbol]",E="[object ArrayBuffer]",M="[object DataView]",Z=n?n.prototype:void 0,$=Z?Z.valueOf:void 0;function z(q,X,K,ee,oe,ce,ne){switch(K){case M:if(q.byteLength!=X.byteLength||q.byteOffset!=X.byteOffset)return!1;q=q.buffer,X=X.buffer;case E:return!(q.byteLength!=X.byteLength||!ce(new r(q),new r(X)));case v:case f:case C:return i(+q,+X);case _:return q.name==X.name&&q.message==X.message;case R:case b:return q==X+"";case w:var Te=o;case S:var ye=ee&p;if(Te||(Te=u),q.size!=X.size&&!ye)return!1;var ue=ne.get(q);if(ue)return ue==X;ee|=h,ne.set(q,X);var me=a(Te(q),Te(X),ee,oe,ce,ne);return ne.delete(q),me;case x:if($)return $.call(q)==$.call(X)}return!1}t.exports=z}}),M4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayPush.js"(e,t){Y();function n(r,i){for(var a=-1,o=i.length,u=r.length;++a<o;)r[u+a]=i[a];return r}t.exports=n}}),$m=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArray.js"(e,t){Y();var n=Array.isArray;t.exports=n}}),L4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseGetAllKeys.js"(e,t){Y();var n=M4(),r=$m();function i(a,o,u){var p=o(a);return r(a)?p:n(p,u(a))}t.exports=i}}),j4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayFilter.js"(e,t){Y();function n(r,i){for(var a=-1,o=r==null?0:r.length,u=0,p=[];++a<o;){var h=r[a];i(h,a,r)&&(p[u++]=h)}return p}t.exports=n}}),B4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/stubArray.js"(e,t){Y();function n(){return[]}t.exports=n}}),U4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getSymbols.js"(e,t){Y();var n=j4(),r=B4(),i=Object.prototype,a=i.propertyIsEnumerable,o=Object.getOwnPropertySymbols,u=o?function(p){return p==null?[]:(p=Object(p),n(o(p),function(h){return a.call(p,h)}))}:r;t.exports=u}}),H4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseTimes.js"(e,t){Y();function n(r,i){for(var a=-1,o=Array(r);++a<r;)o[a]=i(a);return o}t.exports=n}}),Qd=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObjectLike.js"(e,t){Y();function n(r){return r!=null&&typeof r=="object"}t.exports=n}}),V4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsArguments.js"(e,t){Y();var n=Gd(),r=Qd(),i="[object Arguments]";function a(o){return r(o)&&n(o)==i}t.exports=a}}),q4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArguments.js"(e,t){Y();var n=V4(),r=Qd(),i=Object.prototype,a=i.hasOwnProperty,o=i.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(p){return r(p)&&a.call(p,"callee")&&!o.call(p,"callee")};t.exports=u}}),z4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/stubFalse.js"(e,t){Y();function n(){return!1}t.exports=n}}),$y=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isBuffer.js"(e,t){Y();var n=ws(),r=z4(),i=typeof e=="object"&&e&&!e.nodeType&&e,a=i&&typeof t=="object"&&t&&!t.nodeType&&t,o=a&&a.exports===i,u=o?n.Buffer:void 0,p=u?u.isBuffer:void 0,h=p||r;t.exports=h}}),K4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isIndex.js"(e,t){Y();var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;function i(a,o){var u=typeof a;return o=o??n,!!o&&(u=="number"||u!="symbol"&&r.test(a))&&a>-1&&a%1==0&&a<o}t.exports=i}}),Wy=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isLength.js"(e,t){Y();var n=9007199254740991;function r(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=n}t.exports=r}}),$4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsTypedArray.js"(e,t){Y();var n=Gd(),r=Wy(),i=Qd(),a="[object Arguments]",o="[object Array]",u="[object Boolean]",p="[object Date]",h="[object Error]",v="[object Function]",f="[object Map]",_="[object Number]",w="[object Object]",C="[object RegExp]",R="[object Set]",S="[object String]",b="[object WeakMap]",x="[object ArrayBuffer]",E="[object DataView]",M="[object Float32Array]",Z="[object Float64Array]",$="[object Int8Array]",z="[object Int16Array]",q="[object Int32Array]",X="[object Uint8Array]",K="[object Uint8ClampedArray]",ee="[object Uint16Array]",oe="[object Uint32Array]",ce={};ce[M]=ce[Z]=ce[$]=ce[z]=ce[q]=ce[X]=ce[K]=ce[ee]=ce[oe]=!0,ce[a]=ce[o]=ce[x]=ce[u]=ce[E]=ce[p]=ce[h]=ce[v]=ce[f]=ce[_]=ce[w]=ce[C]=ce[R]=ce[S]=ce[b]=!1;function ne(Te){return i(Te)&&r(Te.length)&&!!ce[n(Te)]}t.exports=ne}}),W4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseUnary.js"(e,t){Y();function n(r){return function(i){return r(i)}}t.exports=n}}),G4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nodeUtil.js"(e,t){Y();var n=Uy(),r=typeof e=="object"&&e&&!e.nodeType&&e,i=r&&typeof t=="object"&&t&&!t.nodeType&&t,a=i&&i.exports===r,o=a&&n.process,u=function(){try{var p=i&&i.require&&i.require("util").types;return p||o&&o.binding&&o.binding("util")}catch{}}();t.exports=u}}),Gy=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isTypedArray.js"(e,t){Y();var n=$4(),r=W4(),i=G4(),a=i&&i.isTypedArray,o=a?r(a):n;t.exports=o}}),J4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayLikeKeys.js"(e,t){Y();var n=H4(),r=q4(),i=$m(),a=$y(),o=K4(),u=Gy(),p=Object.prototype,h=p.hasOwnProperty;function v(f,_){var w=i(f),C=!w&&r(f),R=!w&&!C&&a(f),S=!w&&!C&&!R&&u(f),b=w||C||R||S,x=b?n(f.length,String):[],E=x.length;for(var M in f)(_||h.call(f,M))&&!(b&&(M=="length"||R&&(M=="offset"||M=="parent")||S&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||o(M,E)))&&x.push(M);return x}t.exports=v}}),Z4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isPrototype.js"(e,t){Y();var n=Object.prototype;function r(i){var a=i&&i.constructor,o=typeof a=="function"&&a.prototype||n;return i===o}t.exports=r}}),Q4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_overArg.js"(e,t){Y();function n(r,i){return function(a){return r(i(a))}}t.exports=n}}),X4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nativeKeys.js"(e,t){Y();var n=Q4(),r=n(Object.keys,Object);t.exports=r}}),Y4=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseKeys.js"(e,t){Y();var n=Z4(),r=X4(),i=Object.prototype,a=i.hasOwnProperty;function o(u){if(!n(u))return r(u);var p=[];for(var h in Object(u))a.call(u,h)&&h!="constructor"&&p.push(h);return p}t.exports=o}}),e3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArrayLike.js"(e,t){Y();var n=Vy(),r=Wy();function i(a){return a!=null&&r(a.length)&&!n(a)}t.exports=i}}),t3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/keys.js"(e,t){Y();var n=J4(),r=Y4(),i=e3();function a(o){return i(o)?n(o):r(o)}t.exports=a}}),n3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getAllKeys.js"(e,t){Y();var n=L4(),r=U4(),i=t3();function a(o){return n(o,i,r)}t.exports=a}}),r3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_equalObjects.js"(e,t){Y();var n=n3(),r=1,i=Object.prototype,a=i.hasOwnProperty;function o(u,p,h,v,f,_){var w=h&r,C=n(u),R=C.length,S=n(p),b=S.length;if(R!=b&&!w)return!1;for(var x=R;x--;){var E=C[x];if(!(w?E in p:a.call(p,E)))return!1}var M=_.get(u),Z=_.get(p);if(M&&Z)return M==p&&Z==u;var $=!0;_.set(u,p),_.set(p,u);for(var z=w;++x<R;){E=C[x];var q=u[E],X=p[E];if(v)var K=w?v(X,q,E,p,u,_):v(q,X,E,u,p,_);if(!(K===void 0?q===X||f(q,X,h,v,_):K)){$=!1;break}z||(z=E=="constructor")}if($&&!z){var ee=u.constructor,oe=p.constructor;ee!=oe&&"constructor"in u&&"constructor"in p&&!(typeof ee=="function"&&ee instanceof ee&&typeof oe=="function"&&oe instanceof oe)&&($=!1)}return _.delete(u),_.delete(p),$}t.exports=o}}),i3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_DataView.js"(e,t){Y();var n=Ho(),r=ws(),i=n(r,"DataView");t.exports=i}}),s3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Promise.js"(e,t){Y();var n=Ho(),r=ws(),i=n(r,"Promise");t.exports=i}}),a3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Set.js"(e,t){Y();var n=Ho(),r=ws(),i=n(r,"Set");t.exports=i}}),o3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_WeakMap.js"(e,t){Y();var n=Ho(),r=ws(),i=n(r,"WeakMap");t.exports=i}}),c3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getTag.js"(e,t){Y();var n=i3(),r=Km(),i=s3(),a=a3(),o=o3(),u=Gd(),p=qy(),h="[object Map]",v="[object Object]",f="[object Promise]",_="[object Set]",w="[object WeakMap]",C="[object DataView]",R=p(n),S=p(r),b=p(i),x=p(a),E=p(o),M=u;(n&&M(new n(new ArrayBuffer(1)))!=C||r&&M(new r)!=h||i&&M(i.resolve())!=f||a&&M(new a)!=_||o&&M(new o)!=w)&&(M=function(Z){var $=u(Z),z=$==v?Z.constructor:void 0,q=z?p(z):"";if(q)switch(q){case R:return C;case S:return h;case b:return f;case x:return _;case E:return w}return $}),t.exports=M}}),l3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsEqualDeep.js"(e,t){Y();var n=P4(),r=Ky(),i=O4(),a=r3(),o=c3(),u=$m(),p=$y(),h=Gy(),v=1,f="[object Arguments]",_="[object Array]",w="[object Object]",C=Object.prototype,R=C.hasOwnProperty;function S(b,x,E,M,Z,$){var z=u(b),q=u(x),X=z?_:o(b),K=q?_:o(x);X=X==f?w:X,K=K==f?w:K;var ee=X==w,oe=K==w,ce=X==K;if(ce&&p(b)){if(!p(x))return!1;z=!0,ee=!1}if(ce&&!ee)return $||($=new n),z||h(b)?r(b,x,E,M,Z,$):i(b,x,X,E,M,Z,$);if(!(E&v)){var ne=ee&&R.call(b,"__wrapped__"),Te=oe&&R.call(x,"__wrapped__");if(ne||Te){var ye=ne?b.value():b,ue=Te?x.value():x;return $||($=new n),Z(ye,ue,E,M,$)}}return ce?($||($=new n),a(b,x,E,M,Z,$)):!1}t.exports=S}}),u3=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsEqual.js"(e,t){Y();var n=l3(),r=Qd();function i(a,o,u,p,h){return a===o?!0:a==null||o==null||!r(a)&&!r(o)?a!==a&&o!==o:n(a,o,u,p,i,h)}t.exports=i}}),Jy=Ee({"../../node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isEqual.js"(e,t){Y();var n=u3();function r(i,a){return n(i,a)}t.exports=r}}),d3=Ee({"../../node_modules/.pnpm/ms@2.1.3/node_modules/ms/index.js"(e,t){Y();var n=1e3,r=n*60,i=r*60,a=i*24,o=a*7,u=a*365.25;t.exports=function(_,w){w=w||{};var C=typeof _;if(C==="string"&&_.length>0)return p(_);if(C==="number"&&isFinite(_))return w.long?v(_):h(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function p(_){if(_=String(_),!(_.length>100)){var w=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(w){var C=parseFloat(w[1]),R=(w[2]||"ms").toLowerCase();switch(R){case"years":case"year":case"yrs":case"yr":case"y":return C*u;case"weeks":case"week":case"w":return C*o;case"days":case"day":case"d":return C*a;case"hours":case"hour":case"hrs":case"hr":case"h":return C*i;case"minutes":case"minute":case"mins":case"min":case"m":return C*r;case"seconds":case"second":case"secs":case"sec":case"s":return C*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return C;default:return}}}}function h(_){var w=Math.abs(_);return w>=a?Math.round(_/a)+"d":w>=i?Math.round(_/i)+"h":w>=r?Math.round(_/r)+"m":w>=n?Math.round(_/n)+"s":_+"ms"}function v(_){var w=Math.abs(_);return w>=a?f(_,w,a,"day"):w>=i?f(_,w,i,"hour"):w>=r?f(_,w,r,"minute"):w>=n?f(_,w,n,"second"):_+" ms"}function f(_,w,C,R){var S=w>=C*1.5;return Math.round(_/C)+" "+R+(S?"s":"")}}}),h3=Ee({"../../node_modules/.pnpm/debug@4.4.1_supports-color@10.2.0/node_modules/debug/src/common.js"(e,t){Y();function n(r){a.debug=a,a.default=a,a.coerce=f,a.disable=h,a.enable=u,a.enabled=v,a.humanize=d3(),a.destroy=_,Object.keys(r).forEach(w=>{a[w]=r[w]}),a.names=[],a.skips=[],a.formatters={};function i(w){let C=0;for(let R=0;R<w.length;R++)C=(C<<5)-C+w.charCodeAt(R),C|=0;return a.colors[Math.abs(C)%a.colors.length]}a.selectColor=i;function a(w){let C,R=null,S,b;function x(...E){if(!x.enabled)return;const M=x,Z=Number(new Date),$=Z-(C||Z);M.diff=$,M.prev=C,M.curr=Z,C=Z,E[0]=a.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let z=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(X,K)=>{if(X==="%%")return"%";z++;const ee=a.formatters[K];if(typeof ee=="function"){const oe=E[z];X=ee.call(M,oe),E.splice(z,1),z--}return X}),a.formatArgs.call(M,E),(M.log||a.log).apply(M,E)}return x.namespace=w,x.useColors=a.useColors(),x.color=a.selectColor(w),x.extend=o,x.destroy=a.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>R!==null?R:(S!==a.namespaces&&(S=a.namespaces,b=a.enabled(w)),b),set:E=>{R=E}}),typeof a.init=="function"&&a.init(x),x}function o(w,C){const R=a(this.namespace+(typeof C>"u"?":":C)+w);return R.log=this.log,R}function u(w){a.save(w),a.namespaces=w,a.names=[],a.skips=[];const C=(typeof w=="string"?w:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const R of C)R[0]==="-"?a.skips.push(R.slice(1)):a.names.push(R)}function p(w,C){let R=0,S=0,b=-1,x=0;for(;R<w.length;)if(S<C.length&&(C[S]===w[R]||C[S]==="*"))C[S]==="*"?(b=S,x=R,S++):(R++,S++);else if(b!==-1)S=b+1,x++,R=x;else return!1;for(;S<C.length&&C[S]==="*";)S++;return S===C.length}function h(){const w=[...a.names,...a.skips.map(C=>"-"+C)].join(",");return a.enable(""),w}function v(w){for(const C of a.skips)if(p(w,C))return!1;for(const C of a.names)if(p(w,C))return!0;return!1}function f(w){return w instanceof Error?w.stack||w.message:w}function _(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}t.exports=n}}),Xd=Ee({"../../node_modules/.pnpm/debug@4.4.1_supports-color@10.2.0/node_modules/debug/src/browser.js"(e,t){Y(),e.formatArgs=r,e.save=i,e.load=a,e.useColors=n,e.storage=o(),e.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let p;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(p=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(p[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const h="color: "+this.color;p.splice(1,0,h,"color: inherit");let v=0,f=0;p[0].replace(/%[a-zA-Z%]/g,_=>{_!=="%%"&&(v++,_==="%c"&&(f=v))}),p.splice(f,0,h)}e.log=console.debug||console.log||(()=>{});function i(p){try{p?e.storage.setItem("debug",p):e.storage.removeItem("debug")}catch{}}function a(){let p;try{p=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!p&&typeof Co<"u"&&"env"in Co&&(p=Co.env.DEBUG),p}function o(){try{return localStorage}catch{}}t.exports=h3()(e);var{formatters:u}=t.exports;u.j=function(p){try{return JSON.stringify(p)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}}),p3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/types.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0})}}),Ur=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Logger.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var t=Xd(),n="mediasoup-client",r=class{constructor(i){ge(this,"_debug"),ge(this,"_warn"),ge(this,"_error"),i?(this._debug=(0,t.default)(`${n}:${i}`),this._warn=(0,t.default)(`${n}:WARN:${i}`),this._error=(0,t.default)(`${n}:ERROR:${i}`)):(this._debug=(0,t.default)(n),this._warn=(0,t.default)(`${n}:WARN`),this._error=(0,t.default)(`${n}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=r}}),f3=Ee({"../../node_modules/.pnpm/events@3.3.0/node_modules/events/events.js"(e,t){Y();var n=typeof Reflect=="object"?Reflect:null,r=n&&typeof n.apply=="function"?n.apply:function(z,q,X){return Function.prototype.apply.call(z,q,X)},i;n&&typeof n.ownKeys=="function"?i=n.ownKeys:Object.getOwnPropertySymbols?i=function(z){return Object.getOwnPropertyNames(z).concat(Object.getOwnPropertySymbols(z))}:i=function(z){return Object.getOwnPropertyNames(z)};function a($){console&&console.warn&&console.warn($)}var o=Number.isNaN||function(z){return z!==z};function u(){u.init.call(this)}t.exports=u,t.exports.once=E,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var p=10;function h($){if(typeof $!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof $)}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function($){if(typeof $!="number"||$<0||o($))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+$+".");p=$}}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(z){if(typeof z!="number"||z<0||o(z))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+z+".");return this._maxListeners=z,this};function v($){return $._maxListeners===void 0?u.defaultMaxListeners:$._maxListeners}u.prototype.getMaxListeners=function(){return v(this)},u.prototype.emit=function(z){for(var q=[],X=1;X<arguments.length;X++)q.push(arguments[X]);var K=z==="error",ee=this._events;if(ee!==void 0)K=K&&ee.error===void 0;else if(!K)return!1;if(K){var oe;if(q.length>0&&(oe=q[0]),oe instanceof Error)throw oe;var ce=new Error("Unhandled error."+(oe?" ("+oe.message+")":""));throw ce.context=oe,ce}var ne=ee[z];if(ne===void 0)return!1;if(typeof ne=="function")r(ne,this,q);else for(var Te=ne.length,ye=S(ne,Te),X=0;X<Te;++X)r(ye[X],this,q);return!0};function f($,z,q,X){var K,ee,oe;if(h(q),ee=$._events,ee===void 0?(ee=$._events=Object.create(null),$._eventsCount=0):(ee.newListener!==void 0&&($.emit("newListener",z,q.listener?q.listener:q),ee=$._events),oe=ee[z]),oe===void 0)oe=ee[z]=q,++$._eventsCount;else if(typeof oe=="function"?oe=ee[z]=X?[q,oe]:[oe,q]:X?oe.unshift(q):oe.push(q),K=v($),K>0&&oe.length>K&&!oe.warned){oe.warned=!0;var ce=new Error("Possible EventEmitter memory leak detected. "+oe.length+" "+String(z)+" listeners added. Use emitter.setMaxListeners() to increase limit");ce.name="MaxListenersExceededWarning",ce.emitter=$,ce.type=z,ce.count=oe.length,a(ce)}return $}u.prototype.addListener=function(z,q){return f(this,z,q,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(z,q){return f(this,z,q,!0)};function _(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w($,z,q){var X={fired:!1,wrapFn:void 0,target:$,type:z,listener:q},K=_.bind(X);return K.listener=q,X.wrapFn=K,K}u.prototype.once=function(z,q){return h(q),this.on(z,w(this,z,q)),this},u.prototype.prependOnceListener=function(z,q){return h(q),this.prependListener(z,w(this,z,q)),this},u.prototype.removeListener=function(z,q){var X,K,ee,oe,ce;if(h(q),K=this._events,K===void 0)return this;if(X=K[z],X===void 0)return this;if(X===q||X.listener===q)--this._eventsCount===0?this._events=Object.create(null):(delete K[z],K.removeListener&&this.emit("removeListener",z,X.listener||q));else if(typeof X!="function"){for(ee=-1,oe=X.length-1;oe>=0;oe--)if(X[oe]===q||X[oe].listener===q){ce=X[oe].listener,ee=oe;break}if(ee<0)return this;ee===0?X.shift():b(X,ee),X.length===1&&(K[z]=X[0]),K.removeListener!==void 0&&this.emit("removeListener",z,ce||q)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(z){var q,X,K;if(X=this._events,X===void 0)return this;if(X.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):X[z]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete X[z]),this;if(arguments.length===0){var ee=Object.keys(X),oe;for(K=0;K<ee.length;++K)oe=ee[K],oe!=="removeListener"&&this.removeAllListeners(oe);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(q=X[z],typeof q=="function")this.removeListener(z,q);else if(q!==void 0)for(K=q.length-1;K>=0;K--)this.removeListener(z,q[K]);return this};function C($,z,q){var X=$._events;if(X===void 0)return[];var K=X[z];return K===void 0?[]:typeof K=="function"?q?[K.listener||K]:[K]:q?x(K):S(K,K.length)}u.prototype.listeners=function(z){return C(this,z,!0)},u.prototype.rawListeners=function(z){return C(this,z,!1)},u.listenerCount=function($,z){return typeof $.listenerCount=="function"?$.listenerCount(z):R.call($,z)},u.prototype.listenerCount=R;function R($){var z=this._events;if(z!==void 0){var q=z[$];if(typeof q=="function")return 1;if(q!==void 0)return q.length}return 0}u.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function S($,z){for(var q=new Array(z),X=0;X<z;++X)q[X]=$[X];return q}function b($,z){for(;z+1<$.length;z++)$[z]=$[z+1];$.pop()}function x($){for(var z=new Array($.length),q=0;q<z.length;++q)z[q]=$[q].listener||$[q];return z}function E($,z){return new Promise(function(q,X){function K(oe){$.removeListener(z,ee),X(oe)}function ee(){typeof $.removeListener=="function"&&$.removeListener("error",K),q([].slice.call(arguments))}Z($,z,ee,{once:!0}),z!=="error"&&M($,K,{once:!0})})}function M($,z,q){typeof $.on=="function"&&Z($,"error",z,q)}function Z($,z,q,X){if(typeof $.on=="function")X.once?$.once(z,q):$.on(z,q);else if(typeof $.addEventListener=="function")$.addEventListener(z,function K(ee){X.once&&$.removeEventListener(z,K),q(ee)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof $)}}}),Jr=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/enhancedEvents.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.EnhancedEventEmitter=void 0;var t=f3(),n=Ur(),r=new n.Logger("EnhancedEventEmitter"),i=class extends t.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}close(){super.removeAllListeners()}emit(a,...o){return super.emit(a,...o)}safeEmit(a,...o){try{return super.emit(a,...o)}catch(u){r.error("safeEmit() | event listener threw an error [eventName:%s]:%o",a,u);try{super.emit("listenererror",a,u)}catch{}return!!super.listenerCount(a)}}on(a,o){return super.on(a,o),this}off(a,o){return super.off(a,o),this}addListener(a,o){return super.on(a,o),this}prependListener(a,o){return super.prependListener(a,o),this}once(a,o){return super.once(a,o),this}prependOnceListener(a,o){return super.prependOnceListener(a,o),this}removeListener(a,o){return super.off(a,o),this}removeAllListeners(a){return super.removeAllListeners(a),this}listenerCount(a){return super.listenerCount(a)}listeners(a){return super.listeners(a)}rawListeners(a){return super.rawListeners(a)}};e.EnhancedEventEmitter=i}}),Di=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/errors.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidStateError=e.UnsupportedError=void 0;var t=class Zy extends Error{constructor(i){super(i),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Zy):this.stack=new Error(i).stack}};e.UnsupportedError=t;var n=class Qy extends Error{constructor(i){super(i),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Qy):this.stack=new Error(i).stack}};e.InvalidStateError=n}}),Vo=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.clone=t,e.generateRandomNumber=n,e.deepFreeze=r;function t(i){if(i!==void 0)return Number.isNaN(i)?NaN:typeof structuredClone=="function"?structuredClone(i):JSON.parse(JSON.stringify(i))}function n(){return Math.round(Math.random()*1e7)}function r(i){const a=Reflect.ownKeys(i);for(const o of a){const u=i[o];(u&&typeof u=="object"||typeof u=="function")&&r(u)}return Object.freeze(i)}}}),m3=Ee({"../../node_modules/.pnpm/h264-profile-level-id@2.2.3_supports-color@10.2.0/node_modules/h264-profile-level-id/lib/Logger.js"(e){Y();var t=e&&e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var n=t(Xd()),r="h264-profile-level-id",i=class{constructor(a){a?(this._debug=(0,n.default)(`${r}:${a}`),this._warn=(0,n.default)(`${r}:WARN:${a}`),this._error=(0,n.default)(`${r}:ERROR:${a}`)):(this._debug=(0,n.default)(r),this._warn=(0,n.default)(`${r}:WARN`),this._error=(0,n.default)(`${r}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=i}}),g3=Ee({"../../node_modules/.pnpm/h264-profile-level-id@2.2.3_supports-color@10.2.0/node_modules/h264-profile-level-id/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.ProfileLevelId=e.Level=e.Profile=void 0,e.parseProfileLevelId=f,e.profileLevelIdToString=_,e.profileToString=w,e.levelToString=C,e.parseSdpProfileLevelId=R,e.isSameProfile=S,e.isSameProfileAndLevel=b,e.generateProfileLevelIdStringForAnswer=x,e.supportedLevel=E;var t=m3(),n=new t.Logger,r;(function(q){q[q.ConstrainedBaseline=1]="ConstrainedBaseline",q[q.Baseline=2]="Baseline",q[q.Main=3]="Main",q[q.ConstrainedHigh=4]="ConstrainedHigh",q[q.High=5]="High",q[q.PredictiveHigh444=6]="PredictiveHigh444"})(r||(e.Profile=r={}));var i;(function(q){q[q.L1_b=0]="L1_b",q[q.L1=10]="L1",q[q.L1_1=11]="L1_1",q[q.L1_2=12]="L1_2",q[q.L1_3=13]="L1_3",q[q.L2=20]="L2",q[q.L2_1=21]="L2_1",q[q.L2_2=22]="L2_2",q[q.L3=30]="L3",q[q.L3_1=31]="L3_1",q[q.L3_2=32]="L3_2",q[q.L4=40]="L4",q[q.L4_1=41]="L4_1",q[q.L4_2=42]="L4_2",q[q.L5=50]="L5",q[q.L5_1=51]="L5_1",q[q.L5_2=52]="L5_2"})(i||(e.Level=i={}));var a=class{constructor(q,X){this.profile=q,this.level=X}};e.ProfileLevelId=a;var o=new a(r.ConstrainedBaseline,i.L3_1),u=class{constructor(q){this.mask=~M("x",q),this.masked_value=M("1",q)}isMatch(q){return this.masked_value===(q&this.mask)}},p=class{constructor(q,X,K){this.profile_idc=q,this.profile_iop=X,this.profile=K}},h=[new p(66,new u("x1xx0000"),r.ConstrainedBaseline),new p(77,new u("1xxx0000"),r.ConstrainedBaseline),new p(88,new u("11xx0000"),r.ConstrainedBaseline),new p(66,new u("x0xx0000"),r.Baseline),new p(88,new u("10xx0000"),r.Baseline),new p(77,new u("0x0x0000"),r.Main),new p(100,new u("00000000"),r.High),new p(100,new u("00001100"),r.ConstrainedHigh),new p(244,new u("00000000"),r.PredictiveHigh444)],v=[{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:i.L1},{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:i.L1_b},{max_macroblocks_per_second:3e3,max_macroblock_frame_size:396,level:i.L1_1},{max_macroblocks_per_second:6e3,max_macroblock_frame_size:396,level:i.L1_2},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:i.L1_3},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:i.L2},{max_macroblocks_per_second:19800,max_macroblock_frame_size:792,level:i.L2_1},{max_macroblocks_per_second:20250,max_macroblock_frame_size:1620,level:i.L2_2},{max_macroblocks_per_second:40500,max_macroblock_frame_size:1620,level:i.L3},{max_macroblocks_per_second:108e3,max_macroblock_frame_size:3600,level:i.L3_1},{max_macroblocks_per_second:216e3,max_macroblock_frame_size:5120,level:i.L3_2},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:i.L4},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:i.L4_1},{max_macroblocks_per_second:522240,max_macroblock_frame_size:8704,level:i.L4_2},{max_macroblocks_per_second:589824,max_macroblock_frame_size:22080,level:i.L5},{max_macroblocks_per_second:983040,max_macroblock_frame_size:36864,level:i.L5_1},{max_macroblocks_per_second:2073600,max_macroblock_frame_size:36864,level:i.L5_2}];function f(q){if(typeof q!="string"||q.length!==6)return;const K=parseInt(q,16);if(K===0)return;const ee=K&255,oe=K>>8&255,ce=K>>16&255;let ne;switch(ee){case i.L1_1:{ne=oe&16?i.L1_b:i.L1_1;break}case i.L1:case i.L1_2:case i.L1_3:case i.L2:case i.L2_1:case i.L2_2:case i.L3:case i.L3_1:case i.L3_2:case i.L4:case i.L4_1:case i.L4_2:case i.L5:case i.L5_1:case i.L5_2:{ne=ee;break}default:{n.warn(`parseProfileLevelId() | unrecognized level_idc [str:${q}, level_idc:${ee}]`);return}}for(const Te of h)if(ce===Te.profile_idc&&Te.profile_iop.isMatch(oe))return n.debug(`parseProfileLevelId() | result [str:${q}, profile:${Te.profile}, level:${ne}]`),new a(Te.profile,ne);n.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${q}, profile_idc:${ce}, profile_iop:${oe}]`)}function _(q){if(q.level==i.L1_b)switch(q.profile){case r.ConstrainedBaseline:return"42f00b";case r.Baseline:return"42100b";case r.Main:return"4d100b";default:{n.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${q.profile}`);return}}let X;switch(q.profile){case r.ConstrainedBaseline:{X="42e0";break}case r.Baseline:{X="4200";break}case r.Main:{X="4d00";break}case r.ConstrainedHigh:{X="640c";break}case r.High:{X="6400";break}case r.PredictiveHigh444:{X="f400";break}default:{n.warn(`profileLevelIdToString() | unrecognized profile ${q.profile}`);return}}let K=q.level.toString(16);return K.length===1&&(K=`0${K}`),`${X}${K}`}function w(q){switch(q){case r.ConstrainedBaseline:return"ConstrainedBaseline";case r.Baseline:return"Baseline";case r.Main:return"Main";case r.ConstrainedHigh:return"ConstrainedHigh";case r.High:return"High";case r.PredictiveHigh444:return"PredictiveHigh444";default:{n.warn(`profileToString() | unrecognized profile ${q}`);return}}}function C(q){switch(q){case i.L1_b:return"1b";case i.L1:return"1";case i.L1_1:return"1.1";case i.L1_2:return"1.2";case i.L1_3:return"1.3";case i.L2:return"2";case i.L2_1:return"2.1";case i.L2_2:return"2.2";case i.L3:return"3";case i.L3_1:return"3.1";case i.L3_2:return"3.2";case i.L4:return"4";case i.L4_1:return"4.1";case i.L4_2:return"4.2";case i.L5:return"5";case i.L5_1:return"5.1";case i.L5_2:return"5.2";default:{n.warn(`levelToString() | unrecognized level ${q}`);return}}}function R(q={}){const X=q["profile-level-id"];return X?f(X):o}function S(q={},X={}){const K=R(q),ee=R(X);return!!(K&&ee&&K.profile===ee.profile)}function b(q={},X={}){const K=R(q),ee=R(X);return!!(K&&ee&&K.profile===ee.profile&&K.level==ee.level)}function x(q={},X={}){if(!q["profile-level-id"]&&!X["profile-level-id"]){n.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const K=R(q),ee=R(X);if(!K)throw new TypeError("invalid local_profile_level_id");if(!ee)throw new TypeError("invalid remote_profile_level_id");if(K.profile!==ee.profile)throw new TypeError("H264 Profile mismatch");const oe=z(q)&&z(X),ce=K.level,ne=ee.level,Te=$(ce,ne),ye=oe?ce:Te;return n.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${K.profile}, level:${ye}]`),_(new a(K.profile,ye))}function E(q,X){for(let ee=v.length-1;ee>=0;--ee){const oe=v[ee];if(oe.max_macroblock_frame_size*256<=q&&oe.max_macroblocks_per_second<=X*oe.max_macroblock_frame_size)return n.debug(`supportedLevel() | result [max_frame_pixel_count:${q}, max_fps:${X}, level:${oe.level}]`),oe.level}n.warn(`supportedLevel() | no level supported [max_frame_pixel_count:${q}, max_fps:${X}]`)}function M(q,X){return+(X[0]===q)<<7|+(X[1]===q)<<6|+(X[2]===q)<<5|+(X[3]===q)<<4|+(X[4]===q)<<3|+(X[5]===q)<<2|+(X[6]===q)<<1|+(X[7]===q)<<0}function Z(q,X){return q===i.L1_b?X!==i.L1&&X!==i.L1_b:X===i.L1_b?q!==i.L1:q<X}function $(q,X){return Z(q,X)?q:X}function z(q={}){const X=q["level-asymmetry-allowed"];return X===!0||X===1||X==="1"}}}),xs=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/ortc.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.validateRtpCapabilities=o,e.validateRtpParameters=u,e.validateSctpStreamParameters=p,e.validateSctpCapabilities=h,e.getExtendedRtpCapabilities=v,e.getRecvRtpCapabilities=f,e.getSendingRtpParameters=_,e.getSendingRemoteRtpParameters=w,e.reduceCodecs=C,e.generateProbatorRtpParameters=R,e.canSend=S,e.canReceive=b;var t=g3(),n=Vo(),r="probator",i=1234,a=127;function o(ne){if(typeof ne!="object")throw new TypeError("caps is not an object");if(ne.codecs&&!Array.isArray(ne.codecs))throw new TypeError("caps.codecs is not an array");ne.codecs||(ne.codecs=[]);for(const Te of ne.codecs)x(Te);if(ne.headerExtensions&&!Array.isArray(ne.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");ne.headerExtensions||(ne.headerExtensions=[]);for(const Te of ne.headerExtensions)M(Te)}function u(ne){if(typeof ne!="object")throw new TypeError("params is not an object");if(ne.mid&&typeof ne.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(ne.codecs))throw new TypeError("missing params.codecs");for(const Te of ne.codecs)Z(Te);if(ne.headerExtensions&&!Array.isArray(ne.headerExtensions))throw new TypeError("params.headerExtensions is not an array");ne.headerExtensions||(ne.headerExtensions=[]);for(const Te of ne.headerExtensions)$(Te);if(ne.encodings&&!Array.isArray(ne.encodings))throw new TypeError("params.encodings is not an array");ne.encodings||(ne.encodings=[]);for(const Te of ne.encodings)z(Te);if(ne.rtcp&&typeof ne.rtcp!="object")throw new TypeError("params.rtcp is not an object");ne.rtcp||(ne.rtcp={}),q(ne.rtcp)}function p(ne){if(typeof ne!="object")throw new TypeError("params is not an object");if(typeof ne.streamId!="number")throw new TypeError("missing params.streamId");let Te=!1;if(typeof ne.ordered=="boolean"?Te=!0:ne.ordered=!0,ne.maxPacketLifeTime&&typeof ne.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(ne.maxRetransmits&&typeof ne.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(ne.maxPacketLifeTime&&ne.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(Te&&ne.ordered&&(ne.maxPacketLifeTime||ne.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!Te&&(ne.maxPacketLifeTime||ne.maxRetransmits)&&(ne.ordered=!1),ne.label&&typeof ne.label!="string")throw new TypeError("invalid params.label");if(ne.protocol&&typeof ne.protocol!="string")throw new TypeError("invalid params.protocol")}function h(ne){if(typeof ne!="object")throw new TypeError("caps is not an object");if(!ne.numStreams||typeof ne.numStreams!="object")throw new TypeError("missing caps.numStreams");X(ne.numStreams)}function v(ne,Te,ye){var ue,me,_e,ke,le,Re,We,Xe,Ke;const Le={codecs:[],headerExtensions:[]};if(ye)for(const qe of(ue=ne.codecs)!=null?ue:[]){if(K(qe))continue;const rt=((me=Te.codecs)!=null?me:[]).find(wt=>ee(wt,qe,{strict:!0,modify:!0}));if(!rt)continue;const ot={kind:qe.kind,mimeType:qe.mimeType,clockRate:qe.clockRate,channels:qe.channels,localPayloadType:qe.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:rt.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:(_e=qe.parameters)!=null?_e:{},remoteParameters:(ke=rt.parameters)!=null?ke:{},rtcpFeedback:ce(qe,rt)};Le.codecs.push(ot)}else for(const qe of(le=Te.codecs)!=null?le:[]){if(K(qe))continue;const rt=((Re=ne.codecs)!=null?Re:[]).find(wt=>ee(wt,qe,{strict:!0,modify:!0}));if(!rt)continue;const ot={kind:rt.kind,mimeType:rt.mimeType,clockRate:rt.clockRate,channels:rt.channels,localPayloadType:rt.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:qe.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:(We=rt.parameters)!=null?We:{},remoteParameters:(Xe=qe.parameters)!=null?Xe:{},rtcpFeedback:ce(rt,qe)};Le.codecs.push(ot)}for(const qe of Le.codecs){const rt=ne.codecs.find(wt=>{var Pn;return K(wt)&&((Pn=wt.parameters)==null?void 0:Pn.apt)===qe.localPayloadType}),ot=Te.codecs.find(wt=>{var Pn;return K(wt)&&((Pn=wt.parameters)==null?void 0:Pn.apt)===qe.remotePayloadType});rt&&ot&&(qe.localRtxPayloadType=rt.preferredPayloadType,qe.remoteRtxPayloadType=ot.preferredPayloadType)}for(const qe of Te.headerExtensions){const rt=ne.headerExtensions.find(wt=>oe(wt,qe));if(!rt)continue;const ot={kind:qe.kind,uri:qe.uri,sendId:rt.preferredId,recvId:qe.preferredId,encrypt:(Ke=rt.preferredEncrypt)!=null?Ke:!1,direction:"sendrecv"};switch(qe.direction){case"sendrecv":{ot.direction="sendrecv";break}case"recvonly":{ot.direction="sendonly";break}case"sendonly":{ot.direction="recvonly";break}case"inactive":{ot.direction="inactive";break}}Le.headerExtensions.push(ot)}return Le}function f(ne){var Te;const ye={codecs:[],headerExtensions:[]};for(const ue of ne.codecs){const me={kind:ue.kind,mimeType:ue.mimeType,preferredPayloadType:ue.remotePayloadType,clockRate:ue.clockRate,channels:ue.channels,parameters:ue.localParameters,rtcpFeedback:ue.rtcpFeedback};if(ye.codecs.push(me),!ue.remoteRtxPayloadType)continue;const _e={kind:ue.kind,mimeType:`${ue.kind}/rtx`,preferredPayloadType:ue.remoteRtxPayloadType,clockRate:ue.clockRate,parameters:{apt:ue.remotePayloadType},rtcpFeedback:[]};ye.codecs.push(_e)}for(const ue of ne.headerExtensions){if(ue.direction!=="sendrecv"&&ue.direction!=="recvonly")continue;const me={kind:ue.kind,uri:ue.uri,preferredId:ue.recvId,preferredEncrypt:(Te=ue.encrypt)!=null?Te:!1,direction:ue.direction};ye.headerExtensions.push(me)}return ye}function _(ne,Te){const ye={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const ue of Te.codecs){if(ue.kind!==ne)continue;const me={mimeType:ue.mimeType,payloadType:ue.localPayloadType,clockRate:ue.clockRate,channels:ue.channels,parameters:ue.localParameters,rtcpFeedback:ue.rtcpFeedback};if(ye.codecs.push(me),ue.localRtxPayloadType){const _e={mimeType:`${ue.kind}/rtx`,payloadType:ue.localRtxPayloadType,clockRate:ue.clockRate,parameters:{apt:ue.localPayloadType},rtcpFeedback:[]};ye.codecs.push(_e)}}for(const ue of Te.headerExtensions){if(ue.kind&&ue.kind!==ne||ue.direction!=="sendrecv"&&ue.direction!=="sendonly")continue;const me={uri:ue.uri,id:ue.sendId,encrypt:ue.encrypt,parameters:{}};ye.headerExtensions.push(me)}return ye}function w(ne,Te){var ye,ue,me;const _e={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const ke of Te.codecs){if(ke.kind!==ne)continue;const le={mimeType:ke.mimeType,payloadType:ke.localPayloadType,clockRate:ke.clockRate,channels:ke.channels,parameters:ke.remoteParameters,rtcpFeedback:ke.rtcpFeedback};if(_e.codecs.push(le),ke.localRtxPayloadType){const Re={mimeType:`${ke.kind}/rtx`,payloadType:ke.localRtxPayloadType,clockRate:ke.clockRate,parameters:{apt:ke.localPayloadType},rtcpFeedback:[]};_e.codecs.push(Re)}}for(const ke of Te.headerExtensions){if(ke.kind&&ke.kind!==ne||ke.direction!=="sendrecv"&&ke.direction!=="sendonly")continue;const le={uri:ke.uri,id:ke.sendId,encrypt:ke.encrypt,parameters:{}};_e.headerExtensions.push(le)}if(_e.headerExtensions.some(ke=>ke.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const ke of _e.codecs)ke.rtcpFeedback=((ye=ke.rtcpFeedback)!=null?ye:[]).filter(le=>le.type!=="goog-remb");else if(_e.headerExtensions.some(ke=>ke.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const ke of _e.codecs)ke.rtcpFeedback=((ue=ke.rtcpFeedback)!=null?ue:[]).filter(le=>le.type!=="transport-cc");else for(const ke of _e.codecs)ke.rtcpFeedback=((me=ke.rtcpFeedback)!=null?me:[]).filter(le=>le.type!=="transport-cc"&&le.type!=="goog-remb");return _e}function C(ne,Te){const ye=[];if(!Te)ye.push(ne[0]),K(ne[1])&&ye.push(ne[1]);else{for(let ue=0;ue<ne.length;++ue)if(ee(ne[ue],Te,{strict:!0})){ye.push(ne[ue]),K(ne[ue+1])&&ye.push(ne[ue+1]);break}if(ye.length===0)throw new TypeError("no matching codec found")}return ye}function R(ne){ne=n.clone(ne),u(ne);const Te={mid:r,codecs:[],headerExtensions:[],encodings:[{ssrc:i}],rtcp:{cname:"probator"}};return Te.codecs.push(ne.codecs[0]),Te.codecs[0].payloadType=a,Te.headerExtensions=ne.headerExtensions,Te}function S(ne,Te){var ye;return((ye=Te.codecs)!=null?ye:[]).some(ue=>ue.kind===ne)}function b(ne,Te){var ye;if(u(ne),ne.codecs.length===0)return!1;const ue=ne.codecs[0];return((ye=Te.codecs)!=null?ye:[]).some(me=>me.preferredPayloadType===ue.payloadType)}function x(ne){const Te=new RegExp("^(audio|video)/(.+)","i");if(typeof ne!="object")throw new TypeError("codec is not an object");if(!ne.mimeType||typeof ne.mimeType!="string")throw new TypeError("missing codec.mimeType");const ye=Te.exec(ne.mimeType);if(!ye)throw new TypeError("invalid codec.mimeType");if(ne.kind=ye[1].toLowerCase(),typeof ne.preferredPayloadType!="number")throw new TypeError("missing codec.preferredPayloadType");if(typeof ne.clockRate!="number")throw new TypeError("missing codec.clockRate");ne.kind==="audio"?typeof ne.channels!="number"&&(ne.channels=1):delete ne.channels,(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const ue of Object.keys(ne.parameters)){let me=ne.parameters[ue];if(me===void 0&&(ne.parameters[ue]="",me=""),typeof me!="string"&&typeof me!="number")throw new TypeError(`invalid codec parameter [key:${ue}s, value:${me}]`);if(ue==="apt"&&typeof me!="number")throw new TypeError("invalid codec apt parameter")}(!ne.rtcpFeedback||!Array.isArray(ne.rtcpFeedback))&&(ne.rtcpFeedback=[]);for(const ue of ne.rtcpFeedback)E(ue)}function E(ne){if(typeof ne!="object")throw new TypeError("fb is not an object");if(!ne.type||typeof ne.type!="string")throw new TypeError("missing fb.type");(!ne.parameter||typeof ne.parameter!="string")&&(ne.parameter="")}function M(ne){if(typeof ne!="object")throw new TypeError("ext is not an object");if(ne.kind!=="audio"&&ne.kind!=="video")throw new TypeError("invalid ext.kind");if(!ne.uri||typeof ne.uri!="string")throw new TypeError("missing ext.uri");if(typeof ne.preferredId!="number")throw new TypeError("missing ext.preferredId");if(ne.preferredEncrypt&&typeof ne.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(ne.preferredEncrypt||(ne.preferredEncrypt=!1),ne.direction&&typeof ne.direction!="string")throw new TypeError("invalid ext.direction");ne.direction||(ne.direction="sendrecv")}function Z(ne){const Te=new RegExp("^(audio|video)/(.+)","i");if(typeof ne!="object")throw new TypeError("codec is not an object");if(!ne.mimeType||typeof ne.mimeType!="string")throw new TypeError("missing codec.mimeType");const ye=Te.exec(ne.mimeType);if(!ye)throw new TypeError("invalid codec.mimeType");if(typeof ne.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof ne.clockRate!="number")throw new TypeError("missing codec.clockRate");ye[1].toLowerCase()==="audio"?typeof ne.channels!="number"&&(ne.channels=1):delete ne.channels,(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const me of Object.keys(ne.parameters)){let _e=ne.parameters[me];if(_e===void 0&&(ne.parameters[me]="",_e=""),typeof _e!="string"&&typeof _e!="number")throw new TypeError(`invalid codec parameter [key:${me}s, value:${_e}]`);if(me==="apt"&&typeof _e!="number")throw new TypeError("invalid codec apt parameter")}(!ne.rtcpFeedback||!Array.isArray(ne.rtcpFeedback))&&(ne.rtcpFeedback=[]);for(const me of ne.rtcpFeedback)E(me)}function $(ne){if(typeof ne!="object")throw new TypeError("ext is not an object");if(!ne.uri||typeof ne.uri!="string")throw new TypeError("missing ext.uri");if(typeof ne.id!="number")throw new TypeError("missing ext.id");if(ne.encrypt&&typeof ne.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");ne.encrypt||(ne.encrypt=!1),(!ne.parameters||typeof ne.parameters!="object")&&(ne.parameters={});for(const Te of Object.keys(ne.parameters)){let ye=ne.parameters[Te];if(ye===void 0&&(ne.parameters[Te]="",ye=""),typeof ye!="string"&&typeof ye!="number")throw new TypeError("invalid header extension parameter")}}function z(ne){if(typeof ne!="object")throw new TypeError("encoding is not an object");if(ne.ssrc&&typeof ne.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(ne.rid&&typeof ne.rid!="string")throw new TypeError("invalid encoding.rid");if(ne.rtx&&typeof ne.rtx!="object")throw new TypeError("invalid encoding.rtx");if(ne.rtx&&typeof ne.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!ne.dtx||typeof ne.dtx!="boolean")&&(ne.dtx=!1),ne.scalabilityMode&&typeof ne.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function q(ne){if(typeof ne!="object")throw new TypeError("rtcp is not an object");if(ne.cname&&typeof ne.cname!="string")throw new TypeError("invalid rtcp.cname");(!ne.reducedSize||typeof ne.reducedSize!="boolean")&&(ne.reducedSize=!0)}function X(ne){if(typeof ne!="object")throw new TypeError("numStreams is not an object");if(typeof ne.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof ne.MIS!="number")throw new TypeError("missing numStreams.MIS")}function K(ne){return ne?/.+\/rtx$/i.test(ne.mimeType):!1}function ee(ne,Te,{strict:ye=!1,modify:ue=!1}={}){var me,_e,ke,le;const Re=ne.mimeType.toLowerCase(),We=Te.mimeType.toLowerCase();if(Re!==We||ne.clockRate!==Te.clockRate||ne.channels!==Te.channels)return!1;switch(Re){case"video/h264":{if(ye){const Xe=(me=ne.parameters["packetization-mode"])!=null?me:0,Ke=(_e=Te.parameters["packetization-mode"])!=null?_e:0;if(Xe!==Ke||!t.isSameProfile(ne.parameters,Te.parameters))return!1;let Le;try{Le=t.generateProfileLevelIdStringForAnswer(ne.parameters,Te.parameters)}catch{return!1}ue&&(Le?(ne.parameters["profile-level-id"]=Le,Te.parameters["profile-level-id"]=Le):(delete ne.parameters["profile-level-id"],delete Te.parameters["profile-level-id"]))}break}case"video/vp9":{if(ye){const Xe=(ke=ne.parameters["profile-id"])!=null?ke:0,Ke=(le=Te.parameters["profile-id"])!=null?le:0;if(Xe!==Ke)return!1}break}}return!0}function oe(ne,Te){return!(ne.kind&&Te.kind&&ne.kind!==Te.kind||ne.uri!==Te.uri)}function ce(ne,Te){var ye,ue;const me=[];for(const _e of(ye=ne.rtcpFeedback)!=null?ye:[]){const ke=((ue=Te.rtcpFeedback)!=null?ue:[]).find(le=>le.type===_e.type&&(le.parameter===_e.parameter||!le.parameter&&!_e.parameter));ke&&me.push(ke)}return me}}}),v3=Ee({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/Logger.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0;var t=Xd(),n="awaitqueue",r=class{constructor(i){ge(this,"_debug"),ge(this,"_warn"),ge(this,"_error"),i?(this._debug=t(`${n}:${i}`),this._warn=t(`${n}:WARN:${i}`),this._error=t(`${n}:ERROR:${i}`)):(this._debug=t(n),this._warn=t(`${n}:WARN`),this._error=t(`${n}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};e.Logger=r}}),Xy=Ee({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/errors.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=void 0;var t=class Yy extends Error{constructor(i){super(i??"queue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Yy)}};e.AwaitQueueStoppedError=t;var n=class e_ extends Error{constructor(i){super(i??"queue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e_)}};e.AwaitQueueRemovedTaskError=n}}),y3=Ee({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/AwaitQueue.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueue=void 0;var t=v3(),n=Xy(),r=new t.Logger("AwaitQueue"),i=class{constructor(){ge(this,"pendingTasks",new Map),ge(this,"nextTaskId",0),ge(this,"stopping",!1),r.debug("constructor()")}get size(){return this.pendingTasks.size}push(a,o){return H(this,null,function*(){if(o=o??a.name,r.debug(`push() [name:${o}]`),typeof a!="function")throw new TypeError("given task is not a function");if(o)try{Object.defineProperty(a,"name",{value:o})}catch{}return new Promise((u,p)=>{const h={id:this.nextTaskId++,task:a,name:o,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:v=>{if(h.completed)return;h.completed=!0,this.pendingTasks.delete(h.id),r.debug(`resolving task [name:${h.name}]`),u(v);const[f]=this.pendingTasks.values();f&&!f.executedAt&&this.execute(f)},reject:v=>{if(!h.completed&&(h.completed=!0,this.pendingTasks.delete(h.id),r.debug(`rejecting task [name:${h.name}]: %s`,String(v)),p(v),!this.stopping)){const[f]=this.pendingTasks.values();f&&!f.executedAt&&this.execute(f)}}};this.pendingTasks.set(h.id,h),this.pendingTasks.size===1&&this.execute(h)})})}stop(){r.debug("stop()"),this.stopping=!0;for(const a of this.pendingTasks.values())r.debug(`stop() | stopping task [name:${a.name}]`),a.reject(new n.AwaitQueueStoppedError);this.stopping=!1}remove(a){r.debug(`remove() [taskIdx:${a}]`);const o=Array.from(this.pendingTasks.values())[a];if(!o){r.debug(`stop() | no task with given idx [taskIdx:${a}]`);return}o.reject(new n.AwaitQueueRemovedTaskError)}dump(){const a=Date.now();let o=0;return Array.from(this.pendingTasks.values()).map(u=>({idx:o++,task:u.task,name:u.name,enqueuedTime:u.executedAt?u.executedAt-u.enqueuedAt:a-u.enqueuedAt,executionTime:u.executedAt?a-u.executedAt:0}))}execute(a){return H(this,null,function*(){if(r.debug(`execute() [name:${a.name}]`),a.executedAt)throw new Error("task already being executed");a.executedAt=Date.now();try{const o=yield a.task();a.resolve(o)}catch(o){a.reject(o)}})}};e.AwaitQueue=i}}),_3=Ee({"../../node_modules/.pnpm/awaitqueue@3.2.4_supports-color@10.2.0/node_modules/awaitqueue/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=e.AwaitQueue=void 0;var t=y3();Object.defineProperty(e,"AwaitQueue",{enumerable:!0,get:function(){return t.AwaitQueue}});var n=Xy();Object.defineProperty(e,"AwaitQueueStoppedError",{enumerable:!0,get:function(){return n.AwaitQueueStoppedError}}),Object.defineProperty(e,"AwaitQueueRemovedTaskError",{enumerable:!0,get:function(){return n.AwaitQueueRemovedTaskError}})}}),b3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Producer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Producer=void 0;var t=Ur(),n=Jr(),r=Di(),i=new t.Logger("Producer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,localId:u,rtpSender:p,track:h,rtpParameters:v,stopTracks:f,disableTrackOnPause:_,zeroRtpOnPause:w,appData:C}){super(),ge(this,"_id"),ge(this,"_localId"),ge(this,"_closed",!1),ge(this,"_rtpSender"),ge(this,"_track"),ge(this,"_kind"),ge(this,"_rtpParameters"),ge(this,"_paused"),ge(this,"_maxSpatialLayer"),ge(this,"_stopTracks"),ge(this,"_disableTrackOnPause"),ge(this,"_zeroRtpOnPause"),ge(this,"_appData"),ge(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._localId=u,this._rtpSender=p,this._track=h,this._kind=h.kind,this._rtpParameters=v,this._paused=_?!h.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=f,this._disableTrackOnPause=_,this._zeroRtpOnPause=w,this._appData=C??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}getStats(){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");return new Promise((o,u)=>{this.safeEmit("@getstats",o,u)})})}pause(){if(i.debug("pause()"),this._closed){i.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((o,u)=>{this.safeEmit("@pause",o,u)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(i.debug("resume()"),this._closed){i.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((o,u)=>{this.safeEmit("@resume",o,u)}).catch(()=>{}),this._observer.safeEmit("resume")}replaceTrack(o){return H(this,arguments,function*({track:u}){if(i.debug("replaceTrack() [track:%o]",u),this._closed){if(u&&this._stopTracks)try{u.stop()}catch{}throw new r.InvalidStateError("closed")}else if(u&&u.readyState==="ended")throw new r.InvalidStateError("track ended");if(u===this._track){i.debug("replaceTrack() | same track, ignored");return}yield new Promise((p,h)=>{this.safeEmit("@replacetrack",u,p,h)}),this.destroyTrack(),this._track=u,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()})}setMaxSpatialLayer(o){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");if(this._kind!=="video")throw new r.UnsupportedError("not a video Producer");if(typeof o!="number")throw new TypeError("invalid spatialLayer");o!==this._maxSpatialLayer&&(yield new Promise((u,p)=>{this.safeEmit("@setmaxspatiallayer",o,u,p)}).catch(()=>{}),this._maxSpatialLayer=o)})}setRtpEncodingParameters(o){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");if(typeof o!="object")throw new TypeError("invalid params");yield new Promise((u,p)=>{this.safeEmit("@setrtpencodingparameters",o,u,p)})})}onTrackEnded(){i.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}};e.Producer=a}}),S3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Consumer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Consumer=void 0;var t=Ur(),n=Jr(),r=Di(),i=new t.Logger("Consumer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,localId:u,producerId:p,rtpReceiver:h,track:v,rtpParameters:f,appData:_}){super(),ge(this,"_id"),ge(this,"_localId"),ge(this,"_producerId"),ge(this,"_closed",!1),ge(this,"_rtpReceiver"),ge(this,"_track"),ge(this,"_rtpParameters"),ge(this,"_paused"),ge(this,"_appData"),ge(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._localId=u,this._producerId=p,this._rtpReceiver=h,this._track=v,this._rtpParameters=f,this._paused=!v.enabled,this._appData=_??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}getStats(){return H(this,null,function*(){if(this._closed)throw new r.InvalidStateError("closed");return new Promise((o,u)=>{this.safeEmit("@getstats",o,u)})})}pause(){if(i.debug("pause()"),this._closed){i.error("pause() | Consumer closed");return}if(this._paused){i.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(i.debug("resume()"),this._closed){i.error("resume() | Consumer closed");return}if(!this._paused){i.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){i.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}};e.Consumer=a}}),w3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/DataProducer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataProducer=void 0;var t=Ur(),n=Jr(),r=Di(),i=new t.Logger("DataProducer"),a=class extends n.EnhancedEventEmitter{constructor({id:o,dataChannel:u,sctpStreamParameters:p,appData:h}){super(),ge(this,"_id"),ge(this,"_dataChannel"),ge(this,"_closed",!1),ge(this,"_sctpStreamParameters"),ge(this,"_appData"),ge(this,"_observer",new n.EnhancedEventEmitter),i.debug("constructor()"),this._id=o,this._dataChannel=u,this._sctpStreamParameters=p,this._appData=h??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(o){this._dataChannel.bufferedAmountLowThreshold=o}get appData(){return this._appData}set appData(o){this._appData=o}get observer(){return this._observer}close(){this._closed||(i.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(i.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(o){if(i.debug("send()"),this._closed)throw new r.InvalidStateError("closed");this._dataChannel.send(o)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(i.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",o=>{var u,p,h;if(this._closed)return;const v=(u=o.error)!=null?u:new Error("unknown DataChannel error");((p=o.error)==null?void 0:p.errorDetail)==="sctp-failure"?i.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",(h=o.error)==null?void 0:h.sctpCauseCode,o.error.message):i.error('DataChannel "error" event: %o',v),this.safeEmit("error",v)}),this._dataChannel.addEventListener("close",()=>{this._closed||(i.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||i.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}};e.DataProducer=a}}),x3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/DataConsumer.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.DataConsumer=void 0;var t=Ur(),n=Jr(),r=new t.Logger("DataConsumer"),i=class extends n.EnhancedEventEmitter{constructor({id:a,dataProducerId:o,dataChannel:u,sctpStreamParameters:p,appData:h}){super(),ge(this,"_id"),ge(this,"_dataProducerId"),ge(this,"_dataChannel"),ge(this,"_closed",!1),ge(this,"_sctpStreamParameters"),ge(this,"_appData"),ge(this,"_observer",new n.EnhancedEventEmitter),r.debug("constructor()"),this._id=a,this._dataProducerId=o,this._dataChannel=u,this._sctpStreamParameters=p,this._appData=h??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(a){this._dataChannel.binaryType=a}get appData(){return this._appData}set appData(a){this._appData=a}get observer(){return this._observer}close(){this._closed||(r.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"),super.close(),this._observer.close())}transportClosed(){this._closed||(r.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(r.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",a=>{var o,u,p;if(this._closed)return;const h=(o=a.error)!=null?o:new Error("unknown DataChannel error");((u=a.error)==null?void 0:u.errorDetail)==="sctp-failure"?r.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",(p=a.error)==null?void 0:p.sctpCauseCode,a.error.message):r.error('DataChannel "error" event: %o',h),this.safeEmit("error",h)}),this._dataChannel.addEventListener("close",()=>{this._closed||(r.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",a=>{this._closed||this.safeEmit("message",a.data)})}};e.DataConsumer=i}}),C3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Transport.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Transport=void 0;var t=_3(),n=Ur(),r=Jr(),i=Di(),a=Vo(),o=xs(),u=b3(),p=S3(),h=w3(),v=x3(),f=new n.Logger("Transport"),_=class{constructor(C){ge(this,"consumerOptions"),ge(this,"promise"),ge(this,"resolve"),ge(this,"reject"),this.consumerOptions=C,this.promise=new Promise((R,S)=>{this.resolve=R,this.reject=S})}},w=class extends r.EnhancedEventEmitter{constructor({direction:C,id:R,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:$,appData:z,handlerFactory:q,getSendExtendedRtpCapabilities:X,recvRtpCapabilities:K,canProduceByKind:ee}){var oe;super(),ge(this,"_id"),ge(this,"_closed",!1),ge(this,"_direction"),ge(this,"_getSendExtendedRtpCapabilities"),ge(this,"_recvRtpCapabilities"),ge(this,"_canProduceByKind"),ge(this,"_maxSctpMessageSize"),ge(this,"_handler"),ge(this,"_iceGatheringState","new"),ge(this,"_connectionState","new"),ge(this,"_appData"),ge(this,"_producers",new Map),ge(this,"_consumers",new Map),ge(this,"_dataProducers",new Map),ge(this,"_dataConsumers",new Map),ge(this,"_probatorConsumerCreated",!1),ge(this,"_awaitQueue",new t.AwaitQueue),ge(this,"_pendingConsumerTasks",[]),ge(this,"_consumerCreationInProgress",!1),ge(this,"_pendingPauseConsumers",new Map),ge(this,"_consumerPauseInProgress",!1),ge(this,"_pendingResumeConsumers",new Map),ge(this,"_consumerResumeInProgress",!1),ge(this,"_pendingCloseConsumers",new Map),ge(this,"_consumerCloseInProgress",!1),ge(this,"_observer",new r.EnhancedEventEmitter),f.debug("constructor() [id:%s, direction:%s]",R,C),this._id=R,this._direction=C,this._getSendExtendedRtpCapabilities=X,this._recvRtpCapabilities=K,this._canProduceByKind=ee,this._maxSctpMessageSize=E?E.maxMessageSize:null;const ce=(oe=a.clone($))!=null?oe:{};delete ce.iceServers,delete ce.iceTransportPolicy,delete ce.bundlePolicy,delete ce.rtcpMuxPolicy,this._handler=q.factory({direction:C,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:ce,getSendExtendedRtpCapabilities:this._getSendExtendedRtpCapabilities}),this._appData=z??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(C){this._appData=C}get observer(){return this._observer}close(){if(!this._closed){f.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const C of this._producers.values())C.transportClosed();this._producers.clear();for(const C of this._consumers.values())C.transportClosed();this._consumers.clear();for(const C of this._dataProducers.values())C.transportClosed();this._dataProducers.clear();for(const C of this._dataConsumers.values())C.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close"),super.close(),this._observer.close()}}getStats(){return H(this,null,function*(){if(this._closed)throw new i.InvalidStateError("closed");return this._handler.getTransportStats()})}restartIce(C){return H(this,arguments,function*({iceParameters:R}){if(f.debug("restartIce()"),this._closed)throw new i.InvalidStateError("closed");if(!R)throw new TypeError("missing iceParameters");return this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.restartIce(R)}),"transport.restartIce()")})}updateIceServers(){return H(this,arguments,function*({iceServers:C}={}){if(f.debug("updateIceServers()"),this._closed)throw new i.InvalidStateError("closed");if(!Array.isArray(C))throw new TypeError("missing iceServers");return this._awaitQueue.push(()=>H(this,null,function*(){return this._handler.updateIceServers(C)}),"transport.updateIceServers()")})}produce(){return H(this,arguments,function*({track:C,encodings:R,codecOptions:S,codec:b,stopTracks:x=!0,disableTrackOnPause:E=!0,zeroRtpOnPause:M=!1,onRtpSender:Z,appData:$={}}={}){if(f.debug("produce() [track:%o]",C),this._closed)throw new i.InvalidStateError("closed");if(C){if(this._direction!=="send")throw new i.UnsupportedError("not a sending Transport");if(this._canProduceByKind[C.kind]){if(C.readyState==="ended")throw new i.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if($&&typeof $!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError(`cannot produce ${C.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(()=>H(this,null,function*(){let z;if(R&&!Array.isArray(R))throw TypeError("encodings must be an array");R&&R.length===0?z=void 0:R&&(z=R.map(ee=>{const oe={active:!0};return ee.active===!1&&(oe.active=!1),typeof ee.dtx=="boolean"&&(oe.dtx=ee.dtx),typeof ee.scalabilityMode=="string"&&(oe.scalabilityMode=ee.scalabilityMode),typeof ee.scaleResolutionDownBy=="number"&&(oe.scaleResolutionDownBy=ee.scaleResolutionDownBy),typeof ee.maxBitrate=="number"&&(oe.maxBitrate=ee.maxBitrate),typeof ee.maxFramerate=="number"&&(oe.maxFramerate=ee.maxFramerate),typeof ee.adaptivePtime=="boolean"&&(oe.adaptivePtime=ee.adaptivePtime),typeof ee.priority=="string"&&(oe.priority=ee.priority),typeof ee.networkPriority=="string"&&(oe.networkPriority=ee.networkPriority),oe}));const{localId:q,rtpParameters:X,rtpSender:K}=yield this._handler.send({track:C,encodings:z,codecOptions:S,codec:b,onRtpSender:Z});try{o.validateRtpParameters(X);const{id:ee}=yield new Promise((ce,ne)=>{this.safeEmit("produce",{kind:C.kind,rtpParameters:X,appData:$},ce,ne)}),oe=new u.Producer({id:ee,localId:q,rtpSender:K,track:C,rtpParameters:X,stopTracks:x,disableTrackOnPause:E,zeroRtpOnPause:M,appData:$});return this._producers.set(oe.id,oe),this.handleProducer(oe),this._observer.safeEmit("newproducer",oe),oe}catch(ee){throw this._handler.stopSending(q).catch(()=>{}),ee}}),"transport.produce()").catch(z=>{if(x)try{C.stop()}catch{}throw z})})}consume(C){return H(this,arguments,function*({id:R,producerId:S,kind:b,rtpParameters:x,streamId:E,onRtpReceiver:M,appData:Z={}}){if(f.debug("consume()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="recv")throw new i.UnsupportedError("not a receiving Transport");if(typeof R!="string")throw new TypeError("missing id");if(typeof S!="string")throw new TypeError("missing producerId");if(b!=="audio"&&b!=="video")throw new TypeError(`invalid kind '${b}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(Z&&typeof Z!="object")throw new TypeError("if given, appData must be an object");const $=a.clone(x);if(!o.canReceive($,this._recvRtpCapabilities))throw new i.UnsupportedError("cannot consume this Producer");const q=new _({id:R,producerId:S,kind:b,rtpParameters:$,streamId:E,onRtpReceiver:M,appData:Z});return this._pendingConsumerTasks.push(q),queueMicrotask(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),q.promise})}produceData(){return H(this,arguments,function*({ordered:C=!0,maxPacketLifeTime:R,maxRetransmits:S,label:b="",protocol:x="",appData:E={}}={}){if(f.debug("produceData()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="send")throw new i.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(E&&typeof E!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError("SCTP not enabled by remote Transport");return(R||S)&&(C=!1),this._awaitQueue.push(()=>H(this,null,function*(){const{dataChannel:M,sctpStreamParameters:Z}=yield this._handler.sendDataChannel({ordered:C,maxPacketLifeTime:R,maxRetransmits:S,label:b,protocol:x});o.validateSctpStreamParameters(Z);const{id:$}=yield new Promise((q,X)=>{this.safeEmit("producedata",{sctpStreamParameters:Z,label:b,protocol:x,appData:E},q,X)}),z=new h.DataProducer({id:$,dataChannel:M,sctpStreamParameters:Z,appData:E});return this._dataProducers.set(z.id,z),this.handleDataProducer(z),this._observer.safeEmit("newdataproducer",z),z}),"transport.produceData()")})}consumeData(C){return H(this,arguments,function*({id:R,dataProducerId:S,sctpStreamParameters:b,label:x="",protocol:E="",appData:M={}}){if(f.debug("consumeData()"),this._closed)throw new i.InvalidStateError("closed");if(this._direction!=="recv")throw new i.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof R!="string")throw new TypeError("missing id");if(typeof S!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(M&&typeof M!="object")throw new TypeError("if given, appData must be an object")}else throw new i.UnsupportedError("SCTP not enabled by remote Transport");const Z=a.clone(b);return o.validateSctpStreamParameters(Z),this._awaitQueue.push(()=>H(this,null,function*(){const{dataChannel:$}=yield this._handler.receiveDataChannel({sctpStreamParameters:Z,label:x,protocol:E}),z=new v.DataConsumer({id:R,dataProducerId:S,dataChannel:$,sctpStreamParameters:Z,appData:M});return this._dataConsumers.set(z.id,z),this.handleDataConsumer(z),this._observer.safeEmit("newdataconsumer",z),z}),"transport.consumeData()")})}createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingConsumerTasks.length===0){f.debug("createPendingConsumers() | there is no Consumer to be created");return}const C=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let R;const S=[];for(const b of C){const{id:x,kind:E,rtpParameters:M,streamId:Z,onRtpReceiver:$}=b.consumerOptions;S.push({trackId:x,kind:E,rtpParameters:M,streamId:Z,onRtpReceiver:$})}try{const b=yield this._handler.receive(S);for(let x=0;x<b.length;++x){const E=C[x],M=b[x],{id:Z,producerId:$,kind:z,rtpParameters:q,appData:X}=E.consumerOptions,{localId:K,rtpReceiver:ee,track:oe}=M,ce=new p.Consumer({id:Z,localId:K,producerId:$,rtpReceiver:ee,track:oe,rtpParameters:q,appData:X});this._consumers.set(ce.id,ce),this.handleConsumer(ce),!this._probatorConsumerCreated&&!R&&z==="video"&&(R=ce),this._observer.safeEmit("newconsumer",ce),E.resolve(ce)}}catch(b){for(const x of C)x.reject(b)}if(R)try{const b=o.generateProbatorRtpParameters(R.rtpParameters);yield this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:b}]),f.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(b){f.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",b)}}),"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingPauseConsumers.size===0){f.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const C=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const R=C.map(S=>S.localId);yield this._handler.pauseReceiving(R)}catch(R){f.error("pausePendingConsumers() | failed to pause Consumers:",R)}}),"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingResumeConsumers.size===0){f.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const C=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const R=C.map(S=>S.localId);yield this._handler.resumeReceiving(R)}catch(R){f.error("resumePendingConsumers() | failed to resume Consumers:",R)}}),"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(()=>H(this,null,function*(){if(this._pendingCloseConsumers.size===0){f.debug("closePendingConsumers() | there is no Consumer to be closed");return}const C=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{yield this._handler.stopReceiving(C.map(R=>R.localId))}catch(R){f.error("closePendingConsumers() | failed to close Consumers:",R)}}),"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const C=this._handler;C.on("@connect",({dtlsParameters:R},S,b)=>{if(this._closed){b(new i.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:R},S,b)}),C.on("@icegatheringstatechange",R=>{R!==this._iceGatheringState&&(f.debug("ICE gathering state changed to %s",R),this._iceGatheringState=R,this._closed||this.safeEmit("icegatheringstatechange",R))}),C.on("@icecandidateerror",R=>{f.warn(`ICE candidate error [url:${R.url}, localAddress:${R.address}, localPort:${R.port}]: ${R.errorCode} "${R.errorText}"`),this.safeEmit("icecandidateerror",R)}),C.on("@connectionstatechange",R=>{R!==this._connectionState&&(f.debug("connection state changed to %s",R),this._connectionState=R,this._closed||this.safeEmit("connectionstatechange",R))})}handleProducer(C){C.on("@close",()=>{this._producers.delete(C.id),!this._closed&&this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.stopSending(C.localId)}),"producer @close event").catch(R=>f.warn("producer.close() failed:%o",R))}),C.on("@pause",(R,S)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.pauseSending(C.localId)}),"producer @pause event").then(R).catch(S)}),C.on("@resume",(R,S)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.resumeSending(C.localId)}),"producer @resume event").then(R).catch(S)}),C.on("@replacetrack",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.replaceTrack(C.localId,R)}),"producer @replacetrack event").then(S).catch(b)}),C.on("@setmaxspatiallayer",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.setMaxSpatialLayer(C.localId,R)}),"producer @setmaxspatiallayer event").then(S).catch(b)}),C.on("@setrtpencodingparameters",(R,S,b)=>{this._awaitQueue.push(()=>H(this,null,function*(){return yield this._handler.setRtpEncodingParameters(C.localId,R)}),"producer @setrtpencodingparameters event").then(S).catch(b)}),C.on("@getstats",(R,S)=>{if(this._closed)return S(new i.InvalidStateError("closed"));this._handler.getSenderStats(C.localId).then(R).catch(S)})}handleConsumer(C){C.on("@close",()=>{this._consumers.delete(C.id),this._pendingPauseConsumers.delete(C.id),this._pendingResumeConsumers.delete(C.id),!this._closed&&(this._pendingCloseConsumers.set(C.id,C),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),C.on("@pause",()=>{this._pendingResumeConsumers.has(C.id)&&this._pendingResumeConsumers.delete(C.id),this._pendingPauseConsumers.set(C.id,C),queueMicrotask(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),C.on("@resume",()=>{this._pendingPauseConsumers.has(C.id)&&this._pendingPauseConsumers.delete(C.id),this._pendingResumeConsumers.set(C.id,C),queueMicrotask(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),C.on("@getstats",(R,S)=>{if(this._closed)return S(new i.InvalidStateError("closed"));this._handler.getReceiverStats(C.localId).then(R).catch(S)})}handleDataProducer(C){C.on("@close",()=>{this._dataProducers.delete(C.id)})}handleDataConsumer(C){C.on("@close",()=>{this._dataConsumers.delete(C.id)})}};e.Transport=w}}),qo=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/scalabilityModes.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.parse=n;var t=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function n(r){const i=t.exec(r??"");return i?{spatialLayers:Number(i[1]),temporalLayers:Number(i[2])}:{spatialLayers:1,temporalLayers:1}}}}),xl=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/commonUtils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.extractRtpCapabilities=n,e.extractDtlsParameters=r,e.getCname=i,e.applyCodecParameters=a;var t=Fi();function n({sdpObject:o}){var u,p,h;const v=new Map,f=new Map;for(const w of o.media){const C=w.type;switch(C){case"audio":case"video":break;default:continue}for(const R of w.rtp){const S={kind:C,mimeType:`${C}/${R.codec}`,preferredPayloadType:R.payload,clockRate:R.rate,channels:R.encoding,parameters:{},rtcpFeedback:[]};v.set(S.preferredPayloadType,S)}for(const R of(u=w.fmtp)!=null?u:[]){const S=t.parseParams(R.config),b=v.get(R.payload);b&&(S!=null&&S.hasOwnProperty("profile-level-id")&&(S["profile-level-id"]=String(S["profile-level-id"])),b.parameters=S)}for(const R of(p=w.rtcpFb)!=null?p:[]){const S={type:R.type,parameter:R.subtype};if(S.parameter||delete S.parameter,R.payload!=="*"){const b=v.get(Number(R.payload));if(!b)continue;b.rtcpFeedback.push(S)}else for(const b of v.values())b.kind===C&&!/.+\/rtx$/i.test(b.mimeType)&&b.rtcpFeedback.push(S)}for(const R of(h=w.ext)!=null?h:[]){if(R["encrypt-uri"])continue;const S={kind:C,uri:R.uri,preferredId:R.value};f.set(S.preferredId,S)}}return{codecs:Array.from(v.values()),headerExtensions:Array.from(f.values())}}function r({sdpObject:o}){var u;let p=o.setup,h=o.fingerprint;if(!p||!h){const _=((u=o.media)!=null?u:[]).find(w=>w.port!==0);_&&(p??(p=_.setup),h??(h=_.fingerprint))}if(p){if(!h)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let v;switch(p){case"active":{v="client";break}case"passive":{v="server";break}case"actpass":{v="auto";break}}return{role:v,fingerprints:[{algorithm:h.type,value:h.hash}]}}function i({offerMediaObject:o}){var u;const p=((u=o.ssrcs)!=null?u:[]).find(h=>h.attribute==="cname");return p?p.value:""}function a({offerRtpParameters:o,answerMediaObject:u}){var p,h,v;for(const f of o.codecs){const _=f.mimeType.toLowerCase();if(_!=="audio/opus"||!((p=u.rtp)!=null?p:[]).find(S=>S.payload===f.payloadType))continue;u.fmtp=(h=u.fmtp)!=null?h:[];let C=u.fmtp.find(S=>S.payload===f.payloadType);C||(C={payload:f.payloadType,config:""},u.fmtp.push(C));const R=t.parseParams(C.config);switch(_){case"audio/opus":{const S=(v=f.parameters)==null?void 0:v["sprop-stereo"];S!==void 0&&(R.stereo=Number(S)?1:0);break}}C.config="";for(const S of Object.keys(R))C.config&&(C.config+=";"),C.config+=`${S}=${R[S]}`}}}}),Cl=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/unifiedPlanUtils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.getRtpEncodings=t,e.addLegacySimulcast=n;function t({offerMediaObject:r}){var i,a;const o=new Set;for(const h of(i=r.ssrcs)!=null?i:[]){const v=h.id;v&&o.add(v)}if(o.size===0)throw new Error("no a=ssrc lines found");const u=new Map;for(const h of(a=r.ssrcGroups)!=null?a:[]){if(h.semantics!=="FID")continue;const v=h.ssrcs.split(/\s+/),f=Number(v[0]),_=Number(v[1]);o.has(f)&&(o.delete(f),o.delete(_),u.set(f,_))}for(const h of o)u.set(h,void 0);const p=[];for(const[h,v]of u){const f={ssrc:h};v&&(f.rtx={ssrc:v}),p.push(f)}return p}function n({offerMediaObject:r,numStreams:i}){var a,o,u;if(i<=1)throw new TypeError("numStreams must be greater than 1");const p=((a=r.ssrcs)!=null?a:[]).find(b=>b.attribute==="msid");if(!p)throw new Error("a=ssrc line with msid information not found");const[h,v]=p.value.split(" "),f=Number(p.id);let _;((o=r.ssrcGroups)!=null?o:[]).some(b=>{if(b.semantics!=="FID")return!1;const x=b.ssrcs.split(/\s+/);return Number(x[0])===f?(_=Number(x[1]),!0):!1});const w=((u=r.ssrcs)!=null?u:[]).find(b=>b.attribute==="cname");if(!w)throw new Error("a=ssrc line with cname information not found");const C=w.value,R=[],S=[];for(let b=0;b<i;++b)R.push(f+b),_&&S.push(_+b);r.ssrcGroups=[],r.ssrcs=[],r.ssrcGroups.push({semantics:"SIM",ssrcs:R.join(" ")});for(const b of R)r.ssrcs.push({id:b,attribute:"cname",value:C}),r.ssrcs.push({id:b,attribute:"msid",value:`${h} ${v}`});for(let b=0;b<S.length;++b){const x=R[b],E=S[b];r.ssrcs.push({id:E,attribute:"cname",value:C}),r.ssrcs.push({id:E,attribute:"msid",value:`${h} ${v}`}),r.ssrcGroups.push({semantics:"FID",ssrcs:`${x} ${E}`})}}}}),Yd=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/ortc/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.addNackSupportForOpus=t;function t(n){var r,i;for(const a of(r=n.codecs)!=null?r:[])(a.mimeType.toLowerCase()==="audio/opus"||a.mimeType.toLowerCase()==="audio/multiopus")&&!((i=a.rtcpFeedback)!=null&&i.some(o=>o.type==="nack"&&!o.parameter))&&(a.rtcpFeedback||(a.rtcpFeedback=[]),a.rtcpFeedback.push({type:"nack"}))}}}),E3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/MediaSection.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.OfferMediaSection=e.AnswerMediaSection=e.MediaSection=void 0;var t=Fi(),n=Vo(),r=class{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h}){ge(this,"_mediaObject");var v;if(this._mediaObject={type:"",port:0,protocol:"",payloads:"",rtp:[],fmtp:[]},u&&this.setIceParameters(u),p){this._mediaObject.candidates=[];for(const f of p){const _={foundation:f.foundation,component:1,ip:(v=f.address)!=null?v:f.ip,port:f.port,priority:f.priority,transport:f.protocol,type:f.type};f.tcpType&&(_.tcptype=f.tcpType),this._mediaObject.candidates.push(_)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}h&&this.setDtlsRole(h.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(u){this._mediaObject.iceUfrag=u.usernameFragment,this._mediaObject.icePwd=u.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}};e.MediaSection=r;var i=class extends r{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:v,plainRtpParameters:f,offerMediaObject:_,offerRtpParameters:w,answerRtpParameters:C,codecOptions:R}){var S,b,x,E,M;switch(super({iceParameters:u,iceCandidates:p,dtlsParameters:h}),this._mediaObject.mid=String(_.mid),this._mediaObject.type=_.type,this._mediaObject.protocol=_.protocol,f?(this._mediaObject.connection={ip:f.ip,version:f.ipVersion},this._mediaObject.port=f.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),_.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const Z of C.codecs){const $={payload:Z.payloadType,codec:o(Z),rate:Z.clockRate};Z.channels>1&&($.encoding=Z.channels),this._mediaObject.rtp.push($);const z=(S=n.clone(Z.parameters))!=null?S:{};let q=(b=n.clone(Z.rtcpFeedback))!=null?b:[];if(R){const{opusStereo:K,opusFec:ee,opusDtx:oe,opusMaxPlaybackRate:ce,opusMaxAverageBitrate:ne,opusPtime:Te,opusNack:ye,videoGoogleStartBitrate:ue,videoGoogleMaxBitrate:me,videoGoogleMinBitrate:_e}=R,ke=w.codecs.find(le=>le.payloadType===Z.payloadType);switch(Z.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{K!==void 0&&(ke.parameters["sprop-stereo"]=K?1:0,z.stereo=K?1:0),ee!==void 0&&(ke.parameters.useinbandfec=ee?1:0,z.useinbandfec=ee?1:0),oe!==void 0&&(ke.parameters.usedtx=oe?1:0,z.usedtx=oe?1:0),ce!==void 0&&(z.maxplaybackrate=ce),ne!==void 0&&(z.maxaveragebitrate=ne),Te!==void 0&&(ke.parameters.ptime=Te,z.ptime=Te),ye||(ke.rtcpFeedback=ke.rtcpFeedback.filter(le=>le.type!=="nack"||le.parameter),q=q.filter(le=>le.type!=="nack"||le.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":case"video/av1":{ue!==void 0&&(z["x-google-start-bitrate"]=ue),me!==void 0&&(z["x-google-max-bitrate"]=me),_e!==void 0&&(z["x-google-min-bitrate"]=_e);break}}}const X={payload:Z.payloadType,config:""};for(const K of Object.keys(z))X.config&&(X.config+=";"),X.config+=`${K}=${z[K]}`;X.config&&this._mediaObject.fmtp.push(X);for(const K of q)this._mediaObject.rtcpFb.push({payload:Z.payloadType,type:K.type,subtype:K.parameter})}this._mediaObject.payloads=C.codecs.map(Z=>Z.payloadType).join(" "),this._mediaObject.ext=[];for(const Z of C.headerExtensions)((x=_.ext)!=null?x:[]).some(z=>z.uri===Z.uri)&&this._mediaObject.ext.push({uri:Z.uri,value:Z.id});if(_.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),_.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:_.simulcast.list1},this._mediaObject.rids=[];for(const Z of(E=_.rids)!=null?E:[])Z.direction==="send"&&this._mediaObject.rids.push({id:Z.id,direction:"recv"})}else if(_.simulcast_03){this._mediaObject.simulcast_03={value:_.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const Z of(M=_.rids)!=null?M:[])Z.direction==="send"&&this._mediaObject.rids.push({id:Z.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";break}case"application":{typeof _.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=v.port,this._mediaObject.maxMessageSize=v.maxMessageSize):_.sctpmap&&(this._mediaObject.payloads=String(v.port),this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:v.port,maxMessageSize:v.maxMessageSize});break}}}setDtlsRole(u){switch(u){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(u){var p,h;if(!((p=this._mediaObject.simulcast)!=null&&p.list1))return;const v={};for(const w of u)w.rid&&(v[w.rid]=w);const f=this._mediaObject.simulcast.list1,_=t.parseSimulcastStreamList(f);for(const w of _)for(const C of w)C.paused=!((h=v[C.scid])!=null&&h.active);this._mediaObject.simulcast.list1=_.map(w=>w.map(C=>`${C.paused?"~":""}${C.scid}`).join(",")).join(";")}};e.AnswerMediaSection=i;var a=class extends r{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:v,plainRtpParameters:f,mid:_,kind:w,offerRtpParameters:C,streamId:R,trackId:S}){var b,x;switch(super({iceParameters:u,iceCandidates:p,dtlsParameters:h}),this._mediaObject.mid=String(_),this._mediaObject.type=w,f?(this._mediaObject.connection={ip:f.ip,version:f.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=f.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},v?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),this._mediaObject.extmapAllowMixed="extmap-allow-mixed",w){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._mediaObject.msid=`${R??"-"} ${S}`;for(const $ of C.codecs){const z={payload:$.payloadType,codec:o($),rate:$.clockRate};$.channels>1&&(z.encoding=$.channels),this._mediaObject.rtp.push(z);const q={payload:$.payloadType,config:""};for(const X of Object.keys((b=$.parameters)!=null?b:{}))q.config&&(q.config+=";"),q.config+=`${X}=${$.parameters[X]}`;q.config&&this._mediaObject.fmtp.push(q);for(const X of $.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:$.payloadType,type:X.type,subtype:X.parameter})}this._mediaObject.payloads=C.codecs.map($=>$.payloadType).join(" "),this._mediaObject.ext=[];for(const $ of C.headerExtensions)this._mediaObject.ext.push({uri:$.uri,value:$.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const E=C.encodings[0],M=E.ssrc,Z=(x=E.rtx)==null?void 0:x.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],M&&C.rtcp.cname&&this._mediaObject.ssrcs.push({id:M,attribute:"cname",value:C.rtcp.cname}),Z&&(C.rtcp.cname&&this._mediaObject.ssrcs.push({id:Z,attribute:"cname",value:C.rtcp.cname}),M&&this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${M} ${Z}`}));break}case"application":{this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=v.port,this._mediaObject.maxMessageSize=v.maxMessageSize;break}}}setDtlsRole(u){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}};e.OfferMediaSection=a;function o(u){const h=new RegExp("^(audio|video)/(.+)","i").exec(u.mimeType);if(!h)throw new TypeError("invalid codec.mimeType");return h[2]}}}),El=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/sdp/RemoteSdp.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.RemoteSdp=void 0;var t=Fi(),n=Ur(),r=E3(),i=["av1","h264"],a=new n.Logger("RemoteSdp"),o=class{constructor({iceParameters:u,iceCandidates:p,dtlsParameters:h,sctpParameters:v,plainRtpParameters:f}){if(ge(this,"_iceParameters"),ge(this,"_iceCandidates"),ge(this,"_dtlsParameters"),ge(this,"_sctpParameters"),ge(this,"_plainRtpParameters"),ge(this,"_mediaSections",[]),ge(this,"_midToIndex",new Map),ge(this,"_firstMid"),ge(this,"_sdpObject"),this._iceParameters=u,this._iceCandidates=p,this._dtlsParameters=h,this._sctpParameters=v,this._plainRtpParameters=f,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:"10000",sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},u!=null&&u.iceLite&&(this._sdpObject.icelite="ice-lite"),h){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const _=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:h.fingerprints[_-1].algorithm,hash:h.fingerprints[_-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}f&&(this._sdpObject.origin.address=f.ip,this._sdpObject.origin.ipVer=f.ipVersion)}updateIceParameters(u){a.debug("updateIceParameters() [iceParameters:%o]",u),this._iceParameters=u,this._sdpObject.icelite=u.iceLite?"ice-lite":void 0;for(const p of this._mediaSections)p.setIceParameters(u)}updateDtlsRole(u){a.debug("updateDtlsRole() [role:%s]",u),this._dtlsParameters.role=u;for(const p of this._mediaSections)p.setDtlsRole(u)}setSessionExtmapAllowMixed(){a.debug("setSessionExtmapAllowMixed()"),this._sdpObject.extmapAllowMixed="extmap-allow-mixed"}getNextMediaSectionIdx(){for(let u=0;u<this._mediaSections.length;++u){const p=this._mediaSections[u];if(p.closed)return{idx:u,reuseMid:p.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:u,reuseMid:p,offerRtpParameters:h,answerRtpParameters:v,codecOptions:f}){var _;const w=new r.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:u,offerRtpParameters:h,answerRtpParameters:v,codecOptions:f}),C=w.getObject();C.rtp.find(S=>i.includes(S.codec.toLowerCase()))||(C.ext=(_=C.ext)==null?void 0:_.filter(S=>S.uri!=="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension")),p?this._replaceMediaSection(w,p):this._midToIndex.has(w.mid)?this._replaceMediaSection(w):this._addMediaSection(w)}receive({mid:u,kind:p,offerRtpParameters:h,streamId:v,trackId:f}){this.setSessionExtmapAllowMixed();const _=new r.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,mid:u,kind:p,offerRtpParameters:h,streamId:v,trackId:f}),w=this._mediaSections.find(C=>C.closed);w?this._replaceMediaSection(_,w.mid):this._addMediaSection(_)}pauseMediaSection(u){this._findMediaSection(u).pause()}resumeSendingMediaSection(u){this._findMediaSection(u).resume()}resumeReceivingMediaSection(u){this._findMediaSection(u).resume()}disableMediaSection(u){this._findMediaSection(u).disable()}closeMediaSection(u){const p=this._findMediaSection(u);return u===this._firstMid?(a.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",u),this.disableMediaSection(u),!1):(p.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(u,p){const h=this._findMediaSection(u);h.muxSimulcastStreams(p),this._replaceMediaSection(h)}sendSctpAssociation({offerMediaObject:u}){const p=new r.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:u});this._addMediaSection(p)}receiveSctpAssociation(){const u=new r.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application"});this._addMediaSection(u)}getSdp(){return this._sdpObject.origin.sessionVersion++,t.write(this._sdpObject)}_addMediaSection(u){this._firstMid||(this._firstMid=u.mid),this._mediaSections.push(u),this._midToIndex.set(u.mid,this._mediaSections.length-1),this._sdpObject.media.push(u.getObject()),this._regenerateBundleMids()}_replaceMediaSection(u,p){if(typeof p=="string"){const h=this._midToIndex.get(p);if(h===void 0)throw new Error(`no media section found for reuseMid '${p}'`);const v=this._mediaSections[h];this._mediaSections[h]=u,this._midToIndex.delete(v.mid),this._midToIndex.set(u.mid,h),this._sdpObject.media[h]=u.getObject(),this._regenerateBundleMids()}else{const h=this._midToIndex.get(u.mid);if(h===void 0)throw new Error(`no media section found with mid '${u.mid}'`);this._mediaSections[h]=u,this._sdpObject.media[h]=u.getObject()}}_findMediaSection(u){const p=this._midToIndex.get(u);if(p===void 0)throw new Error(`no media section found with mid '${u}'`);return this._mediaSections[p]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(u=>!u.closed).map(u=>u.mid).join(" "))}};e.RemoteSdp=o}}),P3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Chrome111.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome111=void 0;var t=Fi(),n=Jr(),r=Ur(),i=xs(),a=Di(),o=qo(),u=xl(),p=Cl(),h=Yd(),v=El(),f=new r.Logger("Chrome111"),_="Chrome111",w={OS:1024,MIS:1024},C=class Ru extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),ge(this,"_closed",!1),ge(this,"_direction"),ge(this,"_remoteSdp"),ge(this,"_getSendExtendedRtpCapabilities"),ge(this,"_forcedLocalDtlsRole"),ge(this,"_pc"),ge(this,"_mapMidTransceiver",new Map),ge(this,"_sendStream",new MediaStream),ge(this,"_hasDataChannelMediaSection",!1),ge(this,"_nextSendSctpStreamId",0),ge(this,"_transportReady",!1),ge(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),ge(this,"onIceCandidateError",X=>{this.emit("@icecandidateerror",X)}),ge(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),ge(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new v.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Ru(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video",{sendEncodings:[{scalabilityMode:"L3T3"}]});const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Ru.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=u.extractRtpCapabilities({sdpObject:S});return h.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $;if(this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1){let me=1;for(const _e of x){const ke=_e.scalabilityMode?(0,o.parse)(_e.scalabilityMode).temporalLayers:3;ke>me&&(me=ke)}x.forEach((_e,ke)=>{_e.rid=`r${ke}`,_e.scalabilityMode=`L1T${me}`})}const z=this._remoteSdp.getNextMediaSectionIdx(),q=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});Z&&Z(q.sender);const X=yield this._pc.createOffer();let K=t.parse(X.sdp);K.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const ee=Ru.getLocalRtpCapabilities(K),oe=this._getSendExtendedRtpCapabilities(ee),ce=i.getSendingRtpParameters(b.kind,oe);ce.codecs=i.reduceCodecs(ce.codecs,M);const ne=i.getSendingRemoteRtpParameters(b.kind,oe);ne.codecs=i.reduceCodecs(ne.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:K})),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",X),yield this._pc.setLocalDescription(X);const Te=q.mid;ce.mid=Te,K=t.parse(this._pc.localDescription.sdp);const ye=K.media[z.idx];if(ce.rtcp.cname=u.getCname({offerMediaObject:ye}),!x)ce.encodings=p.getRtpEncodings({offerMediaObject:ye});else if(x.length===1){const me=p.getRtpEncodings({offerMediaObject:ye});Object.assign(me[0],x[0]),ce.encodings=me}else ce.encodings=x;this._remoteSdp.send({offerMediaObject:ye,reuseMid:z.reuseMid,offerRtpParameters:ce,answerRtpParameters:ne,codecOptions:E});const ue={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",ue),yield this._pc.setRemoteDescription(ue),this._mapMidTransceiver.set(Te,q),{localId:Te,rtpParameters:ce,rtpSender:q.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),f.debug("stopSending() [localId:%s]",S),this._closed)return;const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),oe=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:oe});const ce={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ce),yield this._pc.setRemoteDescription(ce),this._hasDataChannelMediaSection=!0}const X={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:X}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:X,kind:K,rtpParameters:ee,streamId:oe}=q;f.debug("receive() [trackId:%s, kind:%s]",X,K);const ce=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(X,ce),this._remoteSdp.receive({mid:ce,kind:K,offerRtpParameters:ee,streamId:oe??ee.rtcp.cname,trackId:X})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:X,onRtpReceiver:K}=q;if(K){const ee=M.get(X),oe=this._pc.getTransceivers().find(ce=>ce.mid===ee);if(!oe)throw new Error("transceiver not found");K(oe.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:X,rtpParameters:K}=q,ee=M.get(X),oe=z.media.find(ce=>String(ce.mid)===ee);u.applyCodecParameters({offerRtpParameters:K,answerMediaObject:oe})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:X}=q,K=M.get(X),ee=this._pc.getTransceivers().find(oe=>oe.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,X={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",X);const K=this._pc.createDataChannel(x,X);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const oe=yield this._pc.createAnswer();if(!this._transportReady){const ce=t.parse(oe.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:ce})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",oe),yield this._pc.setLocalDescription(oe),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=u.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Chrome111=C}}),k3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Chrome74.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Chrome74=void 0;var t=Fi(),n=Ur(),r=Jr(),i=xs(),a=Di(),o=qo(),u=xl(),p=Cl(),h=Yd(),v=El(),f=new n.Logger("Chrome74"),_="Chrome74",w={OS:1024,MIS:1024},C=class Au extends r.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),ge(this,"_closed",!1),ge(this,"_direction"),ge(this,"_remoteSdp"),ge(this,"_getSendExtendedRtpCapabilities"),ge(this,"_forcedLocalDtlsRole"),ge(this,"_pc"),ge(this,"_mapMidTransceiver",new Map),ge(this,"_sendStream",new MediaStream),ge(this,"_hasDataChannelMediaSection",!1),ge(this,"_nextSendSctpStreamId",0),ge(this,"_transportReady",!1),ge(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),ge(this,"onIceCandidateError",X=>{this.emit("@icecandidateerror",X)}),ge(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),ge(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new v.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Au(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Au.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=u.extractRtpCapabilities({sdpObject:S});return h.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M}){var Z;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1&&x.forEach((_e,ke)=>{_e.rid=`r${ke}`});const $=this._remoteSdp.getNextMediaSectionIdx(),z=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});let q=yield this._pc.createOffer(),X=t.parse(q.sdp);X.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const K=Au.getLocalRtpCapabilities(X),ee=this._getSendExtendedRtpCapabilities(K),oe=i.getSendingRtpParameters(b.kind,ee);oe.codecs=i.reduceCodecs(oe.codecs,M);const ce=i.getSendingRemoteRtpParameters(b.kind,ee);ce.codecs=i.reduceCodecs(ce.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:(Z=this._forcedLocalDtlsRole)!=null?Z:"client",localSdpObject:X}));let ne=!1;const Te=(0,o.parse)((x??[{}])[0].scalabilityMode);let ye;x&&x.length===1&&Te.spatialLayers>1&&oe.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),ne=!0,X=t.parse(q.sdp),ye=X.media[$.idx],p.addLegacySimulcast({offerMediaObject:ye,numStreams:Te.spatialLayers}),q={type:"offer",sdp:t.write(X)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",q),yield this._pc.setLocalDescription(q);const ue=z.mid;if(oe.mid=ue,X=t.parse(this._pc.localDescription.sdp),ye=X.media[$.idx],oe.rtcp.cname=u.getCname({offerMediaObject:ye}),!x)oe.encodings=p.getRtpEncodings({offerMediaObject:ye});else if(x.length===1){let _e=p.getRtpEncodings({offerMediaObject:ye});Object.assign(_e[0],x[0]),ne&&(_e=[_e[0]]),oe.encodings=_e}else oe.encodings=x;if(oe.encodings.length>1&&(oe.codecs[0].mimeType.toLowerCase()==="video/vp8"||oe.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const _e of oe.encodings)_e.scalabilityMode?_e.scalabilityMode=`L1T${Te.temporalLayers}`:_e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:ye,reuseMid:$.reuseMid,offerRtpParameters:oe,answerRtpParameters:ce,codecOptions:E});const me={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",me),yield this._pc.setRemoteDescription(me),this._mapMidTransceiver.set(ue,z),{localId:ue,rtpParameters:oe,rtpSender:z.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),f.debug("stopSending() [localId:%s]",S),this._closed)return;const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),oe=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:oe});const ce={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ce),yield this._pc.setRemoteDescription(ce),this._hasDataChannelMediaSection=!0}const X={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:X}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:X,kind:K,rtpParameters:ee,streamId:oe}=q;f.debug("receive() [trackId:%s, kind:%s]",X,K);const ce=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(X,ce),this._remoteSdp.receive({mid:ce,kind:K,offerRtpParameters:ee,streamId:oe??ee.rtcp.cname,trackId:X})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:X,rtpParameters:K}=q,ee=M.get(X),oe=z.media.find(ce=>String(ce.mid)===ee);u.applyCodecParameters({offerRtpParameters:K,answerMediaObject:oe})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:X}=q,K=M.get(X),ee=this._pc.getTransceivers().find(oe=>oe.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,X={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",X);const K=this._pc.createDataChannel(x,X);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const oe=yield this._pc.createAnswer();if(!this._transportReady){const ce=t.parse(oe.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:ce})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",oe),yield this._pc.setLocalDescription(oe),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=u.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Chrome74=C}}),T3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Firefox120.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Firefox120=void 0;var t=Fi(),n=Jr(),r=Ur(),i=Di(),a=xs(),o=qo(),u=xl(),p=Cl(),h=El(),v=new r.Logger("Firefox120"),f="Firefox120",_={OS:16,MIS:2048},w=class Iu extends n.EnhancedEventEmitter{constructor({direction:R,iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E,iceServers:M,iceTransportPolicy:Z,additionalSettings:$,getSendExtendedRtpCapabilities:z}){super(),ge(this,"_closed",!1),ge(this,"_direction"),ge(this,"_remoteSdp"),ge(this,"_getSendExtendedRtpCapabilities"),ge(this,"_pc"),ge(this,"_mapMidTransceiver",new Map),ge(this,"_sendStream",new MediaStream),ge(this,"_hasDataChannelMediaSection",!1),ge(this,"_nextSendSctpStreamId",0),ge(this,"_transportReady",!1),ge(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),ge(this,"onIceCandidateError",q=>{this.emit("@icecandidateerror",q)}),ge(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),ge(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),v.debug("constructor()"),this._direction=R,this._remoteSdp=new h.RemoteSdp({iceParameters:S,iceCandidates:b,dtlsParameters:x,sctpParameters:E}),this._getSendExtendedRtpCapabilities=z,this._pc=new RTCPeerConnection(ie({iceServers:M??[],iceTransportPolicy:Z??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},$)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(v.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:f,factory:R=>new Iu(R),getNativeRtpCapabilities:()=>H(null,null,function*(){v.debug("getNativeRtpCapabilities()");let R=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});const S=document.createElement("canvas");S.getContext("2d");const x=S.captureStream().getVideoTracks()[0];try{R.addTransceiver("audio",{direction:"sendrecv"}),R.addTransceiver(x,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const E=yield R.createOffer();try{S.remove()}catch{}try{x.stop()}catch{}try{R.close()}catch{}R=void 0;const M=t.parse(E.sdp);return Iu.getLocalRtpCapabilities(M)}catch(E){try{S.remove()}catch{}try{x.stop()}catch{}try{R==null||R.close()}catch{}throw R=void 0,E}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return v.debug("getNativeSctpCapabilities()"),{numStreams:_}})}}static getLocalRtpCapabilities(R){return u.extractRtpCapabilities({sdpObject:R})}get name(){return f}close(){if(v.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(R){return H(this,null,function*(){throw this.assertNotClosed(),new i.UnsupportedError("not supported")})}restartIce(R){return H(this,null,function*(){if(this.assertNotClosed(),v.debug("restartIce()"),this._remoteSdp.updateIceParameters(R),!!this._transportReady)if(this._direction==="send"){const S=yield this._pc.createOffer({iceRestart:!0});v.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",S),yield this._pc.setLocalDescription(S);const b={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",b),yield this._pc.setRemoteDescription(b)}else{const S={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();v.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(R){return H(this,arguments,function*({track:S,encodings:b,codecOptions:x,codec:E,onRtpSender:M}){this.assertNotClosed(),this.assertSendDirection(),v.debug("send() [kind:%s, track.id:%s]",S.kind,S.id),b&&b.length>1&&b.forEach((ye,ue)=>{ye.rid=`r${ue}`});const Z=this._pc.addTransceiver(S,{direction:"sendonly",streams:[this._sendStream],sendEncodings:b});M&&M(Z.sender);const $=yield this._pc.createOffer();let z=t.parse($.sdp);z.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const q=Iu.getLocalRtpCapabilities(z),X=this._getSendExtendedRtpCapabilities(q),K=a.getSendingRtpParameters(S.kind,X);K.codecs=a.reduceCodecs(K.codecs,E);const ee=a.getSendingRemoteRtpParameters(S.kind,X);ee.codecs=a.reduceCodecs(ee.codecs,E),this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:z}));const oe=(0,o.parse)((b??[{}])[0].scalabilityMode);v.debug("send() | calling pc.setLocalDescription() [offer:%o]",$),yield this._pc.setLocalDescription($);const ce=Z.mid;K.mid=ce,z=t.parse(this._pc.localDescription.sdp);const ne=z.media[z.media.length-1];if(K.rtcp.cname=u.getCname({offerMediaObject:ne}),!b)K.encodings=p.getRtpEncodings({offerMediaObject:ne});else if(b.length===1){const ye=p.getRtpEncodings({offerMediaObject:ne});Object.assign(ye[0],b[0]),K.encodings=ye}else K.encodings=b;if(K.encodings.length>1&&(K.codecs[0].mimeType.toLowerCase()==="video/vp8"||K.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const ye of K.encodings)ye.scalabilityMode?ye.scalabilityMode=`L1T${oe.temporalLayers}`:ye.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:ne,offerRtpParameters:K,answerRtpParameters:ee,codecOptions:x});const Te={type:"answer",sdp:this._remoteSdp.getSdp()};return v.debug("send() | calling pc.setRemoteDescription() [answer:%o]",Te),yield this._pc.setRemoteDescription(Te),this._mapMidTransceiver.set(ce,Z),{localId:ce,rtpParameters:K,rtpSender:Z.sender}})}stopSending(R){return H(this,null,function*(){if(this.assertSendDirection(),v.debug("stopSending() [localId:%s]",R),this._closed)return;const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated transceiver not found");S.sender.replaceTrack(null),this._pc.removeTrack(S.sender),this._remoteSdp.disableMediaSection(S.mid);const b=yield this._pc.createOffer();v.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x),this._mapMidTransceiver.delete(R)})}pauseSending(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),v.debug("pauseSending() [localId:%s]",R);const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");S.direction="inactive",this._remoteSdp.pauseMediaSection(R);const b=yield this._pc.createOffer();v.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)})}resumeSending(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),v.debug("resumeSending() [localId:%s]",R);const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");S.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(R);const b=yield this._pc.createOffer();v.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)})}replaceTrack(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),S?v.debug("replaceTrack() [localId:%s, track.id:%s]",R,S.id):v.debug("replaceTrack() [localId:%s, no track]",R);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated RTCRtpTransceiver not found");yield b.sender.replaceTrack(S)})}setMaxSpatialLayer(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),v.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",R,S);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated transceiver not found");const x=b.sender.getParameters();x.encodings.forEach((Z,$)=>{$<=S?Z.active=!0:Z.active=!1}),yield b.sender.setParameters(x),this._remoteSdp.muxMediaSectionSimulcast(R,x.encodings);const E=yield this._pc.createOffer();v.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M)})}setRtpEncodingParameters(R,S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),v.debug("setRtpEncodingParameters() [localId:%s, params:%o]",R,S);const b=this._mapMidTransceiver.get(R);if(!b)throw new Error("associated RTCRtpTransceiver not found");const x=b.sender.getParameters();x.encodings.forEach((Z,$)=>{x.encodings[$]=ie(ie({},Z),S)}),yield b.sender.setParameters(x),this._remoteSdp.muxMediaSectionSimulcast(R,x.encodings);const E=yield this._pc.createOffer();v.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M)})}getSenderStats(R){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");return S.sender.getStats()})}sendDataChannel(R){return H(this,arguments,function*({ordered:S,maxPacketLifeTime:b,maxRetransmits:x,label:E,protocol:M}){this.assertNotClosed(),this.assertSendDirection();const Z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:S,maxPacketLifeTime:b,maxRetransmits:x,protocol:M};v.debug("sendDataChannel() [options:%o]",Z);const $=this._pc.createDataChannel(E,Z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%_.MIS,!this._hasDataChannelMediaSection){const q=yield this._pc.createOffer(),X=t.parse(q.sdp),K=X.media.find(oe=>oe.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:X})),v.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",q),yield this._pc.setLocalDescription(q),this._remoteSdp.sendSctpAssociation({offerMediaObject:K});const ee={type:"answer",sdp:this._remoteSdp.getSdp()};v.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ee),yield this._pc.setRemoteDescription(ee),this._hasDataChannelMediaSection=!0}const z={streamId:Z.id,ordered:Z.ordered,maxPacketLifeTime:Z.maxPacketLifeTime,maxRetransmits:Z.maxRetransmits};return{dataChannel:$,sctpStreamParameters:z}})}receive(R){return H(this,null,function*(){var S;this.assertNotClosed(),this.assertRecvDirection();const b=[],x=new Map;for(const $ of R){const{trackId:z,kind:q,rtpParameters:X,streamId:K}=$;v.debug("receive() [trackId:%s, kind:%s]",z,q);const ee=(S=X.mid)!=null?S:String(this._mapMidTransceiver.size);x.set(z,ee),this._remoteSdp.receive({mid:ee,kind:q,offerRtpParameters:X,streamId:K??X.rtcp.cname,trackId:z})}const E={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",E),yield this._pc.setRemoteDescription(E);for(const $ of R){const{trackId:z,onRtpReceiver:q}=$;if(q){const X=x.get(z),K=this._pc.getTransceivers().find(ee=>ee.mid===X);if(!K)throw new Error("transceiver not found");q(K.receiver)}}let M=yield this._pc.createAnswer();const Z=t.parse(M.sdp);for(const $ of R){const{trackId:z,rtpParameters:q}=$,X=x.get(z),K=Z.media.find(ee=>String(ee.mid)===X);u.applyCodecParameters({offerRtpParameters:q,answerMediaObject:K}),M={type:"answer",sdp:t.write(Z)}}this._transportReady||(yield this.setupTransport({localDtlsRole:"client",localSdpObject:Z})),v.debug("receive() | calling pc.setLocalDescription() [answer:%o]",M),yield this._pc.setLocalDescription(M);for(const $ of R){const{trackId:z}=$,q=x.get(z),X=this._pc.getTransceivers().find(K=>K.mid===q);if(!X)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(q,X),b.push({localId:q,track:X.receiver.track,rtpReceiver:X.receiver})}return b})}stopReceiving(R){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const x of R){v.debug("stopReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(E.mid)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();v.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b);for(const x of R)this._mapMidTransceiver.delete(x)})}pauseReceiving(R){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const x of R){v.debug("pauseReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");E.direction="inactive",this._remoteSdp.pauseMediaSection(x)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();v.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)})}resumeReceiving(R){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const x of R){v.debug("resumeReceiving() [localId:%s]",x);const E=this._mapMidTransceiver.get(x);if(!E)throw new Error("associated RTCRtpTransceiver not found");E.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(x)}const S={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",S),yield this._pc.setRemoteDescription(S);const b=yield this._pc.createAnswer();v.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",b),yield this._pc.setLocalDescription(b)})}getReceiverStats(R){return H(this,null,function*(){this.assertRecvDirection();const S=this._mapMidTransceiver.get(R);if(!S)throw new Error("associated RTCRtpTransceiver not found");return S.receiver.getStats()})}receiveDataChannel(R){return H(this,arguments,function*({sctpStreamParameters:S,label:b,protocol:x}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:E,ordered:M,maxPacketLifeTime:Z,maxRetransmits:$}=S,z={negotiated:!0,id:E,ordered:M,maxPacketLifeTime:Z,maxRetransmits:$,protocol:x};v.debug("receiveDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(b,z);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const X={type:"offer",sdp:this._remoteSdp.getSdp()};v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",X),yield this._pc.setRemoteDescription(X);const K=yield this._pc.createAnswer();if(!this._transportReady){const ee=t.parse(K.sdp);yield this.setupTransport({localDtlsRole:"client",localSdpObject:ee})}v.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",K),yield this._pc.setLocalDescription(K),this._hasDataChannelMediaSection=!0}return{dataChannel:q}})}setupTransport(R){return H(this,arguments,function*({localDtlsRole:S,localSdpObject:b}){b||(b=t.parse(this._pc.localDescription.sdp));const x=u.extractDtlsParameters({sdpObject:b});x.role=S,this._remoteSdp.updateDtlsRole(S==="client"?"server":"client"),yield new Promise((E,M)=>{this.safeEmit("@connect",{dtlsParameters:x},E,M)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new i.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Firefox120=w}}),R3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/Safari12.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Safari12=void 0;var t=Fi(),n=Jr(),r=Ur(),i=xs(),a=Di(),o=qo(),u=El(),p=xl(),h=Cl(),v=Yd(),f=new r.Logger("Safari12"),_="Safari12",w={OS:1024,MIS:1024},C=class Fu extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),ge(this,"_closed",!1),ge(this,"_direction"),ge(this,"_remoteSdp"),ge(this,"_getSendExtendedRtpCapabilities"),ge(this,"_forcedLocalDtlsRole"),ge(this,"_pc"),ge(this,"_mapMidTransceiver",new Map),ge(this,"_sendStream",new MediaStream),ge(this,"_hasDataChannelMediaSection",!1),ge(this,"_nextSendSctpStreamId",0),ge(this,"_transportReady",!1),ge(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),ge(this,"onIceCandidateError",X=>{this.emit("@icecandidateerror",X)}),ge(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),ge(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new u.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",X=>{this.emit("@icecandidateerror",X)}),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Fu(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Fu.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=p.extractRtpCapabilities({sdpObject:S});return v.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0;try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id);const z=this._remoteSdp.getNextMediaSectionIdx(),q=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream]});Z&&Z(q.sender);let X=yield this._pc.createOffer(),K=t.parse(X.sdp);K.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const ee=Fu.getLocalRtpCapabilities(K),oe=this._getSendExtendedRtpCapabilities(ee),ce=i.getSendingRtpParameters(b.kind,oe);ce.codecs=i.reduceCodecs(ce.codecs,M);const ne=i.getSendingRemoteRtpParameters(b.kind,oe);ne.codecs=i.reduceCodecs(ne.codecs,M);let Te;this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:K}));const ye=(0,o.parse)((x??[{}])[0].scalabilityMode);x&&x.length>1&&(f.debug("send() | enabling legacy simulcast"),K=t.parse(X.sdp),Te=K.media[z.idx],h.addLegacySimulcast({offerMediaObject:Te,numStreams:x.length}),X={type:"offer",sdp:t.write(K)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",X),yield this._pc.setLocalDescription(X);const ue=q.mid;if(ce.mid=ue,K=t.parse(this._pc.localDescription.sdp),Te=K.media[z.idx],ce.rtcp.cname=p.getCname({offerMediaObject:Te}),ce.encodings=h.getRtpEncodings({offerMediaObject:Te}),x)for(let _e=0;_e<ce.encodings.length;++_e)x[_e]&&Object.assign(ce.encodings[_e],x[_e]);if(ce.encodings.length>1&&(ce.codecs[0].mimeType.toLowerCase()==="video/vp8"||ce.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const _e of ce.encodings)_e.scalabilityMode?_e.scalabilityMode=`L1T${ye.temporalLayers}`:_e.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:Te,reuseMid:z.reuseMid,offerRtpParameters:ce,answerRtpParameters:ne,codecOptions:E});const me={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",me),yield this._pc.setRemoteDescription(me),this._mapMidTransceiver.set(ue,q),{localId:ue,rtpParameters:ce,rtpSender:q.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),this._closed)return;f.debug("stopSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(S);const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),oe=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:oe});const ce={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ce),yield this._pc.setRemoteDescription(ce),this._hasDataChannelMediaSection=!0}const X={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:X}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:X,kind:K,rtpParameters:ee,streamId:oe}=q;f.debug("receive() [trackId:%s, kind:%s]",X,K);const ce=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(X,ce),this._remoteSdp.receive({mid:ce,kind:K,offerRtpParameters:ee,streamId:oe??ee.rtcp.cname,trackId:X})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:X,onRtpReceiver:K}=q;if(K){const ee=M.get(X),oe=this._pc.getTransceivers().find(ce=>ce.mid===ee);if(!oe)throw new Error("transceiver not found");K(oe.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:X,rtpParameters:K}=q,ee=M.get(X),oe=z.media.find(ce=>String(ce.mid)===ee);p.applyCodecParameters({offerRtpParameters:K,answerMediaObject:oe})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:X}=q,K=M.get(X),ee=this._pc.getTransceivers().find(oe=>oe.mid===K);if(!ee)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver})}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,X={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",X);const K=this._pc.createDataChannel(x,X);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const oe=yield this._pc.createAnswer();if(!this._transportReady){const ce=t.parse(oe.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:ce})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",oe),yield this._pc.setLocalDescription(oe),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=p.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.Safari12=C}}),A3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/ReactNative106.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.ReactNative106=void 0;var t=Fi(),n=Jr(),r=Ur(),i=xs(),a=Di(),o=qo(),u=El(),p=xl(),h=Cl(),v=Yd(),f=new r.Logger("ReactNative106"),_="ReactNative106",w={OS:1024,MIS:1024},C=class Du extends n.EnhancedEventEmitter{constructor({direction:S,iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M,iceServers:Z,iceTransportPolicy:$,additionalSettings:z,getSendExtendedRtpCapabilities:q}){super(),ge(this,"_closed",!1),ge(this,"_direction"),ge(this,"_remoteSdp"),ge(this,"_getSendExtendedRtpCapabilities"),ge(this,"_forcedLocalDtlsRole"),ge(this,"_pc"),ge(this,"_mapMidTransceiver",new Map),ge(this,"_sendStream",new MediaStream),ge(this,"_hasDataChannelMediaSection",!1),ge(this,"_nextSendSctpStreamId",0),ge(this,"_transportReady",!1),ge(this,"onIceGatheringStateChange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),ge(this,"onIceCandidateError",X=>{this.emit("@icecandidateerror",X)}),ge(this,"onConnectionStateChange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}),ge(this,"onIceConnectionStateChange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.debug("constructor()"),this._direction=S,this._remoteSdp=new u.RemoteSdp({iceParameters:b,iceCandidates:x,dtlsParameters:E,sctpParameters:M}),this._getSendExtendedRtpCapabilities=q,E.role&&E.role!=="auto"&&(this._forcedLocalDtlsRole=E.role==="server"?"client":"server"),this._pc=new RTCPeerConnection(ie({iceServers:Z??[],iceTransportPolicy:$??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},z)),this._pc.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.addEventListener("icecandidateerror",this.onIceCandidateError),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",this.onConnectionStateChange):(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange))}static createFactory(){return{name:_,factory:S=>new Du(S),getNativeRtpCapabilities:()=>H(null,null,function*(){f.debug("getNativeRtpCapabilities()");let S=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{S.addTransceiver("audio"),S.addTransceiver("video");const b=yield S.createOffer();try{S.close()}catch{}S=void 0;const x=t.parse(b.sdp);return Du.getLocalRtpCapabilities(x)}catch(b){try{S==null||S.close()}catch{}throw S=void 0,b}}),getNativeSctpCapabilities:()=>H(null,null,function*(){return f.debug("getNativeSctpCapabilities()"),{numStreams:w}})}}static getLocalRtpCapabilities(S){const b=p.extractRtpCapabilities({sdpObject:S});return v.addNackSupportForOpus(b),b}get name(){return _}close(){if(f.debug("close()"),!this._closed){this._closed=!0,this._sendStream.release(!1);try{this._pc.close()}catch{}this._pc.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this._pc.removeEventListener("icecandidateerror",this.onIceCandidateError),this._pc.removeEventListener("connectionstatechange",this.onConnectionStateChange),this._pc.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.emit("@close"),super.close()}}updateIceServers(S){return H(this,null,function*(){this.assertNotClosed(),f.debug("updateIceServers()");const b=this._pc.getConfiguration();b.iceServers=S,this._pc.setConfiguration(b)})}restartIce(S){return H(this,null,function*(){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(S),!!this._transportReady)if(this._direction==="send"){const b=yield this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",b),yield this._pc.setLocalDescription(b);const x={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",x),yield this._pc.setRemoteDescription(x)}else{const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)}})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),this._pc.getStats()})}send(S){return H(this,arguments,function*({track:b,encodings:x,codecOptions:E,codec:M,onRtpSender:Z}){var $,z;this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",b.kind,b.id),x&&x.length>1&&x.forEach((le,Re)=>{le.rid=`r${Re}`});const q=this._remoteSdp.getNextMediaSectionIdx(),X=this._pc.addTransceiver(b,{direction:"sendonly",streams:[this._sendStream],sendEncodings:x});Z&&Z(X.sender);let K=yield this._pc.createOffer(),ee=t.parse(K.sdp);ee.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();const oe=Du.getLocalRtpCapabilities(ee),ce=this._getSendExtendedRtpCapabilities(oe),ne=i.getSendingRtpParameters(b.kind,ce);ne.codecs=i.reduceCodecs(ne.codecs,M);const Te=i.getSendingRemoteRtpParameters(b.kind,ce);Te.codecs=i.reduceCodecs(Te.codecs,M),this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee}));let ye=!1;const ue=(0,o.parse)((x??[{}])[0].scalabilityMode);let me;x&&x.length===1&&ue.spatialLayers>1&&ne.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(f.debug("send() | enabling legacy simulcast for VP9 SVC"),ye=!0,ee=t.parse(K.sdp),me=ee.media[q.idx],h.addLegacySimulcast({offerMediaObject:me,numStreams:ue.spatialLayers}),K={type:"offer",sdp:t.write(ee)}),f.debug("send() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K);let _e=(z=X.mid)!=null?z:void 0;if(_e||f.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),ne.mid=_e,ee=t.parse(this._pc.localDescription.sdp),me=ee.media[q.idx],ne.rtcp.cname=p.getCname({offerMediaObject:me}),!x)ne.encodings=h.getRtpEncodings({offerMediaObject:me});else if(x.length===1){let le=h.getRtpEncodings({offerMediaObject:me});Object.assign(le[0],x[0]),ye&&(le=[le[0]]),ne.encodings=le}else ne.encodings=x;if(ne.encodings.length>1&&(ne.codecs[0].mimeType.toLowerCase()==="video/vp8"||ne.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const le of ne.encodings)le.scalabilityMode?le.scalabilityMode=`L1T${ue.temporalLayers}`:le.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:me,reuseMid:q.reuseMid,offerRtpParameters:ne,answerRtpParameters:Te,codecOptions:E});const ke={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",ke),yield this._pc.setRemoteDescription(ke),_e||(_e=X.mid,ne.mid=_e),this._mapMidTransceiver.set(_e,X),{localId:_e,rtpParameters:ne,rtpSender:X.sender}})}stopSending(S){return H(this,null,function*(){if(this.assertSendDirection(),this._closed)return;f.debug("stopSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");if(b.sender.replaceTrack(null),this._pc.removeTrack(b.sender),this._remoteSdp.closeMediaSection(b.mid))try{b.stop()}catch{}const E=yield this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",E),yield this._pc.setLocalDescription(E);const M={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",M),yield this._pc.setRemoteDescription(M),this._mapMidTransceiver.delete(S)})}pauseSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="inactive",this._remoteSdp.pauseMediaSection(S);const x=yield this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}resumeSending(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",S);const b=this._mapMidTransceiver.get(S);if(this._remoteSdp.resumeSendingMediaSection(S),!b)throw new Error("associated RTCRtpTransceiver not found");b.direction="sendonly";const x=yield this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",x),yield this._pc.setLocalDescription(x);const E={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",E),yield this._pc.setRemoteDescription(E)})}replaceTrack(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),b?f.debug("replaceTrack() [localId:%s, track.id:%s]",S,b.id):f.debug("replaceTrack() [localId:%s, no track]",S);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");yield x.sender.replaceTrack(b)})}setMaxSpatialLayer(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{z<=b?$.active=!0:$.active=!1}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}setRtpEncodingParameters(S,b){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",S,b);const x=this._mapMidTransceiver.get(S);if(!x)throw new Error("associated RTCRtpTransceiver not found");const E=x.sender.getParameters();E.encodings.forEach(($,z)=>{E.encodings[z]=ie(ie({},$),b)}),yield x.sender.setParameters(E),this._remoteSdp.muxMediaSectionSimulcast(S,E.encodings);const M=yield this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",M),yield this._pc.setLocalDescription(M);const Z={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",Z),yield this._pc.setRemoteDescription(Z)})}getSenderStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertSendDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.sender.getStats()})}sendDataChannel(S){return H(this,arguments,function*({ordered:b,maxPacketLifeTime:x,maxRetransmits:E,label:M,protocol:Z}){var $;this.assertNotClosed(),this.assertSendDirection();const z={negotiated:!0,id:this._nextSendSctpStreamId,ordered:b,maxPacketLifeTime:x,maxRetransmits:E,protocol:Z};f.debug("sendDataChannel() [options:%o]",z);const q=this._pc.createDataChannel(M,z);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%w.MIS,!this._hasDataChannelMediaSection){const K=yield this._pc.createOffer(),ee=t.parse(K.sdp),oe=ee.media.find(ne=>ne.type==="application");this._transportReady||(yield this.setupTransport({localDtlsRole:($=this._forcedLocalDtlsRole)!=null?$:"client",localSdpObject:ee})),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",K),yield this._pc.setLocalDescription(K),this._remoteSdp.sendSctpAssociation({offerMediaObject:oe});const ce={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",ce),yield this._pc.setRemoteDescription(ce),this._hasDataChannelMediaSection=!0}const X={streamId:z.id,ordered:z.ordered,maxPacketLifeTime:z.maxPacketLifeTime,maxRetransmits:z.maxRetransmits};return{dataChannel:q,sctpStreamParameters:X}})}receive(S){return H(this,null,function*(){var b,x;this.assertNotClosed(),this.assertRecvDirection();const E=[],M=new Map;for(const q of S){const{trackId:X,kind:K,rtpParameters:ee,streamId:oe}=q;f.debug("receive() [trackId:%s, kind:%s]",X,K);const ce=(b=ee.mid)!=null?b:String(this._mapMidTransceiver.size);M.set(X,ce),this._remoteSdp.receive({mid:ce,kind:K,offerRtpParameters:ee,streamId:oe??ee.rtcp.cname,trackId:X})}const Z={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",Z),yield this._pc.setRemoteDescription(Z);for(const q of S){const{trackId:X,onRtpReceiver:K}=q;if(K){const ee=M.get(X),oe=this._pc.getTransceivers().find(ce=>ce.mid===ee);if(!oe)throw new Error("transceiver not found");K(oe.receiver)}}let $=yield this._pc.createAnswer();const z=t.parse($.sdp);for(const q of S){const{trackId:X,rtpParameters:K}=q,ee=M.get(X),oe=z.media.find(ce=>String(ce.mid)===ee);p.applyCodecParameters({offerRtpParameters:K,answerMediaObject:oe})}$={type:"answer",sdp:t.write(z)},this._transportReady||(yield this.setupTransport({localDtlsRole:(x=this._forcedLocalDtlsRole)!=null?x:"client",localSdpObject:z})),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",$),yield this._pc.setLocalDescription($);for(const q of S){const{trackId:X}=q,K=M.get(X),ee=this._pc.getTransceivers().find(oe=>oe.mid===K);if(ee)this._mapMidTransceiver.set(K,ee),E.push({localId:K,track:ee.receiver.track,rtpReceiver:ee.receiver});else throw new Error("new RTCRtpTransceiver not found")}return E})}stopReceiving(S){return H(this,null,function*(){if(this.assertRecvDirection(),this._closed)return;for(const E of S){f.debug("stopReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(M.mid)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x);for(const E of S)this._mapMidTransceiver.delete(E)})}pauseReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("pauseReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="inactive",this._remoteSdp.pauseMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}resumeReceiving(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();for(const E of S){f.debug("resumeReceiving() [localId:%s]",E);const M=this._mapMidTransceiver.get(E);if(!M)throw new Error("associated RTCRtpTransceiver not found");M.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(E)}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",b),yield this._pc.setRemoteDescription(b);const x=yield this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",x),yield this._pc.setLocalDescription(x)})}getReceiverStats(S){return H(this,null,function*(){this.assertNotClosed(),this.assertRecvDirection();const b=this._mapMidTransceiver.get(S);if(!b)throw new Error("associated RTCRtpTransceiver not found");return b.receiver.getStats()})}receiveDataChannel(S){return H(this,arguments,function*({sctpStreamParameters:b,label:x,protocol:E}){var M;this.assertNotClosed(),this.assertRecvDirection();const{streamId:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q}=b,X={negotiated:!0,id:Z,ordered:$,maxPacketLifeTime:z,maxRetransmits:q,protocol:E};f.debug("receiveDataChannel() [options:%o]",X);const K=this._pc.createDataChannel(x,X);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const ee={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",ee),yield this._pc.setRemoteDescription(ee);const oe=yield this._pc.createAnswer();if(!this._transportReady){const ce=t.parse(oe.sdp);yield this.setupTransport({localDtlsRole:(M=this._forcedLocalDtlsRole)!=null?M:"client",localSdpObject:ce})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",oe),yield this._pc.setLocalDescription(oe),this._hasDataChannelMediaSection=!0}return{dataChannel:K}})}setupTransport(S){return H(this,arguments,function*({localDtlsRole:b,localSdpObject:x}){x||(x=t.parse(this._pc.localDescription.sdp));const E=p.extractDtlsParameters({sdpObject:x});E.role=b,this._remoteSdp.updateDtlsRole(b==="client"?"server":"client"),yield new Promise((M,Z)=>{this.safeEmit("@connect",{dtlsParameters:E},M,Z)}),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};e.ReactNative106=C}}),I3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/Device.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.Device=void 0,e.detectDeviceAsync=C,e.detectDevice=R;var t=Ly(),n=Ur(),r=Jr(),i=Di(),a=Vo(),o=xs(),u=C3(),p=P3(),h=k3(),v=T3(),f=R3(),_=A3(),w=new n.Logger("Device");function C(x){return H(this,null,function*(){w.debug("detectDeviceAsync() [userAgent:%s]",x),!x&&typeof navigator=="object"&&(x=navigator.userAgent);const E=(0,t.UAParser)(x);return b(E)})}function R(x){w.debug("detectDevice() [userAgent:%s]",x),!x&&typeof navigator=="object"&&(x=navigator.userAgent);const E=(0,t.UAParser)(x);return b(E)}var S=class t_{constructor({handlerName:E,handlerFactory:M}={}){if(ge(this,"_handlerFactory"),ge(this,"_handlerName"),ge(this,"_loaded",!1),ge(this,"_getSendExtendedRtpCapabilities"),ge(this,"_recvRtpCapabilities"),ge(this,"_canProduceByKind",{audio:!1,video:!1}),ge(this,"_sctpCapabilities"),ge(this,"_observer",new r.EnhancedEventEmitter),w.debug("constructor()"),E&&M)throw new TypeError("just one of handlerName or handlerInterface can be given");if(M)this._handlerFactory=M;else{if(E)w.debug("constructor() | handler given: %s",E);else if(E=R(),E)w.debug("constructor() | detected handler: %s",E);else throw new i.UnsupportedError("device not supported");switch(E){case"Chrome111":{this._handlerFactory=p.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=h.Chrome74.createFactory();break}case"Firefox120":{this._handlerFactory=v.Firefox120.createFactory();break}case"Safari12":{this._handlerFactory=f.Safari12.createFactory();break}case"ReactNative106":{this._handlerFactory=_.ReactNative106.createFactory();break}default:throw new TypeError(`unknown handlerName "${E}"`)}}this._handlerName=this._handlerFactory.name}static factory(){return H(this,arguments,function*({handlerName:E,handlerFactory:M}={}){if(w.debug("factory()"),E&&M)throw new TypeError("just one of handlerName or handlerInterface can be given");if(!E&&!M&&(E=yield C(),!E))throw new i.UnsupportedError("device not supported");return new t_({handlerName:E,handlerFactory:M})})}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new i.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new i.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}load(E){return H(this,arguments,function*({routerRtpCapabilities:M,preferLocalCodecsOrder:Z=!1}){if(w.debug("load() [routerRtpCapabilities:%o]",M),this._loaded)throw new i.InvalidStateError("already loaded");const $=a.clone(M);o.validateRtpCapabilities($);const{getNativeRtpCapabilities:z,getNativeSctpCapabilities:q}=this._handlerFactory,X=a.clone(yield z());o.validateRtpCapabilities(X),w.debug("load() | got native RTP capabilities:%o",X),this._getSendExtendedRtpCapabilities=ee=>a.clone(o.getExtendedRtpCapabilities(ee,$,Z));const K=o.getExtendedRtpCapabilities(X,$,!1);this._recvRtpCapabilities=o.getRecvRtpCapabilities(K),o.validateRtpCapabilities(this._recvRtpCapabilities),w.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._canProduceByKind.audio=o.canSend("audio",this._recvRtpCapabilities),this._canProduceByKind.video=o.canSend("video",this._recvRtpCapabilities),this._sctpCapabilities=yield q(),o.validateSctpCapabilities(this._sctpCapabilities),w.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),w.debug("load() succeeded"),this._loaded=!0})}canProduce(E){if(this._loaded){if(E!=="audio"&&E!=="video")throw new TypeError(`invalid kind "${E}"`)}else throw new i.InvalidStateError("not loaded");return this._canProduceByKind[E]}createSendTransport({id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:X,additionalSettings:K,appData:ee}){return w.debug("createSendTransport()"),this.createTransport({direction:"send",id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:X,additionalSettings:K,appData:ee})}createRecvTransport({id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:X,additionalSettings:K,appData:ee}){return w.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:E,iceParameters:M,iceCandidates:Z,dtlsParameters:$,sctpParameters:z,iceServers:q,iceTransportPolicy:X,additionalSettings:K,appData:ee})}createTransport({direction:E,id:M,iceParameters:Z,iceCandidates:$,dtlsParameters:z,sctpParameters:q,iceServers:X,iceTransportPolicy:K,additionalSettings:ee,appData:oe}){if(this._loaded){if(typeof M!="string")throw new TypeError("missing id");if(typeof Z!="object")throw new TypeError("missing iceParameters");if(Array.isArray($)){if(typeof z!="object")throw new TypeError("missing dtlsParameters");if(q&&typeof q!="object")throw new TypeError("wrong sctpParameters");if(oe&&typeof oe!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new i.InvalidStateError("not loaded");const ce=new u.Transport({direction:E,id:M,iceParameters:Z,iceCandidates:$,dtlsParameters:z,sctpParameters:q,iceServers:X,iceTransportPolicy:K,additionalSettings:ee,appData:oe,handlerFactory:this._handlerFactory,getSendExtendedRtpCapabilities:this._getSendExtendedRtpCapabilities,recvRtpCapabilities:this._recvRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",ce),ce}};e.Device=S;function b(x){var E,M,Z,$,z,q;if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(w.debug("detectDeviceImpl() | React-Native detected"),typeof RTCPeerConnection>"u"||typeof RTCRtpTransceiver>"u"){w.warn("detectDeviceImpl() | unsupported react-native-webrtc without RTCPeerConnection or RTCRtpTransceiver, forgot to call registerGlobals() on it?");return}return"ReactNative106"}else{w.debug("detectDeviceImpl() | browser detected [userAgent:%s, parsed:%o]",x.ua,x);const X=x.browser,K=(E=X.name)==null?void 0:E.toLowerCase(),ee=parseInt((M=X.major)!=null?M:"0"),ce=(Z=x.engine.name)==null?void 0:Z.toLowerCase(),ne=x.os,Te=($=ne.name)==null?void 0:$.toLowerCase(),ye=parseFloat((z=ne.version)!=null?z:"0"),me=(q=x.device.model)==null?void 0:q.toLowerCase(),_e=Te==="ios"||me==="ipad",ke=K&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(K),le=K&&["firefox","mobile firefox","mobile focus"].includes(K),Re=K&&["safari","mobile safari"].includes(K),We=K&&["edge"].includes(K);if((ke||We)&&!_e&&ee>=111)return"Chrome111";if(ke&&!_e&&ee>=74||We&&!_e&&ee>=88)return"Chrome74";if(le&&!_e&&ee>=120)return"Firefox120";if(le&&_e&&ye>=14.3)return"Safari12";if(Re&&ee>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(ce==="webkit"&&_e&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(ce==="blink"){const Xe=x.ua.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);return Xe?Number(Xe[1])>=111?"Chrome111":"Chrome74":"Chrome111"}else{w.warn("detectDeviceImpl() | browser not supported [name:%s, version:%s]",K,ee);return}}}}}),F3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/max.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default="ffffffff-ffff-ffff-ffff-ffffffffffff"}}),D3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/nil.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default="00000000-0000-0000-0000-000000000000"}}),N3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/regex.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i}}),eh=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/validate.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=N3();function n(r){return typeof r=="string"&&t.default.test(r)}e.default=n}}),th=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/parse.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=eh();function n(r){if(!(0,t.default)(r))throw TypeError("Invalid UUID");let i;return Uint8Array.of((i=parseInt(r.slice(0,8),16))>>>24,i>>>16&255,i>>>8&255,i&255,(i=parseInt(r.slice(9,13),16))>>>8,i&255,(i=parseInt(r.slice(14,18),16))>>>8,i&255,(i=parseInt(r.slice(19,23),16))>>>8,i&255,(i=parseInt(r.slice(24,36),16))/1099511627776&255,i/4294967296&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255)}e.default=n}}),oa=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/stringify.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.unsafeStringify=void 0;var t=eh(),n=[];for(let a=0;a<256;++a)n.push((a+256).toString(16).slice(1));function r(a,o=0){return(n[a[o+0]]+n[a[o+1]]+n[a[o+2]]+n[a[o+3]]+"-"+n[a[o+4]]+n[a[o+5]]+"-"+n[a[o+6]]+n[a[o+7]]+"-"+n[a[o+8]]+n[a[o+9]]+"-"+n[a[o+10]]+n[a[o+11]]+n[a[o+12]]+n[a[o+13]]+n[a[o+14]]+n[a[o+15]]).toLowerCase()}e.unsafeStringify=r;function i(a,o=0){const u=r(a,o);if(!(0,t.default)(u))throw TypeError("Stringified UUID is invalid");return u}e.default=i}}),Wm=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/rng.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t,n=new Uint8Array(16);function r(){if(!t){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(n)}e.default=r}}),n_=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.updateV1State=void 0;var t=Wm(),n=oa(),r={};function i(u,p,h){var v,f,_,w;let C;const R=(v=u==null?void 0:u._v6)!=null?v:!1;if(u){const S=Object.keys(u);S.length===1&&S[0]==="_v6"&&(u=void 0)}if(u)C=o((w=(_=u.random)!=null?_:(f=u.rng)==null?void 0:f.call(u))!=null?w:(0,t.default)(),u.msecs,u.nsecs,u.clockseq,u.node,p,h);else{const S=Date.now(),b=(0,t.default)();a(r,S,b),C=o(b,r.msecs,r.nsecs,R?void 0:r.clockseq,R?void 0:r.node,p,h)}return p??(0,n.unsafeStringify)(C)}function a(u,p,h){var v,f;return(v=u.msecs)!=null||(u.msecs=-1/0),(f=u.nsecs)!=null||(u.nsecs=0),p===u.msecs?(u.nsecs++,u.nsecs>=1e4&&(u.node=void 0,u.nsecs=0)):p>u.msecs?u.nsecs=0:p<u.msecs&&(u.node=void 0),u.node||(u.node=h.slice(10,16),u.node[0]|=1,u.clockseq=(h[8]<<8|h[9])&16383),u.msecs=p,u}e.updateV1State=a;function o(u,p,h,v,f,_,w=0){if(u.length<16)throw new Error("Random bytes length must be >= 16");if(!_)_=new Uint8Array(16),w=0;else if(w<0||w+16>_.length)throw new RangeError(`UUID byte range ${w}:${w+15} is out of buffer bounds`);p??(p=Date.now()),h??(h=0),v??(v=(u[8]<<8|u[9])&16383),f??(f=u.slice(10,16)),p+=122192928e5;const C=((p&268435455)*1e4+h)%4294967296;_[w++]=C>>>24&255,_[w++]=C>>>16&255,_[w++]=C>>>8&255,_[w++]=C&255;const R=p/4294967296*1e4&268435455;_[w++]=R>>>8&255,_[w++]=R&255,_[w++]=R>>>24&15|16,_[w++]=R>>>16&255,_[w++]=v>>>8|128,_[w++]=v&255;for(let S=0;S<6;++S)_[w++]=f[S];return _}e.default=i}}),r_=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v1ToV6.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=th(),n=oa();function r(a){const o=typeof a=="string"?(0,t.default)(a):a,u=i(o);return typeof a=="string"?(0,n.unsafeStringify)(u):u}e.default=r;function i(a){return Uint8Array.of((a[6]&15)<<4|a[7]>>4&15,(a[7]&15)<<4|(a[4]&240)>>4,(a[4]&15)<<4|(a[5]&240)>>4,(a[5]&15)<<4|(a[0]&240)>>4,(a[0]&15)<<4|(a[1]&240)>>4,(a[1]&15)<<4|(a[2]&240)>>4,96|a[2]&15,a[3],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}}}),O3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/md5.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});function t(w){const C=a(w),R=i(C,w.length*8);return n(R)}function n(w){const C=new Uint8Array(w.length*4);for(let R=0;R<w.length*4;R++)C[R]=w[R>>2]>>>R%4*8&255;return C}function r(w){return(w+64>>>9<<4)+14+1}function i(w,C){const R=new Uint32Array(r(C)).fill(0);R.set(w),R[C>>5]|=128<<C%32,R[R.length-1]=C,w=R;let S=1732584193,b=-271733879,x=-1732584194,E=271733878;for(let M=0;M<w.length;M+=16){const Z=S,$=b,z=x,q=E;S=h(S,b,x,E,w[M],7,-680876936),E=h(E,S,b,x,w[M+1],12,-389564586),x=h(x,E,S,b,w[M+2],17,606105819),b=h(b,x,E,S,w[M+3],22,-1044525330),S=h(S,b,x,E,w[M+4],7,-176418897),E=h(E,S,b,x,w[M+5],12,1200080426),x=h(x,E,S,b,w[M+6],17,-1473231341),b=h(b,x,E,S,w[M+7],22,-45705983),S=h(S,b,x,E,w[M+8],7,1770035416),E=h(E,S,b,x,w[M+9],12,-1958414417),x=h(x,E,S,b,w[M+10],17,-42063),b=h(b,x,E,S,w[M+11],22,-1990404162),S=h(S,b,x,E,w[M+12],7,1804603682),E=h(E,S,b,x,w[M+13],12,-40341101),x=h(x,E,S,b,w[M+14],17,-1502002290),b=h(b,x,E,S,w[M+15],22,1236535329),S=v(S,b,x,E,w[M+1],5,-165796510),E=v(E,S,b,x,w[M+6],9,-1069501632),x=v(x,E,S,b,w[M+11],14,643717713),b=v(b,x,E,S,w[M],20,-373897302),S=v(S,b,x,E,w[M+5],5,-701558691),E=v(E,S,b,x,w[M+10],9,38016083),x=v(x,E,S,b,w[M+15],14,-660478335),b=v(b,x,E,S,w[M+4],20,-405537848),S=v(S,b,x,E,w[M+9],5,568446438),E=v(E,S,b,x,w[M+14],9,-1019803690),x=v(x,E,S,b,w[M+3],14,-187363961),b=v(b,x,E,S,w[M+8],20,1163531501),S=v(S,b,x,E,w[M+13],5,-1444681467),E=v(E,S,b,x,w[M+2],9,-51403784),x=v(x,E,S,b,w[M+7],14,1735328473),b=v(b,x,E,S,w[M+12],20,-1926607734),S=f(S,b,x,E,w[M+5],4,-378558),E=f(E,S,b,x,w[M+8],11,-2022574463),x=f(x,E,S,b,w[M+11],16,1839030562),b=f(b,x,E,S,w[M+14],23,-35309556),S=f(S,b,x,E,w[M+1],4,-1530992060),E=f(E,S,b,x,w[M+4],11,1272893353),x=f(x,E,S,b,w[M+7],16,-155497632),b=f(b,x,E,S,w[M+10],23,-1094730640),S=f(S,b,x,E,w[M+13],4,681279174),E=f(E,S,b,x,w[M],11,-358537222),x=f(x,E,S,b,w[M+3],16,-722521979),b=f(b,x,E,S,w[M+6],23,76029189),S=f(S,b,x,E,w[M+9],4,-640364487),E=f(E,S,b,x,w[M+12],11,-421815835),x=f(x,E,S,b,w[M+15],16,530742520),b=f(b,x,E,S,w[M+2],23,-995338651),S=_(S,b,x,E,w[M],6,-198630844),E=_(E,S,b,x,w[M+7],10,1126891415),x=_(x,E,S,b,w[M+14],15,-1416354905),b=_(b,x,E,S,w[M+5],21,-57434055),S=_(S,b,x,E,w[M+12],6,1700485571),E=_(E,S,b,x,w[M+3],10,-1894986606),x=_(x,E,S,b,w[M+10],15,-1051523),b=_(b,x,E,S,w[M+1],21,-2054922799),S=_(S,b,x,E,w[M+8],6,1873313359),E=_(E,S,b,x,w[M+15],10,-30611744),x=_(x,E,S,b,w[M+6],15,-1560198380),b=_(b,x,E,S,w[M+13],21,1309151649),S=_(S,b,x,E,w[M+4],6,-145523070),E=_(E,S,b,x,w[M+11],10,-1120210379),x=_(x,E,S,b,w[M+2],15,718787259),b=_(b,x,E,S,w[M+9],21,-343485551),S=o(S,Z),b=o(b,$),x=o(x,z),E=o(E,q)}return Uint32Array.of(S,b,x,E)}function a(w){if(w.length===0)return new Uint32Array;const C=new Uint32Array(r(w.length*8)).fill(0);for(let R=0;R<w.length;R++)C[R>>2]|=(w[R]&255)<<R%4*8;return C}function o(w,C){const R=(w&65535)+(C&65535);return(w>>16)+(C>>16)+(R>>16)<<16|R&65535}function u(w,C){return w<<C|w>>>32-C}function p(w,C,R,S,b,x){return o(u(o(o(C,w),o(S,x)),b),R)}function h(w,C,R,S,b,x,E){return p(C&R|~C&S,w,C,b,x,E)}function v(w,C,R,S,b,x,E){return p(C&S|R&~S,w,C,b,x,E)}function f(w,C,R,S,b,x,E){return p(C^R^S,w,C,b,x,E)}function _(w,C,R,S,b,x,E){return p(R^(C|~S),w,C,b,x,E)}e.default=t}}),fd=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v35.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=e.stringToBytes=void 0;var t=th(),n=oa();function r(a){a=unescape(encodeURIComponent(a));const o=new Uint8Array(a.length);for(let u=0;u<a.length;++u)o[u]=a.charCodeAt(u);return o}e.stringToBytes=r,e.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",e.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function i(a,o,u,p,h,v){const f=typeof u=="string"?r(u):u,_=typeof p=="string"?(0,t.default)(p):p;if(typeof p=="string"&&(p=(0,t.default)(p)),(p==null?void 0:p.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let w=new Uint8Array(16+f.length);if(w.set(_),w.set(f,_.length),w=o(w),w[6]=w[6]&15|a,w[8]=w[8]&63|128,h){v=v||0;for(let C=0;C<16;++C)h[v+C]=w[C];return h}return(0,n.unsafeStringify)(w)}e.default=i}}),M3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v3.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;var t=O3(),n=fd(),r=fd();Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return r.URL}});function i(a,o,u,p){return(0,n.default)(48,t.default,a,o,u,p)}i.DNS=n.DNS,i.URL=n.URL,e.default=i}}),L3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/native.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);e.default={randomUUID:t}}}),j3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v4.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=L3(),n=Wm(),r=oa();function i(a,o,u){var p,h,v;if(t.default.randomUUID&&!o&&!a)return t.default.randomUUID();a=a||{};const f=(v=(h=a.random)!=null?h:(p=a.rng)==null?void 0:p.call(a))!=null?v:(0,n.default)();if(f.length<16)throw new Error("Random bytes length must be >= 16");if(f[6]=f[6]&15|64,f[8]=f[8]&63|128,o){if(u=u||0,u<0||u+16>o.length)throw new RangeError(`UUID byte range ${u}:${u+15} is out of buffer bounds`);for(let _=0;_<16;++_)o[u+_]=f[_];return o}return(0,r.unsafeStringify)(f)}e.default=i}}),B3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/sha1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});function t(i,a,o,u){switch(i){case 0:return a&o^~a&u;case 1:return a^o^u;case 2:return a&o^a&u^o&u;case 3:return a^o^u}}function n(i,a){return i<<a|i>>>32-a}function r(i){const a=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520],u=new Uint8Array(i.length+1);u.set(i),u[i.length]=128,i=u;const p=i.length/4+2,h=Math.ceil(p/16),v=new Array(h);for(let f=0;f<h;++f){const _=new Uint32Array(16);for(let w=0;w<16;++w)_[w]=i[f*64+w*4]<<24|i[f*64+w*4+1]<<16|i[f*64+w*4+2]<<8|i[f*64+w*4+3];v[f]=_}v[h-1][14]=(i.length-1)*8/Math.pow(2,32),v[h-1][14]=Math.floor(v[h-1][14]),v[h-1][15]=(i.length-1)*8&4294967295;for(let f=0;f<h;++f){const _=new Uint32Array(80);for(let x=0;x<16;++x)_[x]=v[f][x];for(let x=16;x<80;++x)_[x]=n(_[x-3]^_[x-8]^_[x-14]^_[x-16],1);let w=o[0],C=o[1],R=o[2],S=o[3],b=o[4];for(let x=0;x<80;++x){const E=Math.floor(x/20),M=n(w,5)+t(E,C,R,S)+b+a[E]+_[x]>>>0;b=S,S=R,R=n(C,30)>>>0,C=w,w=M}o[0]=o[0]+w>>>0,o[1]=o[1]+C>>>0,o[2]=o[2]+R>>>0,o[3]=o[3]+S>>>0,o[4]=o[4]+b>>>0}return Uint8Array.of(o[0]>>24,o[0]>>16,o[0]>>8,o[0],o[1]>>24,o[1]>>16,o[1]>>8,o[1],o[2]>>24,o[2]>>16,o[2]>>8,o[2],o[3]>>24,o[3]>>16,o[3]>>8,o[3],o[4]>>24,o[4]>>16,o[4]>>8,o[4])}e.default=r}}),U3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v5.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;var t=B3(),n=fd(),r=fd();Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return r.URL}});function i(a,o,u,p){return(0,n.default)(80,t.default,a,o,u,p)}i.DNS=n.DNS,i.URL=n.URL,e.default=i}}),H3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v6.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=oa(),n=n_(),r=r_();function i(a,o,u){a??(a={}),u??(u=0);let p=(0,n.default)(we(ie({},a),{_v6:!0}),new Uint8Array(16));if(p=(0,r.default)(p),o){for(let h=0;h<16;h++)o[u+h]=p[h];return o}return(0,t.unsafeStringify)(p)}e.default=i}}),V3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v6ToV1.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=th(),n=oa();function r(a){const o=typeof a=="string"?(0,t.default)(a):a,u=i(o);return typeof a=="string"?(0,n.unsafeStringify)(u):u}e.default=r;function i(a){return Uint8Array.of((a[3]&15)<<4|a[4]>>4&15,(a[4]&15)<<4|(a[5]&240)>>4,(a[5]&15)<<4|a[6]&15,a[7],(a[1]&15)<<4|(a[2]&240)>>4,(a[2]&15)<<4|(a[3]&240)>>4,16|(a[0]&240)>>4,(a[0]&15)<<4|(a[1]&240)>>4,a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}}}),q3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/v7.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.updateV7State=void 0;var t=Wm(),n=oa(),r={};function i(u,p,h){var v,f,_;let w;if(u)w=o((_=(f=u.random)!=null?f:(v=u.rng)==null?void 0:v.call(u))!=null?_:(0,t.default)(),u.msecs,u.seq,p,h);else{const C=Date.now(),R=(0,t.default)();a(r,C,R),w=o(R,r.msecs,r.seq,p,h)}return p??(0,n.unsafeStringify)(w)}function a(u,p,h){var v,f;return(v=u.msecs)!=null||(u.msecs=-1/0),(f=u.seq)!=null||(u.seq=0),p>u.msecs?(u.seq=h[6]<<23|h[7]<<16|h[8]<<8|h[9],u.msecs=p):(u.seq=u.seq+1|0,u.seq===0&&u.msecs++),u}e.updateV7State=a;function o(u,p,h,v,f=0){if(u.length<16)throw new Error("Random bytes length must be >= 16");if(!v)v=new Uint8Array(16),f=0;else if(f<0||f+16>v.length)throw new RangeError(`UUID byte range ${f}:${f+15} is out of buffer bounds`);return p??(p=Date.now()),h??(h=u[6]*127<<24|u[7]<<16|u[8]<<8|u[9]),v[f++]=p/1099511627776&255,v[f++]=p/4294967296&255,v[f++]=p/16777216&255,v[f++]=p/65536&255,v[f++]=p/256&255,v[f++]=p&255,v[f++]=112|h>>>28&15,v[f++]=h>>>20&255,v[f++]=128|h>>>14&63,v[f++]=h>>>6&255,v[f++]=h<<2&255|u[10]&3,v[f++]=u[11],v[f++]=u[12],v[f++]=u[13],v[f++]=u[14],v[f++]=u[15],v}e.default=i}}),z3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/version.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0});var t=eh();function n(r){if(!(0,t.default)(r))throw TypeError("Invalid UUID");return parseInt(r.slice(14,15),16)}e.default=n}}),K3=Ee({"../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/cjs-browser/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.validate=e.v7=e.v6ToV1=e.v6=e.v5=e.v4=e.v3=e.v1ToV6=e.v1=e.stringify=e.parse=e.NIL=e.MAX=void 0;var t=F3();Object.defineProperty(e,"MAX",{enumerable:!0,get:function(){return t.default}});var n=D3();Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return n.default}});var r=th();Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return r.default}});var i=oa();Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return i.default}});var a=n_();Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return a.default}});var o=r_();Object.defineProperty(e,"v1ToV6",{enumerable:!0,get:function(){return o.default}});var u=M3();Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return u.default}});var p=j3();Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return p.default}});var h=U3();Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return h.default}});var v=H3();Object.defineProperty(e,"v6",{enumerable:!0,get:function(){return v.default}});var f=V3();Object.defineProperty(e,"v6ToV1",{enumerable:!0,get:function(){return f.default}});var _=q3();Object.defineProperty(e,"v7",{enumerable:!0,get:function(){return _.default}});var w=eh();Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return w.default}});var C=z3();Object.defineProperty(e,"version",{enumerable:!0,get:function(){return C.default}})}}),$3=Ee({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/FakeEventTarget.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeEventTarget=void 0;var t=class{constructor(){ge(this,"listeners",{})}addEventListener(n,r,i={}){var a,o;r&&((o=(a=this.listeners)[n])!=null||(a[n]=[]),this.listeners[n].push({callback:r,once:i.once===!0}))}removeEventListener(n,r){this.listeners[n]&&(this.listeners[n]=this.listeners[n].filter(i=>i.callback!==r))}dispatchEvent(n){if(!n||typeof n.type!="string")throw new Error("invalid event object");const r=this.listeners[n.type];if(!r)return!0;for(const i of[...r]){try{i.callback.call(this,n)}catch(a){setTimeout(()=>{throw a},0)}i.once&&this.removeEventListener(n.type,i.callback)}return!n.defaultPrevented}};e.FakeEventTarget=t}}),W3=Ee({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/utils.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.clone=t;function t(n){if(n!==void 0)return Number.isNaN(n)?NaN:typeof structuredClone=="function"?structuredClone(n):JSON.parse(JSON.stringify(n))}}}),G3=Ee({"../../node_modules/.pnpm/fake-mediastreamtrack@2.1.2/node_modules/fake-mediastreamtrack/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeMediaStreamTrack=void 0;var t=K3(),n=$3(),r=W3(),i,a,o,u,p,h,v,f,_,w,C,R,S,b,x,E,M=class i_ extends n.FakeEventTarget{constructor({kind:z,id:q,label:X,contentHint:K,enabled:ee,muted:oe,readyState:ce,capabilities:ne,constraints:Te,settings:ye,data:ue}){super(),ar(this,i),ar(this,a),ar(this,o),ar(this,u),ar(this,p),ar(this,h),ar(this,v),ar(this,f),ar(this,_),ar(this,w),ar(this,C),ar(this,R,null),ar(this,S,null),ar(this,b,null),ar(this,x,null),ar(this,E,null),un(this,i,q??(0,t.v4)()),un(this,a,z),un(this,o,X??""),un(this,v,K??""),un(this,p,ee??!0),un(this,h,oe??!1),un(this,u,ce??"live"),un(this,f,ne??{}),un(this,_,Te??{}),un(this,w,ye??{}),un(this,C,ue??{})}get id(){return Ct(this,i)}get kind(){return Ct(this,a)}get label(){return Ct(this,o)}get contentHint(){return Ct(this,v)}set contentHint(z){un(this,v,z)}get enabled(){return Ct(this,p)}set enabled(z){const q=Ct(this,p)!==z;un(this,p,z),q&&this.dispatchEvent(new Event("enabledchange"))}get muted(){return Ct(this,h)}get readyState(){return Ct(this,u)}get data(){return Ct(this,C)}set data(z){un(this,C,z)}get onmute(){return Ct(this,R)}set onmute(z){Ct(this,R)&&this.removeEventListener("mute",Ct(this,R)),un(this,R,z),z&&this.addEventListener("mute",z)}get onunmute(){return Ct(this,S)}set onunmute(z){Ct(this,S)&&this.removeEventListener("unmute",Ct(this,S)),un(this,S,z),z&&this.addEventListener("unmute",z)}get onended(){return Ct(this,b)}set onended(z){Ct(this,b)&&this.removeEventListener("ended",Ct(this,b)),un(this,b,z),z&&this.addEventListener("ended",z)}get onenabledchange(){return Ct(this,x)}set onenabledchange(z){Ct(this,x)&&this.removeEventListener("enabledchange",Ct(this,x)),un(this,x,z),z&&this.addEventListener("enabledchange",z)}get onstopped(){return Ct(this,E)}set onstopped(z){Ct(this,E)&&this.removeEventListener("stopped",Ct(this,E)),un(this,E,z),z&&this.addEventListener("stopped",z)}addEventListener(z,q,X){super.addEventListener(z,q,X)}removeEventListener(z,q){super.removeEventListener(z,q)}stop(){Ct(this,u)!=="ended"&&(un(this,u,"ended"),this.dispatchEvent(new Event("stopped")))}clone({id:z,data:q}={}){return new i_({id:z??(0,t.v4)(),kind:Ct(this,a),label:Ct(this,o),contentHint:Ct(this,v),enabled:Ct(this,p),muted:Ct(this,h),readyState:Ct(this,u),capabilities:(0,r.clone)(Ct(this,f)),constraints:(0,r.clone)(Ct(this,_)),settings:(0,r.clone)(Ct(this,w)),data:q??(0,r.clone)(Ct(this,C))})}getCapabilities(){return Ct(this,f)}getConstraints(){return Ct(this,_)}applyConstraints(){return H(this,arguments,function*(z={}){return un(this,_,z),Promise.resolve()})}getSettings(){return Ct(this,w)}remoteStop(){Ct(this,u)!=="ended"&&(un(this,u,"ended"),this.dispatchEvent(new Event("stopped")),this.dispatchEvent(new Event("ended")))}remoteMute(){Ct(this,h)||(un(this,h,!0),this.dispatchEvent(new Event("mute")))}remoteUnmute(){Ct(this,h)&&(un(this,h,!1),this.dispatchEvent(new Event("unmute")))}};i=new WeakMap,a=new WeakMap,o=new WeakMap,u=new WeakMap,p=new WeakMap,h=new WeakMap,v=new WeakMap,f=new WeakMap,_=new WeakMap,w=new WeakMap,C=new WeakMap,R=new WeakMap,S=new WeakMap,b=new WeakMap,x=new WeakMap,E=new WeakMap;var Z=M;e.FakeMediaStreamTrack=Z}}),J3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/handlers/FakeHandler.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.FakeHandler=void 0;var t=G3(),n=Jr(),r=Ur(),i=Vo(),a=xs(),o=Di(),u=new r.Logger("FakeHandler"),p="FakeHandler",h=class Nu extends n.EnhancedEventEmitter{constructor({getSendExtendedRtpCapabilities:_},w){super(),ge(this,"_closed",!1),ge(this,"_fakeParameters"),ge(this,"_getSendExtendedRtpCapabilities"),ge(this,"_cname",`CNAME-${i.generateRandomNumber()}`),ge(this,"_transportReady",!1),ge(this,"_nextLocalId",1),ge(this,"_tracks",new Map),ge(this,"_nextSctpStreamId",0),u.debug("constructor()"),this._getSendExtendedRtpCapabilities=_,this._fakeParameters=w}static createFactory(_){return{name:p,factory:w=>new Nu(w,_),getNativeRtpCapabilities:()=>H(null,null,function*(){return u.debug("getNativeRtpCapabilities()"),Nu.getLocalRtpCapabilities(_)}),getNativeSctpCapabilities:()=>H(null,null,function*(){return u.debug("getNativeSctpCapabilities()"),_.generateNativeSctpCapabilities()})}}static getLocalRtpCapabilities(_){return _.generateNativeRtpCapabilities()}get name(){return p}close(){u.debug("close()"),!this._closed&&(this._closed=!0,super.close())}setIceGatheringState(_){this.emit("@icegatheringstatechange",_)}setConnectionState(_){this.emit("@connectionstatechange",_)}updateIceServers(_){return H(this,null,function*(){this.assertNotClosed(),u.debug("updateIceServers()")})}restartIce(_){return H(this,null,function*(){this.assertNotClosed(),u.debug("restartIce()")})}getTransportStats(){return H(this,null,function*(){return this.assertNotClosed(),new Map})}send(_){return H(this,arguments,function*({track:w,encodings:C,codecOptions:R,codec:S}){this.assertNotClosed(),u.debug("send() [kind:%s, track.id:%s]",w.kind,w.id),this._transportReady||(yield this.setupTransport({localDtlsRole:"server"}));const b=Nu.getLocalRtpCapabilities(this._fakeParameters),x=this._getSendExtendedRtpCapabilities(b),E=a.getSendingRtpParameters(w.kind,x);E.codecs=a.reduceCodecs(E.codecs,S);const M=E.codecs.some($=>/.+\/rtx$/i.test($.mimeType));E.mid=`mid-${i.generateRandomNumber()}`,C||(C=[{}]);for(const $ of C)$.ssrc=i.generateRandomNumber(),M&&($.rtx={ssrc:i.generateRandomNumber()});E.encodings=C,E.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const Z=this._nextLocalId++;return this._tracks.set(Z,w),{localId:String(Z),rtpParameters:E}})}stopSending(_){return H(this,null,function*(){if(u.debug("stopSending() [localId:%s]",_),!this._closed){if(!this._tracks.has(Number(_)))throw new Error("local track not found");this._tracks.delete(Number(_))}})}pauseSending(_){return H(this,null,function*(){this.assertNotClosed()})}resumeSending(_){return H(this,null,function*(){this.assertNotClosed()})}replaceTrack(_,w){return H(this,null,function*(){this.assertNotClosed(),w?u.debug("replaceTrack() [localId:%s, track.id:%s]",_,w.id):u.debug("replaceTrack() [localId:%s, no track]",_),this._tracks.delete(Number(_)),this._tracks.set(Number(_),w)})}setMaxSpatialLayer(_,w){return H(this,null,function*(){this.assertNotClosed(),u.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",_,w)})}setRtpEncodingParameters(_,w){return H(this,null,function*(){this.assertNotClosed(),u.debug("setRtpEncodingParameters() [localId:%s, params:%o]",_,w)})}getSenderStats(_){return H(this,null,function*(){return this.assertNotClosed(),new Map})}sendDataChannel(_){return H(this,arguments,function*({ordered:w,maxPacketLifeTime:C,maxRetransmits:R,label:S,protocol:b}){this.assertNotClosed(),this._transportReady||(yield this.setupTransport({localDtlsRole:"server"})),u.debug("sendDataChannel()");const x=new v({id:this._nextSctpStreamId++,ordered:w,maxPacketLifeTime:C,maxRetransmits:R,label:S,protocol:b}),E={streamId:this._nextSctpStreamId,ordered:w,maxPacketLifeTime:C,maxRetransmits:R};return{dataChannel:x,sctpStreamParameters:E}})}receive(_){return H(this,null,function*(){this.assertNotClosed();const w=[];for(const C of _){const{trackId:R,kind:S}=C;this._transportReady||(yield this.setupTransport({localDtlsRole:"client"})),u.debug("receive() [trackId:%s, kind:%s]",R,S);const b=this._nextLocalId++,x=new t.FakeMediaStreamTrack({kind:S});this._tracks.set(b,x),w.push({localId:String(b),track:x})}return w})}stopReceiving(_){return H(this,null,function*(){if(!this._closed)for(const w of _)u.debug("stopReceiving() [localId:%s]",w),this._tracks.delete(Number(w))})}pauseReceiving(_){return H(this,null,function*(){this.assertNotClosed()})}resumeReceiving(_){return H(this,null,function*(){this.assertNotClosed()})}getReceiverStats(_){return H(this,null,function*(){return this.assertNotClosed(),new Map})}receiveDataChannel(_){return H(this,arguments,function*({sctpStreamParameters:w,label:C,protocol:R}){return this.assertNotClosed(),this._transportReady||(yield this.setupTransport({localDtlsRole:"client"})),u.debug("receiveDataChannel()"),{dataChannel:new v({id:w.streamId,ordered:w.ordered,maxPacketLifeTime:w.maxPacketLifeTime,maxRetransmits:w.maxRetransmits,label:C,protocol:R})}})}setupTransport(_){return H(this,arguments,function*({localDtlsRole:w,localSdpObject:C}){const R=i.clone(this._fakeParameters.generateLocalDtlsParameters());w&&(R.role=w),this.emit("@connectionstatechange","connecting"),yield new Promise((S,b)=>this.emit("@connect",{dtlsParameters:R},S,b)),this._transportReady=!0})}assertNotClosed(){if(this._closed)throw new o.InvalidStateError("method called in a closed handler")}};e.FakeHandler=h;var v=class extends EventTarget{constructor({id:f,ordered:_=!0,maxPacketLifeTime:w=null,maxRetransmits:C=null,label:R="",protocol:S=""}){super(),ge(this,"_id"),ge(this,"_negotiated",!0),ge(this,"_ordered"),ge(this,"_maxPacketLifeTime"),ge(this,"_maxRetransmits"),ge(this,"_label"),ge(this,"_protocol"),ge(this,"_readyState","connecting"),ge(this,"_bufferedAmount",0),ge(this,"_bufferedAmountLowThreshold",0),ge(this,"_binaryType","arraybuffer"),ge(this,"_onopen",null),ge(this,"_onclosing",null),ge(this,"_onclose",null),ge(this,"_onmessage",null),ge(this,"_onbufferedamountlow",null),ge(this,"_onerror",null),u.debug(`constructor() [id:${f}, ordered:${_}, maxPacketLifeTime:${w}, maxRetransmits:${C}, label:${R}, protocol:${S}`),this._id=f,this._ordered=_,this._maxPacketLifeTime=w,this._maxRetransmits=C,this._label=R,this._protocol=S}get id(){return this._id}get negotiated(){return this._negotiated}get ordered(){return this._ordered}get maxPacketLifeTime(){return this._maxPacketLifeTime}get maxRetransmits(){return this._maxRetransmits}get label(){return this._label}get protocol(){return this._protocol}get readyState(){return this._readyState}get bufferedAmount(){return this._bufferedAmount}get bufferedAmountLowThreshold(){return this._bufferedAmountLowThreshold}set bufferedAmountLowThreshold(f){this._bufferedAmountLowThreshold=f}get binaryType(){return this._binaryType}set binaryType(f){this._binaryType=f}get onopen(){return this._onopen}set onopen(f){this._onopen&&this.removeEventListener("open",this._onopen),this._onopen=f,f&&this.addEventListener("open",f)}get onclosing(){return this._onclosing}set onclosing(f){this._onclosing&&this.removeEventListener("closing",this._onclosing),this._onclosing=f,f&&this.addEventListener("closing",f)}get onclose(){return this._onclose}set onclose(f){this._onclose&&this.removeEventListener("close",this._onclose),this._onclose=f,f&&this.addEventListener("close",f)}get onmessage(){return this._onmessage}set onmessage(f){this._onmessage&&this.removeEventListener("message",this._onmessage),this._onmessage=f,f&&this.addEventListener("message",f)}get onbufferedamountlow(){return this._onbufferedamountlow}set onbufferedamountlow(f){this._onbufferedamountlow&&this.removeEventListener("bufferedamountlow",this._onbufferedamountlow),this._onbufferedamountlow=f,f&&this.addEventListener("bufferedamountlow",f)}get onerror(){return this._onerror}set onerror(f){this._onerror&&this.removeEventListener("error",this._onerror),this._onerror=f,f&&this.addEventListener("error",f)}addEventListener(f,_,w){super.addEventListener(f,_,w)}removeEventListener(f,_,w){super.removeEventListener(f,_,w)}close(){["closing","closed"].includes(this._readyState)||(this._readyState="closed")}send(f){if(this._readyState!=="open")throw new o.InvalidStateError("not open")}}}}),Z3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/test/fakeParameters.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.generateRouterRtpCapabilities=r,e.generateNativeRtpCapabilities=i,e.generateNativeSctpCapabilities=a,e.generateLocalDtlsParameters=o,e.generateTransportRemoteParameters=u,e.generateProducerRemoteParameters=p,e.generateConsumerRemoteParameters=h,e.generateDataProducerRemoteParameters=v,e.generateDataConsumerRemoteParameters=f;var t=Vo();function n(){return String(t.generateRandomNumber())}function r(){return t.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}},{mimeType:"video/H264",kind:"video",preferredPayloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:105,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"profile-id":0,"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:106,clockRate:9e4,rtcpFeedback:[],parameters:{apt:105}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id",preferredId:2,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id",preferredId:3,preferredEncrypt:!1,direction:"recvonly"},{kind:"audio",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:11,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:12,preferredEncrypt:!1,direction:"sendrecv"}]})}function i(){return t.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:111,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{minptime:10,useinbandfec:1}},{mimeType:"audio/ISAC",kind:"audio",preferredPayloadType:103,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/CN",kind:"audio",preferredPayloadType:106,clockRate:32e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/foo",kind:"audio",preferredPayloadType:107,clockRate:9e4,channels:4,rtcpFeedback:[{type:"foo-qwe-qwe"}],parameters:{foo:"lalala"}},{mimeType:"video/BAZCODEC",kind:"video",preferredPayloadType:100,clockRate:9e4,rtcpFeedback:[{type:"foo"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[],parameters:{apt:100}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:96,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:97,clockRate:9e4,rtcpFeedback:[],parameters:{apt:96}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:98,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{"profile-id":0}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:99,clockRate:9e4,rtcpFeedback:[],parameters:{apt:98}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:2},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:3},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:4},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",preferredId:6},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",preferredId:7},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing",preferredId:8},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10}]})}function a(){return t.deepFreeze({numStreams:{OS:2048,MIS:2048}})}function o(){return t.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"82:5A:68:3D:36:C3:0A:DE:AF:E7:32:43:D2:88:83:57:AC:2D:65:E5:80:C4:B6:FB:AF:1A:A0:21:9F:6D:0C:AD"}],role:"auto"})}function u(){return{id:n(),iceParameters:t.deepFreeze({iceLite:!0,password:"yku5ej8nvfaor28lvtrabcx0wkrpkztz",usernameFragment:"h3hk1iz6qqlnqlne"}),iceCandidates:t.deepFreeze([{foundation:"udpcandidate",address:"9.9.9.9",ip:"9.9.9.9",port:40533,priority:1078862079,protocol:"udp",type:"host",tcpType:"passive"},{foundation:"udpcandidate",address:"9.9.9.9",ip:"9:9:9:9:9:9",port:41333,priority:1078862089,protocol:"udp",type:"host",tcpType:"passive"}]),dtlsParameters:t.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"A9:F4:E0:D2:74:D3:0F:D9:CA:A5:2F:9F:7F:47:FA:F0:C4:72:DD:73:49:D0:3B:14:90:20:51:30:1B:90:8E:71"},{algorithm:"sha-384",value:"03:D9:0B:87:13:98:F6:6D:BC:FC:92:2E:39:D4:E1:97:32:61:30:56:84:70:81:6E:D1:82:97:EA:D9:C1:21:0F:6B:C5:E7:7F:E1:97:0C:17:97:6E:CF:B3:EF:2E:74:B0"},{algorithm:"sha-512",value:"84:27:A4:28:A4:73:AF:43:02:2A:44:68:FF:2F:29:5C:3B:11:9A:60:F4:A8:F0:F5:AC:A0:E3:49:3E:B1:34:53:A9:85:CE:51:9B:ED:87:5E:B8:F4:8E:3D:FA:20:51:B8:96:EE:DA:56:DC:2F:5C:62:79:15:23:E0:21:82:2B:2C"}],role:"auto"}),sctpParameters:t.deepFreeze({port:5e3,OS:2048,MIS:2048,maxMessageSize:2e6})}}function p(){return t.deepFreeze({id:n()})}function h({id:_,codecMimeType:w}={}){switch(w){case"audio/opus":return{id:_??n(),producerId:n(),kind:"audio",rtpParameters:t.deepFreeze({codecs:[{mimeType:"audio/opus",payloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}}],encodings:[{ssrc:46687003}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",id:10}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"audio/ISAC":return{id:_??n(),producerId:n(),kind:"audio",rtpParameters:t.deepFreeze({codecs:[{mimeType:"audio/ISAC",payloadType:111,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}}],encodings:[{ssrc:46687004}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/VP8":return{id:_??n(),producerId:n(),kind:"video",rtpParameters:t.deepFreeze({codecs:[{mimeType:"video/VP8",payloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",payloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}}],encodings:[{ssrc:99991111,rtx:{ssrc:99991112}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/H264":return{id:_??n(),producerId:n(),kind:"video",rtpParameters:t.deepFreeze({codecs:[{mimeType:"video/H264",payloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",payloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}}],encodings:[{ssrc:99991113,rtx:{ssrc:99991114}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};default:throw new TypeError(`unknown codecMimeType '${w}'`)}}function v(){return t.deepFreeze({id:n()})}function f({id:_}={}){return{id:_??n(),dataProducerId:n(),sctpStreamParameters:t.deepFreeze({streamId:666,maxPacketLifeTime:5e3,maxRetransmits:void 0})}}}}),Q3=Ee({"../../node_modules/.pnpm/@skyway-sdk+mediasoup-client@3.15.2/node_modules/@skyway-sdk/mediasoup-client/lib/index.js"(e){Y(),Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.testFakeParameters=e.FakeHandler=e.enhancedEvents=e.ortc=e.parseScalabilityMode=e.detectDeviceAsync=e.detectDevice=e.Device=e.version=e.types=void 0;var t=Xd();e.debug=t.default,e.types=p3(),e.version="3.15.2";var n=I3();Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return n.Device}}),Object.defineProperty(e,"detectDevice",{enumerable:!0,get:function(){return n.detectDevice}}),Object.defineProperty(e,"detectDeviceAsync",{enumerable:!0,get:function(){return n.detectDeviceAsync}});var r=qo();Object.defineProperty(e,"parseScalabilityMode",{enumerable:!0,get:function(){return r.parse}}),e.ortc=xs(),e.enhancedEvents=Jr();var i=J3();Object.defineProperty(e,"FakeHandler",{enumerable:!0,get:function(){return i.FakeHandler}}),e.testFakeParameters=Z3()}});Y();Y();Y();Y();Y();Y();Y();var Dv=["disable","error","warn","info","debug"],Ka=class Ms{constructor(t){this.debug=(...n)=>(this._log("debug",...n),Date.now()),this.info=(...n)=>(this._log("info",...n),Date.now()),this.warn=(...n)=>{this._log("warn",...n)},this.error=(...n)=>{this._log("error",...n)},this.elapsed=(n,...r)=>{const i=Date.now()-n;this._log("info",`elapsed ms:${i}`,...r)},this.prefix=t}_log(t,...n){const r=Dv.indexOf(t);if(Dv.indexOf(Ms.level)>=r){const a=new Date,o=Ms.formatter.formatToParts(a),u=_=>{var w;return(w=o.find(C=>C.type===_))==null?void 0:w.value},p=String(a.getMilliseconds()).padStart(3,"0"),h=`${u("year")}-${u("month")}-${u("day")}T${u("hour")}:${u("minute")}:${u("second")}.${p}+09:00`;n=[this.prefix,...n].map(_=>{if(_ instanceof Error)return _.toJSON?_.toJSON():{name:_.name,message:_.message,stack:_.stack};if(typeof _=="object")try{return JSON.parse(JSON.stringify(_))}catch{return"json error"}return _});let f=[h,t,...n];switch(Ms.format==="string"&&(f=[h+" "+t+" "+JSON.stringify(n)]),t){case"debug":console.debug(...f);break;case"info":console.info(...f);break;case"warn":console.warn(...f);break;case"error":console.error(...f);break}Ms.onLog({id:Ms.id,timestamp:h,level:t,message:n}),Ms._onLogForAnalytics({id:Ms.id,timestamp:h,level:t,message:n,prefix:this.prefix})}}createBlock(t){return{warn:(...n)=>{this.warn(ie({},t),...n)},debug:(...n)=>{this.debug(ie({},t),...n)},info:(...n)=>{this.info(ie({},t),...n)},error:(...n)=>{this.error(ie({},t),...n)}}}};Ka.level="error";Ka.format="object";Ka.onLog=()=>{};Ka._onLogForAnalytics=()=>{};Ka.id=Math.random().toString().slice(2,7);Ka.formatter=new Intl.DateTimeFormat("ja-JP",{timeZone:"Asia/Tokyo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});var Ge=Ka,X3=new Ge("packages/common/src/error.ts"),_r=class extends Error{constructor(e,t=!0){if(super(e.info.detail),this.id=Math.random().toString().slice(2,10),Object.assign(this,e),this.name=this.info.name,t){const n=["SkyWayError",`name:${this.info.name}, detail:${this.info.detail}, solution:${this.info.solution}`];this.path&&n.push(this.path),this.error&&n.push(this.error),this.payload&&n.push(this.payload),n.push(this.id),X3.warn(...n)}}toJSON(){return{id:this.id,info:this.info,path:this.path,payload:this.payload,error:this.error,stack:this.stack}}};Y();var Y3=new Ge("packages/common/src/event.ts"),Qe=class{constructor(e=()=>{}){this._onSetListener=e,this._stack=[],this._eventIndex=0,this.emit=t=>{for(const n of this._stack)try{n.execute(t)}catch(r){Y3.error("task throws error",r)}},this.removeAllListeners=()=>{this._stack=[]},this.pipe=t=>this.add(n=>t.emit(n)),this.add=t=>{const n=this._eventIndex;this._stack.push({execute:t,id:n}),this._eventIndex++;const r=()=>{this._stack=this._stack.filter(a=>a.id!==n&&a)},i=a=>{a.push(r)};return this._onSetListener(),{removeListener:r,disposer:i}},this.once=t=>{const n=this.add(r=>{n.removeListener(),t(r)});return n},this.asPromise=t=>new Promise((n,r)=>{const i=t&&setTimeout(()=>{r(new Nv("Event asPromise timeout : "+t))},t);this.once(a=>{i&&clearTimeout(i),n(a)})}),this.watch=(t,n)=>new Promise((r,i)=>{const a=n&&setTimeout(()=>{i(new Nv("Event watch timeout : "+n))},n),{removeListener:o}=this.add(u=>{t(u)&&(a&&clearTimeout(a),o(),r(u))})})}get length(){return this._stack.length}},Qi=class{constructor(){this.events=[]}make(){const e=new Qe;return this.events.push(e),e}dispose(){this.events.forEach(e=>e.removeAllListeners()),this.events=[]}},Zr=class{constructor(){this._disposer=[]}push(e){this._disposer.push(e)}dispose(){this._disposer.forEach(e=>e()),this._disposer=[]}},Nv=class extends Error{toJSON(){return{name:this.name,message:this.message,stack:this.stack}}};Y();Y();Y();Y();Y();function s_(e,t){return function(){return e.apply(t,arguments)}}var{toString:ex}=Object.prototype,{getPrototypeOf:Gm}=Object,{iterator:nh,toStringTag:a_}=Symbol,rh=(e=>t=>{const n=ex.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ni=e=>(e=e.toLowerCase(),t=>rh(t)===e),ih=e=>t=>typeof t===e,{isArray:zo}=Array,nl=ih("undefined");function tx(e){return e!==null&&!nl(e)&&e.constructor!==null&&!nl(e.constructor)&&Lr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}var o_=Ni("ArrayBuffer");function nx(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&o_(e.buffer),t}var rx=ih("string"),Lr=ih("function"),c_=ih("number"),sh=e=>e!==null&&typeof e=="object",ix=e=>e===!0||e===!1,Ou=e=>{if(rh(e)!=="object")return!1;const t=Gm(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(a_ in e)&&!(nh in e)},sx=Ni("Date"),ax=Ni("File"),ox=Ni("Blob"),cx=Ni("FileList"),lx=e=>sh(e)&&Lr(e.pipe),ux=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Lr(e.append)&&((t=rh(e))==="formdata"||t==="object"&&Lr(e.toString)&&e.toString()==="[object FormData]"))},dx=Ni("URLSearchParams"),[hx,px,fx,mx]=["ReadableStream","Request","Response","Headers"].map(Ni),gx=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pl(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),zo(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const a=n?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let u;for(r=0;r<o;r++)u=a[r],t.call(null,e[u],u,e)}}function l_(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}var ka=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,u_=e=>!nl(e)&&e!==ka;function kf(){const{caseless:e}=u_(this)&&this||{},t={},n=(r,i)=>{const a=e&&l_(t,i)||i;Ou(t[a])&&Ou(r)?t[a]=kf(t[a],r):Ou(r)?t[a]=kf({},r):zo(r)?t[a]=r.slice():t[a]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Pl(arguments[r],n);return t}var vx=(e,t,n,{allOwnKeys:r}={})=>(Pl(t,(i,a)=>{n&&Lr(i)?e[a]=s_(i,n):e[a]=i},{allOwnKeys:r}),e),yx=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),_x=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},bx=(e,t,n,r)=>{let i,a,o;const u={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),a=i.length;a-- >0;)o=i[a],(!r||r(o,e,t))&&!u[o]&&(t[o]=e[o],u[o]=!0);e=n!==!1&&Gm(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Sx=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},wx=e=>{if(!e)return null;if(zo(e))return e;let t=e.length;if(!c_(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},xx=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Gm(Uint8Array)),Cx=(e,t)=>{const r=(e&&e[nh]).call(e);let i;for(;(i=r.next())&&!i.done;){const a=i.value;t.call(e,a[0],a[1])}},Ex=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Px=Ni("HTMLFormElement"),kx=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Ov=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Tx=Ni("RegExp"),d_=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Pl(n,(i,a)=>{let o;(o=t(i,a,e))!==!1&&(r[a]=o||i)}),Object.defineProperties(e,r)},Rx=e=>{d_(e,(t,n)=>{if(Lr(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Lr(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Ax=(e,t)=>{const n={},r=i=>{i.forEach(a=>{n[a]=!0})};return zo(e)?r(e):r(String(e).split(t)),n},Ix=()=>{},Fx=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Dx(e){return!!(e&&Lr(e.append)&&e[a_]==="FormData"&&e[nh])}var Nx=e=>{const t=new Array(10),n=(r,i)=>{if(sh(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const a=zo(r)?[]:{};return Pl(r,(o,u)=>{const p=n(o,i+1);!nl(p)&&(a[u]=p)}),t[i]=void 0,a}}return r};return n(e,0)},Ox=Ni("AsyncFunction"),Mx=e=>e&&(sh(e)||Lr(e))&&Lr(e.then)&&Lr(e.catch),h_=((e,t)=>e?setImmediate:t?((n,r)=>(ka.addEventListener("message",({source:i,data:a})=>{i===ka&&a===n&&r.length&&r.shift()()},!1),i=>{r.push(i),ka.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Lr(ka.postMessage)),Lx=typeof queueMicrotask<"u"?queueMicrotask.bind(ka):typeof Co<"u"&&Co.nextTick||h_,jx=e=>e!=null&&Lr(e[nh]),Ae={isArray:zo,isArrayBuffer:o_,isBuffer:tx,isFormData:ux,isArrayBufferView:nx,isString:rx,isNumber:c_,isBoolean:ix,isObject:sh,isPlainObject:Ou,isReadableStream:hx,isRequest:px,isResponse:fx,isHeaders:mx,isUndefined:nl,isDate:sx,isFile:ax,isBlob:ox,isRegExp:Tx,isFunction:Lr,isStream:lx,isURLSearchParams:dx,isTypedArray:xx,isFileList:cx,forEach:Pl,merge:kf,extend:vx,trim:gx,stripBOM:yx,inherits:_x,toFlatObject:bx,kindOf:rh,kindOfTest:Ni,endsWith:Sx,toArray:wx,forEachEntry:Cx,matchAll:Ex,isHTMLForm:Px,hasOwnProperty:Ov,hasOwnProp:Ov,reduceDescriptors:d_,freezeMethods:Rx,toObjectSet:Ax,toCamelCase:kx,noop:Ix,toFiniteNumber:Fx,findKey:l_,global:ka,isContextDefined:u_,isSpecCompliantForm:Dx,toJSONObject:Nx,isAsyncFn:Ox,isThenable:Mx,setImmediate:h_,asap:Lx,isIterable:jx};Y();Y();Y();Y();Y();function Do(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}Ae.inherits(Do,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ae.toJSONObject(this.config),code:this.code,status:this.status}}});var p_=Do.prototype,f_={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{f_[e]={value:e}});Object.defineProperties(Do,f_);Object.defineProperty(p_,"isAxiosError",{value:!0});Do.from=(e,t,n,r,i,a)=>{const o=Object.create(p_);return Ae.toFlatObject(e,o,function(p){return p!==Error.prototype},u=>u!=="isAxiosError"),Do.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};var Ot=Do;Y();var Bx=null;function Tf(e){return Ae.isPlainObject(e)||Ae.isArray(e)}function m_(e){return Ae.endsWith(e,"[]")?e.slice(0,-2):e}function Mv(e,t,n){return e?e.concat(t).map(function(i,a){return i=m_(i),!n&&a?"["+i+"]":i}).join(n?".":""):t}function Ux(e){return Ae.isArray(e)&&!e.some(Tf)}var Hx=Ae.toFlatObject(Ae,{},null,function(t){return/^is[A-Z]/.test(t)});function Vx(e,t,n){if(!Ae.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Ae.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(R,S){return!Ae.isUndefined(S[R])});const r=n.metaTokens,i=n.visitor||v,a=n.dots,o=n.indexes,p=(n.Blob||typeof Blob<"u"&&Blob)&&Ae.isSpecCompliantForm(t);if(!Ae.isFunction(i))throw new TypeError("visitor must be a function");function h(C){if(C===null)return"";if(Ae.isDate(C))return C.toISOString();if(Ae.isBoolean(C))return C.toString();if(!p&&Ae.isBlob(C))throw new Ot("Blob is not supported. Use a Buffer instead.");return Ae.isArrayBuffer(C)||Ae.isTypedArray(C)?p&&typeof Blob=="function"?new Blob([C]):Buffer.from(C):C}function v(C,R,S){let b=C;if(C&&!S&&typeof C=="object"){if(Ae.endsWith(R,"{}"))R=r?R:R.slice(0,-2),C=JSON.stringify(C);else if(Ae.isArray(C)&&Ux(C)||(Ae.isFileList(C)||Ae.endsWith(R,"[]"))&&(b=Ae.toArray(C)))return R=m_(R),b.forEach(function(E,M){!(Ae.isUndefined(E)||E===null)&&t.append(o===!0?Mv([R],M,a):o===null?R:R+"[]",h(E))}),!1}return Tf(C)?!0:(t.append(Mv(S,R,a),h(C)),!1)}const f=[],_=Object.assign(Hx,{defaultVisitor:v,convertValue:h,isVisitable:Tf});function w(C,R){if(!Ae.isUndefined(C)){if(f.indexOf(C)!==-1)throw Error("Circular reference detected in "+R.join("."));f.push(C),Ae.forEach(C,function(b,x){(!(Ae.isUndefined(b)||b===null)&&i.call(t,b,Ae.isString(x)?x.trim():x,R,_))===!0&&w(b,R?R.concat(x):[x])}),f.pop()}}if(!Ae.isObject(e))throw new TypeError("data must be an object");return w(e),t}var ah=Vx;function Lv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function g_(e,t){this._pairs=[],e&&ah(e,this,t)}var v_=g_.prototype;v_.append=function(t,n){this._pairs.push([t,n])};v_.toString=function(t){const n=t?function(r){return t.call(this,r,Lv)}:Lv;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};var y_=g_;function qx(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function __(e,t,n){if(!t)return e;const r=n&&n.encode||qx;Ae.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let a;if(i?a=i(t,n):a=Ae.isURLSearchParams(t)?t.toString():new y_(t,n).toString(r),a){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}Y();var zx=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ae.forEach(this.handlers,function(n){n!==null&&e(n)})}},jv=zx;Y();Y();Y();Y();var b_={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};Y();Y();Y();Y();var Kx=typeof URLSearchParams<"u"?URLSearchParams:y_;Y();var $x=typeof FormData<"u"?FormData:null;Y();var Wx=typeof Blob<"u"?Blob:null,Gx={isBrowser:!0,classes:{URLSearchParams:Kx,FormData:$x,Blob:Wx},protocols:["http","https","file","blob","url","data"]},S_={};Dy(S_,{hasBrowserEnv:()=>Jm,hasStandardBrowserEnv:()=>Jx,hasStandardBrowserWebWorkerEnv:()=>Zx,navigator:()=>Rf,origin:()=>Qx});Y();var Jm=typeof window<"u"&&typeof document<"u",Rf=typeof navigator=="object"&&navigator||void 0,Jx=Jm&&(!Rf||["ReactNative","NativeScript","NS"].indexOf(Rf.product)<0),Zx=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Qx=Jm&&window.location.href||"http://localhost",lr=ie(ie({},S_),Gx);function Xx(e,t){return ah(e,new lr.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,a){return lr.isNode&&Ae.isBuffer(n)?(this.append(r,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}Y();function Yx(e){return Ae.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function eC(e){const t={},n=Object.keys(e);let r;const i=n.length;let a;for(r=0;r<i;r++)a=n[r],t[a]=e[a];return t}function tC(e){function t(n,r,i,a){let o=n[a++];if(o==="__proto__")return!0;const u=Number.isFinite(+o),p=a>=n.length;return o=!o&&Ae.isArray(i)?i.length:o,p?(Ae.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!u):((!i[o]||!Ae.isObject(i[o]))&&(i[o]=[]),t(n,r,i[o],a)&&Ae.isArray(i[o])&&(i[o]=eC(i[o])),!u)}if(Ae.isFormData(e)&&Ae.isFunction(e.entries)){const n={};return Ae.forEachEntry(e,(r,i)=>{t(Yx(r),i,n,0)}),n}return null}var w_=tC;function nC(e,t,n){if(Ae.isString(e))try{return(t||JSON.parse)(e),Ae.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}var Zm={transitional:b_,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,a=Ae.isObject(t);if(a&&Ae.isHTMLForm(t)&&(t=new FormData(t)),Ae.isFormData(t))return i?JSON.stringify(w_(t)):t;if(Ae.isArrayBuffer(t)||Ae.isBuffer(t)||Ae.isStream(t)||Ae.isFile(t)||Ae.isBlob(t)||Ae.isReadableStream(t))return t;if(Ae.isArrayBufferView(t))return t.buffer;if(Ae.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Xx(t,this.formSerializer).toString();if((u=Ae.isFileList(t))||r.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return ah(u?{"files[]":t}:t,p&&new p,this.formSerializer)}}return a||i?(n.setContentType("application/json",!1),nC(t)):t}],transformResponse:[function(t){const n=this.transitional||Zm.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(Ae.isResponse(t)||Ae.isReadableStream(t))return t;if(t&&Ae.isString(t)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(u){if(o)throw u.name==="SyntaxError"?Ot.from(u,Ot.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:lr.classes.FormData,Blob:lr.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ae.forEach(["delete","get","head","post","put","patch"],e=>{Zm.headers[e]={}});var Qm=Zm;Y();Y();var rC=Ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),iC=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||t[n]&&rC[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Bv=Symbol("internals");function mc(e){return e&&String(e).trim().toLowerCase()}function Mu(e){return e===!1||e==null?e:Ae.isArray(e)?e.map(Mu):String(e)}function sC(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}var aC=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function mp(e,t,n,r,i){if(Ae.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!Ae.isString(t)){if(Ae.isString(r))return t.indexOf(r)!==-1;if(Ae.isRegExp(r))return r.test(t)}}function oC(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function cC(e,t){const n=Ae.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,a,o){return this[r].call(this,t,i,a,o)},configurable:!0})})}var oh=class{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(o,u,p){const h=mc(u);if(!h)throw new Error("header name must be a non-empty string");const v=Ae.findKey(r,h);(!v||r[v]===void 0||p===!0||p===void 0&&r[v]!==!1)&&(r[v||u]=Mu(o))}const a=(o,u)=>Ae.forEach(o,(p,h)=>i(p,h,u));if(Ae.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(Ae.isString(e)&&(e=e.trim())&&!aC(e))a(iC(e),t);else if(Ae.isObject(e)&&Ae.isIterable(e)){let o={},u,p;for(const h of e){if(!Ae.isArray(h))throw TypeError("Object iterator must return a key-value pair");o[p=h[0]]=(u=o[p])?Ae.isArray(u)?[...u,h[1]]:[u,h[1]]:h[1]}a(o,t)}else e!=null&&i(t,e,n);return this}get(e,t){if(e=mc(e),e){const n=Ae.findKey(this,e);if(n){const r=this[n];if(!t)return r;if(t===!0)return sC(r);if(Ae.isFunction(t))return t.call(this,r,n);if(Ae.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=mc(e),e){const n=Ae.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||mp(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let r=!1;function i(a){if(a=mc(a),a){const o=Ae.findKey(n,a);o&&(!t||mp(n,n[o],o,t))&&(delete n[o],r=!0)}}return Ae.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];(!e||mp(this,this[i],i,e,!0))&&(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return Ae.forEach(this,(r,i)=>{const a=Ae.findKey(n,i);if(a){t[a]=Mu(r),delete t[i];return}const o=e?oC(i):String(i).trim();o!==i&&delete t[i],t[o]=Mu(r),n[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Ae.forEach(this,(n,r)=>{n!=null&&n!==!1&&(t[r]=e&&Ae.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(r=>n.set(r)),n}static accessor(e){const n=(this[Bv]=this[Bv]={accessors:{}}).accessors,r=this.prototype;function i(a){const o=mc(a);n[o]||(cC(r,a),n[o]=!0)}return Ae.isArray(e)?e.forEach(i):i(e),this}};oh.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ae.reduceDescriptors(oh.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});Ae.freezeMethods(oh);var Ti=oh;function gp(e,t){const n=this||Qm,r=t||n,i=Ti.from(r.headers);let a=r.data;return Ae.forEach(e,function(u){a=u.call(n,a,i.normalize(),t?t.status:void 0)}),i.normalize(),a}Y();function x_(e){return!!(e&&e.__CANCEL__)}Y();function C_(e,t,n){Ot.call(this,e??"canceled",Ot.ERR_CANCELED,t,n),this.name="CanceledError"}Ae.inherits(C_,Ot,{__CANCEL__:!0});var kl=C_;Y();Y();Y();function E_(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new Ot("Request failed with status code "+n.status,[Ot.ERR_BAD_REQUEST,Ot.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}Y();function lC(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}Y();Y();function uC(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,a=0,o;return t=t!==void 0?t:1e3,function(p){const h=Date.now(),v=r[a];o||(o=h),n[i]=p,r[i]=h;let f=a,_=0;for(;f!==i;)_+=n[f++],f=f%e;if(i=(i+1)%e,i===a&&(a=(a+1)%e),h-o<t)return;const w=v&&h-v;return w?Math.round(_*1e3/w):void 0}}var dC=uC;Y();function hC(e,t){let n=0,r=1e3/t,i,a;const o=(h,v=Date.now())=>{n=v,i=null,a&&(clearTimeout(a),a=null),e.apply(null,h)};return[(...h)=>{const v=Date.now(),f=v-n;f>=r?o(h,v):(i=h,a||(a=setTimeout(()=>{a=null,o(i)},r-f)))},()=>i&&o(i)]}var pC=hC,md=(e,t,n=3)=>{let r=0;const i=dC(50,250);return pC(a=>{const o=a.loaded,u=a.lengthComputable?a.total:void 0,p=o-r,h=i(p),v=o<=u;r=o;const f={loaded:o,total:u,progress:u?o/u:void 0,bytes:p,rate:h||void 0,estimated:h&&u&&v?(u-o)/h:void 0,event:a,lengthComputable:u!=null,[t?"download":"upload"]:!0};e(f)},n)},Uv=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Hv=e=>(...t)=>Ae.asap(()=>e(...t));Y();Y();var fC=lr.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,lr.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(lr.origin),lr.navigator&&/(msie|trident)/i.test(lr.navigator.userAgent)):()=>!0;Y();var mC=lr.hasStandardBrowserEnv?{write(e,t,n,r,i,a){const o=[e+"="+encodeURIComponent(t)];Ae.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Ae.isString(r)&&o.push("path="+r),Ae.isString(i)&&o.push("domain="+i),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};Y();Y();function gC(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}Y();function vC(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function P_(e,t,n){let r=!gC(t);return e&&(r||n==!1)?vC(e,t):t}Y();var Vv=e=>e instanceof Ti?ie({},e):e;function Ua(e,t){t=t||{};const n={};function r(h,v,f,_){return Ae.isPlainObject(h)&&Ae.isPlainObject(v)?Ae.merge.call({caseless:_},h,v):Ae.isPlainObject(v)?Ae.merge({},v):Ae.isArray(v)?v.slice():v}function i(h,v,f,_){if(Ae.isUndefined(v)){if(!Ae.isUndefined(h))return r(void 0,h,f,_)}else return r(h,v,f,_)}function a(h,v){if(!Ae.isUndefined(v))return r(void 0,v)}function o(h,v){if(Ae.isUndefined(v)){if(!Ae.isUndefined(h))return r(void 0,h)}else return r(void 0,v)}function u(h,v,f){if(f in t)return r(h,v);if(f in e)return r(void 0,h)}const p={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u,headers:(h,v,f)=>i(Vv(h),Vv(v),f,!0)};return Ae.forEach(Object.keys(Object.assign({},e,t)),function(v){const f=p[v]||i,_=f(e[v],t[v],v);Ae.isUndefined(_)&&f!==u||(n[v]=_)}),n}var k_=e=>{const t=Ua({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:u}=t;t.headers=o=Ti.from(o),t.url=__(P_(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&o.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let p;if(Ae.isFormData(n)){if(lr.hasStandardBrowserEnv||lr.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((p=o.getContentType())!==!1){const[h,...v]=p?p.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...v].join("; "))}}if(lr.hasStandardBrowserEnv&&(r&&Ae.isFunction(r)&&(r=r(t)),r||r!==!1&&fC(t.url))){const h=i&&a&&mC.read(a);h&&o.set(i,h)}return t},yC=typeof XMLHttpRequest<"u",_C=yC&&function(e){return new Promise(function(n,r){const i=k_(e);let a=i.data;const o=Ti.from(i.headers).normalize();let{responseType:u,onUploadProgress:p,onDownloadProgress:h}=i,v,f,_,w,C;function R(){w&&w(),C&&C(),i.cancelToken&&i.cancelToken.unsubscribe(v),i.signal&&i.signal.removeEventListener("abort",v)}let S=new XMLHttpRequest;S.open(i.method.toUpperCase(),i.url,!0),S.timeout=i.timeout;function b(){if(!S)return;const E=Ti.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders()),Z={data:!u||u==="text"||u==="json"?S.responseText:S.response,status:S.status,statusText:S.statusText,headers:E,config:e,request:S};E_(function(z){n(z),R()},function(z){r(z),R()},Z),S=null}"onloadend"in S?S.onloadend=b:S.onreadystatechange=function(){!S||S.readyState!==4||S.status===0&&!(S.responseURL&&S.responseURL.indexOf("file:")===0)||setTimeout(b)},S.onabort=function(){S&&(r(new Ot("Request aborted",Ot.ECONNABORTED,e,S)),S=null)},S.onerror=function(){r(new Ot("Network Error",Ot.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let M=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const Z=i.transitional||b_;i.timeoutErrorMessage&&(M=i.timeoutErrorMessage),r(new Ot(M,Z.clarifyTimeoutError?Ot.ETIMEDOUT:Ot.ECONNABORTED,e,S)),S=null},a===void 0&&o.setContentType(null),"setRequestHeader"in S&&Ae.forEach(o.toJSON(),function(M,Z){S.setRequestHeader(Z,M)}),Ae.isUndefined(i.withCredentials)||(S.withCredentials=!!i.withCredentials),u&&u!=="json"&&(S.responseType=i.responseType),h&&([_,C]=md(h,!0),S.addEventListener("progress",_)),p&&S.upload&&([f,w]=md(p),S.upload.addEventListener("progress",f),S.upload.addEventListener("loadend",w)),(i.cancelToken||i.signal)&&(v=E=>{S&&(r(!E||E.type?new kl(null,e,S):E),S.abort(),S=null)},i.cancelToken&&i.cancelToken.subscribe(v),i.signal&&(i.signal.aborted?v():i.signal.addEventListener("abort",v)));const x=lC(i.url);if(x&&lr.protocols.indexOf(x)===-1){r(new Ot("Unsupported protocol "+x+":",Ot.ERR_BAD_REQUEST,e));return}S.send(a||null)})};Y();Y();var bC=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const a=function(h){if(!i){i=!0,u();const v=h instanceof Error?h:this.reason;r.abort(v instanceof Ot?v:new kl(v instanceof Error?v.message:v))}};let o=t&&setTimeout(()=>{o=null,a(new Ot(`timeout ${t} of ms exceeded`,Ot.ETIMEDOUT))},t);const u=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(a):h.removeEventListener("abort",a)}),e=null)};e.forEach(h=>h.addEventListener("abort",a));const{signal:p}=r;return p.unsubscribe=()=>Ae.asap(u),p}},SC=bC;Y();var wC=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},xC=function(e,t){return Oy(this,null,function*(){try{for(var n=Ww(CC(e)),r,i,a;r=!(i=yield new Fo(n.next())).done;r=!1){const o=i.value;yield*My(wC(o,t))}}catch(o){a=[o]}finally{try{r&&(i=n.return)&&(yield new Fo(i.call(n)))}finally{if(a)throw a[0]}}})},CC=function(e){return Oy(this,null,function*(){if(e[Symbol.asyncIterator]){yield*My(e);return}const t=e.getReader();try{for(;;){const{done:n,value:r}=yield new Fo(t.read());if(n)break;yield r}}finally{yield new Fo(t.cancel())}})},qv=(e,t,n,r)=>{const i=xC(e,t);let a=0,o,u=p=>{o||(o=!0,r&&r(p))};return new ReadableStream({pull(p){return H(this,null,function*(){try{const{done:h,value:v}=yield i.next();if(h){u(),p.close();return}let f=v.byteLength;if(n){let _=a+=f;n(_)}p.enqueue(new Uint8Array(v))}catch(h){throw u(h),h}})},cancel(p){return u(p),i.return()}},{highWaterMark:2})},ch=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",T_=ch&&typeof ReadableStream=="function",EC=ch&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):e=>H(null,null,function*(){return new Uint8Array(yield new Response(e).arrayBuffer())})),R_=(e,...t)=>{try{return!!e(...t)}catch{return!1}},PC=T_&&R_(()=>{let e=!1;const t=new Request(lr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),zv=64*1024,Af=T_&&R_(()=>Ae.isReadableStream(new Response("").body)),gd={stream:Af&&(e=>e.body)};ch&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!gd[t]&&(gd[t]=Ae.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new Ot(`Response type '${t}' is not supported`,Ot.ERR_NOT_SUPPORT,r)})})})(new Response);var kC=e=>H(null,null,function*(){if(e==null)return 0;if(Ae.isBlob(e))return e.size;if(Ae.isSpecCompliantForm(e))return(yield new Request(lr.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Ae.isArrayBufferView(e)||Ae.isArrayBuffer(e))return e.byteLength;if(Ae.isURLSearchParams(e)&&(e=e+""),Ae.isString(e))return(yield EC(e)).byteLength}),TC=(e,t)=>H(null,null,function*(){const n=Ae.toFiniteNumber(e.getContentLength());return n??kC(t)}),RC=ch&&(e=>H(null,null,function*(){let{url:t,method:n,data:r,signal:i,cancelToken:a,timeout:o,onDownloadProgress:u,onUploadProgress:p,responseType:h,headers:v,withCredentials:f="same-origin",fetchOptions:_}=k_(e);h=h?(h+"").toLowerCase():"text";let w=SC([i,a&&a.toAbortSignal()],o),C;const R=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let S;try{if(p&&PC&&n!=="get"&&n!=="head"&&(S=yield TC(v,r))!==0){let Z=new Request(t,{method:"POST",body:r,duplex:"half"}),$;if(Ae.isFormData(r)&&($=Z.headers.get("content-type"))&&v.setContentType($),Z.body){const[z,q]=Uv(S,md(Hv(p)));r=qv(Z.body,zv,z,q)}}Ae.isString(f)||(f=f?"include":"omit");const b="credentials"in Request.prototype;C=new Request(t,we(ie({},_),{signal:w,method:n.toUpperCase(),headers:v.normalize().toJSON(),body:r,duplex:"half",credentials:b?f:void 0}));let x=yield fetch(C,_);const E=Af&&(h==="stream"||h==="response");if(Af&&(u||E&&R)){const Z={};["status","statusText","headers"].forEach(X=>{Z[X]=x[X]});const $=Ae.toFiniteNumber(x.headers.get("content-length")),[z,q]=u&&Uv($,md(Hv(u),!0))||[];x=new Response(qv(x.body,zv,z,()=>{q&&q(),R&&R()}),Z)}h=h||"text";let M=yield gd[Ae.findKey(gd,h)||"text"](x,e);return!E&&R&&R(),yield new Promise((Z,$)=>{E_(Z,$,{data:M,headers:Ti.from(x.headers),status:x.status,statusText:x.statusText,config:e,request:C})})}catch(b){throw R&&R(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new Ot("Network Error",Ot.ERR_NETWORK,e,C),{cause:b.cause||b}):Ot.from(b,b&&b.code,e,C)}})),If={http:Bx,xhr:_C,fetch:RC};Ae.forEach(If,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});var Kv=e=>`- ${e}`,AC=e=>Ae.isFunction(e)||e===null||e===!1,A_={getAdapter:e=>{e=Ae.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let a=0;a<t;a++){n=e[a];let o;if(r=n,!AC(n)&&(r=If[(o=String(n)).toLowerCase()],r===void 0))throw new Ot(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+a]=r}if(!r){const a=Object.entries(i).map(([u,p])=>`adapter ${u} `+(p===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(Kv).join(`
`):" "+Kv(a[0]):"as no adapter specified";throw new Ot("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:If};function vp(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new kl(null,e)}function $v(e){return vp(e),e.headers=Ti.from(e.headers),e.data=gp.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),A_.getAdapter(e.adapter||Qm.adapter)(e).then(function(r){return vp(e),r.data=gp.call(e,e.transformResponse,r),r.headers=Ti.from(r.headers),r},function(r){return x_(r)||(vp(e),r&&r.response&&(r.response.data=gp.call(e,e.transformResponse,r.response),r.response.headers=Ti.from(r.response.headers))),Promise.reject(r)})}Y();Y();var I_="1.10.0",lh={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{lh[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});var Wv={};lh.transitional=function(t,n,r){function i(a,o){return"[Axios v"+I_+"] Transitional option '"+a+"'"+o+(r?". "+r:"")}return(a,o,u)=>{if(t===!1)throw new Ot(i(o," has been removed"+(n?" in "+n:"")),Ot.ERR_DEPRECATED);return n&&!Wv[o]&&(Wv[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(a,o,u):!0}};lh.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function IC(e,t,n){if(typeof e!="object")throw new Ot("options must be an object",Ot.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const a=r[i],o=t[a];if(o){const u=e[a],p=u===void 0||o(u,a,e);if(p!==!0)throw new Ot("option "+a+" must be "+p,Ot.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ot("Unknown option "+a,Ot.ERR_BAD_OPTION)}}var Lu={assertOptions:IC,validators:lh},qi=Lu.validators,vd=class{constructor(e){this.defaults=e||{},this.interceptors={request:new jv,response:new jv}}request(e,t){return H(this,null,function*(){try{return yield this._request(e,t)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}})}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ua(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;n!==void 0&&Lu.assertOptions(n,{silentJSONParsing:qi.transitional(qi.boolean),forcedJSONParsing:qi.transitional(qi.boolean),clarifyTimeoutError:qi.transitional(qi.boolean)},!1),r!=null&&(Ae.isFunction(r)?t.paramsSerializer={serialize:r}:Lu.assertOptions(r,{encode:qi.function,serialize:qi.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Lu.assertOptions(t,{baseUrl:qi.spelling("baseURL"),withXsrfToken:qi.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=i&&Ae.merge(i.common,i[t.method]);i&&Ae.forEach(["delete","get","head","post","put","patch","common"],w=>{delete i[w]}),t.headers=Ti.concat(a,i);const o=[];let u=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(t)===!1||(u=u&&C.synchronous,o.unshift(C.fulfilled,C.rejected))});const p=[];this.interceptors.response.forEach(function(C){p.push(C.fulfilled,C.rejected)});let h,v=0,f;if(!u){const w=[$v.bind(this),void 0];for(w.unshift.apply(w,o),w.push.apply(w,p),f=w.length,h=Promise.resolve(t);v<f;)h=h.then(w[v++],w[v++]);return h}f=o.length;let _=t;for(v=0;v<f;){const w=o[v++],C=o[v++];try{_=w(_)}catch(R){C.call(this,R);break}}try{h=$v.call(this,_)}catch(w){return Promise.reject(w)}for(v=0,f=p.length;v<f;)h=h.then(p[v++],p[v++]);return h}getUri(e){e=Ua(this.defaults,e);const t=P_(e.baseURL,e.url,e.allowAbsoluteUrls);return __(t,e.params,e.paramsSerializer)}};Ae.forEach(["delete","get","head","options"],function(t){vd.prototype[t]=function(n,r){return this.request(Ua(r||{},{method:t,url:n,data:(r||{}).data}))}});Ae.forEach(["post","put","patch"],function(t){function n(r){return function(a,o,u){return this.request(Ua(u||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}vd.prototype[t]=n(),vd.prototype[t+"Form"]=n(!0)});var ju=vd;Y();var FC=class F_{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const r=this;this.promise.then(i=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](i);r._listeners=null}),this.promise.then=i=>{let a;const o=new Promise(u=>{r.subscribe(u),a=u}).then(i);return o.cancel=function(){r.unsubscribe(a)},o},t(function(a,o,u){r.reason||(r.reason=new kl(a,o,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new F_(function(i){t=i}),cancel:t}}},DC=FC;Y();function NC(e){return function(n){return e.apply(null,n)}}Y();function OC(e){return Ae.isObject(e)&&e.isAxiosError===!0}Y();var Ff={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ff).forEach(([e,t])=>{Ff[t]=e});var MC=Ff;function D_(e){const t=new ju(e),n=s_(ju.prototype.request,t);return Ae.extend(n,ju.prototype,t,{allOwnKeys:!0}),Ae.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return D_(Ua(e,i))},n}var Dn=D_(Qm);Dn.Axios=ju;Dn.CanceledError=kl;Dn.CancelToken=DC;Dn.isCancel=x_;Dn.VERSION=I_;Dn.toFormData=ah;Dn.AxiosError=Ot;Dn.Cancel=Dn.CanceledError;Dn.all=function(t){return Promise.all(t)};Dn.spread=NC;Dn.isAxiosError=OC;Dn.mergeConfig=Ua;Dn.AxiosHeaders=Ti;Dn.formToJSON=e=>w_(Ae.isHTMLForm(e)?new FormData(e):e);Dn.getAdapter=A_.getAdapter;Dn.HttpStatusCode=MC;Dn.default=Dn;var Ya=Dn,{Axios:qk,AxiosError:zk,CanceledError:Kk,isCancel:$k,CancelToken:Wk,VERSION:Gk,all:Jk,Cancel:Zk,isAxiosError:Qk,spread:Xk,toFormData:Yk,AxiosHeaders:eT,HttpStatusCode:tT,formToJSON:nT,getAdapter:rT,mergeConfig:iT}=Ya,gi=new Ge("packages/common/src/http.ts"),Xm=class{constructor(e){this.api=Ya.create({baseURL:e})}get(e,t){return H(this,null,function*(){const n=yield this.api.get(e,t).catch(r=>r);if(Ya.isAxiosError(n)){const r=we(ie({},n.response),{message:n.message});if(t!=null&&t.retry){if(yield t.retry(r))return gi.warn("retry get",{url:e}),this.get(e,t);throw gi.warn("retry get failed",{url:e}),r}throw gi.warn("response error",{error:r}),r}else return n.data})}post(e,t,n){return H(this,null,function*(){var r,i,a;const o=yield this.api.post(e,t,n).catch(u=>u);if(Ya.isAxiosError(o)){const u={data:(r=o.response)==null?void 0:r.data,status:(i=o.response)==null?void 0:i.status,statusText:(a=o.response)==null?void 0:a.statusText,message:o.message};if(gi.warn("error received",u),n!=null&&n.retry){const p=yield n.retry(u);if(p)return gi.warn("retry post",e,{data:t,error:u,needRetry:p}),this.post(e,t,n);throw u}throw u}else return o.data})}put(e,t,n){return H(this,null,function*(){const r=yield this.api.put(e,t,n).catch(i=>i);if(Ya.isAxiosError(r)){const i=we(ie({},r.response),{message:r.message});if(n!=null&&n.retry){if(yield n.retry(i))return gi.warn("retry put",{url:e,data:t}),this.put(e,t,n);throw gi.warn("retry put failed",{url:e,data:t}),i}throw gi.warn("response error",{error:i}),i}else return r.data})}delete(e,t){return H(this,null,function*(){const n=yield this.api.delete(e,t).catch(r=>r);if(Ya.isAxiosError(n)){const r=we(ie({},n.response),{message:n.message});if(t!=null&&t.retry){if(yield t.retry(r))return gi.warn("retry delete",{url:e}),this.delete(e,t);throw gi.warn("retry delete failed",{url:e}),r}throw gi.warn("response error",{error:r}),r}else return n.data})}};Y();var LC=new Ge("packages/common/src/promise.ts"),ca=class{constructor(){this.id=Math.random().toString().slice(2),this.queue=[],this.running=!1,this.push=e=>new Promise((t,n)=>{this.queue.push({promise:e,done:t,failed:n}),this.running||this.run().catch(r=>{LC.error("push",r)})})}run(){return H(this,null,function*(){const e=this.queue.shift();if(e){this.running=!0;try{const t=yield e.promise();e.done(t)}catch(t){e.failed(t)}yield this.run()}else this.running=!1})}};Y();var Ci=class{constructor(e={}){this.count=0,this.times=8,this.interval=100,this.jitter=0,Object.assign(this,e)}wait(){return H(this,null,function*(){if(this.exceeded)return!1;const e=this.timeout;return this.count++,yield new Promise(t=>setTimeout(t,e)),!0})}get timeout(){return _s(this.count,2)*this.interval+_s(this.count,2)*this.jitter*Math.random()}get exceeded(){return this.count>=this.times}reset(){this.count=0}},jC=e=>JSON.parse(JSON.stringify(e));Y();var Ve={internal:{name:"internal",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},missingProperty:{name:"missingProperty",detail:"",solution:""},notFound:{name:"notFound",detail:"",solution:""},invalidParameter:{name:"invalidParameter",detail:"",solution:""},invalidArgumentValue:{name:"invalidArgumentValue",detail:"",solution:""},invalidContentType:{name:"invalidContentType",detail:"contentType",solution:"ContentType"},localPersonNotJoinedChannel:{name:"localPersonNotJoinedChannel",detail:"PersonChannel The person who tried to operate is not in the channel, so the operation is not possible",solution:"ChannelPerson Please check as you may be operating a person which is not in the channel"},alreadyLocalPersonExist:{name:"alreadyLocalPersonExist",detail:"ChannelLocalPersonChannelLocalPersonJoin",solution:"LocalPersonChannel"},alreadySameNameMemberExist:{name:"alreadySameNameMemberExist",detail:"ChannelNameMember",solution:"Name"},alreadyPublishedStream:{name:"alreadyPublishedStream",detail:"PublishStreamPublish You cannot re-publish a stream that has already been published",solution:"StreamPublishPublicationUnpublishStreamPublish Unpublish the publication that published that stream, or create another new stream and publish it"},alreadySubscribedPublication:{name:"alreadySubscribedPublication",detail:"SubscribePublicationSubscribe",solution:""},invalidTrackKind:{name:"invalidTrackKind",detail:"StreamMediaStreamTrack",solution:"StreamMediaStreamTrack"},cantMoveSameIdChannel:{name:"cantMoveSameIdChannel",detail:"moveChannelidChannel",solution:"Channel"},alreadyChannelClosed:{name:"alreadyChannelClosed",detail:"ChannelClose",solution:""},disabledDataStream:{name:"disabledDataStream",detail:"PublicationDisableDataStream",solution:"PublicationEnable"},publicationNotExist:{name:"publicationNotExist",detail:"channelPublication",solution:"publicationId"},subscriptionNotExist:{name:"subscriptionNotExist",detail:"channelSubscription",solution:"subscriptionId"},unknownMemberType:{name:"unknownMemberType",detail:"MemberSubtype",solution:"MemberSubtype(SfuBot)SkyWayContext"},streamNotExistInSubscription:{name:"streamNotExistInSubscription",detail:"SubscriptionStreamRemoteMemberSubscriptionStream",solution:"Subscription"},streamNotExistInPublication:{name:"streamNotExistInPublication",detail:"PublicationStreamRemoteMemberPublicationStream",solution:"Publication"},dataStreamNotSupportEncoding:{name:"dataStreamNotSupportEncoding",detail:"dataStreamEncode",solution:""},correspondingEncodeNotExistForId:{name:"correspondingEncodeNotExistForId",detail:"IDEncode",solution:"EncodingID"},updateIceParamsFailed:{name:"updateIceParamsFailed",detail:"iceParams",solution:""},invalidElement:{name:"invalidElement",detail:"HTML Element",solution:"Element"},connectRtcApiFailed:{name:"connectRtcApiFailed",detail:"RtcAPI",solution:"Token"},rtcApiFatalError:{name:"rtcApiFatalError",detail:"RtcAPI",solution:""},invalidExpireTokenValue:{name:"invalidExpireTokenValue",detail:"tokenExpire",solution:""},invalidRemindExpireTokenValue:{name:"invalidRemindExpireTokenValue",detail:"tokenExpire",solution:""},invalidTokenAppId:{name:"invalidTokenAppId",detail:"tokenappId",solution:"appIdToken"},mediaDevicesNotFound:{name:"mediaDevicesNotFound",detail:"navigator.mediaDevices",solution:"https,localhost,127.0.0.1"},canNotUseReplaceStream:{name:"canNotUseReplaceStream",detail:"remotePublicationreplaceStream",solution:"PublicationLocal"},canNotEnableRemotePublication:{name:"canNotEnableRemotePublication",detail:"remotePublicationenable",solution:"PublicationLocal"}};Y();Y();Y();var BC=Br(Gw());Br(Fi());var UC=Br(Ly()),HC=new Ge("packages/core/src/util.ts");function No(e){const t=[];return e.forEach(n=>{t.push(n)}),t}function Pt(e){return H(this,arguments,function*({operationName:t,channel:n}){const r={operationName:t,appId:n.appId,channelId:n.id};if(n.localPerson){const i=n.localPerson,a=yield Promise.all(i.publications.map(u=>H(null,null,function*(){var p,h,v;const f={id:u.id,contentType:u.contentType,state:u.state,stats:{},connectionStats:{}};if(u.stream)for(const{memberId:_,stats:w}of yield u.stream._getStatsAll()){const C=w.find(R=>R.type.includes("local-candidate"));f.stats[_]={transportType:(p=C==null?void 0:C.protocol)!=null?p:"none",relayProtocol:(h=C==null?void 0:C.relayProtocol)!=null?h:"none",callType:(v=u.subscriptions.find(R=>R.subscriber.id===_))==null?void 0:v.subscriber.subtype,outbound:w.find(R=>R.type.includes("outbound-rtp")),localCandidate:C}}if(u.stream)for(const{memberId:_,connectionState:w}of u.stream._getConnectionStateAll())f.connectionStats[_]=w;return f})));r.publishing=a;const o=yield Promise.all(i.subscriptions.map(u=>H(null,null,function*(){const p={id:u.id,contentType:u.contentType,stats:{}};if(p.callType=u.publication.publisher.subtype,u.stream){const h=yield u.stream.getStats();p.stats=h.find(f=>f.type.includes("inbound-rtp"));const v=h.find(f=>f.type.includes("local-candidate"));p.transportType=v==null?void 0:v.protocol,p.relayProtocol=v==null?void 0:v.relayProtocol}return u.stream&&(p.connectionState=u.stream.getConnectionState()),p})));r.subscribing=o}return r})}function In({member:e,detail:t,channel:n,operationName:r,payload:i}){const a={operationName:r,payload:i,detail:t};return e&&(a.appId=e.channel.appId,a.channelId=e.channel.id,a.memberId=e.id),n&&(a.appId=n.appId,a.channelId=n.id),a}function Oe({operationName:e,context:t,info:n,error:r,path:i,payload:a,channel:o}){const u={operationName:e,payload:a};return o&&(u.appId=o.appId,u.channelId=o.id,o.localPerson&&(u.memberId=o.localPerson.id)),t&&(u.info=t.info,u.plugins=t.plugins.map(p=>p.subtype)),new _r({error:r,info:n,payload:u,path:i})}var Gv=e=>H(null,[e],function*({stream:t,remoteMember:n,end:r,interval:i,timeout:a}){return new Promise((o,u)=>H(null,null,function*(){i??(i=100),a??(a=1e4);for(let p=0;;p+=i){if(p>=a){u(Oe({operationName:"Peer.waitForStats",info:we(ie({},Ve.timeout),{detail:"waitForStats timeout"}),path:HC.prefix}));break}const h=yield t._getStats(n);if(r(h)){o(h);break}yield new Promise(v=>setTimeout(v,i))}}))}),VC=(e,t)=>{var n,r;return N_((r=(n=e.find(i=>i.payload===t))==null?void 0:n.config)!=null?r:"")},N_=e=>e.split(";").reduce((n,r)=>{const[i,a]=r.split("=");return i&&(n[i]=isNaN(Number(a))?a:Number(a)),n},{}),O_=({isNotBrowser:e}={})=>{if(e)return e;const t=BC.default.getParser(window.navigator.userAgent),n=t.getOSName(),r=t.getOSVersion(),i=t.getBrowserName(),a=t.getBrowserVersion();return{browserName:i,browserVersion:a,osName:n,osVersion:r}};function Jv(){var e,t,n,r,i,a,o,u;if(typeof navigator=="object"&&navigator.product==="ReactNative")return typeof RTCPeerConnection>"u"?void 0:typeof RTCRtpTransceiver<"u"?"ReactNativeUnifiedPlan":"ReactNative";if(typeof navigator=="object"&&typeof navigator.userAgent=="string"){const p=navigator.userAgent,h=new UC.UAParser(p),v=h.getBrowser(),f=(t=(e=v.name)==null?void 0:e.toLowerCase())!=null?t:"",_=parseInt((n=v.major)!=null?n:"0"),C=(i=(r=h.getEngine().name)==null?void 0:r.toLowerCase())!=null?i:"",R=h.getOS(),S=(o=(a=R.name)==null?void 0:a.toLowerCase())!=null?o:"",b=parseFloat((u=R.version)!=null?u:"0"),x=S==="ios",E=["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(f),M=["firefox","mobile firefox","mobile focus"].includes(f),Z=["safari","mobile safari"].includes(f),$=["edge"].includes(f);if((E||$)&&!x&&_>=111)return"Chrome111";if(E&&!x&&_>=74||$&&!x&&_>=88)return"Chrome74";if(E&&!x&&_>=70)return"Chrome70";if(E&&!x&&_>=67)return"Chrome67";if(E&&!x&&_>=55)return"Chrome55";if(M&&!x&&_>=60)return"Firefox60";if(M&&x&&b>=14.3)return"Safari12";if(Z&&_>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(Z&&_>=11)return"Safari11";if($&&!x&&_>=11&&_<=18)return"Edge11";if(C==="webkit"&&x&&b>=14.3&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(C==="blink"){const z=p.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(z){const q=Number(z[1]);return q>=111?"Chrome111":q>=74?"Chrome74":q>=70?"Chrome70":q>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else return}else return}var yp=new Ge("packages/core/src/member/index.ts"),uh=class{constructor(e){this._state="joined",this._events=new Qi,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.channel=e.channel,this.id=e.id,this.name=e.name,this._metadata=e.metadata,this.context=e.context}get metadata(){return this._metadata}get state(){return this._state}get publications(){return this.channel.publications.filter(e=>e.publisher.id===this.id)}get subscriptions(){return this.channel.subscriptions.filter(e=>e.subscriber.id===this.id)}toJSON(){return{id:this.id,name:this.name,type:this.type,subtype:this.subtype,metadata:this.metadata}}_left(){this._state="left",this.onLeft.emit(),this._events.dispose()}_metadataUpdated(e){this._metadata=e,this.onMetadataUpdated.emit(e)}updateMetadata(e){return H(this,null,function*(){yield this.channel._updateMemberMetadata(this.id,e)})}leave(){return H(this,null,function*(){const e=yp.info("[start] leave",yield Pt({operationName:"localPerson.leave",channel:this.channel}));if(this.state==="left")throw Oe({operationName:"localPerson.leave",info:Ve.localPersonNotJoinedChannel,path:yp.prefix,context:this.context,channel:this.channel});yield this.channel.leave(this),yp.elapsed(e,"[end] leave")})}};Y();Y();var hu=new Ge("packages/core/src/plugin/internal/unknown/connection.ts"),qC=class{constructor(e,t){this.localPerson=e,this.remoteMember=t,this.type="unknown",this.onDisconnect=new Qe,this.onClose=new Qe,this.closed=!1}close(){this.closed=!0,this.onClose.emit()}startPublishing(e){return H(this,null,function*(){hu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{publication:e})})}stopPublishing(e){return H(this,null,function*(){hu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{publication:e})})}startSubscribing(e){return H(this,null,function*(){hu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{subscription:e})})}stopSubscribing(e){return H(this,null,function*(){hu.debug(`this is unknown type connection. should install ${this.remoteMember.subtype} plugin`,{subscription:e})})}},M_=class extends uh{constructor(e){super(e),this.type="bot",this.side="remote",this._connections={},this.plugin=e.plugin,this.subtype=e.subtype}_getConnection(e){return this._connections[e]}_getOrCreateConnection(e){var t;return(t=this._getConnection(e.id))!=null?t:this._createConnection(e,this)}_createConnection(e,t){return new qC(e,t)}_dispose(){}};Y();Y();Y();Y();Y();Y();var L_=new Ge("packages/core/src/media/stream/base.ts");function j_(e,t){var n;if(((n=e??{})==null?void 0:n.srcObject)===void 0)throw Oe({operationName:"attachElement",info:Ve.invalidElement,payload:{element:e},path:L_.prefix});if(e.srcObject){const r=e.srcObject,i=r.getTracks().find(o=>o.readyState==="ended");i&&r.removeTrack(i);const a=r.getTracks().find(o=>o.kind===t.kind);a&&r.removeTrack(a),r.addTrack(t)}else e.srcObject=new MediaStream([t])}function B_(e,t){var n;if(((n=e??{})==null?void 0:n.srcObject)===void 0)throw Oe({operationName:"attachElement",info:Ve.invalidElement,payload:{element:e},path:L_.prefix});const r=e.srcObject;r.getTracks().length>0&&r.removeTrack(t),r.getTracks().length===0&&(e.srcObject=null)}Y();Y();Y();Y();var pu,zC=new Uint8Array(16);function KC(){if(!pu&&(pu=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pu))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pu(zC)}Y();Y();Y();var $C=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function WC(e){return typeof e=="string"&&$C.test(e)}var GC=WC,Qn=[];for(let e=0;e<256;++e)Qn.push((e+256).toString(16).slice(1));function JC(e,t=0){return Qn[e[t+0]]+Qn[e[t+1]]+Qn[e[t+2]]+Qn[e[t+3]]+"-"+Qn[e[t+4]]+Qn[e[t+5]]+"-"+Qn[e[t+6]]+Qn[e[t+7]]+"-"+Qn[e[t+8]]+Qn[e[t+9]]+"-"+Qn[e[t+10]]+Qn[e[t+11]]+Qn[e[t+12]]+Qn[e[t+13]]+Qn[e[t+14]]+Qn[e[t+15]]}Y();Y();var ZC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Zv={randomUUID:ZC};function QC(e,t,n){if(Zv.randomUUID&&!t&&!e)return Zv.randomUUID();e=e||{};const r=e.random||(e.rng||KC)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return JC(r)}var Oi=QC;Y();var XC=Br(Qw());Y();function Df(e){this.message=e}Df.prototype=new Error,Df.prototype.name="InvalidCharacterError";var Qv=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new Df("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,i=0,a=0,o="";r=t.charAt(a++);~r&&(n=i%4?64*n+r:r,i++%4)?o+=String.fromCharCode(255&n>>(-2*i&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o};function YC(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(n){return decodeURIComponent(Qv(n).replace(/(.)/g,function(r,i){var a=i.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}(t)}catch{return Qv(t)}}function yd(e){this.message=e}function eE(e,t){if(typeof e!="string")throw new yd("Invalid token specified");var n=(t=t||{}).header===!0?0:1;try{return JSON.parse(YC(e.split(".")[n]))}catch(r){throw new yd("Invalid token specified: "+r.message)}}yd.prototype=new Error,yd.prototype.name="InvalidTokenError";var tE=eE;Y();Y();var ze={};Dy(ze,{BRAND:()=>kE,DIRTY:()=>fo,EMPTY_PATH:()=>sE,INVALID:()=>ut,NEVER:()=>u5,OK:()=>xr,ParseStatus:()=>jr,Schema:()=>Tt,ZodAny:()=>Lo,ZodArray:()=>Va,ZodBigInt:()=>sl,ZodBoolean:()=>al,ZodBranded:()=>Ym,ZodCatch:()=>gl,ZodDate:()=>ol,ZodDefault:()=>ml,ZodDiscriminatedUnion:()=>W_,ZodEffects:()=>Ii,ZodEnum:()=>Tl,ZodError:()=>Ri,ZodFirstPartyTypeKind:()=>ht,ZodFunction:()=>Q_,ZodIntersection:()=>dl,ZodIssueCode:()=>Be,ZodLazy:()=>hl,ZodLiteral:()=>pl,ZodMap:()=>xd,ZodNaN:()=>Ed,ZodNativeEnum:()=>fl,ZodNever:()=>bs,ZodNull:()=>ll,ZodNullable:()=>na,ZodNumber:()=>il,ZodObject:()=>ui,ZodOptional:()=>Ji,ZodParsedType:()=>Ze,ZodPipeline:()=>eg,ZodPromise:()=>jo,ZodReadonly:()=>vl,ZodRecord:()=>Z_,ZodSchema:()=>Tt,ZodSet:()=>Cd,ZodString:()=>Mo,ZodSymbol:()=>Sd,ZodTransformer:()=>Ii,ZodTuple:()=>ta,ZodType:()=>Tt,ZodUndefined:()=>cl,ZodUnion:()=>ul,ZodUnknown:()=>Da,ZodVoid:()=>wd,addIssueToContext:()=>$e,any:()=>ME,array:()=>UE,bigint:()=>IE,boolean:()=>rb,coerce:()=>l5,custom:()=>eb,date:()=>FE,datetimeRegex:()=>K_,defaultErrorMap:()=>Oo,discriminatedUnion:()=>zE,effect:()=>e1,enum:()=>YE,function:()=>ZE,getErrorMap:()=>_d,getParsedType:()=>ds,instanceof:()=>RE,intersection:()=>KE,isAborted:()=>Of,isAsync:()=>rl,isDirty:()=>Mf,isValid:()=>Ha,late:()=>TE,lazy:()=>QE,literal:()=>XE,makeIssue:()=>bd,map:()=>GE,nan:()=>AE,nativeEnum:()=>e5,never:()=>jE,null:()=>OE,nullable:()=>r5,number:()=>nb,object:()=>HE,objectUtil:()=>Nf,oboolean:()=>c5,onumber:()=>o5,optional:()=>n5,ostring:()=>a5,pipeline:()=>s5,preprocess:()=>i5,promise:()=>t5,quotelessJson:()=>nE,record:()=>WE,set:()=>JE,setErrorMap:()=>iE,strictObject:()=>VE,string:()=>tb,symbol:()=>DE,transformer:()=>e1,tuple:()=>$E,undefined:()=>NE,union:()=>qE,unknown:()=>LE,util:()=>Vt,void:()=>BE});Y();Y();Y();Y();Y();var Vt;(function(e){e.assertEqual=i=>{};function t(i){}e.assertIs=t;function n(i){throw new Error}e.assertNever=n,e.arrayToEnum=i=>{const a={};for(const o of i)a[o]=o;return a},e.getValidEnumValues=i=>{const a=e.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),o={};for(const u of a)o[u]=i[u];return e.objectValues(o)},e.objectValues=i=>e.objectKeys(i).map(function(a){return i[a]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&a.push(o);return a},e.find=(i,a)=>{for(const o of i)if(a(o))return o},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,a=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(Vt||(Vt={}));var Nf;(function(e){e.mergeShapes=(t,n)=>ie(ie({},t),n)})(Nf||(Nf={}));var Ze=Vt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ds=e=>{switch(typeof e){case"undefined":return Ze.undefined;case"string":return Ze.string;case"number":return Number.isNaN(e)?Ze.nan:Ze.number;case"boolean":return Ze.boolean;case"function":return Ze.function;case"bigint":return Ze.bigint;case"symbol":return Ze.symbol;case"object":return Array.isArray(e)?Ze.array:e===null?Ze.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Ze.promise:typeof Map<"u"&&e instanceof Map?Ze.map:typeof Set<"u"&&e instanceof Set?Ze.set:typeof Date<"u"&&e instanceof Date?Ze.date:Ze.object;default:return Ze.unknown}},Be=Vt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),nE=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),Ri=class U_ extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},r={_errors:[]},i=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let u=r,p=0;for(;p<o.path.length;){const h=o.path[p];p===o.path.length-1?(u[h]=u[h]||{_errors:[]},u[h]._errors.push(n(o))):u[h]=u[h]||{_errors:[]},u=u[h],p++}}};return i(this),r}static assert(t){if(!(t instanceof U_))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Vt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):r.push(t(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}};Ri.create=e=>new Ri(e);var rE=(e,t)=>{let n;switch(e.code){case Be.invalid_type:e.received===Ze.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Be.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Vt.jsonStringifyReplacer)}`;break;case Be.unrecognized_keys:n=`Unrecognized key(s) in object: ${Vt.joinValues(e.keys,", ")}`;break;case Be.invalid_union:n="Invalid input";break;case Be.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Vt.joinValues(e.options)}`;break;case Be.invalid_enum_value:n=`Invalid enum value. Expected ${Vt.joinValues(e.options)}, received '${e.received}'`;break;case Be.invalid_arguments:n="Invalid function arguments";break;case Be.invalid_return_type:n="Invalid function return type";break;case Be.invalid_date:n="Invalid date";break;case Be.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Vt.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Be.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Be.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Be.custom:n="Invalid input";break;case Be.invalid_intersection_types:n="Intersection results could not be merged";break;case Be.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Be.not_finite:n="Number must be finite";break;default:n=t.defaultError,Vt.assertNever(e)}return{message:n}},Oo=rE,H_=Oo;function iE(e){H_=e}function _d(){return H_}Y();var bd=e=>{const{data:t,path:n,errorMaps:r,issueData:i}=e,a=[...n,...i.path||[]],o=we(ie({},i),{path:a});if(i.message!==void 0)return we(ie({},i),{path:a,message:i.message});let u="";const p=r.filter(h=>!!h).slice().reverse();for(const h of p)u=h(o,{data:t,defaultError:u}).message;return we(ie({},i),{path:a,message:u})},sE=[];function $e(e,t){const n=_d(),r=bd({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Oo?void 0:Oo].filter(i=>!!i)});e.common.issues.push(r)}var jr=class V_{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const i of n){if(i.status==="aborted")return ut;i.status==="dirty"&&t.dirty(),r.push(i.value)}return{status:t.value,value:r}}static mergeObjectAsync(t,n){return H(this,null,function*(){const r=[];for(const i of n){const a=yield i.key,o=yield i.value;r.push({key:a,value:o})}return V_.mergeObjectSync(t,r)})}static mergeObjectSync(t,n){const r={};for(const i of n){const{key:a,value:o}=i;if(a.status==="aborted"||o.status==="aborted")return ut;a.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[a.value]=o.value)}return{status:t.value,value:r}}},ut=Object.freeze({status:"aborted"}),fo=e=>({status:"dirty",value:e}),xr=e=>({status:"valid",value:e}),Of=e=>e.status==="aborted",Mf=e=>e.status==="dirty",Ha=e=>e.status==="valid",rl=e=>typeof Promise<"u"&&e instanceof Promise;Y();Y();Y();var it;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(it||(it={}));var Zi=class{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Xv=(e,t)=>{if(Ha(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Ri(e.common.issues);return this._error=n,this._error}}};function St(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(o,u)=>{var p,h;const{message:v}=e;return o.code==="invalid_enum_value"?{message:v??u.defaultError}:typeof u.data>"u"?{message:(p=v??r)!=null?p:u.defaultError}:o.code!=="invalid_type"?{message:u.defaultError}:{message:(h=v??n)!=null?h:u.defaultError}},description:i}}var Tt=class{get description(){return this._def.description}_getType(e){return ds(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ds(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new jr,ctx:{common:e.parent.common,data:e.data,parsedType:ds(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(rl(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:(n=t==null?void 0:t.async)!=null?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ds(e)},i=this._parseSync({data:e,path:r.path,parent:r});return Xv(r,i)}"~validate"(e){var t,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ds(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:r});return Ha(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(n=(t=i==null?void 0:i.message)==null?void 0:t.toLowerCase())!=null&&n.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(i=>Ha(i)?{value:i.value}:{issues:r.common.issues})}parseAsync(e,t){return H(this,null,function*(){const n=yield this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error})}safeParseAsync(e,t){return H(this,null,function*(){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ds(e)},r=this._parse({data:e,path:n.path,parent:n}),i=yield rl(r)?r:Promise.resolve(r);return Xv(n,i)})}refine(e,t){const n=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,i)=>{const a=e(r),o=()=>i.addIssue(ie({code:Be.custom},n(r)));return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new Ii({schema:this,typeName:ht.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Ji.create(this,this._def)}nullable(){return na.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Va.create(this)}promise(){return jo.create(this,this._def)}or(e){return ul.create([this,e],this._def)}and(e){return dl.create(this,e,this._def)}transform(e){return new Ii(we(ie({},St(this._def)),{schema:this,typeName:ht.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){const t=typeof e=="function"?e:()=>e;return new ml(we(ie({},St(this._def)),{innerType:this,defaultValue:t,typeName:ht.ZodDefault}))}brand(){return new Ym(ie({typeName:ht.ZodBranded,type:this},St(this._def)))}catch(e){const t=typeof e=="function"?e:()=>e;return new gl(we(ie({},St(this._def)),{innerType:this,catchValue:t,typeName:ht.ZodCatch}))}describe(e){const t=this.constructor;return new t(we(ie({},this._def),{description:e}))}pipe(e){return eg.create(this,e)}readonly(){return vl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},aE=/^c[^\s-]{8,}$/i,oE=/^[0-9a-z]+$/,cE=/^[0-9A-HJKMNP-TV-Z]{26}$/i,lE=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,uE=/^[a-z0-9_-]{21}$/i,dE=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,hE=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,pE=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,fE="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",_p,mE=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,gE=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,vE=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,yE=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,_E=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,bE=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,q_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",SE=new RegExp(`^${q_}$`);function z_(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function wE(e){return new RegExp(`^${z_(e)}$`)}function K_(e){let t=`${q_}T${z_(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function xE(e,t){return!!((t==="v4"||!t)&&mE.test(e)||(t==="v6"||!t)&&vE.test(e))}function CE(e,t){if(!dE.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||t&&i.alg!==t)}catch{return!1}}function EE(e,t){return!!((t==="v4"||!t)&&gE.test(e)||(t==="v6"||!t)&&yE.test(e))}var Mo=class Tc extends Tt{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Ze.string){const a=this._getOrReturnCtx(t);return $e(a,{code:Be.invalid_type,expected:Ze.string,received:a.parsedType}),ut}const r=new jr;let i;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=t.data.length>a.value,u=t.data.length<a.value;(o||u)&&(i=this._getOrReturnCtx(t,i),o?$e(i,{code:Be.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&$e(i,{code:Be.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")pE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"email",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")_p||(_p=new RegExp(fE,"u")),_p.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"emoji",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")lE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"uuid",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")uE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"nanoid",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")aE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"cuid",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")oE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"cuid2",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")cE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"ulid",code:Be.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),$e(i,{validation:"url",code:Be.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"regex",code:Be.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?K_(a).test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?SE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?wE(a).test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?hE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"duration",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?xE(t.data,a.version)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"ip",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?CE(t.data,a.alg)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"jwt",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?EE(t.data,a.version)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"cidr",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?_E.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"base64",code:Be.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?bE.test(t.data)||(i=this._getOrReturnCtx(t,i),$e(i,{validation:"base64url",code:Be.invalid_string,message:a.message}),r.dirty()):Vt.assertNever(a);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(i=>t.test(i),ie({validation:n,code:Be.invalid_string},it.errToObj(r)))}_addCheck(t){return new Tc(we(ie({},this._def),{checks:[...this._def.checks,t]}))}email(t){return this._addCheck(ie({kind:"email"},it.errToObj(t)))}url(t){return this._addCheck(ie({kind:"url"},it.errToObj(t)))}emoji(t){return this._addCheck(ie({kind:"emoji"},it.errToObj(t)))}uuid(t){return this._addCheck(ie({kind:"uuid"},it.errToObj(t)))}nanoid(t){return this._addCheck(ie({kind:"nanoid"},it.errToObj(t)))}cuid(t){return this._addCheck(ie({kind:"cuid"},it.errToObj(t)))}cuid2(t){return this._addCheck(ie({kind:"cuid2"},it.errToObj(t)))}ulid(t){return this._addCheck(ie({kind:"ulid"},it.errToObj(t)))}base64(t){return this._addCheck(ie({kind:"base64"},it.errToObj(t)))}base64url(t){return this._addCheck(ie({kind:"base64url"},it.errToObj(t)))}jwt(t){return this._addCheck(ie({kind:"jwt"},it.errToObj(t)))}ip(t){return this._addCheck(ie({kind:"ip"},it.errToObj(t)))}cidr(t){return this._addCheck(ie({kind:"cidr"},it.errToObj(t)))}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck(ie({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!=null?n:!1,local:(r=t==null?void 0:t.local)!=null?r:!1},it.errToObj(t==null?void 0:t.message)))}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck(ie({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision},it.errToObj(t==null?void 0:t.message)))}duration(t){return this._addCheck(ie({kind:"duration"},it.errToObj(t)))}regex(t,n){return this._addCheck(ie({kind:"regex",regex:t},it.errToObj(n)))}includes(t,n){return this._addCheck(ie({kind:"includes",value:t,position:n==null?void 0:n.position},it.errToObj(n==null?void 0:n.message)))}startsWith(t,n){return this._addCheck(ie({kind:"startsWith",value:t},it.errToObj(n)))}endsWith(t,n){return this._addCheck(ie({kind:"endsWith",value:t},it.errToObj(n)))}min(t,n){return this._addCheck(ie({kind:"min",value:t},it.errToObj(n)))}max(t,n){return this._addCheck(ie({kind:"max",value:t},it.errToObj(n)))}length(t,n){return this._addCheck(ie({kind:"length",value:t},it.errToObj(n)))}nonempty(t){return this.min(1,it.errToObj(t))}trim(){return new Tc(we(ie({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new Tc(we(ie({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new Tc(we(ie({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}};Mo.create=e=>{var t;return new Mo(ie({checks:[],typeName:ht.ZodString,coerce:(t=e==null?void 0:e.coerce)!=null?t:!1},St(e)))};function PE(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r,a=Number.parseInt(e.toFixed(i).replace(".","")),o=Number.parseInt(t.toFixed(i).replace(".",""));return a%o/_s(10,i)}var il=class Lf extends Tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Ze.number){const a=this._getOrReturnCtx(t);return $e(a,{code:Be.invalid_type,expected:Ze.number,received:a.parsedType}),ut}let r;const i=new jr;for(const a of this._def.checks)a.kind==="int"?Vt.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),$e(r,{code:Be.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),$e(r,{code:Be.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),$e(r,{code:Be.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?PE(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),$e(r,{code:Be.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),$e(r,{code:Be.not_finite,message:a.message}),i.dirty()):Vt.assertNever(a);return{status:i.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,it.toString(n))}gt(t,n){return this.setLimit("min",t,!1,it.toString(n))}lte(t,n){return this.setLimit("max",t,!0,it.toString(n))}lt(t,n){return this.setLimit("max",t,!1,it.toString(n))}setLimit(t,n,r,i){return new Lf(we(ie({},this._def),{checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:it.toString(i)}]}))}_addCheck(t){return new Lf(we(ie({},this._def),{checks:[...this._def.checks,t]}))}int(t){return this._addCheck({kind:"int",message:it.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:it.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:it.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:it.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:it.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:it.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:it.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:it.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:it.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Vt.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}};il.create=e=>new il(ie({checks:[],typeName:ht.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1},St(e)));var sl=class jf extends Tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Ze.bigint)return this._getInvalidInput(t);let r;const i=new jr;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),$e(r,{code:Be.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),$e(r,{code:Be.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),$e(r,{code:Be.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):Vt.assertNever(a);return{status:i.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return $e(n,{code:Be.invalid_type,expected:Ze.bigint,received:n.parsedType}),ut}gte(t,n){return this.setLimit("min",t,!0,it.toString(n))}gt(t,n){return this.setLimit("min",t,!1,it.toString(n))}lte(t,n){return this.setLimit("max",t,!0,it.toString(n))}lt(t,n){return this.setLimit("max",t,!1,it.toString(n))}setLimit(t,n,r,i){return new jf(we(ie({},this._def),{checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:it.toString(i)}]}))}_addCheck(t){return new jf(we(ie({},this._def),{checks:[...this._def.checks,t]}))}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:it.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:it.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:it.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:it.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:it.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}};sl.create=e=>{var t;return new sl(ie({checks:[],typeName:ht.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!=null?t:!1},St(e)))};var al=class extends Tt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ze.boolean){const n=this._getOrReturnCtx(e);return $e(n,{code:Be.invalid_type,expected:Ze.boolean,received:n.parsedType}),ut}return xr(e.data)}};al.create=e=>new al(ie({typeName:ht.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1},St(e)));var ol=class $_ extends Tt{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Ze.date){const a=this._getOrReturnCtx(t);return $e(a,{code:Be.invalid_type,expected:Ze.date,received:a.parsedType}),ut}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return $e(a,{code:Be.invalid_date}),ut}const r=new jr;let i;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(i=this._getOrReturnCtx(t,i),$e(i,{code:Be.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):Vt.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new $_(we(ie({},this._def),{checks:[...this._def.checks,t]}))}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:it.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:it.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}};ol.create=e=>new ol(ie({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:ht.ZodDate},St(e)));var Sd=class extends Tt{_parse(e){if(this._getType(e)!==Ze.symbol){const n=this._getOrReturnCtx(e);return $e(n,{code:Be.invalid_type,expected:Ze.symbol,received:n.parsedType}),ut}return xr(e.data)}};Sd.create=e=>new Sd(ie({typeName:ht.ZodSymbol},St(e)));var cl=class extends Tt{_parse(e){if(this._getType(e)!==Ze.undefined){const n=this._getOrReturnCtx(e);return $e(n,{code:Be.invalid_type,expected:Ze.undefined,received:n.parsedType}),ut}return xr(e.data)}};cl.create=e=>new cl(ie({typeName:ht.ZodUndefined},St(e)));var ll=class extends Tt{_parse(e){if(this._getType(e)!==Ze.null){const n=this._getOrReturnCtx(e);return $e(n,{code:Be.invalid_type,expected:Ze.null,received:n.parsedType}),ut}return xr(e.data)}};ll.create=e=>new ll(ie({typeName:ht.ZodNull},St(e)));var Lo=class extends Tt{constructor(){super(...arguments),this._any=!0}_parse(e){return xr(e.data)}};Lo.create=e=>new Lo(ie({typeName:ht.ZodAny},St(e)));var Da=class extends Tt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return xr(e.data)}};Da.create=e=>new Da(ie({typeName:ht.ZodUnknown},St(e)));var bs=class extends Tt{_parse(e){const t=this._getOrReturnCtx(e);return $e(t,{code:Be.invalid_type,expected:Ze.never,received:t.parsedType}),ut}};bs.create=e=>new bs(ie({typeName:ht.ZodNever},St(e)));var wd=class extends Tt{_parse(e){if(this._getType(e)!==Ze.undefined){const n=this._getOrReturnCtx(e);return $e(n,{code:Be.invalid_type,expected:Ze.void,received:n.parsedType}),ut}return xr(e.data)}};wd.create=e=>new wd(ie({typeName:ht.ZodVoid},St(e)));var Va=class Bu extends Tt{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),i=this._def;if(n.parsedType!==Ze.array)return $e(n,{code:Be.invalid_type,expected:Ze.array,received:n.parsedType}),ut;if(i.exactLength!==null){const o=n.data.length>i.exactLength.value,u=n.data.length<i.exactLength.value;(o||u)&&($e(n,{code:o?Be.too_big:Be.too_small,minimum:u?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&($e(n,{code:Be.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&($e(n,{code:Be.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,u)=>i.type._parseAsync(new Zi(n,o,n.path,u)))).then(o=>jr.mergeArray(r,o));const a=[...n.data].map((o,u)=>i.type._parseSync(new Zi(n,o,n.path,u)));return jr.mergeArray(r,a)}get element(){return this._def.type}min(t,n){return new Bu(we(ie({},this._def),{minLength:{value:t,message:it.toString(n)}}))}max(t,n){return new Bu(we(ie({},this._def),{maxLength:{value:t,message:it.toString(n)}}))}length(t,n){return new Bu(we(ie({},this._def),{exactLength:{value:t,message:it.toString(n)}}))}nonempty(t){return this.min(1,t)}};Va.create=(e,t)=>new Va(ie({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ht.ZodArray},St(t)));function eo(e){if(e instanceof ui){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Ji.create(eo(r))}return new ui(we(ie({},e._def),{shape:()=>t}))}else return e instanceof Va?new Va(we(ie({},e._def),{type:eo(e.element)})):e instanceof Ji?Ji.create(eo(e.unwrap())):e instanceof na?na.create(eo(e.unwrap())):e instanceof ta?ta.create(e.items.map(t=>eo(t))):e}var ui=class _i extends Tt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Vt.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==Ze.object){const h=this._getOrReturnCtx(t);return $e(h,{code:Be.invalid_type,expected:Ze.object,received:h.parsedType}),ut}const{status:r,ctx:i}=this._processInputParams(t),{shape:a,keys:o}=this._getCached(),u=[];if(!(this._def.catchall instanceof bs&&this._def.unknownKeys==="strip"))for(const h in i.data)o.includes(h)||u.push(h);const p=[];for(const h of o){const v=a[h],f=i.data[h];p.push({key:{status:"valid",value:h},value:v._parse(new Zi(i,f,i.path,h)),alwaysSet:h in i.data})}if(this._def.catchall instanceof bs){const h=this._def.unknownKeys;if(h==="passthrough")for(const v of u)p.push({key:{status:"valid",value:v},value:{status:"valid",value:i.data[v]}});else if(h==="strict")u.length>0&&($e(i,{code:Be.unrecognized_keys,keys:u}),r.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const v of u){const f=i.data[v];p.push({key:{status:"valid",value:v},value:h._parse(new Zi(i,f,i.path,v)),alwaysSet:v in i.data})}}return i.common.async?Promise.resolve().then(()=>H(this,null,function*(){const h=[];for(const v of p){const f=yield v.key,_=yield v.value;h.push({key:f,value:_,alwaysSet:v.alwaysSet})}return h})).then(h=>jr.mergeObjectSync(r,h)):jr.mergeObjectSync(r,p)}get shape(){return this._def.shape()}strict(t){return it.errToObj,new _i(ie(we(ie({},this._def),{unknownKeys:"strict"}),t!==void 0?{errorMap:(n,r)=>{var i,a,o,u;const p=(o=(a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)!=null?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(u=it.errToObj(t).message)!=null?u:p}:{message:p}}}:{}))}strip(){return new _i(we(ie({},this._def),{unknownKeys:"strip"}))}passthrough(){return new _i(we(ie({},this._def),{unknownKeys:"passthrough"}))}extend(t){return new _i(we(ie({},this._def),{shape:()=>ie(ie({},this._def.shape()),t)}))}merge(t){return new _i({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>ie(ie({},this._def.shape()),t._def.shape()),typeName:ht.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new _i(we(ie({},this._def),{catchall:t}))}pick(t){const n={};for(const r of Vt.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new _i(we(ie({},this._def),{shape:()=>n}))}omit(t){const n={};for(const r of Vt.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new _i(we(ie({},this._def),{shape:()=>n}))}deepPartial(){return eo(this)}partial(t){const n={};for(const r of Vt.objectKeys(this.shape)){const i=this.shape[r];t&&!t[r]?n[r]=i:n[r]=i.optional()}return new _i(we(ie({},this._def),{shape:()=>n}))}required(t){const n={};for(const r of Vt.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Ji;)a=a._def.innerType;n[r]=a}return new _i(we(ie({},this._def),{shape:()=>n}))}keyof(){return X_(Vt.objectKeys(this.shape))}};ui.create=(e,t)=>new ui(ie({shape:()=>e,unknownKeys:"strip",catchall:bs.create(),typeName:ht.ZodObject},St(t)));ui.strictCreate=(e,t)=>new ui(ie({shape:()=>e,unknownKeys:"strict",catchall:bs.create(),typeName:ht.ZodObject},St(t)));ui.lazycreate=(e,t)=>new ui(ie({shape:e,unknownKeys:"strip",catchall:bs.create(),typeName:ht.ZodObject},St(t)));var ul=class extends Tt{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function r(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Ri(o.ctx.common.issues));return $e(t,{code:Be.invalid_union,unionErrors:a}),ut}if(t.common.async)return Promise.all(n.map(i=>H(this,null,function*(){const a=we(ie({},t),{common:we(ie({},t.common),{issues:[]}),parent:null});return{result:yield i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}}))).then(r);{let i;const a=[];for(const u of n){const p=we(ie({},t),{common:we(ie({},t.common),{issues:[]}),parent:null}),h=u._parseSync({data:t.data,path:t.path,parent:p});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:p}),p.common.issues.length&&a.push(p.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(u=>new Ri(u));return $e(t,{code:Be.invalid_union,unionErrors:o}),ut}}get options(){return this._def.options}};ul.create=(e,t)=>new ul(ie({options:e,typeName:ht.ZodUnion},St(t)));var cs=e=>e instanceof hl?cs(e.schema):e instanceof Ii?cs(e.innerType()):e instanceof pl?[e.value]:e instanceof Tl?e.options:e instanceof fl?Vt.objectValues(e.enum):e instanceof ml?cs(e._def.innerType):e instanceof cl?[void 0]:e instanceof ll?[null]:e instanceof Ji?[void 0,...cs(e.unwrap())]:e instanceof na?[null,...cs(e.unwrap())]:e instanceof Ym||e instanceof vl?cs(e.unwrap()):e instanceof gl?cs(e._def.innerType):[],W_=class G_ extends Tt{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Ze.object)return $e(n,{code:Be.invalid_type,expected:Ze.object,received:n.parsedType}),ut;const r=this.discriminator,i=n.data[r],a=this.optionsMap.get(i);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):($e(n,{code:Be.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ut)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const i=new Map;for(const a of n){const o=cs(a.shape[t]);if(!o.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const u of o){if(i.has(u))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(u)}`);i.set(u,a)}}return new G_(ie({typeName:ht.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:i},St(r)))}};function Bf(e,t){const n=ds(e),r=ds(t);if(e===t)return{valid:!0,data:e};if(n===Ze.object&&r===Ze.object){const i=Vt.objectKeys(t),a=Vt.objectKeys(e).filter(u=>i.indexOf(u)!==-1),o=ie(ie({},e),t);for(const u of a){const p=Bf(e[u],t[u]);if(!p.valid)return{valid:!1};o[u]=p.data}return{valid:!0,data:o}}else if(n===Ze.array&&r===Ze.array){if(e.length!==t.length)return{valid:!1};const i=[];for(let a=0;a<e.length;a++){const o=e[a],u=t[a],p=Bf(o,u);if(!p.valid)return{valid:!1};i.push(p.data)}return{valid:!0,data:i}}else return n===Ze.date&&r===Ze.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var dl=class extends Tt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(i,a)=>{if(Of(i)||Of(a))return ut;const o=Bf(i.value,a.value);return o.valid?((Mf(i)||Mf(a))&&t.dirty(),{status:t.value,value:o.data}):($e(n,{code:Be.invalid_intersection_types}),ut)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,a])=>r(i,a)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};dl.create=(e,t,n)=>new dl(ie({left:e,right:t,typeName:ht.ZodIntersection},St(n)));var ta=class J_ extends Tt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ze.array)return $e(r,{code:Be.invalid_type,expected:Ze.array,received:r.parsedType}),ut;if(r.data.length<this._def.items.length)return $e(r,{code:Be.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ut;!this._def.rest&&r.data.length>this._def.items.length&&($e(r,{code:Be.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((o,u)=>{const p=this._def.items[u]||this._def.rest;return p?p._parse(new Zi(r,o,r.path,u)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>jr.mergeArray(n,o)):jr.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new J_(we(ie({},this._def),{rest:t}))}};ta.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ta(ie({items:e,typeName:ht.ZodTuple,rest:null},St(t)))};var Z_=class Uf extends Tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ze.object)return $e(r,{code:Be.invalid_type,expected:Ze.object,received:r.parsedType}),ut;const i=[],a=this._def.keyType,o=this._def.valueType;for(const u in r.data)i.push({key:a._parse(new Zi(r,u,r.path,u)),value:o._parse(new Zi(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?jr.mergeObjectAsync(n,i):jr.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Tt?new Uf(ie({keyType:t,valueType:n,typeName:ht.ZodRecord},St(r))):new Uf(ie({keyType:Mo.create(),valueType:t,typeName:ht.ZodRecord},St(n)))}},xd=class extends Tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Ze.map)return $e(n,{code:Be.invalid_type,expected:Ze.map,received:n.parsedType}),ut;const r=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map(([o,u],p)=>({key:r._parse(new Zi(n,o,n.path,[p,"key"])),value:i._parse(new Zi(n,u,n.path,[p,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(()=>H(this,null,function*(){for(const u of a){const p=yield u.key,h=yield u.value;if(p.status==="aborted"||h.status==="aborted")return ut;(p.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(p.value,h.value)}return{status:t.value,value:o}}))}else{const o=new Map;for(const u of a){const p=u.key,h=u.value;if(p.status==="aborted"||h.status==="aborted")return ut;(p.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(p.value,h.value)}return{status:t.value,value:o}}}};xd.create=(e,t,n)=>new xd(ie({valueType:t,keyType:e,typeName:ht.ZodMap},St(n)));var Cd=class Hf extends Tt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==Ze.set)return $e(r,{code:Be.invalid_type,expected:Ze.set,received:r.parsedType}),ut;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&($e(r,{code:Be.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&($e(r,{code:Be.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const a=this._def.valueType;function o(p){const h=new Set;for(const v of p){if(v.status==="aborted")return ut;v.status==="dirty"&&n.dirty(),h.add(v.value)}return{status:n.value,value:h}}const u=[...r.data.values()].map((p,h)=>a._parse(new Zi(r,p,r.path,h)));return r.common.async?Promise.all(u).then(p=>o(p)):o(u)}min(t,n){return new Hf(we(ie({},this._def),{minSize:{value:t,message:it.toString(n)}}))}max(t,n){return new Hf(we(ie({},this._def),{maxSize:{value:t,message:it.toString(n)}}))}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}};Cd.create=(e,t)=>new Cd(ie({valueType:e,minSize:null,maxSize:null,typeName:ht.ZodSet},St(t)));var Q_=class Uu extends Tt{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==Ze.function)return $e(n,{code:Be.invalid_type,expected:Ze.function,received:n.parsedType}),ut;function r(u,p){return bd({data:u,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,_d(),Oo].filter(h=>!!h),issueData:{code:Be.invalid_arguments,argumentsError:p}})}function i(u,p){return bd({data:u,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,_d(),Oo].filter(h=>!!h),issueData:{code:Be.invalid_return_type,returnTypeError:p}})}const a={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof jo){const u=this;return xr(function(...p){return H(this,null,function*(){const h=new Ri([]),v=yield u._def.args.parseAsync(p,a).catch(w=>{throw h.addIssue(r(p,w)),h}),f=yield Reflect.apply(o,this,v);return yield u._def.returns._def.type.parseAsync(f,a).catch(w=>{throw h.addIssue(i(f,w)),h})})})}else{const u=this;return xr(function(...p){const h=u._def.args.safeParse(p,a);if(!h.success)throw new Ri([r(p,h.error)]);const v=Reflect.apply(o,this,h.data),f=u._def.returns.safeParse(v,a);if(!f.success)throw new Ri([i(v,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Uu(we(ie({},this._def),{args:ta.create(t).rest(Da.create())}))}returns(t){return new Uu(we(ie({},this._def),{returns:t}))}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new Uu(ie({args:t||ta.create([]).rest(Da.create()),returns:n||Da.create(),typeName:ht.ZodFunction},St(r)))}},hl=class extends Tt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};hl.create=(e,t)=>new hl(ie({getter:e,typeName:ht.ZodLazy},St(t)));var pl=class extends Tt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return $e(t,{received:t.data,code:Be.invalid_literal,expected:this._def.value}),ut}return{status:"valid",value:e.data}}get value(){return this._def.value}};pl.create=(e,t)=>new pl(ie({value:e,typeName:ht.ZodLiteral},St(t)));function X_(e,t){return new Tl(ie({values:e,typeName:ht.ZodEnum},St(t)))}var Tl=class Vf extends Tt{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return $e(n,{expected:Vt.joinValues(r),received:n.parsedType,code:Be.invalid_type}),ut}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return $e(n,{received:n.data,code:Be.invalid_enum_value,options:r}),ut}return xr(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Vf.create(t,ie(ie({},this._def),n))}exclude(t,n=this._def){return Vf.create(this.options.filter(r=>!t.includes(r)),ie(ie({},this._def),n))}};Tl.create=X_;var fl=class extends Tt{_parse(e){const t=Vt.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==Ze.string&&n.parsedType!==Ze.number){const r=Vt.objectValues(t);return $e(n,{expected:Vt.joinValues(r),received:n.parsedType,code:Be.invalid_type}),ut}if(this._cache||(this._cache=new Set(Vt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=Vt.objectValues(t);return $e(n,{received:n.data,code:Be.invalid_enum_value,options:r}),ut}return xr(e.data)}get enum(){return this._def.values}};fl.create=(e,t)=>new fl(ie({values:e,typeName:ht.ZodNativeEnum},St(t)));var jo=class extends Tt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ze.promise&&t.common.async===!1)return $e(t,{code:Be.invalid_type,expected:Ze.promise,received:t.parsedType}),ut;const n=t.parsedType===Ze.promise?t.data:Promise.resolve(t.data);return xr(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}};jo.create=(e,t)=>new jo(ie({type:e,typeName:ht.ZodPromise},St(t)));var Ii=class extends Tt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ht.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:a=>{$e(n,a),a.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),r.type==="preprocess"){const a=r.transform(n.data,i);if(n.common.async)return Promise.resolve(a).then(o=>H(this,null,function*(){if(t.value==="aborted")return ut;const u=yield this._def.schema._parseAsync({data:o,path:n.path,parent:n});return u.status==="aborted"?ut:u.status==="dirty"||t.value==="dirty"?fo(u.value):u}));{if(t.value==="aborted")return ut;const o=this._def.schema._parseSync({data:a,path:n.path,parent:n});return o.status==="aborted"?ut:o.status==="dirty"||t.value==="dirty"?fo(o.value):o}}if(r.type==="refinement"){const a=o=>{const u=r.refinement(o,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?ut:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?ut:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(r.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ha(a))return ut;const o=r.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Ha(a)?Promise.resolve(r.transform(a.value,i)).then(o=>({status:t.value,value:o})):ut);Vt.assertNever(r)}};Ii.create=(e,t,n)=>new Ii(ie({schema:e,typeName:ht.ZodEffects,effect:t},St(n)));Ii.createWithPreprocess=(e,t,n)=>new Ii(ie({schema:t,effect:{type:"preprocess",transform:e},typeName:ht.ZodEffects},St(n)));var Ji=class extends Tt{_parse(e){return this._getType(e)===Ze.undefined?xr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ji.create=(e,t)=>new Ji(ie({innerType:e,typeName:ht.ZodOptional},St(t)));var na=class extends Tt{_parse(e){return this._getType(e)===Ze.null?xr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};na.create=(e,t)=>new na(ie({innerType:e,typeName:ht.ZodNullable},St(t)));var ml=class extends Tt{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===Ze.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};ml.create=(e,t)=>new ml(ie({innerType:e,typeName:ht.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default},St(t)));var gl=class extends Tt{_parse(e){const{ctx:t}=this._processInputParams(e),n=we(ie({},t),{common:we(ie({},t.common),{issues:[]})}),r=this._def.innerType._parse({data:n.data,path:n.path,parent:ie({},n)});return rl(r)?r.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ri(n.common.issues)},input:n.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new Ri(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};gl.create=(e,t)=>new gl(ie({innerType:e,typeName:ht.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch},St(t)));var Ed=class extends Tt{_parse(e){if(this._getType(e)!==Ze.nan){const n=this._getOrReturnCtx(e);return $e(n,{code:Be.invalid_type,expected:Ze.nan,received:n.parsedType}),ut}return{status:"valid",value:e.data}}};Ed.create=e=>new Ed(ie({typeName:ht.ZodNaN},St(e)));var kE=Symbol("zod_brand"),Ym=class extends Tt{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},eg=class Y_ extends Tt{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return H(this,null,function*(){const a=yield this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?ut:a.status==="dirty"?(n.dirty(),fo(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})});{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?ut:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(t,n){return new Y_({in:t,out:n,typeName:ht.ZodPipeline})}},vl=class extends Tt{_parse(e){const t=this._def.innerType._parse(e),n=r=>(Ha(r)&&(r.value=Object.freeze(r.value)),r);return rl(t)?t.then(r=>n(r)):n(t)}unwrap(){return this._def.innerType}};vl.create=(e,t)=>new vl(ie({innerType:e,typeName:ht.ZodReadonly},St(t)));function Yv(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function eb(e,t={},n){return e?Lo.create().superRefine((r,i)=>{var a,o;const u=e(r);if(u instanceof Promise)return u.then(p=>{var h,v;if(!p){const f=Yv(t,r),_=(v=(h=f.fatal)!=null?h:n)!=null?v:!0;i.addIssue(we(ie({code:"custom"},f),{fatal:_}))}});if(!u){const p=Yv(t,r),h=(o=(a=p.fatal)!=null?a:n)!=null?o:!0;i.addIssue(we(ie({code:"custom"},p),{fatal:h}))}}):Lo.create()}var TE={object:ui.lazycreate},ht;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(ht||(ht={}));var RE=(e,t={message:`Input not instance of ${e.name}`})=>eb(n=>n instanceof e,t),tb=Mo.create,nb=il.create,AE=Ed.create,IE=sl.create,rb=al.create,FE=ol.create,DE=Sd.create,NE=cl.create,OE=ll.create,ME=Lo.create,LE=Da.create,jE=bs.create,BE=wd.create,UE=Va.create,HE=ui.create,VE=ui.strictCreate,qE=ul.create,zE=W_.create,KE=dl.create,$E=ta.create,WE=Z_.create,GE=xd.create,JE=Cd.create,ZE=Q_.create,QE=hl.create,XE=pl.create,YE=Tl.create,e5=fl.create,t5=jo.create,e1=Ii.create,n5=Ji.create,r5=na.create,i5=Ii.createWithPreprocess,s5=eg.create,a5=()=>tb().optional(),o5=()=>nb().optional(),c5=()=>rb().optional(),l5={string:e=>Mo.create(we(ie({},e),{coerce:!0})),number:e=>il.create(we(ie({},e),{coerce:!0})),boolean:e=>al.create(we(ie({},e),{coerce:!0})),bigint:e=>sl.create(we(ie({},e),{coerce:!0})),date:e=>ol.create(we(ie({},e),{coerce:!0}))},u5=ut,gc=new Ge("packages/token/src/encoder.ts"),yl=class ib{constructor(t){let n;try{n=M5.parse(t)}catch(r){throw r instanceof ze.ZodError?new _r({path:gc.prefix,info:vc.invalidParameter,error:new Error("Received invalid token. Please check your SkyWayAuthToken.")}):new _r({path:gc.prefix,info:vc.invalidParameter,error:new Error("Received invalid token. Please check your SkyWayAuthToken.")})}Object.assign(this,n)}static Decode(t){try{const n=tE(t),r=new ib(n);return r.tokenString=t,r}catch(n){throw new _r({path:gc.prefix,info:vc.invalidParameter,error:n})}}encode(t){const n={jti:this.jti,iat:this.iat,exp:this.exp,scope:this.scope,version:this.version};return this.tokenString=XC.default.KJUR.jws.JWS.sign("HS256",JSON.stringify({alg:"HS256",typ:"JWT"}),JSON.stringify(n),t),this.tokenString}toJSON(){return{jti:this.jti,iat:this.iat,exp:this.exp,scope:this.scope,encoded:this.tokenString,version:this.version}}getAppId(){switch(this.version){case void 0:case 1:case 2:return this.scope.app.id;case 3:return this.scope.appId;default:throw new _r({path:gc.prefix,info:vc.invalidParameter,error:new Error(`invalid token version: version ${this.version} is not supported.`)})}}getAnalyticsEnabled(){var t,n,r;switch(this.version){case void 0:case 1:case 2:return(t=this.scope.app.analytics)!=null?t:!1;case 3:return(r=(n=this.scope.analytics)==null?void 0:n.enabled)!=null?r:!0;default:throw new _r({path:gc.prefix,info:vc.invalidParameter,error:new Error(`invalid token version: version ${this.version} is not supported.`)})}}};Y();var d5=["create","write","delete"],h5=ze.object({actions:ze.array(ze.enum(d5).refine(e=>typeof e=="string"))}).passthrough(),p5=["create","write","delete"],f5=ze.object({actions:ze.array(ze.enum(p5).refine(e=>typeof e=="string")),forwardings:ze.array(h5)}).passthrough();Y();var m5=["write","create","delete","updateMetadata","enable","disable"],g5=ze.object({actions:ze.array(ze.enum(m5).refine(e=>typeof e=="string"))}).passthrough(),v5=["write","create","delete"],y5=ze.object({actions:ze.array(ze.enum(v5).refine(e=>typeof e=="string"))}).passthrough(),_5=["write","create","delete","updateMetadata","signal"],b5=ze.object({id:ze.string().optional(),name:ze.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),S5=ze.intersection(b5,ze.object({actions:ze.array(ze.enum(_5).refine(e=>typeof e=="string")),publication:g5.optional(),subscription:y5.optional()}).passthrough()),w5=["write","read","create","delete","updateMetadata"],x5=ze.object({id:ze.string().optional(),name:ze.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),C5=ze.intersection(x5,ze.object({actions:ze.array(ze.enum(w5).refine(e=>typeof e=="string")),members:ze.array(S5),sfuBots:ze.array(f5).optional()}).passthrough()),E5=["listChannels","read","write"],P5=ze.object({id:ze.string(),analytics:ze.boolean().optional(),actions:ze.array(ze.enum(E5).refine(e=>typeof e=="string")).optional(),channels:ze.array(C5).optional(),turn:ze.boolean().optional()}).passthrough();Y();var k5=["publish","subscribe","updateMetadata"],T5=ze.object({id:ze.string().optional(),name:ze.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),R5=ze.intersection(T5,ze.object({methods:ze.array(ze.enum(k5).refine(e=>typeof e=="string"))}).passthrough()),A5=["create","close","updateMetadata"],I5=ze.object({id:ze.string().optional(),name:ze.string().optional()}).refine(e=>e.id!==void 0||e.name!==void 0,{message:"Either id or name is required."}),F5=ze.intersection(I5,ze.object({methods:ze.array(ze.enum(A5).refine(e=>typeof e=="string")),member:R5.optional(),sfu:ze.object({enabled:ze.boolean().optional(),maxSubscribersLimit:ze.number().optional()}).optional()}).passthrough()),D5=ze.object({appId:ze.string(),analytics:ze.object({enabled:ze.boolean().optional()}).optional(),noiseCancelling:ze.object({enabled:ze.boolean().optional()}).optional(),turn:ze.object({enabled:ze.boolean().optional()}).optional(),rooms:ze.array(F5)}).passthrough();Y();var sb=ze.object({jti:ze.string().uuid(),iat:ze.number().nonnegative(),exp:ze.number().nonnegative()}),N5=ze.intersection(sb,ze.object({scope:ze.object({app:P5}),version:ze.union([ze.literal(1),ze.literal(2),ze.literal(void 0)]).optional()})),O5=ze.intersection(sb,ze.object({scope:D5,version:ze.literal(3)})),M5=ze.union([N5,O5]);Y();var vc={invalidParameter:{name:"invalidParameter",detail:"failed to decode token",solution:"Use the correct token according to the specification"}};Y();var t1=()=>Math.floor(Date.now()/1e3),Ko=Oi,ab=class{constructor(e){this.contentType=e,this.side="local",this.onConnectionStateChanged=new Qe,this._onConnectionStateChanged=new Qe,this.id=Ko(),this._label="",this.published=!1,this._getTransportCallbacks={},this._getStatsCallbacks={},this._connectionState={},this._onConnectionStateChanged.pipe(this.onConnectionStateChanged)}_setLabel(e){this._label=e}_unpublished(){this.published=!1,this._getTransportCallbacks={},this._getStatsCallbacks={}}_getTransport(e){var t,n;const r=typeof e=="string"?e:e.id;return(n=(t=this._getTransportCallbacks)[r])==null?void 0:n.call(t)}_setConnectionState(e,t){this._connectionState[e.id]!==t&&(this._connectionState[e.id]=t,this._onConnectionStateChanged.emit({remoteMember:e,state:t}))}getStats(e){return this._getStats(e)}_getStats(e){var t,n,r;const i=typeof e=="string"?e:e.id;return(r=(n=(t=this._getStatsCallbacks)[i])==null?void 0:n.call(t))!=null?r:[]}_getStatsAll(){return Promise.all(Object.entries(this._getStatsCallbacks).map(e=>H(this,[e],function*([t,n]){return{memberId:t,stats:yield n().catch(()=>[])}})))}getRTCPeerConnection(e){return this._getRTCPeerConnection(e)}_getRTCPeerConnection(e){var t;return(t=this._getTransport(e))==null?void 0:t.rtcPeerConnection}getConnectionState(e){return this._getConnectionState(e)}_getConnectionState(e){var t;const n=typeof e=="string"?e:e.id;return(t=this._connectionState[n])!=null?t:"new"}_getConnectionStateAll(){return Object.keys(this._getTransportCallbacks).map(e=>({memberId:e,connectionState:this._getConnectionState(e)}))}toJSON(){return{label:this._label,contentType:this.contentType,id:this.id,side:this.side}}},L5=new Ge("packages/core/src/media/stream/local/media.ts"),tg=class extends ab{constructor(e,t,n={}){super(t),this.onTrackUpdated=new Qe,this.onDestroyed=new Qe,this._disposer=new Zr,this._trackConstraints={},this._replacingTrack=!1,this._onReplacingTrackDone=new Qe,this._onEnableChanged=new Qe,this._track=e,this._listenTrackEvent(),this._options=n,this._trackConstraints=ie({},n)}get trackConstraints(){return this._trackConstraints}toJSON(){const e=super.toJSON();return we(ie({},e),{trackConstraints:this.trackConstraints,isEnabled:this.isEnabled,_options:this._options})}get track(){return this._track}attach(e){this._element=e,j_(e,this._track)}detach(){this._element&&(B_(this._element,this._track),this._element=void 0)}_disable(e){this._options.stopTrackWhenDisabled?(this._trackConstraints=ie(ie({},this.trackConstraints),this.track.getConstraints()),this.track.stop()):this._oldTrack=this.track;const t=e==="video"?cb:j5;t.enabled=!1,this._onEnableChanged.emit(t),this._updateTrack(t)}_updateTrack(e){this._track=e,this._element&&this.attach(this._element),this.onTrackUpdated.emit(e),this._listenTrackEvent()}_listenTrackEvent(){const e=()=>{L5.info("onDestroyed",this.toJSON()),this.onDestroyed.emit()};this._track.addEventListener("ended",e),this._disposer.push(()=>this._track.removeEventListener("ended",e))}release(){this._disposer.dispose(),this._track.stop()}},ob=new RTCPeerConnection,j5=ob.addTransceiver("audio").receiver.track,cb=ob.addTransceiver("video").receiver.track,bp=new Ge("packages/core/src/media/stream/local/audio.ts"),Sp=class extends tg{constructor(e,t={}){if(super(e,"audio",t),this.contentType="audio",this._isEnabled=!0,this._promiseQueue=new ca,e.kind!=="audio")throw Oe({operationName:"LocalAudioStream.constructor",path:bp.prefix,info:Ve.invalidTrackKind,payload:{track:e}})}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){if(this._isEnabled===!0&&e===!1)this._isEnabled=e,this._disable("audio"),bp.debug("stopped");else if(this._isEnabled===!1&&e===!0){if(this._isEnabled=e,this._options.stopTrackWhenDisabled){const t=this._options.isDisplayMedia===!0?yield this.enableDisplay():yield this.enableMic();this._updateTrack(t),this._onEnableChanged.emit(t)}else this._oldTrack&&(this._updateTrack(this._oldTrack),this._onEnableChanged.emit(this._oldTrack));bp.debug("resumed")}}))})}get isEnabled(){return this._isEnabled}enableMic(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getUserMedia({audio:this.trackConstraints})).getAudioTracks();return e})}enableDisplay(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getDisplayMedia({audio:this.trackConstraints})).getAudioTracks();return e})}};Y();var B5=new Ge("packages/core/src/media/stream/local/customVideo.ts"),U5=class extends tg{constructor(e={}){super(cb,"video",e),this.contentType="video",this._isEnabled=!0,this._promiseQueue=new ca,this._stream=null}setStream(e){return H(this,null,function*(){if(this._stream)throw new Error("ProcessedStream is already exists");this._stream=e,this._updateTrack(e.track)})}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){var t;yield(t=this._stream)==null?void 0:t.setEnabled(e)}))})}updateTrack(e){return H(this,null,function*(){this._updateTrack(e),this._onEnableChanged.emit(e)})}get isEnabled(){return this._isEnabled}release(){var e;(e=this._stream)==null||e.dispose().catch(()=>{B5.error("release failed")})}};Y();var fu=new Ge("packages/core/src/media/stream/local/video.ts"),wp=class extends tg{constructor(e,t={}){if(super(e,"video",t),this.contentType="video",this._isEnabled=!0,this._promiseQueue=new ca,e.kind!=="video")throw Oe({operationName:"LocalVideoStream.constructor",path:fu.prefix,info:Ve.invalidTrackKind,payload:{track:e}});fu.debug("LocalVideoStream spawned",this.toJSON())}setEnabled(e){return H(this,null,function*(){yield this._promiseQueue.push(()=>H(this,null,function*(){if(this._isEnabled===!0&&e===!1)this._isEnabled=e,this._disable("video"),fu.debug("stopped",this.toJSON());else if(this._isEnabled===!1&&e===!0){if(this._isEnabled=e,this._options.stopTrackWhenDisabled){const t=this._options.isDisplayMedia===!0?yield this.enableDisplay():yield this.enableCamera();this._updateTrack(t),this._onEnableChanged.emit(t)}else this._oldTrack&&(this._updateTrack(this._oldTrack),this._onEnableChanged.emit(this._oldTrack));fu.debug("resumed",this.toJSON())}}))})}get isEnabled(){return this._isEnabled}enableCamera(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getUserMedia({video:this.trackConstraints})).getVideoTracks();return e})}enableDisplay(){return H(this,null,function*(){const[e]=(yield navigator.mediaDevices.getDisplayMedia({video:this.trackConstraints})).getVideoTracks();return e})}},H5=new Ge("packages/core/src/media/stream/local/data.ts"),ng=class extends ab{constructor(e={}){super("data"),this.options=e,this.contentType="data",this._onWriteData=new Qe,this._isEnabled=!0,this._setLabel("LocalDataStream")}get isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}write(e){if(!this._isEnabled)throw Oe({operationName:"LocalDataStream.write",path:H5.prefix,info:Ve.disabledDataStream});!ArrayBuffer.isView(e)&&typeof e!="string"&&(e=qf+JSON.stringify(e)),this._onWriteData.emit(e)}},qf="skyway_object:";Y();function V5(e,{publisherId:t,stream:n,origin:r,metadata:i,codecCapabilities:a,encodings:o,contentType:u,id:p,isEnabled:h}){const v=e._getPublication(p);if(v)return v;u=u.toLowerCase();const f=r?e._getPublication(r):void 0;return f&&o.length===0&&(o=f.encodings),new lb({id:p,channel:e,publisher:e._getMember(t),contentType:u,metadata:i,origin:f,stream:n,codecCapabilities:a??[],encodings:o,isEnabled:h})}var gn=new Ge("packages/core/src/publication/index.ts"),lb=class{constructor(e){this._codecCapabilities=[],this._encodings=[],this._state="enabled",this._events=new Qi,this.onCanceled=this._events.make(),this.onSubscribed=this._events.make(),this.onUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onEnabled=this._events.make(),this.onDisabled=this._events.make(),this.onStateChanged=this._events.make(),this.onConnectionStateChanged=new Qe,this._onEncodingsChanged=this._events.make(),this._onReplaceStream=this._events.make(),this._onEnabled=this._events.make(),this.streamEventDisposer=new Zr,this.cancel=()=>new Promise((i,a)=>{let o=!1;this._channel._unpublish(this.id).catch(u=>{o=!0,a(u)}),this._setStream(void 0),this.onCanceled.asPromise(this._context.config.rtcApi.timeout).then(()=>i()).catch(u=>{o||a(u)})}),this.updateMetadata=i=>new Promise((a,o)=>H(this,null,function*(){const u=gn.info("[start] updateMetadata",yield Pt({operationName:"Publication.updateMetadata",channel:this._channel}),this);let p=!1;this._channel._updatePublicationMetadata(this.id,i).catch(h=>{p=!0,o(h)}),this.onMetadataUpdated.watch(h=>h.metadata===i,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){a(),gn.elapsed(u,"[end] updateMetadata",yield Pt({operationName:"Publication.updateMetadata",channel:this._channel}),this)})).catch(h=>{if(!p)throw Oe({operationName:"PublicationImpl.updateMetadata",info:we(ie({},Ve.timeout),{detail:"publication onMetadataUpdated"}),path:gn.prefix,context:this._context,channel:this._channel,error:h})})})),this.disable=()=>new Promise((i,a)=>H(this,null,function*(){if(this.state==="disabled"){i();return}const o=gn.info("[start] disable",yield Pt({operationName:"Publication.disable",channel:this._channel}),this);yield this._disableStream();let u=!1;this._channel._disablePublication(this.id).catch(p=>{u=!0,a(p)}),this.onDisabled.asPromise(this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){i(),gn.elapsed(o,"[end] disable",yield Pt({operationName:"Publication.disable",channel:this._channel}),this)})).catch(p=>{u||a(p)})})),this.enable=()=>new Promise((i,a)=>H(this,null,function*(){if(this.stream==null){a(Oe({operationName:"Publication.enable",context:this._context,info:Ve.canNotEnableRemotePublication,path:gn.prefix}));return}if(this.state==="enabled"){i();return}const o=gn.info("[start] enable",yield Pt({operationName:"Publication.enable",channel:this._channel}),this);let u=!1;this._channel._enablePublication(this.id).catch(p=>{u=!0,a(p)}),this._onEnabled.asPromise(this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){yield this._enableStream(),this.onEnabled.emit(),this.onStateChanged.emit(),gn.elapsed(o,"[end] enable",yield Pt({operationName:"Publication.enable",channel:this._channel}),this),i()})).catch(p=>{u||a(p)})}));var t,n,r;this.id=e.id,this._channel=e.channel,this._context=this._channel._context,this.publisher=e.publisher,this.contentType=e.contentType,this._metadata=e.metadata,this.origin=e.origin,this.setCodecCapabilities((t=e.codecCapabilities)!=null?t:[]),this.setEncodings(zf((n=e.encodings)!=null?n:[])),this._state=e.isEnabled?"enabled":"disabled",e.stream&&this._setStream(e.stream),this._analytics=(r=this._channel.localPerson)==null?void 0:r._analytics,gn.debug("publication spawned",this.toJSON())}get codecCapabilities(){return this._codecCapabilities}setCodecCapabilities(e){this._codecCapabilities=e}get encodings(){return this._encodings}setEncodings(e){this._encodings=e}get stream(){return this._stream}_setStream(e){this._stream=e,e?e._onConnectionStateChanged.add(t=>{gn.debug("onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit(t)}).disposer(this.streamEventDisposer):this.streamEventDisposer.dispose()}get metadata(){return this._metadata}get state(){return this._state}get deviceName(){if(!(this.stream instanceof ng))return this.stream.track.label}get subscriptions(){return this._channel.subscriptions.filter(e=>e.publication.id===this.id)}_updateMetadata(e){this._metadata=e,this.onMetadataUpdated.emit({metadata:e})}_disable(){return H(this,null,function*(){yield this._disableStream(),this.onDisabled.emit(),this.onStateChanged.emit()})}_enable(){this.stream?this._onEnabled.emit():(this._state="enabled",this.onEnabled.emit(),this.onStateChanged.emit())}_unpublished(){this._state="canceled",this.stream&&this.stream._unpublished(),this.onCanceled.emit(),this.onStateChanged.emit(),this._dispose()}_subscribed(e){this.onSubscribed.emit({subscription:e}),this.onSubscriptionListChanged.emit()}_unsubscribed(e){this.onUnsubscribed.emit({subscription:e}),this.onSubscriptionListChanged.emit()}updateEncodings(e){gn.info("updateEncodings",{encodings:e},this),this.setEncodings(zf(ub(e))),this._onEncodingsChanged.emit(e),this._analytics&&!this._analytics.isClosed()&&this._analytics.client.sendPublicationUpdateEncodingsReport({publicationId:this.id,encodings:this.encodings,updatedAt:Date.now()})}_disableStream(){return H(this,null,function*(){this.state!=="disabled"&&(this._state="disabled",this.stream&&(this.stream.contentType==="data"?this.stream.setIsEnabled(!1):yield this.stream.setEnabled(!1).catch(e=>{gn.warn(In({channel:this._channel,operationName:"Publication._disableStream",payload:e,detail:"setEnabled failed"}))}),Pt({operationName:"Publication._disableStream",channel:this._channel}).then(e=>gn.info("publication _disableStream",e,{publication:this})).catch(()=>{})))})}_enableStream(){return H(this,null,function*(){this.state!=="enabled"&&(this._state="enabled",this.stream&&(Pt({operationName:"Publication._enableStream",channel:this._channel}).then(e=>gn.info("publication _enableStream",e,{publication:this})).catch(()=>{}),this.stream.contentType==="data"?this.stream.setIsEnabled(!0):yield this.stream.setEnabled(!0).catch(e=>{gn.warn(In({channel:this._channel,operationName:"Publication._disableStream",payload:e,detail:"setEnabled failed"}))})))})}replaceStream(e,t={}){var n;if(gn.info("replaceStream",{stream:e,options:t},this),!this.stream)throw Oe({operationName:"PublicationImpl.replaceStream",context:this._context,info:Ve.canNotUseReplaceStream,path:gn.prefix});if(e.contentType!==this.contentType)throw Oe({operationName:"PublicationImpl.replaceStream",context:this._context,info:Ve.invalidContentType,path:gn.prefix});((n=t.releaseOldStream)==null||n)&&this.stream.release(),Pt({operationName:"PublicationImpl.replaceStream",channel:this._channel}).then(i=>gn.debug(i,{old:this.stream,new:e})).catch(i=>i),e.setEnabled(this.stream.isEnabled).catch(i=>{gn.error("replaceStream stream.setEnabled",i,this.toJSON())});const r=this._stream;this._setStream(e),this._onReplaceStream.emit({newStream:e,oldStream:r}),this._analytics&&!this._analytics.isClosed()&&this._analytics.client.sendMediaDeviceReport({publicationId:this.id,mediaDeviceName:this.deviceName,mediaDeviceTrigger:"replaceStream",updatedAt:Date.now()})}getStats(e){if(!this.stream)throw Oe({operationName:"PublicationImpl.getStats",context:this._context,info:Ve.streamNotExistInSubscription,path:gn.prefix});return this.stream._getStats(e)}getRTCPeerConnection(e){if(!this.stream)throw Oe({operationName:"PublicationImpl.getRTCPeerConnection",context:this._context,info:Ve.streamNotExistInSubscription,path:gn.prefix});return this.stream._getRTCPeerConnection(e)}getConnectionState(e){if(!this.stream)throw Oe({operationName:"PublicationImpl.getConnectionState",context:this._context,info:Ve.streamNotExistInSubscription,path:gn.prefix});return this.stream._getConnectionState(e)}toJSON(){var e;return{id:this.id,channelId:this._channel.id,publisherId:this.publisher.id,origin:(e=this.origin)==null?void 0:e.id,contentType:this.contentType,metadata:this.metadata,codecCapabilities:this.codecCapabilities,encodings:this.encodings,state:this.state,stream:this.stream}}_dispose(){this._events.dispose()}},zf=e=>e.map((t,n)=>{var r;return we(ie({},t),{id:(r=t.id)!=null?r:n.toString()})}),ub=e=>{const[t]=e;return t.maxBitrate?e.sort((n,r)=>n.maxBitrate-r.maxBitrate):t.scaleResolutionDownBy?e.sort((n,r)=>r.scaleResolutionDownBy-n.scaleResolutionDownBy):t.maxFramerate?e.sort((n,r)=>n.maxFramerate-r.maxFramerate):e};Y();function q5(e){return e==null?!1:e.side==="remote"}Y();Y();var n1=new Ge("packages/core/src/dataPlane/agent/publishing.ts"),z5=class{constructor(e){this._localPerson=e,this.context=this._localPerson.context}startPublishing(e){return H(this,null,function*(){if(this.context.config.internal.disableDPlane){yield new Promise(i=>setTimeout(i,500));return}const t=e.publication,n=e.subscriber;t.stream||(yield this._localPerson.onStreamPublished.watch(i=>i.publication.id===t.id,this.context.config.rtcApi.timeout).catch(i=>{throw Oe({operationName:"PublishingAgent.startPublishing",context:this.context,channel:this._localPerson.channel,info:we(ie({},Ve.timeout),{detail:"PublishingAgent onStreamPublished"}),path:n1.prefix,payload:{publication:t},error:i})}));const r=n._getOrCreateConnection(this._localPerson);r.startPublishing&&(yield r.startPublishing(t,e.id))})}stopPublishing(e,t){return H(this,null,function*(){const n=t._getConnection(this._localPerson.id);n!=null&&n.stopPublishing&&n.stopPublishing(e).catch(r=>{n1.error("stopPublishing failed",r)})})}};Y();var K5=class{constructor(e){this._localPerson=e,this._disposers={},this._context=this._localPerson.context}startSubscribing(e){return H(this,null,function*(){if(this._context.config.internal.disableDPlane){yield new Promise(r=>setTimeout(r,500));return}const n=e.publication.publisher._getOrCreateConnection(this._localPerson);if(n.startSubscribing){yield n.startSubscribing(e);const{removeListener:r}=e._onChangeEncoding.add(()=>H(this,null,function*(){var i;yield(i=n.changePreferredEncoding)==null?void 0:i.call(n,e)}));this._disposers[e.id]=r}})}stopSubscribing(e){return H(this,null,function*(){var t,n;const i=e.publication.publisher._getConnection(this._localPerson.id);i!=null&&i.stopSubscribing&&(yield i.stopSubscribing(e),(n=(t=this._disposers)[e.id])==null||n.call(t))})}};Y();var r1=class{constructor(e){this._impl=e,this._events=new Qi,this.onLeft=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberStateChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onFatalError=this._events.make(),this.apply(e)}get keepaliveIntervalSec(){return this._impl.keepaliveIntervalSec}get keepaliveIntervalGapSec(){return this._impl.keepaliveIntervalGapSec}get disableSignaling(){return this._impl.disableSignaling}get disableAnalytics(){return this._impl.disableAnalytics}get type(){return this._impl.type}get subtype(){return this._impl.subtype}get side(){return this._impl.side}get id(){return this._impl.id}get name(){return this._impl.name}get channel(){return this._impl.channel}get metadata(){return this._impl.metadata}get state(){return this._impl.state}get publications(){return this._impl.publications}get subscriptions(){return this._impl.subscriptions}apply(e){this._impl=e,e.onLeft.pipe(this.onLeft),e.onMetadataUpdated.pipe(this.onMetadataUpdated),e.onStreamPublished.pipe(this.onStreamPublished),e.onStreamUnpublished.pipe(this.onStreamUnpublished),e.onPublicationListChanged.pipe(this.onPublicationListChanged),e.onPublicationSubscribed.pipe(this.onPublicationSubscribed),e.onPublicationUnsubscribed.pipe(this.onPublicationUnsubscribed),e.onSubscriptionListChanged.pipe(this.onSubscriptionListChanged),e.onFatalError.pipe(this.onFatalError)}subscribe(e,t){return this._impl.subscribe(e,t)}unsubscribe(e){return this._impl.unsubscribe(e)}publish(e,t={}){return this._impl.publish(e,t)}unpublish(e){return this._impl.unpublish(e)}updateMetadata(e){return this._impl.updateMetadata(e)}leave(){return H(this,null,function*(){yield this._impl.leave()})}dispose(){this._impl.dispose()}};Y();Y();var $5=24*60*60;Y();var i1=new Ge("packages/core/src/external/ice.ts"),W5=class{constructor(e){this.args=e,this.domain=this.args.domain,this.version=this.args.version,this.secure=this.args.secure,this.memberId=this.args.memberId,this.channelId=this.args.channelId,this.ttl=this.args.ttl,this.context=this.args.context,this._stunServers=[],this._turnServers=[],this._endpoint=`http${this.secure?"s":""}://${this.domain}/v${this.version}`,this.http=new Xm(this._endpoint)}updateIceParams(){return H(this,null,function*(){const e={memberId:this.memberId,channelId:this.channelId,ttl:this.ttl};i1.debug("[start] fetch iceParams");const t=new Ci({times:6,interval:500,jitter:100}),{turn:n,stun:r}=yield this.http.post("/ice-params",e,{headers:{authorization:`Bearer ${this.context.authTokenString}`},retry:()=>t.wait()});n&&(this._turnServers=[{credential:n.credential,urls:`turn:${n.domain}:${n.port}?transport=tcp`,username:n.username},{credential:n.credential,urls:`turn:${n.domain}:${n.port}?transport=udp`,username:n.username},{credential:n.credential,urls:`turns:${n.domain}:${n.port}?transport=tcp`,username:n.username}]),this._stunServers=[{urls:`stun:${r.domain}:${r.port}`}],i1.debug("[end] fetch iceParams",{turn:n,stun:r})})}get iceServers(){let e=[...this._stunServers];const t=this._turnServers.filter(n=>{const r=n.urls;switch(this.context.config.rtcConfig.turnProtocol){case"all":return!0;case"udp":return r.endsWith("udp");case"tcp":return!r.startsWith("turns")&&r.endsWith("tcp");case"tls":return r.startsWith("turns")}});return this.context.config.rtcConfig.turnPolicy!=="disable"&&(e=[...e,...t]),e}};Y();Y();Y();Y();var G5=20480,mu=class{constructor(e,t={}){if(this.event=e,this.payload=t,this.eventId=Oi(),this.data=JSON.stringify({event:this.event,eventId:this.eventId,payload:this.payload}),this.data.length>G5)throw new Error("payload size exceeds the upper limit")}};Y();var J5=["rateLimitExceeded","targetNotFound","payloadLengthExceeded","invalidPayload","unknown","parameterError","permissionError"];function s1(e){return!(!e||typeof e!="object"||!db(e.src)||!e.data||typeof e.data!="object")}function Z5(e){return!(!e||typeof e!="object"||typeof e.eventId!="string"||typeof e.ok!="boolean"||typeof e.reason<"u"&&(typeof e.reason!="string"||!J5.includes(e.reason)))}function db(e){return!(e===void 0||Array.isArray(e)||typeof e!="object"||typeof e.id!="string"||typeof e.name<"u"&&typeof e.name!="string")}Y();var a1=Br(qm());Y();var Ta=class{constructor(){this._listeners=new Map,this._listenerIndex=0,this.emit=e=>{this._listeners.forEach(t=>t(e))},this.removeAllListeners=()=>{this._listeners.clear()},this.addListener=e=>{const t=this._listenerIndex;return this._listeners.set(t,e),this._listenerIndex++,{removeListener:()=>{this._listeners.delete(t)}}},this.addOneTimeListener=e=>{const t=this.addListener(n=>{t.removeListener(),e(n)});return t},this.asPromise=e=>new Promise((t,n)=>{let r=()=>{};const i=e&&setTimeout(()=>{n("Event asPromise timeout"),r()},e);r=this.addOneTimeListener(o=>{i&&clearTimeout(i),t(o)}).removeListener})}};Y();var Q5="1.0.4",X5=["open","sendRequestSignalingMessage","sendResponseSignalingMessage","acknowledge"],Y5=e=>(_s(2,e)+Math.random())*1e3,e6=class{constructor({channelId:e,channelName:t,memberId:n,memberName:r,sessionEndpoint:i,token:a,logger:o}){this._isOpen=!1,this._isDestroyed=!1,this._reconnectCount=0,this.connectionState="closed",this.onConnectionStateChanged=new Ta,this.onOpened=new Ta,this.onEventReceived=new Ta,this.onConnectionFailed=new Ta,this._sessionEndpoint=i,this._channelId=e,this._channelName=t,this._memberId=n,this._memberName=r,this._token=a,this._logger=o,this._connect()}_setConnectionState(e){this._logger.debug(`connectionState changed : ${e}`),this.connectionState=e,this.onConnectionStateChanged.emit(e)}_connect(){let e;try{const t=`SkyWayAuthToken!${this._token}`,n={channelId:this._channelId,channelName:this._channelName,memberId:this._memberId,memberName:this._memberName,platform:"javascript",version:Q5},r=Object.entries(n).filter(([a,o])=>o!==void 0).map(a=>a.join("=")).join("&"),i=`${this._sessionEndpoint}?${r}`;e=new a1.default(i,t),this._logger.debug(`Connecting to signaling-server: ${this._sessionEndpoint}`),e.onerror=a=>{this._logger.error("WebSocket error occurred",a.error),e.close(4202)}}catch(t){const n=t instanceof Error?t:new Error;this._logger.error("Failed to create WebSocket instance",n),this.reconnect();return}e.onopen=()=>{this._logger.debug("Connected to signaling-server")},e.onclose=t=>{const n="Close event fired: "+JSON.stringify({code:t.code,reason:t.reason,type:t.type});if(4100<=t.code&&t.code<=4199?this._logger.error(n,new Error):this._logger.debug(n),t.code!==1e3&&!(4e3<=t.code&&t.code<=4199)){this.reconnect();return}t.code!==4e3&&(this._logger.debug("Closed the connection to signaling-server"),this.onConnectionFailed.emit(),this.destroy())},e.onmessage=t=>{this._messageHandler(t.data)},this._ws=e}updateAuthToken(e){this._token=e}reconnect(){if(this._ws!==void 0&&this._ws.close(4e3),this._ws=void 0,this._isOpen=!1,this._reconnectCount>=8)this.onConnectionFailed.emit(),this.destroy(),this._logger.error("Failed to reconnect for eight times",new Error);else{this._setConnectionState("reconnecting");const e=Y5(this._reconnectCount);this._reconnectTimer=setTimeout(()=>{this._connect(),this._reconnectCount++,this._logger.debug(`Try to reconnect: count = ${this._reconnectCount}`)},e)}}destroy(){this._isDestroyed=!0,this._setConnectionState("closed"),this.onConnectionStateChanged.removeAllListeners(),this.onOpened.removeAllListeners(),this.onEventReceived.removeAllListeners(),this.onConnectionFailed.removeAllListeners(),this._reconnectTimer&&clearTimeout(this._reconnectTimer),this._ws!==void 0&&this._ws.close(1e3)}send(e){return new Promise((t,n)=>{const r=()=>{this.onOpened.addOneTimeListener(()=>{this.send(e).then(()=>{t()}).catch(i=>{n(i)})}),this.onConnectionFailed.addOneTimeListener(()=>{n(new Error("Connection failed"))})};if(this._isDestroyed){n(new Error("The socket is already destroyed"));return}if(this._ws===void 0||!this._isOpen){this._logger.debug("Retry send the client event when connected because WebSocket is undefined or isOpen = false"),r();return}this._logger.debug(`Send the event: ${e.data}`),this._ws.send(e.data,i=>{if(i){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==a1.default.OPEN){this._logger.debug("Retry send the client event when connected because WebSocket.send failed"),r();return}n(i)}else t()})})}_messageHandler(e){if(typeof e!="string"){this._logger.error("Received invalid message: not string",new Error);return}let t;try{t=JSON.parse(e)}catch(n){const r=n instanceof Error?n:new Error;this._logger.error("Received invalid message: parse error",r);return}if(!t6(t)){this._logger.error(`Received invalid message: ${t}`,new Error);return}t.event==="open"?(this._logger.debug("Received a open event"),this._isOpen=!0,this._setConnectionState("connected"),this._reconnectCount!==0&&(this._reconnectCount=0,this._logger.debug("Succeeded to reconnect")),this.onOpened.emit()):(this._logger.debug(`Received the event: ${t.event}, payload: ${JSON.stringify(t.payload)}`),this.onEventReceived.emit(t))}};function t6(e){return!(!e||typeof e!="object"||typeof e.event!="string"||!X5.includes(e.event)||typeof e.eventId!="string"||e.payload&&typeof e.payload!="object")}var o1="signaling.skyway.ntt.com",n6="v1",r6=class{constructor({token:e,channelId:t,channelName:n,memberId:r,memberName:i},a){this.onConnectionStateChanged=new Ta,this.onConnectionFailed=new Ta,this.onRequested=new Ta,this._connectivityCheckTimers=new Map,this._responseCallbacks=new Map,this._acknowledgeCallbacks=new Map,this._token=e,this._channelId=t,this._channelName=n,this._memberId=r,this._memberName=i;const o={connectivityCheckIntervalSec:30,signalingServerDomain:o1,secure:!0,logger:{debug:u=>{console.debug(u)},error:u=>{console.error(u)}}};this._options=Object.assign({},o,a??{}),this._logger=this._options.logger,this._logger.debug(`Created instance with the options: ${this._options}`)}get connectionState(){var e,t;return(t=(e=this._socket)==null?void 0:e.connectionState)!=null?t:"closed"}connect(){return H(this,null,function*(){const e=this._options.secure?"wss":"ws",t=this._options.signalingServerDomain||o1;this._socket=new e6({sessionEndpoint:`${e}://${t}/${n6}/ws`,channelId:this._channelId,channelName:this._channelName,memberId:this._memberId,memberName:this._memberName,token:this._token,logger:this._logger}),this._socket.onEventReceived.addListener(n=>{try{this._eventReceivedHandler(n)}catch(r){this._logger.error("in _eventReceivedHandler",r)}}),this._socket.onConnectionFailed.addListener(()=>{this.onConnectionFailed.emit()}),this._socket.onConnectionStateChanged.addListener(n=>{this.onConnectionStateChanged.emit(n)}),yield this._socket.onOpened.asPromise(15*1e3),this._startConnectivityCheck()})}disconnect(){var e;this._stopConnectivityCheck(),(e=this._socket)==null||e.destroy(),this._socket=void 0,this._responseCallbacks.clear(),this._acknowledgeCallbacks.clear()}_startConnectivityCheck(){if(this._connectivityCheckInterval){this._logger.debug("connectivity check timer is already set");return}this._connectivityCheckInterval=setInterval(()=>{var e;const t=new mu("checkConnectivity");(e=this._socket)==null||e.send(t).catch(()=>{this._acknowledgeCallbacks.delete(t.eventId)}),this._connectivityCheckTimers.set(t.eventId,setTimeout(()=>{var n;this._acknowledgeCallbacks.delete(t.eventId),(n=this._socket)==null||n.reconnect(),this._logger.debug("connectivity check timer is expired")},5*1e3)),this._setAcknowledgeCallback(t.eventId,n=>{var r;const i=this._connectivityCheckTimers.get(t.eventId);i&&(clearTimeout(i),this._connectivityCheckTimers.delete(t.eventId)),n.ok||((r=this._socket)==null||r.reconnect(),this._logger.debug("connectivity check response from server was not ok"))})},this._options.connectivityCheckIntervalSec*1e3),this._logger.debug("Started connectivity check timer")}_stopConnectivityCheck(){if(!this._connectivityCheckInterval){this._logger.debug("connectivity check timer is not set");return}clearInterval(this._connectivityCheckInterval),this._connectivityCheckInterval=void 0,this._logger.debug("Stopped connectivity check timer");for(const[e,t]of this._connectivityCheckTimers)clearTimeout(t);this._connectivityCheckTimers.clear()}request(e,t,n=10){return i6(e),c1(t),new Promise((r,i)=>{if(this._socket===void 0){i(new Error("websocket is not connected"));return}const a={dst:e,data:t},o=new mu("sendRequestSignalingMessage",a),u=setTimeout(()=>{this._acknowledgeCallbacks.delete(o.eventId),i(new Error("request timeout"))},n*1e3);this._setResponseCallback(o.eventId,p=>{clearTimeout(u),r(p)}),this._setAcknowledgeCallback(o.eventId,p=>{p.ok||(clearTimeout(u),i(p))}),this._socket.send(o).catch(p=>{this._acknowledgeCallbacks.delete(o.eventId),clearTimeout(u),i(p)})})}_response(e,t,n,r){return new Promise((i,a)=>{if(c1(n),this._socket===void 0){a(new Error("websocket is not connected"));return}const o={dst:e,requestEventId:t,data:n},u=new mu("sendResponseSignalingMessage",o),p=setTimeout(()=>{this._acknowledgeCallbacks.delete(u.eventId),a(new Error("response timeout"))},r*1e3);this._setAcknowledgeCallback(u.eventId,h=>{clearTimeout(p),h.ok?i():a(h)}),this._socket.send(u).catch(h=>{this._acknowledgeCallbacks.delete(u.eventId),clearTimeout(p),a(h)})})}updateSkyWayAuthToken(e,t=10){return new Promise((n,r)=>{if(this._socket===void 0){r(new Error("websocket is not connected"));return}const i={token:e},a=new mu("updateSkyWayAuthToken",i),o=setTimeout(()=>{this._acknowledgeCallbacks.delete(a.eventId),r(new Error("updateSkyWayAuthToken timeout"))},t*1e3);this._setAcknowledgeCallback(a.eventId,u=>{if(clearTimeout(o),u.ok){if(this._socket===void 0){r(new Error("websocket is not connected"));return}this._socket.updateAuthToken(e),n()}else r(u)}),this._socket.send(a).catch(u=>{this._acknowledgeCallbacks.delete(a.eventId),clearTimeout(o),r(u)})})}_eventReceivedHandler(e){switch(e.event){case"acknowledge":this._acknowledgeHandler(e.payload);break;case"sendRequestSignalingMessage":this._eventMessageRequestHandler(e.payload);break;case"sendResponseSignalingMessage":this._eventMessageResponseHandler(e.payload);break;case"open":break;default:e.event,this._logger.debug(`Unknown event: ${e.event}`)}}_acknowledgeHandler(e){if(!Z5(e))throw new Error("Invalid payload");const{eventId:t}=e;if(!this._acknowledgeCallbacks.has(t))throw new Error(`acknowledge event has unknown eventId: ${t}`);const n=this._acknowledgeCallbacks.get(t);n&&(this._acknowledgeCallbacks.delete(t),n(e))}_eventMessageRequestHandler(e){if(!s1(e))throw new Error("Invalid payload");if(!e.requestEventId)throw new Error("Invalid payload");const t=e.src,n=e.requestEventId,r=(i,a=10)=>H(this,null,function*(){yield this._response(t,n,i,a)});this.onRequested.emit({data:e.data,reply:r,requestEventId:e.requestEventId,src:e.src})}_eventMessageResponseHandler(e){if(!s1(e))throw new Error("Invalid payload");if(!e.requestEventId||!this._responseCallbacks.has(e.requestEventId))throw new Error(`received response has unknown eventId: ${e.requestEventId}`);const t=this._responseCallbacks.get(e.requestEventId);t&&(this._responseCallbacks.delete(e.requestEventId),t(e.data))}_setResponseCallback(e,t){this._responseCallbacks.set(e,t)}_setAcknowledgeCallback(e,t){this._acknowledgeCallbacks.set(e,t)}};function c1(e){if(!e||typeof e!="object")throw new Error("the type of data must be object")}function i6(e){if(!db(e))throw new Error("the type of target must be {id: string, name: string}");if(!GC(e.id))throw new Error("the type of target.id must be uuid format")}Y();var ri=new Ge("packages/core/src/external/signaling.ts");function s6(e,t,n){return H(this,null,function*(){const{signalingService:r}=e.config,i=new r6({token:e.authTokenString,channelId:t.id,channelName:t.name,memberId:n.id,memberName:n.name},{logger:{error:o=>H(null,null,function*(){ri.error("SignalingClient error",Oe({operationName:"SignalingClient.logger",context:e,info:we(ie({},Ve.internal),{detail:"signalingClient error"}),error:o,path:ri.prefix,channel:t}))}),debug:o=>{}},signalingServerDomain:r.domain,secure:r.secure}),a=new a6(i,e);return yield a.connect(),a})}var a6=class{constructor(e,t){this._client=e,this.context=t,this.onConnectionFailed=new Qe,this.onConnectionStateChanged=new Qe,this.onMessage=new Qe,this.closed=!1,this._chunkedMessageBuffer={},this._backoffUpdateSkyWayAuthToken=new Ci({times:8,interval:100,jitter:100}),this._disposer=new Zr,this._listen(),t._onTokenUpdated.add(n=>H(this,null,function*(){yield this._updateSkyWayAuthToken(n)})).disposer(this._disposer)}updateClient(e){this._client=e,this._listen()}_listen(){this._client.onConnectionFailed.addOneTimeListener(()=>{this.onConnectionFailed.emit({})}),this._client.onConnectionStateChanged.addListener(e=>{ri.debug("signalingClient onConnectionStateChanged",e),this.onConnectionStateChanged.emit(e)}),this._client.onRequested.addListener(e=>H(this,[e],function*({data:t,src:n,reply:r}){var i;const a=t,{chunk:o,length:u,offset:p,id:h,type:v}=a;if(v===xp){if(u===0)this.onMessage.emit({src:n,data:JSON.parse(o)});else if(this._chunkedMessageBuffer[h]=[...(i=this._chunkedMessageBuffer[h])!=null?i:[],a.chunk],u===p){const f=this._chunkedMessageBuffer[h].join("");delete this._chunkedMessageBuffer[h],this.onMessage.emit({src:n,data:JSON.parse(f)})}yield r({}).catch(f=>{this.closed||ri.warn("failed to reply",In({operationName:"SignalingSession.reply",detail:"SignalingClient failed to reply"}),f)})}}))}_updateSkyWayAuthToken(e){return H(this,null,function*(){if(this._backoffUpdateSkyWayAuthToken.exceeded){ri.error("[failed] updateSkyWayAuthToken");return}yield this._backoffUpdateSkyWayAuthToken.wait(),ri.debug("[start] updateSkyWayAuthToken",{count:this._backoffUpdateSkyWayAuthToken.count});const t=yield this._client.updateSkyWayAuthToken(e).catch(n=>n);if(t){ri.warn("[retry] updateSkyWayAuthToken",In({operationName:"SignalingSession._updateSkyWayAuthToken",detail:"[retry] updateSkyWayAuthToken"}),t),yield this._updateSkyWayAuthToken(e);return}ri.debug("[end] updateSkyWayAuthToken"),this._backoffUpdateSkyWayAuthToken.reset()})}get connectionState(){return this._client.connectionState}connect(){return H(this,null,function*(){ri.debug("[start] connect signalingService"),yield this._client.connect().catch(e=>{throw Oe({operationName:"signalingSession.connect",path:ri.prefix,info:we(ie({},Ve.internal),{detail:"signalingClient failed to connect Server"}),context:this.context,error:e})}),ri.debug("[end] connect signalingService")})}close(){this.closed=!0,this._disposer.dispose(),this._client.disconnect()}send(e,t,n=1e4){return H(this,null,function*(){var r;try{const i=JSON.stringify(t),a=Ko();if(i.length>20480){const o=(r=i.match(/.{1,20480}/g))!=null?r:[];let u=0;for(const p of o){const h={type:xp,length:o.length-1,offset:u++,chunk:p,id:a};yield this._client.request(e,h,n/1e3)}}else{const o={type:xp,length:0,offset:0,chunk:i,id:a};yield this._client.request(e,o,n/1e3)}}catch(i){if(this.closed||e.state!=="joined")return;throw Oe({operationName:"SignalingSession.send",context:this.context,info:we(ie({},Ve.internal),{detail:"signalingClient"}),error:i,path:ri.prefix,payload:{target:e,data:t}})}})}},xp="signalingMessage",l1=new Ge("packages/core/src/member/person/local/factory.ts");function o6(e,t,n){return H(this,arguments,function*(r,i,a,{keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p,disableSignaling:h}={}){var v;l1.debug("createLocalPerson",{channel:i,memberDto:a,keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p});const{iceParamServer:f}=r.config,_=h===!0?void 0:yield s6(r,i,a),w=new W5(we(ie({},f),{memberId:a.id,channelId:i.id,ttl:$5,context:r}));yield w.updateIceParams().catch(R=>{throw Oe({operationName:"createLocalPerson",context:r,channel:i,info:we(ie({},Ve.internal),{detail:"updateIceParams failed"}),path:l1.prefix,error:R})});const C=yield c6.Create({iceManager:w,channel:i,signaling:_,analytics:r.analyticsSession,metadata:a.metadata,name:a.name,id:a.id,keepaliveIntervalSec:o,keepaliveIntervalGapSec:u,preventAutoLeaveOnBeforeUnload:p,context:r});for(const R of r.plugins)yield(v=R._whenCreateLocalPerson)==null?void 0:v.call(R,C),C._onDisposed.once(()=>H(null,null,function*(){var S;yield(S=R._whenDisposeLocalPerson)==null?void 0:S.call(R,C)}));return C})}var mt=new Ge("packages/core/src/member/localPerson/index.ts"),c6=class hb extends uh{constructor(t){super(t),this.args=t,this.type="person",this.subtype="person",this.side="local",this.keepaliveIntervalSec=this.args.keepaliveIntervalSec,this.keepaliveIntervalGapSec=this.args.keepaliveIntervalGapSec,this.preventAutoLeaveOnBeforeUnload=this.args.preventAutoLeaveOnBeforeUnload,this.disableSignaling=this.args.disableSignaling,this.disableAnalytics=this.args.disableAnalytics,this.config=this.context.config,this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onFatalError=this._events.make(),this._onStreamSubscribeFailed=this._events.make(),this._onDisposed=this._events.make(),this._disposer=new Zr,this._subscribing={},this._requestQueue=new ca,this.iceManager=this.args.iceManager,this._disposed=!1,this._publishingAgent=new z5(this),this._subscribingAgent=new K5(this),this._signaling=t.signaling,this._analytics=t.analytics,this._listenChannelEvent(),this._listenBeforeUnload()}static Create(...t){return H(this,null,function*(){const n=new hb(...t);return yield n._setupTtlTimer(),n._analytics&&n._analytics.client.sendJoinReport({memberId:n.id}),n})}_listenChannelEvent(){this.channel.onPublicationSubscribed.add(t=>H(this,[t],function*({subscription:n}){yield this._handleOnPublicationSubscribe(n).catch(r=>mt.error("_handleOnStreamSubscribe",r))})).disposer(this._disposer),this.channel.onPublicationUnsubscribed.add(t=>H(this,[t],function*({subscription:n}){yield this._handleOnPublicationUnsubscribe(n).catch(r=>mt.error("_handleOnStreamUnsubscribe",r))})).disposer(this._disposer),this.channel._onDisposed.once(()=>{this.dispose()}),this.onLeft.once(()=>{this.dispose()})}_setupTtlTimer(){return H(this,null,function*(){const{keepaliveIntervalSec:t,keepaliveIntervalGapSec:n}=this;if(t==null||(mt.debug("_setupTtlTimer",this.toJSON(),{keepaliveIntervalSec:t,keepaliveIntervalGapSec:n}),t===-1))return;const r=()=>H(this,null,function*(){if(this._disposed)return;const i=yield this.context._api.getServerUnixtimeInSec();this.ttlSec=Math.floor(i+t+(n??0));try{yield this.channel._updateMemberTtl(this.id,this.ttlSec),mt.debug("updateTtl",this.toJSON(),{now:i,ttlSec:this.ttlSec,keepaliveIntervalSec:t??0,keepaliveIntervalGapSec:n??0,diff:this.ttlSec-i})}catch(a){if(this._disposed)return;throw a}});yield r(),this.ttlInterval=setInterval(()=>H(this,null,function*(){yield r().catch(i=>{this._disposed||(this.onFatalError.emit(Oe({operationName:"localPerson._setupTtlTimer",path:mt.prefix,info:we(ie({},Ve.internal),{detail:"updateMemberTtl failed"}),channel:this.channel,context:this.context,error:i})),this.dispose())})}),t*1e3)})}_listenBeforeUnload(){if(window&&!this.preventAutoLeaveOnBeforeUnload){const t=()=>H(this,null,function*(){window.removeEventListener("beforeunload",t),this.state==="joined"&&(mt.debug("leave by beforeunload",this.toJSON()),yield this.leave())});window.addEventListener("beforeunload",t)}}_handleOnPublicationSubscribe(t){return H(this,null,function*(){var n;if(t.subscriber.id===this.id)try{const r=mt.info("[start] startSubscribing",yield Pt({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t}),i=(n=this._subscribing[t.publication.id])==null?void 0:n.options;i&&(t.preferredEncoding=i.preferredEncodingId),yield this._subscribingAgent.startSubscribing(t),this.onPublicationSubscribed.emit({subscription:t,stream:t.stream}),this.onSubscriptionListChanged.emit(),mt.elapsed(r,"[end] startSubscribing",yield Pt({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t})}catch(r){throw this._onStreamSubscribeFailed.emit({error:r,subscription:t}),r}if(t.publication.publisher.id===this.id){if(t.subscriber.id===this.id)throw Oe({operationName:"localPerson._handleOnStreamSubscribe",path:mt.prefix,info:we(ie({},Ve.internal),{detail:"can not subscribe own Publication"}),channel:this.channel,context:this.context});const r=mt.info("[start] startPublishing",yield Pt({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t});yield this._publishingAgent.startPublishing(t).catch(i=>{throw mt.error("[failed] startPublishing",i,{subscription:t}),i}),mt.elapsed(r,"[end] startPublishing",yield Pt({operationName:"onPublicationSubscribed",channel:this.channel}),{subscription:t})}})}_handleOnPublicationUnsubscribe(t){return H(this,null,function*(){if(t.publication.publisher.id===this.id){const n=mt.info("[start] stopPublishing",yield Pt({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t});yield this._publishingAgent.stopPublishing(t.publication,t.subscriber).catch(r=>{throw mt.error("[failed] stopPublishing",r,{subscription:t}),r}),mt.elapsed(n,"[end] stopPublishing",yield Pt({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t})}if(t.subscriber.id===this.id){const n=mt.info("[start] stopSubscribing",yield Pt({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t});yield this._subscribingAgent.stopSubscribing(t).catch(r=>{throw mt.error("[failed] stopSubscribing",{subscription:t},r),r}),this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit(),mt.elapsed(n,"[end] stopSubscribing",yield Pt({operationName:"onPublicationUnsubscribed",channel:this.channel}),{subscription:t})}})}publish(t){return H(this,arguments,function*(n,r={}){var i,a,o,u;const p=mt.info("[start] publish",yield Pt({operationName:"localPerson.publish",channel:this.channel}),{options:r});if(this.state!=="joined")throw Oe({operationName:"localPerson.publish",info:Ve.localPersonNotJoinedChannel,path:mt.prefix,channel:this.channel,context:this.context});if(n.published)throw Oe({operationName:"localPerson.publish",channel:this.channel,context:this.context,info:Ve.alreadyPublishedStream,path:mt.prefix});n.published=!0,r.codecCapabilities&&(r.codecCapabilities=r.codecCapabilities.filter(_=>_!=null));const h={metadata:r.metadata,publisher:this.id,channel:this.channel.id,contentType:n.contentType,codecCapabilities:(i=r.codecCapabilities)!=null?i:[],isEnabled:r.isEnabled};n.contentType==="video"&&h.codecCapabilities.length===0&&(h.codecCapabilities=[{mimeType:"video/vp8"}]),r.encodings&&r.encodings.length>0&&(h.encodings=zf(ub(r.encodings)));const v=yield this._requestQueue.push(()=>this.channel._publish(h).catch(_=>{throw Oe({operationName:"localPerson.publish",context:this.context,channel:this.channel,info:_.info,path:mt.prefix,error:_})}));n.contentType==="data"?n.setIsEnabled(v.isEnabled):yield n.setEnabled(v.isEnabled);const f=this.channel._addPublication(v);if(f._setStream(n),(a=h.codecCapabilities)!=null&&a.length&&f.setCodecCapabilities(h.codecCapabilities),(o=h.encodings)!=null&&o.length&&f.setEncodings(h.encodings),yield this._handleOnStreamPublish(f),mt.elapsed(p,"[end] publish",yield Pt({operationName:"localPerson.publish",channel:this.channel}),{publication:f}),["video","audio"].includes(f.contentType)&&this._analytics&&!this._analytics.isClosed()){this._analytics.client.sendMediaDeviceReport({publicationId:f.id,mediaDeviceName:f.deviceName,mediaDeviceTrigger:"publish",updatedAt:Date.now()});const _=(u=h.encodings)!=null?u:[];this._analytics.client.sendPublicationUpdateEncodingsReport({publicationId:f.id,encodings:_,updatedAt:Date.now()})}return f})}_handleOnStreamPublish(t){return H(this,null,function*(){mt.info("onStreamPublished",yield Pt({operationName:"onStreamPublished",channel:this.channel})),this.onStreamPublished.emit({publication:t}),this.onPublicationListChanged.emit()})}unpublish(t){return H(this,null,function*(){const n=mt.info("[start] unpublish",yield Pt({operationName:"localPerson.unpublish",channel:this.channel})),r=typeof t=="string"?t:t.id;if(this.state!=="joined")throw Oe({operationName:"localPerson.unpublish",info:Ve.localPersonNotJoinedChannel,path:mt.prefix,context:this.context,channel:this.channel});const i=this.channel._getPublication(r);if(!i)throw Oe({operationName:"localPerson.unpublish",info:Ve.publicationNotExist,path:mt.prefix,context:this.context,channel:this.channel,payload:{publicationId:r}});i.stream&&i.stream._unpublished(),yield this._requestQueue.push(()=>this.channel._unpublish(r)),i.subscriptions.map(a=>a.subscriber).forEach(a=>{q5(a)&&this._publishingAgent.stopPublishing(i,a).catch(o=>{mt.error("[failed] stopPublishing",o,{publication:i})})}),yield this._handleOnStreamUnpublished(i),mt.elapsed(n,"[end] unpublish",yield Pt({operationName:"localPerson.unpublish",channel:this.channel}),{publication:i})})}_handleOnStreamUnpublished(t){return H(this,null,function*(){mt.info("onStreamUnpublished",yield Pt({operationName:"onStreamUnpublished",channel:this.channel})),this.onStreamUnpublished.emit({publication:t}),this.onPublicationListChanged.emit()})}subscribe(t){return H(this,arguments,function*(n,r={}){const i=mt.info("[start] subscribe",yield Pt({operationName:"localPerson.subscribe",channel:this.channel}),{target:n}),a=typeof n=="string"?n:n.id;if(this.state!=="joined")throw Oe({operationName:"localPerson.subscribe",info:Ve.localPersonNotJoinedChannel,path:mt.prefix,context:this.context,channel:this.channel,payload:{target:n}});const o=this.channel._getPublication(a);if(o==null)throw Oe({operationName:"localPerson.subscribe",info:Ve.publicationNotExist,path:mt.prefix,context:this.context,channel:this.channel,payload:o});this._validatePublicationForSubscribe(o),this._subscribing[o.id]={options:r,processing:!0};const u=this._subscribing[o.id];try{const p=yield this._requestQueue.push(()=>this.channel._subscribe(this.id,a));mt.elapsed(i,"[elapsed] subscribe / subscriptionDto received",{subscriptionDto:p});const h=this.channel._addSubscription(p);return h.stream||(yield Promise.race([new Promise((v,f)=>{this.onPublicationSubscribed.watch(({subscription:_})=>_.publication.id===a,this.context.config.rtcApi.timeout).then(v).catch(_=>H(this,null,function*(){u.processing&&f(Oe({operationName:"localPerson.subscribe",info:we(ie({},Ve.timeout),{detail:"failed to subscribe publication. maybe publisher already left room"}),path:mt.prefix,context:this.context,channel:this.channel,payload:{subscription:h,publication:o},error:_}))}))}),new Promise((v,f)=>{this.channel.onMemberLeft.watch(_=>_.member.id===o.publisher.id,this.context.config.rtcApi.timeout+1e3).then(()=>{u.processing&&f(Oe({operationName:"localPerson.subscribe",info:we(ie({},Ve.internal),{detail:"failed to subscribe publication. publisher already left room"}),path:mt.prefix,context:this.context,channel:this.channel,payload:{subscription:h,publication:o}}))}).catch(v)}),new Promise((v,f)=>{this._onStreamSubscribeFailed.watch(_=>_.subscription.publication.id===o.id,this.context.config.rtcApi.timeout+1e3).then(_=>{var w,C;if(u.processing){const R=(C=(w=_==null?void 0:_.error)==null?void 0:w.info)!=null?C:we(ie({},Ve.internal),{detail:"subscribe _onStreamSubscribeFailed"});f(Oe({operationName:"localPerson.subscribe",info:R,path:mt.prefix,context:this.context,channel:this.channel,error:_.error,payload:{subscription:h,publication:o}}))}}).catch(v)})])),u.processing=!1,mt.elapsed(i,"[end] subscribe",yield Pt({operationName:"localPerson.subscribe",channel:this.channel}),{subscription:h,publication:o}),{subscription:h,stream:h.stream}}catch(p){throw u.processing=!1,mt.warn("[failed] subscribe",p,{publication:o}),p}})}_validatePublicationForSubscribe(t){if(t.publisher.id===this.id)throw Oe({operationName:"localPerson._validatePublicationForSubscribe",info:Ve.publicationNotExist,path:mt.prefix,context:this.context,channel:this.channel,payload:{publication:t}});if(t.publisher instanceof M_)throw Oe({operationName:"localPerson._validatePublicationForSubscribe",info:Ve.unknownMemberType,path:mt.prefix,context:this.context,channel:this.channel,payload:{publication:t}});if(this.subscriptions.find(n=>n.publication.id===t.id))throw Oe({operationName:"localPerson._validatePublicationForSubscribe",info:Ve.alreadySubscribedPublication,path:mt.prefix,context:this.context,channel:this.channel,payload:{publication:t}})}unsubscribe(t){return H(this,null,function*(){const n=mt.info("[start] unsubscribe",yield Pt({operationName:"localPerson.unsubscribe",channel:this.channel})),r=typeof t=="string"?t:t.id;if(this.state!=="joined")throw Oe({operationName:"localPerson.unsubscribe",info:Ve.localPersonNotJoinedChannel,path:mt.prefix,context:this.context,channel:this.channel});const i=this.subscriptions.find(a=>a.id===r);if(!i)throw Oe({operationName:"localPerson.unsubscribe",info:Ve.subscriptionNotExist,path:mt.prefix,context:this.context,channel:this.channel,payload:{subscriptionId:r}});delete this._subscribing[i.publication.id],yield this._requestQueue.push(()=>this.channel._unsubscribe(r)),mt.elapsed(n,"[end] unsubscribe",yield Pt({operationName:"localPerson.unsubscribe",channel:this.channel}),{subscription:i})})}_getConnections(){return this.channel.members.map(r=>r._getConnection(this.id)).filter(r=>(r==null?void 0:r.closed)===!1)}dispose(){this._disposed||(this._disposed=!0,mt.debug("disposed",this.toJSON()),clearInterval(this.ttlInterval),this._signaling&&this._signaling.close(),this._analytics&&this._analytics.close(),this._getConnections().forEach(t=>t.close({reason:"localPerson disposed"})),this._onDisposed.emit(),this._events.dispose(),this._disposer.dispose())}};Y();Y();var zi=new Ge("packages/core/src/subscription/index.ts"),l6=class{constructor(e){this._disposer=new Zr,this._state="enabled",this.onCanceled=new Qe,this.onStreamAttached=new Qe,this.onConnectionStateChanged=new Qe,this._onChangeEncoding=new Qe,this.cancel=()=>new Promise((t,n)=>{let r=!1;this._channel._unsubscribe(this.id).catch(i=>{r=!0,n(i)}),this.onCanceled.asPromise(this._context.config.rtcApi.timeout).then(()=>t()).catch(i=>{r||n(i)})}),this._channel=e.channel,this._context=this._channel._context,this.id=e.id,this.contentType=e.contentType,this.subscriber=e.subscriber,this.publication=e.publication,zi.debug("subscription spawned",this.toJSON()),this._handlePublicationEnabled()}get state(){return this._state}_handlePublicationEnabled(){this.publication.onDisabled.add(()=>{this.stream&&(zi.debug("disabled",this),this.stream.setIsEnabled(!1))}).disposer(this._disposer),this.publication.onEnabled.add(()=>{this.stream&&(zi.debug("enabled",this),this.stream.setIsEnabled(!0))}).disposer(this._disposer),this.stream&&this.stream.setIsEnabled(this.publication.state==="enabled")}_setStream(e){this._stream=e,this.onStreamAttached.emit(),e._onConnectionStateChanged.add(t=>{zi.debug("onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit(t)})}get stream(){return this._stream}toJSON(){return{id:this.id,contentType:this.contentType,subscriber:this.subscriber,publication:this.publication,channelId:this._channel.id,state:this.state,stream:this.stream}}_canceled(){this._state="canceled",this.onCanceled.emit(),this._disposer.dispose()}changePreferredEncoding(e){if(!this.stream)throw Oe({operationName:"SubscriptionImpl.changePreferredEncoding",info:Ve.streamNotExistInSubscription,path:zi.prefix,context:this._context,channel:this._channel});if(this.stream.contentType==="data")throw Oe({operationName:"SubscriptionImpl.changePreferredEncoding",info:Ve.dataStreamNotSupportEncoding,path:zi.prefix,context:this._context,channel:this._channel});if(!this.publication.encodings.map(t=>t.id).includes(e))throw Oe({operationName:"SubscriptionImpl.changePreferredEncoding",info:Ve.correspondingEncodeNotExistForId,path:zi.prefix,context:this._context,channel:this._channel});this.preferredEncoding=e,this._onChangeEncoding.emit()}getStats(){if(!this.stream)throw Oe({operationName:"SubscriptionImpl.getStats",info:Ve.streamNotExistInSubscription,path:zi.prefix,context:this._context,channel:this._channel});return this.stream._getStats()}getRTCPeerConnection(){if(!this.stream)throw Oe({operationName:"SubscriptionImpl.getRTCPeerConnection",info:Ve.streamNotExistInSubscription,path:zi.prefix,context:this._context,channel:this._channel});return this.stream._getRTCPeerConnection()}getConnectionState(){if(!this.stream)throw Oe({operationName:"SubscriptionImpl.getConnectionState",info:Ve.streamNotExistInSubscription,path:zi.prefix,context:this._context,channel:this._channel});return this.stream._getConnectionState()}};function u6(e,{subscriberId:t,publicationId:n,id:r}){const i=e._getSubscription(r);if(i)return i;const o=e._getPublication(n).contentType;return new l6({channel:e,id:r,subscriber:e._getMember(t),publication:e._getPublication(n),contentType:o})}var en=new Ge("packages/core/src/channel/index.ts"),Cp=class{constructor(e,t){this._context=e,this._channelImpl=t,this.id=this._channelImpl.id,this.name=this._channelImpl.name,this.appId=this._context.appId,this.disposed=!1,this.config=this._context.config,this._state="opened",this._api=this._context._api,this._members={},this._getMember=n=>this._members[n],this._publications={},this._getPublication=n=>this._publications[n],this._subscriptions={},this._getSubscription=n=>this._subscriptions[n],this._events=new Qi,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this._onDisposed=this._events.make(),this.leave=n=>H(this,null,function*(){return this._channelImpl.leave(this.id,n.id)}),this.updateMetadata=n=>this._channelImpl.updateChannelMetadata(n),this.close=()=>new Promise((n,r)=>H(this,null,function*(){if(this.state==="closed"){r(Oe({operationName:"SkyWayChannelImpl.close",path:en.prefix,info:Ve.alreadyChannelClosed,channel:this,context:this._context,payload:this.toJSON()}));return}const i=en.info("[start] close channel",yield Pt({operationName:"SkyWayChannelImpl.close",channel:this}));try{yield this._channelImpl.close().catch(a=>{throw Oe({operationName:"SkyWayChannelImpl.close",context:this._context,info:we(ie({},Ve.internal),{detail:"_api.deleteChannel failed"}),error:a,path:en.prefix,channel:this})}),this._state!=="closed"&&(yield this.onClosed.asPromise(this._context.config.rtcApi.timeout).catch(a=>{throw Oe({operationName:"SkyWayChannelImpl.close",context:this._context,info:we(ie({},Ve.timeout),{detail:"channel.onClosed"}),error:a,path:en.prefix,channel:this})}))}catch(a){en.error(a.message,a),r(a)}en.elapsed(i,"[end] close channel",yield Pt({operationName:"SkyWayChannelImpl.close",channel:this})),n()})),this._updateMemberTtl=(n,r)=>this._channelImpl.updateMemberTtl(n,r),this._updateMemberMetadata=(n,r)=>this._channelImpl.updateMemberMetadata(n,r),this._publish=n=>this._channelImpl.publish(n),this._unpublish=n=>H(this,null,function*(){return this._channelImpl.unpublish(n)}),this._subscribe=(n,r)=>{const i=this._getPublication(r),a=this._getMember(n);if(a==null)throw Oe({operationName:"SkyWayChannelImpl._subscribe",path:en.prefix,info:we(ie({},Ve.internal),{detail:"subscriber not found"}),channel:this,context:this._context,payload:{subscriberId:n,publicationId:r}});return this._channelImpl.subscribe({publication:i.toJSON(),subscriber:a.toJSON()})},this._unsubscribe=n=>H(this,null,function*(){if(!this._getSubscription(n))throw Oe({operationName:"SkyWayChannelImpl._unsubscribe",path:en.prefix,info:we(ie({},Ve.internal),{detail:"can't unsubscribe not exist subscription"}),channel:this,context:this._context,payload:{subscriptionId:n}});yield this._channelImpl.unsubscribe(n)}),this._updatePublicationMetadata=(n,r)=>this._channelImpl.updatePublicationMetadata(n,r),this._disablePublication=n=>this._channelImpl.disablePublication(n),this._enablePublication=n=>this._channelImpl.enablePublication(n),this._setupPropertiesFromChannel(),this._setupListenChannelEvent(),e._onDisposed.once(()=>{this.dispose()}),en.debug("channel spawned",this.toJSON())}_addMember(e){const t=this._getMember(e.id);if(t)return t;const n=this._context._createRemoteMember(this,e);return this._members[n.id]=n,n}_removeMember(e){delete this._members[e]}_addPublication(e){const t=this._getPublication(e.id);if(t)return t;const n=V5(this,e);return this._publications[e.id]=n,n}_removePublication(e){delete this._publications[e]}_addSubscription(e){const t=this._getSubscription(e.id);if(t)return t;const n=u6(this,e);return this._subscriptions[e.id]=n,n}_removeSubscription(e){delete this._subscriptions[e]}get localPerson(){return this._localPerson}get members(){return Object.values(this._members)}get bots(){return this.members.filter(e=>e.type==="bot")}get publications(){return Object.values(this._publications)}get subscriptions(){return Object.values(this._subscriptions)}get metadata(){return this._channelImpl.metadata}get state(){return this._state}toJSON(){return{id:this.id,name:this.name,appId:this.appId,metadata:this.metadata,members:this.members,publications:this.publications,subscriptions:this.subscriptions}}_setupPropertiesFromChannel(){this._channelImpl.members.forEach(e=>{this._addMember(e)}),this._channelImpl.publications.forEach(e=>{this._addPublication(e)}),this._channelImpl.subscriptions.forEach(e=>{this._addSubscription(e)})}_setupListenChannelEvent(){this._channelImpl.onClosed.add(()=>this._handleOnChannelClose()),this._channelImpl.onMetadataUpdated.add(({channel:e})=>this._handleOnChannelMetadataUpdate(e.metadata)),this._channelImpl.onMemberJoined.add(({member:e})=>{this._handleOnMemberJoin(e)}),this._channelImpl.onMemberLeft.add(({member:e})=>{this._handleOnMemberLeft(e)}),this._channelImpl.onMemberListChanged.pipe(this.onMemberListChanged),this._channelImpl.onMemberMetadataUpdated.add(({member:e})=>{this._handleOnMemberMetadataUpdate(e,e.metadata)}),this._channelImpl.onStreamPublished.add(({publication:e})=>{this._handleOnStreamPublish(e)}),this._channelImpl.onStreamUnpublished.add(({publication:e})=>{this._handleOnStreamUnpublish(e)}),this._channelImpl.onPublicationListChanged.pipe(this.onPublicationListChanged),this._channelImpl.onPublicationMetadataUpdated.add(({publication:e})=>{this._handleOnPublicationMetadataUpdate(e,e.metadata)}),this._channelImpl.onPublicationEnabled.add(e=>H(this,[e],function*({publication:t}){return yield this._handleOnPublicationEnabled(t)})),this._channelImpl.onPublicationDisabled.add(e=>H(this,[e],function*({publication:t}){return yield this._handleOnPublicationDisabled(t)})),this._channelImpl.onPublicationSubscribed.add(({subscription:e})=>{this._handleOnStreamSubscribe(e)}),this._channelImpl.onPublicationUnsubscribed.add(({subscription:e})=>{this._handleOnStreamUnsubscribe(e)}),this._channelImpl.onSubscriptionListChanged.pipe(this.onSubscriptionListChanged)}_handleOnChannelClose(){this._state="closed",this.onClosed.emit({}),this.dispose()}_handleOnChannelMetadataUpdate(e){this.onMetadataUpdated.emit({metadata:e})}_handleOnMemberJoin(e){const t=this._addMember(e);this.onMemberJoined.emit({member:t})}_handleOnMemberLeft(e){var t;const n=this._getMember(e.id);this._removeMember(n.id),n._left(),((t=this.localPerson)==null?void 0:t.id)===e.id&&(this.localPerson._left(),this._localPerson=void 0),this.onMemberLeft.emit({member:n})}_handleOnMemberMetadataUpdate(e,t){var n;const r=this._getMember(e.id);r._metadataUpdated(t),((n=this.localPerson)==null?void 0:n.id)===e.id&&this.localPerson._metadataUpdated(t),this.onMemberMetadataUpdated.emit({member:r,metadata:t})}_handleOnStreamPublish(e){const t=this._addPublication(e);this.onStreamPublished.emit({publication:t})}_handleOnStreamUnpublish(e){const t=this._getPublication(e.id);this._removePublication(t.id),t._unpublished(),this.onStreamUnpublished.emit({publication:t})}_handleOnPublicationMetadataUpdate(e,t){const n=this._getPublication(e.id);n._updateMetadata(t),this.onPublicationMetadataUpdated.emit({publication:n,metadata:t})}_handleOnPublicationEnabled(e){return H(this,null,function*(){const t=this._getPublication(e.id);t._enable(),this.onPublicationEnabled.emit({publication:t})})}_handleOnPublicationDisabled(e){return H(this,null,function*(){const t=this._getPublication(e.id);yield t._disable(),this.onPublicationDisabled.emit({publication:t})})}_handleOnStreamSubscribe(e){const t=this._addSubscription(e);this._getPublication(t.publication.id)._subscribed(t),this.onPublicationSubscribed.emit({subscription:t})}_handleOnStreamUnsubscribe(e){const t=this._getSubscription(e.id);this._removeSubscription(t.id),t._canceled(),this._getPublication(t.publication.id)._unsubscribed(t),this.onPublicationUnsubscribed.emit({subscription:t})}join(){return H(this,arguments,function*(e={}){var t,n,r;const i=en.info("[start] join",yield Pt({operationName:"SkyWayChannelImpl.join",channel:this}));if(this._localPerson)throw Oe({operationName:"SkyWayChannelImpl.join",path:en.prefix,info:Ve.alreadyLocalPersonExist,channel:this,context:this._context});if(e.name!=null&&this.members.find(v=>v.name===e.name))throw Oe({operationName:"SkyWayChannelImpl.join",path:en.prefix,info:Ve.alreadySameNameMemberExist,channel:this,context:this._context,payload:e});(t=e.keepaliveIntervalSec)!=null||(e.keepaliveIntervalSec=this.config.member.keepaliveIntervalSec),(n=e.keepaliveIntervalGapSec)!=null||(e.keepaliveIntervalGapSec=this.config.member.keepaliveIntervalGapSec),(r=e.preventAutoLeaveOnBeforeUnload)!=null||(e.preventAutoLeaveOnBeforeUnload=this.config.member.preventAutoLeaveOnBeforeUnload);const a=we(ie({},e),{type:"person",subtype:"person"});e.keepaliveIntervalSec!==null&&(a.ttlSec=(yield this._context._api.getServerUnixtimeInSec())+e.keepaliveIntervalSec);const o=yield this._channelImpl.joinChannel(a).catch(h=>{throw en.error("[failed] join",h),h});en.elapsed(i,"[elapsed] join / channelImpl.joinChannel",{member:o});const u=yield this._createLocalPerson(o,e),p=new r1(u);return en.elapsed(i,"[end] join",{person:u}),p})}moveChannel(e){return H(this,null,function*(){if(this._localPerson)throw Oe({operationName:"SkyWayChannelImpl.moveChannel",path:en.prefix,info:Ve.alreadyLocalPersonExist,channel:this,context:this._context});if(!(e instanceof r1))throw Oe({operationName:"SkyWayChannelImpl.moveChannel",path:en.prefix,info:Ve.invalidArgumentValue,channel:this,context:this._context});const t=e.channel;if(this.id===t.id)throw Oe({operationName:"SkyWayChannelImpl.moveChannel",path:en.prefix,info:Ve.cantMoveSameIdChannel,channel:this,context:this._context});yield t.leave(e);const n={name:e.name,type:e.type,subtype:e.subtype,metadata:e.metadata};e.keepaliveIntervalSec!=null&&(n.ttlSec=(yield this._context._api.getServerUnixtimeInSec())+e.keepaliveIntervalSec);const r=yield this._channelImpl.joinChannel(n),i=yield this._createLocalPerson(r,{keepaliveIntervalSec:e.keepaliveIntervalSec,keepaliveIntervalGapSec:e.keepaliveIntervalGapSec,disableSignaling:e.disableSignaling,disableAnalytics:e.disableAnalytics});e.apply(i)})}_createLocalPerson(e,t){return H(this,null,function*(){const n=yield o6(this._context,this,e,t);return this._localPerson=n,n})}dispose(){this.disposed||(this.disposed=!0,en.debug("disposed",this.toJSON()),this._channelImpl.dispose(),this._onDisposed.emit(),this._events.dispose())}},rg=class{static Create(e){return H(this,arguments,function*(t,n={}){const r=en.info("[start] createChannel",{operationName:"SkyWayChannel.Create"}),i=yield t._api.createChannel(n).catch(o=>{throw en.error("[failed] createChannel",o),o}),a=new Cp(t,i);return en.elapsed(r,"[end] createChannel"),a})}static Find(e,t){return H(this,null,function*(){const n=en.info("[start] findChannel",{operationName:"SkyWayChannel.Find"}),r=yield e._api.findChannel(t).catch(a=>{throw en.error("[failed] findChannel",a),a}),i=new Cp(e,r);return en.elapsed(n,"[end] findChannel"),i})}static FindOrCreate(e,t){return H(this,null,function*(){const n=en.info("[start] findOrCreateChannel",{operationName:"SkyWayChannel.FindOrCreate"}),r=yield e._api.findOrCreateChannel(t).catch(a=>{throw en.error("[failed] findOrCreateChannel",a),a}),i=new Cp(e,r);return en.elapsed(n,"[end] findOrCreateChannel"),i})}constructor(){}};Y();Y();var d6=Br(jy()),h6=class{constructor(e={}){this.rtcApi={domain:"rtc-api.skyway.ntt.com",timeout:3e4,secure:!0,eventSubscribeTimeout:5e3},this.iceParamServer={domain:"ice-params.skyway.ntt.com",version:1,secure:!0},this.signalingService={domain:"signaling.skyway.ntt.com",secure:!0},this.analyticsService={domain:"analytics-logging.skyway.ntt.com",secure:!0},this.rtcConfig={timeout:3e4,turnPolicy:"enable",turnProtocol:"all",encodedInsertableStreams:!1,iceDisconnectBufferTimeout:5e3},this.token={updateReminderSec:30},this.log={level:"error",format:"string"},this.internal={disableDPlane:!1},this.member={keepaliveIntervalGapSec:30,keepaliveIntervalSec:30,preventAutoLeaveOnBeforeUnload:!1},Object.assign(this,(0,d6.default)(this,e))}};Y();Y();Y();Y();Y();Y();var p6="rtc-api.skyway.ntt.com",ga=2e4,f6=8;Y();var or={timeout:{name:"timeout",detail:"",solution:""},internalError:{name:"internalError",detail:"",solution:""},invalidParameter:{name:"invalidParameter",detail:"",solution:""},connectionDisconnected:{name:"connectionDisconnected",detail:"",solution:""},websocketConnectionFailure:{name:"connectionFailure",detail:"",solution:""},rpcResponseError:{name:"rpcResponseError",detail:"",solution:"",error:{}},onClosedWhileRequesting:{name:"onClosedWhileRequesting",detail:"request",solution:""},failedToConnectRtcAPI:{name:"failedToConnectRtcAPI",detail:"rtc-api server",solution:"Token"},failedToUpdateMemberTTL:{name:"failedToUpdateMemberTTL",detail:"updateMemberTTL",solution:""}};Y();var m6=Br(qm());Y();function Ir({operationName:e,info:t,error:n,path:r,payload:i,channelId:a,appId:o,memberId:u}){return new _r({error:n,info:t,payload:{payload:i,operationName:e,channelId:a,appId:o,memberId:u},path:r})}function Si({appId:e,detail:t,channelId:n,operationName:r,payload:i,memberId:a}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n,memberId:a}}var An=new Ge("packages/rtc-rpc-api-client/src/rpc.ts"),g6=4291,v6=class{constructor(){this._id=Oi(),this.closed=!1,this.negotiated=!1,this._reconnecting=!1,this._pendingRequests=[],this._events=new Qi,this._onMessage=this._events.make(),this.onNotify=this._events.make(),this.onFatalError=this._events.make(),this.onDisconnected=this._events.make(),this.onClosed=this._events.make(),this._send=e=>new Promise((t,n)=>H(this,null,function*(){if(yield new Promise(r=>setTimeout(r,0)),this._ws.readyState!==this._ws.OPEN){n(Ir({operationName:"RPC._send",info:we(ie({},or.internalError),{detail:"wrong state"}),path:An.prefix,payload:{request:e,wsReadyState:u1[this._ws.readyState]}}));return}this._ws.send(JSON.stringify(e),r=>{if(r)throw n(Ir({operationName:"RPC._send",info:we(ie({},or.internalError),{detail:"failed to send rpc message"}),path:An.prefix,error:r}))}),t()}))}set reconnecting(e){this._reconnecting=e}get reconnecting(){return this._reconnecting}connect(e){return H(this,arguments,function*({domain:t,token:n,secure:r}){const i=n;this._ws=new m6.default(`${r?"wss":"ws"}://${t}/ws`,i),this._ws.onmessage=o=>{this._onMessage.emit(JSON.parse(o.data))},this._ws.onclose=o=>H(this,null,function*(){An.debug("websocket closed",{id:this._id,code:o.code,reason:o.reason}),o.code===g6?this.close():this.onDisconnected.emit()}),this._onMessage.add(o=>{y6(o)&&this.onNotify.emit(o)});const a=yield new Promise((o,u)=>{const p=setTimeout(()=>{u(Ir({operationName:"RPC.connect",info:we(ie({},or.timeout),{detail:"ws.open"}),path:An.prefix}))},5e3);this._ws.onerror=h=>{u(Ir({operationName:"RPC.connect",info:or.websocketConnectionFailure,path:An.prefix,error:h}))},this._ws.onopen=()=>{clearTimeout(p),o()}}).catch(o=>o);if(a)throw a;this.negotiated=!0})}close(){this.closed||(this.closed=!0,An.debug("closed"),this._ws.close(),this.onClosed.emit(),this._events.dispose())}resolvePendingRequests(){An.debug("resolve pendingRequests",[...this._pendingRequests]),this._pendingRequests.forEach(e=>H(this,null,function*(){yield this._send(e)})),this._pendingRequests=[]}request(e,t){return H(this,null,function*(){if(this.closed)throw Ir({operationName:"RPC.request",info:we(ie({},or.internalError),{detail:"rpc closed"}),path:An.prefix,payload:{method:e,params:t,id:this._id}});let n=!1;try{const r=Ep(e,t),i=()=>H(this,null,function*(){return yield this._onMessage.watch(u=>u.id===r.id,ga).catch(()=>{if(!n)throw Ir({operationName:"RPC.request",info:we(ie({},or.timeout),{detail:"rpc request timeout"}),path:An.prefix,payload:{rpcTimeout:ga,method:e,params:t,wsReadyState:u1[this._ws.readyState],id:this._id}})})}),a=()=>H(this,null,function*(){An.warn("[start] reconnecting. pending request",Si({operationName:"RPC.request",detail:"[start] reconnecting. pending request",payload:{request:r,id:this._id}})),this._pendingRequests.push(r);const u=yield Promise.race([i(),this.onFatalError.asPromise(ga+100).then(p=>{throw n||An.error("[failed] reconnecting. pending request",Ir({operationName:"RPC.request",info:we(ie({},or.internalError),{detail:"onFatalError while request"}),path:An.prefix}),p),p})]);return n=!0,An.warn("[end] reconnecting. pending request",Si({operationName:"RPC.request",detail:"[end] reconnecting. pending request",payload:{request:r,id:this._id}})),u});let o;if(this._reconnecting?o=yield a():(this._send(r).catch(u=>{An.error("send error",u)}),o=yield Promise.race([i(),H(this,null,function*(){if(yield this.onDisconnected.asPromise(ga+100),n)return{};try{const u=yield a();return An.warn(Si({operationName:"request.pendingRequest",detail:"success to handle disconnected"})),u}catch(u){throw Ir({operationName:"RPC.request",info:or.connectionDisconnected,path:An.prefix,error:u})}}),this.onFatalError.asPromise(ga+100).then(u=>{if(n)return{};throw Ir({operationName:"RPC.request",info:we(ie({},or.internalError),{detail:"onFatalError while requesting"}),path:An.prefix,error:u})}),this.onClosed.asPromise(ga+100).then(()=>{if(n)return{};throw Ir({operationName:"RPC.request",info:or.onClosedWhileRequesting,path:An.prefix,payload:{method:e,params:t}})})]),n=!0),o.error)throw An.warn("[failed] request ",{message:o,method:e,params:t}),Ir({operationName:"RPC.request",info:we(ie({},or.rpcResponseError),{detail:e,error:o.error}),payload:{message:o,method:e,params:t},path:An.prefix});return o.result}catch(r){throw n=!0,r}})}notify(e,t){return H(this,null,function*(){const n=Ep(e,t,!0);yield this._send(n)})}batch(e){return H(this,null,function*(){const t=e.map(({method:r,params:i})=>Ep(r,i));return this._send(t).catch(r=>{throw r}),yield Promise.all(t.map(r=>H(this,[r],function*({id:i}){return yield this._onMessage.watch(o=>o.id===i,ga)})))})}},Ep=(e,t,n)=>{if(n)return{jsonrpc:"2.0",method:e,params:t};const r=Oi();return{jsonrpc:"2.0",method:e,params:t,id:r}},y6=e=>{const t=e;return!!(t.method&&t.id==null)},u1=["CONNECTING","OPEN","CLOSING","CLOSED"],Cn=new Ge("packages/rtc-rpc-api-client/src/client.ts"),d1,h1,_6=class{constructor(e){this.config=e,this.closed=!1,this._domain=(d1=this.config.domain)!=null?d1:p6,this._secure=(h1=this.config.secure)!=null?h1:!0,this._token=this.config.token,this._rpc=new v6,this._subscribingChannelEvents=new Set,this._subscribingChannelVersions={},this._httpClient=new Xm(`http${this.config.secure?"s":""}://${this.config.domain}`),this._reconnectCount=0,this._reconnectLimit=f6,this._events=new Qi,this.onEvent=this._events.make(),this.onFatalError=this._events.make(),this.onClose=this._events.make(),this.onReconnected=this._events.make();var t,n,r,i;Ge.level=(n=(t=e.log)==null?void 0:t.level)!=null?n:Ge.level,Ge.format=(i=(r=e.log)==null?void 0:r.format)!=null?i:Ge.format,Cn.debug("RtcRpcApiClient spawned",e),this._rpc.onNotify.add(a=>{if(a.method==="channelEventNotification"){const o=a.params;this._subscribingChannelVersions[o.data.channel.id]=o.data.channel.version,this.onEvent.emit({channelId:o.data.channel.id,event:o})}}),this._rpc.onDisconnected.add(()=>H(this,null,function*(){this._rpc.negotiated&&!this._rpc.closed&&!this._rpc.reconnecting&&(yield this._reconnect())})),this._rpc.onFatalError.once(a=>{Cn.error("fatal error",a),this.onFatalError.emit(a),this.close()})}get token(){return this._token}_reconnect(){return H(this,null,function*(){if(this._reconnectCount>=this._reconnectLimit){this._rpc.onFatalError.emit(Ir({operationName:"RtcRpcApiClient._reconnect",info:{name:"failed to reconnect",detail:"_reconnectLimit exceeded",solution:""},path:Cn.prefix})),this.close();return}this._rpc.reconnecting=!0,Cn.warn("[start] reconnect",Si({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect start",payload:{reconnectCount:this._reconnectCount,limit:this._reconnectLimit}})),this._reconnectCount++;const e=_s(this._reconnectCount,2)*100+_s(this._reconnectCount,2)*100*Math.random();yield new Promise(t=>setTimeout(t,e));try{yield this.connect().catch(t=>{throw Cn.warn("[failed] reconnect rtc api",Si({operationName:"RtcRpcApiClient._reconnect",detail:"connect rpc failed",payload:{reconnectCount:this._reconnectCount}}),t),t}),this._rpc.reconnecting=!1,this._reconnectCount=0,this._rpc.resolvePendingRequests(),yield Promise.all([...this._subscribingChannelEvents].map(t=>H(this,null,function*(){const[n,r]=t.split(":"),i=this._subscribingChannelVersions[r];yield this.subscribeChannelEvents({appId:n,channelId:r,offset:i})}))).catch(t=>{throw Cn.warn("subscribeChannelEvents failed",Si({operationName:"RtcRpcApiClient._reconnect",detail:"subscribeChannelEvents failed",payload:{reconnectCount:this._reconnectCount}}),t),t}),Cn.warn("[end] reconnect",Si({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect finished",payload:{reconnectCount:this._reconnectCount}})),this.onReconnected.emit()}catch(t){Cn.warn("[failed] reconnect",Si({operationName:"RtcRpcApiClient._reconnect",detail:"reconnect failed",payload:{reconnectCount:this._reconnectCount}}),t),yield this._reconnect()}})}updateToken(e){return H(this,null,function*(){Cn.debug("token update",{token:e}),this._token=e,yield this._updateAuthToken()})}close(){this.closed||(this.closed=!0,Cn.debug("closed"),this._rpc.close(),this.onClose.emit(),this._events.dispose())}health(){return H(this,null,function*(){return yield this._httpClient.get("/health")})}connect(){return H(this,null,function*(){Cn.debug("connect to rtc api rpc",this._domain),yield this._rpc.connect({domain:this._domain,token:this.token,secure:this._secure}).catch(e=>{throw Ir({operationName:"RtcRpcApiClient.connect",info:or.failedToConnectRtcAPI,error:e,path:Cn.prefix})})})}_channelSubscribed(e,t){this._subscribingChannelEvents.add(e+":"+t),Cn.debug("_channelSubscribed",{appId:e,channelId:t,_subscribingChannelEvents:[...this._subscribingChannelEvents]})}_isSubscribingChannel(e,t){return this._subscribingChannelEvents.has(e+":"+t)}createChannel(e){return H(this,arguments,function*({name:t,metadata:n,appId:r}){const{channel:i}=yield this._rpc.request("createChannel",{name:t,metadata:n,appId:r,authToken:this.token});return this._channelSubscribed(r,i.id),i})}findOrCreateChannel(e){return H(this,arguments,function*({name:t,metadata:n,appId:r}){const{channel:i}=yield this._rpc.request("findOrCreateChannel",{name:t,metadata:n,appId:r,authToken:this.token});return this._channelSubscribed(r,i.id),i})}getChannel(e){return H(this,arguments,function*({appId:t,id:n}){const r=yield this._rpc.request("getChannel",{id:n,appId:t,authToken:this.token});return this._isSubscribingChannel(t,n)||(this._channelSubscribed(t,n),yield this.subscribeChannelEvents({appId:t,channelId:n,offset:r.channel.version})),r.channel})}getChannelByName(e){return H(this,arguments,function*({name:t,appId:n}){const r=yield this._rpc.request("getChannelByName",{name:t,appId:n,authToken:this.token}),i=r.channel.id;return this._isSubscribingChannel(n,i)||(this._channelSubscribed(n,i),yield this.subscribeChannelEvents({appId:n,channelId:i,offset:r.channel.version})),r.channel})}deleteChannel(e){return H(this,arguments,function*({id:t,appId:n}){yield this._rpc.request("deleteChannel",{id:t,appId:n,authToken:this.token})})}updateChannelMetadata(e){return H(this,arguments,function*({id:t,metadata:n,appId:r}){yield this._rpc.request("updateChannelMetadata",{id:t,metadata:n,appId:r,authToken:this.token})})}addMember(e){return H(this,arguments,function*({channelId:t,name:n,metadata:r,subscribeChannelEvents:i,appId:a,ttlSec:o,subtype:u,type:p}){return yield this._rpc.request("addMember",{channelId:t,name:n,metadata:r,subscribeChannelEvents:i,appId:a,ttlSec:o&&parseInt(o.toString()),authToken:this.token,subtype:u,type:p})})}updateMemberTtl(e){return H(this,arguments,function*(t,n=new Ci({times:8})){const{appId:r,channelId:i,memberId:a,ttlSec:o}=t;try{yield this._rpc.request("updateMemberTtl",{appId:r,channelId:i,memberId:a,ttlSec:o&&parseInt(o.toString()),authToken:this.token})}catch(u){if(!n.exceeded)Cn.warn("retry updateMemberTtl",Si({operationName:"RtcRpcApiClient.updateMemberTtl",detail:"retry updateMemberTtl",appId:r,channelId:i,memberId:a,payload:{backoff:n.count}}),u),yield n.wait(),yield this.updateMemberTtl(t,n);else throw new _r({path:Cn.prefix,info:or.failedToUpdateMemberTTL,error:u})}})}updateMemberMetadata(e){return H(this,arguments,function*({channelId:t,memberId:n,metadata:r,appId:i}){yield this._rpc.request("updateMemberMetadata",{channelId:t,memberId:n,metadata:r,appId:i,authToken:this.token})})}leaveChannel(e){return H(this,arguments,function*({channelId:t,id:n,appId:r}){yield this._rpc.request("removeMember",{channelId:t,id:n,appId:r,authToken:this.token})})}publishStream(e){return H(this,arguments,function*({appId:t,channelId:n,publisherId:r,contentType:i,metadata:a,origin:o,codecCapabilities:u,encodings:p,isEnabled:h}){return{publicationId:(yield this._rpc.request("publishStream",{channelId:n,publisherId:r,contentType:i[0].toUpperCase()+i.slice(1),metadata:a,origin:o,codecCapabilities:u,encodings:p==null?void 0:p.map(f=>({id:f.id})),isEnabled:h,appId:t,authToken:this.token})).id}})}disablePublication(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("disablePublication",{channelId:t,appId:r,publicationId:n,authToken:this.token})})}enablePublication(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("enablePublication",{channelId:t,appId:r,publicationId:n,authToken:this.token})})}updatePublicationMetadata(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r,metadata:i}){yield this._rpc.request("updatePublicationMetadata",{channelId:t,publicationId:n,metadata:i,appId:r,authToken:this.token})})}unpublishStream(e){return H(this,arguments,function*({channelId:t,publicationId:n,appId:r}){yield this._rpc.request("unpublishStream",{channelId:t,publicationId:n,appId:r,authToken:this.token})})}subscribeStream(e){return H(this,arguments,function*({channelId:t,subscriberId:n,publicationId:r,appId:i}){return{subscriptionId:(yield this._rpc.request("subscribeStream",{channelId:t,subscriberId:n,publicationId:r,appId:i,authToken:this.token})).id}})}unsubscribeStream(e){return H(this,arguments,function*({channelId:t,subscriptionId:n,appId:r}){yield this._rpc.request("unsubscribeStream",{channelId:t,subscriptionId:n,appId:r,authToken:this.token})})}getServerUnixtime(e){return H(this,arguments,function*(t,n=new Ci({times:8})){const{appId:r}=t;try{return(yield this._rpc.request("getServerUnixtime",{appId:r,authToken:this.token})).unixtime}catch(i){if(n.exceeded)throw i;return Cn.warn(Si({operationName:"RtcRpcApiClient.getServerUnixtime",detail:"retry getServerUnixtime",appId:r,payload:{backoff:n.count}}),i),yield n.wait(),this.getServerUnixtime(t,n)}})}_updateAuthToken(){return H(this,null,function*(){yield this._rpc.request("updateAuthToken",{authToken:this.token})})}subscribeChannelEvents(e){return H(this,arguments,function*({appId:t,channelId:n,offset:r}){try{Cn.debug("[start] subscribeChannelEvents",{offset:r}),yield this._rpc.request("subscribeChannelEvents",{appId:t,authToken:this.token,channelId:n,offset:r}),Cn.debug("[end] subscribeChannelEvents",{offset:r})}catch(i){if(i instanceof _r&&i.info.name===or.connectionDisconnected.name)Cn.warn("reconnect happened while subscribeChannelEvents. retry",Si({operationName:"RtcRpcApiClient.subscribeChannelEvents",detail:"reconnect happened while subscribeChannelEvents. retry",appId:t,channelId:n,payload:{offset:r}}),i),yield this.subscribeChannelEvents({appId:t,channelId:n,offset:r});else throw Cn.error("[failed] subscribeChannelEvents",Ir({operationName:"RtcRpcApiClient.subscribeChannelEvents",info:we(ie({},or.internalError),{detail:"subscribeChannelEvents failed"}),path:Cn.prefix,error:i,payload:{offset:r},appId:t,channelId:n})),i}})}};Y();Y();var b6=Br(jy()),S6=class{constructor(e={}){this.rtcApi={domain:"rtc-api.skyway.ntt.com",timeout:3e4,secure:!0,eventSubscribeTimeout:5e3},this.log={level:"error",format:"object"},Object.assign(this,(0,b6.default)(this,e))}};Y();Y();var et=we(ie({},or),{invalidParameter:{name:"invalidParameter",detail:"",solution:""},notFound:{name:"notFound",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internalError:{name:"internalError",detail:"",solution:""},invalidRequestParameter:{name:"invalidRequestParameter",detail:"",solution:"API"},insufficientPermissions:{name:"insufficientPermissions",detail:"token Token permissions are insufficient",solution:"Token Add the necessary permissions to the Token"},publicationNestedTooMuch:{name:"publicationNestedTooMuch",detail:"originPublicationPublicationorigin It is not possible to specify the origin of a publication for which Origin has been set",solution:" There is no solution because it is a specification limitation"},channelNotFound:{name:"channelNotFound",detail:"channel The channel you tried to reference does not exist.",solution:"channelIdchannelName Make sure that the Channel id and channel name are correct."},memberNotFound:{name:"memberNotFound",detail:"Member The member you tried to reference does not exist.",solution:"memberIdmemberName Make sure that the member id and member name is correct."},publicationNotFound:{name:"publicationNotFound",detail:"Publication The Publication you tried to reference does not exist.",solution:"publicationId Make sure that the publication id is correct."},subscriptionNotFound:{name:"subscriptionNotFound",detail:"Subscription The Subscription you tried to reference does not exist.",solution:"subscriptionId Make sure that the subscription id is correct."},operationConflicted:{name:"operationConflicted",detail:" The channel with the given name has already been created by a conflicting request up to now",solution:"channel"},channelNameDuplicated:{name:"channelNameDuplicated",detail:"Channel A channel with that name already exists",solution:"channel"},memberNameDuplicated:{name:"memberNameDuplicated",detail:"Member A member with that name already exists",solution:"member"},subscriptionAlreadyExists:{name:"subscriptionAlreadyExists",detail:"PublicationSubscribe",solution:"publicationId"},rateLimitExceeded:{name:"rateLimitExceeded",detail:"",solution:""},projectUsageLimitExceeded:{name:"projectUsageLimitExceeded",detail:"",solution:""},invalidAuthToken:{name:"invalidAuthToken",detail:"AuthToken",solution:"AuthToken"},authTokenExpired:{name:"authTokenExpired",detail:"AuthToken",solution:"ExpAuthToken"},serverBusy:{name:"serverBusy",detail:"",solution:""}});Y();function p1({appId:e,detail:t,channelId:n,operationName:r,payload:i}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n}}function tt({operationName:e,info:t,error:n,path:r,channelId:i,appId:a,payload:o}){return new _r({error:n,info:t,payload:{payload:o,operationName:e,channelId:i,appId:a},path:r})}var gt=new Ge("packages/rtc-api-client/src/infrastructure/api.ts"),w6=class{constructor(e){this._client=e,this.closed=!1,this.onClose=new Qe,this.onFatalError=new Qe,this._token=yl.Decode(this._client.token),e.onClose.once(()=>{this.close()}),e.onFatalError.add(t=>{this.onFatalError.emit(t)})}connect(){return H(this,null,function*(){yield this._client.connect()})}updateAuthToken(e){return H(this,null,function*(){this._token=yl.Decode(e),yield this._client.updateToken(e).catch(t=>{var n,r,i,a,o;const{info:u}=t;if(((r=(n=u==null?void 0:u.error)==null?void 0:n.data)==null?void 0:r.code)===429001)throw tt({operationName:"RtcApiImpl.updateAuthToken",path:gt.prefix,info:et.projectUsageLimitExceeded,error:t});const p=this._commonError("RtcApiImpl.updateAuthToken",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,t);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 401:throw tt({operationName:"RtcApiImpl.updateAuthToken",path:gt.prefix,info:et.invalidAuthToken,error:t});default:throw tt({operationName:"RtcApiImpl.updateAuthToken",path:gt.prefix,info:et.internalError,error:t})}})})}close(){this.closed||(this.closed=!0,gt.debug("closed"),this._client.close(),this.onClose.emit(),this.onClose.removeAllListeners())}_commonError(e,t,n){switch(t){case-32602:return tt({operationName:e,info:et.invalidRequestParameter,path:gt.prefix,error:n});case-32603:return tt({operationName:e,info:et.internalError,path:gt.prefix,error:n});case 403:case 4030:return tt({operationName:e,info:et.insufficientPermissions,path:gt.prefix,error:n});case 429:return tt({operationName:e,info:et.rateLimitExceeded,path:gt.prefix,error:n})}}createChannel(e,t){return H(this,null,function*(){const{id:n}=yield this._client.createChannel({appId:e,name:t.name,metadata:t.metadata}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.createChannel",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw tt({operationName:"RtcApiImpl.createChannel",path:gt.prefix,info:et.channelNotFound,error:i});case 409:throw tt({operationName:"RtcApiImpl.createChannel",path:gt.prefix,info:et.channelNameDuplicated,error:i});default:throw tt({operationName:"RtcApiImpl.createChannel",path:gt.prefix,info:et.internalError,error:i})}});return yield this.getChannel(e,{id:n})})}getChannel(e,t){return H(this,arguments,function*(n,{name:r,id:i}){if(i)return yield this._client.getChannel({appId:n,id:i}).catch(a=>{var o,u,p;const{info:h}=a,v=this._commonError("RtcApiImpl.getChannel",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(v)throw v;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw tt({operationName:"RtcApiImpl.getChannel",path:gt.prefix,info:et.channelNotFound,error:a});default:throw tt({operationName:"RtcApiImpl.getChannel",path:gt.prefix,info:et.internalError,error:a})}});if(r)return yield this._client.getChannelByName({appId:n,name:r}).catch(a=>{var o,u,p;const{info:h}=a,v=this._commonError("RtcApiImpl.getChannel",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(v)throw v;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw tt({operationName:"getChannel",path:gt.prefix,info:et.channelNotFound,error:a});default:throw tt({operationName:"getChannel",path:gt.prefix,info:et.internalError,error:a})}});throw tt({operationName:"RtcApiImpl.createChannel",path:gt.prefix,info:et.invalidRequestParameter})})}findOrCreateChannel(e,t){return H(this,null,function*(){return this._client.findOrCreateChannel(we(ie({},t),{appId:e})).catch(n=>{var r,i,a,o;const{info:u}=n,p=this._commonError("RtcApiImpl.findOrCreateChannel",(i=(r=u==null?void 0:u.error)==null?void 0:r.code)!=null?i:-1,n);if(p)throw p;if(t.name&&((a=u==null?void 0:u.error)==null?void 0:a.code)===409)return this.getChannel(e,{name:t.name});switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw tt({operationName:"RtcApiImpl.findOrCreateChannel",path:gt.prefix,info:et.channelNotFound,error:n});case 409:throw tt({operationName:"RtcApiImpl.findOrCreateChannel",path:gt.prefix,info:et.channelNameDuplicated,error:n});default:throw tt({operationName:"RtcApiImpl.findOrCreateChannel",path:gt.prefix,info:et.internalError,error:n})}})})}deleteChannel(e,t){return H(this,null,function*(){yield this._client.deleteChannel({appId:e,id:t}).catch(n=>{var r,i,a;const{info:o}=n,u=this._commonError("RtcApiImpl.deleteChannel",(i=(r=o==null?void 0:o.error)==null?void 0:r.code)!=null?i:-1,n);if(u)throw u;switch((a=o==null?void 0:o.error)==null?void 0:a.code){case 404:throw tt({operationName:"RtcApiImpl.deleteChannel",path:gt.prefix,info:et.channelNotFound,error:n});default:throw tt({operationName:"RtcApiImpl.deleteChannel",path:gt.prefix,info:et.internalError,error:n})}})})}updateChannelMetadata(e,t,n){return H(this,null,function*(){yield this._client.updateChannelMetadata({appId:e,id:t,metadata:n}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.updateChannelMetadata",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw tt({operationName:"RtcApiImpl.updateChannelMetadata",path:gt.prefix,info:et.channelNotFound,error:r});default:throw tt({operationName:"RtcApiImpl.updateChannelMetadata",path:gt.prefix,info:et.internalError,error:r})}})})}join(e,t,n){return H(this,null,function*(){const{memberId:r}=yield this._client.addMember({appId:e,channelId:t,name:n.name,metadata:n.metadata,ttlSec:n.ttlSec,type:n.type,subtype:n.subtype}).catch(a=>{var o,u,p;const{info:h}=a,v=this._commonError("RtcApiImpl.addMember",(u=(o=h==null?void 0:h.error)==null?void 0:o.code)!=null?u:-1,a);if(v)throw v;switch((p=h==null?void 0:h.error)==null?void 0:p.code){case 404:throw tt({operationName:"RtcApiImpl.addMember",path:gt.prefix,info:et.channelNotFound,error:a});case 409:throw tt({operationName:"RtcApiImpl.addMember",path:gt.prefix,info:et.memberNameDuplicated,error:a});default:throw tt({operationName:"RtcApiImpl.addMember",path:gt.prefix,info:et.internalError,error:a})}});return{id:r,name:n.name,type:n.type,subtype:n.subtype,metadata:n.metadata}})}updateMemberTtl(e,t,n,r){return H(this,null,function*(){yield this._client.updateMemberTtl({appId:e,channelId:t,memberId:n,ttlSec:r}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updateMemberTtl",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw tt({operationName:"RtcApiImpl.updateMemberTtl",path:gt.prefix,info:et.memberNotFound,error:i});default:throw tt({operationName:"RtcApiImpl.updateMemberTtl",path:gt.prefix,info:et.internalError,error:i})}})})}getServerUnixtime(e){return H(this,null,function*(){return yield this._client.getServerUnixtime({appId:e}).catch(t=>{var n,r;const{info:i}=t,a=this._commonError("RtcApiImpl.getServerUnixtime",(r=(n=i==null?void 0:i.error)==null?void 0:n.code)!=null?r:-1,t);throw a||tt({operationName:"RtcApiImpl.getServerUnixtime",path:gt.prefix,info:et.internalError,error:t})})})}updateMemberMetadata(e,t,n,r){return H(this,null,function*(){yield this._client.updateMemberMetadata({appId:e,channelId:t,memberId:n,metadata:r}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updateMemberMetadata",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw tt({operationName:"RtcApiImpl.updateMemberMetadata",path:gt.prefix,info:et.memberNotFound,error:i});default:throw tt({operationName:"RtcApiImpl.updateMemberMetadata",path:gt.prefix,info:et.internalError,error:i})}})})}leave(e,t,n){return H(this,null,function*(){yield this._client.leaveChannel({channelId:t,id:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.leaveChannel",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw tt({operationName:"RtcApiImpl.leaveChannel",path:gt.prefix,info:et.memberNotFound,error:r});default:throw tt({operationName:"RtcApiImpl.leaveChannel",path:gt.prefix,info:et.internalError,error:r})}})})}publish(e,t){return H(this,null,function*(){const{publicationId:n}=yield this._client.publishStream({channelId:t.channel,publisherId:t.publisher,contentType:t.contentType,metadata:t.metadata,origin:t.origin,codecCapabilities:t.codecCapabilities,encodings:t.encodings,isEnabled:t.isEnabled,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.publish",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){default:throw tt({operationName:"RtcApiImpl.publish",path:gt.prefix,info:et.internalError,error:r})}});return n})}updatePublicationMetadata(e,t,n,r){return H(this,null,function*(){yield this._client.updatePublicationMetadata({channelId:t,publicationId:n,metadata:r,appId:e}).catch(i=>{var a,o,u;const{info:p}=i,h=this._commonError("RtcApiImpl.updatePublicationMetadata",(o=(a=p==null?void 0:p.error)==null?void 0:a.code)!=null?o:-1,i);if(h)throw h;switch((u=p==null?void 0:p.error)==null?void 0:u.code){case 404:throw tt({operationName:"RtcApiImpl.updatePublicationMetadata",path:gt.prefix,info:et.publicationNotFound,error:i});default:throw tt({operationName:"RtcApiImpl.updatePublicationMetadata",path:gt.prefix,info:et.internalError,error:i})}})})}disablePublication(e,t,n){return H(this,null,function*(){yield this._client.disablePublication({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.disablePublication",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw tt({operationName:"RtcApiImpl.disablePublication",path:gt.prefix,info:et.publicationNotFound,error:r});default:throw tt({operationName:"RtcApiImpl.disablePublication",path:gt.prefix,info:et.internalError,error:r})}})})}enablePublication(e,t,n){return H(this,null,function*(){yield this._client.enablePublication({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.enablePublication",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw tt({operationName:"RtcApiImpl.enablePublication",path:gt.prefix,info:et.publicationNotFound,error:r});default:throw tt({operationName:"RtcApiImpl.enablePublication",path:gt.prefix,info:et.internalError,error:r})}})})}unpublish(e,t,n){return H(this,null,function*(){yield this._client.unpublishStream({channelId:t,publicationId:n,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.unpublishStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw tt({operationName:"RtcApiImpl.unpublishStream",path:gt.prefix,info:et.publicationNotFound,error:r});default:throw tt({operationName:"RtcApiImpl.unpublishStream",path:gt.prefix,info:et.internalError,error:r})}})})}subscribe(e,t){return H(this,null,function*(){const{subscriptionId:n}=yield this._client.subscribeStream({channelId:t.channel.id,subscriberId:t.subscriber.id,publicationId:t.publication.id,appId:e}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.subscribeStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw tt({operationName:"RtcApiImpl.subscribeStream",path:gt.prefix,info:et.publicationNotFound,error:r});case 409:throw tt({operationName:"RtcApiImpl.subscribeStream",path:gt.prefix,info:et.subscriptionAlreadyExists,error:r});default:throw tt({operationName:"RtcApiImpl.subscribeStream",path:gt.prefix,info:et.internalError,error:r})}});return n})}unsubscribe(e,t,n){return H(this,null,function*(){yield this._client.unsubscribeStream({appId:e,channelId:t,subscriptionId:n}).catch(r=>{var i,a,o;const{info:u}=r,p=this._commonError("RtcApiImpl.unsubscribeStream",(a=(i=u==null?void 0:u.error)==null?void 0:i.code)!=null?a:-1,r);if(p)throw p;switch((o=u==null?void 0:u.error)==null?void 0:o.code){case 404:throw tt({operationName:"RtcApiImpl.unsubscribeStream",path:gt.prefix,info:et.publicationNotFound,error:r});default:throw tt({operationName:"RtcApiImpl.unsubscribeStream",path:gt.prefix,info:et.internalError,error:r})}})})}};Y();var wa=new Ge("packages/rtc-api-client/src/infrastructure/eventObserver.ts"),x6=class{constructor(e,t,n,r){this.onEvent=new Qe,this._disposer=[];const i=new C6(n.version,a=>H(null,null,function*(){yield t.subscribeChannelEvents({appId:e,channelId:n.id,offset:a}),yield new Promise(o=>setTimeout(o,r.eventSubscribeTimeout)),i.packetLostHappened&&wa.error(tt({operationName:"EventObserverImpl.eventJitterBuffer",info:we(ie({},et.internalError),{detail:"failed to resolve event lost"}),channelId:n.id,appId:e,path:wa.prefix}))}));this._disposer=[t.onEvent.add(a=>H(this,[a],function*({channelId:o,event:u}){o===n.id&&i.push({event:u,version:u.data.channel.version})})).removeListener,i.onEvent.add(a=>{this.onEvent.emit(a)}).removeListener]}dispose(){this._disposer.forEach(e=>e()),this.onEvent.removeAllListeners()}},C6=class{constructor(e,t,n=1e3){this.presentVersion=e,this.onPacketLost=t,this.packetLifetime=n,this.onEvent=new Qe,this.eventBuffer={},this.packetLostHappened=!1}get expectNextVersion(){return this.presentVersion+1}push(e){const t=e.version;if(t<this.expectNextVersion){wa.debug("duplicate event",we(ie({},e),{presentVersion:this.presentVersion}));return}if(t>this.expectNextVersion){wa.debug("maybe miss order event received",we(ie({},e),{presentVersion:this.presentVersion})),this.eventBuffer[t]=e,this.handlePacketLifetime();return}this.packetLostHappened&&(wa.warn("event packetLost resolved",p1({operationName:"EventJitterBuffer.push",detail:"event packetLost resolved",payload:{eventFrame:e}})),this.packetLostHappened=!1),this.eventBuffer[t]=e,this.resolveEvents()}handlePacketLifetime(){const[e]=Object.keys(this.eventBuffer).sort().map(t=>this.eventBuffer[Number(t)]);this.packetLifeTimer==null&&e&&(wa.debug("set event packetLost timer",we(ie({},e),{presentVersion:this.presentVersion})),this.packetLifeTimer=setTimeout(()=>H(this,null,function*(){if(this.presentVersion<e.version){if(wa.warn("event packetLost",p1({operationName:"EventJitterBuffer.handlePacketLifetime",detail:"eventPacket lost",payload:{oldestBufferedEvent:e,eventBufferLength:Object.keys(this.eventBuffer).length,presentVersion:this.presentVersion}})),this.packetLostHappened)return;this.packetLostHappened=!0,yield this.onPacketLost(this.expectNextVersion)}this.packetLifeTimer=void 0,this.handlePacketLifetime()}),this.packetLifetime))}resolveEvents(){const e=[];for(let t=this.expectNextVersion;;t++){const n=this.eventBuffer[t];if(n)e.push(n),delete this.eventBuffer[t];else break}e.length>0&&(this.presentVersion=e.slice(-1)[0].version,e.forEach(t=>{this.onEvent.emit(t.event)}))}},vi=new Ge("packages/rtc-api-client/src/client.ts"),E6=class pb{constructor(t,n,r,i){this.appId=t,this.config=n,this.apiClient=r,this._eventObserverFactory=i,this.closed=!1,this.onFatalError=new Qe,this.apiClient.onFatalError.pipe(this.onFatalError)}static Create(t){return H(this,null,function*(){const n=new S6(t);n.log&&(Ge.level=n.log.level,Ge.format=n.log.format),vi.debug("RtcApiClient spawned",n);const r=new _6(we(ie({},n.rtcApi),{token:t.token,log:n.log})),i=new w6(r);yield i.connect();const a=(o,u)=>new x6(o,r,u,n.rtcApi);return new pb(t.appId,n,i,a)})}updateAuthToken(t){return H(this,null,function*(){yield this.apiClient.updateAuthToken(t)})}getServerUnixtimeInMs(){return H(this,null,function*(){return this.apiClient.getServerUnixtime(this.appId)})}getServerUnixtimeInSec(){return H(this,null,function*(){return Math.floor((yield this.getServerUnixtimeInMs())/1e3)})}createChannel(){return H(this,arguments,function*(t={}){vi.debug("[start] apiClient.createChannel",{init:t});const n=yield this.apiClient.createChannel(this.appId,t).catch(i=>{throw vi.debug("[failed] apiClient.createChannel",{init:t,e:i}),i});return vi.debug("[end] apiClient.createChannel",{init:t,channelDto:n}),Pp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config)})}findChannel(t){return H(this,null,function*(){vi.debug("[start] apiClient.getChannel",{query:t});const n=yield this.apiClient.getChannel(this.appId,t).catch(i=>{throw vi.debug("[failed] apiClient.getChannel",{query:t,e:i}),i}),r=Pp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config);return vi.debug("[end] apiClient.getChannel",{channelId:r.id}),r})}findOrCreateChannel(t){return H(this,null,function*(){vi.debug("[start] apiClient.findOrCreateChannel",{query:t});const n=yield this.apiClient.findOrCreateChannel(this.appId,t).catch(i=>{throw vi.debug("[failed] apiClient.findOrCreateChannel",{query:t,e:i}),i});return vi.debug("[end] apiClient.findOrCreateChannel",{query:t}),Pp(this.appId,this._eventObserverFactory(this.appId,n),this.apiClient,n,this.config)})}deleteChannel(t){return this.apiClient.deleteChannel(this.appId,t)}close(){this.closed||(this.closed=!0,vi.debug("closed",{appid:this.appId}),this.apiClient.close())}};Y();Y();var P6={};Y();var Wt=new Ge("packages/rtc-api-client/src/domain/channel.ts"),k6=class{constructor(e,{id:t,name:n,members:r,metadata:i,publications:a,subscriptions:o,version:u},p,h,v){this.appId=e,this.eventObserver=p,this.apiClient=h,this.config=v,this.disposed=!1,this._events=new Qi,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.updateChannelMetadata=f=>new Promise((_,w)=>{let C=!1;this.apiClient.updateChannelMetadata(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onMetadataUpdated.watch(R=>R.channel.metadata===f).then(()=>_()).catch(R=>{C||w(tt({operationName:"ChannelImpl.updateChannelMetadata",info:we(ie({},et.timeout),{detail:"onMetadataUpdated"}),path:Wt.prefix,error:R,appId:this.appId,channelId:this.id}))})}),this.leave=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.leave(this.appId,f,_).catch(S=>{R=!0,C(S)}),this.onMemberLeft.watch(S=>S.member.id===_,this.config.rtcApi.timeout).then(()=>w()).catch(S=>{R||C(tt({operationName:"ChannelImpl.leave",info:we(ie({},et.timeout),{detail:"onMemberLeft"}),path:Wt.prefix,error:S,appId:this.appId,channelId:this.id}))})}),this.updateMemberMetadata=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.updateMemberMetadata(this.appId,this.id,f,_).catch(S=>{R=!0,C(S)}),this.onMemberMetadataUpdated.watch(S=>S.member.id===f&&S.member.metadata===_).then(()=>w()).catch(S=>{R||C(tt({operationName:"ChannelImpl.updateMemberMetadata",info:we(ie({},et.timeout),{detail:"onMemberMetadataUpdated"}),path:Wt.prefix,error:S,appId:this.appId,channelId:this.id}))})}),this.unpublish=f=>new Promise((_,w)=>{let C=!1;this.apiClient.unpublish(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onStreamUnpublished.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(tt({operationName:"ChannelImpl.unpublish",info:we(ie({},et.timeout),{detail:"onStreamUnpublished"}),path:Wt.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.updatePublicationMetadata=(f,_)=>new Promise((w,C)=>{let R=!1;this.apiClient.updatePublicationMetadata(this.appId,this.id,f,_).catch(S=>{R=!0,C(S)}),this.onPublicationMetadataUpdated.watch(S=>S.publication.id===f&&S.publication.metadata===_).then(()=>w()).catch(S=>{R||C(tt({operationName:"ChannelImpl.updatePublicationMetadata",info:we(ie({},et.timeout),{detail:"onPublicationMetadataUpdated"}),path:Wt.prefix,error:S,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.disablePublication=f=>new Promise((_,w)=>{let C=!1;this.apiClient.disablePublication(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationDisabled.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(tt({operationName:"ChannelImpl.disablePublication",info:we(ie({},et.timeout),{detail:"onPublicationDisabled"}),path:Wt.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.enablePublication=f=>new Promise((_,w)=>{let C=!1;this.apiClient.enablePublication(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationEnabled.watch(R=>R.publication.id===f).then(()=>_()).catch(R=>{C||w(tt({operationName:"ChannelImpl.enablePublication",info:we(ie({},et.timeout),{detail:"onPublicationEnabled"}),path:Wt.prefix,error:R,payload:{publicationId:f},appId:this.appId,channelId:this.id}))})}),this.unsubscribe=f=>new Promise((_,w)=>{let C=!1;this.apiClient.unsubscribe(this.appId,this.id,f).catch(R=>{C=!0,w(R)}),this.onPublicationUnsubscribed.watch(R=>R.subscription.id===f).then(()=>_()).catch(R=>{C||w(tt({operationName:"ChannelImpl.unsubscribe",info:we(ie({},et.timeout),{detail:"onPublicationUnsubscribed"}),path:Wt.prefix,error:R,payload:{subscriptionId:f},appId:this.appId,channelId:this.id}))})}),this.id=t,this.name=n,this.metadata=i,this.members=r,this.publications=a,this.subscriptions=o,this.version=u,p.onEvent.add(f=>{Wt.debug("received event: ",f),this.version=f.data.channel.version;try{switch(f.type){case"ChannelDeleted":this._channelClosed();break;case"ChannelMetadataUpdated":this._channelMetadataUpdated(f.data);break;case"MemberAdded":this._memberJoined(f.data);break;case"MemberRemoved":this._memberLeft(f.data);break;case"MemberMetadataUpdated":this._memberMetadataUpdated(f.data);break;case"StreamPublished":this._streamPublished(f.data);break;case"StreamUnpublished":this._streamUnpublished(f.data);break;case"PublicationMetadataUpdated":this._publicationMetadataUpdated(f.data);break;case"PublicationDisabled":this._publicationDisabled(f.data);break;case"PublicationEnabled":this._publicationEnabled(f.data);break;case"StreamSubscribed":this._streamSubscribed(f.data);break;case"StreamUnsubscribed":this._streamUnsubscribed(f.data);break}}catch(_){Wt.error(_)}}),h.onClose.once(()=>{this.dispose()})}getMember(e){return this.members.find(t=>t.id===e)}addMember(e){const t=this.getMember(e.id);return t||(this.members.push(e),e)}deleteMember(e){this.members=this.members.filter(t=>t.id!==e)}getPublication(e){return this.publications.find(t=>t.id===e)}addPublication(e){var t,n;const r=this.getPublication(e.id);if(r)return r;const i=we(ie({},e),{channelId:this.id,codecCapabilities:(t=e.codecCapabilities)!=null?t:[],encodings:(n=e.encodings)!=null?n:[]});return this.publications.push(i),i}deletePublication(e){this.publications=this.publications.filter(t=>t.id!==e)}getSubscription(e){return this.subscriptions.find(t=>t.id===e)}addSubscription(e){const t=this.getSubscription(e.id);if(t)return t;const n=this.getPublication(e.publicationId),r=we(ie({},e),{channelId:this.id,publisherId:n.publisherId,contentType:n.contentType});return this.subscriptions.push(r),r}deleteSubscription(e){this.subscriptions=this.subscriptions.filter(t=>t.id!==e)}_channelClosed(){this.onClosed.emit({})}_channelMetadataUpdated(e){this.metadata=e.channel.metadata,this.onMetadataUpdated.emit(e)}_memberJoined(e){this.addMember(e.member),this.onMemberJoined.emit(e),this.onMemberListChanged.emit({})}_memberLeft(e){const t=this.getMember(e.member.id);if(!t)throw tt({operationName:"ChannelImpl._memberLeft",info:et.memberNotFound,path:Wt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deleteMember(t.id),this.onMemberLeft.emit({member:t}),this.onMemberListChanged.emit({})}_memberMetadataUpdated(e){const t=this.getMember(e.member.id);if(!t)throw tt({operationName:"ChannelImpl._memberMetadataUpdated",info:et.memberNotFound,path:Wt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.metadata=e.member.metadata,this.onMemberMetadataUpdated.emit(e)}_streamPublished(e){const t=this.addPublication(e.publication),n=we(ie({},e),{publication:t});this.onStreamPublished.emit(n),this.onPublicationListChanged.emit({})}_streamUnpublished(e){const t=this.getPublication(e.publication.id);if(!t)throw tt({operationName:"ChannelImpl._streamUnpublished",info:et.publicationNotFound,path:Wt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deletePublication(t.id);const n=we(ie({},e),{publication:t});this.onStreamUnpublished.emit(n),this.onPublicationListChanged.emit({})}_publicationMetadataUpdated(e){const t=this.getPublication(e.publication.id);if(!t)throw tt({operationName:"ChannelImpl._publicationMetadataUpdated",info:et.publicationNotFound,path:Wt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.metadata=e.publication.metadata;const n=we(ie({},e),{publication:t});this.onPublicationMetadataUpdated.emit(n)}_publicationDisabled(e){const t=this.getPublication(e.publication.id);if(!t)throw tt({operationName:"ChannelImpl._publicationDisabled",info:et.publicationNotFound,path:Wt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});t.isEnabled=e.publication.isEnabled;const n={publication:t};this.onPublicationDisabled.emit(n)}_publicationEnabled(e){const t=this.getPublication(e.publication.id);if(!t)throw tt({operationName:"ChannelImpl._publicationEnabled",info:et.publicationNotFound,path:Wt.prefix,payload:{event:P6},appId:this.appId,channelId:this.id});t.isEnabled=e.publication.isEnabled;const n={publication:t};this.onPublicationEnabled.emit(n)}_streamSubscribed(e){const t=this.addSubscription(e.subscription),n=we(ie({},e),{subscription:t});this.onPublicationSubscribed.emit(n),this.onSubscriptionListChanged.emit({})}_streamUnsubscribed(e){const t=this.getSubscription(e.subscription.id);if(!t)throw tt({operationName:"ChannelImpl._streamUnsubscribed",info:et.subscriptionNotFound,path:Wt.prefix,payload:{event:e},appId:this.appId,channelId:this.id});this.deleteSubscription(t.id);const n=we(ie({},e),{subscription:t});this.onPublicationUnsubscribed.emit(n),this.onSubscriptionListChanged.emit({})}joinChannel(e){return H(this,null,function*(){var t;e.type&&(e.type=e.type[0].toUpperCase()+e.type.slice(1)),e.subtype&&(e.subtype=e.subtype[0].toUpperCase()+e.subtype.slice(1)),Wt.debug("[start] joinChannel",{memberInit:e});const n=yield this.apiClient.join(this.appId,this.id,ie({},e)),r=(t=this.getMember(n.id))!=null?t:(yield this.onMemberJoined.watch(i=>i.member.id===n.id,this.config.rtcApi.timeout).catch(i=>{throw tt({operationName:"ChannelImpl.joinChannel",info:we(ie({},et.timeout),{detail:"onMemberJoined"}),path:Wt.prefix,error:i,appId:this.appId,channelId:this.id})})).member;return Wt.debug("[end] joinChannel",{member:r}),r})}updateMemberTtl(e,t){return this.apiClient.updateMemberTtl(this.appId,this.id,e,t)}publish(e){return H(this,null,function*(){var t,n,r;const i=Wt.debug("[start] apiClient.publish",{init:e}),a=this.id,o=yield this.apiClient.publish(this.appId,we(ie({},e),{channel:a})),u={id:o,channelId:a,publisherId:e.publisher,origin:e.origin,contentType:e.contentType,metadata:e.metadata,codecCapabilities:(t=e.codecCapabilities)!=null?t:[],encodings:(n=e.encodings)!=null?n:[],isEnabled:(r=e.isEnabled)!=null?r:!0};Wt.elapsed(i,"[ongoing] apiClient.publish",{publicationDto:u});const p=this.getPublication(o);if(p)return p;const{publication:h}=yield this.onStreamPublished.watch(v=>v.publication.id===o,this.config.rtcApi.timeout).catch(v=>{throw tt({operationName:"ChannelImpl.publish",info:we(ie({},et.timeout),{detail:"onStreamPublished"}),path:Wt.prefix,error:v,payload:{publicationDto:u},appId:this.appId,channelId:this.id})});return Wt.elapsed(i,"[end] apiClient.publish",{publicationDto:u}),h})}subscribe(e){return H(this,null,function*(){const t=Wt.debug("[start] apiClient.subscribe",{init:e}),n=yield this.apiClient.subscribe(this.appId,we(ie({},e),{channel:this})),r={id:n,publicationId:e.publication.id,channelId:this.id,publisherId:e.publication.publisherId,subscriberId:e.subscriber.id,contentType:e.publication.contentType};Wt.elapsed(t,"[ongoing] apiClient.subscribe",{subscriptionDto:r});const i=this.getSubscription(n);if(i)return Wt.elapsed(t,"[end] apiClient.subscribe",{subscriptionDto:r}),i;const{subscription:a}=yield this.onPublicationSubscribed.watch(o=>o.subscription.id===n,this.config.rtcApi.timeout).catch(o=>{throw Wt.elapsed(t,"[fail] apiClient.subscribe",o),tt({operationName:"ChannelImpl.subscribe",info:we(ie({},et.timeout),{detail:"onPublicationSubscribed"}),path:Wt.prefix,error:o,payload:{subscriptionDto:r}})});return Wt.elapsed(t,"[end] apiClient.subscribe",{subscriptionDto:r}),a})}close(){return this.apiClient.deleteChannel(this.appId,this.id)}dispose(){this.disposed||(this.disposed=!0,Wt.debug("disposed",{id:this.id}),this.eventObserver.dispose(),this._events.dispose())}};function Pp(e,t,n,r,i){return new k6(e,r,t,n,i)}Y();Y();Y();Y();var Fs=class{constructor(e,t){this.id=Oi(),this.type=e,this.payload=t}toJSON(){return{id:this.id,type:this.type,payload:this.payload}}};Y();function T6(e){return!(typeof e!="object"||e===null||Array.isArray(e))}function R6(e){if(!e||typeof e!="object"||!e.statsRequest||typeof e.statsRequest!="object"||!e.statsRequest.intervalSec||typeof e.statsRequest.intervalSec!="number"||!e.statsRequest.types||!Array.isArray(e.statsRequest.types))return!1;for(const t of e.statsRequest.types){if(!t.type||typeof t.type!="string"||!t.properties||!T6(t.properties))return!1;for(const n of Object.keys(t.properties))if(!("normalization"in t.properties[n])||typeof t.properties[n].normalization!="boolean"||!t.properties[n].outputKey||typeof t.properties[n].outputKey!="string")return!1}return!0}var A6=["invalidPayload","unexpected"];function f1(e){return!(!e||typeof e!="object"||typeof e.eventId!="string"||typeof e.ok!="boolean"||typeof e.reason<"u"&&(typeof e.reason!="string"||!A6.includes(e.reason)))}Y();var kp=Br(qm());Y();var Vs=class{constructor(){this._listeners=new Map,this._listenerIndex=0,this.emit=e=>{this._listeners.forEach(t=>t(e))},this.removeAllListeners=()=>{this._listeners.clear()},this.addListener=e=>{const t=this._listenerIndex;return this._listeners.set(t,e),this._listenerIndex++,{removeListener:()=>{this._listeners.delete(t)}}},this.addOneTimeListener=e=>{const t=this.addListener(n=>{t.removeListener(),e(n)});return t},this.asPromise=e=>new Promise((t,n)=>{let r=()=>{};const i=e&&setTimeout(()=>{n("Event asPromise timeout"),r()},e);r=this.addOneTimeListener(o=>{i&&clearTimeout(i),t(o)}).removeListener})}},I6=["Open","Acknowledge"],F6=e=>(_s(2,e)+Math.random())*1e3,D6=class{constructor({sessionEndpoint:e,token:t,logger:n,sdkVersion:r,contextId:i}){this._isOpen=!1,this._isClosed=!1,this._reconnectCount=0,this.connectionState="connecting",this.onConnectionStateChanged=new Vs,this.onOpened=new Vs,this.onTokenExpired=new Vs,this.onEventReceived=new Vs,this.onConnectionFailed=new Vs,this._resendClientEvents=[],this._sessionEndpoint=e,this._token=t,this._logger=n,this._sdkVersion=r,this._contextId=i,this._connect()}_setConnectionState(e){this.connectionState!==e&&(this._logger.debug(`connectionState changed : ${e}`),this.connectionState=e,this.onConnectionStateChanged.emit(e))}_connect(){let e;try{const t=`SkyWayAuthToken!${this._token}`,n={sdkPlatform:"js",sdkVersion:this._sdkVersion,contextId:this._contextId},r=Object.entries(n).filter(([a,o])=>o!==void 0).map(a=>a.join("=")).join("&"),i=`${this._sessionEndpoint}?${r}`;e=new kp.default(i,t),this._logger.debug(`Connecting to analytics-logging-server: ${this._sessionEndpoint}`),e.onerror=a=>{this._logger.error("WebSocket error occurred",a.error),e.close(4202)}}catch(t){const n=t instanceof Error?t:new Error;this._logger.error("Failed to create WebSocket instance",n),this.reconnect();return}e.onopen=()=>{this._logger.debug("Connected to analytics-logging-server")},e.onclose=t=>{const n="Close event fired: "+JSON.stringify({code:t.code,reason:t.reason,type:t.type});if(4100<=t.code&&t.code<=4199||t.code===1009?this._logger.error(n,new Error):this._logger.debug(n),t.code!==1e3&&t.code!==1009&&!(4e3<=t.code&&t.code<=4199)){t.code===4200?this.onTokenExpired.emit():this.reconnect();return}this._logger.debug("Closed the connection to analytics-logging-server"),this.onConnectionFailed.emit({code:t.code,reason:t.reason}),this.close()},e.onmessage=t=>{this._messageHandler(t.data)},this._ws=e}updateAuthToken(e){this._token=e}reconnect(){if(this._ws!==void 0&&this._ws.close(4e3),this._ws=void 0,this._isOpen=!1,this._reconnectCount>=5)this.onConnectionFailed.emit({}),this.close(),this._logger.error("Failed to reconnect for five times",new Error);else{this._setConnectionState("reconnecting");const e=F6(this._reconnectCount);this._reconnectTimer=setTimeout(()=>{this._connect(),this._reconnectCount++,this._logger.debug(`Try to reconnect: count = ${this._reconnectCount}`)},e)}}close(){this._isClosed=!0,this.destroy()}destroy(){this._setConnectionState("closed"),this.onConnectionStateChanged.removeAllListeners(),this.onOpened.removeAllListeners(),this.onEventReceived.removeAllListeners(),this.onConnectionFailed.removeAllListeners(),this._reconnectTimer&&clearTimeout(this._reconnectTimer),this._ws!==void 0&&this._ws.close(1e3)}send(e){return H(this,null,function*(){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==kp.default.OPEN){this._logger.debug("Try to reconnect because connection is lost"),this.resendAfterReconnect(e);return}const t=JSON.stringify(e.toJSON());this._ws.send(t,n=>{if(n){this._logger.debug(`Try to reconnect because failed to send: ${n.message}`),this.resendAfterReconnect(e);return}})})}resendAfterReconnect(e){this._resendClientEvents.some(n=>n.id===e.id)||this._resendClientEvents.push(e),this.connectionState!=="reconnecting"&&this.reconnect()}pushResendClientEventsQueue(e){this._resendClientEvents.push(e)}isClosed(){return this._isClosed}_messageHandler(e){if(typeof e!="string"){this._logger.error("Received invalid message: not string",new Error);return}let t;try{t=JSON.parse(e)}catch(n){const r=n instanceof Error?n:new Error;this._logger.error("Received invalid message: parse error",r);return}if(!N6(t)){this._logger.error(`Received invalid message: ${JSON.stringify(t)}`,new Error);return}if(t.type==="Open"){if(!R6(t.payload)){this._logger.error(`Received invalid message: ${JSON.stringify(t.payload)}`,new Error);return}if(this._logger.debug("Received a open event"),this._isOpen=!0,this._setConnectionState("connected"),this._reconnectCount!==0&&(this._reconnectCount=0,this._logger.debug("Succeeded to reconnect")),this._resendClientEvents.length>0){for(const n of this._resendClientEvents){if(this._ws===void 0||!this._isOpen||this._ws.readyState!==kp.default.OPEN){this._logger.error(`Failed to resend event because connection lost after reconnect: ${n}`,new Error);continue}const r=JSON.stringify(n.toJSON());this._ws.send(r,i=>{if(i){this._logger.error(`Failed to resend event: ${n}`,i);return}this._logger.debug(`Succeed to resend ClientEvent: ${n}`)})}this._logger.debug("Process of resending ClientEvents is completed"),this._resendClientEvents=[]}this.onOpened.emit(t.payload)}else this._logger.debug(`Received the event: ${t.type}, payload: ${JSON.stringify(t.payload)}`),this.onEventReceived.emit(t)}};function N6(e){return!(!e||typeof e!="object"||typeof e.type!="string"||!I6.includes(e.type)||typeof e.id!="string"||e.payload&&typeof e.payload!="object")}Y();var O6=class{constructor(e={}){this.count=0,this.times=8,this.interval=100,this.jitter=0,Object.assign(this,e)}wait(){return H(this,null,function*(){if(this.exceeded)return!1;const e=this.timeout;return this.count++,yield new Promise(t=>setTimeout(t,e)),!0})}get timeout(){return _s(this.count,2)*this.interval+_s(this.count,2)*this.jitter*Math.random()}get exceeded(){return this.count>=this.times}reset(){this.count=0}stop(){this.count=this.times}},m1="analytics-logging.skyway.ntt.com",M6="v2",L6=5,fb=class mb{constructor({token:t,sdkVersion:n,contextId:r},i){this.onConnectionStateChanged=new Vs,this.onConnectionFailed=new Vs,this.onAnalyticsNotEnabledError=new Vs,this._isClosed=!1,this._responseCallbacks=new Map,this._acknowledgeCallbacks=new Map,this._mediaDeviceVersion=new Map,this._encodingsVersion=new Map,this._preferredEncodingVersion=new Map,this._previousSubscriptionStats=new Map,this._statsRequest={intervalSec:5,types:[]},this._pendingSdkLogs=[],this._token=t,this._newToken=void 0,this._sdkVersion=n,this._contextId=r;const a={analyticsLoggingServerDomain:m1,secure:!0,logger:{debug:(o,...u)=>{console.debug(o,...u)},warn:(o,...u)=>{console.warn(o,...u)},error:o=>{console.error(o)}}};this._options=Object.assign({},a,i??{}),this._logger=this._options.logger,this._logger.debug(`Created instance with the options: ${this._options}`),this._sdkLogTimer=setInterval(()=>{if(this._pendingSdkLogs.length>0){const o=this._pendingSdkLogs.splice(0,this._pendingSdkLogs.length);this.sendSdkLogReport(o).catch(u=>{this._logger.warn("sendSdkLogReport (interval) failed",u)})}},5*1e3)}get connectionState(){var t,n;return(n=(t=this._socket)==null?void 0:t.connectionState)!=null?n:"closed"}connect(){return H(this,null,function*(){const t=this._options.secure?"wss":"ws",n=this._options.analyticsLoggingServerDomain||m1;this._socket=new D6({sessionEndpoint:`${t}://${n}/${M6}/client/ws`,contextId:this._contextId,token:this._token,logger:this._logger,sdkVersion:this._sdkVersion}),this._socket.onEventReceived.addListener(i=>{try{this._eventReceivedHandler(i)}catch(a){this._logger.error("in _eventReceivedHandler",a)}}),this._socket.onConnectionFailed.addListener(i=>{i.code===4e3&&this.onAnalyticsNotEnabledError.emit(i),this.onConnectionFailed.emit(),this.dispose()}),this._socket.onConnectionStateChanged.addListener(i=>{var a;i==="closed"&&!this.isClosed()&&((a=this._socket)!=null&&a.isClosed())&&(this._isClosed=!0,this.dispose()),this.onConnectionStateChanged.emit(i)}),this._socket.onTokenExpired.addListener(()=>{this._reconnectWithNewSkyWayAuthToken()});const r=yield this._socket.onOpened.asPromise();if(r!==void 0){this._statsRequest=r.statsRequest;return}else{this._logger.error("First time connection payload is undefined",new Error),this.onConnectionFailed.emit();return}})}bufferOrSendSdkLog(t){const n=t.level==="warn"||t.level==="error";if(this._pendingSdkLogs.push(t),n||this._pendingSdkLogs.length>=mb.MAX_PENDING_SDK_LOGS){const r=[...this._pendingSdkLogs];this._pendingSdkLogs.length=0,this.sendSdkLogReport(r).catch(i=>{this._logger.warn("sendSdkLogReport failed",i)})}}dispose(){clearInterval(this._sdkLogTimer),this._disconnect(),this._cleanupAnalyticsClientMaps()}setNewSkyWayAuthToken(t){this._socket!==void 0&&(this._newToken=t,this._logger.debug("setNewSkyWayAuthToken is success"))}cleanupOnUnpublished(t){this._mediaDeviceVersion.delete(t),this._encodingsVersion.delete(t)}cleanupOnUnsubscribed(t){this._preferredEncodingVersion.delete(t),this._previousSubscriptionStats.delete(t)}_disconnect(){var t;(t=this._socket)==null||t.destroy(),this._socket=void 0,this._responseCallbacks.clear(),this._acknowledgeCallbacks.clear()}sendMediaDeviceReport(t){return H(this,null,function*(){let n=this._mediaDeviceVersion.get(t.publicationId);n===void 0?n=0:n++,this._mediaDeviceVersion.set(t.publicationId,n);const r={publicationId:t.publicationId,mediaDeviceName:t.mediaDeviceName,mediaDeviceVersion:n,mediaDeviceTrigger:t.mediaDeviceTrigger,updatedAt:t.updatedAt},i=new Fs("MediaDeviceReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendMediaDeviceReport is failed",a)})})}sendSdkLogReport(t){return H(this,null,function*(){if(t.length===0)return;const n=t.map(i=>({timestamp:i.timestamp,level:i.level,message:Array.isArray(i.message)?i.message.map(a=>typeof a=="string"?a:JSON.stringify(a)).join(","):String(i.message)})),r=new Fs("SdkLog",{sdkLogs:n,contextId:this._contextId});yield this._sendClientEvent(r).catch(i=>{this._logger.warn("_sendClientEvent in sendSdkLogReport is failed",i)})})}sendBindingRtcPeerConnectionToSubscription(t){return H(this,null,function*(){const n=new Fs("BindingRtcPeerConnectionToSubscription",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendBindingRtcPeerConnectionToSubscription is failed",r)})})}filterStatsReport(t){const n=Array.from(t.values()).find(o=>o.type==="transport"&&o.dtlsState==="connected"),r=[];if(n){const o=Array.from(t.values()).find(u=>u.type==="candidate-pair"&&u.nominated&&u.id===(n==null?void 0:n.selectedCandidatePairId));o&&r.push(o.id,o.localCandidateId,o.remoteCandidateId,o.transportId)}else{const o=Array.from(t.values()).find(u=>u.type==="candidate-pair"&&u.nominated&&u.selected);o&&r.push(o.id,o.localCandidateId,o.remoteCandidateId,o.transportId)}const i=new Map,a=["candidate-pair","local-candidate","remote-candidate","transport"];for(const[o,u]of t.entries())a.includes(u.type)?r.includes(u.id)&&i.set(o,u):i.set(o,u);return i}bundleStatsReportByStatsType(t){const n={};for(const r of t.values())n[r.type]=r;return n}sendSubscriptionStatsReport(t,n){return H(this,null,function*(){var r;const i=this._previousSubscriptionStats.get(n.subscriptionId);if(this._previousSubscriptionStats.set(n.subscriptionId,{stats:t,createdAt:n.createdAt}),i===void 0)return;const a=this.filterStatsReport(i.stats),o=this.bundleStatsReportByStatsType(a),u=i.createdAt,p=(n.createdAt-u)/1e3;if(p<=0)throw new Error("duration must be greater than 0. also sendSubscriptionStatsReport was duplicated.");const h=this.filterStatsReport(t),v=this.bundleStatsReportByStatsType(h),f={};for(const{type:C,properties:R}of this._statsRequest.types)for(const[S,{normalization:b,outputKey:x,contentType:E}]of Object.entries(R)){if(!E.includes(n.contentType))continue;const M=v[C];if(!(M===void 0||M[S]===void 0))if(b){const Z=(r=o[C])==null?void 0:r[S];if(Z===void 0){this._logger.warn(`${C} in previous statsReport is undefined`);continue}const $=(Number(M[S])-Number(Z))/p;f[C]=we(ie({},f[C]),{[x]:String($)})}else f[C]=we(ie({},f[C]),{[x]:String(M[S])})}const _={subscriptionId:n.subscriptionId,stats:f,role:n.role,createdAt:n.createdAt},w=new Fs("SubscriptionStatsReport",_);yield this._sendClientEvent(w).catch(C=>{this._logger.warn("_sendClientEvent in sendSubscriptionStatsReport is failed",C)})})}sendRtcPeerConnectionEventReport(t){return H(this,null,function*(){const n=new Fs("RtcPeerConnectionEventReport",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendRtcPeerConnectionEventReport is failed",r)})})}sendPublicationUpdateEncodingsReport(t){return H(this,null,function*(){let n=this._encodingsVersion.get(t.publicationId);n===void 0?n=0:n++,this._encodingsVersion.set(t.publicationId,n);const r={publicationId:t.publicationId,encodings:t.encodings,encodingsVersion:n,updatedAt:t.updatedAt},i=new Fs("PublicationUpdateEncodingsReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendPublicationUpdateEncodingsReport is failed",a)})})}sendSubscriptionUpdatePreferredEncodingReport(t){return H(this,null,function*(){let n=this._preferredEncodingVersion.get(t.subscriptionId);n===void 0?n=0:n++,this._preferredEncodingVersion.set(t.subscriptionId,n);const r={subscriptionId:t.subscriptionId,preferredEncodingIndex:t.preferredEncodingIndex,preferredEncodingVersion:n,updatedAt:t.updatedAt},i=new Fs("SubscriptionUpdatePreferredEncodingReport",r);yield this._sendClientEvent(i).catch(a=>{this._logger.warn("_sendClientEvent in sendSubscriptionUpdatePreferredEncodingReport is failed",a)})})}sendJoinReport(t){return H(this,null,function*(){const n=new Fs("JoinReport",t);yield this._sendClientEvent(n).catch(r=>{this._logger.warn("_sendClientEvent in sendJoinReport is failed",r)})})}_sendClientEvent(t){return H(this,null,function*(){return new Promise((n,r)=>H(this,null,function*(){if(this._socket===void 0||this._socket.connectionState==="closed"){r(new Error("websocket is not connected"));return}if(this._socket.connectionState==="connecting"){this._socket.pushResendClientEventsQueue(t),this._setAcknowledgeCallback(t.id,a=>H(this,null,function*(){a.ok?(this._acknowledgeCallbacks.delete(t.id),n()):(this._acknowledgeCallbacks.delete(t.id),r(a))})),this._logger.debug(`pushResendClientEventsQueue and setAcknowledgeCallback. clientEvent.id: ${t.id}`),r(new Error("websocket is connecting now"));return}const i=new O6({times:6,interval:500,jitter:100});for(;!i.exceeded;){const a=setTimeout(()=>H(this,null,function*(){if(this._socket===void 0){this._acknowledgeCallbacks.delete(t.id),r(new Error("Socket closed when trying to resend"));return}else this._socket.resendAfterReconnect(t);r(new Error("Timeout to send data"))}),L6*1e3);this._logger.debug(`send clientEvent, ${JSON.stringify(t)}`),this._socket.send(t).catch(u=>{this._acknowledgeCallbacks.delete(t.id),clearTimeout(a),r(u)});const o=yield this._waitForAcknowledge(t.id).catch(u=>u);if(clearTimeout(a),f1(o))if(o.reason==="unexpected")yield i.wait();else{r(o);return}else{n();return}}r(new Error("unexpected has occurred at server"))}))})}_waitForAcknowledge(t){return H(this,null,function*(){return new Promise((n,r)=>{this._setAcknowledgeCallback(t,i=>H(this,null,function*(){i.ok?(this._acknowledgeCallbacks.delete(t),n()):(this._acknowledgeCallbacks.delete(t),r(i))}))})})}_reconnectWithNewSkyWayAuthToken(){return H(this,null,function*(){this._disconnect(),this._newToken!==void 0?(this._token=this._newToken,this._newToken=void 0,yield this.connect()):this._logger.warn("new token is not set. so not reconnect.")})}_eventReceivedHandler(t){switch(t.type){case"Acknowledge":this._acknowledgeHandler(t.payload);break;case"Open":break;default:t.type,this._logger.warn(`Unknown event: ${t.type}`)}}_acknowledgeHandler(t){if(!f1(t))throw new Error("Invalid payload");const{eventId:n}=t;if(!this._acknowledgeCallbacks.has(n))throw new Error(`acknowledge event has unknown eventId: ${n}`);const r=this._acknowledgeCallbacks.get(n);r&&(this._acknowledgeCallbacks.delete(n),r(t))}_setAcknowledgeCallback(t,n){this._acknowledgeCallbacks.set(t,n)}_cleanupAnalyticsClientMaps(){this._mediaDeviceVersion.clear(),this._encodingsVersion.clear(),this._preferredEncodingVersion.clear(),this._previousSubscriptionStats.clear()}getIntervalSec(){return this._statsRequest.intervalSec}isConnectionEstablished(){return!(!this._socket||this._socket.connectionState==="connecting"||this._socket.connectionState==="closed")}isClosed(){return this._isClosed}};fb.MAX_PENDING_SDK_LOGS=50;var j6=fb;Y();var gb="packages/core/src/external/analytics.ts",qr=new Ge(gb);function B6(e){return H(this,null,function*(){const{analyticsService:t}=e.config,n=new j6({token:e.authTokenString,sdkVersion:$f.version,contextId:$f.id},{logger:{error:(i,a)=>H(null,null,function*(){qr.error(`AnalyticsClient error: ${i}`,Oe({operationName:"AnalyticsClient.logger",context:e,info:we(ie({},Ve.internal),{detail:"AnalyticsClient error"}),error:a,path:qr.prefix}))}),debug:(i,...a)=>{qr.debug("[analytics]:",i,...a)},warn:(i,...a)=>{qr.warn("[analytics]:",i,...a)}},analyticsLoggingServerDomain:t.domain,secure:t.secure}),r=new U6(n,e);return Ge._onLogForAnalytics=i=>{i.prefix!==gb&&n.bufferOrSendSdkLog(i)},r.connectWithTimeout().catch(i=>{r.close(),qr.error(`AnalyticsClient error: ${i.message}`,Oe({operationName:"AnalyticsClient.logger",context:e,info:we(ie({},Ve.internal),{detail:"AnalyticsClient error"}),error:i,path:qr.prefix})),r.onConnectionFailed.emit({})}),r})}var U6=class{constructor(e,t){this.client=e,this.context=t,this.onConnectionFailed=new Qe,this.onConnectionStateChanged=new Qe,this.onMessage=new Qe,this._isClosed=!1,this._listen(),t._onTokenUpdated.add(n=>{this.client.setNewSkyWayAuthToken(n)})}_listen(){this.client.onConnectionFailed.addOneTimeListener(()=>{this.onConnectionFailed.emit({})}),this.client.onConnectionStateChanged.addListener(e=>{e==="closed"&&!this.isClosed()&&this.client.isClosed()&&this.close(),this.onConnectionStateChanged.emit(e)})}get connectionState(){return this.client.connectionState}_connect(){return H(this,null,function*(){qr.debug("[start] connect analyticsService"),yield this.client.connect().then(()=>{qr.debug("[end] connect analyticsService")}).catch(e=>{this.close(),qr.debug("[end] failed connect analyticsService: also unreachable to server"),qr.error(`AnalyticsClient error: ${e.message}`,Oe({operationName:"AnalyticsClient.logger",info:we(ie({},Ve.internal),{detail:"AnalyticsClient error"}),error:e,path:qr.prefix})),this.onConnectionFailed.emit({})})})}connectWithTimeout(){return H(this,null,function*(){let e;const t=new Promise((r,i)=>{e=setTimeout(()=>{qr.debug("[end] failed connect analyticsService: no initial response from the server"),i(new Error("failed connect analyticsService"))},3e4)}),n=new Promise((r,i)=>{this.client.onAnalyticsNotEnabledError.addOneTimeListener(a=>{qr.warn(`[end] failed connect analyticsService: ${a.reason}`),r()})});return Promise.race([this._connect(),t,n]).finally(()=>{clearTimeout(e)})})}close(){this._isClosed=!0,this.onConnectionFailed.removeAllListeners(),this.onConnectionStateChanged.removeAllListeners(),this.onMessage.removeAllListeners()}isClosed(){return this._isClosed}};Y();Y();var ig=class{constructor(){this._onContextAttached=new Qe}_attachContext(e){this._context=e,this._onContextAttached.emit(e)}};Y();var H6=new Ge("packages/core/src/plugin/internal/person/connection/messageBuffer.ts"),V6=class{constructor(e){this.signaling=e,this._indicateMessageBuffer={},this._excludeConnectionIndicateBuffering=new Set,this._disposer=new Zr,this.signaling.onMessage.add(t=>{const n=t.src.id+t.src.name;this._excludeConnectionIndicateBuffering.has(n)||(this._indicateMessageBuffer[n]||(this._indicateMessageBuffer[n]=[]),this._indicateMessageBuffer[n].push(t))}).disposer(this._disposer)}resolveMessagingBuffer({id:e,name:t}){const n=e+t,r=this._indicateMessageBuffer[n];(r==null?void 0:r.length)>0&&(H6.debug("resolveMessagingBuffer",{length:r.length}),r.forEach(i=>{this.signaling.onMessage.emit(i)}),delete this._indicateMessageBuffer[n]),this._excludeConnectionIndicateBuffering.add(n)}close(){this._disposer.dispose(),this._indicateMessageBuffer={},this._excludeConnectionIndicateBuffering=new Set}};Y();Y();Y();var yc=Br(Fi());Y();Y();Y();Y();var vb=class{constructor(e,t){this.id=e,this.contentType=t,this.side="remote",this.onConnectionStateChanged=new Qe,this._onConnectionStateChanged=new Qe,this._connectionState="new",this._getTransport=()=>{},this.getStats=()=>this._getStats(),this._getStats=()=>H(null,null,function*(){return[]}),this._onConnectionStateChanged.pipe(this.onConnectionStateChanged)}_setConnectionState(e){this._connectionState!==e&&(this._connectionState=e,this._onConnectionStateChanged.emit(e))}getRTCPeerConnection(){return this._getRTCPeerConnection()}_getRTCPeerConnection(){var e;return(e=this._getTransport())==null?void 0:e.rtcPeerConnection}getConnectionState(){return this._getConnectionState()}_getConnectionState(){return this._connectionState}toJSON(){return{contentType:this.contentType,id:this.id,codec:this.codec,side:this.side}}},yb=class extends vb{constructor(e,t,n){super(e,t),this.id=e,this.contentType=t,this.track=n}get isEnabled(){return this.track.enabled}setIsEnabled(e){this.track.enabled=e}attach(e){this._element=e,j_(e,this.track)}detach(){this._element&&(B_(this._element,this.track),this._element=void 0)}},q6=class extends yb{constructor(e,t){super(e,"audio",t),this.track=t,this.contentType="audio"}};Y();var z6=class extends vb{constructor(e,t){super(e,"data"),this._datachannel=t,this._isEnabled=!0,this.contentType="data",this.onData=new Qe,t.onmessage=({data:n})=>{this.isEnabled&&(typeof n=="string"&&n.includes(qf)&&(n=JSON.parse(n.slice(qf.length))),this.onData.emit(n))}}get isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}};Y();var K6=class extends yb{constructor(e,t){super(e,"video",t),this.track=t,this.contentType="video"}},$6=new Ge("packages/core/src/media/stream/remote/factory.ts"),Kf=(e,t,n)=>{if(t instanceof RTCDataChannel){const r=new z6(e,t);return r.codec=n,r}else if(t.kind==="audio"){const r=new q6(e,t);return r.codec=n,r}else if(t.kind==="video"){const r=new K6(e,t);return r.codec=n,r}throw Oe({operationName:"createRemoteStream",path:$6.prefix,info:we(ie({},Ve.invalidArgumentValue),{detail:"invalid stream type"})})};Y();var W6=new Ge("packages/core/src/plugin/internal/person/util.ts"),jc=(e,t)=>H(null,null,function*(){const n=W6.createBlock({label:"setEncodingParams"}),r=e.getParameters();n.debug("getParameters",{params:r,newEncodings:t}),r.encodings==null&&(r.encodings=[]),r.encodings=t.map((i,a)=>ie(ie({},r.encodings[a]||{}),i)),yield e.setParameters(r)}),_b=()=>Jv()==="Safari12"||Jv()==="Safari11";function G6(e){switch(e){case"closed":case"disconnected":case"failed":return"disconnected";case"connected":return"connected";case"connecting":return"connecting";case"new":return"new";case"reconnecting":return"reconnecting"}}var J6=e=>{const t=[];return e.forEach(n=>{t.push(JSON.parse(JSON.stringify(n)))}),t};Y();var bb=class Sb{constructor(t,n){this.publicationId=t,this.streamId=n}static fromLabel(t){const{p:n,s:r}=JSON.parse(t);return new Sb(n,r)}toLabel(){return JSON.stringify({p:this.publicationId,s:this.streamId})}};Y();var yi=new Ge("packages/core/src/plugin/internal/person/connection/peer.ts"),wb=class{constructor(e,t,n,r,i,a,o){this._context=e,this._iceManager=t,this.signaling=n,this.analytics=r,this.localPerson=i,this.endpoint=a,this.role=o,this._pendingCandidates=[],this.pc=new RTCPeerConnection(we(ie({},this._context.config.rtcConfig),{iceTransportPolicy:this._context.config.rtcConfig.turnPolicy==="turnOnly"?"relay":void 0,iceServers:this._iceManager.iceServers})),this.onSignalingStateChanged=new Qe,this.onPeerConnectionStateChanged=new Qe,this.onDisconnect=new Qe,this.connected=!1,this.disconnected=!1,this.rtcPeerConnectionId=Ko(),this._onICECandidate=h=>H(this,null,function*(){if(h.candidate==null||h.candidate===""||this.pc.connectionState==="closed")return;const v={kind:"iceCandidateMessage",payload:{candidate:h.candidate,role:this.role}};yi.debug("[start] send candidate",{message:v,localPerson:this.localPerson}),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceCandidate",data:{candidate:JSON.stringify(h.candidate)},createdAt:Date.now()});try{yield this.signaling.send(this.endpoint,v),yi.debug("[end] send candidate",{message:v,localPerson:this.localPerson})}catch(f){yi.warn("[failed] send candidate",In({operationName:"Peer._onICECandidate",channel:this.localPerson.channel,detail:"[failed] send candidate",payload:{message:v}}),f)}}),this._onICECandidateError=h=>H(this,null,function*(){this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceCandidateError",data:{event:JSON.stringify(h)},createdAt:Date.now()})}),this._onIceGatheringStateChange=h=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const v=this.pc.iceGatheringState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceGatheringStateChange",data:{event:v},createdAt:Date.now()})}}),this._onConnectionStateChange=()=>H(this,null,function*(){const h=this.pc.connectionState;switch(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"connectionStateChange",data:{connectionState:h},createdAt:Date.now()}),h){case"connected":this.connected=!0,this._pendingCandidates=[];break}this.onPeerConnectionStateChanged.emit(this.pc.connectionState)}),this._onIceConnectionStateChange=()=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const h=this.pc.iceConnectionState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"iceConnectionStateChange",data:{iceConnectionState:h},createdAt:Date.now()})}}),this._onSignalingStateChange=()=>H(this,null,function*(){if(this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const h=this.pc.signalingState;this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"signalingStateChange",data:{signalingState:h},createdAt:Date.now()})}}),this.waitForSignalingState=(h,v=1e4)=>H(this,null,function*(){this.pc.signalingState!==h&&(yield this.onSignalingStateChanged.watch(()=>this.pc.signalingState===h,v).catch(f=>{throw Oe({operationName:"Peer.waitForSignalingState",info:we(ie({},Ve.timeout),{detail:"waitForSignalingState timeout"}),path:yi.prefix,context:this._context,channel:this.localPerson.channel,error:f})}))}),this.waitForConnectionState=(h,v=1e4)=>H(this,null,function*(){h!==this.pc.connectionState&&(yield this.onPeerConnectionStateChanged.watch(()=>h===this.pc.connectionState,v).catch(f=>{throw Oe({operationName:"Peer.waitForConnectionState",info:we(ie({},Ve.timeout),{detail:"waitForConnectionState timeout"}),path:yi.prefix,context:this._context,channel:this.localPerson.channel,error:f})}))}),this.waitForStats=h=>H(this,[h],function*({track:v,cb:f,interval:_,timeout:w,logging:C}){_??(_=100),w??(w=1e4);for(let R=0;;R+=_){if(R>=w)throw Oe({operationName:"Peer.waitForStats",info:we(ie({},Ve.timeout),{detail:"waitForStats timeout"}),path:yi.prefix,context:this._context,channel:this.localPerson.channel});const S=yield this.pc.getStats(v),b=J6(S);if(C&&yi.debug("Peer.waitForStats",b),f(b))break;yield new Promise(x=>setTimeout(x,_))}});var u;yi.debug("peerConfig",this.pc.getConfiguration()),this.setPeerConnectionListener();const p=(u=this.pc)==null?void 0:u.peerIdentity;p&&p.catch(h=>{yi.debug("firefox peerIdentity",h)})}setPeerConnectionListener(){this.pc.onicecandidate=this._onICECandidate,this.pc.onicecandidateerror=this._onICECandidateError,this.pc.onicegatheringstatechange=this._onIceGatheringStateChange,this.pc.onconnectionstatechange=this._onConnectionStateChange,this.pc.oniceconnectionstatechange=this._onIceConnectionStateChange,this.pc.onsignalingstatechange=()=>{this._onSignalingStateChange(),this.onSignalingStateChanged.emit(this.pc.signalingState)}}unSetPeerConnectionListener(){this.pc.onicecandidate=null,this.pc.onicecandidateerror=null,this.pc.onicegatheringstatechange=null,this.pc.onconnectionstatechange=null,this.pc.oniceconnectionstatechange=null,this.pc.onsignalingstatechange=null}handleCandidate(e){return H(this,null,function*(){this._pendingCandidates.push(e),this.pc.remoteDescription&&(yield this.resolveCandidates())})}resolveCandidates(){return H(this,null,function*(){const e=[...this._pendingCandidates];this._pendingCandidates=[],yi.debug("addIceCandidates",e),yield Promise.all(e.map(t=>{this.pc.signalingState!=="closed"&&this.pc.addIceCandidate(t).catch(n=>{yi.warn("[failed] add ice candidate",In({operationName:"Peer.resolveCandidates",channel:this.localPerson.channel,detail:"[failed] send candidate",payload:{endpointId:this.endpoint.id}}),n)})}))})}},Ds=new Ge("packages/core/src/plugin/internal/person/connection/receiver.ts"),Z6=class extends wb{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a,"receiver"),this.id=Oi(),this.onConnectionStateChanged=new Qe,this.onStreamAdded=new Qe,this.onError=new Qe,this._connectionState="new",this._publicationInfo={},this.streams={},this._subscriptions={},this._promiseQueue=new ca,this._disposer=new Zr,this._log=Ds.createBlock({localPersonId:this.localPerson.id,id:this.id}),this._log.debug("spawned"),this.signaling.onMessage.add(o=>H(this,[o],function*({src:u,data:p}){if(!(u.id===a.id&&u.name===a.name))return;const h=p;switch(h.kind){case"senderProduceMessage":this._promiseQueue.push(()=>this._handleSenderProduce(h.payload)).catch(v=>this._log.error("handle senderProduceMessage failed",v,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"senderUnproduceMessage":this._promiseQueue.push(()=>this._handleSenderUnproduce(h.payload)).catch(v=>this._log.error("handle handleSenderUnproduce",v,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"senderRestartIceMessage":this._promiseQueue.push(()=>this._handleSenderRestartIce(h.payload)).catch(v=>this._log.error("_handleSenderRestartIce",v,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}));break;case"iceCandidateMessage":{const{role:v,candidate:f}=h.payload;v==="sender"&&(yield this.handleCandidate(f))}break}})).disposer(this._disposer),this.pc.ontrack=o=>H(this,[o],function*({track:u,transceiver:p}){if(!p.mid)throw Oe({operationName:"Receiver.pc.ontrack",info:we(ie({},Ve.missingProperty),{detail:"mid missing"}),path:Ds.prefix,context:this._context,channel:this.localPerson.channel});const h=Object.values(this._publicationInfo).find(w=>{var C;return w.mid===((C=p.mid)==null?void 0:C.toString())});if(!h){const w=Oe({operationName:"Receiver.pc.ontrack",info:we(ie({},Ve.notFound),{detail:"publicationInfo not found"}),path:Ds.prefix,context:this._context,channel:i.channel,payload:{endpointId:this.endpoint.id,publicationInfo:this._publicationInfo,mid:p.mid}});this.onError.emit(w),this._log.error(w);return}const v=yc.parse(this.pc.remoteDescription.sdp),f=this._getCodecFromSdp(v,p,u.kind),_=Kf(h.streamId,u,f);_.codec=f,this._setupTransportAccessForStream(_),this.streams[h.publicationId]=_,this._log.debug("MediaStreamTrack added",h,u,f),this.onStreamAdded.emit({publicationId:h.publicationId,stream:_})}),this.pc.ondatachannel=o=>H(this,[o],function*({channel:u}){const{publicationId:p,streamId:h}=bb.fromLabel(u.label),v={mimeType:"datachannel"},f=Kf(h,u,v);this._setupTransportAccessForStream(f),this.streams[p]=f,this._log.debug("DataChannel added",p,u,v),this.onStreamAdded.emit({publicationId:p,stream:f})}),this.onPeerConnectionStateChanged.add(o=>{switch(o){case"connecting":case"connected":this._setConnectionState(o);break;case"failed":case"closed":this._setConnectionState("disconnected");break}}).disposer(this._disposer)}_setConnectionState(e){this._connectionState!==e&&(this._log.debug("onConnectionStateChanged",this.id,this._connectionState,e),this._connectionState=e,this.onConnectionStateChanged.emit(e))}_setupTransportAccessForStream(e){e._getTransport=()=>({rtcPeerConnection:this.pc,connectionState:G6(this.pc.connectionState)}),e._getStats=()=>H(this,null,function*(){if(e.contentType==="data"){const r=yield this.pc.getStats();return No(r)}const t=yield this.pc.getStats(e.track);return No(t)}),this._disposer.push(()=>{e._getTransport=()=>{}}),this.onConnectionStateChanged.add(t=>{e._setConnectionState(t),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"skywayConnectionStateChange",data:{skywayConnectionState:t},createdAt:Date.now()})}).disposer(this._disposer)}_getCodecFromSdp(e,t,n){var r;const i=e.media.find(f=>{var _,w;return((_=f.mid)==null?void 0:_.toString())===((w=t.mid)==null?void 0:w.toString())});if(!i)throw Oe({operationName:"Receiver._getCodecFromSdp",info:we(ie({},Ve.notFound),{detail:"m-line not exist"}),path:Ds.prefix,context:this._context,channel:this.localPerson.channel});const a=(r=i.payloads)==null?void 0:r.toString().split(" ")[0],o=i.rtp.find(f=>f.payload.toString()===a),u=`${n}/${o.codec}`.toLowerCase();let p={};const h=i.fmtp.find(f=>f.payload.toString()===a);return h!=null&&h.config&&(p=N_(h.config)),{mimeType:u,parameters:p}}get hasMedia(){const e=Object.values(this.streams).length;return this._log.debug("hasMedia",{count:e}),e>0}close(){this._log.debug("closed"),this.unSetPeerConnectionListener(),this.pc.close(),this._setConnectionState("disconnected"),this._disposer.dispose()}add(e){this._subscriptions[e.id]=e}remove(e){const t=this._subscriptions[e];if(!t)return;delete this._subscriptions[t.id];const n=t.publication.id;this.streams[n]&&delete this.streams[n]}_validateRemoteOffer(e){const t=yc.parse(e);this._log.debug("_validateRemoteOffer",{sdpObject:t});for(const n of t.media){if(n.direction==="inactive")continue;if(!Object.values(this._publicationInfo).find(i=>{var a;return((a=n.mid)==null?void 0:a.toString())===i.mid})){const i=Oe({operationName:"Receiver._validateRemoteOffer",info:we(ie({},Ve.notFound),{detail:"mismatch between sdp and state"}),path:Ds.prefix,context:this._context,channel:this.localPerson.channel,payload:{sdpMedia:t.media,sdpMediaLine:n,info:this._publicationInfo}});throw this.onError.emit(i),i}}}get isWrongSignalingState(){return this.pc.signalingState==="have-local-offer"&&this.pc.remoteDescription||this.pc.signalingState==="have-remote-offer"}_handleSenderProduce(e){return H(this,arguments,function*({sdp:t,publicationId:n,info:r}){if(this.pc.signalingState!=="closed"){if(this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("_handleSenderProduce wait for be stable",In({operationName:"Receiver._handleSenderProduce",channel:this.localPerson.channel,detail:"_handleSenderProduce wait for be stable",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderProduce({sdp:t,publicationId:n,info:r});return}throw Oe({operationName:"Receiver._handleSenderProduce",context:this._context,channel:this.localPerson.channel,info:we(ie({},Ve.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Ds.prefix})}this._log.debug("_handleSenderProduce",{info:r,publicationId:n,publicationInfo:Object.values(this._publicationInfo)}),this._publicationInfo[r.publicationId]=r,this._validateRemoteOffer(t.sdp),yield this.sendAnswer(t),yield this.resolveCandidates()}})}_handleSenderUnproduce(e){return H(this,arguments,function*({sdp:t,publicationId:n}){if(this.pc.signalingState==="closed"){this._log.warn("signalingState closed",In({channel:this.localPerson.channel,detail:"signalingState closed",operationName:"Receiver._handleSenderUnproduce"}));return}if(this._log.debug("<handleSenderUnproduce> start",{sdp:t,publicationId:n}),this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("signalingState is not stable",In({channel:this.localPerson.channel,detail:"signalingState is not stable",operationName:"Receiver._handleSenderUnproduce",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderUnproduce({sdp:t,publicationId:n});return}throw Oe({operationName:"Receiver._handleSenderProduce",context:this._context,channel:this.localPerson.channel,info:we(ie({},Ve.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Ds.prefix})}delete this._publicationInfo[n],yield this.sendAnswer(t),yield this.resolveCandidates(),this._log.debug("<handleSenderUnproduce> end",{publicationId:n})})}_handleSenderRestartIce(e){return H(this,arguments,function*({sdp:t}){if(this.pc.signalingState!=="closed"){if(this.pc.signalingState!=="stable"){if(this.isWrongSignalingState){this._log.warn("signalingState is not stable",In({channel:this.localPerson.channel,detail:"signalingState is not stable",operationName:"Receiver._handleSenderRestartIce",payload:{signalingState:this.pc.signalingState}})),yield this.waitForSignalingState("stable"),yield this._handleSenderRestartIce({sdp:t});return}throw Oe({operationName:"Receiver._handleSenderRestartIce",context:this._context,channel:this.localPerson.channel,info:we(ie({},Ve.internal),{detail:"wrong signalingState"}),payload:{signalingState:this.pc.signalingState},path:Ds.prefix})}this._setConnectionState("reconnecting"),yield this.sendAnswer(t),yield this.resolveCandidates(),this.pc.connectionState==="connected"&&this._setConnectionState("connected")}})}sendAnswer(e){return H(this,null,function*(){this._log.debug("[receiver] start: sendAnswer"),yield this.pc.setRemoteDescription(e);const t=yield this.pc.createAnswer();this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"answer",data:{answer:JSON.stringify(t)},createdAt:Date.now()});const n=yc.parse(this.pc.remoteDescription.sdp),r=yc.parse(t.sdp);n.media.forEach((o,u)=>{const p=r.media[u];p.fmtp=jC(p.fmtp).map(h=>{const v=o.fmtp.find(f=>f.payload===h.payload);return v||h})});const i=yc.write(r);yield this.pc.setLocalDescription({type:"answer",sdp:i});const a={kind:"receiverAnswerMessage",payload:{sdp:this.pc.localDescription}};yield this.signaling.send(this.endpoint,a).catch(o=>this._log.error("failed to send answer",o,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id})),this._log.debug("[receiver] end: sendAnswer")})}get subscriptions(){return this._subscriptions}};Y();var Q6=Br(Jy()),g1=Br(Fi()),vr=new Ge("packages/core/src/plugin/internal/person/connection/sender.ts"),X6=class extends wb{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a,"sender"),this.id=Oi(),this.onConnectionStateChanged=new Qe,this.publications={},this.transceivers={},this.datachannels={},this._pendingPublications=[],this._isNegotiating=!1,this.promiseQueue=new ca,this._disposer=new Zr,this._ms=new MediaStream,this._backoffIceRestarted=new Ci({times:8,interval:100,jitter:100}),this._connectionState="new",this._log=vr.createBlock({localPersonId:this.localPerson.id,id:this.id}),this._unsubscribeStreamEnableChange={},this._cleanupStreamCallbacks={},this.restartIce=()=>H(this,null,function*(){if(this._backoffIceRestarted.exceeded){this._log.error(Oe({operationName:"Sender.restartIce",context:this._context,channel:this.localPerson.channel,info:we(ie({},Ve.internal),{detail:"restartIce limit exceeded"}),path:vr.prefix})),this._setConnectionState("disconnected");return}this._log.warn("[start] restartIce",In({operationName:"Sender.restartIce",detail:"start restartIce",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}));const o=()=>{if(this.endpoint.state==="left")return this._log.warn("endpointMemberLeft",In({operationName:"restartIce",detail:"endpointMemberLeft",channel:this.localPerson.channel,payload:{endpointId:this.endpoint.id}})),this._setConnectionState("disconnected"),!0;if(this.pc.connectionState==="connected")return this._log.warn("[end] restartIce",In({operationName:"restartIce",detail:"reconnected",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}})),this._backoffIceRestarted.reset(),this._setConnectionState("connected"),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"restartIce",data:void 0,createdAt:Date.now()}),!0};if(this._setConnectionState("reconnecting"),yield this._backoffIceRestarted.wait(),o())return;let u=yield this._iceManager.updateIceParams().catch(v=>v);if(u){this._log.warn("[failed] restartIce",In({operationName:"restartIce",detail:"update IceParams failed",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}),u),yield this.restartIce();return}if(this.pc.setConfiguration&&(this.pc.setConfiguration(we(ie({},this.pc.getConfiguration()),{iceServers:this._iceManager.iceServers})),this._log.debug("<restartIce> setConfiguration",{iceServers:this._iceManager.iceServers})),o())return;if(this.signaling.connectionState!=="connected"){if(this._log.warn("<restartIce> reconnect signaling service",In({operationName:"restartIce",detail:"reconnect signaling service",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}})),u=yield this.signaling.onConnectionStateChanged.watch(v=>v==="connected",1e4).catch(v=>v).then(()=>{}),u instanceof _r){yield this.restartIce();return}if(o())return}const p=yield this.pc.createOffer({iceRestart:!0});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(p)},createdAt:Date.now()}),yield this.pc.setLocalDescription(p);const h={kind:"senderRestartIceMessage",payload:{sdp:this.pc.localDescription}};if(u=yield this.signaling.send(this.endpoint,h,1e4).catch(v=>v),u){this._log.warn("<restartIce> [failed]",In({operationName:"restartIce",detail:"timeout send signaling message",channel:this.localPerson.channel,payload:{count:this._backoffIceRestarted.count}}),u),yield this.restartIce();return}u=yield this.waitForConnectionState("connected",this._context.config.rtcConfig.iceDisconnectBufferTimeout).catch(v=>v),!(!u&&o())&&(yield this.restartIce())}),this._log.debug("spawned"),this.signaling.onMessage.add(o=>H(this,[o],function*({src:u,data:p}){if(!(u.id===a.id&&u.name===a.name))return;const h=p;switch(h.kind){case"receiverAnswerMessage":this.promiseQueue.push(()=>this._handleReceiverAnswer(h.payload)).catch(v=>this._log.error("handle receiverAnswerMessage",{localPersonId:this.localPerson.id,endpointId:this.endpoint.id,err:v}));break;case"iceCandidateMessage":{const{role:v,candidate:f}=h.payload;v==="receiver"&&(yield this.handleCandidate(f))}break}})).disposer(this._disposer),this.onPeerConnectionStateChanged.add(o=>H(this,null,function*(){try{switch(vr.debug("onPeerConnectionStateChanged",{state:o}),o){case"disconnected":case"failed":(yield this.waitForConnectionState("connected",e.config.rtcConfig.iceDisconnectBufferTimeout).catch(p=>p))&&this._connectionState!=="reconnecting"&&(yield this.restartIce());break;case"connecting":case"connected":this._setConnectionState(o);break;case"closed":this._setConnectionState("disconnected");break}}catch(u){vr.error("onPeerConnectionStateChanged",u,this.id)}})).disposer(this._disposer)}_setConnectionState(e){this._connectionState!==e&&(this._log.debug("onConnectionStateChanged",this.id,this._connectionState,e),this._connectionState=e,this.onConnectionStateChanged.emit(e))}get hasMedia(){const e=Object.keys(this.publications).length;return this._log.debug("hasMedia",{count:e}),e>0}_getMid(e,t){if(e.contentType==="data"){const n=t.media.find(r=>r.type==="application");if((n==null?void 0:n.mid)==null)throw Oe({operationName:"Sender._getMid",info:we(ie({},Ve.missingProperty),{detail:"datachannel mid undefined"}),path:vr.prefix,context:this._context,channel:this.localPerson.channel});return n.mid.toString()}else{const r=this.transceivers[e.id].mid;if(r==null)throw Oe({operationName:"Sender._getMid",info:we(ie({},Ve.missingProperty),{detail:"media mid undefined"}),path:vr.prefix,context:this._context,channel:this.localPerson.channel});return r.toString()}}_listenStreamEnableChange(e,t){this._unsubscribeStreamEnableChange[t]&&this._unsubscribeStreamEnableChange[t]();const{removeListener:n}=e._onEnableChanged.add(r=>H(this,null,function*(){yield this._replaceTrack(t,r).catch(i=>{vr.warn(In({member:this.localPerson,detail:"_replaceTrack failed",operationName:"Sender._listenStreamEnableChange",payload:i}))})}));this._unsubscribeStreamEnableChange[t]=n}add(e){return H(this,null,function*(){var t,n;if(this._isNegotiating||this.pc.signalingState!=="stable"){this._pendingPublications.push(e),this._log.debug("<add> isNegotiating",{publication:e,isNegotiating:this._isNegotiating,signalingState:this.pc.signalingState,pendingPublications:this._pendingPublications.length});return}this._isNegotiating=!0,this._log.debug("<add> add publication",{publication:e}),this.publications[e.id]=e;const r=e.stream;if(!r)throw Oe({operationName:"Sender.add",info:we(ie({},Ve.missingProperty),{detail:"<add> stream not found"}),path:vr.prefix,context:this._context,channel:this.localPerson.channel});if(this._cleanupStreamCallbacks[r.id]=this._setupTransportAccessForStream(r),r.contentType==="data"){const p=this.pc.createDataChannel(new bb(e.id,r.id).toLabel(),r.options);r._onWriteData.add(h=>{p.readyState==="open"&&p.send(h)}).disposer(this._disposer),this.datachannels[e.id]=p}else{e._onReplaceStream.add(h=>H(this,[h],function*({newStream:v,oldStream:f}){v._replacingTrack=!0,this._listenStreamEnableChange(v,e.id),this._cleanupStreamCallbacks[f.id]&&this._cleanupStreamCallbacks[f.id](),this._cleanupStreamCallbacks[v.id]=this._setupTransportAccessForStream(v),yield this._replaceTrack(e.id,v.track),v._replacingTrack=!1,v._onReplacingTrackDone.emit()})).disposer(this._disposer),this._listenStreamEnableChange(r,e.id);const p=this.pc.addTransceiver(r.track,{direction:"sendonly",streams:[this._ms]});e._onEncodingsChanged.add(h=>H(this,null,function*(){yield jc(p.sender,h).catch(v=>{this._log.error("_onEncodingsChanged failed",v)})})).disposer(this._disposer),this.transceivers[e.id]=p}const i=yield this.pc.createOffer().catch(p=>{throw Oe({operationName:"Sender.add",info:we(ie({},Ve.internal),{detail:"can't create offer"}),path:vr.prefix,context:this._context,channel:this.localPerson.channel,error:p})});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(i)},createdAt:Date.now()}),yield this.pc.setLocalDescription(i);const a=g1.parse(this.pc.localDescription.sdp);this._log.debug("<add> create offer base",a);const o=this._getMid(e,a);if(e.contentType!=="data"){Y6((t=e.codecCapabilities)!=null?t:[],o,a);const p=g1.write(a);if(yield this.pc.setLocalDescription({type:"offer",sdp:p}),this._log.debug("<add> create offer",this.pc.localDescription),((n=e.encodings)==null?void 0:n.length)>0)if(_b())this._safariSetupEncoding(e);else{const h=this.transceivers[e.id];yield jc(h.sender,[e.encodings[0]])}}const u={kind:"senderProduceMessage",payload:{sdp:this.pc.localDescription,publicationId:e.id,info:{publicationId:e.id,streamId:r.id,mid:o}}};this._log.debug("[start] send message",u),yield this.signaling.send(this.endpoint,u).catch(p=>{throw this._log.error("[failed] send message :",p,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}),p}),this._log.debug("[end] send message",u)})}_setupTransportAccessForStream(e){e._getTransportCallbacks[this.endpoint.id]=()=>({rtcPeerConnection:this.pc,connectionState:this._connectionState}),e._getStatsCallbacks[this.endpoint.id]=()=>H(this,null,function*(){if(e.contentType==="data"){const i=yield this.pc.getStats();return No(i)}e._replacingTrack&&(yield e._onReplacingTrackDone.asPromise(200));const n=yield this.pc.getStats(e.track);return No(n)});const t=()=>{delete e._getTransportCallbacks[this.endpoint.id],delete e._getStatsCallbacks[this.endpoint.id]};return this._disposer.push(()=>{t()}),this.onConnectionStateChanged.add(n=>{e._setConnectionState(this.endpoint,n),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"skywayConnectionStateChange",data:{skywayConnectionState:n},createdAt:Date.now()})}).disposer(this._disposer),t}remove(e){return H(this,null,function*(){const t=this.publications[e];if(!t){this._log.warn("<remove> publication not found",In({operationName:"Sender.remove",detail:"publication already removed",channel:this.localPerson.channel,payload:{publicationId:e}}));return}if(delete this.publications[e],this._isNegotiating||this.pc.signalingState!=="stable"){this._pendingPublications.push(e),this._log.debug("<remove> isNegotiating",{publicationId:e,_isNegotiating:this._isNegotiating,signalingState:this.pc.signalingState});return}this._isNegotiating=!0,this._log.debug("<remove> [start]",{publicationId:e});const n=t.stream;if(!n)throw Oe({operationName:"Sender.remove",info:we(ie({},Ve.missingProperty),{detail:"<remove> publication not have stream"}),path:vr.prefix,context:this._context,channel:this.localPerson.channel,payload:{publication:t}});n.contentType==="data"?(this.datachannels[e].close(),delete this.datachannels[e]):(this.transceivers[e].stop(),delete this.transceivers[e]);const r=yield this.pc.createOffer().catch(a=>{throw Oe({operationName:"Sender.remove",info:we(ie({},Ve.internal),{detail:"<remove> can't create offer"}),path:vr.prefix,context:this._context,channel:this.localPerson.channel,error:a})});this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.rtcPeerConnectionId,type:"offer",data:{offer:JSON.stringify(r)},createdAt:Date.now()}),yield this.pc.setLocalDescription(r);const i={kind:"senderUnproduceMessage",payload:{sdp:this.pc.localDescription,publicationId:e}};this._log.debug("<remove> send message",{message:i}),yield this.signaling.send(this.endpoint,i).catch(a=>{throw this._log.error("<remove> in remote error :",a,{localPersonId:this.localPerson.id,endpointId:this.endpoint.id}),a}),this._log.debug("<remove> [end]",{publicationId:e})})}_replaceTrack(e,t){return H(this,null,function*(){const n=this.transceivers[e];if(!n){this._log.warn("can't replace track, transceiver not found",In({operationName:"Sender._replaceTrack",detail:"transceiver already removed",channel:this.localPerson.channel,payload:{publicationId:e}}));return}yield n.sender.replaceTrack(t).catch(r=>{throw Oe({operationName:"Sender._replaceTrack",context:this._context,info:Ve.internal,error:r,path:vr.prefix,channel:this.localPerson.channel})})})}_handleReceiverAnswer(e){return H(this,arguments,function*({sdp:t}){this.pc.signalingState!=="closed"&&(this._log.debug("<handleReceiverAnswer> [start]"),yield this.pc.setRemoteDescription(new RTCSessionDescription(t)).catch(n=>{const r=Oe({operationName:"Sender._handleReceiverAnswer",context:this._context,info:we(ie({},Ve.internal),{detail:"failed to setRemoteDescription"}),path:vr.prefix,payload:{sdp:t},channel:this.localPerson.channel,error:n});throw this._log.error(r),r}),this._log.debug("<handleReceiverAnswer> sRD"),yield this.resolveCandidates(),this._log.debug("<handleReceiverAnswer> resolveCandidates"),yield this.waitForSignalingState("stable"),this._log.debug("<handleReceiverAnswer> waitForSignalingState"),this._isNegotiating=!1,yield this._resolvePendingSender(),this._log.debug("<handleReceiverAnswer> _resolvePendingSender",this._pendingPublications.length),this._log.debug("<handleReceiverAnswer> [end]"))})}_safariSetupEncoding(e){const t=this.transceivers[e.id],n=e.stream;this.waitForStats({track:n.track,cb:r=>{const i=r.find(a=>a.id.includes("RTCOutboundRTP")||a.type.includes("outbound-rtp"));return(i==null?void 0:i.keyFramesEncoded)>0},interval:10,timeout:this._context.config.rtcConfig.timeout}).then(()=>{vr.debug("safari wait for stats resolved, setEncodingParams"),jc(t.sender,[e.encodings[0]]).catch(r=>{this._log.error("setEncodingParams failed",r)})}).catch(r=>{this._log.error("waitForStats",r)})}_resolvePendingSender(){return H(this,null,function*(){const e=this._pendingPublications.shift();e&&(this._log.debug("resolve pending sender",{publication:e}),typeof e=="string"?yield this.remove(e):yield this.add(e))})}close(){this._log.debug("closed"),this.unSetPeerConnectionListener(),Object.values(this._unsubscribeStreamEnableChange).forEach(e=>e()),this.pc.close(),this._setConnectionState("disconnected"),this._disposer.dispose()}};function Y6(e,t,n){var r,i;const a=n.media.find(h=>{var v;return((v=h.mid)==null?void 0:v.toString())===t});if(!a)throw Oe({operationName:"applyCodecCapabilities",info:we(ie({},Ve.notFound),{detail:"media not found"}),path:vr.prefix});e.forEach(h=>{var v;if(h.parameters)for(const[f,_]of Object.entries((v=h.parameters)!=null?v:{})){if(_===!1||!h.parameters[f])return;f==="usedtx"&&_&&(h.parameters[f]=1)}});const o=(h,v,f)=>{var _;const w=v.map(S=>we(ie({},S),{parameters:VC(f,S.payload)})),C=v1(h.mimeType);return C&&(_=w.find(S=>{var b,x;return S.codec.toLowerCase()!==C.toLowerCase()?!1:Object.keys((b=h.parameters)!=null?b:{}).length===0||eP(h.mimeType)==="audio"?!0:(0,Q6.default)(S.parameters,(x=h.parameters)!=null?x:{})}))!=null?_:void 0},u=e.map(h=>o(h,a.rtp,a.fmtp)).filter(h=>h!=null),p=[...u,...a.rtp.filter(h=>!u.find(v=>v.payload===h.payload))];for(const h of a.fmtp){const v=h.payload,f=p.find(C=>C.payload===v);if(f){const C=e.find(R=>o(R,[f],a.fmtp));C&&C.parameters&&Object.keys(C.parameters).length>0&&(h.config="",Object.entries(C.parameters).forEach(([R,S])=>{S===!1||h.config.includes(R)||(h.config.length>0?h.config+=`;${R}=${S}`:h.config=`${R}=${S}`)}))}const _=p.find(C=>C.codec.toLowerCase()==="opus"),w=(i=(r=e.find(C=>v1(C.mimeType).toLowerCase()==="opus"))==null?void 0:r.parameters)==null?void 0:i.usedtx;_&&w!==!1&&h.payload===_.payload&&!h.config.includes("usedtx")&&(h.config.length>0?h.config+=";usedtx=1":h.config="usedtx=1")}a.payloads=p.map(h=>h.payload.toString()).join(" ")}var v1=e=>e.split("/")[1],eP=e=>e.split("/")[0],gu=new Ge("packages/core/src/plugin/internal/person/connection/index.ts"),tP=class{constructor(e,t,n,r,i,a,o){this._iceManager=e,this._signaling=t,this._analytics=n,this._context=r,this.channelId=i,this.localPerson=a,this.remoteMember=o,this.id=Oi(),this.type="p2p",this.onDisconnect=new Qe,this.onClose=new Qe,this.closed=!1,this.disconnected=!1,this._log=gu.createBlock({id:this.id,localPersonId:this.localPerson.id}),this._pubsubQueue=new ca,this.sendSubscriptionStatsReportTimers=new Map,this._waitingSendSubscriptionStatsReportsFromPublish=new Map,this._waitingSendSubscriptionStatsReportsFromSubscribe=[],this.sender=new X6(this._context,this._iceManager,this._signaling,this._analytics,this.localPerson,this.remoteMember),this.receiver=new Z6(this._context,this._iceManager,this._signaling,this._analytics,this.localPerson,this.remoteMember),this.sender.onDisconnect.once(()=>{this.disconnected=!0,this.onDisconnect.emit()}),this.receiver.onDisconnect.once(()=>{this.disconnected=!0,this.onDisconnect.emit()}),this._analytics&&this._analytics.onConnectionStateChanged.add(u=>{if(u==="connected"){if(this._waitingSendSubscriptionStatsReportsFromPublish.size>0){for(const[p,h]of this._waitingSendSubscriptionStatsReportsFromPublish){const v=this.sender.publications[h];v&&this.startSendSubscriptionStatsReportTimer(v,p)}this._waitingSendSubscriptionStatsReportsFromPublish.clear()}if(this._waitingSendSubscriptionStatsReportsFromSubscribe.length>0){for(const p of this._waitingSendSubscriptionStatsReportsFromSubscribe){const h=this.receiver.subscriptions[p];h&&this.startSendSubscriptionStatsReportTimer(h,p)}this._waitingSendSubscriptionStatsReportsFromSubscribe=[]}}})}startPublishing(e,t){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("startPublishing",{publication:e}),yield this.sender.add(e)})),this._analytics&&!this._analytics.isClosed()&&(this._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:t,role:"sender",rtcPeerConnectionId:this.sender.rtcPeerConnectionId}),this._analytics.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer(e,t):this._waitingSendSubscriptionStatsReportsFromPublish.set(t,e.id))})}stopPublishing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("<stopPublishing> start",{publication:e}),this.sender.remove(e.id).then(()=>{this._log.debug("<stopPublishing> removed",{publication:e})}).catch(n=>{this._log.error("<stopPublishing> remove failed",n,{publication:e})}),this._closeIfNeeded(),this._log.debug("<stopPublishing> end",{publication:e})}));const t=this.sendSubscriptionStatsReportTimers.get(e.id);t&&(clearInterval(t),this.sendSubscriptionStatsReportTimers.delete(e.id))})}startSubscribing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("startSubscribing",{subscription:e}),this.receiver.add(e);const t=e.publication.id;let n=this.receiver.streams[t];n||(yield this.receiver.onStreamAdded.watch(r=>r.publicationId===t,this._context.config.rtcConfig.timeout).catch(()=>{throw Oe({operationName:"P2PConnection.startSubscribing",info:we(ie({},Ve.timeout),{detail:"onStreamAdded"}),path:gu.prefix,context:this._context,channel:this.localPerson.channel,payload:{subscription:e}})}),n=this.receiver.streams[t]),n.setIsEnabled(e.publication.state==="enabled"),e.codec=n.codec,e._setStream(n),this._analytics&&!this._analytics.isClosed()&&(this._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:e.id,role:"receiver",rtcPeerConnectionId:this.receiver.rtcPeerConnectionId}),this._analytics.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer(e,e.id):this._waitingSendSubscriptionStatsReportsFromSubscribe.push(e.id))}))})}stopSubscribing(e){return H(this,null,function*(){yield this._pubsubQueue.push(()=>H(this,null,function*(){this._log.debug("stopSubscribing",{subscription:e}),this.receiver.remove(e.id),this._closeIfNeeded()}));const t=this.sendSubscriptionStatsReportTimers.get(e.id);t&&(clearInterval(t),this.sendSubscriptionStatsReportTimers.delete(e.id))})}_closeIfNeeded(){this.sender.hasMedia||this.receiver.hasMedia||this.close({reason:"no media"})}getStats(e){return H(this,null,function*(){const t=e.stream;if(!t)throw Oe({operationName:"P2PConnection.getStats",info:we(ie({},Ve.invalidArgumentValue),{detail:"Subscription or Publication must has stream"}),path:gu.prefix,context:this._context,channel:this.localPerson.channel});return t.side==="local"?t.contentType==="data"?this.sender.pc.getStats():this.sender.pc.getStats(t.track):t.contentType==="data"?this.receiver.pc.getStats():this.receiver.pc.getStats(t.track)})}close({reason:e}={}){if(!this.closed){this.closed=!0,this._log.debug("closed",{endpointId:this.remoteMember.id,reason:e,sender:this.sender.id,receiver:this.receiver.id,id:this.id}),this.sender.close(),this.receiver.close();for(const t of this.sendSubscriptionStatsReportTimers.values())clearInterval(t);this.sendSubscriptionStatsReportTimers.clear(),this._waitingSendSubscriptionStatsReportsFromPublish.clear(),this._waitingSendSubscriptionStatsReportsFromSubscribe=[],this.onClose.emit()}}startSendSubscriptionStatsReportTimer(e,t){if(this._analytics){const n=e instanceof lb?"sender":"receiver",r=this._analytics.client.getIntervalSec();this.sendSubscriptionStatsReportTimers.set(e.id,setInterval(()=>H(this,null,function*(){if(!this._analytics)throw Oe({operationName:"P2PConnection.sendSubscriptionStatsReportTimer",info:we(ie({},Ve.missingProperty),{detail:"AnalyticsSession not exist"}),path:gu.prefix,context:this._context,channel:this.localPerson.channel});if(this._analytics.isClosed()){const a=this.sendSubscriptionStatsReportTimers.get(e.id);a&&(clearInterval(a),this.sendSubscriptionStatsReportTimers.delete(e.id));return}const i=yield this.getStats(e);i&&this._analytics.client.sendSubscriptionStatsReport(i,{subscriptionId:t,role:n,contentType:e.contentType,createdAt:Date.now()})}),r*1e3))}}},_c=new Ge("packages/core/src/plugin/internal/person/member.ts"),Hu=class extends uh{constructor(e){super(e),this.args=e,this.type="person",this.subtype="person",this.side="remote",this._connections={},this._context=this.args.channel._context,this._disposer=new Zr,this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.subscribe=t=>new Promise((n,r)=>{let i=!1;this.channel._subscribe(this.id,t).catch(a=>{i=!0,r(a)}),this.onPublicationSubscribed.watch(({subscription:a})=>a.publication.id===t,this._context.config.rtcApi.timeout).then(({subscription:a})=>{n({subscription:a})}).catch(()=>{i||r(Oe({operationName:"RemotePersonImpl.subscribe",info:we(ie({},Ve.timeout),{detail:"onPublicationSubscribed"}),path:_c.prefix,context:this._context,channel:this.channel}))})}),this.plugin=e.plugin,this.channel.onPublicationUnsubscribed.add(({subscription:t})=>{t.subscriber.id===this.id&&(this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this.channel.onPublicationSubscribed.add(({subscription:t})=>{t.subscriber.id===this.id&&(this.onPublicationSubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this.channel.onStreamPublished.add(({publication:t})=>{t.publisher.id===this.id&&this.onPublicationListChanged.emit()}).disposer(this._disposer),this.channel.onStreamUnpublished.add(({publication:t})=>{t.publisher.id===this.id&&this.onPublicationListChanged.emit()}).disposer(this._disposer),this.onLeft.once(()=>{_c.debug("RemotePerson left: ",this.toJSON()),Object.values(this._connections).forEach(t=>{t.close({reason:"remote person left"})}),this._connections={}})}_getConnection(e){return this._connections[e]}_getOrCreateConnection(e){var t;return(t=this._getConnection(e.id))!=null?t:this._createConnection(this.channel,e,this)}_createConnection(e,t,n){if(t.side!=="local")throw Oe({operationName:"RemotePersonImpl._createConnection",info:we(ie({},Ve.invalidArgumentValue),{detail:"wrong localPerson type"}),path:_c.prefix,context:this._context,channel:this.channel});if(!t._signaling)throw Oe({operationName:"RemotePersonImpl._createConnection",info:we(ie({},Ve.missingProperty),{detail:"signalingSession not exist"}),path:_c.prefix,context:this._context,channel:this.channel});const r=new tP(t.iceManager,t._signaling,t._analytics,this._context,e.id,t,n);return this.plugin._messageBuffers[t.id].resolveMessagingBuffer(n),r.onClose.once(()=>{_c.debug("connection closed",this.toJSON(),{connectionId:r.id}),delete this._connections[t.id]}),this._connections[t.id]=r,r}unsubscribe(e){return H(this,null,function*(){yield this.channel._unsubscribe(e)})}_dispose(){this._disposer.dispose()}},nP=class extends ig{constructor(){super(...arguments),this.subtype="person",this._messageBuffers={},this._whenCreateLocalPerson=e=>H(this,null,function*(){e._signaling&&(this._messageBuffers[e.id]=new V6(e._signaling))}),this._whenDisposeLocalPerson=e=>H(this,null,function*(){const t=this._messageBuffers[e.id];t&&(t.close(),delete this._messageBuffers[e.id])}),this._createRemoteMember=(e,t)=>new Hu(we(ie({},this._context),{context:this._context,channel:e,metadata:t.metadata,id:t.id,name:t.name,plugin:this}))}},rP=e=>{const t=new nP;return e.registerPlugin(t),t};Y();var iP=class extends ig{constructor(){super(...arguments),this.subtype="unknown",this._createRemoteMember=(e,t)=>new M_(we(ie({},this._context),{context:this._context,channel:e,metadata:t.metadata,id:t.id,name:t.name,plugin:this,subtype:t.subtype}))}};Y();var sP="1.15.0",Ar=new Ge("packages/core/src/context.ts"),sg=class xb{constructor(t,n,r,i){this.config=n,this.authToken=r,this.info=i,this.disposed=!1,this.plugins=[],this._unknownPlugin=new iP,this._reminderSec=this.config.token.updateReminderSec,this._events=new Qi,this.onTokenUpdateReminder=this._events.make(),this.onTokenExpired=this._events.make(),this.onFatalError=this._events.make(),this._onTokenUpdated=this._events.make(),this._onDisposed=this._events.make(),this._authTokenString=r.tokenString,this.appId=this.authToken.getAppId(),rP(this),this._api=t,this._api.onFatalError.once(a=>{Ar.error("onFatalError",{appId:this.appId,error:a}),this.onFatalError.emit(Oe({operationName:"SkyWayContext._api.onFatalError",context:this,info:Ve.rtcApiFatalError,error:a,path:Ar.prefix})),this.dispose()})}static Create(t){return H(this,arguments,function*(n,r={}){const i=new h6(r);Ge.level=i.log.level,Ge.format=i.log.format;const a=yl.Decode(n),{osName:o,osVersion:u,browserName:p,browserVersion:h}=O_(),v={sdkName:"core",sdkVersion:this.version,osName:o,osVersion:u,browserName:p,browserVersion:h},f={rapi:i.rtcApi.domain,signaling:i.signalingService.domain,ice:i.iceParamServer.domain};Ar.info("core sdk spawned",{operationName:"SkyWayContext.Create",runtime:v,endpoint:f,config:i,token:a});try{const _=a.getAppId(),w=yield E6.Create({appId:_,token:n,log:i.log,rtcApi:i.rtcApi}),C=new xb(w,i,a,{endpoint:f,runtime:v});return yield C._setTokenExpireTimer(),a.getAnalyticsEnabled()&&(C.analyticsSession=yield B6(C)),C}catch(_){throw Oe({operationName:"SkyWayContext.Create",info:Ve.connectRtcApiFailed,error:_,path:Ar.prefix})}})}get authTokenString(){return this._authTokenString}_setTokenExpireTimer(){return H(this,null,function*(){const t=yield this._api.getServerUnixtimeInSec(),n=this.authToken.exp-t;if(n<0)throw Oe({operationName:"SkyWayContext._setTokenExpireTimer",context:this,info:Ve.invalidExpireTokenValue,path:Ar.prefix,payload:{exp:this.authToken.exp,now:t}});this.tokenUpdateReminderTimer&&clearTimeout(this.tokenUpdateReminderTimer);const r=n-this._reminderSec;if(r<0)throw Oe({operationName:"SkyWayContext._setTokenExpireTimer",context:this,info:Ve.invalidRemindExpireTokenValue,path:Ar.prefix,payload:{expiresInSec:n,reminderSec:this._reminderSec}});Ar.debug("_setTokenExpireTimer",{expiresInSec:n,tokenExpireReminderTimeSec:r}),this.tokenUpdateReminderTimer=setTimeout(()=>{Ar.debug("tokenUpdateReminder",{appid:this.appId}),this.onTokenUpdateReminder.emit()},r*1e3),this.tokenExpiredTimer&&clearTimeout(this.tokenExpiredTimer),this.tokenExpiredTimer=setTimeout(()=>{Ar.debug("tokenExpired",{appid:this.appId}),this.onTokenExpired.emit()},n*1e3)})}updateAuthToken(t){return H(this,null,function*(){const n=yl.Decode(t),r=n.getAppId();if(Ar.info({operationName:"SkyWayContext.updateAuthToken"},{oldToken:this.authToken,newToken:n}),r!==this.appId)throw Oe({operationName:"SkyWayContext.updateAuthToken",context:this,info:Ve.invalidTokenAppId,path:Ar.prefix,payload:{invalid:r,expect:this.appId}});this._authTokenString=t,this.authToken=n,this._onTokenUpdated.emit(t),yield this._setTokenExpireTimer(),yield this._api.updateAuthToken(t).catch(i=>{var a;throw Ar.warn("[failed] SkyWayContext.updateAuthToken",{detail:i}),i instanceof _r&&((a=i.info)==null?void 0:a.name)==="projectUsageLimitExceeded"&&(this.dispose(),clearTimeout(this.tokenExpiredTimer)),i})})}registerPlugin(t){this.plugins.find(n=>n.subtype===t.subtype)||(t._attachContext(this),this.plugins.push(t))}_createRemoteMember(t,n){const r=t._getMember(n.id);if(r)return r;Ar.debug("createRemoteMember",{memberDto:n}),n.type=n.type.toLowerCase(),n.subtype=n.subtype.toLowerCase();let i=this.plugins.find(o=>o.subtype===n.subtype);return i||(i=this._unknownPlugin),i._createRemoteMember(t,n)}dispose(){this.disposed||(this.disposed=!0,Ar.debug("disposed",{appid:this.appId}),clearTimeout(this.tokenUpdateReminderTimer),this._onDisposed.emit(),this._events.dispose(),this._api.close(),Ge._onLogForAnalytics=()=>{})}};sg.version=sP;sg.id=Oi();var $f=sg;Y();Y();var Tp=new Ge("packages/core/src/media/factory.ts"),aP=class{constructor(){if(this.onDeviceChange=new Qe,this._devices=[],!(navigator!=null&&navigator.mediaDevices))throw Oe({operationName:"StreamFactory.constructor",info:Ve.mediaDevicesNotFound,path:Tp.prefix});navigator.mediaDevices.addEventListener("devicechange",()=>H(this,null,function*(){const e=yield this._enumerateDevicesArray(),t=[];this._devices.forEach(r=>{e.map(i=>i.id).includes(r.id)||t.push(r)});const n=[];e.map(r=>r.id).forEach(r=>{this._devices.map(i=>i.id).includes(r)||n.push(e.find(i=>i.id===r))}),Tp.debug("device changed",{added:n,removed:t}),t.forEach(r=>{this.onDeviceChange.emit({state:"removed",device:r})}),n.forEach(r=>{this.onDeviceChange.emit({state:"added",device:r})}),this._devices=e}))}_enumerateDevicesArray(){return H(this,null,function*(){return(yield navigator.mediaDevices.enumerateDevices()).map(t=>new oP(t)).filter(t=>t.id.length>0)})}_enumerateDevicesWithAuth(){return H(this,arguments,function*({video:e,audio:t}={audio:!0,video:!0}){let n=[];return(e||t)&&(n=(yield navigator.mediaDevices.getUserMedia({video:e,audio:t})).getTracks()),this._devices=yield this._enumerateDevicesArray(),n.forEach(r=>r.stop()),this._devices})}enumerateDevices(){return H(this,null,function*(){return yield this._enumerateDevicesWithAuth()})}enumerateInputVideoDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({video:!0})).filter(t=>t.kind==="videoinput")})}enumerateInputAudioDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({audio:!0})).filter(t=>t.kind==="audioinput")})}enumerateOutputAudioDevices(){return H(this,null,function*(){return(yield this._enumerateDevicesWithAuth({audio:!0})).filter(t=>t.kind==="audiooutput")})}createCameraVideoStream(){return H(this,arguments,function*(e={}){var t;e.stopTrackWhenDisabled=(t=e.stopTrackWhenDisabled)!=null?t:!0;const[n]=(yield navigator.mediaDevices.getUserMedia({video:e})).getTracks(),r=new wp(n,e);return r._setLabel("camera"),r})}createMicrophoneAudioStream(){return H(this,arguments,function*(e={}){var t;e.stopTrackWhenDisabled=(t=e.stopTrackWhenDisabled)!=null?t:!0;const[n]=(yield navigator.mediaDevices.getUserMedia({audio:e})).getTracks(),r=new Sp(n,e);return r._setLabel("microphone"),r})}createDisplayStreams(){return H(this,arguments,function*(e={}){var t,n,r;const i=(t=e.video)!=null?t:{};(n=i.stopTrackWhenDisabled)!=null||(i.stopTrackWhenDisabled=!0);let a=e.audio;a&&(a=typeof a=="boolean"?{}:a,(r=a.stopTrackWhenDisabled)!=null||(a.stopTrackWhenDisabled=!0)),e={audio:a,video:i};const o=yield navigator.mediaDevices.getDisplayMedia(e),[u]=o.getVideoTracks(),[p]=o.getAudioTracks();e.audio&&!p&&Tp.warn(In({operationName:"StreamFactory.createDisplayStreams",detail:"This client does not support device audio capture"}));const h=new wp(u,we(ie({},i),{isDisplayMedia:!0}));h._setLabel("displayVideo");const v=p?new Sp(p,we(ie({},a),{isDisplayMedia:!0})):void 0;return v&&v._setLabel("displayAudio"),{video:h,audio:v}})}createDataStream(){return H(this,arguments,function*(e={}){return new ng(e)})}createMicrophoneAudioAndCameraStream(){return H(this,arguments,function*({audio:e,video:t}={}){var n,r;const i=yield navigator.mediaDevices.getUserMedia({audio:e??!0,video:t??!0}),[a]=i.getAudioTracks(),[o]=i.getVideoTracks();e=e??{},e.stopTrackWhenDisabled=(n=e.stopTrackWhenDisabled)!=null?n:!0;const u=new Sp(a,e);u._setLabel("microphone"),t=t??{},t.stopTrackWhenDisabled=(r=t.stopTrackWhenDisabled)!=null?r:!0;const p=new wp(o,t);return p._setLabel("camera"),{audio:u,video:p}})}createCustomVideoStream(e){return H(this,arguments,function*(t,n={}){var r,i;n.stopTrackWhenDisabled=(r=n.stopTrackWhenDisabled)!=null?r:!0;const a=new U5(n),o=yield t.createProcessedStream({constraints:(i=n.constraints)!=null?i:{},stopTrackWhenDisabled:n.stopTrackWhenDisabled,onUpdateTrack:u=>a.updateTrack(u)});return yield a.setStream(o),a})}},y1=new aP,oP=class{constructor(e){this.id=e.deviceId,this.label=e.label,this.kind=e.kind}};Y();Y();Y();Y();Y();Y();Y();Y();Y();Y();var Cb={domain:"sfu.skyway.ntt.com",secure:!0,version:4};Y();var Ls={invalidParameter:{name:"invalidParameter",detail:"",solution:""},invalidRequestParameter:{name:"invalidRequestParameter",detail:"",solution:""},notFound:{name:"notFound",detail:"",solution:""},maxSubscriberExceededError:{name:"maxSubscribersExceededError",detail:"forwardingmaxSubscribersmaxSubscribersSubscribe",solution:"maxSubscribers"},quotaExceededError:{name:"quotaExceededError",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},insufficientPermissions:{name:"insufficientPermissions",detail:"token",solution:"token"},backendError:{name:"backendError:",detail:"",solution:""},notAllowedConsumeError:{name:"notAllowedConsumeError",detail:"ForwardingConsume",solution:"Forwardingmember"}};Y();function va({operationName:e,info:t,error:n,path:r,payload:i}){return new _r({error:n,info:t,payload:{payload:i,operationName:e},path:r})}function bc({appId:e,detail:t,channelId:n,operationName:r,payload:i,memberId:a,botId:o}){return{operationName:r,payload:i,detail:t,appId:e,channelId:n,memberId:a,botId:o}}var fr=new Ge("packages/sfu-api-client/src/api.ts"),cP=class{constructor(e,t){this._token=e,this._headers={authorization:`Bearer ${this._token}`},this.options=ie(ie({},Cb),t),this.endpoint=`http${this.options.secure?"s":""}://${this.options.domain}/v${this.options.version}`,this.http=new Xm(this.endpoint),Ge.level=this.options.log.level,Ge.format=this.options.log.format,fr.debug("SfuRestApiClient spawned",{endpoint:this.endpoint})}updateToken(e){this._token=e}_commonErrorHandler(e,t){switch(e==null?void 0:e.status){case 401:return va({operationName:t,info:Ls.invalidRequestParameter,path:fr.prefix,payload:e});case 403:return va({operationName:t,info:Ls.insufficientPermissions,path:fr.prefix,payload:e});case 404:return va({operationName:t,info:Ls.notFound,path:fr.prefix,payload:e});case 429:return va({operationName:t,info:Ls.quotaExceededError,path:fr.prefix,payload:e});default:return va({operationName:t,info:Ls.backendError,path:fr.prefix,payload:e})}}createBot(e){return H(this,arguments,function*({appId:t,channelId:n}){return(yield this.http.post("/bots",{appId:t,channelId:n},{headers:{authorization:`Bearer ${this._token}`}}).catch(i=>{throw this._commonErrorHandler(i,"SfuRestApiClient.createBot")})).id})}deleteBot(e){return H(this,arguments,function*({botId:t}){yield this.http.delete(`/bots/${t}`,{headers:{authorization:`Bearer ${this._token}`}}).catch(n=>{throw this._commonErrorHandler(n,"SfuRestApiClient.deleteBot")})})}startForwarding(e){return H(this,arguments,function*({botId:t,publicationId:n,maxSubscribers:r,contentType:i,publisherId:a}){const o=new Ci,u={publicationId:n,maxSubscribers:r,contentType:i[0].toUpperCase()+i.slice(1),publisherId:a},p=yield this.http.post(`/bots/${t}/forwardings`,u,{headers:{authorization:`Bearer ${this._token}`},retry:h=>H(this,null,function*(){return[400,403,429].includes(h.status)?!1:yield o.wait()})}).catch(h=>{throw this._commonErrorHandler(h,"SfuRestApiClient.startForwarding")});return o.count>0&&fr.warn("success to retry startForwarding",bc({operationName:"SfuRestApiClient.startForwarding",detail:"success to retry startForwarding",botId:t,memberId:a,payload:{publicationId:n,count:o.count}})),p})}createProducer(e){return H(this,arguments,function*({botId:t,forwardingId:n,transportId:r,producerOptions:i}){const a=new Ci,o=yield this.http.put(`/bots/${t}/forwardings/${n}/transports/producers`,{transportId:r,producerOptions:i},{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield a.wait()})}).catch(u=>{throw this._commonErrorHandler(u,"SfuRestApiClient.createProducer")});return a.count>0&&fr.warn("success to retry createProducer",bc({operationName:"SfuRestApiClient.createProducer",detail:"success to retry createProducer",botId:t,payload:{forwardingId:n,transportId:r,count:a.count}})),o})}createConsumer(e){return H(this,arguments,function*({botId:t,forwardingId:n,rtpCapabilities:r,subscriptionId:i,subscriberId:a,spatialLayer:o,originPublicationId:u}){const p=new Ci({times:5,interval:100}),h={rtpCapabilities:r,subscriptionId:i,subscriberId:a,spatialLayer:o,originPublicationId:u},v=yield this.http.post(`/bots/${t}/forwardings/${n}/transports/consumers`,h,{retry:f=>H(this,null,function*(){return[400,403,429].includes(f.status)?!1:yield p.wait()}),headers:{authorization:`Bearer ${this._token}`}}).catch(f=>{throw f.status===429?va({operationName:"SfuRestApiClient.createConsumer",info:Ls.maxSubscriberExceededError,path:fr.prefix,payload:f}):f.status===403?va({operationName:"SfuRestApiClient.createConsumer",info:Ls.notAllowedConsumeError,path:fr.prefix,payload:f}):this._commonErrorHandler(f,"SfuRestApiClient.createConsumer")});return p.count>0&&fr.warn("success to retry createConsumer",bc({operationName:"SfuRestApiClient.createConsumer",detail:"success to retry createConsumer",botId:t,payload:{forwardingId:n,count:p.count}})),fr.debug("response of createConsumer",v),v})}connect(e){return H(this,arguments,function*({transportId:t,dtlsParameters:n}){const r=new Ci,i={transportId:t,dtlsParameters:n},a=yield this.http.put("/transports/connections",i,{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield r.wait()})}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.connect")});return r.count>0&&fr.warn("success to retry connect",bc({operationName:"SfuRestApiClient.connect",detail:"success to retry connect",payload:{transportId:t,count:r.count}})),a})}changeConsumerLayer(e){return H(this,arguments,function*({transportId:t,consumerId:n,spatialLayer:r,publicationId:i}){return yield this.http.put(`transports/consumers/${n}/layers`,{transportId:t,spatialLayer:r,publicationId:i},{headers:{authorization:`Bearer ${this._token}`}}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.changeConsumerLayer")})})}stopForwarding({botId:e,forwardingId:t}){let n=!1;return{promise:this.http.delete(`/bots/${e}/forwardings/${t}`,{headers:{authorization:`Bearer ${this._token}`}}).catch(i=>{throw this._commonErrorHandler(i,"SfuRestApiClient.stopForwarding")}).then(i=>{n=i}),fulfilled:n}}iceRestart(e){return H(this,arguments,function*({transportId:t}){return(yield this.http.put("/transports/connections/ice",{transportId:t},{headers:this._headers}).catch(r=>{throw this._commonErrorHandler(r,"SfuRestApiClient.iceRestart")})).iceParameters})}getRtpCapabilities(e){return H(this,arguments,function*({botId:t,forwardingId:n,originPublicationId:r}){const i=new Ci,a=yield this.http.get(`/bots/${t}/forwardings/${n}/transports/rtp-capabilities?originPublicationId=${r}`,{headers:{authorization:`Bearer ${this._token}`},retry:()=>H(this,null,function*(){return yield i.wait()})}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.getRtpCapabilities")});return i.count>0&&fr.warn("getCapabilities to retry connect",bc({operationName:"SfuRestApiClient.getRtpCapabilities",detail:"getCapabilities to retry connect",botId:t,payload:{forwardingId:n,count:i.count}})),a.rtpCapabilities})}confirmSubscription(e){return H(this,arguments,function*({forwardingId:t,subscriptionId:n,identifierKey:r}){const i={forwardingId:t,subscriptionId:n,identifierKey:r},a=yield this.http.post("/confirm-subscription",i,{headers:{authorization:`Bearer ${this._token}`}}).catch(o=>{throw this._commonErrorHandler(o,"SfuRestApiClient.confirmSubscription")});return fr.debug("response of confirmSubscription",a),a})}},Zt=we(ie({},Ls),{invalidParameter:{name:"invalidParameter",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internal:{name:"internal",detail:"",solution:""},sfuBotNotInChannel:{name:"sfuBotNotInChannel",detail:"SfuBotChannel",solution:"SfuBot"},remotePublisherId:{name:"remotePublisherId",detail:"publisherremotePublicationForwarding",solution:"PublicationLocalPublish"},dataStreamNotSupported:{name:"dataStreamNotSupported",detail:"dataStreamSFU",solution:""},streamNotExistInPublication:{name:"streamNotExistInPublication",detail:"PublicationStreamRemoteMemberPublicationStream",solution:"Publication"},invalidPreferredEncoding:{name:"invalidPreferredEncoding",detail:"preferredEncoding",solution:""},invalidEncodings:{name:"invalidEncodings",detail:"",solution:"PublicationForwarding"},receiverNotFound:{name:"receiverNotFound",detail:"SFURemoteMemberSubscription",solution:"SFUsubscriptionLocalPersonSubscribeSubscription"},consumerNotFound:{name:"consumerNotFound",detail:"SFULocalPersonUnsubscribeSubscription",solution:"Subscription"},forwardingNotFound:{name:"forwardingNotFound",detail:"Forwarding",solution:"Forwarding"},netWorkError:{name:"netWorkError",detail:"",solution:""},confirmSubscriptionFailed:{name:"confirmSubscriptionFailed",detail:"Forwardingconsume",solution:""}});Y();function Wf(e,t){let n=0;for(;n<t.length&&t[n].id!==e;n++);return n}function xa({channel:e,detail:t,operationName:n,payload:r,bot:i}){var a;const o={operationName:n,payload:r,detail:t};return e&&(o.appId=e.appId,o.channelId=e.id,e.localPerson&&(o.memberId=e.localPerson.id)),i&&(o.botId=i.id,o.appId=i.channel.appId,o.channelId=i.channel.id,o.memberId=(a=i.channel.localPerson)==null?void 0:a.id),o}Y();var ei=new Ge("packages/sfu-bot/src/connection/receiver.ts"),lP=class{constructor(e,t,n,r,i,a,o){this.subscription=e,this._api=t,this._transportRepository=n,this._localPerson=r,this._bot=i,this._iceManager=a,this._context=o,this._disposer=new Zr,this.sendSubscriptionStatsReportTimer=null,this._waitingSendSubscriptionStatsReports=[];const u=this._localPerson._analytics;u&&u.onConnectionStateChanged.add(p=>{if(p==="connected"&&this._waitingSendSubscriptionStatsReports.length>0){for(const h of this._waitingSendSubscriptionStatsReports)this.consumer&&this.consumer.id===h&&this.startSendSubscriptionStatsReportTimer();this._waitingSendSubscriptionStatsReports=[]}})}toJSON(){return{transport:this.transport,subscription:this.subscription}}consume(){return H(this,null,function*(){var e,t;let n=this._transportRepository.rtpCapabilities;n||(ei.debug("[start] getCapabilities"),n=yield this._api.getRtpCapabilities({botId:this._bot.id,forwardingId:this.subscription.publication.id,originPublicationId:this.subscription.publication.origin.id}),ei.debug("[end] getCapabilities"),yield this._transportRepository.loadDevice(n).catch(w=>{throw Oe({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:we(ie({},Zt.internal),{detail:"sfu loadDevice failed"}),path:ei.prefix,error:w})}));const r=this.subscription.preferredEncoding?Wf(this.subscription.preferredEncoding,(t=(e=this.subscription.publication.origin)==null?void 0:e.encodings)!=null?t:[]):void 0;ei.debug("[start] createConsumer",{subscription:this.subscription});const{consumerOptions:i,transportOptions:a,transportId:o,producerId:u}=yield this._api.createConsumer({botId:this._bot.id,forwardingId:this.subscription.publication.id,rtpCapabilities:n,subscriptionId:this.subscription.id,subscriberId:this.subscription.subscriber.id,spatialLayer:r,originPublicationId:this.subscription.publication.origin.id});a&&this._transportRepository.createTransport(this._localPerson.id,this._bot,a,"recv",this._iceManager,this._localPerson._analytics),this.transport=this._transportRepository.getTransport(this._localPerson.id,o),this.transport||(ei.warn("transport is under race condition",{transportId:o}),yield this._transportRepository.onTransportCreated.watch(w=>w===o,this._bot.options.endpointTimeout).catch(w=>{throw Oe({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:we(ie({},Zt.timeout),{detail:"receiver sfuTransport not found"}),path:ei.prefix,error:w,payload:{transportOptions:a,transportId:o,producerId:u,consumerOptions:i,subscription:this.subscription}})}),this.transport=this._transportRepository.getTransport(this._localPerson.id,o)),this._localPerson._analytics&&!this._localPerson._analytics.isClosed()&&this._localPerson._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:this.subscription.id,role:"receiver",rtcPeerConnectionId:this.transport.id}),ei.debug("[end] createConsumer"),ei.debug("[start] consume",{consumerOptions:i,subscription:this.subscription});const p=yield this.transport.msTransport.consume(we(ie({},i),{producerId:u})).catch(w=>{throw Oe({operationName:"Receiver.consume",context:this._context,channel:this._localPerson.channel,info:we(ie({},Zt.internal),{detail:"consume failed, maybe subscribing unsupported codec"}),path:ei.prefix,error:w})});this.consumer=p,ei.debug("[end] consume",{subscription:this.subscription});const[h]=p.rtpParameters.codecs,v=Kf(Ko(),p.track,h),f={mimeType:h.mimeType,parameters:h.parameters};this._setupTransportAccessForStream(v,p);const _=this._localPerson._analytics;return _&&!_.isClosed()&&(_.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer():this._waitingSendSubscriptionStatsReports.push(p.id)),{stream:v,codec:f}})}_setupTransportAccessForStream(e,t){const n=this.transport,r=this.pc;e._getTransport=()=>({rtcPeerConnection:r,connectionState:n.connectionState,info:this}),e._getStats=()=>H(this,null,function*(){const i=yield t.getStats();let a=No(i);return a=a.map(o=>(o.sfuTransportId=n.id,o)),a}),this._disposer.push(()=>{e._getTransport=()=>{}}),n.onConnectionStateChanged.add(i=>{ei.debug("transport connection state changed",n.id,i),e._setConnectionState(i)})}unconsume(){if(!this.consumer){ei.debug("unconsume failed, consumer not exist",{subscription:this.subscription});return}this.consumer.close(),this.consumer=void 0,this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer)}close(){this._disposer.dispose()}get pc(){var e;return(e=this.transport)==null?void 0:e.pc}startSendSubscriptionStatsReportTimer(){const e=this._localPerson._analytics;if(e){const t=e.client.getIntervalSec();this.sendSubscriptionStatsReportTimer=setInterval(()=>H(this,null,function*(){if(!e||e.isClosed()){this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer);return}if(this.consumer){const n=yield this.consumer.getStats();n&&e.client.sendSubscriptionStatsReport(n,{subscriptionId:this.subscription.id,role:"receiver",contentType:this.subscription.contentType,createdAt:Date.now()})}}),t*1e3)}}};Y();var _1=Br(Jy());Y();var vu=new Ge("packages/sfu-bot/src/connection/sender.ts"),uP=class{constructor(e){this.props=e,this.state="started",this.configure=this.props.configure,this.originPublication=this.props.originPublication,this.relayingPublication=this.props.relayingPublication,this._identifierKey=this.props.identifierKey,this._api=this.props.api,this._context=this.props.context,this.onStopped=new Qe,this.relayingPublication.onSubscribed.add(t=>H(this,null,function*(){yield this.confirmSubscription(t.subscription).catch(n=>n)})),this.relayingPublication.subscriptions.forEach(t=>H(this,null,function*(){yield this.confirmSubscription(t).catch(n=>n)}))}get id(){return this.relayingPublication.id}_stop(){this.state="stopped",this.onStopped.emit()}toJSON(){return{id:this.id,configure:this.configure,originPublication:this.originPublication,relayingPublication:this.relayingPublication}}confirmSubscription(e){return H(this,null,function*(){vu.debug("[start] Forwarding confirmSubscription");const{message:t}=yield this._api.confirmSubscription({forwardingId:this.id,subscriptionId:e.id,identifierKey:this._identifierKey}).catch(n=>{throw vu.error("Forwarding confirmSubscription failed:",n),Oe({operationName:"Forwarding.confirmSubscription",context:this._context,info:Zt.confirmSubscriptionFailed,path:vu.prefix,payload:n})});vu.debug("[end] Forwarding confirmSubscription",{message:t})})}},on=new Ge("packages/sfu-bot/src/connection/sender.ts"),dP=class{constructor(e,t,n,r,i,a,o,u){this.publication=e,this.channel=t,this._api=n,this._transportRepository=r,this._localPerson=i,this._bot=a,this._iceManager=o,this._context=u,this._disposer=new Zr,this._connectionState="new",this.onConnectionStateChanged=new Qe,this.closed=!1,this.sendSubscriptionStatsReportTimer=null,this._waitingSendSubscriptionStatsReports=[];const p=this._localPerson._analytics;p&&p.onConnectionStateChanged.add(h=>{if(h==="connected"&&this._waitingSendSubscriptionStatsReports.length>0){for(const v of this._waitingSendSubscriptionStatsReports)this._producer&&this._producer.id===v&&this.startSendSubscriptionStatsReportTimer();this._waitingSendSubscriptionStatsReports=[]}})}_setConnectionState(e){this._connectionState!==e&&(on.debug("_setConnectionState",{state:e,forwardingId:this.forwardingId}),this._connectionState=e,this.onConnectionStateChanged.emit(e))}toJSON(){return{forwarding:this.forwarding,broadcasterTransport:this._broadcasterTransport,_connectionState:this._connectionState}}startForwarding(e){return H(this,null,function*(){if(this.publication.contentType==="data")throw Oe({operationName:"Sender.startForwarding",context:this._context,info:Zt.dataStreamNotSupported,path:on.prefix,channel:this.channel});const t=this.publication.stream;if(!t)throw Oe({operationName:"Sender.startForwarding",context:this._context,info:Zt.streamNotExistInPublication,path:on.prefix,channel:this.channel});this.onConnectionStateChanged.add(w=>{var C;on.debug("transport connection state changed",(C=this._broadcasterTransport)==null?void 0:C.id,w),t._setConnectionState(this._bot,w)}).disposer(this._disposer),on.debug("[start] Sender startForwarding",{botId:this._bot.id,publicationId:this.publication.id,contentType:this.publication.contentType,maxSubscribers:e.maxSubscribers});const{forwardingId:n,broadcasterTransportId:r,broadcasterTransportOptions:i,rtpCapabilities:a,identifierKey:o}=yield this._api.startForwarding({botId:this._bot.id,publicationId:this.publication.id,contentType:this.publication.contentType,maxSubscribers:e.maxSubscribers,publisherId:this.publication.publisher.id});if(this.forwardingId=n,i&&(on.debug("sender create new transport",{broadcasterTransportOptions:i}),yield this._transportRepository.loadDevice(a),this._broadcasterTransport=this._transportRepository.createTransport(this._localPerson.id,this._bot,i,"send",this._iceManager,this._localPerson._analytics)),this._broadcasterTransport=this._transportRepository.getTransport(this._localPerson.id,r),!this._broadcasterTransport)throw Oe({operationName:"Sender.startForwarding",context:this._context,info:we(ie({},Zt.internal),{detail:"_broadcasterTransport not found"}),path:on.prefix,channel:this.channel,payload:{broadcasterTransportOptions:i}});this._broadcasterTransport.onConnectionStateChanged.add(w=>{this._setConnectionState(w)}).disposer(this._disposer),this._setConnectionState(this._broadcasterTransport.connectionState);const u=yield this._produce(t,this._broadcasterTransport);this._cleanupStreamCallbacks=this._setupTransportAccessForStream(t,this._broadcasterTransport,u);const p=this._localPerson._analytics;p&&!p.isClosed()&&(p.client.isConnectionEstablished()?this.startSendSubscriptionStatsReportTimer():this._waitingSendSubscriptionStatsReports.push(u.id)),on.debug("[end] Sender startForwarding",{forwardingId:n});let h=this.channel._getPublication(n);h||(h=(yield this.channel.onStreamPublished.watch(w=>w.publication.id===n,this._context.config.rtcApi.timeout).catch(()=>{throw Oe({operationName:"Sender.startForwarding",context:this._context,info:we(ie({},Zt.timeout),{detail:"SfuBotMember onStreamPublished"}),path:on.prefix,channel:this.channel,payload:{forwardingId:n}})})).publication);const v=new uP({configure:e,originPublication:this.publication,relayingPublication:h,api:this._api,context:this._context,identifierKey:o});this.forwarding=v;const f=this.channel.subscriptions.find(w=>w.publication.id===this.publication.id),[_]=u.rtpParameters.codecs;return f.codec=_,this._localPerson._analytics&&this._localPerson._analytics.client.connectionState!=="closed"&&this._localPerson._analytics.client.sendBindingRtcPeerConnectionToSubscription({subscriptionId:f.id,role:"sender",rtcPeerConnectionId:this._broadcasterTransport.id}),_b()&&Gv({stream:t,remoteMember:this._bot.id,end:w=>{const C=w.find(R=>R.id.includes("RTCOutboundRTP")||R.type.includes("outbound-rtp"));return(C==null?void 0:C.keyFramesEncoded)>0},interval:10}).then(()=>H(this,null,function*(){const w=this.publication.encodings;(w==null?void 0:w.length)>0&&(yield jc(u.rtpSender,w).catch(C=>{on.error("_onEncodingsChanged failed",C,this)}))})).catch(w=>{on.error("setEncodingParams waitForLocalStats failed",w,this)}),Gv({stream:t,remoteMember:this._bot.id,end:w=>!!w.find(C=>C.type.includes("local-candidate"))}).then(()=>H(this,null,function*(){const w=yield Pt({operationName:"startForwarding/waitForLocalStats",channel:this.channel});on.debug(w,"forwarding connection connected",{broadcasterTransportId:r})})).catch(()=>{}),v})}_listenStreamEnableChange(e){this._unsubscribeStreamEnableChange&&this._unsubscribeStreamEnableChange();const{removeListener:t}=e._onEnableChanged.add(n=>H(this,null,function*(){yield this._replaceTrack(n).catch(r=>{on.warn(xa({detail:"replaceTrack failed",operationName:"Sender._listenStreamEnableChange",bot:this._bot,payload:r}))})}));this._unsubscribeStreamEnableChange=t}_produce(e,t){return H(this,null,function*(){var n,r,i,a,o,u,p,h;this.publication._onReplaceStream.add(b=>H(this,[b],function*({newStream:x}){if(!this._broadcasterTransport)throw Oe({operationName:"Sender._produce",context:this._context,info:we(ie({},Zt.internal),{detail:"_broadcasterTransport not found"}),path:on.prefix,channel:this.channel});this._listenStreamEnableChange(x),this._cleanupStreamCallbacks&&this._cleanupStreamCallbacks(),this._cleanupStreamCallbacks=this._setupTransportAccessForStream(x,this._broadcasterTransport,S),yield this._replaceTrack(x.track)})).disposer(this._disposer),this._listenStreamEnableChange(e);const v=Ko(),f={track:e.track,stopTracks:!1,appData:{transactionId:v},disableTrackOnPause:!1},_=this.publication.encodings;_&&(f.encodings=_),this.publication._onEncodingsChanged.add(b=>H(this,null,function*(){yield jc(S.rtpSender,b).catch(x=>{on.error("_onEncodingsChanged failed",x,this)})})).disposer(this._disposer);const w=this.publication.codecCapabilities,C=(r=(n=this._transportRepository.rtpCapabilities)==null?void 0:n.codecs)!=null?r:[];on.debug("select codec",{codecCapabilities:w,deviceCodecs:C});const[R]=w.map(b=>b.mimeType.toLowerCase().includes("video")?C.find(M=>{var Z;return!(M.mimeType.toLowerCase()!==b.mimeType.toLowerCase()||Object.keys((Z=b.parameters)!=null?Z:{}).length>0&&!(0,_1.default)(b.parameters,M.parameters))}):C.find(E=>E.mimeType.toLowerCase()===b.mimeType.toLowerCase()));if(on.debug("selected codec",{codec:R}),R){const[b,x]=R.mimeType.split("/");f.codec=we(ie({},R),{mimeType:`${b}/${x.toUpperCase()}`}),e.contentType==="video"&&this._fixVideoCodecWithParametersOrder(R)}else w.length>0&&on.warn("preferred codec not supported",xa({channel:this.channel,detail:"preferred codec not supported",operationName:"Sender._produce",bot:this._bot,payload:{codecCapabilities:w,deviceCodecs:C}}));e.contentType==="audio"&&(((a=(i=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:i.parameters)==null?void 0:a.usedtx)!==!1&&(f.codecOptions=we(ie({},f.codecOptions),{opusDtx:!0})),(u=(o=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:o.parameters)!=null&&u.stereo&&(f.codecOptions=we(ie({},f.codecOptions),{opusStereo:!0})),(h=(p=w.find(M=>M.mimeType.toLowerCase()==="audio/opus"))==null?void 0:p.parameters)!=null&&h.useinbandfec&&(f.codecOptions=we(ie({},f.codecOptions),{opusFec:!0}))),t.onProduce.watch(b=>{var x;return((x=b.producerOptions.appData)==null?void 0:x.transactionId)===v},this._context.config.rtcConfig.timeout).then(b=>H(this,null,function*(){try{const{producerId:x}=yield this._api.createProducer({botId:this._bot.id,transportId:t.id,forwardingId:this.forwardingId,producerOptions:b.producerOptions});b.callback({id:x})}catch(x){b.errback(x)}})).catch(b=>{on.error("onProduce failed",b,this)}),on.debug("[start] msTransport.produce",this);const S=yield t.msTransport.produce(f).catch(b=>{throw Oe({operationName:"Sender._produce",context:this._context,info:we(ie({},Zt.internal),{detail:"msTransport.produce failed"}),path:on.prefix,channel:this.channel,error:b})});return on.debug("[end] msTransport.produce",this),this._producer=S,S})}_fixVideoCodecWithParametersOrder(e){const t=this._broadcasterTransport.msTransport._handler,n=i=>i.mimeType===e.mimeType?e.parameters&&Object.keys(e.parameters).length>0?!!(0,_1.default)(i.parameters,e.parameters):!0:!1,r=(i,a)=>{for(const o of Object.keys(i))o!=="payloadType"&&(i[o]=a[o])};if(t._sendingRtpParametersByKind){const i=t._sendingRtpParametersByKind.video,a=i.codecs.find(n);if(i&&a){const o=JSON.parse(JSON.stringify(i)),[u]=i.codecs,p=JSON.parse(JSON.stringify(u));r(u,a),r(a,p),on.debug("sort _sendingRtpParametersByKind",{origin:o,new:i.codecs})}}if(t._sendingRemoteRtpParametersByKind){const i=t._sendingRemoteRtpParametersByKind.video,a=i.codecs.find(n);if(i&&a){const o=JSON.parse(JSON.stringify(i)),[u]=i.codecs,p=JSON.parse(JSON.stringify(u));r(u,a),r(a,p),on.debug("sort _sendingRemoteRtpParametersByKind",{origin:o,new:i.codecs})}}}_setupTransportAccessForStream(e,t,n){e._getTransportCallbacks[this._bot.id]=()=>({rtcPeerConnection:t.pc,connectionState:t.connectionState,info:this}),e._getStatsCallbacks[this._bot.id]=()=>H(this,null,function*(){if(n.closed)return delete e._getStatsCallbacks[this._bot.id],[];const i=yield n.getStats();let a=No(i);return a=a.map(o=>(o.sfuTransportId=t.id,o)),a});const r=()=>{delete e._getTransportCallbacks[this._bot.id],delete e._getStatsCallbacks[this._bot.id]};return this._disposer.push(()=>{r()}),r}unproduce(){this._producer&&(this._producer.close(),this._producer=void 0,this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer))}_replaceTrack(e){return H(this,null,function*(){var t,n;yield(n=(t=this._producer)==null?void 0:t.replaceTrack)==null?void 0:n.call(t,{track:e}).catch(r=>{throw Oe({operationName:"Sender._replaceTrack",context:this._context,info:Zt.internal,error:r,path:on.prefix,channel:this.channel})})})}close(){this.closed=!0,this._unsubscribeStreamEnableChange&&this._unsubscribeStreamEnableChange(),this._setConnectionState("disconnected"),this._disposer.dispose()}get pc(){var e;return(e=this._broadcasterTransport)==null?void 0:e.pc}startSendSubscriptionStatsReportTimer(){const e=this._localPerson._analytics,t=this._bot.subscriptions.find(n=>n.publication.id===this.publication.id);if(t&&e){const n=e.client.getIntervalSec();this.sendSubscriptionStatsReportTimer=setInterval(()=>H(this,null,function*(){if(!e||e.isClosed()){this.sendSubscriptionStatsReportTimer&&clearInterval(this.sendSubscriptionStatsReportTimer);return}if(this._producer){const r=yield this._producer.getStats();r&&e.client.sendSubscriptionStatsReport(r,{subscriptionId:t.id,role:"sender",contentType:this.publication.contentType,createdAt:Date.now()})}}),n*1e3)}}},ti=new Ge("packages/sfu-bot/src/connection/index.ts"),hP=class{constructor(e,t,n,r,i,a){this._api=e,this.channel=t,this.localPerson=n,this.remoteMember=r,this._transportRepository=i,this._context=a,this.type="sfu",this.onDisconnect=new Qe,this.onClose=new Qe,this.closed=!1,this._receivers={},this._senders={}}addSender(e){const t=new dP(e,this.channel,this._api,this._transportRepository,this.localPerson,this.remoteMember,this.localPerson.iceManager,this._context);return this._senders[e.id]=t,t}removeSender(e){ti.debug("removeSender",e);const t=this._senders[e];t&&t.unproduce()}startSubscribing(e){return H(this,null,function*(){var t;const n=new lP(e,this._api,this._transportRepository,this.localPerson,this.remoteMember,this.localPerson.iceManager,this._context);this._receivers[e.id]=n;const r=ti.debug("[start] _startSubscribing consume"),{stream:i,codec:a}=yield n.consume().catch(o=>{throw ti.error("[failed] _startSubscribing consume",Oe({operationName:"SFUConnection.startSubscribing",context:this._context,channel:this.channel,info:we(ie({},Zt.internal),{detail:"failed to receiver.consume"}),error:o,path:ti.prefix,payload:{subscription:e.toJSON()}})),o});if(ti.elapsed(r,"[end] _startSubscribing consume"),i.setIsEnabled(e.publication.state==="enabled"),e.codec=a,e._setStream(i),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()){const o=e.preferredEncoding,u=(t=e.publication.origin)==null?void 0:t.encodings;if(!o||!u||u.length===0)return;const p=Wf(o,u);this.localPerson._analytics.client.sendSubscriptionUpdatePreferredEncodingReport({subscriptionId:e.id,preferredEncodingIndex:p,updatedAt:Date.now()})}})}stopSubscribing(e){return H(this,null,function*(){const t=this._receivers[e.id];t&&t.unconsume()})}stopPublishing(e){return H(this,null,function*(){this.removeSender(e.id)})}close({reason:e}={}){this.closed||(ti.debug("close sfu connection",{remote:this.remoteMember,local:this.localPerson,reason:e}),this.closed=!0,Object.values(this._senders).forEach(t=>{t.close()}),Object.values(this._receivers).forEach(t=>{t.close()}),this._senders={},this._receivers={},this.onClose.emit())}_getReceiver(e){return this._receivers[e]}changePreferredEncoding(e){return H(this,null,function*(){var t;const n=e.preferredEncoding,r=(t=e.publication.origin)==null?void 0:t.encodings;if(ti.debug("changePreferredEncoding",{preferredEncoding:n,encodings:r,subscription:e}),!n)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Zt.invalidPreferredEncoding,path:ti.prefix,payload:{subscription:e}});if(!r||r.length===0)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Zt.invalidEncodings,path:ti.prefix,payload:{subscription:e}});const i=Wf(n,r),a=this._getReceiver(e.id);if(!a)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Zt.receiverNotFound,path:ti.prefix,payload:{subscription:e}});const o=a.transport;if(!o)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:we(ie({},Zt.internal),{detail:"transport not found"}),path:ti.prefix,payload:{subscription:e}});const u=a.consumer;if(!u)throw Oe({operationName:"SFUConnection.changePreferredEncoding",context:this._context,channel:this.channel,info:Zt.consumerNotFound,path:ti.prefix,payload:{subscription:e}});yield this._api.changeConsumerLayer({transportId:o.id,consumerId:u.id,publicationId:e.publication.id,spatialLayer:i}),this.localPerson._analytics&&!this.localPerson._analytics.isClosed()&&this.localPerson._analytics.client.sendSubscriptionUpdatePreferredEncodingReport({subscriptionId:e.id,preferredEncodingIndex:i,updatedAt:Date.now()})})}};Y();Y();var pP=10,mr=new Ge("packages/sfu-bot/src/member.ts"),Eb=class Pb extends uh{constructor(t){super(t),this.side="remote",this.subtype=Pb.subtype,this.type="bot",this._connections={},this.onForwardingStarted=new Qe,this.onForwardingStopped=new Qe,this.onForwardingListChanged=new Qe,this._startForwardQueue=new ca,this._forwardings={},this.stopForwarding=n=>new Promise((r,i)=>H(this,null,function*(){const a=mr.info("[start] stopForwarding",yield Pt({operationName:"SfuBotMember.stopForwarding",channel:this.channel}));if(this.state!=="joined"){i(Oe({operationName:"SfuBotMember.stopForwarding",context:this._context,info:Zt.sfuBotNotInChannel,path:mr.prefix,channel:this.channel,payload:{status:this.state}}));return}const o=typeof n=="string"?n:n.id,u=this._forwardings[o];if(!u){i(Oe({operationName:"SfuBotMember.stopForwarding",context:this._context,info:Zt.forwardingNotFound,path:mr.prefix,channel:this.channel,payload:{forwardingId:o,_forwardings:Object.keys(this._forwardings)}}));return}delete this._forwardings[u.id];const{promise:p,fulfilled:h}=this._api.stopForwarding({botId:this.id,forwardingId:o});let v=!1;p.catch(f=>{v=!0,i(f)}),this.onForwardingStopped.watch(f=>f.forwarding.id===o,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){mr.elapsed(a,"[end] stopForwarding",yield Pt({operationName:"SfuBotMember.stopForwarding",channel:this.channel})),r()})).catch(f=>{v||i(Oe({operationName:"SfuBotMember.stopForwarding",context:this._context,info:we(ie({},Zt.timeout),{detail:"onForwardingStopped"}),path:mr.prefix,channel:this.channel,payload:{fulfilled:h},error:f}))})})),this._api=t.api,this._context=t.context,this._transportRepository=t.transportRepository,this.options=t.options,this.onLeft.once(()=>{mr.debug("SfuBotMember left: ",{id:this.id}),Object.values(this._connections).forEach(n=>{n.close({reason:"sfu bot left"})}),this._connections={}})}get forwardings(){return Object.values(this._forwardings)}_getConnection(t){return this._connections[t]}_getOrCreateConnection(t){var n;return(n=this._getConnection(t.id))!=null?n:this._createConnection(this.channel,t,this)}_createConnection(t,n,r){const i=new hP(r._api,t,n,r,this._transportRepository,this._context);return i.onClose.once(()=>{delete this._connections[n.id]}),this._connections[n.id]=i,i}startForwarding(t){return H(this,arguments,function*(n,r={}){const i=mr.info("[start] startForwarding",yield Pt({operationName:"SfuBotMember.startForwarding",channel:this.channel})),a=yield this._startForwardQueue.push(()=>this._startForwarding(n,r));return mr.elapsed(i,"[end] startForwarding",yield Pt({operationName:"SfuBotMember.startForwarding",channel:this.channel})),a})}_startForwarding(t,n){return H(this,null,function*(){if(n.maxSubscribers==null&&(n.maxSubscribers=pP),this.state!=="joined")throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:Zt.sfuBotNotInChannel,path:mr.prefix,payload:{status:this.state}});if(!this.channel._getPublication(t.id))throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:Ve.publicationNotExist,path:mr.prefix});const r=this.channel.localPerson;if(!r)throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,channel:this.channel,info:Ve.localPersonNotJoinedChannel,path:mr.prefix});if(r.id!==t.publisher.id)throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,info:Zt.remotePublisherId,path:mr.prefix,channel:this.channel});const i=mr.debug("[start] SfuBotMember startForwarding",{publication:t.toJSON(),configure:n}),u=yield this._getOrCreateConnection(r).addSender(t).startForwarding(n).catch(p=>{throw Oe({operationName:"SfuBotMember._startForwarding",context:this._context,info:we(ie({},Zt.internal),{detail:"[failed] SfuBotMember startForwarding"}),path:mr.prefix,channel:this.channel,error:p,payload:{publication:t.toJSON()}})});return this._forwardings[u.id]=u,this.listenStopForwardEvent(u),this.onForwardingStarted.emit({forwarding:u}),this.onForwardingListChanged.emit(),mr.elapsed(i,"[end] SfuBotMember startForwarding",{forwarding:u.toJSON()}),u})}listenStopForwardEvent(t){const{removeListener:n}=this.channel.onStreamUnpublished.add(r=>{if(r.publication.id===t.id){n(),t._stop();const i=t.originPublication,a=this._getConnection(i.publisher.id);a&&a.removeSender(i.id),this.onForwardingStopped.emit({forwarding:t}),this.onForwardingListChanged.emit()}})}_dispose(){}};Eb.subtype="sfu";var Na=Eb;Y();var fP=we(ie({},Cb),{endpointTimeout:3e4,ackTimeout:1e4,disableRestartIce:!1});Y();Y();var b1=Br(Q3());Y();var Zn=new Ge("packages/sfu-bot/src/connection/transport/transport.ts"),mP=class{constructor(e,t,n,r,i,a){this.msTransport=e,this._bot=t,this._iceManager=n,this._sfuApi=r,this._context=i,this._analyticsSession=a,this._backoffIceRestart=new Ci({times:8,interval:100,jitter:100}),this._connectionState="new",this.onProduce=new Qe,this.onProduceData=new Qe,this.onMediasoupConnectionStateChanged=new Qe,this.onConnectionStateChanged=new Qe,this.restartIce=()=>H(this,null,function*(){if(this._backoffIceRestart.exceeded){Zn.error("_iceRestartedCount exceeded",Oe({operationName:"SfuTransport.restartIce",context:this._context,info:Zt.netWorkError,path:Zn.prefix})),this._setConnectionState("disconnected");return}Zn.warn("[start] restartIce",xa({bot:this._bot,detail:"start restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}}));const v=()=>{if(this._bot.state==="left")return Zn.debug("bot already left",this),this._setConnectionState("disconnected"),Zn.warn("[end] restartIce",xa({bot:this._bot,detail:"end restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}})),!0;if(this.msTransport.connectionState==="connected")return this._backoffIceRestart.reset(),this._setConnectionState("connected"),Zn.warn("[end] restartIce",xa({bot:this._bot,detail:"end restartIce",operationName:"SfuTransport.restartIce",payload:{count:this._backoffIceRestart.count,transport:this}})),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"restartIce",data:void 0,createdAt:Date.now()}),!0};if(this._setConnectionState("reconnecting"),yield this._backoffIceRestart.wait(),v())return;let f=yield this._iceManager.updateIceParams().catch(w=>w);if(f){Zn.warn("updateIceParams failed",xa({operationName:"SfuTransport.restartIce",detail:"updateIceParams failed",bot:this._bot,payload:{transport:this}}),f),yield this.restartIce();return}if(yield this.msTransport.updateIceServers({iceServers:this._iceManager.iceServers}),v())return;const _=yield this._mediasoupRestartIce();if(f=yield this._waitForMsConnectionState("connected",this._context.config.rtcConfig.iceDisconnectBufferTimeout).catch(w=>w),!f&&v())return _;yield this.restartIce()}),this._waitForMsConnectionState=(v,f=1e4)=>H(this,null,function*(){v!==this.msTransport.connectionState&&(yield this.onMediasoupConnectionStateChanged.watch(()=>v===this.msTransport.connectionState,f).catch(_=>{throw Oe({operationName:"SfuTransport._waitForMsConnectionState",context:this._context,info:we(ie({},Zt.timeout),{detail:"waitForConnectionState timeout"}),error:_,path:Zn.prefix})}))}),this._onConnect=v=>(f,_,w)=>H(this,[f,_,w],function*({dtlsParameters:C},R,S){try{Zn.debug("[start] transport connect",{transportId:v}),yield this._sfuApi.connect({transportId:v,dtlsParameters:C}),Zn.debug("[end] transport connect",{transportId:v}),R()}catch(b){Zn.error("[failed] transport connect",{error:b,transportId:v}),S(b)}});var o,u,p;const h=i.plugins.find(v=>v.subtype===dh.subtype);this._options=h.options,Zn.debug("peerConfig",(p=(u=(o=this.pc)==null?void 0:o.getConfiguration)==null?void 0:u.call(o))!=null?p:{}),e.on("connect",(v,f,_)=>this._onConnect(e.id)(v,f,_)),e.on("connectionstatechange",v=>{this.onMediasoupConnectionStateChanged.emit(v),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"connectionStateChange",data:{connectionState:v},createdAt:Date.now()})}),e.on("produce",(v,f,_)=>{this.onProduce.emit({producerOptions:v,callback:f,errback:_})}),e.on("producedata",(v,f,_)=>{this.onProduceData.emit({producerOptions:v,callback:f,errback:_})}),this.onMediasoupConnectionStateChanged.add(v=>H(this,null,function*(){switch(Pt({operationName:"onMediasoupConnectionStateChanged",channel:this._bot.channel}).then(f=>{Zn.debug(f,{state:v,transportId:this.id,bot:t})}).catch(()=>{}),v){case"disconnected":case"failed":{if(this._connectionState==="reconnecting")return;(yield this._waitForMsConnectionState("connected",i.config.rtcConfig.iceDisconnectBufferTimeout).catch(_=>_))&&this._connectionState!=="reconnecting"&&t.options.disableRestartIce!==!0&&(yield this.restartIce())}break;case"connecting":case"connected":this._setConnectionState(v);break;case"closed":this._setConnectionState("disconnected");break}Zn.debug("onMediasoupConnectionStateChanged",this)}))}get pc(){var e,t,n;return(n=(t=(e=this.msTransport)==null?void 0:e._handler)==null?void 0:t._pc)!=null?n:{}}get id(){return this.msTransport.id}get connectionState(){return this._connectionState}toJSON(){return{id:this.id,direction:this.msTransport.direction,connectionState:this._connectionState}}close(){var e;Zn.debug("close",this.id),(e=this.pc)!=null&&e.peerIdentity&&this.pc.peerIdentity.catch(()=>{}),this.msTransport.close(),this._setConnectionState("disconnected")}_setConnectionState(e){this._connectionState!==e&&(Zn.debug("onConnectionStateChanged",this._connectionState,e,this),this._connectionState=e,this.onConnectionStateChanged.emit(e),this._analyticsSession&&!this._analyticsSession.isClosed()&&this._analyticsSession.client.sendRtcPeerConnectionEventReport({rtcPeerConnectionId:this.id,type:"skywayConnectionStateChange",data:{skywayConnectionState:e},createdAt:Date.now()}))}_mediasoupRestartIce(){return H(this,null,function*(){const e=yield this._sfuApi.iceRestart({transportId:this.id}).catch(t=>t);if(e instanceof Error){Zn.warn("iceRestart failed",xa({operationName:"SfuTransport._mediasoupRestartIce",detail:"iceRestart failed",bot:this._bot,payload:{transport:this}}),e),yield this.restartIce();return}return yield this.msTransport.restartIce({iceParameters:e}),e})}},Rp=new Ge("packages/sfu-bot/src/connection/transport/transportRepository.ts"),gP=class{constructor(e,t){this._context=e,this._api=t,this.onTransportCreated=new Qe,this._transports={},this.getTransport=(i,a)=>this._transports[i+a];const{browserName:n,browserVersion:r}=O_();Rp.debug("runtime info",{browserName:n,browserVersion:r}),n==="Safari"&&r==null?this._device=new b1.Device({handlerName:"Safari12"}):this._device=new b1.Device}get rtpCapabilities(){if(this._device.loaded)return this._device.rtpCapabilities}loadDevice(e){return H(this,null,function*(){this._device.loaded||(yield this._device.load({routerRtpCapabilities:e}).catch(t=>{throw Oe({operationName:"TransportRepository.loadDevice",context:this._context,info:we(ie({},Zt.internal),{detail:"loadDevice failed"}),path:Rp.prefix,payload:{rtpCapabilities:e},error:t})}),Rp.debug("device loaded",{routerRtpCapabilities:e,rtpCapabilities:this._device.rtpCapabilities}))})}createTransport(e,t,n,r,i,a){const u=(r==="send"?h=>this._device.createSendTransport(h):h=>this._device.createRecvTransport(h))(we(ie({},n),{iceServers:i.iceServers,iceTransportPolicy:this._context.config.rtcConfig.turnPolicy==="turnOnly"?"relay":void 0,additionalSettings:this._context.config.rtcConfig})),p=new mP(u,t,i,this._api,this._context,a);return this._transports[e+u.id]=p,this.onTransportCreated.emit(u.id),p}deleteTransports(e){Object.entries(ie({},this._transports)).forEach(([t,n])=>{t.includes(e)&&(n.close(),delete this._transports[t])})}};Y();var vP="1.14.2",ya=new Ge("packages/sfu-bot/src/plugin.ts"),kb=class Tb extends ig{constructor(t={}){super(),this.subtype=Tb.subtype,this._createRemoteMember=(n,r)=>new Na(we(ie({},this._context),{channel:n,id:r.id,name:r.name,metadata:r.metadata,plugin:this,api:this._api,context:this._context,transportRepository:this._transportRepository,options:this.options})),this.createBot=n=>H(this,null,function*(){var r;const i=ya.info("[start] createBot",yield Pt({operationName:"SfuBotPlugin.createBot",channel:n})),a=this._context.authToken.getAppId(),o=yield this._api.createBot({appId:a,channelId:n.id}),u=(r=n._getMember(o))!=null?r:(yield n.onMemberJoined.watch(p=>p.member.id===o,this._context.config.rtcApi.timeout).catch(p=>{throw Oe({operationName:"SfuBotPlugin.createBot",info:we(ie({},Zt.timeout),{detail:"onMemberJoined"}),path:ya.prefix,error:p,context:this._context})})).member;return ya.elapsed(i,"[end] createBot",yield Pt({operationName:"SfuBotPlugin.createBot",channel:n})),u}),this.deleteBot=(n,r)=>H(this,null,function*(){return new Promise((i,a)=>H(this,null,function*(){const o=ya.info("[start] deleteBot",yield Pt({operationName:"SfuBotPlugin.deleteBot",channel:n}));let u=!1;this._api.deleteBot({botId:r}).catch(p=>{u=!0,a(p)}),n.onMemberLeft.watch(p=>p.member.id===r,this._context.config.rtcApi.timeout).then(()=>H(this,null,function*(){ya.elapsed(o,"[end] deleteBot",yield Pt({operationName:"SfuBotPlugin.deleteBot",channel:n})),i()})).catch(p=>{u||a(Oe({operationName:"SfuBotPlugin.deleteBot",info:we(ie({},Zt.timeout),{detail:"onMemberLeft"}),path:ya.prefix,channel:n,error:p,context:this._context}))})}))}),this.options=ie(ie({},fP),t),this._onContextAttached.once(n=>{Ge.level=n.config.log.level,Ge.format=n.config.log.format,ya.info("SfuBotPlugin spawned",{operationName:"SfuBotPlugin.constructor",endpoint:{sfu:this.options.domain},options:this.options,sdkName:"sfu-bot",sdkVersion:vP}),this._api=new cP(n.authTokenString,we(ie({},this.options),{log:n.config.log})),this._transportRepository=new gP(n,this._api),n._onTokenUpdated.add(r=>{this._api.updateToken(r)})}),this._whenDisposeLocalPerson=n=>H(this,null,function*(){this._transportRepository.deleteTransports(n.id)})}};kb.subtype=Na.subtype;var dh=kb,yP={invalidParameter:{name:"invalidParameter",detail:"",solution:""},timeout:{name:"timeout",detail:"",solution:""},internal:{name:"internal",detail:"",solution:""},notImplemented:{name:"notImplemented",detail:"RoomType",solution:"RoomType"},roomNotOpened:{name:"roomNotOpened",detail:"RoomOpen",solution:"Room"},subscribeOtherMemberType:{name:"subscribeOtherMemberType",detail:"RemoteMemberSubscribe/UnsubscribeMemberTypePerson",solution:"RemoteMember"},sfuRoomNotSupportDataStream:{name:"sfuRoomNotSupportDataStream",detail:"SFURoomDataStream",solution:""},publicationNotHasOrigin:{name:"publicationNotHasOrigin",detail:"SfuRoomPublicationOrigin",solution:"SfuRoomP2PRoomID"},notFound:{name:"notFound",detail:"",solution:""}},Sr=ie(ie(ie({},Ve),Zt),yP);Y();var Rb=class{constructor(e,t){this.member=e,this.room=t,this.onLeft=new Qe;const{removeListener:n}=t.onMemberLeft.add(r=>{r.member.id===this.member.id&&(n(),this.onLeft.emit())});this.onMetadataUpdated=e.onMetadataUpdated}get id(){return this.member.id}get name(){return this.member.name}get roomId(){return this.room.id}get roomName(){return this.room.name}get roomType(){return this.room.type}get state(){return this.member.state}get metadata(){return this.member.metadata}get _member(){return this.member}get publications(){return this.room.publications.filter(e=>e.publisher.id===this.id)}get subscriptions(){return this.member.subscriptions.map(e=>this.room._getSubscription(e.id))}updateMetadata(e){return this.member.updateMetadata(e)}leave(){return this.member.leave()}toJSON(){return{id:this.id,name:this.name,metadata:this.metadata}}};Y();var Ab=class extends Rb{constructor(e,t){super(e,t),this.side="local",this._local=this._member,this.onStreamPublished=new Qe,this.onStreamUnpublished=new Qe,this.onPublicationListChanged=new Qe,this.onPublicationSubscribed=new Qe,this.onPublicationUnsubscribed=new Qe,this.onSubscriptionListChanged=new Qe,this.onFatalError=new Qe,this._context=this.room._context,this._local.onPublicationSubscribed.add(n=>H(this,null,function*(){const r=t._addSubscription(n.subscription);this.onPublicationSubscribed.emit({subscription:r,stream:n.stream})})),this._local.onFatalError.pipe(this.onFatalError),this._listenRoomEvent(),this.onStreamPublished.add(()=>this.onPublicationListChanged.emit()),this.onStreamUnpublished.add(()=>this.onPublicationListChanged.emit()),this.onPublicationSubscribed.add(()=>this.onSubscriptionListChanged.emit()),this.onPublicationUnsubscribed.add(()=>this.onSubscriptionListChanged.emit())}get subscriptions(){return this.member.subscriptions.map(e=>this.room._getSubscription(e.id)).filter(e=>e.stream)}_listenRoomEvent(){this.room.onPublicationUnsubscribed.add(e=>{e.subscription.subscriber._member.id===this._local.id&&this.onPublicationUnsubscribed.emit(e)})}};Y();Y();function br({operationName:e,context:t,info:n,error:r,path:i,payload:a,room:o}){const u={operationName:e,payload:a};return o&&(u.appId=o._channel.appId,u.roomId=o.id,o.localRoomMember&&(u.memberId=o.localRoomMember.id)),t&&(u.info=t.info,u.plugins=t.plugins.map(p=>p.subtype)),new _r({error:r,info:n,payload:u,path:i})}var Sc=new Ge("packages/room/src/member/local/p2p.ts"),_P=class extends Ab{constructor(e,t){super(e,t)}publish(e){return H(this,arguments,function*(t,n={}){const r=yield this._local.publish(t,n),i=this.room._addPublication(r);return this.onStreamPublished.emit({publication:i}),i})}unpublish(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unpublish(t).catch(r=>{Sc.error("unpublish",r,{target:e},this.toJSON())});const{publication:n}=yield this.room.onStreamUnpublished.watch(r=>r.publication.id===t,this._context.config.rtcApi.timeout).catch(r=>{throw br({operationName:"LocalP2PRoomMemberImpl.unpublish",context:this._context,room:this.room,info:we(ie({},Sr.timeout),{detail:"onStreamUnpublished"}),path:Sc.prefix,error:r})});this.onStreamUnpublished.emit({publication:n})})}subscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id,{subscription:n,stream:r}=yield this._local.subscribe(t);return{subscription:this.room._addSubscription(n),stream:r}})}unsubscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unsubscribe(t).catch(n=>{Sc.error("unsubscribe",n,{target:e},this.toJSON())}),yield this.room.onPublicationUnsubscribed.watch(n=>n.subscription.id===t,this._context.config.rtcApi.timeout).catch(n=>{throw br({operationName:"LocalP2PRoomMemberImpl.unsubscribe",context:this._context,room:this.room,info:we(ie({},Sr.timeout),{detail:"onPublicationUnsubscribed"}),path:Sc.prefix,error:n})})})}_updateRoom(e){Sc.debug("_updateRoom",{memberId:this.id}),this.room=e,this._listenRoomEvent()}};Y();Y();var bP=10,Ns=new Ge("packages/room/src/member/local/sfu.ts"),SP=class extends Ab{constructor(e,t){super(e,t)}publish(e){return H(this,arguments,function*(t,n={}){var r;if(t instanceof ng)throw br({operationName:"LocalSFURoomMemberImpl.publish",context:this._context,room:this.room,info:Sr.sfuRoomNotSupportDataStream,path:Ns.prefix});n.maxSubscribers=(r=n.maxSubscribers)!=null?r:bP;const i=yield this._local.publish(t,n),a=this.room._channel.members.find(h=>h.subtype===Na.subtype);if(!a)throw br({operationName:"LocalSFURoomMemberImpl.publish",context:this._context,room:this.room,info:Zt.sfuBotNotInChannel,path:Ns.prefix});const u=(yield a.startForwarding(i,{maxSubscribers:n.maxSubscribers})).relayingPublication,p=this.room._addPublication(u);return this.onStreamPublished.emit({publication:p}),p})}unpublish(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id,n=this.room._getPublication(t),r=n._publication.origin;if(!r)throw br({operationName:"LocalSFURoomMemberImpl.unpublish",context:this._context,room:this.room,info:Sr.publicationNotHasOrigin,path:Ns.prefix});this._local.unpublish(r.id).catch(i=>{Ns.error("unpublish error",i,{target:e},this.toJSON())}),yield this.room.onStreamUnpublished.watch(i=>i.publication.id===t,this._context.config.rtcApi.timeout).catch(i=>{throw br({operationName:"LocalSFURoomMemberImpl.unpublish",context:this._context,room:this.room,info:we(ie({},Sr.timeout),{detail:"onStreamUnpublished"}),path:Ns.prefix,error:i})}),this.onStreamUnpublished.emit({publication:n})})}subscribe(e,t){return H(this,null,function*(){const n=typeof e=="string"?e:e.id,{subscription:r,stream:i}=yield this._local.subscribe(n,t);return{subscription:this.room._addSubscription(r),stream:i}})}unsubscribe(e){return H(this,null,function*(){const t=typeof e=="string"?e:e.id;this._local.unsubscribe(t).catch(n=>{Ns.error("unsubscribe error",n,{target:e},this.toJSON())}),yield this.room.onPublicationUnsubscribed.watch(n=>n.subscription.id===t,this._context.config.rtcApi.timeout).catch(n=>{throw br({operationName:"LocalSFURoomMemberImpl.unsubscribe",context:this._context,room:this.room,info:we(ie({},Sr.timeout),{detail:"onPublicationUnsubscribed"}),path:Ns.prefix,error:n})})})}_updateRoom(e){Ns.debug("_updateRoom",{memberId:this.id}),this.room=e,this._listenRoomEvent()}};Y();var S1=new Ge("packages/room/src/member/remote/base.ts"),Pd=class extends Rb{constructor(e,t){super(e,t),this.side="remote",this.onPublicationSubscribed=new Qe,this.onPublicationUnsubscribed=new Qe,this.onSubscriptionListChanged=new Qe,this.onPublicationListChanged=new Qe,this._disposer=new Zr,this.subscribe=n=>new Promise((r,i)=>{if(!(this.member instanceof Hu)){i(br({operationName:"RemoteRoomMemberImpl.subscribe",context:this.room._context,room:this.room,info:Sr.subscribeOtherMemberType,path:S1.prefix}));return}let a=!1;this.member.subscribe(n).catch(o=>{a=!0,i(o)}),this.onPublicationSubscribed.watch(o=>o.subscription.publication.id===n).then(o=>r(o)).catch(o=>{a||i(o)})}),this.unsubscribe=n=>new Promise((r,i)=>{if(!(this.member instanceof Hu)){i(br({operationName:"RemoteRoomMemberImpl.unsubscribe",context:this.room._context,room:this.room,info:Sr.subscribeOtherMemberType,path:S1.prefix}));return}let a=!1;this.member.unsubscribe(n).catch(o=>{a=!0,i(o)}),this.onPublicationUnsubscribed.watch(o=>o.subscription.id===n).then(()=>r()).catch(o=>{a||i(o)})}),t.onPublicationSubscribed.add(n=>{n.subscription.subscriber._member.id===e.id&&(this.onPublicationSubscribed.emit(n),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),t.onPublicationUnsubscribed.add(n=>{n.subscription.subscriber._member.id===e.id&&(this.onPublicationUnsubscribed.emit(n),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),e instanceof Hu&&e.onPublicationListChanged.pipe(this.onPublicationListChanged).disposer(this._disposer)}_dispose(){this._disposer.dispose()}};Y();var Vu="packages/room/src/publication/index.ts",w1=new Ge(Vu),wP=class{constructor(e,t){this._publication=e,this._room=t,this._disposer=new Zr,this._events=new Qi,this.onCanceled=this._events.make(),this.onSubscribed=this._events.make(),this.onUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onEnabled=this._events.make(),this.onDisabled=this._events.make(),this.onStateChanged=this._events.make(),this.onConnectionStateChanged=new Qe,this.enable=()=>new Promise((r,i)=>{if(this.state==="enabled"){r();return}this._origin?Promise.all([this._origin.enable(),this._publication.onEnabled.asPromise()]).then(()=>r()).catch(i):this._publication.enable().then(r).catch(i)}),this.disable=()=>new Promise((r,i)=>{if(this.state==="disabled"){r();return}this._origin?Promise.all([this._origin.disable(),this._publication.onDisabled.asPromise()]).then(()=>r()).catch(i):this._publication.disable().then(r).catch(i)}),this.replaceStream=(r,i={})=>{this._preferredPublication.replaceStream(r,i)};var n;this.id=e.id,this.contentType=e.contentType,this._origin=e.origin;{const r=(n=this._origin)!=null?n:this._publication;this.publisher=this._room._getMember(r.publisher.id)}this._setEvents()}_setEvents(){var e;this._room.onStreamUnpublished.add(t=>{t.publication.id===this.id&&this._dispose()}),this._room.onPublicationSubscribed.add(t=>{t.subscription.publication.id===this.id&&(this.onSubscribed.emit({subscription:t.subscription}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this._room.onPublicationUnsubscribed.add(t=>{t.subscription.publication.id===this.id&&(this.onUnsubscribed.emit({subscription:t.subscription}),this.onSubscriptionListChanged.emit())}).disposer(this._disposer),this._publication.onEnabled.pipe(this.onEnabled),this._publication.onDisabled.pipe(this.onDisabled),this._publication.onStateChanged.pipe(this.onStateChanged),((e=this._origin)!=null?e:this._publication).onMetadataUpdated.pipe(this.onMetadataUpdated),this._origin?this._origin.onConnectionStateChanged.add(t=>{w1.debug("this._origin.onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit({state:t.state})}):this._publication.onConnectionStateChanged.add(t=>{w1.debug("this._publication.onConnectionStateChanged",this.id,t),this.onConnectionStateChanged.emit({state:t.state,remoteMember:this._room._getMember(t.remoteMember.id)})})}get subscriptions(){return this._publication.subscriptions.map(e=>this._room._getSubscription(e.id))}get _preferredPublication(){var e;return(e=this._origin)!=null?e:this._publication}get codecCapabilities(){return this._preferredPublication.codecCapabilities}get encodings(){return this._preferredPublication.encodings}get stream(){return this._preferredPublication.stream}get state(){return this._preferredPublication.state}get metadata(){return this._preferredPublication.metadata}cancel(){return H(this,null,function*(){yield Promise.all([this._preferredPublication.cancel(),this.onCanceled.asPromise()])})}updateMetadata(e){return H(this,null,function*(){yield this._preferredPublication.updateMetadata(e)})}updateEncodings(e){this._preferredPublication.updateEncodings(e)}_dispose(){this.onCanceled.emit(),this._events.dispose(),this._disposer.dispose()}getStats(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Na.subtype))==null?void 0:t.subscriber;if(!n)throw br({operationName:"RoomPublicationImpl.getStats",room:this._room,path:Vu,info:we(ie({},Sr.notFound),{detail:"bot not found"})});return this._origin.getStats(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getStats(n)}}getRTCPeerConnection(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Na.subtype))==null?void 0:t.subscriber;if(!n)throw br({operationName:"RoomPublicationImpl.getRTCPeerConnection",room:this._room,path:Vu,info:we(ie({},Sr.notFound),{detail:"bot not found"})});return this._origin.getRTCPeerConnection(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getRTCPeerConnection(n)}}getConnectionState(e){var t;if(this._origin){const n=(t=this._origin.subscriptions.find(r=>r.subscriber.subtype===Na.subtype))==null?void 0:t.subscriber;if(!n)throw br({operationName:"RoomPublicationImpl.getConnectionState",room:this._room,path:Vu,info:we(ie({},Sr.notFound),{detail:"bot not found"})});return this._origin.getConnectionState(n)}else{const n=typeof e=="string"?e:e.id;return this._publication.getConnectionState(n)}}toJSON(){return{id:this.id,contentType:this.contentType,metadata:this.metadata,publisher:this.publisher,subscriptions:this.subscriptions,codecCapabilities:this.codecCapabilities,encodings:this.encodings,state:this.state}}};Y();Y();var xP="1.15.1";Y();Y();Y();var Ap=new Ge("packages/room/src/subscription/index.ts"),CP=class{constructor(e,t){this._subscription=e,this._room=t,this._context=this._room._context,this.onStreamAttached=new Qe,this.onCanceled=new Qe,this.onConnectionStateChanged=new Qe,this.id=e.id,this.contentType=e.contentType,this.publication=this._room._getPublication(e.publication.id),this.subscriber=this._room._getMember(e.subscriber.id),e.onStreamAttached.pipe(this.onStreamAttached),e.onCanceled.pipe(this.onCanceled),e.onConnectionStateChanged.add(n=>{Ap.debug("_subscription.onConnectionStateChanged",this.id,n),this.onConnectionStateChanged.emit(n)})}get stream(){return this._subscription.stream}get state(){return this._subscription.state}get codec(){return this._subscription.codec}get preferredEncoding(){return this._subscription.preferredEncoding}changePreferredEncoding(e){this._subscription.changePreferredEncoding(e)}cancel(){return H(this,null,function*(){this._subscription.cancel().catch(e=>{Ap.error("subscription.cancel",e,this.toJSON())}),yield this._room.onPublicationUnsubscribed.watch(e=>e.subscription.id===this.id,this._context.config.rtcApi.timeout).catch(e=>{throw br({operationName:"RoomSubscriptionImpl.cancel",context:this._context,room:this._room,info:we(ie({},Sr.timeout),{detail:"onPublicationUnsubscribed"}),error:e,path:Ap.prefix})})})}toJSON(){return{id:this.id,contentType:this.contentType,publication:this.publication,codec:this.codec}}getStats(){return this._subscription.getStats()}getRTCPeerConnection(){return this._subscription.getRTCPeerConnection()}getConnectionState(){return this._subscription.getConnectionState()}},x1=new Ge("packages/room/src/room/base.ts"),Ib=class{constructor(e,t){this._channel=t,this._members={},this._publications={},this._subscriptions={},this._context=this._channel._context,this._events=new Qi,this.onClosed=this._events.make(),this.onMetadataUpdated=this._events.make(),this.onMemberJoined=this._events.make(),this.onMemberLeft=this._events.make(),this.onMemberListChanged=this._events.make(),this.onMemberMetadataUpdated=this._events.make(),this.onStreamPublished=this._events.make(),this.onStreamUnpublished=this._events.make(),this.onPublicationListChanged=this._events.make(),this.onPublicationMetadataUpdated=this._events.make(),this.onPublicationEnabled=this._events.make(),this.onPublicationDisabled=this._events.make(),this.onPublicationSubscribed=this._events.make(),this.onPublicationUnsubscribed=this._events.make(),this.onSubscriptionListChanged=this._events.make(),this.type=e,this._channel.onClosed.pipe(this.onClosed),this._channel.onMetadataUpdated.pipe(this.onMetadataUpdated),this._channel.onMemberMetadataUpdated.add(n=>{this._handleOnMemberMetadataUpdate(n)})}_getMember(e){return this._members[e]}_getPublication(e){return this._publications[e]}_addPublication(e){const t=this._publications[e.id];if(t)return t;const n=new wP(e,this);return this._publications[e.id]=n,n}_getSubscription(e){return this._subscriptions[e]}_addSubscription(e){const t=this._subscriptions[e.id];if(t)return t;const n=new CP(e,this);return this._subscriptions[e.id]=n,n}get id(){return this._channel.id}get name(){return this._channel.name}get metadata(){return this._channel.metadata}get state(){return this._channel.state}get disposed(){return this._channel.disposed}_handleOnMemberMetadataUpdate(e){const t=this._getMember(e.member.id);this.onMemberMetadataUpdated.emit({member:t,metadata:e.metadata})}get members(){return Object.values(this._members)}get publications(){return Object.values(this._publications)}get subscriptions(){return Object.values(this._subscriptions)}joinChannel(){return H(this,arguments,function*(e={}){var t;if(this.state!=="opened")throw br({operationName:"RoomImpl.joinChannel",context:this._context,room:this,info:Sr.roomNotOpened,path:x1.prefix});e.name=(t=e.name)!=null?t:Oi();const n=yield this._channel.join(e);return this._getMember(n.id)||(yield this.onMemberJoined.watch(r=>r.member._member.id===n.id,this._context.config.rtcApi.timeout).catch(r=>{throw br({operationName:"RoomImpl.joinChannel",context:this._context,room:this,info:we(ie({},Sr.timeout),{detail:"RoomImpl onMemberJoined"}),path:x1.prefix,error:r})})),n})}leave(e){return H(this,null,function*(){yield this._channel.leave(e._member)})}moveRoom(e){return H(this,null,function*(){return yield this._channel.moveChannel(e._local),e._updateRoom(this),e})}updateMetadata(e){return this._channel.updateMetadata(e)}close(){return H(this,null,function*(){yield this._channel.close()})}dispose(){return H(this,null,function*(){return this._channel.dispose()})}toJSON(){return{type:this.type,id:this.id,name:this.name,metadata:this.metadata,members:this.members,publications:this.publications,subscriptions:this.subscriptions}}},EP=new Ge("packages/room/src/room/p2p.ts"),PP=class extends Ib{constructor(e){super("p2p",e),this.setChannelState(),this.setChannelListener()}setChannelState(){this._channel.members.forEach(e=>{const t=new Pd(e,this);this._members[e.id]=t}),this._channel.publications.forEach(e=>{this._addPublication(e)}),this._channel.subscriptions.forEach(e=>{this._addSubscription(e)})}setChannelListener(){this._channel.onMemberJoined.add(e=>this._handleOnMemberJoin(e.member)),this._channel.onMemberLeft.add(e=>this._handleOnMemberLeft(e.member)),this._channel.onStreamPublished.add(e=>this._handleOnStreamPublish(e.publication)),this._channel.onStreamUnpublished.add(e=>this._handleOnStreamUnpublish(e.publication)),this._channel.onPublicationMetadataUpdated.add(e=>{this._handleOnPublicationMetadataUpdate(e.publication)}),this._channel.onPublicationEnabled.add(e=>{this._handleOnPublicationEnabled(e.publication)}),this._channel.onPublicationDisabled.add(e=>{this._handleOnPublicationDisabled(e.publication)}),this._channel.onPublicationSubscribed.add(e=>this._handleOnStreamSubscribe(e.subscription)),this._channel.onPublicationUnsubscribed.add(e=>this._handleOnStreamUnsubscribe(e.subscription))}_handleOnMemberJoin(e){if(this._getMember(e.id))return;const t=new Pd(e,this);this._members[e.id]=t,this.onMemberJoined.emit({member:t}),this.onMemberListChanged.emit({})}_handleOnMemberLeft(e){const t=this._getMember(e.id);delete this._members[e.id],t._dispose(),this.onMemberLeft.emit({member:t}),this.onMemberListChanged.emit({})}_handleOnStreamPublish(e){if(this._getPublication(e.id))return;const t=this._addPublication(e);this.onStreamPublished.emit({publication:t}),this.onPublicationListChanged.emit({})}_handleOnStreamUnpublish(e){const t=this._getPublication(e.id);delete this._publications[e.id],this.onStreamUnpublished.emit({publication:t}),this.onPublicationListChanged.emit({})}_handleOnPublicationMetadataUpdate(e){const t=this._getPublication(e.id);this.onPublicationMetadataUpdated.emit({publication:t,metadata:t.metadata})}_handleOnPublicationEnabled(e){const t=this._getPublication(e.id);this.onPublicationEnabled.emit({publication:t})}_handleOnPublicationDisabled(e){const t=this._getPublication(e.id);this.onPublicationDisabled.emit({publication:t})}_handleOnStreamSubscribe(e){if(this._getSubscription(e.id))return;const t=this._addSubscription(e);this.onPublicationSubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit({})}_handleOnStreamUnsubscribe(e){const t=this._getSubscription(e.id);delete this._subscriptions[e.id],this.onPublicationUnsubscribed.emit({subscription:t}),this.onSubscriptionListChanged.emit({})}join(){return H(this,arguments,function*(e={}){const t=yield this.joinChannel(e),n=new _P(t,this);return EP.debug("member joined",e),this.localRoomMember=n,n.onLeft.once(()=>{this.localRoomMember=void 0}),n})}};Y();var kP=new Ge("packages/room/src/room/sfu.ts"),TP=class Fb extends Ib{constructor(t,n){super("sfu",t),this._plugin=n,this.setChannelState(),this.setChannelListener()}static Create(t,n){return H(this,null,function*(){const r=t.plugins.find(o=>o.subtype==="sfu");return n.members.find(o=>o.subtype===Na.subtype)||(yield r.createBot(n)),new Fb(n,r)})}setChannelState(){this._channel.members.forEach(t=>{if(t.type==="bot")return;const n=new Pd(t,this);this._members[t.id]=n}),this._channel.publications.forEach(t=>{t.origin&&this._addPublication(t)}),this._channel.subscriptions.forEach(t=>{t.subscriber.type!=="bot"&&this._addSubscription(t)})}setChannelListener(){this._channel.onMemberJoined.add(t=>this._handleOnMemberJoin(t.member)),this._channel.onMemberLeft.add(t=>this._handleOnMemberLeft(t.member)),this._channel.onStreamPublished.add(t=>{this._handleOnStreamPublish(t.publication)}),this._channel.onStreamUnpublished.add(t=>this._handleOnStreamUnpublish(t.publication)),this._channel.onPublicationMetadataUpdated.add(t=>{this._handleOnPublicationMetadataUpdate(t.publication)}),this._channel.onPublicationEnabled.add(t=>{this._handleOnPublicationEnabled(t.publication)}),this._channel.onPublicationDisabled.add(t=>{this._handleOnPublicationDisabled(t.publication)}),this._channel.onPublicationSubscribed.add(t=>{this._handleOnStreamSubscribe(t.subscription)}),this._channel.onPublicationUnsubscribed.add(t=>this._handleOnStreamUnsubscribe(t.subscription))}_handleOnMemberJoin(t){if(t.type==="bot")return;const n=new Pd(t,this);this._members[t.id]=n,this.onMemberJoined.emit({member:n}),this.onMemberListChanged.emit({})}_handleOnMemberLeft(t){const n=this._getMember(t.id);n&&(delete this._members[t.id],n._dispose(),this.onMemberLeft.emit({member:n}),this.onMemberListChanged.emit({}))}_handleOnStreamPublish(t){var n;if(!((n=t.origin)!=null&&n.id))return;const r=this._addPublication(t);this.onStreamPublished.emit({publication:r}),this.onPublicationListChanged.emit({})}_handleOnStreamUnpublish(t){var n;if(!((n=t.origin)!=null&&n.id))return;const r=this._getPublication(t.id);delete this._publications[t.id],this.onStreamUnpublished.emit({publication:r}),this.onPublicationListChanged.emit({})}_getRelayedPublication(t){return this.publications.find(r=>{var i;return((i=r._publication.origin)==null?void 0:i.id)===t})}_handleOnPublicationMetadataUpdate(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationMetadataUpdated.emit({publication:n,metadata:n.metadata})}_handleOnPublicationEnabled(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationEnabled.emit({publication:n})}_handleOnPublicationDisabled(t){const n=this._getRelayedPublication(t.id);n&&this.onPublicationDisabled.emit({publication:n})}_handleOnStreamSubscribe(t){if(t.subscriber.type==="bot")return;const n=this._addSubscription(t);this.onPublicationSubscribed.emit({subscription:n}),this.onSubscriptionListChanged.emit({})}_handleOnStreamUnsubscribe(t){if(t.subscriber.type==="bot")return;const n=this._getSubscription(t.id);delete this._subscriptions[t.id],this.onPublicationUnsubscribed.emit({subscription:n}),this.onSubscriptionListChanged.emit({})}join(){return H(this,arguments,function*(t={}){const n=yield this.joinChannel(we(ie({},t),{disableSignaling:!0})),r=new SP(n,this);return this.localRoomMember=r,r.onLeft.once(()=>{this.localRoomMember=void 0}),kP.debug("member joined",t),r})}},Db=new Ge("packages/room/src/room/index.ts"),ra=class{constructor(){}};ra.Create=(e,t)=>H(null,null,function*(){var n,r;Db.info("room created",{operationName:"SkyWayRoom._Factory",sdkName:"room",sdkVersion:xP,init:t});const i=new dh((n=t==null?void 0:t.options)==null?void 0:n.sfu);e.registerPlugin(i);const a=yield rg.Create(e,{name:(r=t.name)!=null?r:Oi(),metadata:t.metadata});return yield ra._Factory(e,t.type,a)});ra.Find=(e,t,n,r)=>H(null,null,function*(){const i=new dh(r==null?void 0:r.sfu);e.registerPlugin(i);const a=yield rg.Find(e,t);return yield ra._Factory(e,n,a)});ra.FindOrCreate=(e,t)=>H(null,null,function*(){var n;const r=new dh((n=t==null?void 0:t.options)==null?void 0:n.sfu);e.registerPlugin(r);const i=yield rg.FindOrCreate(e,ie({},t));return yield ra._Factory(e,t.type,i)});ra._Factory=(e,t,n)=>H(null,null,function*(){switch(t){case"p2p":return new PP(n);case"sfu":return yield TP.Create(e,n);default:throw Oe({operationName:"SkyWayRoom._Factory",context:e,channel:n,info:Sr.notImplemented,path:Db.prefix})}});var RP=ra;Y();/*! Bundled license information:

jsrsasign/lib/jsrsasign.js:
  (*! CryptoJS v3.1.2 core-fix.js
   * code.google.com/p/crypto-js
   * (c) 2009-2013 by Jeff Mott. All rights reserved.
   * code.google.com/p/crypto-js/wiki/License
   * THIS IS FIX of 'core.js' to fix Hmac issue.
   * https://code.google.com/p/crypto-js/issues/detail?id=84
   * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
   *)
  (*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
   *)
  (*! (c) Tom Wu, Kenji Urushima | http://www-cs-students.stanford.edu/~tjw/jsbn/
   *)
  (*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
   *)
  (*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
   *)
*/var Et=Rd();const Nb=Jf(Et),AP=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Ob=e=>Array.isArray(e)&&e.every(t=>typeof t=="object"&&!(t instanceof Array)),IP=e=>Array.isArray(e)&&e.every(t=>Array.isArray(t)),FP=e=>Array.from(e.map(t=>Object.keys(t)).reduce((t,n)=>new Set([...t,...n]),[])),DP=(e,t)=>{t=t||FP(e);let n=t,r=t;Ob(t)&&(n=t.map(a=>a.label),r=t.map(a=>a.key));const i=e.map(a=>r.map(o=>NP(o,a)));return[n,...i]},NP=(e,t)=>{const n=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(r,i,a,o){const u=r[i];if(u==null)o.splice(1);else return u},t);return n===void 0?e in t?t[e]:"":n},OP=e=>typeof e>"u"||e===null?"":e,Mb=(e,t=",",n='"')=>e.filter(r=>r).map(r=>r.map(i=>OP(i)).map(i=>`${n}${i}${n}`).join(t)).join(`
`),MP=(e,t,n,r)=>Mb(t?[t,...e]:e,n,r),LP=(e,t,n,r)=>Mb(DP(e,t),n,r),jP=(e,t,n,r)=>t?`${t.join(n)}
${e}`:e.replace(/"/g,'""'),Lb=(e,t,n,r)=>{if(Ob(e))return LP(e,t,n,r);if(IP(e))return MP(e,t,n,r);if(typeof e=="string")return jP(e,t,n);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},jb=(e,t,n,r,i)=>{const a=Lb(e,n,r,i),o=AP()?"application/csv":"text/csv",u=new Blob([t?"\uFEFF":"",a],{type:o}),p=`data:${o};charset=utf-8,${t?"\uFEFF":""}${a}`,h=window.URL||window.webkitURL;return typeof h.createObjectURL>"u"?p:h.createObjectURL(u)};var Bb={exports:{}},BP="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",UP=BP,HP=UP;function Ub(){}function Hb(){}Hb.resetWarningCache=Ub;var VP=function(){function e(r,i,a,o,u,p){if(p!==HP){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Hb,resetWarningCache:Ub};return n.PropTypes=n,n};Bb.exports=VP();var ni=Bb.exports;const Vb={data:ni.oneOfType([ni.string,ni.array,ni.func]).isRequired,headers:ni.array,target:ni.string,separator:ni.string,filename:ni.string,uFEFF:ni.bool,onClick:ni.func,asyncOnClick:ni.bool,enclosingCharacter:ni.string},qb={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},qP={target:"_blank"};class C1 extends Nb.Component{constructor(t){super(t),this.state={}}buildURI(){return jb(...arguments)}componentDidMount(){const{data:t,headers:n,separator:r,enclosingCharacter:i,uFEFF:a,target:o,specs:u,replace:p}=this.props;this.state.page=window.open(this.buildURI(t,a,n,r,i),o,u,p)}getWindow(){return this.state.page}render(){return null}}ac(C1,"defaultProps",Object.assign(qb,qP)),ac(C1,"propTypes",Vb);var zb={exports:{}},hh={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zP=Rd(),KP=Symbol.for("react.element"),$P=Symbol.for("react.fragment"),WP=Object.prototype.hasOwnProperty,GP=zP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JP={key:!0,ref:!0,__self:!0,__source:!0};function Kb(e,t,n){var r,i={},a=null,o=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)WP.call(t,r)&&!JP.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:KP,type:e,key:a,ref:o,props:i,_owner:GP.current}}hh.Fragment=$P;hh.jsx=Kb;hh.jsxs=Kb;zb.exports=hh;var $b=zb.exports;const At=$b.jsx,wc=$b.jsxs;var yu;let ZP=(yu=class extends Nb.Component{constructor(t){super(t),this.buildURI=this.buildURI.bind(this)}buildURI(){return jb(...arguments)}handleLegacy(t,n=!1){if(window.navigator.msSaveOrOpenBlob){t.preventDefault();const{data:r,headers:i,separator:a,filename:o,enclosingCharacter:u,uFEFF:p}=this.props,h=n&&typeof r=="function"?r():r;let v=new Blob([p?"\uFEFF":"",Lb(h,i,a,u)]);return window.navigator.msSaveBlob(v,o),!1}}handleAsyncClick(t){const n=r=>{if(r===!1){t.preventDefault();return}this.handleLegacy(t,!0)};this.props.onClick(t,n)}handleSyncClick(t){if(this.props.onClick(t)===!1){t.preventDefault();return}this.handleLegacy(t)}handleClick(){return t=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(t):this.handleSyncClick(t);this.handleLegacy(t)}}render(){const{data:t,headers:n,separator:r,filename:i,uFEFF:a,children:o,onClick:u,asyncOnClick:p,enclosingCharacter:h,...v}=this.props,_=typeof window>"u"?"":this.buildURI(t,a,n,r,h);return At("a",{download:i,...v,ref:w=>this.link=w,target:"_self",href:_,onClick:this.handleClick(),children:o})}},ac(yu,"defaultProps",qb),ac(yu,"propTypes",Vb),yu);const QP=ZP;function E1(e,t,n,r,i,a,o){try{var u=e[a](o),p=u.value}catch(h){n(h);return}u.done?t(p):Promise.resolve(p).then(r,i)}function Ra(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(p){E1(a,r,i,o,u,"next",p)}function u(p){E1(a,r,i,o,u,"throw",p)}o(void 0)})}}var XP="Expected a function",P1=NaN,YP="[object Symbol]",ek=/^\s+|\s+$/g,tk=/^[-+]0x[0-9a-f]+$/i,nk=/^0b[01]+$/i,rk=/^0o[0-7]+$/i,ik=parseInt,sk=typeof Ei=="object"&&Ei&&Ei.Object===Object&&Ei,ak=typeof self=="object"&&self&&self.Object===Object&&self,ok=sk||ak||Function("return this")(),ck=Object.prototype,lk=ck.toString,uk=Math.max,dk=Math.min,Ip=function(){return ok.Date.now()};function hk(e,t,n){var r,i,a,o,u,p,h=0,v=!1,f=!1,_=!0;if(typeof e!="function")throw new TypeError(XP);t=k1(t)||0,Gf(n)&&(v=!!n.leading,f="maxWait"in n,a=f?uk(k1(n.maxWait)||0,t):a,_="trailing"in n?!!n.trailing:_);function w($){var z=r,q=i;return r=i=void 0,h=$,o=e.apply(q,z),o}function C($){return h=$,u=setTimeout(b,t),v?w($):o}function R($){var z=$-p,q=$-h,X=t-z;return f?dk(X,a-q):X}function S($){var z=$-p,q=$-h;return p===void 0||z>=t||z<0||f&&q>=a}function b(){var $=Ip();if(S($))return x($);u=setTimeout(b,R($))}function x($){return u=void 0,_&&r?w($):(r=i=void 0,o)}function E(){u!==void 0&&clearTimeout(u),h=0,r=p=i=u=void 0}function M(){return u===void 0?o:x(Ip())}function Z(){var $=Ip(),z=S($);if(r=arguments,i=this,p=$,z){if(u===void 0)return C(p);if(f)return u=setTimeout(b,t),w(p)}return u===void 0&&(u=setTimeout(b,t)),o}return Z.cancel=E,Z.flush=M,Z}function Gf(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function pk(e){return!!e&&typeof e=="object"}function fk(e){return typeof e=="symbol"||pk(e)&&lk.call(e)==YP}function k1(e){if(typeof e=="number")return e;if(fk(e))return P1;if(Gf(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Gf(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(ek,"");var n=nk.test(e);return n||rk.test(e)?ik(e.slice(2),n?2:8):tk.test(e)?P1:+e}var mk=hk;const gk=Jf(mk),mo=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),vk=e=>e===mo;var kd=()=>/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"");const Td=(...e)=>e.map(t=>t.trim()).join(" ").trim(),yk=/\s*\((.*?)\)\s*/g,_k=/(\(\?:[^)]+\))\?/g,bk=/(\(\?)?:\w+/g,Sk=/\*/g,wk=/[-{}[\]+?.,\\^$|#]/g,xk=e=>e instanceof RegExp?new RegExp(e.source,"i"):(e=e.replace(wk,"\\$&").replace(yk,"(?:$1)?").replace(bk,(t,n)=>n?t:"([^\\s]+)").replace(Sk,"(.*?)").replace(_k,"\\s*$1?\\s*"),new RegExp("^"+e+"$","i")),Ck=(e,t)=>{if(e=e.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!e.length&&!t.length)return 1;if(!e.length||!t.length)return 0;if(e===t)return 1;if(e.length===1&&t.length===1||e.length<2||t.length<2)return 0;const n=new Map;for(let i=0;i<e.length-1;i++){const a=e.substring(i,i+2),o=n.has(a)?n.get(a)+1:1;n.set(a,o)}let r=0;for(let i=0;i<t.length-1;i++){const a=t.substring(i,i+2),o=n.has(a)?n.get(a):0;o>0&&(n.set(a,o-1),r++)}return 2*r/(e.length+t.length-2)},Wb=()=>typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0);class Fp{setSpeechRecognition(t){const n=!!t&&(vk(t)||Wb());n&&(this.disableRecognition(),this.recognition=new t,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(n)}subscribe(t,n){this.subscribers[t]=n}unsubscribe(t){delete this.subscribers[t]}emitListeningChange(t){this.listening=t,Object.keys(this.subscribers).forEach(n=>{const{onListeningChange:r}=this.subscribers[n];r(t)})}emitMicrophoneAvailabilityChange(t){this.isMicrophoneAvailable=t,Object.keys(this.subscribers).forEach(n=>{const{onMicrophoneAvailabilityChange:r}=this.subscribers[n];r(t)})}emitTranscriptChange(t,n){Object.keys(this.subscribers).forEach(r=>{const{onTranscriptChange:i}=this.subscribers[r];i(t,n)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(t=>{const{onClearTranscript:n}=this.subscribers[t];n()})}emitBrowserSupportsSpeechRecognitionChange(t){Object.keys(this.subscribers).forEach(n=>{const{onBrowserSupportsSpeechRecognitionChange:r,onBrowserSupportsContinuousListeningChange:i}=this.subscribers[n];r(t),i(t)})}disconnect(t){if(this.recognition&&this.listening)switch(t){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(t){t&&t.error&&t.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:t,resultIndex:n}){const r=n===void 0?t.length-1:n;this.interimTranscript="",this.finalTranscript="";for(let a=r;a<t.length;++a)t[a].isFinal&&(!kd()||t[a][0].confidence>0)?this.updateFinalTranscript(t[a][0].transcript):this.interimTranscript=Td(this.interimTranscript,t[a][0].transcript);let i=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(i=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,i||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(t){this.finalTranscript=Td(this.finalTranscript,t)}resetTranscript(){this.disconnect("RESET")}startListening(){return Ra(function*({continuous:t=!1,language:n}={}){if(!this.recognition)return;const r=t!==this.recognition.continuous,i=n&&n!==this.recognition.lang;if((r||i)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=r?t:this.recognition.continuous,this.recognition.lang=i?n:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(a){a instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return Ra(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}stopListening(){return Ra(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}getRecognition(){return this.recognition}start(){return Ra(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(t){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(t),kd()&&(this.updateFinalTranscript=gk(this.updateFinalTranscript,250,{leading:!0}))}}const Gb="CLEAR_TRANSCRIPT",Jb="APPEND_TRANSCRIPT",Ek=()=>({type:Gb}),Pk=(e,t)=>({type:Jb,payload:{interimTranscript:e,finalTranscript:t}}),kk=(e,t)=>{switch(t.type){case Gb:return{interimTranscript:"",finalTranscript:""};case Jb:return{interimTranscript:t.payload.interimTranscript,finalTranscript:Td(e.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};let go=!!mo,qu=go&&!kd(),is;const Tk=({transcribing:e=!0,clearTranscriptOnListen:t=!0,commands:n=[]}={})=>{const[r]=Et.useState(Aa.getRecognitionManager()),[i,a]=Et.useState(go),[o,u]=Et.useState(qu),[{interimTranscript:p,finalTranscript:h},v]=Et.useReducer(kk,{interimTranscript:r.interimTranscript,finalTranscript:""}),[f,_]=Et.useState(r.listening),[w,C]=Et.useState(r.isMicrophoneAvailable),R=Et.useRef(n);R.current=n;const S=()=>{v(Ek())},b=Et.useCallback(()=>{r.resetTranscript(),S()},[r]),x=(q,X,K)=>{const oe=(typeof q=="object"?q.toString():q).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),ce=Ck(oe,X);return ce>=K?{command:q,commandWithoutSpecials:oe,howSimilar:ce,isFuzzyMatch:!0}:null},E=(q,X)=>{const ee=xk(q).exec(X);return ee?{command:q,parameters:ee.slice(1)}:null},M=Et.useCallback((q,X)=>{R.current.forEach(({command:K,callback:ee,matchInterim:oe=!1,isFuzzyMatch:ce=!1,fuzzyMatchingThreshold:ne=.8,bestMatchOnly:Te=!1})=>{const ye=!X&&oe?q.trim():X.trim(),me=(Array.isArray(K)?K:[K]).map(_e=>ce?x(_e,ye,ne):E(_e,ye)).filter(_e=>_e);if(ce&&Te&&me.length>=2){me.sort((Re,We)=>We.howSimilar-Re.howSimilar);const{command:_e,commandWithoutSpecials:ke,howSimilar:le}=me[0];ee(ke,ye,le,{command:_e,resetTranscript:b})}else me.forEach(_e=>{if(_e.isFuzzyMatch){const{command:ke,commandWithoutSpecials:le,howSimilar:Re}=_e;ee(le,ye,Re,{command:ke,resetTranscript:b})}else{const{command:ke,parameters:le}=_e;ee(...le,{command:ke,resetTranscript:b})}})})},[b]),Z=Et.useCallback((q,X)=>{e&&v(Pk(q,X)),M(q,X)},[M,e]),$=Et.useCallback(()=>{t&&S()},[t]);return Et.useEffect(()=>{const q=Aa.counter;Aa.counter+=1;const X={onListeningChange:_,onMicrophoneAvailabilityChange:C,onTranscriptChange:Z,onClearTranscript:$,onBrowserSupportsSpeechRecognitionChange:a,onBrowserSupportsContinuousListeningChange:u};return r.subscribe(q,X),()=>{r.unsubscribe(q)}},[e,t,r,Z,$]),{transcript:Td(h,p),interimTranscript:p,finalTranscript:h,listening:f,isMicrophoneAvailable:w,resetTranscript:b,browserSupportsSpeechRecognition:i,browserSupportsContinuousListening:o}},Aa={counter:0,applyPolyfill:e=>{is?is.setSpeechRecognition(e):is=new Fp(e);const t=!!e&&Wb();go=t,qu=t},removePolyfill:()=>{is?is.setSpeechRecognition(mo):is=new Fp(mo),go=!!mo,qu=go&&!kd()},getRecognitionManager:()=>(is||(is=new Fp(mo)),is),getRecognition:()=>Aa.getRecognitionManager().getRecognition(),startListening:({continuous:e,language:t}={})=>Ra(function*(){yield Aa.getRecognitionManager().startListening({continuous:e,language:t})})(),stopListening:()=>Ra(function*(){yield Aa.getRecognitionManager().stopListening()})(),abortListening:()=>Ra(function*(){yield Aa.getRecognitionManager().abortListening()})(),browserSupportsSpeechRecognition:()=>go,browserSupportsContinuousListening:()=>qu};var Zb={exports:{}};(function(e,t){(function(r,i){e.exports=i(Rd())})(Ei,function(n){return function(r){var i={};function a(o){if(i[o])return i[o].exports;var u=i[o]={i:o,l:!1,exports:{}};return r[o].call(u.exports,u,u.exports,a),u.l=!0,u.exports}return a.m=r,a.c=i,a.d=function(o,u,p){a.o(o,u)||Object.defineProperty(o,u,{enumerable:!0,get:p})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,u){if(u&1&&(o=a(o)),u&8||u&4&&typeof o=="object"&&o&&o.__esModule)return o;var p=Object.create(null);if(a.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:o}),u&2&&typeof o!="string")for(var h in o)a.d(p,h,(function(v){return o[v]}).bind(null,h));return p},a.n=function(o){var u=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(u,"a",u),u},a.o=function(o,u){return Object.prototype.hasOwnProperty.call(o,u)},a.p="",a(a.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,i,a){a.r(i);var o=a("react"),u=function(){var _=function(w,C){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,S){R.__proto__=S}||function(R,S){for(var b in S)S.hasOwnProperty(b)&&(R[b]=S[b])},_(w,C)};return function(w,C){_(w,C);function R(){this.constructor=w}w.prototype=C===null?Object.create(C):(R.prototype=C.prototype,new R)}}(),p=function(){return p=Object.assign||function(_){for(var w,C=1,R=arguments.length;C<R;C++){w=arguments[C];for(var S in w)Object.prototype.hasOwnProperty.call(w,S)&&(_[S]=w[S])}return _},p.apply(this,arguments)},h=function(_,w){var C={};for(var R in _)Object.prototype.hasOwnProperty.call(_,R)&&w.indexOf(R)<0&&(C[R]=_[R]);if(_!=null&&typeof Object.getOwnPropertySymbols=="function")for(var S=0,R=Object.getOwnPropertySymbols(_);S<R.length;S++)w.indexOf(R[S])<0&&Object.prototype.propertyIsEnumerable.call(_,R[S])&&(C[R[S]]=_[R[S]]);return C};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(w){var C=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return C?new Promise(function(R,S){C.call(navigator,w,R,S)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function v(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var f=function(_){u(w,_);function w(C){var R=_.call(this,C)||this;return R.canvas=null,R.ctx=null,R.requestUserMediaId=0,R.unmounted=!1,R.state={hasUserMedia:!1},R}return w.prototype.componentDidMount=function(){var C=this,R=C.state,S=C.props;if(this.unmounted=!1,!v()){S.onUserMediaError("getUserMedia not supported");return}R.hasUserMedia||this.requestUserMedia(),S.children&&typeof S.children!="function"&&console.warn("children must be a function")},w.prototype.componentDidUpdate=function(C){var R=this.props;if(!v()){R.onUserMediaError("getUserMedia not supported");return}var S=JSON.stringify(C.audioConstraints)!==JSON.stringify(R.audioConstraints),b=JSON.stringify(C.videoConstraints)!==JSON.stringify(R.videoConstraints),x=C.minScreenshotWidth!==R.minScreenshotWidth,E=C.minScreenshotHeight!==R.minScreenshotHeight;(b||x||E)&&(this.canvas=null,this.ctx=null),(S||b)&&(this.stopAndCleanup(),this.requestUserMedia())},w.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},w.stopMediaStream=function(C){C&&(C.getVideoTracks&&C.getAudioTracks?(C.getVideoTracks().map(function(R){C.removeTrack(R),R.stop()}),C.getAudioTracks().map(function(R){C.removeTrack(R),R.stop()})):C.stop())},w.prototype.stopAndCleanup=function(){var C=this.state;C.hasUserMedia&&(w.stopMediaStream(this.stream),C.src&&window.URL.revokeObjectURL(C.src))},w.prototype.getScreenshot=function(C){var R=this,S=R.state,b=R.props;if(!S.hasUserMedia)return null;var x=this.getCanvas(C);return x&&x.toDataURL(b.screenshotFormat,b.screenshotQuality)},w.prototype.getCanvas=function(C){var R=this,S=R.state,b=R.props;if(!this.video||!S.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var x=this.video.videoWidth,E=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var M=x/E;x=b.minScreenshotWidth||this.video.clientWidth,E=x/M,b.minScreenshotHeight&&E<b.minScreenshotHeight&&(E=b.minScreenshotHeight,x=E*M)}this.canvas=document.createElement("canvas"),this.canvas.width=(C==null?void 0:C.width)||x,this.canvas.height=(C==null?void 0:C.height)||E,this.ctx=this.canvas.getContext("2d")}var Z=this,$=Z.ctx,z=Z.canvas;return $&&z&&(z.width=(C==null?void 0:C.width)||z.width,z.height=(C==null?void 0:C.height)||z.height,b.mirrored&&($.translate(z.width,0),$.scale(-1,1)),$.imageSmoothingEnabled=b.imageSmoothing,$.drawImage(this.video,0,0,(C==null?void 0:C.width)||z.width,(C==null?void 0:C.height)||z.height),b.mirrored&&($.scale(-1,1),$.translate(-z.width,0))),z},w.prototype.requestUserMedia=function(){var C=this,R=this.props,S=function(E,M){var Z={video:typeof M<"u"?M:!0};R.audio&&(Z.audio=typeof E<"u"?E:!0),C.requestUserMediaId++;var $=C.requestUserMediaId;navigator.mediaDevices.getUserMedia(Z).then(function(z){C.unmounted||$!==C.requestUserMediaId?w.stopMediaStream(z):C.handleUserMedia(null,z)}).catch(function(z){C.handleUserMedia(z)})};if("mediaDevices"in navigator)S(R.audioConstraints,R.videoConstraints);else{var b=function(E){return{optional:[{sourceId:E}]}},x=function(E){var M=E.deviceId;return typeof M=="string"?M:Array.isArray(M)&&M.length>0?M[0]:typeof M=="object"&&M.ideal?M.ideal:null};MediaStreamTrack.getSources(function(E){var M=null,Z=null;E.forEach(function(q){q.kind==="audio"?M=q.id:q.kind==="video"&&(Z=q.id)});var $=x(R.audioConstraints);$&&(M=$);var z=x(R.videoConstraints);z&&(Z=z),S(b(M),b(Z))})}},w.prototype.handleUserMedia=function(C,R){var S=this.props;if(C||!R){this.setState({hasUserMedia:!1}),S.onUserMediaError(C);return}this.stream=R;try{this.video&&(this.video.srcObject=R),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(R)})}S.onUserMedia(R)},w.prototype.render=function(){var C=this,R=this,S=R.state,b=R.props,x=b.audio;b.forceScreenshotSourceSize;var E=b.disablePictureInPicture;b.onUserMedia,b.onUserMediaError,b.screenshotFormat,b.screenshotQuality,b.minScreenshotWidth,b.minScreenshotHeight,b.audioConstraints,b.videoConstraints,b.imageSmoothing;var M=b.mirrored,Z=b.style,$=Z===void 0?{}:Z,z=b.children,q=h(b,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),X=M?p(p({},$),{transform:($.transform||"")+" scaleX(-1)"}):$,K={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",p({autoPlay:!0,disablePictureInPicture:E,src:S.src,muted:!x,playsInline:!0,ref:function(ee){C.video=ee},style:X},q)),z&&z(K))},w.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},w}(o.Component);i.default=f},react:function(r,i){r.exports=n}}).default})})(Zb);var Rk=Zb.exports;const Ak=Jf(Rk),Ik="78d4247e-9c81-45c4-a3ad-cad69d3fa502",Fk="q30eIW0sHi102yMNovcPpJm31EX/AbcjpsZnjHbOmoI=",Dk=new yl({jti:Ko(),iat:t1(),exp:t1()+60*60*24,scope:{app:{id:Ik,turn:!0,actions:["read"],channels:[{id:"*",name:"*",actions:["write"],members:[{id:"*",name:"*",actions:["write"],publication:{actions:["write"]},subscription:{actions:["write"]}}],sfuBots:[{actions:["write"],forwardings:[{actions:["write"]}]}]}]}}}),Nk=Dk.encode(Fk),Ok={log:{level:"debug"}},Mk={},Lk=window.scrollX,jk=({subscription:e,windowInfo:t,participantNum:n,participantAllNums:r,windowMax:i})=>{const a=Et.useRef(null);Et.useEffect(()=>{a!=null&&a.current&&e.stream&&(a.current.srcObject=new MediaStream([e.stream.track]))},[a==null?void 0:a.current,e.stream]);const o=Et.useMemo(()=>(console.log("Window Info:"+t),t?{position:"absolute",width:t==null?void 0:t.width,top:`${0+window.screen.height/2-t.height/2+t.topDiff}px`,left:`${window.screenLeft+Lk+window.screen.width/2-t.width/2+t.leftDiff+(i+50)*(n+1-(r+1)/2)}px`,border:`10px solid rgba(${t==null?void 0:t.borderRed}, ${t==null?void 0:t.borderGreen}, ${t==null?void 0:t.borderBlue}, ${t.borderAlpha})`}:{}),[t]);return At("div",{children:At("video",{muted:!0,autoPlay:!0,playsInline:!0,ref:a,onClick:async()=>{e.preferredEncoding==="high"?e.changePreferredEncoding("low"):e.preferredEncoding==="low"&&e.changePreferredEncoding("high")},style:o})})},yt={MOVING_AVERAGE_FRAME:10,WIDTH_MAX:400,WIDTH_MIN:200,DISTANCE_RATE_MOVE:1e4,DEFAULT_TOP_DIFF:0,DEFAULT_LEFT_DIFF:0,BORDER_ALPHA_MIN:0,BORDER_ALPHA_MAX:1,BORDER_ALPHA_MIN_THRESHOLD:.015,DEFAULT_MY_WINDOW_WIDTH:250,BORDER_COLORS:{GREEN:{r:83,g:253,b:49,a:0}}},ss=(yt.WIDTH_MAX+yt.WIDTH_MIN)/2,_a=yt.BORDER_COLORS.GREEN,gr={averageValue:(e,t=0,n=e.length-1)=>{let r=0;for(let i=t;i<n+1;i++)r+=e[i];return r/(n-t+1)},inner:(e,t)=>e[0]*t[0]+e[1]*t[1],norm:e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),getParticipantDirection:e=>e<0||e>360?"Error":e<22.5||e>=337.5?"Left":e>=22.5&&e<67.5?"LeftDown":e>=67.5&&e<112.5?"Down":e>=112.5&&e<157.5?"RightDown":e>=157.5&&e<202.5?"Right":e>=202.5&&e<247.5?"RightUp":e>=247.5&&e<292.5?"Up":e>=292.5&&e<337.5?"LeftUp":"Error"};let xc=1,Xa=1,Os="Baseline",T1=0;const as=[],os=[],Bk=!1,R1=yt.BORDER_ALPHA_MIN,Uk=()=>{const[e,t]=Et.useState(""),[n,r]=Et.useState(),[i,a]=Et.useState(),[o,u]=Et.useState(),[p,h]=Et.useState([]),[v,f]=Et.useState({topDiff:yt.DEFAULT_TOP_DIFF,leftDiff:yt.DEFAULT_LEFT_DIFF,width:300,height:300,borderRed:_a.r,borderGreen:_a.g,borderBlue:_a.b,borderAlpha:_a.a,borderAlphaValueBasedVoice:R1,widthInCaseOfChange:0,theta:0,isSpeaking:!1,transcript:"",gazeStatus:""}),[_,w]=Et.useState(new Map),[C,R]=Et.useState(new Map);Tk();const[S,b]=Et.useState([]),[x,E]=Et.useState(0),[M,Z]=Et.useState(!1),$=Et.useRef(null),z=Et.useRef(null),q=Et.useRef(null),X=Et.useRef(),K=Et.useRef(null),ee=Et.useMemo(()=>({position:"absolute",top:50,left:0,width:yt.DEFAULT_MY_WINDOW_WIDTH,border:`10px solid rgba(${v.borderRed}, ${v.borderGreen}, ${v.borderBlue}, ${v.borderAlphaValueBasedVoice})`}),[v]),oe=Et.useCallback((ue,me,_e,ke,le,Re,We)=>{let Xe=0,Ke=0,Le=ss,qe=yt.BORDER_ALPHA_MIN,rt=0,ot=yt.WIDTH_MIN,wt="";const Pn=yt.DISTANCE_RATE_MOVE*gr.norm(me)*Math.sin(_e),Xi=yt.DISTANCE_RATE_MOVE*gr.norm(me)*Math.cos(_e-Math.PI);let kn;150*gr.norm(me)<=1?(Xe=1,Ke=1):(Xe=1/(150*gr.norm(me)),Ke=1/(150*gr.norm(me))),Le=yt.WIDTH_MAX*Xe,qe=yt.BORDER_ALPHA_MAX*Ke,Le<yt.WIDTH_MIN&&(Le=yt.WIDTH_MIN),qe<yt.BORDER_ALPHA_MIN_THRESHOLD&&(qe=yt.BORDER_ALPHA_MIN),rt=Le,as.push(Le),os.push(qe),as.length<yt.MOVING_AVERAGE_FRAME?Le=gr.averageValue(as,0,as.length-1):(as.length>yt.MOVING_AVERAGE_FRAME+3&&as.shift(),Le=gr.averageValue(as,as.length-yt.MOVING_AVERAGE_FRAME,as.length-1)),os.length<yt.MOVING_AVERAGE_FRAME?qe=gr.averageValue(os,0,os.length-1):(os.length>yt.MOVING_AVERAGE_FRAME+3&&os.shift(),qe=gr.averageValue(os,os.length-yt.MOVING_AVERAGE_FRAME,os.length-1)),Le>yt.WIDTH_MAX-(yt.WIDTH_MAX-yt.WIDTH_MIN)*.1?ot=yt.WIDTH_MAX:ot=yt.WIDTH_MIN,rt>yt.WIDTH_MAX-(yt.WIDTH_MAX-yt.WIDTH_MIN)*.1&&(wt="mutual gaze"),rt<yt.WIDTH_MIN+(yt.WIDTH_MAX-yt.WIDTH_MIN)*.1&&(wt="gaze aversion");const dr={borderRed:_a.r,borderGreen:_a.g,borderBlue:_a.b,borderAlphaValueBasedVoice:le,widthInCaseOfChange:rt,theta:ke,isSpeaking:Re,transcript:We,gazeStatus:wt};switch(ue){case 1:kn={...dr,topDiff:yt.DEFAULT_TOP_DIFF,leftDiff:yt.DEFAULT_LEFT_DIFF,width:ss,height:ss,borderAlpha:le};break;case 2:kn={...dr,topDiff:yt.DEFAULT_TOP_DIFF,leftDiff:yt.DEFAULT_LEFT_DIFF,width:ss,height:ss,borderAlpha:qe};break;case 3:kn={...dr,topDiff:yt.DEFAULT_TOP_DIFF,leftDiff:yt.DEFAULT_LEFT_DIFF,width:Le,height:Le,borderAlpha:le};break;case 4:kn={...dr,topDiff:yt.DEFAULT_TOP_DIFF,leftDiff:yt.DEFAULT_LEFT_DIFF,width:ot,height:ot,borderAlpha:le};break;case 5:kn={...dr,topDiff:Pn,leftDiff:Xi,width:ss,height:ss,borderAlpha:le};break;case 6:kn={...dr,topDiff:Pn,leftDiff:Xi,width:Le,height:Le,borderAlpha:le};break;default:kn={...dr,topDiff:yt.DEFAULT_TOP_DIFF,leftDiff:yt.DEFAULT_LEFT_DIFF,width:ss,height:ss,borderAlpha:le}}return kn},[]),ce=Et.useCallback(ue=>{if(ue.multiFaceLandmarks.length>0){X.current=ue;const me=[],_e=[],ke=[];if(ue.multiFaceLandmarks&&ue.multiFaceLandmarks[0])for(let Le=0;Le<ue.multiFaceLandmarks[0].length;Le++)ue.multiFaceLandmarks[0][Le].x<0?me.push(0):ue.multiFaceLandmarks[0][Le].x>1?me.push(1):me.push(ue.multiFaceLandmarks[0][Le].x),ue.multiFaceLandmarks[0][Le].y<0?_e.push(0):ue.multiFaceLandmarks[0][Le].y>1?_e.push(1):_e.push(ue.multiFaceLandmarks[0][Le].y),Le===1&&(ue.multiFaceLandmarks[0][Le].x<0?ke.push(0):ue.multiFaceLandmarks[0][Le].x>1?ke.push(1):ke.push(ue.multiFaceLandmarks[0][Le].x),ue.multiFaceLandmarks[0][Le].y<0?ke.push(0):ue.multiFaceLandmarks[0][Le].y>1?ke.push(1):ke.push(ue.multiFaceLandmarks[0][Le].y));const le=[gr.averageValue(me),gr.averageValue(_e)],Re=[1,0],We=[ke[0]-le[0],ke[1]-le[1]];let Xe=Math.acos(gr.inner(Re,We)/(gr.norm(Re)*gr.norm(We))),Ke=Xe*(180/Math.PI);We[1]<0&&(Xe=-Xe,Ke=360-Ke),f(()=>oe(Xa,We,Xe,Ke,R1,Bk,""))}},[]),ne=Et.useCallback(()=>{b([{ID:xc,condition:Xa,startTime:0,endTime:0,myTheta:0,myDirection:"",myWindowWidth:0,myStatusGaze:"",myIsSpeaking:!1,myTranscript:""}]),E(0),T1=performance.now(),Z(!0)},[]),Te=Et.useCallback(()=>{var ue;Z(!1),(ue=K==null?void 0:K.current)==null||ue.link.click()},[]),ye=async()=>{var Re,We,Xe;const ue=await $f.Create(Nk,Ok),me=await RP.FindOrCreate(ue,{name:e,type:"p2p",options:Mk}),_e=await me.join();r(_e);const ke=await y1.createMicrophoneAudioAndCameraStream({video:{frameRate:15}});ke.video.attach($.current);const le=await y1.createDataStream();a(ke),u(le),await((Re=$.current)==null?void 0:Re.play()),await _e.publish(ke.audio,{maxSubscribers:50}),await _e.publish(ke.video,{maxSubscribers:50,encodings:[{scaleResolutionDownBy:4,id:"low",maxBitrate:8e4},{scaleResolutionDownBy:1,id:"high",maxBitrate:4e5}]}),le!==void 0&&(console.log("published data stream"),await _e.publish(le)),_e.onPublicationSubscribed.add(Ke=>{if(Ke.stream.contentType==="audio"){const Le=q?q.current:null,qe=document.createElement("audio");qe.srcObject=new MediaStream([Ke.stream.track]),qe.play(),Le==null||Le.appendChild(qe),Ke.subscription.onCanceled.once(()=>{Le==null||Le.removeChild(qe)})}}),_e.onPublicationUnsubscribed.add(Ke=>{R(Le=>{const qe=new Map(Le);return qe.delete(Ke.subscription.id),qe})}),_e.onSubscriptionListChanged.add(()=>{h(_e.subscriptions.filter(Ke=>Ke.contentType==="video"))}),me.onStreamPublished.add(async Ke=>{if(Ke.publication.publisher.id!==_e.id)try{const{stream:Le}=await _e.subscribe(Ke.publication);Le.contentType==="data"&&R(qe=>new Map(qe).set(Ke.publication.publisher.id,Le))}catch(Le){console.log("Failed to subscribe to data stream:",Le),Le instanceof _r&&Le.name==="internal"&&console.log("Publisher already left the room, ignoring subscription.")}}),(We=document.getElementById("active-after-conference"))==null||We.classList.remove("non-active"),(Xe=document.getElementById("active-before-conference"))==null||Xe.classList.add("non-active"),await Promise.all(me.publications.filter(Ke=>Ke.publisher.id!==_e.id).map(async Ke=>{try{const{stream:Le}=await _e.subscribe(Ke);Le.contentType==="data"&&R(qe=>new Map(qe).set(Ke.publisher.id,Le))}catch(Le){console.error("Failed to subscribe:",Le)}}))};return Et.useEffect(()=>{C.forEach((ue,me)=>{ue.onData.add(_e=>{console.log("Receiving Data from",me,":",_e),w(ke=>{const le=new Map(ke);return le.set(me,_e),le})})})},[C]),Et.useEffect(()=>{o&&(console.log("Sending Data:",v),o.write(v))},[o,v]),Et.useEffect(()=>{var me;const ue=new jw.FaceMesh({locateFile:_e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${_e}`});return ue.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),ue.onResults(ce),$.current&&((me=z.current)!=null&&me.video)&&new Lw.Camera(z.current.video,{onFrame:async()=>{await ue.send({image:z.current.video})}}).start(),()=>{ue.close()}},[ce]),Et.useEffect(()=>{if(o&&C&&M){const ue=(performance.now()-T1)/1e3,me={ID:xc,condition:Xa,startTime:x,endTime:ue,myTheta:v.theta,myDirection:gr.getParticipantDirection(v.theta),myWindowWidth:v.widthInCaseOfChange,myStatusGaze:v.gazeStatus,myIsSpeaking:v.isSpeaking,myTranscript:v.transcript};b(_e=>[..._e,me]),E(ue)}},[M,x,v,C]),wc("div",{children:[At("div",{id:"active-before-conference",children:wc("p",{children:["Your ID:",wc("select",{id:"ID",onChange:ue=>{xc=Number(ue.target.value)},children:[At("option",{value:"1",children:"1"}),At("option",{value:"2",children:"2"}),At("option",{value:"3",children:"3"}),At("option",{value:"4",children:"4"}),At("option",{value:"5",children:"5"}),At("option",{value:"6",children:"6"}),At("option",{value:"7",children:"7"}),At("option",{value:"8",children:"8"}),At("option",{value:"9",children:"9"}),At("option",{value:"10",children:"10"}),At("option",{value:"11",children:"11"}),At("option",{value:"12",children:"12"}),At("option",{value:"13",children:"13"}),At("option",{value:"14",children:"14"}),At("option",{value:"15",children:"15"}),At("option",{value:"16",children:"16"}),At("option",{value:"17",children:"17"}),At("option",{value:"18",children:"18"}),At("option",{value:"19",children:"19"}),At("option",{value:"20",children:"20"})]})," condition=",wc("select",{id:"condition",onChange:ue=>{switch(Xa=Number(ue.target.value),Xa){case 1:Os="Baseline";break;case 2:Os="FrameChange";break;case 3:Os="SizeChange";break;case 4:Os="SizeChange_Discrete";break;case 5:Os="PositionChange";break;case 6:Os="PositionAndSizeChange";break;default:Os="";break}},children:[At("option",{value:"1",children:"Baseline"}),At("option",{value:"2",children:"FrameChange"}),At("option",{value:"3",children:"SizeChange"}),At("option",{value:"4",children:"SizeChange_Discrete"})]})," room name:"," ",At("input",{type:"text",value:e,onChange:ue=>{t(ue.target.value)}}),"",At("button",{onClick:ye,children:"join"})]})}),wc("div",{id:"active-after-conference",className:"non-active",children:["ID: ",xc,"  condition: ",Os,"  room name: ",e,"",At("button",{onClick:ne,disabled:M,children:"Measurement Start"}),"",At("button",{onClick:Te,disabled:!M,children:"Measurement End"})]}),At("video",{id:"local-video",ref:$,muted:!0,playsInline:!0,style:ee}),At(Ak,{id:"local-video-webcam",ref:z,muted:!0,playsInline:!0,style:ee}),At("div",{style:{display:"flex",flexWrap:"wrap"},children:p.map(ue=>At(jk,{subscription:ue,windowInfo:_.get(ue.publication.publisher.id),participantNum:p.indexOf(ue),participantAllNums:p.length,windowMax:yt.WIDTH_MAX},ue.id))}),At("div",{ref:q}),At(QP,{data:S,filename:`C${Xa}_ID${xc}_headDirectionResults.csv`,ref:K})]})},Hk=Iy(document.getElementById("root"));Hk.render(At(Uk,{}));
